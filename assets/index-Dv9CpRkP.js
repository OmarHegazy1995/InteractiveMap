function mq(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const l in n)if(l!=="default"&&!(l in e)){const u=Object.getOwnPropertyDescriptor(n,l);u&&Object.defineProperty(e,l,u.get?u:{enumerable:!0,get:()=>n[l]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function r(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function n(l){if(l.ep)return;l.ep=!0;const u=r(l);fetch(l.href,u)}})();var Vx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function od(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var LB={exports:{}},my={},MB={exports:{}},to={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lM;function gq(){if(lM)return to;lM=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),d=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),I=Symbol.iterator;function M(lt){return lt===null||typeof lt!="object"?null:(lt=I&&lt[I]||lt["@@iterator"],typeof lt=="function"?lt:null)}var L={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,R={};function H(lt,ie,Le){this.props=lt,this.context=ie,this.refs=R,this.updater=Le||L}H.prototype.isReactComponent={},H.prototype.setState=function(lt,ie){if(typeof lt!="object"&&typeof lt!="function"&&lt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,lt,ie,"setState")},H.prototype.forceUpdate=function(lt){this.updater.enqueueForceUpdate(this,lt,"forceUpdate")};function q(){}q.prototype=H.prototype;function te(lt,ie,Le){this.props=lt,this.context=ie,this.refs=R,this.updater=Le||L}var J=te.prototype=new q;J.constructor=te,U(J,H.prototype),J.isPureReactComponent=!0;var se=Array.isArray,ye=Object.prototype.hasOwnProperty,Se={current:null},Be={key:!0,ref:!0,__self:!0,__source:!0};function De(lt,ie,Le){var Fe,Re={},et=null,xt=null;if(ie!=null)for(Fe in ie.ref!==void 0&&(xt=ie.ref),ie.key!==void 0&&(et=""+ie.key),ie)ye.call(ie,Fe)&&!Be.hasOwnProperty(Fe)&&(Re[Fe]=ie[Fe]);var Dt=arguments.length-2;if(Dt===1)Re.children=Le;else if(1<Dt){for(var pt=Array(Dt),Ct=0;Ct<Dt;Ct++)pt[Ct]=arguments[Ct+2];Re.children=pt}if(lt&&lt.defaultProps)for(Fe in Dt=lt.defaultProps,Dt)Re[Fe]===void 0&&(Re[Fe]=Dt[Fe]);return{$$typeof:e,type:lt,key:et,ref:xt,props:Re,_owner:Se.current}}function we(lt,ie){return{$$typeof:e,type:lt.type,key:ie,ref:lt.ref,props:lt.props,_owner:lt._owner}}function nt(lt){return typeof lt=="object"&&lt!==null&&lt.$$typeof===e}function _e(lt){var ie={"=":"=0",":":"=2"};return"$"+lt.replace(/[=:]/g,function(Le){return ie[Le]})}var Ie=/\/+/g;function Ze(lt,ie){return typeof lt=="object"&&lt!==null&&lt.key!=null?_e(""+lt.key):ie.toString(36)}function st(lt,ie,Le,Fe,Re){var et=typeof lt;(et==="undefined"||et==="boolean")&&(lt=null);var xt=!1;if(lt===null)xt=!0;else switch(et){case"string":case"number":xt=!0;break;case"object":switch(lt.$$typeof){case e:case t:xt=!0}}if(xt)return xt=lt,Re=Re(xt),lt=Fe===""?"."+Ze(xt,0):Fe,se(Re)?(Le="",lt!=null&&(Le=lt.replace(Ie,"$&/")+"/"),st(Re,ie,Le,"",function(Ct){return Ct})):Re!=null&&(nt(Re)&&(Re=we(Re,Le+(!Re.key||xt&&xt.key===Re.key?"":(""+Re.key).replace(Ie,"$&/")+"/")+lt)),ie.push(Re)),1;if(xt=0,Fe=Fe===""?".":Fe+":",se(lt))for(var Dt=0;Dt<lt.length;Dt++){et=lt[Dt];var pt=Fe+Ze(et,Dt);xt+=st(et,ie,Le,pt,Re)}else if(pt=M(lt),typeof pt=="function")for(lt=pt.call(lt),Dt=0;!(et=lt.next()).done;)et=et.value,pt=Fe+Ze(et,Dt++),xt+=st(et,ie,Le,pt,Re);else if(et==="object")throw ie=String(lt),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(lt).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.");return xt}function Et(lt,ie,Le){if(lt==null)return lt;var Fe=[],Re=0;return st(lt,Fe,"","",function(et){return ie.call(Le,et,Re++)}),Fe}function Ut(lt){if(lt._status===-1){var ie=lt._result;ie=ie(),ie.then(function(Le){(lt._status===0||lt._status===-1)&&(lt._status=1,lt._result=Le)},function(Le){(lt._status===0||lt._status===-1)&&(lt._status=2,lt._result=Le)}),lt._status===-1&&(lt._status=0,lt._result=ie)}if(lt._status===1)return lt._result.default;throw lt._result}var jt={current:null},bt={transition:null},Nt={ReactCurrentDispatcher:jt,ReactCurrentBatchConfig:bt,ReactCurrentOwner:Se};function ar(){throw Error("act(...) is not supported in production builds of React.")}return to.Children={map:Et,forEach:function(lt,ie,Le){Et(lt,function(){ie.apply(this,arguments)},Le)},count:function(lt){var ie=0;return Et(lt,function(){ie++}),ie},toArray:function(lt){return Et(lt,function(ie){return ie})||[]},only:function(lt){if(!nt(lt))throw Error("React.Children.only expected to receive a single React element child.");return lt}},to.Component=H,to.Fragment=r,to.Profiler=l,to.PureComponent=te,to.StrictMode=n,to.Suspense=v,to.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nt,to.act=ar,to.cloneElement=function(lt,ie,Le){if(lt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+lt+".");var Fe=U({},lt.props),Re=lt.key,et=lt.ref,xt=lt._owner;if(ie!=null){if(ie.ref!==void 0&&(et=ie.ref,xt=Se.current),ie.key!==void 0&&(Re=""+ie.key),lt.type&&lt.type.defaultProps)var Dt=lt.type.defaultProps;for(pt in ie)ye.call(ie,pt)&&!Be.hasOwnProperty(pt)&&(Fe[pt]=ie[pt]===void 0&&Dt!==void 0?Dt[pt]:ie[pt])}var pt=arguments.length-2;if(pt===1)Fe.children=Le;else if(1<pt){Dt=Array(pt);for(var Ct=0;Ct<pt;Ct++)Dt[Ct]=arguments[Ct+2];Fe.children=Dt}return{$$typeof:e,type:lt.type,key:Re,ref:et,props:Fe,_owner:xt}},to.createContext=function(lt){return lt={$$typeof:d,_currentValue:lt,_currentValue2:lt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},lt.Provider={$$typeof:u,_context:lt},lt.Consumer=lt},to.createElement=De,to.createFactory=function(lt){var ie=De.bind(null,lt);return ie.type=lt,ie},to.createRef=function(){return{current:null}},to.forwardRef=function(lt){return{$$typeof:a,render:lt}},to.isValidElement=nt,to.lazy=function(lt){return{$$typeof:b,_payload:{_status:-1,_result:lt},_init:Ut}},to.memo=function(lt,ie){return{$$typeof:x,type:lt,compare:ie===void 0?null:ie}},to.startTransition=function(lt){var ie=bt.transition;bt.transition={};try{lt()}finally{bt.transition=ie}},to.unstable_act=ar,to.useCallback=function(lt,ie){return jt.current.useCallback(lt,ie)},to.useContext=function(lt){return jt.current.useContext(lt)},to.useDebugValue=function(){},to.useDeferredValue=function(lt){return jt.current.useDeferredValue(lt)},to.useEffect=function(lt,ie){return jt.current.useEffect(lt,ie)},to.useId=function(){return jt.current.useId()},to.useImperativeHandle=function(lt,ie,Le){return jt.current.useImperativeHandle(lt,ie,Le)},to.useInsertionEffect=function(lt,ie){return jt.current.useInsertionEffect(lt,ie)},to.useLayoutEffect=function(lt,ie){return jt.current.useLayoutEffect(lt,ie)},to.useMemo=function(lt,ie){return jt.current.useMemo(lt,ie)},to.useReducer=function(lt,ie,Le){return jt.current.useReducer(lt,ie,Le)},to.useRef=function(lt){return jt.current.useRef(lt)},to.useState=function(lt){return jt.current.useState(lt)},to.useSyncExternalStore=function(lt,ie,Le){return jt.current.useSyncExternalStore(lt,ie,Le)},to.useTransition=function(){return jt.current.useTransition()},to.version="18.3.1",to}var cM;function hv(){return cM||(cM=1,MB.exports=gq()),MB.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uM;function _q(){if(uM)return my;uM=1;var e=hv(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function d(a,v,x){var b,I={},M=null,L=null;x!==void 0&&(M=""+x),v.key!==void 0&&(M=""+v.key),v.ref!==void 0&&(L=v.ref);for(b in v)n.call(v,b)&&!u.hasOwnProperty(b)&&(I[b]=v[b]);if(a&&a.defaultProps)for(b in v=a.defaultProps,v)I[b]===void 0&&(I[b]=v[b]);return{$$typeof:t,type:a,key:M,ref:L,props:I,_owner:l.current}}return my.Fragment=r,my.jsx=d,my.jsxs=d,my}var hM;function vq(){return hM||(hM=1,LB.exports=_q()),LB.exports}var Nr=vq(),Me=hv();const pc=od(Me),yq=mq({__proto__:null,default:pc},[Me]);var Gx={},OB={exports:{}},Tf={},DB={exports:{}},RB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fM;function xq(){return fM||(fM=1,function(e){function t(bt,Nt){var ar=bt.length;bt.push(Nt);e:for(;0<ar;){var lt=ar-1>>>1,ie=bt[lt];if(0<l(ie,Nt))bt[lt]=Nt,bt[ar]=ie,ar=lt;else break e}}function r(bt){return bt.length===0?null:bt[0]}function n(bt){if(bt.length===0)return null;var Nt=bt[0],ar=bt.pop();if(ar!==Nt){bt[0]=ar;e:for(var lt=0,ie=bt.length,Le=ie>>>1;lt<Le;){var Fe=2*(lt+1)-1,Re=bt[Fe],et=Fe+1,xt=bt[et];if(0>l(Re,ar))et<ie&&0>l(xt,Re)?(bt[lt]=xt,bt[et]=ar,lt=et):(bt[lt]=Re,bt[Fe]=ar,lt=Fe);else if(et<ie&&0>l(xt,ar))bt[lt]=xt,bt[et]=ar,lt=et;else break e}}return Nt}function l(bt,Nt){var ar=bt.sortIndex-Nt.sortIndex;return ar!==0?ar:bt.id-Nt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var d=Date,a=d.now();e.unstable_now=function(){return d.now()-a}}var v=[],x=[],b=1,I=null,M=3,L=!1,U=!1,R=!1,H=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function J(bt){for(var Nt=r(x);Nt!==null;){if(Nt.callback===null)n(x);else if(Nt.startTime<=bt)n(x),Nt.sortIndex=Nt.expirationTime,t(v,Nt);else break;Nt=r(x)}}function se(bt){if(R=!1,J(bt),!U)if(r(v)!==null)U=!0,Ut(ye);else{var Nt=r(x);Nt!==null&&jt(se,Nt.startTime-bt)}}function ye(bt,Nt){U=!1,R&&(R=!1,q(De),De=-1),L=!0;var ar=M;try{for(J(Nt),I=r(v);I!==null&&(!(I.expirationTime>Nt)||bt&&!_e());){var lt=I.callback;if(typeof lt=="function"){I.callback=null,M=I.priorityLevel;var ie=lt(I.expirationTime<=Nt);Nt=e.unstable_now(),typeof ie=="function"?I.callback=ie:I===r(v)&&n(v),J(Nt)}else n(v);I=r(v)}if(I!==null)var Le=!0;else{var Fe=r(x);Fe!==null&&jt(se,Fe.startTime-Nt),Le=!1}return Le}finally{I=null,M=ar,L=!1}}var Se=!1,Be=null,De=-1,we=5,nt=-1;function _e(){return!(e.unstable_now()-nt<we)}function Ie(){if(Be!==null){var bt=e.unstable_now();nt=bt;var Nt=!0;try{Nt=Be(!0,bt)}finally{Nt?Ze():(Se=!1,Be=null)}}else Se=!1}var Ze;if(typeof te=="function")Ze=function(){te(Ie)};else if(typeof MessageChannel<"u"){var st=new MessageChannel,Et=st.port2;st.port1.onmessage=Ie,Ze=function(){Et.postMessage(null)}}else Ze=function(){H(Ie,0)};function Ut(bt){Be=bt,Se||(Se=!0,Ze())}function jt(bt,Nt){De=H(function(){bt(e.unstable_now())},Nt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(bt){bt.callback=null},e.unstable_continueExecution=function(){U||L||(U=!0,Ut(ye))},e.unstable_forceFrameRate=function(bt){0>bt||125<bt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):we=0<bt?Math.floor(1e3/bt):5},e.unstable_getCurrentPriorityLevel=function(){return M},e.unstable_getFirstCallbackNode=function(){return r(v)},e.unstable_next=function(bt){switch(M){case 1:case 2:case 3:var Nt=3;break;default:Nt=M}var ar=M;M=Nt;try{return bt()}finally{M=ar}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(bt,Nt){switch(bt){case 1:case 2:case 3:case 4:case 5:break;default:bt=3}var ar=M;M=bt;try{return Nt()}finally{M=ar}},e.unstable_scheduleCallback=function(bt,Nt,ar){var lt=e.unstable_now();switch(typeof ar=="object"&&ar!==null?(ar=ar.delay,ar=typeof ar=="number"&&0<ar?lt+ar:lt):ar=lt,bt){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=ar+ie,bt={id:b++,callback:Nt,priorityLevel:bt,startTime:ar,expirationTime:ie,sortIndex:-1},ar>lt?(bt.sortIndex=ar,t(x,bt),r(v)===null&&bt===r(x)&&(R?(q(De),De=-1):R=!0,jt(se,ar-lt))):(bt.sortIndex=ie,t(v,bt),U||L||(U=!0,Ut(ye))),bt},e.unstable_shouldYield=_e,e.unstable_wrapCallback=function(bt){var Nt=M;return function(){var ar=M;M=Nt;try{return bt.apply(this,arguments)}finally{M=ar}}}}(RB)),RB}var AM;function wq(){return AM||(AM=1,DB.exports=xq()),DB.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dM;function bq(){if(dM)return Tf;dM=1;var e=hv(),t=wq();function r(y){for(var B="https://reactjs.org/docs/error-decoder.html?invariant="+y,O=1;O<arguments.length;O++)B+="&args[]="+encodeURIComponent(arguments[O]);return"Minified React error #"+y+"; visit "+B+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,l={};function u(y,B){d(y,B),d(y+"Capture",B)}function d(y,B){for(l[y]=B,y=0;y<B.length;y++)n.add(B[y])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),v=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b={},I={};function M(y){return v.call(I,y)?!0:v.call(b,y)?!1:x.test(y)?I[y]=!0:(b[y]=!0,!1)}function L(y,B,O,G){if(O!==null&&O.type===0)return!1;switch(typeof B){case"function":case"symbol":return!0;case"boolean":return G?!1:O!==null?!O.acceptsBooleans:(y=y.toLowerCase().slice(0,5),y!=="data-"&&y!=="aria-");default:return!1}}function U(y,B,O,G){if(B===null||typeof B>"u"||L(y,B,O,G))return!0;if(G)return!1;if(O!==null)switch(O.type){case 3:return!B;case 4:return B===!1;case 5:return isNaN(B);case 6:return isNaN(B)||1>B}return!1}function R(y,B,O,G,re,de,We){this.acceptsBooleans=B===2||B===3||B===4,this.attributeName=G,this.attributeNamespace=re,this.mustUseProperty=O,this.propertyName=y,this.type=B,this.sanitizeURL=de,this.removeEmptyString=We}var H={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(y){H[y]=new R(y,0,!1,y,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(y){var B=y[0];H[B]=new R(B,1,!1,y[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(y){H[y]=new R(y,2,!1,y.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(y){H[y]=new R(y,2,!1,y,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(y){H[y]=new R(y,3,!1,y.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(y){H[y]=new R(y,3,!0,y,null,!1,!1)}),["capture","download"].forEach(function(y){H[y]=new R(y,4,!1,y,null,!1,!1)}),["cols","rows","size","span"].forEach(function(y){H[y]=new R(y,6,!1,y,null,!1,!1)}),["rowSpan","start"].forEach(function(y){H[y]=new R(y,5,!1,y.toLowerCase(),null,!1,!1)});var q=/[\-:]([a-z])/g;function te(y){return y[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(y){var B=y.replace(q,te);H[B]=new R(B,1,!1,y,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(y){var B=y.replace(q,te);H[B]=new R(B,1,!1,y,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(y){var B=y.replace(q,te);H[B]=new R(B,1,!1,y,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(y){H[y]=new R(y,1,!1,y.toLowerCase(),null,!1,!1)}),H.xlinkHref=new R("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(y){H[y]=new R(y,1,!1,y.toLowerCase(),null,!0,!0)});function J(y,B,O,G){var re=H.hasOwnProperty(B)?H[B]:null;(re!==null?re.type!==0:G||!(2<B.length)||B[0]!=="o"&&B[0]!=="O"||B[1]!=="n"&&B[1]!=="N")&&(U(B,O,re,G)&&(O=null),G||re===null?M(B)&&(O===null?y.removeAttribute(B):y.setAttribute(B,""+O)):re.mustUseProperty?y[re.propertyName]=O===null?re.type===3?!1:"":O:(B=re.attributeName,G=re.attributeNamespace,O===null?y.removeAttribute(B):(re=re.type,O=re===3||re===4&&O===!0?"":""+O,G?y.setAttributeNS(G,B,O):y.setAttribute(B,O))))}var se=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ye=Symbol.for("react.element"),Se=Symbol.for("react.portal"),Be=Symbol.for("react.fragment"),De=Symbol.for("react.strict_mode"),we=Symbol.for("react.profiler"),nt=Symbol.for("react.provider"),_e=Symbol.for("react.context"),Ie=Symbol.for("react.forward_ref"),Ze=Symbol.for("react.suspense"),st=Symbol.for("react.suspense_list"),Et=Symbol.for("react.memo"),Ut=Symbol.for("react.lazy"),jt=Symbol.for("react.offscreen"),bt=Symbol.iterator;function Nt(y){return y===null||typeof y!="object"?null:(y=bt&&y[bt]||y["@@iterator"],typeof y=="function"?y:null)}var ar=Object.assign,lt;function ie(y){if(lt===void 0)try{throw Error()}catch(O){var B=O.stack.trim().match(/\n( *(at )?)/);lt=B&&B[1]||""}return`
`+lt+y}var Le=!1;function Fe(y,B){if(!y||Le)return"";Le=!0;var O=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(B)if(B=function(){throw Error()},Object.defineProperty(B.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(B,[])}catch(Or){var G=Or}Reflect.construct(y,[],B)}else{try{B.call()}catch(Or){G=Or}y.call(B.prototype)}else{try{throw Error()}catch(Or){G=Or}y()}}catch(Or){if(Or&&G&&typeof Or.stack=="string"){for(var re=Or.stack.split(`
`),de=G.stack.split(`
`),We=re.length-1,Lt=de.length-1;1<=We&&0<=Lt&&re[We]!==de[Lt];)Lt--;for(;1<=We&&0<=Lt;We--,Lt--)if(re[We]!==de[Lt]){if(We!==1||Lt!==1)do if(We--,Lt--,0>Lt||re[We]!==de[Lt]){var qt=`
`+re[We].replace(" at new "," at ");return y.displayName&&qt.includes("<anonymous>")&&(qt=qt.replace("<anonymous>",y.displayName)),qt}while(1<=We&&0<=Lt);break}}}finally{Le=!1,Error.prepareStackTrace=O}return(y=y?y.displayName||y.name:"")?ie(y):""}function Re(y){switch(y.tag){case 5:return ie(y.type);case 16:return ie("Lazy");case 13:return ie("Suspense");case 19:return ie("SuspenseList");case 0:case 2:case 15:return y=Fe(y.type,!1),y;case 11:return y=Fe(y.type.render,!1),y;case 1:return y=Fe(y.type,!0),y;default:return""}}function et(y){if(y==null)return null;if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y;switch(y){case Be:return"Fragment";case Se:return"Portal";case we:return"Profiler";case De:return"StrictMode";case Ze:return"Suspense";case st:return"SuspenseList"}if(typeof y=="object")switch(y.$$typeof){case _e:return(y.displayName||"Context")+".Consumer";case nt:return(y._context.displayName||"Context")+".Provider";case Ie:var B=y.render;return y=y.displayName,y||(y=B.displayName||B.name||"",y=y!==""?"ForwardRef("+y+")":"ForwardRef"),y;case Et:return B=y.displayName||null,B!==null?B:et(y.type)||"Memo";case Ut:B=y._payload,y=y._init;try{return et(y(B))}catch{}}return null}function xt(y){var B=y.type;switch(y.tag){case 24:return"Cache";case 9:return(B.displayName||"Context")+".Consumer";case 10:return(B._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return y=B.render,y=y.displayName||y.name||"",B.displayName||(y!==""?"ForwardRef("+y+")":"ForwardRef");case 7:return"Fragment";case 5:return B;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return et(B);case 8:return B===De?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof B=="function")return B.displayName||B.name||null;if(typeof B=="string")return B}return null}function Dt(y){switch(typeof y){case"boolean":case"number":case"string":case"undefined":return y;case"object":return y;default:return""}}function pt(y){var B=y.type;return(y=y.nodeName)&&y.toLowerCase()==="input"&&(B==="checkbox"||B==="radio")}function Ct(y){var B=pt(y)?"checked":"value",O=Object.getOwnPropertyDescriptor(y.constructor.prototype,B),G=""+y[B];if(!y.hasOwnProperty(B)&&typeof O<"u"&&typeof O.get=="function"&&typeof O.set=="function"){var re=O.get,de=O.set;return Object.defineProperty(y,B,{configurable:!0,get:function(){return re.call(this)},set:function(We){G=""+We,de.call(this,We)}}),Object.defineProperty(y,B,{enumerable:O.enumerable}),{getValue:function(){return G},setValue:function(We){G=""+We},stopTracking:function(){y._valueTracker=null,delete y[B]}}}}function mr(y){y._valueTracker||(y._valueTracker=Ct(y))}function Zt(y){if(!y)return!1;var B=y._valueTracker;if(!B)return!0;var O=B.getValue(),G="";return y&&(G=pt(y)?y.checked?"true":"false":y.value),y=G,y!==O?(B.setValue(y),!0):!1}function sn(y){if(y=y||(typeof document<"u"?document:void 0),typeof y>"u")return null;try{return y.activeElement||y.body}catch{return y.body}}function er(y,B){var O=B.checked;return ar({},B,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:O??y._wrapperState.initialChecked})}function mt(y,B){var O=B.defaultValue==null?"":B.defaultValue,G=B.checked!=null?B.checked:B.defaultChecked;O=Dt(B.value!=null?B.value:O),y._wrapperState={initialChecked:G,initialValue:O,controlled:B.type==="checkbox"||B.type==="radio"?B.checked!=null:B.value!=null}}function En(y,B){B=B.checked,B!=null&&J(y,"checked",B,!1)}function $r(y,B){En(y,B);var O=Dt(B.value),G=B.type;if(O!=null)G==="number"?(O===0&&y.value===""||y.value!=O)&&(y.value=""+O):y.value!==""+O&&(y.value=""+O);else if(G==="submit"||G==="reset"){y.removeAttribute("value");return}B.hasOwnProperty("value")?an(y,B.type,O):B.hasOwnProperty("defaultValue")&&an(y,B.type,Dt(B.defaultValue)),B.checked==null&&B.defaultChecked!=null&&(y.defaultChecked=!!B.defaultChecked)}function zn(y,B,O){if(B.hasOwnProperty("value")||B.hasOwnProperty("defaultValue")){var G=B.type;if(!(G!=="submit"&&G!=="reset"||B.value!==void 0&&B.value!==null))return;B=""+y._wrapperState.initialValue,O||B===y.value||(y.value=B),y.defaultValue=B}O=y.name,O!==""&&(y.name=""),y.defaultChecked=!!y._wrapperState.initialChecked,O!==""&&(y.name=O)}function an(y,B,O){(B!=="number"||sn(y.ownerDocument)!==y)&&(O==null?y.defaultValue=""+y._wrapperState.initialValue:y.defaultValue!==""+O&&(y.defaultValue=""+O))}var Pn=Array.isArray;function yn(y,B,O,G){if(y=y.options,B){B={};for(var re=0;re<O.length;re++)B["$"+O[re]]=!0;for(O=0;O<y.length;O++)re=B.hasOwnProperty("$"+y[O].value),y[O].selected!==re&&(y[O].selected=re),re&&G&&(y[O].defaultSelected=!0)}else{for(O=""+Dt(O),B=null,re=0;re<y.length;re++){if(y[re].value===O){y[re].selected=!0,G&&(y[re].defaultSelected=!0);return}B!==null||y[re].disabled||(B=y[re])}B!==null&&(B.selected=!0)}}function Ci(y,B){if(B.dangerouslySetInnerHTML!=null)throw Error(r(91));return ar({},B,{value:void 0,defaultValue:void 0,children:""+y._wrapperState.initialValue})}function Zn(y,B){var O=B.value;if(O==null){if(O=B.children,B=B.defaultValue,O!=null){if(B!=null)throw Error(r(92));if(Pn(O)){if(1<O.length)throw Error(r(93));O=O[0]}B=O}B==null&&(B=""),O=B}y._wrapperState={initialValue:Dt(O)}}function Vi(y,B){var O=Dt(B.value),G=Dt(B.defaultValue);O!=null&&(O=""+O,O!==y.value&&(y.value=O),B.defaultValue==null&&y.defaultValue!==O&&(y.defaultValue=O)),G!=null&&(y.defaultValue=""+G)}function Ti(y){var B=y.textContent;B===y._wrapperState.initialValue&&B!==""&&B!==null&&(y.value=B)}function ui(y){switch(y){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ta(y,B){return y==null||y==="http://www.w3.org/1999/xhtml"?ui(B):y==="http://www.w3.org/2000/svg"&&B==="foreignObject"?"http://www.w3.org/1999/xhtml":y}var bi,ti=function(y){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(B,O,G,re){MSApp.execUnsafeLocalFunction(function(){return y(B,O,G,re)})}:y}(function(y,B){if(y.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in y)y.innerHTML=B;else{for(bi=bi||document.createElement("div"),bi.innerHTML="<svg>"+B.valueOf().toString()+"</svg>",B=bi.firstChild;y.firstChild;)y.removeChild(y.firstChild);for(;B.firstChild;)y.appendChild(B.firstChild)}});function vi(y,B){if(B){var O=y.firstChild;if(O&&O===y.lastChild&&O.nodeType===3){O.nodeValue=B;return}}y.textContent=B}var Dn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ua=["Webkit","ms","Moz","O"];Object.keys(Dn).forEach(function(y){ua.forEach(function(B){B=B+y.charAt(0).toUpperCase()+y.substring(1),Dn[B]=Dn[y]})});function ca(y,B,O){return B==null||typeof B=="boolean"||B===""?"":O||typeof B!="number"||B===0||Dn.hasOwnProperty(y)&&Dn[y]?(""+B).trim():B+"px"}function Gn(y,B){y=y.style;for(var O in B)if(B.hasOwnProperty(O)){var G=O.indexOf("--")===0,re=ca(O,B[O],G);O==="float"&&(O="cssFloat"),G?y.setProperty(O,re):y[O]=re}}var Li=ar({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xa(y,B){if(B){if(Li[y]&&(B.children!=null||B.dangerouslySetInnerHTML!=null))throw Error(r(137,y));if(B.dangerouslySetInnerHTML!=null){if(B.children!=null)throw Error(r(60));if(typeof B.dangerouslySetInnerHTML!="object"||!("__html"in B.dangerouslySetInnerHTML))throw Error(r(61))}if(B.style!=null&&typeof B.style!="object")throw Error(r(62))}}function yi(y,B){if(y.indexOf("-")===-1)return typeof B.is=="string";switch(y){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nn=null;function ki(y){return y=y.target||y.srcElement||window,y.correspondingUseElement&&(y=y.correspondingUseElement),y.nodeType===3?y.parentNode:y}var oo=null,wa=null,ba=null;function Mi(y){if(y=qf(y)){if(typeof oo!="function")throw Error(r(280));var B=y.stateNode;B&&(B=$f(B),oo(y.stateNode,y.type,B))}}function Ea(y){wa?ba?ba.push(y):ba=[y]:wa=y}function hr(){if(wa){var y=wa,B=ba;if(ba=wa=null,Mi(y),B)for(y=0;y<B.length;y++)Mi(B[y])}}function Bo(y,B){return y(B)}function xc(){}var sl=!1;function _n(y,B,O){if(sl)return y(B,O);sl=!0;try{return Bo(y,B,O)}finally{sl=!1,(wa!==null||ba!==null)&&(xc(),hr())}}function Tt(y,B){var O=y.stateNode;if(O===null)return null;var G=$f(O);if(G===null)return null;O=G[B];e:switch(B){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(G=!G.disabled)||(y=y.type,G=!(y==="button"||y==="input"||y==="select"||y==="textarea")),y=!G;break e;default:y=!1}if(y)return null;if(O&&typeof O!="function")throw Error(r(231,B,typeof O));return O}var pe=!1;if(a)try{var be={};Object.defineProperty(be,"passive",{get:function(){pe=!0}}),window.addEventListener("test",be,be),window.removeEventListener("test",be,be)}catch{pe=!1}function Ve(y,B,O,G,re,de,We,Lt,qt){var Or=Array.prototype.slice.call(arguments,3);try{B.apply(O,Or)}catch(pn){this.onError(pn)}}var rt=!1,je=null,oe=!1,Ee=null,me={onError:function(y){rt=!0,je=y}};function xe(y,B,O,G,re,de,We,Lt,qt){rt=!1,je=null,Ve.apply(me,arguments)}function Ne(y,B,O,G,re,de,We,Lt,qt){if(xe.apply(this,arguments),rt){if(rt){var Or=je;rt=!1,je=null}else throw Error(r(198));oe||(oe=!0,Ee=Or)}}function Oe(y){var B=y,O=y;if(y.alternate)for(;B.return;)B=B.return;else{y=B;do B=y,(B.flags&4098)!==0&&(O=B.return),y=B.return;while(y)}return B.tag===3?O:null}function St(y){if(y.tag===13){var B=y.memoizedState;if(B===null&&(y=y.alternate,y!==null&&(B=y.memoizedState)),B!==null)return B.dehydrated}return null}function Ht(y){if(Oe(y)!==y)throw Error(r(188))}function Rt(y){var B=y.alternate;if(!B){if(B=Oe(y),B===null)throw Error(r(188));return B!==y?null:y}for(var O=y,G=B;;){var re=O.return;if(re===null)break;var de=re.alternate;if(de===null){if(G=re.return,G!==null){O=G;continue}break}if(re.child===de.child){for(de=re.child;de;){if(de===O)return Ht(re),y;if(de===G)return Ht(re),B;de=de.sibling}throw Error(r(188))}if(O.return!==G.return)O=re,G=de;else{for(var We=!1,Lt=re.child;Lt;){if(Lt===O){We=!0,O=re,G=de;break}if(Lt===G){We=!0,G=re,O=de;break}Lt=Lt.sibling}if(!We){for(Lt=de.child;Lt;){if(Lt===O){We=!0,O=de,G=re;break}if(Lt===G){We=!0,G=de,O=re;break}Lt=Lt.sibling}if(!We)throw Error(r(189))}}if(O.alternate!==G)throw Error(r(190))}if(O.tag!==3)throw Error(r(188));return O.stateNode.current===O?y:B}function Vt(y){return y=Rt(y),y!==null?Gt(y):null}function Gt(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){var B=Gt(y);if(B!==null)return B;y=y.sibling}return null}var br=t.unstable_scheduleCallback,qr=t.unstable_cancelCallback,Hr=t.unstable_shouldYield,Jr=t.unstable_requestPaint,en=t.unstable_now,Vn=t.unstable_getCurrentPriorityLevel,Kn=t.unstable_ImmediatePriority,Sn=t.unstable_UserBlockingPriority,Ii=t.unstable_NormalPriority,ha=t.unstable_LowPriority,sa=t.unstable_IdlePriority,Ya=null,Ra=null;function es(y){if(Ra&&typeof Ra.onCommitFiberRoot=="function")try{Ra.onCommitFiberRoot(Ya,y,void 0,(y.current.flags&128)===128)}catch{}}var so=Math.clz32?Math.clz32:Rf,Ss=Math.log,Co=Math.LN2;function Rf(y){return y>>>=0,y===0?32:31-(Ss(y)/Co|0)|0}var Hu=64,Ul=4194304;function wc(y){switch(y&-y){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return y&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return y}}function Cl(y,B){var O=y.pendingLanes;if(O===0)return 0;var G=0,re=y.suspendedLanes,de=y.pingedLanes,We=O&268435455;if(We!==0){var Lt=We&~re;Lt!==0?G=wc(Lt):(de&=We,de!==0&&(G=wc(de)))}else We=O&~re,We!==0?G=wc(We):de!==0&&(G=wc(de));if(G===0)return 0;if(B!==0&&B!==G&&(B&re)===0&&(re=G&-G,de=B&-B,re>=de||re===16&&(de&4194240)!==0))return B;if((G&4)!==0&&(G|=O&16),B=y.entangledLanes,B!==0)for(y=y.entanglements,B&=G;0<B;)O=31-so(B),re=1<<O,G|=y[O],B&=~re;return G}function qc(y,B){switch(y){case 1:case 2:case 4:return B+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return B+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function No(y,B){for(var O=y.suspendedLanes,G=y.pingedLanes,re=y.expirationTimes,de=y.pendingLanes;0<de;){var We=31-so(de),Lt=1<<We,qt=re[We];qt===-1?((Lt&O)===0||(Lt&G)!==0)&&(re[We]=qc(Lt,B)):qt<=B&&(y.expiredLanes|=Lt),de&=~Lt}}function fh(y){return y=y.pendingLanes&-1073741825,y!==0?y:y&1073741824?1073741824:0}function bc(){var y=Hu;return Hu<<=1,(Hu&4194240)===0&&(Hu=64),y}function Sl(y){for(var B=[],O=0;31>O;O++)B.push(y);return B}function ll(y,B,O){y.pendingLanes|=B,B!==536870912&&(y.suspendedLanes=0,y.pingedLanes=0),y=y.eventTimes,B=31-so(B),y[B]=O}function cl(y,B){var O=y.pendingLanes&~B;y.pendingLanes=B,y.suspendedLanes=0,y.pingedLanes=0,y.expiredLanes&=B,y.mutableReadLanes&=B,y.entangledLanes&=B,B=y.entanglements;var G=y.eventTimes;for(y=y.expirationTimes;0<O;){var re=31-so(O),de=1<<re;B[re]=0,G[re]=-1,y[re]=-1,O&=~de}}function Nl(y,B){var O=y.entangledLanes|=B;for(y=y.entanglements;O;){var G=31-so(O),re=1<<G;re&B|y[G]&B&&(y[G]|=B),O&=~re}}var ma=0;function $c(y){return y&=-y,1<y?4<y?(y&268435455)!==0?16:536870912:4:1}var ec,Nh,Ah,zh,hf,Vu=!1,zo=[],zl=null,ul=null,Tl=null,Hi=new Map,ff=new Map,Ec=[],Ui="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kf(y,B){switch(y){case"focusin":case"focusout":zl=null;break;case"dragenter":case"dragleave":ul=null;break;case"mouseover":case"mouseout":Tl=null;break;case"pointerover":case"pointerout":Hi.delete(B.pointerId);break;case"gotpointercapture":case"lostpointercapture":ff.delete(B.pointerId)}}function hl(y,B,O,G,re,de){return y===null||y.nativeEvent!==de?(y={blockedOn:B,domEventName:O,eventSystemFlags:G,nativeEvent:de,targetContainers:[re]},B!==null&&(B=qf(B),B!==null&&Nh(B)),y):(y.eventSystemFlags|=G,B=y.targetContainers,re!==null&&B.indexOf(re)===-1&&B.push(re),y)}function Xc(y,B,O,G,re){switch(B){case"focusin":return zl=hl(zl,y,B,O,G,re),!0;case"dragenter":return ul=hl(ul,y,B,O,G,re),!0;case"mouseover":return Tl=hl(Tl,y,B,O,G,re),!0;case"pointerover":var de=re.pointerId;return Hi.set(de,hl(Hi.get(de)||null,y,B,O,G,re)),!0;case"gotpointercapture":return de=re.pointerId,ff.set(de,hl(ff.get(de)||null,y,B,O,G,re)),!0}return!1}function Kd(y){var B=vf(y.target);if(B!==null){var O=Oe(B);if(O!==null){if(B=O.tag,B===13){if(B=St(O),B!==null){y.blockedOn=B,hf(y.priority,function(){Ah(O)});return}}else if(B===3&&O.stateNode.current.memoizedState.isDehydrated){y.blockedOn=O.tag===3?O.stateNode.containerInfo:null;return}}}y.blockedOn=null}function dh(y){if(y.blockedOn!==null)return!1;for(var B=y.targetContainers;0<B.length;){var O=vu(y.domEventName,y.eventSystemFlags,B[0],y.nativeEvent);if(O===null){O=y.nativeEvent;var G=new O.constructor(O.type,O);Nn=G,O.target.dispatchEvent(G),Nn=null}else return B=qf(O),B!==null&&Nh(B),y.blockedOn=O,!1;B.shift()}return!0}function Zc(y,B,O){dh(y)&&O.delete(B)}function _u(){Vu=!1,zl!==null&&dh(zl)&&(zl=null),ul!==null&&dh(ul)&&(ul=null),Tl!==null&&dh(Tl)&&(Tl=null),Hi.forEach(Zc),ff.forEach(Zc)}function tc(y,B){y.blockedOn===B&&(y.blockedOn=null,Vu||(Vu=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,_u)))}function Gu(y){function B(re){return tc(re,y)}if(0<zo.length){tc(zo[0],y);for(var O=1;O<zo.length;O++){var G=zo[O];G.blockedOn===y&&(G.blockedOn=null)}}for(zl!==null&&tc(zl,y),ul!==null&&tc(ul,y),Tl!==null&&tc(Tl,y),Hi.forEach(B),ff.forEach(B),O=0;O<Ec.length;O++)G=Ec[O],G.blockedOn===y&&(G.blockedOn=null);for(;0<Ec.length&&(O=Ec[0],O.blockedOn===null);)Kd(O),O.blockedOn===null&&Ec.shift()}var Bc=se.ReactCurrentBatchConfig,Uf=!0;function ph(y,B,O,G){var re=ma,de=Bc.transition;Bc.transition=null;try{ma=1,mh(y,B,O,G)}finally{ma=re,Bc.transition=de}}function Ku(y,B,O,G){var re=ma,de=Bc.transition;Bc.transition=null;try{ma=4,mh(y,B,O,G)}finally{ma=re,Bc.transition=de}}function mh(y,B,O,G){if(Uf){var re=vu(y,B,O,G);if(re===null)MA(y,B,G,Cc,O),kf(y,G);else if(Xc(re,y,B,O,G))G.stopPropagation();else if(kf(y,G),B&4&&-1<Ui.indexOf(y)){for(;re!==null;){var de=qf(re);if(de!==null&&ec(de),de=vu(y,B,O,G),de===null&&MA(y,B,G,Cc,O),de===re)break;re=de}re!==null&&G.stopPropagation()}else MA(y,B,G,null,O)}}var Cc=null;function vu(y,B,O,G){if(Cc=null,y=ki(G),y=vf(y),y!==null)if(B=Oe(y),B===null)y=null;else if(O=B.tag,O===13){if(y=St(B),y!==null)return y;y=null}else if(O===3){if(B.stateNode.current.memoizedState.isDehydrated)return B.tag===3?B.stateNode.containerInfo:null;y=null}else B!==y&&(y=null);return Cc=y,null}function rc(y){switch(y){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vn()){case Kn:return 1;case Sn:return 4;case Ii:case ha:return 16;case sa:return 536870912;default:return 16}default:return 16}}var ts=null,Wu=null,gh=null;function yu(){if(gh)return gh;var y,B=Wu,O=B.length,G,re="value"in ts?ts.value:ts.textContent,de=re.length;for(y=0;y<O&&B[y]===re[y];y++);var We=O-y;for(G=1;G<=We&&B[O-G]===re[de-G];G++);return gh=re.slice(y,1<G?1-G:void 0)}function fo(y){var B=y.keyCode;return"charCode"in y?(y=y.charCode,y===0&&B===13&&(y=13)):y=B,y===10&&(y=13),32<=y||y===13?y:0}function nc(){return!0}function ne(){return!1}function ze(y){function B(O,G,re,de,We){this._reactName=O,this._targetInst=re,this.type=G,this.nativeEvent=de,this.target=We,this.currentTarget=null;for(var Lt in y)y.hasOwnProperty(Lt)&&(O=y[Lt],this[Lt]=O?O(de):de[Lt]);return this.isDefaultPrevented=(de.defaultPrevented!=null?de.defaultPrevented:de.returnValue===!1)?nc:ne,this.isPropagationStopped=ne,this}return ar(B.prototype,{preventDefault:function(){this.defaultPrevented=!0;var O=this.nativeEvent;O&&(O.preventDefault?O.preventDefault():typeof O.returnValue!="unknown"&&(O.returnValue=!1),this.isDefaultPrevented=nc)},stopPropagation:function(){var O=this.nativeEvent;O&&(O.stopPropagation?O.stopPropagation():typeof O.cancelBubble!="unknown"&&(O.cancelBubble=!0),this.isPropagationStopped=nc)},persist:function(){},isPersistent:nc}),B}var ft={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(y){return y.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qt=ze(ft),sr=ar({},ft,{view:0,detail:0}),Xr=ze(sr),tr,ri,Yn,Bi=ar({},sr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yc,button:0,buttons:0,relatedTarget:function(y){return y.relatedTarget===void 0?y.fromElement===y.srcElement?y.toElement:y.fromElement:y.relatedTarget},movementX:function(y){return"movementX"in y?y.movementX:(y!==Yn&&(Yn&&y.type==="mousemove"?(tr=y.screenX-Yn.screenX,ri=y.screenY-Yn.screenY):ri=tr=0,Yn=y),tr)},movementY:function(y){return"movementY"in y?y.movementY:ri}}),Si=ze(Bi),Ga=ar({},Bi,{dataTransfer:0}),xo=ze(Ga),Yr=ar({},sr,{relatedTarget:0}),Un=ze(Yr),oi=ar({},ft,{animationName:0,elapsedTime:0,pseudoElement:0}),Ka=ze(oi),Qo=ar({},ft,{clipboardData:function(y){return"clipboardData"in y?y.clipboardData:window.clipboardData}}),Oi=ze(Qo),qu=ar({},ft,{data:0}),Af=ze(qu),df={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},os={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cd(y){var B=this.nativeEvent;return B.getModifierState?B.getModifierState(y):(y=Qa[y])?!!B[y]:!1}function Yc(){return cd}var ic=ar({},sr,{key:function(y){if(y.key){var B=df[y.key]||y.key;if(B!=="Unidentified")return B}return y.type==="keypress"?(y=fo(y),y===13?"Enter":String.fromCharCode(y)):y.type==="keydown"||y.type==="keyup"?os[y.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yc,charCode:function(y){return y.type==="keypress"?fo(y):0},keyCode:function(y){return y.type==="keydown"||y.type==="keyup"?y.keyCode:0},which:function(y){return y.type==="keypress"?fo(y):y.type==="keydown"||y.type==="keyup"?y.keyCode:0}}),_s=ze(ic),xu=ar({},Bi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sc=ze(xu),Qh=ar({},sr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yc}),zs=ze(Qh),ss=ar({},ft,{propertyName:0,elapsedTime:0,pseudoElement:0}),fl=ze(ss),wu=ar({},Bi,{deltaX:function(y){return"deltaX"in y?y.deltaX:"wheelDeltaX"in y?-y.wheelDeltaX:0},deltaY:function(y){return"deltaY"in y?y.deltaY:"wheelDeltaY"in y?-y.wheelDeltaY:"wheelDelta"in y?-y.wheelDelta:0},deltaZ:0,deltaMode:0}),Xn=ze(wu),Rr=[9,13,27,32],jo=a&&"CompositionEvent"in window,bn=null;a&&"documentMode"in document&&(bn=document.documentMode);var Ao=a&&"TextEvent"in window&&!bn,Jc=a&&(!jo||bn&&8<bn&&11>=bn),xn=" ",Qs=!1;function js(y,B){switch(y){case"keyup":return Rr.indexOf(B.keyCode)!==-1;case"keydown":return B.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ac(y){return y=y.detail,typeof y=="object"&&"data"in y?y.data:null}var Ql=!1;function Zs(y,B){switch(y){case"compositionend":return ac(B);case"keypress":return B.which!==32?null:(Qs=!0,xn);case"textInput":return y=B.data,y===xn&&Qs?null:y;default:return null}}function Hs(y,B){if(Ql)return y==="compositionend"||!jo&&js(y,B)?(y=yu(),gh=Wu=ts=null,Ql=!1,y):null;switch(y){case"paste":return null;case"keypress":if(!(B.ctrlKey||B.altKey||B.metaKey)||B.ctrlKey&&B.altKey){if(B.char&&1<B.char.length)return B.char;if(B.which)return String.fromCharCode(B.which)}return null;case"compositionend":return Jc&&B.locale!=="ko"?null:B.data;default:return null}}var bu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fa(y){var B=y&&y.nodeName&&y.nodeName.toLowerCase();return B==="input"?!!bu[y.type]:B==="textarea"}function EA(y,B,O,G){Ea(G),B=Gf(B,"onChange"),0<B.length&&(O=new Qt("onChange","change",null,O,G),y.push({event:O,listeners:B}))}var ls=null,lo=null;function _h(y){PA(y,0)}function pf(y){var B=Gh(y);if(Zt(B))return y}function BA(y,B){if(y==="change")return B}var Tc=!1;if(a){var Ic;if(a){var oc="oninput"in document;if(!oc){var sc=document.createElement("div");sc.setAttribute("oninput","return;"),oc=typeof sc.oninput=="function"}Ic=oc}else Ic=!1;Tc=Ic&&(!document.documentMode||9<document.documentMode)}function Nf(){ls&&(ls.detachEvent("onpropertychange",Il),lo=ls=null)}function Il(y){if(y.propertyName==="value"&&pf(lo)){var B=[];EA(B,lo,y,ki(y)),_n(_h,B)}}function Eu(y,B,O){y==="focusin"?(Nf(),ls=B,lo=O,ls.attachEvent("onpropertychange",Il)):y==="focusout"&&Nf()}function Wa(y){if(y==="selectionchange"||y==="keyup"||y==="keydown")return pf(lo)}function Mo(y,B){if(y==="click")return pf(B)}function vs(y,B){if(y==="input"||y==="change")return pf(B)}function Ts(y,B){return y===B&&(y!==0||1/y===1/B)||y!==y&&B!==B}var Vs=typeof Object.is=="function"?Object.is:Ts;function $u(y,B){if(Vs(y,B))return!0;if(typeof y!="object"||y===null||typeof B!="object"||B===null)return!1;var O=Object.keys(y),G=Object.keys(B);if(O.length!==G.length)return!1;for(G=0;G<O.length;G++){var re=O[G];if(!v.call(B,re)||!Vs(y[re],B[re]))return!1}return!0}function eu(y){for(;y&&y.firstChild;)y=y.firstChild;return y}function tu(y,B){var O=eu(y);y=0;for(var G;O;){if(O.nodeType===3){if(G=y+O.textContent.length,y<=B&&G>=B)return{node:O,offset:B-y};y=G}e:{for(;O;){if(O.nextSibling){O=O.nextSibling;break e}O=O.parentNode}O=void 0}O=eu(O)}}function Wd(y,B){return y&&B?y===B?!0:y&&y.nodeType===3?!1:B&&B.nodeType===3?Wd(y,B.parentNode):"contains"in y?y.contains(B):y.compareDocumentPosition?!!(y.compareDocumentPosition(B)&16):!1:!1}function qd(){for(var y=window,B=sn();B instanceof y.HTMLIFrameElement;){try{var O=typeof B.contentWindow.location.href=="string"}catch{O=!1}if(O)y=B.contentWindow;else break;B=sn(y.document)}return B}function zf(y){var B=y&&y.nodeName&&y.nodeName.toLowerCase();return B&&(B==="input"&&(y.type==="text"||y.type==="search"||y.type==="tel"||y.type==="url"||y.type==="password")||B==="textarea"||y.contentEditable==="true")}function jh(y){var B=qd(),O=y.focusedElem,G=y.selectionRange;if(B!==O&&O&&O.ownerDocument&&Wd(O.ownerDocument.documentElement,O)){if(G!==null&&zf(O)){if(B=G.start,y=G.end,y===void 0&&(y=B),"selectionStart"in O)O.selectionStart=B,O.selectionEnd=Math.min(y,O.value.length);else if(y=(B=O.ownerDocument||document)&&B.defaultView||window,y.getSelection){y=y.getSelection();var re=O.textContent.length,de=Math.min(G.start,re);G=G.end===void 0?de:Math.min(G.end,re),!y.extend&&de>G&&(re=G,G=de,de=re),re=tu(O,de);var We=tu(O,G);re&&We&&(y.rangeCount!==1||y.anchorNode!==re.node||y.anchorOffset!==re.offset||y.focusNode!==We.node||y.focusOffset!==We.offset)&&(B=B.createRange(),B.setStart(re.node,re.offset),y.removeAllRanges(),de>G?(y.addRange(B),y.extend(We.node,We.offset)):(B.setEnd(We.node,We.offset),y.addRange(B)))}}for(B=[],y=O;y=y.parentNode;)y.nodeType===1&&B.push({element:y,left:y.scrollLeft,top:y.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<B.length;O++)y=B[O],y.element.scrollLeft=y.left,y.element.scrollTop=y.top}}var CA=a&&"documentMode"in document&&11>=document.documentMode,Al=null,SA=null,Xu=null,Hh=!1;function ud(y,B,O){var G=O.window===O?O.document:O.nodeType===9?O:O.ownerDocument;Hh||Al==null||Al!==sn(G)||(G=Al,"selectionStart"in G&&zf(G)?G={start:G.selectionStart,end:G.selectionEnd}:(G=(G.ownerDocument&&G.ownerDocument.defaultView||window).getSelection(),G={anchorNode:G.anchorNode,anchorOffset:G.anchorOffset,focusNode:G.focusNode,focusOffset:G.focusOffset}),Xu&&$u(Xu,G)||(Xu=G,G=Gf(SA,"onSelect"),0<G.length&&(B=new Qt("onSelect","select",null,B,O),y.push({event:B,listeners:G}),B.target=Al)))}function mf(y,B){var O={};return O[y.toLowerCase()]=B.toLowerCase(),O["Webkit"+y]="webkit"+B,O["Moz"+y]="moz"+B,O}var Ys={animationend:mf("Animation","AnimationEnd"),animationiteration:mf("Animation","AnimationIteration"),animationstart:mf("Animation","AnimationStart"),transitionend:mf("Transition","TransitionEnd")},vh={},Lr={};a&&(Lr=document.createElement("div").style,"AnimationEvent"in window||(delete Ys.animationend.animation,delete Ys.animationiteration.animation,delete Ys.animationstart.animation),"TransitionEvent"in window||delete Ys.transitionend.transition);function Qf(y){if(vh[y])return vh[y];if(!Ys[y])return y;var B=Ys[y],O;for(O in B)if(B.hasOwnProperty(O)&&O in Lr)return vh[y]=B[O];return y}var TA=Qf("animationend"),IA=Qf("animationiteration"),jf=Qf("animationstart"),Vh=Qf("transitionend"),Fc=new Map,FA="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fl(y,B){Fc.set(y,B),u(B,[y])}for(var yh=0;yh<FA.length;yh++){var Ho=FA[yh],ai=Ho.toLowerCase(),$d=Ho[0].toUpperCase()+Ho.slice(1);Fl(ai,"on"+$d)}Fl(TA,"onAnimationEnd"),Fl(IA,"onAnimationIteration"),Fl(jf,"onAnimationStart"),Fl("dblclick","onDoubleClick"),Fl("focusin","onFocus"),Fl("focusout","onBlur"),Fl(Vh,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sm=new Set("cancel close invalid load scroll toggle".split(" ").concat(xh));function Hf(y,B,O){var G=y.type||"unknown-event";y.currentTarget=O,Ne(G,B,void 0,y),y.currentTarget=null}function PA(y,B){B=(B&4)!==0;for(var O=0;O<y.length;O++){var G=y[O],re=G.event;G=G.listeners;e:{var de=void 0;if(B)for(var We=G.length-1;0<=We;We--){var Lt=G[We],qt=Lt.instance,Or=Lt.currentTarget;if(Lt=Lt.listener,qt!==de&&re.isPropagationStopped())break e;Hf(re,Lt,Or),de=qt}else for(We=0;We<G.length;We++){if(Lt=G[We],qt=Lt.instance,Or=Lt.currentTarget,Lt=Lt.listener,qt!==de&&re.isPropagationStopped())break e;Hf(re,Lt,Or),de=qt}}}if(oe)throw y=Ee,oe=!1,Ee=null,y}function di(y,B){var O=B[Js];O===void 0&&(O=B[Js]=new Set);var G=y+"__bubble";O.has(G)||(hd(B,y,2,!1),O.add(G))}function Xd(y,B,O){var G=0;B&&(G|=4),hd(O,y,G,B)}var LA="_reactListening"+Math.random().toString(36).slice(2);function Vf(y){if(!y[LA]){y[LA]=!0,n.forEach(function(O){O!=="selectionchange"&&(Sm.has(O)||Xd(O,!1,y),Xd(O,!0,y))});var B=y.nodeType===9?y:y.ownerDocument;B===null||B[LA]||(B[LA]=!0,Xd("selectionchange",!1,B))}}function hd(y,B,O,G){switch(rc(B)){case 1:var re=ph;break;case 4:re=Ku;break;default:re=mh}O=re.bind(null,B,O,y),re=void 0,!pe||B!=="touchstart"&&B!=="touchmove"&&B!=="wheel"||(re=!0),G?re!==void 0?y.addEventListener(B,O,{capture:!0,passive:re}):y.addEventListener(B,O,!0):re!==void 0?y.addEventListener(B,O,{passive:re}):y.addEventListener(B,O,!1)}function MA(y,B,O,G,re){var de=G;if((B&1)===0&&(B&2)===0&&G!==null)e:for(;;){if(G===null)return;var We=G.tag;if(We===3||We===4){var Lt=G.stateNode.containerInfo;if(Lt===re||Lt.nodeType===8&&Lt.parentNode===re)break;if(We===4)for(We=G.return;We!==null;){var qt=We.tag;if((qt===3||qt===4)&&(qt=We.stateNode.containerInfo,qt===re||qt.nodeType===8&&qt.parentNode===re))return;We=We.return}for(;Lt!==null;){if(We=vf(Lt),We===null)return;if(qt=We.tag,qt===5||qt===6){G=de=We;continue e}Lt=Lt.parentNode}}G=G.return}_n(function(){var Or=de,pn=ki(O),wn=[];e:{var vn=Fc.get(y);if(vn!==void 0){var qn=Qt,fi=y;switch(y){case"keypress":if(fo(O)===0)break e;case"keydown":case"keyup":qn=_s;break;case"focusin":fi="focus",qn=Un;break;case"focusout":fi="blur",qn=Un;break;case"beforeblur":case"afterblur":qn=Un;break;case"click":if(O.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qn=Si;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qn=xo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qn=zs;break;case TA:case IA:case jf:qn=Ka;break;case Vh:qn=fl;break;case"scroll":qn=Xr;break;case"wheel":qn=Xn;break;case"copy":case"cut":case"paste":qn=Oi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qn=Sc}var pi=(B&4)!==0,_l=!pi&&y==="scroll",_r=pi?vn!==null?vn+"Capture":null:vn;pi=[];for(var nr=Or,Sr;nr!==null;){Sr=nr;var Bn=Sr.stateNode;if(Sr.tag===5&&Bn!==null&&(Sr=Bn,_r!==null&&(Bn=Tt(nr,_r),Bn!=null&&pi.push(fd(nr,Bn,Sr)))),_l)break;nr=nr.return}0<pi.length&&(vn=new qn(vn,fi,null,O,pn),wn.push({event:vn,listeners:pi}))}}if((B&7)===0){e:{if(vn=y==="mouseover"||y==="pointerover",qn=y==="mouseout"||y==="pointerout",vn&&O!==Nn&&(fi=O.relatedTarget||O.fromElement)&&(vf(fi)||fi[Ll]))break e;if((qn||vn)&&(vn=pn.window===pn?pn:(vn=pn.ownerDocument)?vn.defaultView||vn.parentWindow:window,qn?(fi=O.relatedTarget||O.toElement,qn=Or,fi=fi?vf(fi):null,fi!==null&&(_l=Oe(fi),fi!==_l||fi.tag!==5&&fi.tag!==6)&&(fi=null)):(qn=null,fi=Or),qn!==fi)){if(pi=Si,Bn="onMouseLeave",_r="onMouseEnter",nr="mouse",(y==="pointerout"||y==="pointerover")&&(pi=Sc,Bn="onPointerLeave",_r="onPointerEnter",nr="pointer"),_l=qn==null?vn:Gh(qn),Sr=fi==null?vn:Gh(fi),vn=new pi(Bn,nr+"leave",qn,O,pn),vn.target=_l,vn.relatedTarget=Sr,Bn=null,vf(pn)===Or&&(pi=new pi(_r,nr+"enter",fi,O,pn),pi.target=Sr,pi.relatedTarget=_l,Bn=pi),_l=Bn,qn&&fi)t:{for(pi=qn,_r=fi,nr=0,Sr=pi;Sr;Sr=Kf(Sr))nr++;for(Sr=0,Bn=_r;Bn;Bn=Kf(Bn))Sr++;for(;0<nr-Sr;)pi=Kf(pi),nr--;for(;0<Sr-nr;)_r=Kf(_r),Sr--;for(;nr--;){if(pi===_r||_r!==null&&pi===_r.alternate)break t;pi=Kf(pi),_r=Kf(_r)}pi=null}else pi=null;qn!==null&&Rp(wn,vn,qn,pi,!1),fi!==null&&_l!==null&&Rp(wn,_l,fi,pi,!0)}}e:{if(vn=Or?Gh(Or):window,qn=vn.nodeName&&vn.nodeName.toLowerCase(),qn==="select"||qn==="input"&&vn.type==="file")var Ei=BA;else if(fa(vn))if(Tc)Ei=vs;else{Ei=Wa;var $i=Eu}else(qn=vn.nodeName)&&qn.toLowerCase()==="input"&&(vn.type==="checkbox"||vn.type==="radio")&&(Ei=Mo);if(Ei&&(Ei=Ei(y,Or))){EA(wn,Ei,O,pn);break e}$i&&$i(y,vn,Or),y==="focusout"&&($i=vn._wrapperState)&&$i.controlled&&vn.type==="number"&&an(vn,"number",vn.value)}switch($i=Or?Gh(Or):window,y){case"focusin":(fa($i)||$i.contentEditable==="true")&&(Al=$i,SA=Or,Xu=null);break;case"focusout":Xu=SA=Al=null;break;case"mousedown":Hh=!0;break;case"contextmenu":case"mouseup":case"dragend":Hh=!1,ud(wn,O,pn);break;case"selectionchange":if(CA)break;case"keydown":case"keyup":ud(wn,O,pn)}var Xi;if(jo)e:{switch(y){case"compositionstart":var la="onCompositionStart";break e;case"compositionend":la="onCompositionEnd";break e;case"compositionupdate":la="onCompositionUpdate";break e}la=void 0}else Ql?js(y,O)&&(la="onCompositionEnd"):y==="keydown"&&O.keyCode===229&&(la="onCompositionStart");la&&(Jc&&O.locale!=="ko"&&(Ql||la!=="onCompositionStart"?la==="onCompositionEnd"&&Ql&&(Xi=yu()):(ts=pn,Wu="value"in ts?ts.value:ts.textContent,Ql=!0)),$i=Gf(Or,la),0<$i.length&&(la=new Af(la,y,null,O,pn),wn.push({event:la,listeners:$i}),Xi?la.data=Xi:(Xi=ac(O),Xi!==null&&(la.data=Xi)))),(Xi=Ao?Zs(y,O):Hs(y,O))&&(Or=Gf(Or,"onBeforeInput"),0<Or.length&&(pn=new Af("onBeforeInput","beforeinput",null,O,pn),wn.push({event:pn,listeners:Or}),pn.data=Xi))}PA(wn,B)})}function fd(y,B,O){return{instance:y,listener:B,currentTarget:O}}function Gf(y,B){for(var O=B+"Capture",G=[];y!==null;){var re=y,de=re.stateNode;re.tag===5&&de!==null&&(re=de,de=Tt(y,O),de!=null&&G.unshift(fd(y,de,re)),de=Tt(y,B),de!=null&&G.push(fd(y,de,re))),y=y.return}return G}function Kf(y){if(y===null)return null;do y=y.return;while(y&&y.tag!==5);return y||null}function Rp(y,B,O,G,re){for(var de=B._reactName,We=[];O!==null&&O!==G;){var Lt=O,qt=Lt.alternate,Or=Lt.stateNode;if(qt!==null&&qt===G)break;Lt.tag===5&&Or!==null&&(Lt=Or,re?(qt=Tt(O,de),qt!=null&&We.unshift(fd(O,qt,Lt))):re||(qt=Tt(O,de),qt!=null&&We.push(fd(O,qt,Lt)))),O=O.return}We.length!==0&&y.push({event:B,listeners:We})}var kp=/\r\n?/g,Zd=/\u0000|\uFFFD/g;function Yd(y){return(typeof y=="string"?y:""+y).replace(kp,`
`).replace(Zd,"")}function wh(y,B,O){if(B=Yd(B),Yd(y)!==B&&O)throw Error(r(425))}function Zu(){}var gf=null,bh=null;function _f(y,B){return y==="textarea"||y==="noscript"||typeof B.children=="string"||typeof B.children=="number"||typeof B.dangerouslySetInnerHTML=="object"&&B.dangerouslySetInnerHTML!==null&&B.dangerouslySetInnerHTML.__html!=null}var Jd=typeof setTimeout=="function"?setTimeout:void 0,ep=typeof clearTimeout=="function"?clearTimeout:void 0,Up=typeof Promise=="function"?Promise:void 0,OA=typeof queueMicrotask=="function"?queueMicrotask:typeof Up<"u"?function(y){return Up.resolve(null).then(y).catch(tp)}:Jd;function tp(y){setTimeout(function(){throw y})}function DA(y,B){var O=B,G=0;do{var re=O.nextSibling;if(y.removeChild(O),re&&re.nodeType===8)if(O=re.data,O==="/$"){if(G===0){y.removeChild(re),Gu(B);return}G--}else O!=="$"&&O!=="$?"&&O!=="$!"||G++;O=re}while(O);Gu(B)}function Pl(y){for(;y!=null;y=y.nextSibling){var B=y.nodeType;if(B===1||B===3)break;if(B===8){if(B=y.data,B==="$"||B==="$!"||B==="$?")break;if(B==="/$")return null}}return y}function lc(y){y=y.previousSibling;for(var B=0;y;){if(y.nodeType===8){var O=y.data;if(O==="$"||O==="$!"||O==="$?"){if(B===0)return y;B--}else O==="/$"&&B++}y=y.previousSibling}return null}var dl=Math.random().toString(36).slice(2),Yu="__reactFiber$"+dl,Wf="__reactProps$"+dl,Ll="__reactContainer$"+dl,Js="__reactEvents$"+dl,Tm="__reactListeners$"+dl,Np="__reactHandles$"+dl;function vf(y){var B=y[Yu];if(B)return B;for(var O=y.parentNode;O;){if(B=O[Ll]||O[Yu]){if(O=B.alternate,B.child!==null||O!==null&&O.child!==null)for(y=lc(y);y!==null;){if(O=y[Yu])return O;y=lc(y)}return B}y=O,O=y.parentNode}return null}function qf(y){return y=y[Yu]||y[Ll],!y||y.tag!==5&&y.tag!==6&&y.tag!==13&&y.tag!==3?null:y}function Gh(y){if(y.tag===5||y.tag===6)return y.stateNode;throw Error(r(33))}function $f(y){return y[Wf]||null}var Ad=[],Bu=-1;function ru(y){return{current:y}}function ka(y){0>Bu||(y.current=Ad[Bu],Ad[Bu]=null,Bu--)}function po(y,B){Bu++,Ad[Bu]=y.current,y.current=B}var nu={},Is=ru(nu),Ml=ru(!1),Fs=nu;function yf(y,B){var O=y.type.contextTypes;if(!O)return nu;var G=y.stateNode;if(G&&G.__reactInternalMemoizedUnmaskedChildContext===B)return G.__reactInternalMemoizedMaskedChildContext;var re={},de;for(de in O)re[de]=B[de];return G&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=B,y.__reactInternalMemoizedMaskedChildContext=re),re}function Ol(y){return y=y.childContextTypes,y!=null}function xf(){ka(Ml),ka(Is)}function dd(y,B,O){if(Is.current!==nu)throw Error(r(168));po(Is,B),po(Ml,O)}function pd(y,B,O){var G=y.stateNode;if(B=B.childContextTypes,typeof G.getChildContext!="function")return O;G=G.getChildContext();for(var re in G)if(!(re in B))throw Error(r(108,xt(y)||"Unknown",re));return ar({},O,G)}function Kh(y){return y=(y=y.stateNode)&&y.__reactInternalMemoizedMergedChildContext||nu,Fs=Is.current,po(Is,y),po(Ml,Ml.current),!0}function md(y,B,O){var G=y.stateNode;if(!G)throw Error(r(169));O?(y=pd(y,B,Fs),G.__reactInternalMemoizedMergedChildContext=y,ka(Ml),ka(Is),po(Is,y)):ka(Ml),po(Ml,O)}var Cu=null,wf=!1,z=!1;function W(y){Cu===null?Cu=[y]:Cu.push(y)}function ce(y){wf=!0,W(y)}function ve(){if(!z&&Cu!==null){z=!0;var y=0,B=ma;try{var O=Cu;for(ma=1;y<O.length;y++){var G=O[y];do G=G(!0);while(G!==null)}Cu=null,wf=!1}catch(re){throw Cu!==null&&(Cu=Cu.slice(y+1)),br(Kn,ve),re}finally{ma=B,z=!1}}return null}var Qe=[],qe=0,Je=null,ut=0,dt=[],vt=0,Wt=null,dr=1,yt="";function rr(y,B){Qe[qe++]=ut,Qe[qe++]=Je,Je=y,ut=B}function lr(y,B,O){dt[vt++]=dr,dt[vt++]=yt,dt[vt++]=Wt,Wt=y;var G=dr;y=yt;var re=32-so(G)-1;G&=~(1<<re),O+=1;var de=32-so(B)+re;if(30<de){var We=re-re%5;de=(G&(1<<We)-1).toString(32),G>>=We,re-=We,dr=1<<32-so(B)+re|O<<re|G,yt=de+y}else dr=1<<de|O<<re|G,yt=y}function Qr(y){y.return!==null&&(rr(y,1),lr(y,1,0))}function gr(y){for(;y===Je;)Je=Qe[--qe],Qe[qe]=null,ut=Qe[--qe],Qe[qe]=null;for(;y===Wt;)Wt=dt[--vt],dt[vt]=null,yt=dt[--vt],dt[vt]=null,dr=dt[--vt],dt[vt]=null}var Ur=null,zr=null,Gr=!1,rn=null;function ni(y,B){var O=Ma(5,null,null,0);O.elementType="DELETED",O.stateNode=B,O.return=y,B=y.deletions,B===null?(y.deletions=[O],y.flags|=16):B.push(O)}function Qn(y,B){switch(y.tag){case 5:var O=y.type;return B=B.nodeType!==1||O.toLowerCase()!==B.nodeName.toLowerCase()?null:B,B!==null?(y.stateNode=B,Ur=y,zr=Pl(B.firstChild),!0):!1;case 6:return B=y.pendingProps===""||B.nodeType!==3?null:B,B!==null?(y.stateNode=B,Ur=y,zr=null,!0):!1;case 13:return B=B.nodeType!==8?null:B,B!==null?(O=Wt!==null?{id:dr,overflow:yt}:null,y.memoizedState={dehydrated:B,treeContext:O,retryLane:1073741824},O=Ma(18,null,null,0),O.stateNode=B,O.return=y,y.child=O,Ur=y,zr=null,!0):!1;default:return!1}}function ra(y){return(y.mode&1)!==0&&(y.flags&128)===0}function si(y){if(Gr){var B=zr;if(B){var O=B;if(!Qn(y,B)){if(ra(y))throw Error(r(418));B=Pl(O.nextSibling);var G=Ur;B&&Qn(y,B)?ni(G,O):(y.flags=y.flags&-4097|2,Gr=!1,Ur=y)}}else{if(ra(y))throw Error(r(418));y.flags=y.flags&-4097|2,Gr=!1,Ur=y}}}function Fa(y){for(y=y.return;y!==null&&y.tag!==5&&y.tag!==3&&y.tag!==13;)y=y.return;Ur=y}function Vo(y){if(y!==Ur)return!1;if(!Gr)return Fa(y),Gr=!0,!1;var B;if((B=y.tag!==3)&&!(B=y.tag!==5)&&(B=y.type,B=B!=="head"&&B!=="body"&&!_f(y.type,y.memoizedProps)),B&&(B=zr)){if(ra(y))throw aa(),Error(r(418));for(;B;)ni(y,B),B=Pl(B.nextSibling)}if(Fa(y),y.tag===13){if(y=y.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));e:{for(y=y.nextSibling,B=0;y;){if(y.nodeType===8){var O=y.data;if(O==="/$"){if(B===0){zr=Pl(y.nextSibling);break e}B--}else O!=="$"&&O!=="$!"&&O!=="$?"||B++}y=y.nextSibling}zr=null}}else zr=Ur?Pl(y.stateNode.nextSibling):null;return!0}function aa(){for(var y=zr;y;)y=Pl(y.nextSibling)}function Jn(){zr=Ur=null,Gr=!1}function Tn(y){rn===null?rn=[y]:rn.push(y)}var So=se.ReactCurrentBatchConfig;function Gi(y,B,O){if(y=O.ref,y!==null&&typeof y!="function"&&typeof y!="object"){if(O._owner){if(O=O._owner,O){if(O.tag!==1)throw Error(r(309));var G=O.stateNode}if(!G)throw Error(r(147,y));var re=G,de=""+y;return B!==null&&B.ref!==null&&typeof B.ref=="function"&&B.ref._stringRef===de?B.ref:(B=function(We){var Lt=re.refs;We===null?delete Lt[de]:Lt[de]=We},B._stringRef=de,B)}if(typeof y!="string")throw Error(r(284));if(!O._owner)throw Error(r(290,y))}return y}function Ba(y,B){throw y=Object.prototype.toString.call(B),Error(r(31,y==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":y))}function To(y){var B=y._init;return B(y._payload)}function Go(y){function B(_r,nr){if(y){var Sr=_r.deletions;Sr===null?(_r.deletions=[nr],_r.flags|=16):Sr.push(nr)}}function O(_r,nr){if(!y)return null;for(;nr!==null;)B(_r,nr),nr=nr.sibling;return null}function G(_r,nr){for(_r=new Map;nr!==null;)nr.key!==null?_r.set(nr.key,nr):_r.set(nr.index,nr),nr=nr.sibling;return _r}function re(_r,nr){return _r=Gl(_r,nr),_r.index=0,_r.sibling=null,_r}function de(_r,nr,Sr){return _r.index=Sr,y?(Sr=_r.alternate,Sr!==null?(Sr=Sr.index,Sr<nr?(_r.flags|=2,nr):Sr):(_r.flags|=2,nr)):(_r.flags|=1048576,nr)}function We(_r){return y&&_r.alternate===null&&(_r.flags|=2),_r}function Lt(_r,nr,Sr,Bn){return nr===null||nr.tag!==6?(nr=lu(Sr,_r.mode,Bn),nr.return=_r,nr):(nr=re(nr,Sr),nr.return=_r,nr)}function qt(_r,nr,Sr,Bn){var Ei=Sr.type;return Ei===Be?pn(_r,nr,Sr.props.children,Bn,Sr.key):nr!==null&&(nr.elementType===Ei||typeof Ei=="object"&&Ei!==null&&Ei.$$typeof===Ut&&To(Ei)===nr.type)?(Bn=re(nr,Sr.props),Bn.ref=Gi(_r,nr,Sr),Bn.return=_r,Bn):(Bn=Rl(Sr.type,Sr.key,Sr.props,null,_r.mode,Bn),Bn.ref=Gi(_r,nr,Sr),Bn.return=_r,Bn)}function Or(_r,nr,Sr,Bn){return nr===null||nr.tag!==4||nr.stateNode.containerInfo!==Sr.containerInfo||nr.stateNode.implementation!==Sr.implementation?(nr=Lu(Sr,_r.mode,Bn),nr.return=_r,nr):(nr=re(nr,Sr.children||[]),nr.return=_r,nr)}function pn(_r,nr,Sr,Bn,Ei){return nr===null||nr.tag!==7?(nr=gl(Sr,_r.mode,Bn,Ei),nr.return=_r,nr):(nr=re(nr,Sr),nr.return=_r,nr)}function wn(_r,nr,Sr){if(typeof nr=="string"&&nr!==""||typeof nr=="number")return nr=lu(""+nr,_r.mode,Sr),nr.return=_r,nr;if(typeof nr=="object"&&nr!==null){switch(nr.$$typeof){case ye:return Sr=Rl(nr.type,nr.key,nr.props,null,_r.mode,Sr),Sr.ref=Gi(_r,null,nr),Sr.return=_r,Sr;case Se:return nr=Lu(nr,_r.mode,Sr),nr.return=_r,nr;case Ut:var Bn=nr._init;return wn(_r,Bn(nr._payload),Sr)}if(Pn(nr)||Nt(nr))return nr=gl(nr,_r.mode,Sr,null),nr.return=_r,nr;Ba(_r,nr)}return null}function vn(_r,nr,Sr,Bn){var Ei=nr!==null?nr.key:null;if(typeof Sr=="string"&&Sr!==""||typeof Sr=="number")return Ei!==null?null:Lt(_r,nr,""+Sr,Bn);if(typeof Sr=="object"&&Sr!==null){switch(Sr.$$typeof){case ye:return Sr.key===Ei?qt(_r,nr,Sr,Bn):null;case Se:return Sr.key===Ei?Or(_r,nr,Sr,Bn):null;case Ut:return Ei=Sr._init,vn(_r,nr,Ei(Sr._payload),Bn)}if(Pn(Sr)||Nt(Sr))return Ei!==null?null:pn(_r,nr,Sr,Bn,null);Ba(_r,Sr)}return null}function qn(_r,nr,Sr,Bn,Ei){if(typeof Bn=="string"&&Bn!==""||typeof Bn=="number")return _r=_r.get(Sr)||null,Lt(nr,_r,""+Bn,Ei);if(typeof Bn=="object"&&Bn!==null){switch(Bn.$$typeof){case ye:return _r=_r.get(Bn.key===null?Sr:Bn.key)||null,qt(nr,_r,Bn,Ei);case Se:return _r=_r.get(Bn.key===null?Sr:Bn.key)||null,Or(nr,_r,Bn,Ei);case Ut:var $i=Bn._init;return qn(_r,nr,Sr,$i(Bn._payload),Ei)}if(Pn(Bn)||Nt(Bn))return _r=_r.get(Sr)||null,pn(nr,_r,Bn,Ei,null);Ba(nr,Bn)}return null}function fi(_r,nr,Sr,Bn){for(var Ei=null,$i=null,Xi=nr,la=nr=0,hc=null;Xi!==null&&la<Sr.length;la++){Xi.index>la?(hc=Xi,Xi=null):hc=Xi.sibling;var _o=vn(_r,Xi,Sr[la],Bn);if(_o===null){Xi===null&&(Xi=hc);break}y&&Xi&&_o.alternate===null&&B(_r,Xi),nr=de(_o,nr,la),$i===null?Ei=_o:$i.sibling=_o,$i=_o,Xi=hc}if(la===Sr.length)return O(_r,Xi),Gr&&rr(_r,la),Ei;if(Xi===null){for(;la<Sr.length;la++)Xi=wn(_r,Sr[la],Bn),Xi!==null&&(nr=de(Xi,nr,la),$i===null?Ei=Xi:$i.sibling=Xi,$i=Xi);return Gr&&rr(_r,la),Ei}for(Xi=G(_r,Xi);la<Sr.length;la++)hc=qn(Xi,_r,la,Sr[la],Bn),hc!==null&&(y&&hc.alternate!==null&&Xi.delete(hc.key===null?la:hc.key),nr=de(hc,nr,la),$i===null?Ei=hc:$i.sibling=hc,$i=hc);return y&&Xi.forEach(function(mp){return B(_r,mp)}),Gr&&rr(_r,la),Ei}function pi(_r,nr,Sr,Bn){var Ei=Nt(Sr);if(typeof Ei!="function")throw Error(r(150));if(Sr=Ei.call(Sr),Sr==null)throw Error(r(151));for(var $i=Ei=null,Xi=nr,la=nr=0,hc=null,_o=Sr.next();Xi!==null&&!_o.done;la++,_o=Sr.next()){Xi.index>la?(hc=Xi,Xi=null):hc=Xi.sibling;var mp=vn(_r,Xi,_o.value,Bn);if(mp===null){Xi===null&&(Xi=hc);break}y&&Xi&&mp.alternate===null&&B(_r,Xi),nr=de(mp,nr,la),$i===null?Ei=mp:$i.sibling=mp,$i=mp,Xi=hc}if(_o.done)return O(_r,Xi),Gr&&rr(_r,la),Ei;if(Xi===null){for(;!_o.done;la++,_o=Sr.next())_o=wn(_r,_o.value,Bn),_o!==null&&(nr=de(_o,nr,la),$i===null?Ei=_o:$i.sibling=_o,$i=_o);return Gr&&rr(_r,la),Ei}for(Xi=G(_r,Xi);!_o.done;la++,_o=Sr.next())_o=qn(Xi,_r,la,_o.value,Bn),_o!==null&&(y&&_o.alternate!==null&&Xi.delete(_o.key===null?la:_o.key),nr=de(_o,nr,la),$i===null?Ei=_o:$i.sibling=_o,$i=_o);return y&&Xi.forEach(function(ex){return B(_r,ex)}),Gr&&rr(_r,la),Ei}function _l(_r,nr,Sr,Bn){if(typeof Sr=="object"&&Sr!==null&&Sr.type===Be&&Sr.key===null&&(Sr=Sr.props.children),typeof Sr=="object"&&Sr!==null){switch(Sr.$$typeof){case ye:e:{for(var Ei=Sr.key,$i=nr;$i!==null;){if($i.key===Ei){if(Ei=Sr.type,Ei===Be){if($i.tag===7){O(_r,$i.sibling),nr=re($i,Sr.props.children),nr.return=_r,_r=nr;break e}}else if($i.elementType===Ei||typeof Ei=="object"&&Ei!==null&&Ei.$$typeof===Ut&&To(Ei)===$i.type){O(_r,$i.sibling),nr=re($i,Sr.props),nr.ref=Gi(_r,$i,Sr),nr.return=_r,_r=nr;break e}O(_r,$i);break}else B(_r,$i);$i=$i.sibling}Sr.type===Be?(nr=gl(Sr.props.children,_r.mode,Bn,Sr.key),nr.return=_r,_r=nr):(Bn=Rl(Sr.type,Sr.key,Sr.props,null,_r.mode,Bn),Bn.ref=Gi(_r,nr,Sr),Bn.return=_r,_r=Bn)}return We(_r);case Se:e:{for($i=Sr.key;nr!==null;){if(nr.key===$i)if(nr.tag===4&&nr.stateNode.containerInfo===Sr.containerInfo&&nr.stateNode.implementation===Sr.implementation){O(_r,nr.sibling),nr=re(nr,Sr.children||[]),nr.return=_r,_r=nr;break e}else{O(_r,nr);break}else B(_r,nr);nr=nr.sibling}nr=Lu(Sr,_r.mode,Bn),nr.return=_r,_r=nr}return We(_r);case Ut:return $i=Sr._init,_l(_r,nr,$i(Sr._payload),Bn)}if(Pn(Sr))return fi(_r,nr,Sr,Bn);if(Nt(Sr))return pi(_r,nr,Sr,Bn);Ba(_r,Sr)}return typeof Sr=="string"&&Sr!==""||typeof Sr=="number"?(Sr=""+Sr,nr!==null&&nr.tag===6?(O(_r,nr.sibling),nr=re(nr,Sr),nr.return=_r,_r=nr):(O(_r,nr),nr=lu(Sr,_r.mode,Bn),nr.return=_r,_r=nr),We(_r)):O(_r,nr)}return _l}var ys=Go(!0),Ko=Go(!1),Wo=ru(null),Ps=null,ro=null,Pa=null;function La(){Pa=ro=Ps=null}function wo(y){var B=Wo.current;ka(Wo),y._currentValue=B}function qa(y,B,O){for(;y!==null;){var G=y.alternate;if((y.childLanes&B)!==B?(y.childLanes|=B,G!==null&&(G.childLanes|=B)):G!==null&&(G.childLanes&B)!==B&&(G.childLanes|=B),y===O)break;y=y.return}}function cs(y,B){Ps=y,Pa=ro=null,y=y.dependencies,y!==null&&y.firstContext!==null&&((y.lanes&B)!==0&&(tl=!0),y.firstContext=null)}function rs(y){var B=y._currentValue;if(Pa!==y)if(y={context:y,memoizedValue:B,next:null},ro===null){if(Ps===null)throw Error(r(308));ro=y,Ps.dependencies={lanes:0,firstContext:y}}else ro=ro.next=y;return B}var ja=null;function Gs(y){ja===null?ja=[y]:ja.push(y)}function Mr(y,B,O,G){var re=B.interleaved;return re===null?(O.next=O,Gs(B)):(O.next=re.next,re.next=O),B.interleaved=O,co(y,G)}function co(y,B){y.lanes|=B;var O=y.alternate;for(O!==null&&(O.lanes|=B),O=y,y=y.return;y!==null;)y.childLanes|=B,O=y.alternate,O!==null&&(O.childLanes|=B),O=y,y=y.return;return O.tag===3?O.stateNode:null}var ns=!1;function qo(y){y.updateQueue={baseState:y.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bo(y,B){y=y.updateQueue,B.updateQueue===y&&(B.updateQueue={baseState:y.baseState,firstBaseUpdate:y.firstBaseUpdate,lastBaseUpdate:y.lastBaseUpdate,shared:y.shared,effects:y.effects})}function hn(y,B){return{eventTime:y,lane:B,tag:0,payload:null,callback:null,next:null}}function us(y,B,O){var G=y.updateQueue;if(G===null)return null;if(G=G.shared,(S&2)!==0){var re=G.pending;return re===null?B.next=B:(B.next=re.next,re.next=B),G.pending=B,co(y,O)}return re=G.interleaved,re===null?(B.next=B,Gs(G)):(B.next=re.next,re.next=B),G.interleaved=B,co(y,O)}function jl(y,B,O){if(B=B.updateQueue,B!==null&&(B=B.shared,(O&4194240)!==0)){var G=B.lanes;G&=y.pendingLanes,O|=G,B.lanes=O,Nl(y,O)}}function Io(y,B){var O=y.updateQueue,G=y.alternate;if(G!==null&&(G=G.updateQueue,O===G)){var re=null,de=null;if(O=O.firstBaseUpdate,O!==null){do{var We={eventTime:O.eventTime,lane:O.lane,tag:O.tag,payload:O.payload,callback:O.callback,next:null};de===null?re=de=We:de=de.next=We,O=O.next}while(O!==null);de===null?re=de=B:de=de.next=B}else re=de=B;O={baseState:G.baseState,firstBaseUpdate:re,lastBaseUpdate:de,shared:G.shared,effects:G.effects},y.updateQueue=O;return}y=O.lastBaseUpdate,y===null?O.firstBaseUpdate=B:y.next=B,O.lastBaseUpdate=B}function el(y,B,O,G){var re=y.updateQueue;ns=!1;var de=re.firstBaseUpdate,We=re.lastBaseUpdate,Lt=re.shared.pending;if(Lt!==null){re.shared.pending=null;var qt=Lt,Or=qt.next;qt.next=null,We===null?de=Or:We.next=Or,We=qt;var pn=y.alternate;pn!==null&&(pn=pn.updateQueue,Lt=pn.lastBaseUpdate,Lt!==We&&(Lt===null?pn.firstBaseUpdate=Or:Lt.next=Or,pn.lastBaseUpdate=qt))}if(de!==null){var wn=re.baseState;We=0,pn=Or=qt=null,Lt=de;do{var vn=Lt.lane,qn=Lt.eventTime;if((G&vn)===vn){pn!==null&&(pn=pn.next={eventTime:qn,lane:0,tag:Lt.tag,payload:Lt.payload,callback:Lt.callback,next:null});e:{var fi=y,pi=Lt;switch(vn=B,qn=O,pi.tag){case 1:if(fi=pi.payload,typeof fi=="function"){wn=fi.call(qn,wn,vn);break e}wn=fi;break e;case 3:fi.flags=fi.flags&-65537|128;case 0:if(fi=pi.payload,vn=typeof fi=="function"?fi.call(qn,wn,vn):fi,vn==null)break e;wn=ar({},wn,vn);break e;case 2:ns=!0}}Lt.callback!==null&&Lt.lane!==0&&(y.flags|=64,vn=re.effects,vn===null?re.effects=[Lt]:vn.push(Lt))}else qn={eventTime:qn,lane:vn,tag:Lt.tag,payload:Lt.payload,callback:Lt.callback,next:null},pn===null?(Or=pn=qn,qt=wn):pn=pn.next=qn,We|=vn;if(Lt=Lt.next,Lt===null){if(Lt=re.shared.pending,Lt===null)break;vn=Lt,Lt=vn.next,vn.next=null,re.lastBaseUpdate=vn,re.shared.pending=null}}while(!0);if(pn===null&&(qt=wn),re.baseState=qt,re.firstBaseUpdate=Or,re.lastBaseUpdate=pn,B=re.shared.interleaved,B!==null){re=B;do We|=re.lane,re=re.next;while(re!==B)}else de===null&&(re.shared.lanes=0);he|=We,y.lanes=We,y.memoizedState=wn}}function cc(y,B,O){if(y=B.effects,B.effects=null,y!==null)for(B=0;B<y.length;B++){var G=y[B],re=G.callback;if(re!==null){if(G.callback=null,G=O,typeof re!="function")throw Error(r(191,re));re.call(G)}}}var Su={},Ls=ru(Su),Ms=ru(Su),bf=ru(Su);function xs(y){if(y===Su)throw Error(r(174));return y}function Ef(y,B){switch(po(bf,B),po(Ms,y),po(Ls,Su),y=B.nodeType,y){case 9:case 11:B=(B=B.documentElement)?B.namespaceURI:ta(null,"");break;default:y=y===8?B.parentNode:B,B=y.namespaceURI||null,y=y.tagName,B=ta(B,y)}ka(Ls),po(Ls,B)}function $o(){ka(Ls),ka(Ms),ka(bf)}function Wh(y){xs(bf.current);var B=xs(Ls.current),O=ta(B,y.type);B!==O&&(po(Ms,y),po(Ls,O))}function rp(y){Ms.current===y&&(ka(Ls),ka(Ms))}var Fo=ru(0);function iu(y){for(var B=y;B!==null;){if(B.tag===13){var O=B.memoizedState;if(O!==null&&(O=O.dehydrated,O===null||O.data==="$?"||O.data==="$!"))return B}else if(B.tag===19&&B.memoizedProps.revealOrder!==void 0){if((B.flags&128)!==0)return B}else if(B.child!==null){B.child.return=B,B=B.child;continue}if(B===y)break;for(;B.sibling===null;){if(B.return===null||B.return===y)return null;B=B.return}B.sibling.return=B.return,B=B.sibling}return null}var gd=[];function np(){for(var y=0;y<gd.length;y++)gd[y]._workInProgressVersionPrimary=null;gd.length=0}var au=se.ReactCurrentDispatcher,oa=se.ReactCurrentBatchConfig,Pc=0,Po=null,is=null,ws=null,Xf=!1,Hl=!1,Tu=0,Ju=0;function ur(){throw Error(r(321))}function Kr(y,B){if(B===null)return!1;for(var O=0;O<B.length&&O<y.length;O++)if(!Vs(y[O],B[O]))return!1;return!0}function Eh(y,B,O,G,re,de){if(Pc=de,Po=B,B.memoizedState=null,B.updateQueue=null,B.lanes=0,au.current=y===null||y.memoizedState===null?kA:lp,y=O(G,re),Hl){de=0;do{if(Hl=!1,Tu=0,25<=de)throw Error(r(301));de+=1,ws=is=null,B.updateQueue=null,au.current=Mm,y=O(G,re)}while(Hl)}if(au.current=Rc,B=is!==null&&is.next!==null,Pc=0,ws=is=Po=null,Xf=!1,B)throw Error(r(300));return y}function _a(){var y=Tu!==0;return Tu=0,y}function Bt(){var y={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ws===null?Po.memoizedState=ws=y:ws=ws.next=y,ws}function Lc(){if(is===null){var y=Po.alternate;y=y!==null?y.memoizedState:null}else y=is.next;var B=ws===null?Po.memoizedState:ws.next;if(B!==null)ws=B,is=y;else{if(y===null)throw Error(r(310));is=y,y={memoizedState:is.memoizedState,baseState:is.baseState,baseQueue:is.baseQueue,queue:is.queue,next:null},ws===null?Po.memoizedState=ws=y:ws=ws.next=y}return ws}function qh(y,B){return typeof B=="function"?B(y):B}function Bf(y){var B=Lc(),O=B.queue;if(O===null)throw Error(r(311));O.lastRenderedReducer=y;var G=is,re=G.baseQueue,de=O.pending;if(de!==null){if(re!==null){var We=re.next;re.next=de.next,de.next=We}G.baseQueue=re=de,O.pending=null}if(re!==null){de=re.next,G=G.baseState;var Lt=We=null,qt=null,Or=de;do{var pn=Or.lane;if((Pc&pn)===pn)qt!==null&&(qt=qt.next={lane:0,action:Or.action,hasEagerState:Or.hasEagerState,eagerState:Or.eagerState,next:null}),G=Or.hasEagerState?Or.eagerState:y(G,Or.action);else{var wn={lane:pn,action:Or.action,hasEagerState:Or.hasEagerState,eagerState:Or.eagerState,next:null};qt===null?(Lt=qt=wn,We=G):qt=qt.next=wn,Po.lanes|=pn,he|=pn}Or=Or.next}while(Or!==null&&Or!==de);qt===null?We=G:qt.next=Lt,Vs(G,B.memoizedState)||(tl=!0),B.memoizedState=G,B.baseState=We,B.baseQueue=qt,O.lastRenderedState=G}if(y=O.interleaved,y!==null){re=y;do de=re.lane,Po.lanes|=de,he|=de,re=re.next;while(re!==y)}else re===null&&(O.lanes=0);return[B.memoizedState,O.dispatch]}function ou(y){var B=Lc(),O=B.queue;if(O===null)throw Error(r(311));O.lastRenderedReducer=y;var G=O.dispatch,re=O.pending,de=B.memoizedState;if(re!==null){O.pending=null;var We=re=re.next;do de=y(de,We.action),We=We.next;while(We!==re);Vs(de,B.memoizedState)||(tl=!0),B.memoizedState=de,B.baseQueue===null&&(B.baseState=de),O.lastRenderedState=de}return[de,G]}function ip(){}function RA(y,B){var O=Po,G=Lc(),re=B(),de=!Vs(G.memoizedState,re);if(de&&(G.memoizedState=re,tl=!0),G=G.queue,_d(Im.bind(null,O,G,y),[y]),G.getSnapshot!==B||de||ws!==null&&ws.memoizedState.tag&1){if(O.flags|=2048,Mc(9,Iu.bind(null,O,G,re,B),void 0,null),F===null)throw Error(r(349));(Pc&30)!==0||Zf(O,B,re)}return re}function Zf(y,B,O){y.flags|=16384,y={getSnapshot:B,value:O},B=Po.updateQueue,B===null?(B={lastEffect:null,stores:null},Po.updateQueue=B,B.stores=[y]):(O=B.stores,O===null?B.stores=[y]:O.push(y))}function Iu(y,B,O,G){B.value=O,B.getSnapshot=G,Cf(B)&&Yf(y)}function Im(y,B,O){return O(function(){Cf(B)&&Yf(y)})}function Cf(y){var B=y.getSnapshot;y=y.value;try{var O=B();return!Vs(y,O)}catch{return!0}}function Yf(y){var B=co(y,1);B!==null&&ht(B,y,1,-1)}function Jf(y){var B=Bt();return typeof y=="function"&&(y=y()),B.memoizedState=B.baseState=y,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qh,lastRenderedState:y},B.queue=y,y=y.dispatch=kg.bind(null,Po,y),[B.memoizedState,y]}function Mc(y,B,O,G){return y={tag:y,create:B,destroy:O,deps:G,next:null},B=Po.updateQueue,B===null?(B={lastEffect:null,stores:null},Po.updateQueue=B,B.lastEffect=y.next=y):(O=B.lastEffect,O===null?B.lastEffect=y.next=y:(G=O.next,O.next=y,y.next=G,B.lastEffect=y)),y}function Bh(){return Lc().memoizedState}function Oc(y,B,O,G){var re=Bt();Po.flags|=y,re.memoizedState=Mc(1|B,O,void 0,G===void 0?null:G)}function eh(y,B,O,G){var re=Lc();G=G===void 0?null:G;var de=void 0;if(is!==null){var We=is.memoizedState;if(de=We.destroy,G!==null&&Kr(G,We.deps)){re.memoizedState=Mc(B,O,de,G);return}}Po.flags|=y,re.memoizedState=Mc(1|B,O,de,G)}function $h(y,B){return Oc(8390656,8,y,B)}function _d(y,B){return eh(2048,8,y,B)}function Fm(y,B){return eh(4,2,y,B)}function Ks(y,B){return eh(4,4,y,B)}function ap(y,B){if(typeof B=="function")return y=y(),B(y),function(){B(null)};if(B!=null)return y=y(),B.current=y,function(){B.current=null}}function op(y,B,O){return O=O!=null?O.concat([y]):null,eh(4,4,ap.bind(null,B,y),O)}function Da(){}function Di(y,B){var O=Lc();B=B===void 0?null:B;var G=O.memoizedState;return G!==null&&B!==null&&Kr(B,G[1])?G[0]:(O.memoizedState=[y,B],y)}function Pm(y,B){var O=Lc();B=B===void 0?null:B;var G=O.memoizedState;return G!==null&&B!==null&&Kr(B,G[1])?G[0]:(y=y(),O.memoizedState=[y,B],y)}function Dc(y,B,O){return(Pc&21)===0?(y.baseState&&(y.baseState=!1,tl=!0),y.memoizedState=O):(Vs(O,B)||(O=bc(),Po.lanes|=O,he|=O,y.baseState=!0),B)}function sp(y,B){var O=ma;ma=O!==0&&4>O?O:4,y(!0);var G=oa.transition;oa.transition={};try{y(!1),B()}finally{ma=O,oa.transition=G}}function vd(){return Lc().memoizedState}function yd(y,B,O){var G=It(y);if(O={lane:G,action:O,hasEagerState:!1,eagerState:null,next:null},Lm(y))zp(B,O);else if(O=Mr(y,B,O,G),O!==null){var re=pr();ht(O,y,G,re),Qp(O,B,G)}}function kg(y,B,O){var G=It(y),re={lane:G,action:O,hasEagerState:!1,eagerState:null,next:null};if(Lm(y))zp(B,re);else{var de=y.alternate;if(y.lanes===0&&(de===null||de.lanes===0)&&(de=B.lastRenderedReducer,de!==null))try{var We=B.lastRenderedState,Lt=de(We,O);if(re.hasEagerState=!0,re.eagerState=Lt,Vs(Lt,We)){var qt=B.interleaved;qt===null?(re.next=re,Gs(B)):(re.next=qt.next,qt.next=re),B.interleaved=re;return}}catch{}finally{}O=Mr(y,B,re,G),O!==null&&(re=pr(),ht(O,y,G,re),Qp(O,B,G))}}function Lm(y){var B=y.alternate;return y===Po||B!==null&&B===Po}function zp(y,B){Hl=Xf=!0;var O=y.pending;O===null?B.next=B:(B.next=O.next,O.next=B),y.pending=B}function Qp(y,B,O){if((O&4194240)!==0){var G=B.lanes;G&=y.pendingLanes,O|=G,B.lanes=O,Nl(y,O)}}var Rc={readContext:rs,useCallback:ur,useContext:ur,useEffect:ur,useImperativeHandle:ur,useInsertionEffect:ur,useLayoutEffect:ur,useMemo:ur,useReducer:ur,useRef:ur,useState:ur,useDebugValue:ur,useDeferredValue:ur,useTransition:ur,useMutableSource:ur,useSyncExternalStore:ur,useId:ur,unstable_isNewReconciler:!1},kA={readContext:rs,useCallback:function(y,B){return Bt().memoizedState=[y,B===void 0?null:B],y},useContext:rs,useEffect:$h,useImperativeHandle:function(y,B,O){return O=O!=null?O.concat([y]):null,Oc(4194308,4,ap.bind(null,B,y),O)},useLayoutEffect:function(y,B){return Oc(4194308,4,y,B)},useInsertionEffect:function(y,B){return Oc(4,2,y,B)},useMemo:function(y,B){var O=Bt();return B=B===void 0?null:B,y=y(),O.memoizedState=[y,B],y},useReducer:function(y,B,O){var G=Bt();return B=O!==void 0?O(B):B,G.memoizedState=G.baseState=B,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:B},G.queue=y,y=y.dispatch=yd.bind(null,Po,y),[G.memoizedState,y]},useRef:function(y){var B=Bt();return y={current:y},B.memoizedState=y},useState:Jf,useDebugValue:Da,useDeferredValue:function(y){return Bt().memoizedState=y},useTransition:function(){var y=Jf(!1),B=y[0];return y=sp.bind(null,y[1]),Bt().memoizedState=y,[B,y]},useMutableSource:function(){},useSyncExternalStore:function(y,B,O){var G=Po,re=Bt();if(Gr){if(O===void 0)throw Error(r(407));O=O()}else{if(O=B(),F===null)throw Error(r(349));(Pc&30)!==0||Zf(G,B,O)}re.memoizedState=O;var de={value:O,getSnapshot:B};return re.queue=de,$h(Im.bind(null,G,de,y),[y]),G.flags|=2048,Mc(9,Iu.bind(null,G,de,O,B),void 0,null),O},useId:function(){var y=Bt(),B=F.identifierPrefix;if(Gr){var O=yt,G=dr;O=(G&~(1<<32-so(G)-1)).toString(32)+O,B=":"+B+"R"+O,O=Tu++,0<O&&(B+="H"+O.toString(32)),B+=":"}else O=Ju++,B=":"+B+"r"+O.toString(32)+":";return y.memoizedState=B},unstable_isNewReconciler:!1},lp={readContext:rs,useCallback:Di,useContext:rs,useEffect:_d,useImperativeHandle:op,useInsertionEffect:Fm,useLayoutEffect:Ks,useMemo:Pm,useReducer:Bf,useRef:Bh,useState:function(){return Bf(qh)},useDebugValue:Da,useDeferredValue:function(y){var B=Lc();return Dc(B,is.memoizedState,y)},useTransition:function(){var y=Bf(qh)[0],B=Lc().memoizedState;return[y,B]},useMutableSource:ip,useSyncExternalStore:RA,useId:vd,unstable_isNewReconciler:!1},Mm={readContext:rs,useCallback:Di,useContext:rs,useEffect:_d,useImperativeHandle:op,useInsertionEffect:Fm,useLayoutEffect:Ks,useMemo:Pm,useReducer:ou,useRef:Bh,useState:function(){return ou(qh)},useDebugValue:Da,useDeferredValue:function(y){var B=Lc();return is===null?B.memoizedState=y:Dc(B,is.memoizedState,y)},useTransition:function(){var y=ou(qh)[0],B=Lc().memoizedState;return[y,B]},useMutableSource:ip,useSyncExternalStore:RA,useId:vd,unstable_isNewReconciler:!1};function Fu(y,B){if(y&&y.defaultProps){B=ar({},B),y=y.defaultProps;for(var O in y)B[O]===void 0&&(B[O]=y[O]);return B}return B}function UA(y,B,O,G){B=y.memoizedState,O=O(G,B),O=O==null?B:ar({},B,O),y.memoizedState=O,y.lanes===0&&(y.updateQueue.baseState=O)}var Xh={isMounted:function(y){return(y=y._reactInternals)?Oe(y)===y:!1},enqueueSetState:function(y,B,O){y=y._reactInternals;var G=pr(),re=It(y),de=hn(G,re);de.payload=B,O!=null&&(de.callback=O),B=us(y,de,re),B!==null&&(ht(B,y,re,G),jl(B,y,re))},enqueueReplaceState:function(y,B,O){y=y._reactInternals;var G=pr(),re=It(y),de=hn(G,re);de.tag=1,de.payload=B,O!=null&&(de.callback=O),B=us(y,de,re),B!==null&&(ht(B,y,re,G),jl(B,y,re))},enqueueForceUpdate:function(y,B){y=y._reactInternals;var O=pr(),G=It(y),re=hn(O,G);re.tag=2,B!=null&&(re.callback=B),B=us(y,re,G),B!==null&&(ht(B,y,G,O),jl(B,y,G))}};function Om(y,B,O,G,re,de,We){return y=y.stateNode,typeof y.shouldComponentUpdate=="function"?y.shouldComponentUpdate(G,de,We):B.prototype&&B.prototype.isPureReactComponent?!$u(O,G)||!$u(re,de):!0}function Zh(y,B,O){var G=!1,re=nu,de=B.contextType;return typeof de=="object"&&de!==null?de=rs(de):(re=Ol(B)?Fs:Is.current,G=B.contextTypes,de=(G=G!=null)?yf(y,re):nu),B=new B(O,de),y.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,B.updater=Xh,y.stateNode=B,B._reactInternals=y,G&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=re,y.__reactInternalMemoizedMaskedChildContext=de),B}function Dm(y,B,O,G){y=B.state,typeof B.componentWillReceiveProps=="function"&&B.componentWillReceiveProps(O,G),typeof B.UNSAFE_componentWillReceiveProps=="function"&&B.UNSAFE_componentWillReceiveProps(O,G),B.state!==y&&Xh.enqueueReplaceState(B,B.state,null)}function cp(y,B,O,G){var re=y.stateNode;re.props=O,re.state=y.memoizedState,re.refs={},qo(y);var de=B.contextType;typeof de=="object"&&de!==null?re.context=rs(de):(de=Ol(B)?Fs:Is.current,re.context=yf(y,de)),re.state=y.memoizedState,de=B.getDerivedStateFromProps,typeof de=="function"&&(UA(y,B,de,O),re.state=y.memoizedState),typeof B.getDerivedStateFromProps=="function"||typeof re.getSnapshotBeforeUpdate=="function"||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(B=re.state,typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount(),B!==re.state&&Xh.enqueueReplaceState(re,re.state,null),el(y,O,re,G),re.state=y.memoizedState),typeof re.componentDidMount=="function"&&(y.flags|=4194308)}function Yh(y,B){try{var O="",G=B;do O+=Re(G),G=G.return;while(G);var re=O}catch(de){re=`
Error generating stack: `+de.message+`
`+de.stack}return{value:y,source:B,stack:re,digest:null}}function NA(y,B,O){return{value:y,source:null,stack:O??null,digest:B??null}}function Ua(y,B){try{console.error(B.value)}catch(O){setTimeout(function(){throw O})}}var up=typeof WeakMap=="function"?WeakMap:Map;function Rm(y,B,O){O=hn(-1,O),O.tag=3,O.payload={element:null};var G=B.value;return O.callback=function(){it||(it=!0,ct=G),Ua(y,B)},O}function km(y,B,O){O=hn(-1,O),O.tag=3;var G=y.type.getDerivedStateFromError;if(typeof G=="function"){var re=B.value;O.payload=function(){return G(re)},O.callback=function(){Ua(y,B)}}var de=y.stateNode;return de!==null&&typeof de.componentDidCatch=="function"&&(O.callback=function(){Ua(y,B),typeof G!="function"&&(Xe===null?Xe=new Set([this]):Xe.add(this));var We=B.stack;this.componentDidCatch(B.value,{componentStack:We!==null?We:""})}),O}function zA(y,B,O){var G=y.pingCache;if(G===null){G=y.pingCache=new up;var re=new Set;G.set(B,re)}else re=G.get(B),re===void 0&&(re=new Set,G.set(B,re));re.has(O)||(re.add(O),y=Aa.bind(null,y,B,O),B.then(y,y))}function Um(y){do{var B;if((B=y.tag===13)&&(B=y.memoizedState,B=B!==null?B.dehydrated!==null:!0),B)return y;y=y.return}while(y!==null);return null}function hp(y,B,O,G,re){return(y.mode&1)===0?(y===B?y.flags|=65536:(y.flags|=128,O.flags|=131072,O.flags&=-52805,O.tag===1&&(O.alternate===null?O.tag=17:(B=hn(-1,1),B.tag=2,us(O,B,1))),O.lanes|=1),y):(y.flags|=65536,y.lanes=re,y)}var Ug=se.ReactCurrentOwner,tl=!1;function uc(y,B,O,G){B.child=y===null?Ko(B,null,O,G):ys(B,y.child,O,G)}function Nm(y,B,O,G,re){O=O.render;var de=B.ref;return cs(B,re),G=Eh(y,B,O,G,de,re),O=_a(),y!==null&&!tl?(B.updateQueue=y.updateQueue,B.flags&=-2053,y.lanes&=~re,eA(y,B,re)):(Gr&&O&&Qr(B),B.flags|=1,uc(y,B,G,re),B.child)}function jp(y,B,O,G,re){if(y===null){var de=O.type;return typeof de=="function"&&!Do(de)&&de.defaultProps===void 0&&O.compare===null&&O.defaultProps===void 0?(B.tag=15,B.type=de,xd(y,B,de,G,re)):(y=Rl(O.type,null,G,B,B.mode,re),y.ref=B.ref,y.return=B,B.child=y)}if(de=y.child,(y.lanes&re)===0){var We=de.memoizedProps;if(O=O.compare,O=O!==null?O:$u,O(We,G)&&y.ref===B.ref)return eA(y,B,re)}return B.flags|=1,y=Gl(de,G),y.ref=B.ref,y.return=B,B.child=y}function xd(y,B,O,G,re){if(y!==null){var de=y.memoizedProps;if($u(de,G)&&y.ref===B.ref)if(tl=!1,B.pendingProps=G=de,(y.lanes&re)!==0)(y.flags&131072)!==0&&(tl=!0);else return B.lanes=y.lanes,eA(y,B,re)}return Vp(y,B,O,G,re)}function zm(y,B,O){var G=B.pendingProps,re=G.children,de=y!==null?y.memoizedState:null;if(G.mode==="hidden")if((B.mode&1)===0)B.memoizedState={baseLanes:0,cachePool:null,transitions:null},po(Z,V),V|=O;else{if((O&1073741824)===0)return y=de!==null?de.baseLanes|O:O,B.lanes=B.childLanes=1073741824,B.memoizedState={baseLanes:y,cachePool:null,transitions:null},B.updateQueue=null,po(Z,V),V|=y,null;B.memoizedState={baseLanes:0,cachePool:null,transitions:null},G=de!==null?de.baseLanes:O,po(Z,V),V|=G}else de!==null?(G=de.baseLanes|O,B.memoizedState=null):G=O,po(Z,V),V|=G;return uc(y,B,re,O),B.child}function Hp(y,B){var O=B.ref;(y===null&&O!==null||y!==null&&y.ref!==O)&&(B.flags|=512,B.flags|=2097152)}function Vp(y,B,O,G,re){var de=Ol(O)?Fs:Is.current;return de=yf(B,de),cs(B,re),O=Eh(y,B,O,G,de,re),G=_a(),y!==null&&!tl?(B.updateQueue=y.updateQueue,B.flags&=-2053,y.lanes&=~re,eA(y,B,re)):(Gr&&G&&Qr(B),B.flags|=1,uc(y,B,O,re),B.child)}function Ng(y,B,O,G,re){if(Ol(O)){var de=!0;Kh(B)}else de=!1;if(cs(B,re),B.stateNode===null)Vm(y,B),Zh(B,O,G),cp(B,O,G,re),G=!0;else if(y===null){var We=B.stateNode,Lt=B.memoizedProps;We.props=Lt;var qt=We.context,Or=O.contextType;typeof Or=="object"&&Or!==null?Or=rs(Or):(Or=Ol(O)?Fs:Is.current,Or=yf(B,Or));var pn=O.getDerivedStateFromProps,wn=typeof pn=="function"||typeof We.getSnapshotBeforeUpdate=="function";wn||typeof We.UNSAFE_componentWillReceiveProps!="function"&&typeof We.componentWillReceiveProps!="function"||(Lt!==G||qt!==Or)&&Dm(B,We,G,Or),ns=!1;var vn=B.memoizedState;We.state=vn,el(B,G,We,re),qt=B.memoizedState,Lt!==G||vn!==qt||Ml.current||ns?(typeof pn=="function"&&(UA(B,O,pn,G),qt=B.memoizedState),(Lt=ns||Om(B,O,Lt,G,vn,qt,Or))?(wn||typeof We.UNSAFE_componentWillMount!="function"&&typeof We.componentWillMount!="function"||(typeof We.componentWillMount=="function"&&We.componentWillMount(),typeof We.UNSAFE_componentWillMount=="function"&&We.UNSAFE_componentWillMount()),typeof We.componentDidMount=="function"&&(B.flags|=4194308)):(typeof We.componentDidMount=="function"&&(B.flags|=4194308),B.memoizedProps=G,B.memoizedState=qt),We.props=G,We.state=qt,We.context=Or,G=Lt):(typeof We.componentDidMount=="function"&&(B.flags|=4194308),G=!1)}else{We=B.stateNode,bo(y,B),Lt=B.memoizedProps,Or=B.type===B.elementType?Lt:Fu(B.type,Lt),We.props=Or,wn=B.pendingProps,vn=We.context,qt=O.contextType,typeof qt=="object"&&qt!==null?qt=rs(qt):(qt=Ol(O)?Fs:Is.current,qt=yf(B,qt));var qn=O.getDerivedStateFromProps;(pn=typeof qn=="function"||typeof We.getSnapshotBeforeUpdate=="function")||typeof We.UNSAFE_componentWillReceiveProps!="function"&&typeof We.componentWillReceiveProps!="function"||(Lt!==wn||vn!==qt)&&Dm(B,We,G,qt),ns=!1,vn=B.memoizedState,We.state=vn,el(B,G,We,re);var fi=B.memoizedState;Lt!==wn||vn!==fi||Ml.current||ns?(typeof qn=="function"&&(UA(B,O,qn,G),fi=B.memoizedState),(Or=ns||Om(B,O,Or,G,vn,fi,qt)||!1)?(pn||typeof We.UNSAFE_componentWillUpdate!="function"&&typeof We.componentWillUpdate!="function"||(typeof We.componentWillUpdate=="function"&&We.componentWillUpdate(G,fi,qt),typeof We.UNSAFE_componentWillUpdate=="function"&&We.UNSAFE_componentWillUpdate(G,fi,qt)),typeof We.componentDidUpdate=="function"&&(B.flags|=4),typeof We.getSnapshotBeforeUpdate=="function"&&(B.flags|=1024)):(typeof We.componentDidUpdate!="function"||Lt===y.memoizedProps&&vn===y.memoizedState||(B.flags|=4),typeof We.getSnapshotBeforeUpdate!="function"||Lt===y.memoizedProps&&vn===y.memoizedState||(B.flags|=1024),B.memoizedProps=G,B.memoizedState=fi),We.props=G,We.state=fi,We.context=qt,G=Or):(typeof We.componentDidUpdate!="function"||Lt===y.memoizedProps&&vn===y.memoizedState||(B.flags|=4),typeof We.getSnapshotBeforeUpdate!="function"||Lt===y.memoizedProps&&vn===y.memoizedState||(B.flags|=1024),G=!1)}return fp(y,B,O,G,de,re)}function fp(y,B,O,G,re,de){Hp(y,B);var We=(B.flags&128)!==0;if(!G&&!We)return re&&md(B,O,!1),eA(y,B,de);G=B.stateNode,Ug.current=B;var Lt=We&&typeof O.getDerivedStateFromError!="function"?null:G.render();return B.flags|=1,y!==null&&We?(B.child=ys(B,y.child,null,de),B.child=ys(B,null,Lt,de)):uc(y,B,Lt,de),B.memoizedState=G.state,re&&md(B,O,!0),B.child}function Ap(y){var B=y.stateNode;B.pendingContext?dd(y,B.pendingContext,B.pendingContext!==B.context):B.context&&dd(y,B.context,!1),Ef(y,B.containerInfo)}function Qm(y,B,O,G,re){return Jn(),Tn(re),B.flags|=256,uc(y,B,O,G),B.child}var jm={dehydrated:null,treeContext:null,retryLane:0};function Gp(y){return{baseLanes:y,cachePool:null,transitions:null}}function zg(y,B,O){var G=B.pendingProps,re=Fo.current,de=!1,We=(B.flags&128)!==0,Lt;if((Lt=We)||(Lt=y!==null&&y.memoizedState===null?!1:(re&2)!==0),Lt?(de=!0,B.flags&=-129):(y===null||y.memoizedState!==null)&&(re|=1),po(Fo,re&1),y===null)return si(B),y=B.memoizedState,y!==null&&(y=y.dehydrated,y!==null)?((B.mode&1)===0?B.lanes=1:y.data==="$!"?B.lanes=8:B.lanes=1073741824,null):(We=G.children,y=G.fallback,de?(G=B.mode,de=B.child,We={mode:"hidden",children:We},(G&1)===0&&de!==null?(de.childLanes=0,de.pendingProps=We):de=rl(We,G,0,null),y=gl(y,G,O,null),de.return=B,y.return=B,de.sibling=y,B.child=de,B.child.memoizedState=Gp(O),B.memoizedState=jm,y):dp(B,We));if(re=y.memoizedState,re!==null&&(Lt=re.dehydrated,Lt!==null))return G0(y,B,We,G,Lt,re,O);if(de){de=G.fallback,We=B.mode,re=y.child,Lt=re.sibling;var qt={mode:"hidden",children:G.children};return(We&1)===0&&B.child!==re?(G=B.child,G.childLanes=0,G.pendingProps=qt,B.deletions=null):(G=Gl(re,qt),G.subtreeFlags=re.subtreeFlags&14680064),Lt!==null?de=Gl(Lt,de):(de=gl(de,We,O,null),de.flags|=2),de.return=B,G.return=B,G.sibling=de,B.child=G,G=de,de=B.child,We=y.child.memoizedState,We=We===null?Gp(O):{baseLanes:We.baseLanes|O,cachePool:null,transitions:We.transitions},de.memoizedState=We,de.childLanes=y.childLanes&~O,B.memoizedState=jm,G}return de=y.child,y=de.sibling,G=Gl(de,{mode:"visible",children:G.children}),(B.mode&1)===0&&(G.lanes=O),G.return=B,G.sibling=null,y!==null&&(O=B.deletions,O===null?(B.deletions=[y],B.flags|=16):O.push(y)),B.child=G,B.memoizedState=null,G}function dp(y,B){return B=rl({mode:"visible",children:B},y.mode,0,null),B.return=y,y.child=B}function Kp(y,B,O,G){return G!==null&&Tn(G),ys(B,y.child,null,O),y=dp(B,B.pendingProps.children),y.flags|=2,B.memoizedState=null,y}function G0(y,B,O,G,re,de,We){if(O)return B.flags&256?(B.flags&=-257,G=NA(Error(r(422))),Kp(y,B,We,G)):B.memoizedState!==null?(B.child=y.child,B.flags|=128,null):(de=G.fallback,re=B.mode,G=rl({mode:"visible",children:G.children},re,0,null),de=gl(de,re,We,null),de.flags|=2,G.return=B,de.return=B,G.sibling=de,B.child=G,(B.mode&1)!==0&&ys(B,y.child,null,We),B.child.memoizedState=Gp(We),B.memoizedState=jm,de);if((B.mode&1)===0)return Kp(y,B,We,null);if(re.data==="$!"){if(G=re.nextSibling&&re.nextSibling.dataset,G)var Lt=G.dgst;return G=Lt,de=Error(r(419)),G=NA(de,G,void 0),Kp(y,B,We,G)}if(Lt=(We&y.childLanes)!==0,tl||Lt){if(G=F,G!==null){switch(We&-We){case 4:re=2;break;case 16:re=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:re=32;break;case 536870912:re=268435456;break;default:re=0}re=(re&(G.suspendedLanes|We))!==0?0:re,re!==0&&re!==de.retryLane&&(de.retryLane=re,co(y,re),ht(G,y,re,-1))}return hi(),G=NA(Error(r(421))),Kp(y,B,We,G)}return re.data==="$?"?(B.flags|=128,B.child=y.child,B=io.bind(null,y),re._reactRetry=B,null):(y=de.treeContext,zr=Pl(re.nextSibling),Ur=B,Gr=!0,rn=null,y!==null&&(dt[vt++]=dr,dt[vt++]=yt,dt[vt++]=Wt,dr=y.id,yt=y.overflow,Wt=B),B=dp(B,G.children),B.flags|=4096,B)}function Qg(y,B,O){y.lanes|=B;var G=y.alternate;G!==null&&(G.lanes|=B),qa(y.return,B,O)}function Hm(y,B,O,G,re){var de=y.memoizedState;de===null?y.memoizedState={isBackwards:B,rendering:null,renderingStartTime:0,last:G,tail:O,tailMode:re}:(de.isBackwards=B,de.rendering=null,de.renderingStartTime=0,de.last=G,de.tail=O,de.tailMode=re)}function jg(y,B,O){var G=B.pendingProps,re=G.revealOrder,de=G.tail;if(uc(y,B,G.children,O),G=Fo.current,(G&2)!==0)G=G&1|2,B.flags|=128;else{if(y!==null&&(y.flags&128)!==0)e:for(y=B.child;y!==null;){if(y.tag===13)y.memoizedState!==null&&Qg(y,O,B);else if(y.tag===19)Qg(y,O,B);else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===B)break e;for(;y.sibling===null;){if(y.return===null||y.return===B)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}G&=1}if(po(Fo,G),(B.mode&1)===0)B.memoizedState=null;else switch(re){case"forwards":for(O=B.child,re=null;O!==null;)y=O.alternate,y!==null&&iu(y)===null&&(re=O),O=O.sibling;O=re,O===null?(re=B.child,B.child=null):(re=O.sibling,O.sibling=null),Hm(B,!1,re,O,de);break;case"backwards":for(O=null,re=B.child,B.child=null;re!==null;){if(y=re.alternate,y!==null&&iu(y)===null){B.child=re;break}y=re.sibling,re.sibling=O,O=re,re=y}Hm(B,!0,O,null,de);break;case"together":Hm(B,!1,null,null,void 0);break;default:B.memoizedState=null}return B.child}function Vm(y,B){(B.mode&1)===0&&y!==null&&(y.alternate=null,B.alternate=null,B.flags|=2)}function eA(y,B,O){if(y!==null&&(B.dependencies=y.dependencies),he|=B.lanes,(O&B.childLanes)===0)return null;if(y!==null&&B.child!==y.child)throw Error(r(153));if(B.child!==null){for(y=B.child,O=Gl(y,y.pendingProps),B.child=O,O.return=B;y.sibling!==null;)y=y.sibling,O=O.sibling=Gl(y,y.pendingProps),O.return=B;O.sibling=null}return B.child}function no(y,B,O){switch(B.tag){case 3:Ap(B),Jn();break;case 5:Wh(B);break;case 1:Ol(B.type)&&Kh(B);break;case 4:Ef(B,B.stateNode.containerInfo);break;case 10:var G=B.type._context,re=B.memoizedProps.value;po(Wo,G._currentValue),G._currentValue=re;break;case 13:if(G=B.memoizedState,G!==null)return G.dehydrated!==null?(po(Fo,Fo.current&1),B.flags|=128,null):(O&B.child.childLanes)!==0?zg(y,B,O):(po(Fo,Fo.current&1),y=eA(y,B,O),y!==null?y.sibling:null);po(Fo,Fo.current&1);break;case 19:if(G=(O&B.childLanes)!==0,(y.flags&128)!==0){if(G)return jg(y,B,O);B.flags|=128}if(re=B.memoizedState,re!==null&&(re.rendering=null,re.tail=null,re.lastEffect=null),po(Fo,Fo.current),G)break;return null;case 22:case 23:return B.lanes=0,zm(y,B,O)}return eA(y,B,O)}var Hg,Vg,Gm,K0;Hg=function(y,B){for(var O=B.child;O!==null;){if(O.tag===5||O.tag===6)y.appendChild(O.stateNode);else if(O.tag!==4&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===B)break;for(;O.sibling===null;){if(O.return===null||O.return===B)return;O=O.return}O.sibling.return=O.return,O=O.sibling}},Vg=function(){},Gm=function(y,B,O,G){var re=y.memoizedProps;if(re!==G){y=B.stateNode,xs(Ls.current);var de=null;switch(O){case"input":re=er(y,re),G=er(y,G),de=[];break;case"select":re=ar({},re,{value:void 0}),G=ar({},G,{value:void 0}),de=[];break;case"textarea":re=Ci(y,re),G=Ci(y,G),de=[];break;default:typeof re.onClick!="function"&&typeof G.onClick=="function"&&(y.onclick=Zu)}xa(O,G);var We;O=null;for(Or in re)if(!G.hasOwnProperty(Or)&&re.hasOwnProperty(Or)&&re[Or]!=null)if(Or==="style"){var Lt=re[Or];for(We in Lt)Lt.hasOwnProperty(We)&&(O||(O={}),O[We]="")}else Or!=="dangerouslySetInnerHTML"&&Or!=="children"&&Or!=="suppressContentEditableWarning"&&Or!=="suppressHydrationWarning"&&Or!=="autoFocus"&&(l.hasOwnProperty(Or)?de||(de=[]):(de=de||[]).push(Or,null));for(Or in G){var qt=G[Or];if(Lt=re?.[Or],G.hasOwnProperty(Or)&&qt!==Lt&&(qt!=null||Lt!=null))if(Or==="style")if(Lt){for(We in Lt)!Lt.hasOwnProperty(We)||qt&&qt.hasOwnProperty(We)||(O||(O={}),O[We]="");for(We in qt)qt.hasOwnProperty(We)&&Lt[We]!==qt[We]&&(O||(O={}),O[We]=qt[We])}else O||(de||(de=[]),de.push(Or,O)),O=qt;else Or==="dangerouslySetInnerHTML"?(qt=qt?qt.__html:void 0,Lt=Lt?Lt.__html:void 0,qt!=null&&Lt!==qt&&(de=de||[]).push(Or,qt)):Or==="children"?typeof qt!="string"&&typeof qt!="number"||(de=de||[]).push(Or,""+qt):Or!=="suppressContentEditableWarning"&&Or!=="suppressHydrationWarning"&&(l.hasOwnProperty(Or)?(qt!=null&&Or==="onScroll"&&di("scroll",y),de||Lt===qt||(de=[])):(de=de||[]).push(Or,qt))}O&&(de=de||[]).push("style",O);var Or=de;(B.updateQueue=Or)&&(B.flags|=4)}},K0=function(y,B,O,G){O!==G&&(B.flags|=4)};function tA(y,B){if(!Gr)switch(y.tailMode){case"hidden":B=y.tail;for(var O=null;B!==null;)B.alternate!==null&&(O=B),B=B.sibling;O===null?y.tail=null:O.sibling=null;break;case"collapsed":O=y.tail;for(var G=null;O!==null;)O.alternate!==null&&(G=O),O=O.sibling;G===null?B||y.tail===null?y.tail=null:y.tail.sibling=null:G.sibling=null}}function pl(y){var B=y.alternate!==null&&y.alternate.child===y.child,O=0,G=0;if(B)for(var re=y.child;re!==null;)O|=re.lanes|re.childLanes,G|=re.subtreeFlags&14680064,G|=re.flags&14680064,re.return=y,re=re.sibling;else for(re=y.child;re!==null;)O|=re.lanes|re.childLanes,G|=re.subtreeFlags,G|=re.flags,re.return=y,re=re.sibling;return y.subtreeFlags|=G,y.childLanes=O,B}function Gg(y,B,O){var G=B.pendingProps;switch(gr(B),B.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pl(B),null;case 1:return Ol(B.type)&&xf(),pl(B),null;case 3:return G=B.stateNode,$o(),ka(Ml),ka(Is),np(),G.pendingContext&&(G.context=G.pendingContext,G.pendingContext=null),(y===null||y.child===null)&&(Vo(B)?B.flags|=4:y===null||y.memoizedState.isDehydrated&&(B.flags&256)===0||(B.flags|=1024,rn!==null&&(Ar(rn),rn=null))),Vg(y,B),pl(B),null;case 5:rp(B);var re=xs(bf.current);if(O=B.type,y!==null&&B.stateNode!=null)Gm(y,B,O,G,re),y.ref!==B.ref&&(B.flags|=512,B.flags|=2097152);else{if(!G){if(B.stateNode===null)throw Error(r(166));return pl(B),null}if(y=xs(Ls.current),Vo(B)){G=B.stateNode,O=B.type;var de=B.memoizedProps;switch(G[Yu]=B,G[Wf]=de,y=(B.mode&1)!==0,O){case"dialog":di("cancel",G),di("close",G);break;case"iframe":case"object":case"embed":di("load",G);break;case"video":case"audio":for(re=0;re<xh.length;re++)di(xh[re],G);break;case"source":di("error",G);break;case"img":case"image":case"link":di("error",G),di("load",G);break;case"details":di("toggle",G);break;case"input":mt(G,de),di("invalid",G);break;case"select":G._wrapperState={wasMultiple:!!de.multiple},di("invalid",G);break;case"textarea":Zn(G,de),di("invalid",G)}xa(O,de),re=null;for(var We in de)if(de.hasOwnProperty(We)){var Lt=de[We];We==="children"?typeof Lt=="string"?G.textContent!==Lt&&(de.suppressHydrationWarning!==!0&&wh(G.textContent,Lt,y),re=["children",Lt]):typeof Lt=="number"&&G.textContent!==""+Lt&&(de.suppressHydrationWarning!==!0&&wh(G.textContent,Lt,y),re=["children",""+Lt]):l.hasOwnProperty(We)&&Lt!=null&&We==="onScroll"&&di("scroll",G)}switch(O){case"input":mr(G),zn(G,de,!0);break;case"textarea":mr(G),Ti(G);break;case"select":case"option":break;default:typeof de.onClick=="function"&&(G.onclick=Zu)}G=re,B.updateQueue=G,G!==null&&(B.flags|=4)}else{We=re.nodeType===9?re:re.ownerDocument,y==="http://www.w3.org/1999/xhtml"&&(y=ui(O)),y==="http://www.w3.org/1999/xhtml"?O==="script"?(y=We.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild)):typeof G.is=="string"?y=We.createElement(O,{is:G.is}):(y=We.createElement(O),O==="select"&&(We=y,G.multiple?We.multiple=!0:G.size&&(We.size=G.size))):y=We.createElementNS(y,O),y[Yu]=B,y[Wf]=G,Hg(y,B,!1,!1),B.stateNode=y;e:{switch(We=yi(O,G),O){case"dialog":di("cancel",y),di("close",y),re=G;break;case"iframe":case"object":case"embed":di("load",y),re=G;break;case"video":case"audio":for(re=0;re<xh.length;re++)di(xh[re],y);re=G;break;case"source":di("error",y),re=G;break;case"img":case"image":case"link":di("error",y),di("load",y),re=G;break;case"details":di("toggle",y),re=G;break;case"input":mt(y,G),re=er(y,G),di("invalid",y);break;case"option":re=G;break;case"select":y._wrapperState={wasMultiple:!!G.multiple},re=ar({},G,{value:void 0}),di("invalid",y);break;case"textarea":Zn(y,G),re=Ci(y,G),di("invalid",y);break;default:re=G}xa(O,re),Lt=re;for(de in Lt)if(Lt.hasOwnProperty(de)){var qt=Lt[de];de==="style"?Gn(y,qt):de==="dangerouslySetInnerHTML"?(qt=qt?qt.__html:void 0,qt!=null&&ti(y,qt)):de==="children"?typeof qt=="string"?(O!=="textarea"||qt!=="")&&vi(y,qt):typeof qt=="number"&&vi(y,""+qt):de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&de!=="autoFocus"&&(l.hasOwnProperty(de)?qt!=null&&de==="onScroll"&&di("scroll",y):qt!=null&&J(y,de,qt,We))}switch(O){case"input":mr(y),zn(y,G,!1);break;case"textarea":mr(y),Ti(y);break;case"option":G.value!=null&&y.setAttribute("value",""+Dt(G.value));break;case"select":y.multiple=!!G.multiple,de=G.value,de!=null?yn(y,!!G.multiple,de,!1):G.defaultValue!=null&&yn(y,!!G.multiple,G.defaultValue,!0);break;default:typeof re.onClick=="function"&&(y.onclick=Zu)}switch(O){case"button":case"input":case"select":case"textarea":G=!!G.autoFocus;break e;case"img":G=!0;break e;default:G=!1}}G&&(B.flags|=4)}B.ref!==null&&(B.flags|=512,B.flags|=2097152)}return pl(B),null;case 6:if(y&&B.stateNode!=null)K0(y,B,y.memoizedProps,G);else{if(typeof G!="string"&&B.stateNode===null)throw Error(r(166));if(O=xs(bf.current),xs(Ls.current),Vo(B)){if(G=B.stateNode,O=B.memoizedProps,G[Yu]=B,(de=G.nodeValue!==O)&&(y=Ur,y!==null))switch(y.tag){case 3:wh(G.nodeValue,O,(y.mode&1)!==0);break;case 5:y.memoizedProps.suppressHydrationWarning!==!0&&wh(G.nodeValue,O,(y.mode&1)!==0)}de&&(B.flags|=4)}else G=(O.nodeType===9?O:O.ownerDocument).createTextNode(G),G[Yu]=B,B.stateNode=G}return pl(B),null;case 13:if(ka(Fo),G=B.memoizedState,y===null||y.memoizedState!==null&&y.memoizedState.dehydrated!==null){if(Gr&&zr!==null&&(B.mode&1)!==0&&(B.flags&128)===0)aa(),Jn(),B.flags|=98560,de=!1;else if(de=Vo(B),G!==null&&G.dehydrated!==null){if(y===null){if(!de)throw Error(r(318));if(de=B.memoizedState,de=de!==null?de.dehydrated:null,!de)throw Error(r(317));de[Yu]=B}else Jn(),(B.flags&128)===0&&(B.memoizedState=null),B.flags|=4;pl(B),de=!1}else rn!==null&&(Ar(rn),rn=null),de=!0;if(!de)return B.flags&65536?B:null}return(B.flags&128)!==0?(B.lanes=O,B):(G=G!==null,G!==(y!==null&&y.memoizedState!==null)&&G&&(B.child.flags|=8192,(B.mode&1)!==0&&(y===null||(Fo.current&1)!==0?K===0&&(K=3):hi())),B.updateQueue!==null&&(B.flags|=4),pl(B),null);case 4:return $o(),Vg(y,B),y===null&&Vf(B.stateNode.containerInfo),pl(B),null;case 10:return wo(B.type._context),pl(B),null;case 17:return Ol(B.type)&&xf(),pl(B),null;case 19:if(ka(Fo),de=B.memoizedState,de===null)return pl(B),null;if(G=(B.flags&128)!==0,We=de.rendering,We===null)if(G)tA(de,!1);else{if(K!==0||y!==null&&(y.flags&128)!==0)for(y=B.child;y!==null;){if(We=iu(y),We!==null){for(B.flags|=128,tA(de,!1),G=We.updateQueue,G!==null&&(B.updateQueue=G,B.flags|=4),B.subtreeFlags=0,G=O,O=B.child;O!==null;)de=O,y=G,de.flags&=14680066,We=de.alternate,We===null?(de.childLanes=0,de.lanes=y,de.child=null,de.subtreeFlags=0,de.memoizedProps=null,de.memoizedState=null,de.updateQueue=null,de.dependencies=null,de.stateNode=null):(de.childLanes=We.childLanes,de.lanes=We.lanes,de.child=We.child,de.subtreeFlags=0,de.deletions=null,de.memoizedProps=We.memoizedProps,de.memoizedState=We.memoizedState,de.updateQueue=We.updateQueue,de.type=We.type,y=We.dependencies,de.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),O=O.sibling;return po(Fo,Fo.current&1|2),B.child}y=y.sibling}de.tail!==null&&en()>He&&(B.flags|=128,G=!0,tA(de,!1),B.lanes=4194304)}else{if(!G)if(y=iu(We),y!==null){if(B.flags|=128,G=!0,O=y.updateQueue,O!==null&&(B.updateQueue=O,B.flags|=4),tA(de,!0),de.tail===null&&de.tailMode==="hidden"&&!We.alternate&&!Gr)return pl(B),null}else 2*en()-de.renderingStartTime>He&&O!==1073741824&&(B.flags|=128,G=!0,tA(de,!1),B.lanes=4194304);de.isBackwards?(We.sibling=B.child,B.child=We):(O=de.last,O!==null?O.sibling=We:B.child=We,de.last=We)}return de.tail!==null?(B=de.tail,de.rendering=B,de.tail=B.sibling,de.renderingStartTime=en(),B.sibling=null,O=Fo.current,po(Fo,G?O&1|2:O&1),B):(pl(B),null);case 22:case 23:return An(),G=B.memoizedState!==null,y!==null&&y.memoizedState!==null!==G&&(B.flags|=8192),G&&(B.mode&1)!==0?(V&1073741824)!==0&&(pl(B),B.subtreeFlags&6&&(B.flags|=8192)):pl(B),null;case 24:return null;case 25:return null}throw Error(r(156,B.tag))}function Km(y,B){switch(gr(B),B.tag){case 1:return Ol(B.type)&&xf(),y=B.flags,y&65536?(B.flags=y&-65537|128,B):null;case 3:return $o(),ka(Ml),ka(Is),np(),y=B.flags,(y&65536)!==0&&(y&128)===0?(B.flags=y&-65537|128,B):null;case 5:return rp(B),null;case 13:if(ka(Fo),y=B.memoizedState,y!==null&&y.dehydrated!==null){if(B.alternate===null)throw Error(r(340));Jn()}return y=B.flags,y&65536?(B.flags=y&-65537|128,B):null;case 19:return ka(Fo),null;case 4:return $o(),null;case 10:return wo(B.type._context),null;case 22:case 23:return An(),null;case 24:return null;default:return null}}var su=!1,Dl=!1,Xo=typeof WeakSet=="function"?WeakSet:Set,jn=null;function Jh(y,B){var O=y.ref;if(O!==null)if(typeof O=="function")try{O(null)}catch(G){In(y,B,G)}else O.current=null}function wd(y,B,O){try{O()}catch(G){In(y,B,G)}}var Wm=!1;function W0(y,B){if(gf=Uf,y=qd(),zf(y)){if("selectionStart"in y)var O={start:y.selectionStart,end:y.selectionEnd};else e:{O=(O=y.ownerDocument)&&O.defaultView||window;var G=O.getSelection&&O.getSelection();if(G&&G.rangeCount!==0){O=G.anchorNode;var re=G.anchorOffset,de=G.focusNode;G=G.focusOffset;try{O.nodeType,de.nodeType}catch{O=null;break e}var We=0,Lt=-1,qt=-1,Or=0,pn=0,wn=y,vn=null;t:for(;;){for(var qn;wn!==O||re!==0&&wn.nodeType!==3||(Lt=We+re),wn!==de||G!==0&&wn.nodeType!==3||(qt=We+G),wn.nodeType===3&&(We+=wn.nodeValue.length),(qn=wn.firstChild)!==null;)vn=wn,wn=qn;for(;;){if(wn===y)break t;if(vn===O&&++Or===re&&(Lt=We),vn===de&&++pn===G&&(qt=We),(qn=wn.nextSibling)!==null)break;wn=vn,vn=wn.parentNode}wn=qn}O=Lt===-1||qt===-1?null:{start:Lt,end:qt}}else O=null}O=O||{start:0,end:0}}else O=null;for(bh={focusedElem:y,selectionRange:O},Uf=!1,jn=B;jn!==null;)if(B=jn,y=B.child,(B.subtreeFlags&1028)!==0&&y!==null)y.return=B,jn=y;else for(;jn!==null;){B=jn;try{var fi=B.alternate;if((B.flags&1024)!==0)switch(B.tag){case 0:case 11:case 15:break;case 1:if(fi!==null){var pi=fi.memoizedProps,_l=fi.memoizedState,_r=B.stateNode,nr=_r.getSnapshotBeforeUpdate(B.elementType===B.type?pi:Fu(B.type,pi),_l);_r.__reactInternalSnapshotBeforeUpdate=nr}break;case 3:var Sr=B.stateNode.containerInfo;Sr.nodeType===1?Sr.textContent="":Sr.nodeType===9&&Sr.documentElement&&Sr.removeChild(Sr.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Bn){In(B,B.return,Bn)}if(y=B.sibling,y!==null){y.return=B.return,jn=y;break}jn=B.return}return fi=Wm,Wm=!1,fi}function rA(y,B,O){var G=B.updateQueue;if(G=G!==null?G.lastEffect:null,G!==null){var re=G=G.next;do{if((re.tag&y)===y){var de=re.destroy;re.destroy=void 0,de!==void 0&&wd(B,O,de)}re=re.next}while(re!==G)}}function qm(y,B){if(B=B.updateQueue,B=B!==null?B.lastEffect:null,B!==null){var O=B=B.next;do{if((O.tag&y)===y){var G=O.create;O.destroy=G()}O=O.next}while(O!==B)}}function $m(y){var B=y.ref;if(B!==null){var O=y.stateNode;switch(y.tag){case 5:y=O;break;default:y=O}typeof B=="function"?B(y):B.current=y}}function Xm(y){var B=y.alternate;B!==null&&(y.alternate=null,Xm(B)),y.child=null,y.deletions=null,y.sibling=null,y.tag===5&&(B=y.stateNode,B!==null&&(delete B[Yu],delete B[Wf],delete B[Js],delete B[Tm],delete B[Np])),y.stateNode=null,y.return=null,y.dependencies=null,y.memoizedProps=null,y.memoizedState=null,y.pendingProps=null,y.stateNode=null,y.updateQueue=null}function Zm(y){return y.tag===5||y.tag===3||y.tag===4}function pp(y){e:for(;;){for(;y.sibling===null;){if(y.return===null||Zm(y.return))return null;y=y.return}for(y.sibling.return=y.return,y=y.sibling;y.tag!==5&&y.tag!==6&&y.tag!==18;){if(y.flags&2||y.child===null||y.tag===4)continue e;y.child.return=y,y=y.child}if(!(y.flags&2))return y.stateNode}}function QA(y,B,O){var G=y.tag;if(G===5||G===6)y=y.stateNode,B?O.nodeType===8?O.parentNode.insertBefore(y,B):O.insertBefore(y,B):(O.nodeType===8?(B=O.parentNode,B.insertBefore(y,O)):(B=O,B.appendChild(y)),O=O._reactRootContainer,O!=null||B.onclick!==null||(B.onclick=Zu));else if(G!==4&&(y=y.child,y!==null))for(QA(y,B,O),y=y.sibling;y!==null;)QA(y,B,O),y=y.sibling}function ef(y,B,O){var G=y.tag;if(G===5||G===6)y=y.stateNode,B?O.insertBefore(y,B):O.appendChild(y);else if(G!==4&&(y=y.child,y!==null))for(ef(y,B,O),y=y.sibling;y!==null;)ef(y,B,O),y=y.sibling}var Oo=null,Os=!1;function Ds(y,B,O){for(O=O.child;O!==null;)Pu(y,B,O),O=O.sibling}function Pu(y,B,O){if(Ra&&typeof Ra.onCommitFiberUnmount=="function")try{Ra.onCommitFiberUnmount(Ya,O)}catch{}switch(O.tag){case 5:Dl||Jh(O,B);case 6:var G=Oo,re=Os;Oo=null,Ds(y,B,O),Oo=G,Os=re,Oo!==null&&(Os?(y=Oo,O=O.stateNode,y.nodeType===8?y.parentNode.removeChild(O):y.removeChild(O)):Oo.removeChild(O.stateNode));break;case 18:Oo!==null&&(Os?(y=Oo,O=O.stateNode,y.nodeType===8?DA(y.parentNode,O):y.nodeType===1&&DA(y,O),Gu(y)):DA(Oo,O.stateNode));break;case 4:G=Oo,re=Os,Oo=O.stateNode.containerInfo,Os=!0,Ds(y,B,O),Oo=G,Os=re;break;case 0:case 11:case 14:case 15:if(!Dl&&(G=O.updateQueue,G!==null&&(G=G.lastEffect,G!==null))){re=G=G.next;do{var de=re,We=de.destroy;de=de.tag,We!==void 0&&((de&2)!==0||(de&4)!==0)&&wd(O,B,We),re=re.next}while(re!==G)}Ds(y,B,O);break;case 1:if(!Dl&&(Jh(O,B),G=O.stateNode,typeof G.componentWillUnmount=="function"))try{G.props=O.memoizedProps,G.state=O.memoizedState,G.componentWillUnmount()}catch(Lt){In(O,B,Lt)}Ds(y,B,O);break;case 21:Ds(y,B,O);break;case 22:O.mode&1?(Dl=(G=Dl)||O.memoizedState!==null,Ds(y,B,O),Dl=G):Ds(y,B,O);break;default:Ds(y,B,O)}}function q0(y){var B=y.updateQueue;if(B!==null){y.updateQueue=null;var O=y.stateNode;O===null&&(O=y.stateNode=new Xo),B.forEach(function(G){var re=Ki.bind(null,y,G);O.has(G)||(O.add(G),G.then(re,re))})}}function tf(y,B){var O=B.deletions;if(O!==null)for(var G=0;G<O.length;G++){var re=O[G];try{var de=y,We=B,Lt=We;e:for(;Lt!==null;){switch(Lt.tag){case 5:Oo=Lt.stateNode,Os=!1;break e;case 3:Oo=Lt.stateNode.containerInfo,Os=!0;break e;case 4:Oo=Lt.stateNode.containerInfo,Os=!0;break e}Lt=Lt.return}if(Oo===null)throw Error(r(160));Pu(de,We,re),Oo=null,Os=!1;var qt=re.alternate;qt!==null&&(qt.return=null),re.return=null}catch(Or){In(re,B,Or)}}if(B.subtreeFlags&12854)for(B=B.child;B!==null;)$0(B,y),B=B.sibling}function $0(y,B){var O=y.alternate,G=y.flags;switch(y.tag){case 0:case 11:case 14:case 15:if(tf(B,y),Sf(y),G&4){try{rA(3,y,y.return),qm(3,y)}catch(pi){In(y,y.return,pi)}try{rA(5,y,y.return)}catch(pi){In(y,y.return,pi)}}break;case 1:tf(B,y),Sf(y),G&512&&O!==null&&Jh(O,O.return);break;case 5:if(tf(B,y),Sf(y),G&512&&O!==null&&Jh(O,O.return),y.flags&32){var re=y.stateNode;try{vi(re,"")}catch(pi){In(y,y.return,pi)}}if(G&4&&(re=y.stateNode,re!=null)){var de=y.memoizedProps,We=O!==null?O.memoizedProps:de,Lt=y.type,qt=y.updateQueue;if(y.updateQueue=null,qt!==null)try{Lt==="input"&&de.type==="radio"&&de.name!=null&&En(re,de),yi(Lt,We);var Or=yi(Lt,de);for(We=0;We<qt.length;We+=2){var pn=qt[We],wn=qt[We+1];pn==="style"?Gn(re,wn):pn==="dangerouslySetInnerHTML"?ti(re,wn):pn==="children"?vi(re,wn):J(re,pn,wn,Or)}switch(Lt){case"input":$r(re,de);break;case"textarea":Vi(re,de);break;case"select":var vn=re._wrapperState.wasMultiple;re._wrapperState.wasMultiple=!!de.multiple;var qn=de.value;qn!=null?yn(re,!!de.multiple,qn,!1):vn!==!!de.multiple&&(de.defaultValue!=null?yn(re,!!de.multiple,de.defaultValue,!0):yn(re,!!de.multiple,de.multiple?[]:"",!1))}re[Wf]=de}catch(pi){In(y,y.return,pi)}}break;case 6:if(tf(B,y),Sf(y),G&4){if(y.stateNode===null)throw Error(r(162));re=y.stateNode,de=y.memoizedProps;try{re.nodeValue=de}catch(pi){In(y,y.return,pi)}}break;case 3:if(tf(B,y),Sf(y),G&4&&O!==null&&O.memoizedState.isDehydrated)try{Gu(B.containerInfo)}catch(pi){In(y,y.return,pi)}break;case 4:tf(B,y),Sf(y);break;case 13:tf(B,y),Sf(y),re=y.child,re.flags&8192&&(de=re.memoizedState!==null,re.stateNode.isHidden=de,!de||re.alternate!==null&&re.alternate.memoizedState!==null||(ke=en())),G&4&&q0(y);break;case 22:if(pn=O!==null&&O.memoizedState!==null,y.mode&1?(Dl=(Or=Dl)||pn,tf(B,y),Dl=Or):tf(B,y),Sf(y),G&8192){if(Or=y.memoizedState!==null,(y.stateNode.isHidden=Or)&&!pn&&(y.mode&1)!==0)for(jn=y,pn=y.child;pn!==null;){for(wn=jn=pn;jn!==null;){switch(vn=jn,qn=vn.child,vn.tag){case 0:case 11:case 14:case 15:rA(4,vn,vn.return);break;case 1:Jh(vn,vn.return);var fi=vn.stateNode;if(typeof fi.componentWillUnmount=="function"){G=vn,O=vn.return;try{B=G,fi.props=B.memoizedProps,fi.state=B.memoizedState,fi.componentWillUnmount()}catch(pi){In(G,O,pi)}}break;case 5:Jh(vn,vn.return);break;case 22:if(vn.memoizedState!==null){p(wn);continue}}qn!==null?(qn.return=vn,jn=qn):p(wn)}pn=pn.sibling}e:for(pn=null,wn=y;;){if(wn.tag===5){if(pn===null){pn=wn;try{re=wn.stateNode,Or?(de=re.style,typeof de.setProperty=="function"?de.setProperty("display","none","important"):de.display="none"):(Lt=wn.stateNode,qt=wn.memoizedProps.style,We=qt!=null&&qt.hasOwnProperty("display")?qt.display:null,Lt.style.display=ca("display",We))}catch(pi){In(y,y.return,pi)}}}else if(wn.tag===6){if(pn===null)try{wn.stateNode.nodeValue=Or?"":wn.memoizedProps}catch(pi){In(y,y.return,pi)}}else if((wn.tag!==22&&wn.tag!==23||wn.memoizedState===null||wn===y)&&wn.child!==null){wn.child.return=wn,wn=wn.child;continue}if(wn===y)break e;for(;wn.sibling===null;){if(wn.return===null||wn.return===y)break e;pn===wn&&(pn=null),wn=wn.return}pn===wn&&(pn=null),wn.sibling.return=wn.return,wn=wn.sibling}}break;case 19:tf(B,y),Sf(y),G&4&&q0(y);break;case 21:break;default:tf(B,y),Sf(y)}}function Sf(y){var B=y.flags;if(B&2){try{e:{for(var O=y.return;O!==null;){if(Zm(O)){var G=O;break e}O=O.return}throw Error(r(160))}switch(G.tag){case 5:var re=G.stateNode;G.flags&32&&(vi(re,""),G.flags&=-33);var de=pp(y);ef(y,de,re);break;case 3:case 4:var We=G.stateNode.containerInfo,Lt=pp(y);QA(y,Lt,We);break;default:throw Error(r(161))}}catch(qt){In(y,y.return,qt)}y.flags&=-3}B&4096&&(y.flags&=-4097)}function X0(y,B,O){jn=y,Vl(y)}function Vl(y,B,O){for(var G=(y.mode&1)!==0;jn!==null;){var re=jn,de=re.child;if(re.tag===22&&G){var We=re.memoizedState!==null||su;if(!We){var Lt=re.alternate,qt=Lt!==null&&Lt.memoizedState!==null||Dl;Lt=su;var Or=Dl;if(su=We,(Dl=qt)&&!Or)for(jn=re;jn!==null;)We=jn,qt=We.child,We.tag===22&&We.memoizedState!==null?o(re):qt!==null?(qt.return=We,jn=qt):o(re);for(;de!==null;)jn=de,Vl(de),de=de.sibling;jn=re,su=Lt,Dl=Or}Kg(y)}else(re.subtreeFlags&8772)!==0&&de!==null?(de.return=re,jn=de):Kg(y)}}function Kg(y){for(;jn!==null;){var B=jn;if((B.flags&8772)!==0){var O=B.alternate;try{if((B.flags&8772)!==0)switch(B.tag){case 0:case 11:case 15:Dl||qm(5,B);break;case 1:var G=B.stateNode;if(B.flags&4&&!Dl)if(O===null)G.componentDidMount();else{var re=B.elementType===B.type?O.memoizedProps:Fu(B.type,O.memoizedProps);G.componentDidUpdate(re,O.memoizedState,G.__reactInternalSnapshotBeforeUpdate)}var de=B.updateQueue;de!==null&&cc(B,de,G);break;case 3:var We=B.updateQueue;if(We!==null){if(O=null,B.child!==null)switch(B.child.tag){case 5:O=B.child.stateNode;break;case 1:O=B.child.stateNode}cc(B,We,O)}break;case 5:var Lt=B.stateNode;if(O===null&&B.flags&4){O=Lt;var qt=B.memoizedProps;switch(B.type){case"button":case"input":case"select":case"textarea":qt.autoFocus&&O.focus();break;case"img":qt.src&&(O.src=qt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(B.memoizedState===null){var Or=B.alternate;if(Or!==null){var pn=Or.memoizedState;if(pn!==null){var wn=pn.dehydrated;wn!==null&&Gu(wn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Dl||B.flags&512&&$m(B)}catch(vn){In(B,B.return,vn)}}if(B===y){jn=null;break}if(O=B.sibling,O!==null){O.return=B.return,jn=O;break}jn=B.return}}function p(y){for(;jn!==null;){var B=jn;if(B===y){jn=null;break}var O=B.sibling;if(O!==null){O.return=B.return,jn=O;break}jn=B.return}}function o(y){for(;jn!==null;){var B=jn;try{switch(B.tag){case 0:case 11:case 15:var O=B.return;try{qm(4,B)}catch(qt){In(B,O,qt)}break;case 1:var G=B.stateNode;if(typeof G.componentDidMount=="function"){var re=B.return;try{G.componentDidMount()}catch(qt){In(B,re,qt)}}var de=B.return;try{$m(B)}catch(qt){In(B,de,qt)}break;case 5:var We=B.return;try{$m(B)}catch(qt){In(B,We,qt)}}}catch(qt){In(B,B.return,qt)}if(B===y){jn=null;break}var Lt=B.sibling;if(Lt!==null){Lt.return=B.return,jn=Lt;break}jn=B.return}}var h=Math.ceil,m=se.ReactCurrentDispatcher,w=se.ReactCurrentOwner,E=se.ReactCurrentBatchConfig,S=0,F=null,D=null,Q=0,V=0,Z=ru(0),K=0,ee=null,he=0,le=0,Ae=0,fe=null,Ce=null,ke=0,He=1/0,$e=null,it=!1,ct=null,Xe=null,Ye=!1,tt=null,Pt=0,gt=0,Jt=null,kt=-1,or=0;function pr(){return(S&6)!==0?en():kt!==-1?kt:kt=en()}function It(y){return(y.mode&1)===0?1:(S&2)!==0&&Q!==0?Q&-Q:So.transition!==null?(or===0&&(or=bc()),or):(y=ma,y!==0||(y=window.event,y=y===void 0?16:rc(y.type)),y)}function ht(y,B,O,G){if(50<gt)throw gt=0,Jt=null,Error(r(185));ll(y,O,G),((S&2)===0||y!==F)&&(y===F&&((S&2)===0&&(le|=O),K===4&&Br(y,Q)),zt(y,G),O===1&&S===0&&(B.mode&1)===0&&(He=en()+500,wf&&ve()))}function zt(y,B){var O=y.callbackNode;No(y,B);var G=Cl(y,y===F?Q:0);if(G===0)O!==null&&qr(O),y.callbackNode=null,y.callbackPriority=0;else if(B=G&-G,y.callbackPriority!==B){if(O!=null&&qr(O),B===1)y.tag===0?ce(ln.bind(null,y)):W(ln.bind(null,y)),OA(function(){(S&6)===0&&ve()}),O=null;else{switch($c(G)){case 1:O=Kn;break;case 4:O=Sn;break;case 16:O=Ii;break;case 536870912:O=sa;break;default:O=Ii}O=ga(O,Ot.bind(null,y))}y.callbackPriority=B,y.callbackNode=O}}function Ot(y,B){if(kt=-1,or=0,(S&6)!==0)throw Error(r(327));var O=y.callbackNode;if(Ni()&&y.callbackNode!==O)return null;var G=Cl(y,y===F?Q:0);if(G===0)return null;if((G&30)!==0||(G&y.expiredLanes)!==0||B)B=ji(y,G);else{B=G;var re=S;S|=2;var de=Wn();(F!==y||Q!==B)&&($e=null,He=en()+500,cn(y,B));do try{Wi();break}catch(Lt){Ln(y,Lt)}while(!0);La(),m.current=de,S=re,D!==null?B=0:(F=null,Q=0,B=K)}if(B!==0){if(B===2&&(re=fh(y),re!==0&&(G=re,B=fr(y,re))),B===1)throw O=ee,cn(y,0),Br(y,G),zt(y,en()),O;if(B===6)Br(y,G);else{if(re=y.current.alternate,(G&30)===0&&!yr(re)&&(B=ji(y,G),B===2&&(de=fh(y),de!==0&&(G=de,B=fr(y,de))),B===1))throw O=ee,cn(y,0),Br(y,G),zt(y,en()),O;switch(y.finishedWork=re,y.finishedLanes=G,B){case 0:case 1:throw Error(r(345));case 2:ei(y,Ce,$e);break;case 3:if(Br(y,G),(G&130023424)===G&&(B=ke+500-en(),10<B)){if(Cl(y,0)!==0)break;if(re=y.suspendedLanes,(re&G)!==G){pr(),y.pingedLanes|=y.suspendedLanes&re;break}y.timeoutHandle=Jd(ei.bind(null,y,Ce,$e),B);break}ei(y,Ce,$e);break;case 4:if(Br(y,G),(G&4194240)===G)break;for(B=y.eventTimes,re=-1;0<G;){var We=31-so(G);de=1<<We,We=B[We],We>re&&(re=We),G&=~de}if(G=re,G=en()-G,G=(120>G?120:480>G?480:1080>G?1080:1920>G?1920:3e3>G?3e3:4320>G?4320:1960*h(G/1960))-G,10<G){y.timeoutHandle=Jd(ei.bind(null,y,Ce,$e),G);break}ei(y,Ce,$e);break;case 5:ei(y,Ce,$e);break;default:throw Error(r(329))}}}return zt(y,en()),y.callbackNode===O?Ot.bind(null,y):null}function fr(y,B){var O=fe;return y.current.memoizedState.isDehydrated&&(cn(y,B).flags|=256),y=ji(y,B),y!==2&&(B=Ce,Ce=O,B!==null&&Ar(B)),y}function Ar(y){Ce===null?Ce=y:Ce.push.apply(Ce,y)}function yr(y){for(var B=y;;){if(B.flags&16384){var O=B.updateQueue;if(O!==null&&(O=O.stores,O!==null))for(var G=0;G<O.length;G++){var re=O[G],de=re.getSnapshot;re=re.value;try{if(!Vs(de(),re))return!1}catch{return!1}}}if(O=B.child,B.subtreeFlags&16384&&O!==null)O.return=B,B=O;else{if(B===y)break;for(;B.sibling===null;){if(B.return===null||B.return===y)return!0;B=B.return}B.sibling.return=B.return,B=B.sibling}}return!0}function Br(y,B){for(B&=~Ae,B&=~le,y.suspendedLanes|=B,y.pingedLanes&=~B,y=y.expirationTimes;0<B;){var O=31-so(B),G=1<<O;y[O]=-1,B&=~G}}function ln(y){if((S&6)!==0)throw Error(r(327));Ni();var B=Cl(y,0);if((B&1)===0)return zt(y,en()),null;var O=ji(y,B);if(y.tag!==0&&O===2){var G=fh(y);G!==0&&(B=G,O=fr(y,G))}if(O===1)throw O=ee,cn(y,0),Br(y,B),zt(y,en()),O;if(O===6)throw Error(r(345));return y.finishedWork=y.current.alternate,y.finishedLanes=B,ei(y,Ce,$e),zt(y,en()),null}function dn(y,B){var O=S;S|=1;try{return y(B)}finally{S=O,S===0&&(He=en()+500,wf&&ve())}}function Wr(y){tt!==null&&tt.tag===0&&(S&6)===0&&Ni();var B=S;S|=1;var O=E.transition,G=ma;try{if(E.transition=null,ma=1,y)return y()}finally{ma=G,E.transition=O,S=B,(S&6)===0&&ve()}}function An(){V=Z.current,ka(Z)}function cn(y,B){y.finishedWork=null,y.finishedLanes=0;var O=y.timeoutHandle;if(O!==-1&&(y.timeoutHandle=-1,ep(O)),D!==null)for(O=D.return;O!==null;){var G=O;switch(gr(G),G.tag){case 1:G=G.type.childContextTypes,G!=null&&xf();break;case 3:$o(),ka(Ml),ka(Is),np();break;case 5:rp(G);break;case 4:$o();break;case 13:ka(Fo);break;case 19:ka(Fo);break;case 10:wo(G.type._context);break;case 22:case 23:An()}O=O.return}if(F=y,D=y=Gl(y.current,null),Q=V=B,K=0,ee=null,Ae=le=he=0,Ce=fe=null,ja!==null){for(B=0;B<ja.length;B++)if(O=ja[B],G=O.interleaved,G!==null){O.interleaved=null;var re=G.next,de=O.pending;if(de!==null){var We=de.next;de.next=re,G.next=We}O.pending=G}ja=null}return y}function Ln(y,B){do{var O=D;try{if(La(),au.current=Rc,Xf){for(var G=Po.memoizedState;G!==null;){var re=G.queue;re!==null&&(re.pending=null),G=G.next}Xf=!1}if(Pc=0,ws=is=Po=null,Hl=!1,Tu=0,w.current=null,O===null||O.return===null){K=1,ee=B,D=null;break}e:{var de=y,We=O.return,Lt=O,qt=B;if(B=Q,Lt.flags|=32768,qt!==null&&typeof qt=="object"&&typeof qt.then=="function"){var Or=qt,pn=Lt,wn=pn.tag;if((pn.mode&1)===0&&(wn===0||wn===11||wn===15)){var vn=pn.alternate;vn?(pn.updateQueue=vn.updateQueue,pn.memoizedState=vn.memoizedState,pn.lanes=vn.lanes):(pn.updateQueue=null,pn.memoizedState=null)}var qn=Um(We);if(qn!==null){qn.flags&=-257,hp(qn,We,Lt,de,B),qn.mode&1&&zA(de,Or,B),B=qn,qt=Or;var fi=B.updateQueue;if(fi===null){var pi=new Set;pi.add(qt),B.updateQueue=pi}else fi.add(qt);break e}else{if((B&1)===0){zA(de,Or,B),hi();break e}qt=Error(r(426))}}else if(Gr&&Lt.mode&1){var _l=Um(We);if(_l!==null){(_l.flags&65536)===0&&(_l.flags|=256),hp(_l,We,Lt,de,B),Tn(Yh(qt,Lt));break e}}de=qt=Yh(qt,Lt),K!==4&&(K=2),fe===null?fe=[de]:fe.push(de),de=We;do{switch(de.tag){case 3:de.flags|=65536,B&=-B,de.lanes|=B;var _r=Rm(de,qt,B);Io(de,_r);break e;case 1:Lt=qt;var nr=de.type,Sr=de.stateNode;if((de.flags&128)===0&&(typeof nr.getDerivedStateFromError=="function"||Sr!==null&&typeof Sr.componentDidCatch=="function"&&(Xe===null||!Xe.has(Sr)))){de.flags|=65536,B&=-B,de.lanes|=B;var Bn=km(de,Lt,B);Io(de,Bn);break e}}de=de.return}while(de!==null)}va(O)}catch(Ei){B=Ei,D===O&&O!==null&&(D=O=O.return);continue}break}while(!0)}function Wn(){var y=m.current;return m.current=Rc,y===null?Rc:y}function hi(){(K===0||K===3||K===2)&&(K=4),F===null||(he&268435455)===0&&(le&268435455)===0||Br(F,Q)}function ji(y,B){var O=S;S|=2;var G=Wn();(F!==y||Q!==B)&&($e=null,cn(y,B));do try{Hn();break}catch(re){Ln(y,re)}while(!0);if(La(),S=O,m.current=G,D!==null)throw Error(r(261));return F=null,Q=0,K}function Hn(){for(;D!==null;)Ji(D)}function Wi(){for(;D!==null&&!Hr();)Ji(D)}function Ji(y){var B=ia(y.alternate,y,V);y.memoizedProps=y.pendingProps,B===null?va(y):D=B,w.current=null}function va(y){var B=y;do{var O=B.alternate;if(y=B.return,(B.flags&32768)===0){if(O=Gg(O,B,V),O!==null){D=O;return}}else{if(O=Km(O,B),O!==null){O.flags&=32767,D=O;return}if(y!==null)y.flags|=32768,y.subtreeFlags=0,y.deletions=null;else{K=6,D=null;return}}if(B=B.sibling,B!==null){D=B;return}D=B=y}while(B!==null);K===0&&(K=5)}function ei(y,B,O){var G=ma,re=E.transition;try{E.transition=null,ma=1,qi(y,B,O,G)}finally{E.transition=re,ma=G}return null}function qi(y,B,O,G){do Ni();while(tt!==null);if((S&6)!==0)throw Error(r(327));O=y.finishedWork;var re=y.finishedLanes;if(O===null)return null;if(y.finishedWork=null,y.finishedLanes=0,O===y.current)throw Error(r(177));y.callbackNode=null,y.callbackPriority=0;var de=O.lanes|O.childLanes;if(cl(y,de),y===F&&(D=F=null,Q=0),(O.subtreeFlags&2064)===0&&(O.flags&2064)===0||Ye||(Ye=!0,ga(Ii,function(){return Ni(),null})),de=(O.flags&15990)!==0,(O.subtreeFlags&15990)!==0||de){de=E.transition,E.transition=null;var We=ma;ma=1;var Lt=S;S|=4,w.current=null,W0(y,O),$0(O,y),jh(bh),Uf=!!gf,bh=gf=null,y.current=O,X0(O),Jr(),S=Lt,ma=We,E.transition=de}else y.current=O;if(Ye&&(Ye=!1,tt=y,Pt=re),de=y.pendingLanes,de===0&&(Xe=null),es(O.stateNode),zt(y,en()),B!==null)for(G=y.onRecoverableError,O=0;O<B.length;O++)re=B[O],G(re.value,{componentStack:re.stack,digest:re.digest});if(it)throw it=!1,y=ct,ct=null,y;return(Pt&1)!==0&&y.tag!==0&&Ni(),de=y.pendingLanes,(de&1)!==0?y===Jt?gt++:(gt=0,Jt=y):gt=0,ve(),null}function Ni(){if(tt!==null){var y=$c(Pt),B=E.transition,O=ma;try{if(E.transition=null,ma=16>y?16:y,tt===null)var G=!1;else{if(y=tt,tt=null,Pt=0,(S&6)!==0)throw Error(r(331));var re=S;for(S|=4,jn=y.current;jn!==null;){var de=jn,We=de.child;if((jn.flags&16)!==0){var Lt=de.deletions;if(Lt!==null){for(var qt=0;qt<Lt.length;qt++){var Or=Lt[qt];for(jn=Or;jn!==null;){var pn=jn;switch(pn.tag){case 0:case 11:case 15:rA(8,pn,de)}var wn=pn.child;if(wn!==null)wn.return=pn,jn=wn;else for(;jn!==null;){pn=jn;var vn=pn.sibling,qn=pn.return;if(Xm(pn),pn===Or){jn=null;break}if(vn!==null){vn.return=qn,jn=vn;break}jn=qn}}}var fi=de.alternate;if(fi!==null){var pi=fi.child;if(pi!==null){fi.child=null;do{var _l=pi.sibling;pi.sibling=null,pi=_l}while(pi!==null)}}jn=de}}if((de.subtreeFlags&2064)!==0&&We!==null)We.return=de,jn=We;else e:for(;jn!==null;){if(de=jn,(de.flags&2048)!==0)switch(de.tag){case 0:case 11:case 15:rA(9,de,de.return)}var _r=de.sibling;if(_r!==null){_r.return=de.return,jn=_r;break e}jn=de.return}}var nr=y.current;for(jn=nr;jn!==null;){We=jn;var Sr=We.child;if((We.subtreeFlags&2064)!==0&&Sr!==null)Sr.return=We,jn=Sr;else e:for(We=nr;jn!==null;){if(Lt=jn,(Lt.flags&2048)!==0)try{switch(Lt.tag){case 0:case 11:case 15:qm(9,Lt)}}catch(Ei){In(Lt,Lt.return,Ei)}if(Lt===We){jn=null;break e}var Bn=Lt.sibling;if(Bn!==null){Bn.return=Lt.return,jn=Bn;break e}jn=Lt.return}}if(S=re,ve(),Ra&&typeof Ra.onPostCommitFiberRoot=="function")try{Ra.onPostCommitFiberRoot(Ya,y)}catch{}G=!0}return G}finally{ma=O,E.transition=B}}return!1}function na(y,B,O){B=Yh(O,B),B=Rm(y,B,1),y=us(y,B,1),B=pr(),y!==null&&(ll(y,1,B),zt(y,B))}function In(y,B,O){if(y.tag===3)na(y,y,O);else for(;B!==null;){if(B.tag===3){na(B,y,O);break}else if(B.tag===1){var G=B.stateNode;if(typeof B.type.getDerivedStateFromError=="function"||typeof G.componentDidCatch=="function"&&(Xe===null||!Xe.has(G))){y=Yh(O,y),y=km(B,y,1),B=us(B,y,1),y=pr(),B!==null&&(ll(B,1,y),zt(B,y));break}}B=B.return}}function Aa(y,B,O){var G=y.pingCache;G!==null&&G.delete(B),B=pr(),y.pingedLanes|=y.suspendedLanes&O,F===y&&(Q&O)===O&&(K===4||K===3&&(Q&130023424)===Q&&500>en()-ke?cn(y,0):Ae|=O),zt(y,B)}function ea(y,B){B===0&&((y.mode&1)===0?B=1:(B=Ul,Ul<<=1,(Ul&130023424)===0&&(Ul=4194304)));var O=pr();y=co(y,B),y!==null&&(ll(y,B,O),zt(y,O))}function io(y){var B=y.memoizedState,O=0;B!==null&&(O=B.retryLane),ea(y,O)}function Ki(y,B){var O=0;switch(y.tag){case 13:var G=y.stateNode,re=y.memoizedState;re!==null&&(O=re.retryLane);break;case 19:G=y.stateNode;break;default:throw Error(r(314))}G!==null&&G.delete(B),ea(y,O)}var ia;ia=function(y,B,O){if(y!==null)if(y.memoizedProps!==B.pendingProps||Ml.current)tl=!0;else{if((y.lanes&O)===0&&(B.flags&128)===0)return tl=!1,no(y,B,O);tl=(y.flags&131072)!==0}else tl=!1,Gr&&(B.flags&1048576)!==0&&lr(B,ut,B.index);switch(B.lanes=0,B.tag){case 2:var G=B.type;Vm(y,B),y=B.pendingProps;var re=yf(B,Is.current);cs(B,O),re=Eh(null,B,G,y,re,O);var de=_a();return B.flags|=1,typeof re=="object"&&re!==null&&typeof re.render=="function"&&re.$$typeof===void 0?(B.tag=1,B.memoizedState=null,B.updateQueue=null,Ol(G)?(de=!0,Kh(B)):de=!1,B.memoizedState=re.state!==null&&re.state!==void 0?re.state:null,qo(B),re.updater=Xh,B.stateNode=re,re._reactInternals=B,cp(B,G,y,O),B=fp(null,B,G,!0,de,O)):(B.tag=0,Gr&&de&&Qr(B),uc(null,B,re,O),B=B.child),B;case 16:G=B.elementType;e:{switch(Vm(y,B),y=B.pendingProps,re=G._init,G=re(G._payload),B.type=G,re=B.tag=ml(G),y=Fu(G,y),re){case 0:B=Vp(null,B,G,y,O);break e;case 1:B=Ng(null,B,G,y,O);break e;case 11:B=Nm(null,B,G,y,O);break e;case 14:B=jp(null,B,G,Fu(G.type,y),O);break e}throw Error(r(306,G,""))}return B;case 0:return G=B.type,re=B.pendingProps,re=B.elementType===G?re:Fu(G,re),Vp(y,B,G,re,O);case 1:return G=B.type,re=B.pendingProps,re=B.elementType===G?re:Fu(G,re),Ng(y,B,G,re,O);case 3:e:{if(Ap(B),y===null)throw Error(r(387));G=B.pendingProps,de=B.memoizedState,re=de.element,bo(y,B),el(B,G,null,O);var We=B.memoizedState;if(G=We.element,de.isDehydrated)if(de={element:G,isDehydrated:!1,cache:We.cache,pendingSuspenseBoundaries:We.pendingSuspenseBoundaries,transitions:We.transitions},B.updateQueue.baseState=de,B.memoizedState=de,B.flags&256){re=Yh(Error(r(423)),B),B=Qm(y,B,G,O,re);break e}else if(G!==re){re=Yh(Error(r(424)),B),B=Qm(y,B,G,O,re);break e}else for(zr=Pl(B.stateNode.containerInfo.firstChild),Ur=B,Gr=!0,rn=null,O=Ko(B,null,G,O),B.child=O;O;)O.flags=O.flags&-3|4096,O=O.sibling;else{if(Jn(),G===re){B=eA(y,B,O);break e}uc(y,B,G,O)}B=B.child}return B;case 5:return Wh(B),y===null&&si(B),G=B.type,re=B.pendingProps,de=y!==null?y.memoizedProps:null,We=re.children,_f(G,re)?We=null:de!==null&&_f(G,de)&&(B.flags|=32),Hp(y,B),uc(y,B,We,O),B.child;case 6:return y===null&&si(B),null;case 13:return zg(y,B,O);case 4:return Ef(B,B.stateNode.containerInfo),G=B.pendingProps,y===null?B.child=ys(B,null,G,O):uc(y,B,G,O),B.child;case 11:return G=B.type,re=B.pendingProps,re=B.elementType===G?re:Fu(G,re),Nm(y,B,G,re,O);case 7:return uc(y,B,B.pendingProps,O),B.child;case 8:return uc(y,B,B.pendingProps.children,O),B.child;case 12:return uc(y,B,B.pendingProps.children,O),B.child;case 10:e:{if(G=B.type._context,re=B.pendingProps,de=B.memoizedProps,We=re.value,po(Wo,G._currentValue),G._currentValue=We,de!==null)if(Vs(de.value,We)){if(de.children===re.children&&!Ml.current){B=eA(y,B,O);break e}}else for(de=B.child,de!==null&&(de.return=B);de!==null;){var Lt=de.dependencies;if(Lt!==null){We=de.child;for(var qt=Lt.firstContext;qt!==null;){if(qt.context===G){if(de.tag===1){qt=hn(-1,O&-O),qt.tag=2;var Or=de.updateQueue;if(Or!==null){Or=Or.shared;var pn=Or.pending;pn===null?qt.next=qt:(qt.next=pn.next,pn.next=qt),Or.pending=qt}}de.lanes|=O,qt=de.alternate,qt!==null&&(qt.lanes|=O),qa(de.return,O,B),Lt.lanes|=O;break}qt=qt.next}}else if(de.tag===10)We=de.type===B.type?null:de.child;else if(de.tag===18){if(We=de.return,We===null)throw Error(r(341));We.lanes|=O,Lt=We.alternate,Lt!==null&&(Lt.lanes|=O),qa(We,O,B),We=de.sibling}else We=de.child;if(We!==null)We.return=de;else for(We=de;We!==null;){if(We===B){We=null;break}if(de=We.sibling,de!==null){de.return=We.return,We=de;break}We=We.return}de=We}uc(y,B,re.children,O),B=B.child}return B;case 9:return re=B.type,G=B.pendingProps.children,cs(B,O),re=rs(re),G=G(re),B.flags|=1,uc(y,B,G,O),B.child;case 14:return G=B.type,re=Fu(G,B.pendingProps),re=Fu(G.type,re),jp(y,B,G,re,O);case 15:return xd(y,B,B.type,B.pendingProps,O);case 17:return G=B.type,re=B.pendingProps,re=B.elementType===G?re:Fu(G,re),Vm(y,B),B.tag=1,Ol(G)?(y=!0,Kh(B)):y=!1,cs(B,O),Zh(B,G,re),cp(B,G,re,O),fp(null,B,G,!0,y,O);case 19:return jg(y,B,O);case 22:return zm(y,B,O)}throw Error(r(156,B.tag))};function ga(y,B){return br(y,B)}function Zo(y,B,O,G){this.tag=y,this.key=O,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=B,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=G,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ma(y,B,O,G){return new Zo(y,B,O,G)}function Do(y){return y=y.prototype,!(!y||!y.isReactComponent)}function ml(y){if(typeof y=="function")return Do(y)?1:0;if(y!=null){if(y=y.$$typeof,y===Ie)return 11;if(y===Et)return 14}return 2}function Gl(y,B){var O=y.alternate;return O===null?(O=Ma(y.tag,B,y.key,y.mode),O.elementType=y.elementType,O.type=y.type,O.stateNode=y.stateNode,O.alternate=y,y.alternate=O):(O.pendingProps=B,O.type=y.type,O.flags=0,O.subtreeFlags=0,O.deletions=null),O.flags=y.flags&14680064,O.childLanes=y.childLanes,O.lanes=y.lanes,O.child=y.child,O.memoizedProps=y.memoizedProps,O.memoizedState=y.memoizedState,O.updateQueue=y.updateQueue,B=y.dependencies,O.dependencies=B===null?null:{lanes:B.lanes,firstContext:B.firstContext},O.sibling=y.sibling,O.index=y.index,O.ref=y.ref,O}function Rl(y,B,O,G,re,de){var We=2;if(G=y,typeof y=="function")Do(y)&&(We=1);else if(typeof y=="string")We=5;else e:switch(y){case Be:return gl(O.children,re,de,B);case De:We=8,re|=8;break;case we:return y=Ma(12,O,B,re|2),y.elementType=we,y.lanes=de,y;case Ze:return y=Ma(13,O,B,re),y.elementType=Ze,y.lanes=de,y;case st:return y=Ma(19,O,B,re),y.elementType=st,y.lanes=de,y;case jt:return rl(O,re,de,B);default:if(typeof y=="object"&&y!==null)switch(y.$$typeof){case nt:We=10;break e;case _e:We=9;break e;case Ie:We=11;break e;case Et:We=14;break e;case Ut:We=16,G=null;break e}throw Error(r(130,y==null?y:typeof y,""))}return B=Ma(We,O,B,re),B.elementType=y,B.type=G,B.lanes=de,B}function gl(y,B,O,G){return y=Ma(7,y,G,B),y.lanes=O,y}function rl(y,B,O,G){return y=Ma(22,y,G,B),y.elementType=jt,y.lanes=O,y.stateNode={isHidden:!1},y}function lu(y,B,O){return y=Ma(6,y,null,B),y.lanes=O,y}function Lu(y,B,O){return B=Ma(4,y.children!==null?y.children:[],y.key,B),B.lanes=O,B.stateNode={containerInfo:y.containerInfo,pendingChildren:null,implementation:y.implementation},B}function Kl(y,B,O,G,re){this.tag=B,this.containerInfo=y,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sl(0),this.expirationTimes=Sl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sl(0),this.identifierPrefix=G,this.onRecoverableError=re,this.mutableSourceEagerHydrationData=null}function mo(y,B,O,G,re,de,We,Lt,qt){return y=new Kl(y,B,O,Lt,qt),B===1?(B=1,de===!0&&(B|=8)):B=0,de=Ma(3,null,null,B),y.current=de,de.stateNode=y,de.memoizedState={element:G,isDehydrated:O,cache:null,transitions:null,pendingSuspenseBoundaries:null},qo(de),y}function go(y,B,O){var G=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Se,key:G==null?null:""+G,children:y,containerInfo:B,implementation:O}}function Ca(y){if(!y)return nu;y=y._reactInternals;e:{if(Oe(y)!==y||y.tag!==1)throw Error(r(170));var B=y;do{switch(B.tag){case 3:B=B.stateNode.context;break e;case 1:if(Ol(B.type)){B=B.stateNode.__reactInternalMemoizedMergedChildContext;break e}}B=B.return}while(B!==null);throw Error(r(171))}if(y.tag===1){var O=y.type;if(Ol(O))return pd(y,O,B)}return B}function hs(y,B,O,G,re,de,We,Lt,qt){return y=mo(O,G,!0,y,re,de,We,Lt,qt),y.context=Ca(null),O=y.current,G=pr(),re=It(O),de=hn(G,re),de.callback=B??null,us(O,de,re),y.current.lanes=re,ll(y,re,G),zt(y,G),y}function Rs(y,B,O,G){var re=B.current,de=pr(),We=It(re);return O=Ca(O),B.context===null?B.context=O:B.pendingContext=O,B=hn(de,We),B.payload={element:y},G=G===void 0?null:G,G!==null&&(B.callback=G),y=us(re,B,We),y!==null&&(ht(y,re,We,de),jl(y,re,We)),We}function uo(y){if(y=y.current,!y.child)return null;switch(y.child.tag){case 5:return y.child.stateNode;default:return y.child.stateNode}}function Mu(y,B){if(y=y.memoizedState,y!==null&&y.dehydrated!==null){var O=y.retryLane;y.retryLane=O!==0&&O<B?O:B}}function nA(y,B){Mu(y,B),(y=y.alternate)&&Mu(y,B)}function jA(){return null}var bd=typeof reportError=="function"?reportError:function(y){console.error(y)};function HA(y){this._internalRoot=y}kc.prototype.render=HA.prototype.render=function(y){var B=this._internalRoot;if(B===null)throw Error(r(409));Rs(y,B,null,null)},kc.prototype.unmount=HA.prototype.unmount=function(){var y=this._internalRoot;if(y!==null){this._internalRoot=null;var B=y.containerInfo;Wr(function(){Rs(null,y,null,null)}),B[Ll]=null}};function kc(y){this._internalRoot=y}kc.prototype.unstable_scheduleHydration=function(y){if(y){var B=zh();y={blockedOn:null,target:y,priority:B};for(var O=0;O<Ec.length&&B!==0&&B<Ec[O].priority;O++);Ec.splice(O,0,y),O===0&&Kd(y)}};function Ch(y){return!(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)}function Yo(y){return!(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11&&(y.nodeType!==8||y.nodeValue!==" react-mount-point-unstable "))}function Ou(){}function Ed(y,B,O,G,re){if(re){if(typeof G=="function"){var de=G;G=function(){var Or=uo(We);de.call(Or)}}var We=hs(B,G,y,0,null,!1,!1,"",Ou);return y._reactRootContainer=We,y[Ll]=We.current,Vf(y.nodeType===8?y.parentNode:y),Wr(),We}for(;re=y.lastChild;)y.removeChild(re);if(typeof G=="function"){var Lt=G;G=function(){var Or=uo(qt);Lt.call(Or)}}var qt=mo(y,0,!1,null,null,!1,!1,"",Ou);return y._reactRootContainer=qt,y[Ll]=qt.current,Vf(y.nodeType===8?y.parentNode:y),Wr(function(){Rs(B,qt,O,G)}),qt}function Z0(y,B,O,G,re){var de=O._reactRootContainer;if(de){var We=de;if(typeof re=="function"){var Lt=re;re=function(){var qt=uo(We);Lt.call(qt)}}Rs(B,We,y,re)}else We=Ed(O,B,y,re,G);return uo(We)}ec=function(y){switch(y.tag){case 3:var B=y.stateNode;if(B.current.memoizedState.isDehydrated){var O=wc(B.pendingLanes);O!==0&&(Nl(B,O|1),zt(B,en()),(S&6)===0&&(He=en()+500,ve()))}break;case 13:Wr(function(){var G=co(y,1);if(G!==null){var re=pr();ht(G,y,1,re)}}),nA(y,1)}},Nh=function(y){if(y.tag===13){var B=co(y,134217728);if(B!==null){var O=pr();ht(B,y,134217728,O)}nA(y,134217728)}},Ah=function(y){if(y.tag===13){var B=It(y),O=co(y,B);if(O!==null){var G=pr();ht(O,y,B,G)}nA(y,B)}},zh=function(){return ma},hf=function(y,B){var O=ma;try{return ma=y,B()}finally{ma=O}},oo=function(y,B,O){switch(B){case"input":if($r(y,O),B=O.name,O.type==="radio"&&B!=null){for(O=y;O.parentNode;)O=O.parentNode;for(O=O.querySelectorAll("input[name="+JSON.stringify(""+B)+'][type="radio"]'),B=0;B<O.length;B++){var G=O[B];if(G!==y&&G.form===y.form){var re=$f(G);if(!re)throw Error(r(90));Zt(G),$r(G,re)}}}break;case"textarea":Vi(y,O);break;case"select":B=O.value,B!=null&&yn(y,!!O.multiple,B,!1)}},Bo=dn,xc=Wr;var Y0={usingClientEntryPoint:!1,Events:[qf,Gh,$f,Ea,hr,dn]},Wg={findFiberByHostInstance:vf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},J1={bundleType:Wg.bundleType,version:Wg.version,rendererPackageName:Wg.rendererPackageName,rendererConfig:Wg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:se.ReactCurrentDispatcher,findHostInstanceByFiber:function(y){return y=Vt(y),y===null?null:y.stateNode},findFiberByHostInstance:Wg.findFiberByHostInstance||jA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wp.isDisabled&&Wp.supportsFiber)try{Ya=Wp.inject(J1),Ra=Wp}catch{}}return Tf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y0,Tf.createPortal=function(y,B){var O=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ch(B))throw Error(r(200));return go(y,B,null,O)},Tf.createRoot=function(y,B){if(!Ch(y))throw Error(r(299));var O=!1,G="",re=bd;return B!=null&&(B.unstable_strictMode===!0&&(O=!0),B.identifierPrefix!==void 0&&(G=B.identifierPrefix),B.onRecoverableError!==void 0&&(re=B.onRecoverableError)),B=mo(y,1,!1,null,null,O,!1,G,re),y[Ll]=B.current,Vf(y.nodeType===8?y.parentNode:y),new HA(B)},Tf.findDOMNode=function(y){if(y==null)return null;if(y.nodeType===1)return y;var B=y._reactInternals;if(B===void 0)throw typeof y.render=="function"?Error(r(188)):(y=Object.keys(y).join(","),Error(r(268,y)));return y=Vt(B),y=y===null?null:y.stateNode,y},Tf.flushSync=function(y){return Wr(y)},Tf.hydrate=function(y,B,O){if(!Yo(B))throw Error(r(200));return Z0(null,y,B,!0,O)},Tf.hydrateRoot=function(y,B,O){if(!Ch(y))throw Error(r(405));var G=O!=null&&O.hydratedSources||null,re=!1,de="",We=bd;if(O!=null&&(O.unstable_strictMode===!0&&(re=!0),O.identifierPrefix!==void 0&&(de=O.identifierPrefix),O.onRecoverableError!==void 0&&(We=O.onRecoverableError)),B=hs(B,null,y,1,O??null,re,!1,de,We),y[Ll]=B.current,Vf(y),G)for(y=0;y<G.length;y++)O=G[y],re=O._getVersion,re=re(O._source),B.mutableSourceEagerHydrationData==null?B.mutableSourceEagerHydrationData=[O,re]:B.mutableSourceEagerHydrationData.push(O,re);return new kc(B)},Tf.render=function(y,B,O){if(!Yo(B))throw Error(r(200));return Z0(null,y,B,!1,O)},Tf.unmountComponentAtNode=function(y){if(!Yo(y))throw Error(r(40));return y._reactRootContainer?(Wr(function(){Z0(null,null,y,!1,function(){y._reactRootContainer=null,y[Ll]=null})}),!0):!1},Tf.unstable_batchedUpdates=dn,Tf.unstable_renderSubtreeIntoContainer=function(y,B,O,G){if(!Yo(O))throw Error(r(200));if(y==null||y._reactInternals===void 0)throw Error(r(38));return Z0(y,B,O,!1,G)},Tf.version="18.3.1-next-f1338f8080-20240426",Tf}var pM;function w6(){if(pM)return OB.exports;pM=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),OB.exports=bq(),OB.exports}var mM;function Eq(){if(mM)return Gx;mM=1;var e=w6();return Gx.createRoot=e.createRoot,Gx.hydrateRoot=e.hydrateRoot,Gx}var Bq=Eq();const Cq=od(Bq);/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var gM="popstate";function Sq(e={}){function t(n,l){let{pathname:u,search:d,hash:a}=n.location;return yT("",{pathname:u,search:d,hash:a},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function r(n,l){return typeof l=="string"?l:i1(l)}return Iq(t,r,null,e)}function El(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ud(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Tq(){return Math.random().toString(36).substring(2,10)}function _M(e,t){return{usr:e.state,key:e.key,idx:t}}function yT(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?fv(t):t,state:r,key:t&&t.key||n||Tq()}}function i1({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function fv(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function Iq(e,t,r,n={}){let{window:l=document.defaultView,v5Compat:u=!1}=n,d=l.history,a="POP",v=null,x=b();x==null&&(x=0,d.replaceState({...d.state,idx:x},""));function b(){return(d.state||{idx:null}).idx}function I(){a="POP";let H=b(),q=H==null?null:H-x;x=H,v&&v({action:a,location:R.location,delta:q})}function M(H,q){a="PUSH";let te=yT(R.location,H,q);x=b()+1;let J=_M(te,x),se=R.createHref(te);try{d.pushState(J,"",se)}catch(ye){if(ye instanceof DOMException&&ye.name==="DataCloneError")throw ye;l.location.assign(se)}u&&v&&v({action:a,location:R.location,delta:1})}function L(H,q){a="REPLACE";let te=yT(R.location,H,q);x=b();let J=_M(te,x),se=R.createHref(te);d.replaceState(J,"",se),u&&v&&v({action:a,location:R.location,delta:0})}function U(H){return Fq(H)}let R={get action(){return a},get location(){return e(l,d)},listen(H){if(v)throw new Error("A history only accepts one active listener");return l.addEventListener(gM,I),v=H,()=>{l.removeEventListener(gM,I),v=null}},createHref(H){return t(l,H)},createURL:U,encodeLocation(H){let q=U(H);return{pathname:q.pathname,search:q.search,hash:q.hash}},push:M,replace:L,go(H){return d.go(H)}};return R}function Fq(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),El(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:i1(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function b6(e,t,r="/"){return Pq(e,t,r,!1)}function Pq(e,t,r,n){let l=typeof t=="string"?fv(t):t,u=fm(l.pathname||"/",r);if(u==null)return null;let d=E6(e);Lq(d);let a=null;for(let v=0;a==null&&v<d.length;++v){let x=Hq(u);a=Qq(d[v],x,n)}return a}function E6(e,t=[],r=[],n="",l=!1){let u=(d,a,v=l,x)=>{let b={relativePath:x===void 0?d.path||"":x,caseSensitive:d.caseSensitive===!0,childrenIndex:a,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(n)&&v)return;El(b.relativePath.startsWith(n),`Absolute route path "${b.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(n.length)}let I=am([n,b.relativePath]),M=r.concat(b);d.children&&d.children.length>0&&(El(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${I}".`),E6(d.children,t,M,I,v)),!(d.path==null&&!d.index)&&t.push({path:I,score:Nq(I,d.index),routesMeta:M})};return e.forEach((d,a)=>{if(d.path===""||!d.path?.includes("?"))u(d,a);else for(let v of B6(d.path))u(d,a,!0,v)}),t}function B6(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,l=r.endsWith("?"),u=r.replace(/\?$/,"");if(n.length===0)return l?[u,""]:[u];let d=B6(n.join("/")),a=[];return a.push(...d.map(v=>v===""?u:[u,v].join("/"))),l&&a.push(...d),a.map(v=>e.startsWith("/")&&v===""?"/":v)}function Lq(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:zq(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var Mq=/^:[\w-]+$/,Oq=3,Dq=2,Rq=1,kq=10,Uq=-2,vM=e=>e==="*";function Nq(e,t){let r=e.split("/"),n=r.length;return r.some(vM)&&(n+=Uq),t&&(n+=Dq),r.filter(l=>!vM(l)).reduce((l,u)=>l+(Mq.test(u)?Oq:u===""?Rq:kq),n)}function zq(e,t){return e.length===t.length&&e.slice(0,-1).every((n,l)=>n===t[l])?e[e.length-1]-t[t.length-1]:0}function Qq(e,t,r=!1){let{routesMeta:n}=e,l={},u="/",d=[];for(let a=0;a<n.length;++a){let v=n[a],x=a===n.length-1,b=u==="/"?t:t.slice(u.length)||"/",I=c2({path:v.relativePath,caseSensitive:v.caseSensitive,end:x},b),M=v.route;if(!I&&x&&r&&!n[n.length-1].route.index&&(I=c2({path:v.relativePath,caseSensitive:v.caseSensitive,end:!1},b)),!I)return null;Object.assign(l,I.params),d.push({params:l,pathname:am([u,I.pathname]),pathnameBase:Wq(am([u,I.pathnameBase])),route:M}),I.pathnameBase!=="/"&&(u=am([u,I.pathnameBase]))}return d}function c2(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=jq(e.path,e.caseSensitive,e.end),l=t.match(r);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),a=l.slice(1);return{params:n.reduce((x,{paramName:b,isOptional:I},M)=>{if(b==="*"){let U=a[M]||"";d=u.slice(0,u.length-U.length).replace(/(.)\/+$/,"$1")}const L=a[M];return I&&!L?x[b]=void 0:x[b]=(L||"").replace(/%2F/g,"/"),x},{}),pathname:u,pathnameBase:d,pattern:e}}function jq(e,t=!1,r=!0){Ud(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],l="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,a,v)=>(n.push({paramName:a,isOptional:v!=null}),v?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),l+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?l+="\\/*$":e!==""&&e!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,t?void 0:"i"),n]}function Hq(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ud(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function fm(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Vq(e,t="/"){let{pathname:r,search:n="",hash:l=""}=typeof e=="string"?fv(e):e;return{pathname:r?r.startsWith("/")?r:Gq(r,t):t,search:qq(n),hash:$q(l)}}function Gq(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(l=>{l===".."?r.length>1&&r.pop():l!=="."&&r.push(l)}),r.length>1?r.join("/"):"/"}function kB(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Kq(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Y5(e){let t=Kq(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function J5(e,t,r,n=!1){let l;typeof e=="string"?l=fv(e):(l={...e},El(!l.pathname||!l.pathname.includes("?"),kB("?","pathname","search",l)),El(!l.pathname||!l.pathname.includes("#"),kB("#","pathname","hash",l)),El(!l.search||!l.search.includes("#"),kB("#","search","hash",l)));let u=e===""||l.pathname==="",d=u?"/":l.pathname,a;if(d==null)a=r;else{let I=t.length-1;if(!n&&d.startsWith("..")){let M=d.split("/");for(;M[0]==="..";)M.shift(),I-=1;l.pathname=M.join("/")}a=I>=0?t[I]:"/"}let v=Vq(l,a),x=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&r.endsWith("/");return!v.pathname.endsWith("/")&&(x||b)&&(v.pathname+="/"),v}var am=e=>e.join("/").replace(/\/\/+/g,"/"),Wq=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),qq=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,$q=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Xq(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var C6=["POST","PUT","PATCH","DELETE"];new Set(C6);var Zq=["GET",...C6];new Set(Zq);var Av=Me.createContext(null);Av.displayName="DataRouter";var wb=Me.createContext(null);wb.displayName="DataRouterState";Me.createContext(!1);var S6=Me.createContext({isTransitioning:!1});S6.displayName="ViewTransition";var Yq=Me.createContext(new Map);Yq.displayName="Fetchers";var Jq=Me.createContext(null);Jq.displayName="Await";var zd=Me.createContext(null);zd.displayName="Navigation";var S1=Me.createContext(null);S1.displayName="Location";var Pp=Me.createContext({outlet:null,matches:[],isDataRoute:!1});Pp.displayName="Route";var eI=Me.createContext(null);eI.displayName="RouteError";function e$(e,{relative:t}={}){El(dv(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=Me.useContext(zd),{hash:l,pathname:u,search:d}=T1(e,{relative:t}),a=u;return r!=="/"&&(a=u==="/"?r:am([r,u])),n.createHref({pathname:a,search:d,hash:l})}function dv(){return Me.useContext(S1)!=null}function Pg(){return El(dv(),"useLocation() may be used only in the context of a <Router> component."),Me.useContext(S1).location}var T6="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function I6(e){Me.useContext(zd).static||Me.useLayoutEffect(e)}function bb(){let{isDataRoute:e}=Me.useContext(Pp);return e?A$():t$()}function t$(){El(dv(),"useNavigate() may be used only in the context of a <Router> component.");let e=Me.useContext(Av),{basename:t,navigator:r}=Me.useContext(zd),{matches:n}=Me.useContext(Pp),{pathname:l}=Pg(),u=JSON.stringify(Y5(n)),d=Me.useRef(!1);return I6(()=>{d.current=!0}),Me.useCallback((v,x={})=>{if(Ud(d.current,T6),!d.current)return;if(typeof v=="number"){r.go(v);return}let b=J5(v,JSON.parse(u),l,x.relative==="path");e==null&&t!=="/"&&(b.pathname=b.pathname==="/"?t:am([t,b.pathname])),(x.replace?r.replace:r.push)(b,x.state,x)},[t,r,u,l,e])}Me.createContext(null);function T1(e,{relative:t}={}){let{matches:r}=Me.useContext(Pp),{pathname:n}=Pg(),l=JSON.stringify(Y5(r));return Me.useMemo(()=>J5(e,JSON.parse(l),n,t==="path"),[e,l,n,t])}function r$(e,t){return F6(e,t)}function F6(e,t,r,n,l){El(dv(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=Me.useContext(zd),{matches:d}=Me.useContext(Pp),a=d[d.length-1],v=a?a.params:{},x=a?a.pathname:"/",b=a?a.pathnameBase:"/",I=a&&a.route;{let te=I&&I.path||"";P6(x,!I||te.endsWith("*")||te.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${x}" (under <Route path="${te}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${te}"> to <Route path="${te==="/"?"*":`${te}/*`}">.`)}let M=Pg(),L;if(t){let te=typeof t=="string"?fv(t):t;El(b==="/"||te.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${te.pathname}" was given in the \`location\` prop.`),L=te}else L=M;let U=L.pathname||"/",R=U;if(b!=="/"){let te=b.replace(/^\//,"").split("/");R="/"+U.replace(/^\//,"").split("/").slice(te.length).join("/")}let H=b6(e,{pathname:R});Ud(I||H!=null,`No routes matched location "${L.pathname}${L.search}${L.hash}" `),Ud(H==null||H[H.length-1].route.element!==void 0||H[H.length-1].route.Component!==void 0||H[H.length-1].route.lazy!==void 0,`Matched leaf route at location "${L.pathname}${L.search}${L.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let q=s$(H&&H.map(te=>Object.assign({},te,{params:Object.assign({},v,te.params),pathname:am([b,u.encodeLocation?u.encodeLocation(te.pathname).pathname:te.pathname]),pathnameBase:te.pathnameBase==="/"?b:am([b,u.encodeLocation?u.encodeLocation(te.pathnameBase).pathname:te.pathnameBase])})),d,r,n,l);return t&&q?Me.createElement(S1.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...L},navigationType:"POP"}},q):q}function n$(){let e=f$(),t=Xq(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:n},u={padding:"2px 4px",backgroundColor:n},d=null;return console.error("Error handled by React Router default ErrorBoundary:",e),d=Me.createElement(Me.Fragment,null,Me.createElement("p",null,"💿 Hey developer 👋"),Me.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Me.createElement("code",{style:u},"ErrorBoundary")," or"," ",Me.createElement("code",{style:u},"errorElement")," prop on your route.")),Me.createElement(Me.Fragment,null,Me.createElement("h2",null,"Unexpected Application Error!"),Me.createElement("h3",{style:{fontStyle:"italic"}},t),r?Me.createElement("pre",{style:l},r):null,d)}var i$=Me.createElement(n$,null),a$=class extends Me.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?Me.createElement(Pp.Provider,{value:this.props.routeContext},Me.createElement(eI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function o$({routeContext:e,match:t,children:r}){let n=Me.useContext(Av);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),Me.createElement(Pp.Provider,{value:e},r)}function s$(e,t=[],r=null,n=null,l=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let u=e,d=r?.errors;if(d!=null){let x=u.findIndex(b=>b.route.id&&d?.[b.route.id]!==void 0);El(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let a=!1,v=-1;if(r)for(let x=0;x<u.length;x++){let b=u[x];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(v=x),b.route.id){let{loaderData:I,errors:M}=r,L=b.route.loader&&!I.hasOwnProperty(b.route.id)&&(!M||M[b.route.id]===void 0);if(b.route.lazy||L){a=!0,v>=0?u=u.slice(0,v+1):u=[u[0]];break}}}return u.reduceRight((x,b,I)=>{let M,L=!1,U=null,R=null;r&&(M=d&&b.route.id?d[b.route.id]:void 0,U=b.route.errorElement||i$,a&&(v<0&&I===0?(P6("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),L=!0,R=null):v===I&&(L=!0,R=b.route.hydrateFallbackElement||null)));let H=t.concat(u.slice(0,I+1)),q=()=>{let te;return M?te=U:L?te=R:b.route.Component?te=Me.createElement(b.route.Component,null):b.route.element?te=b.route.element:te=x,Me.createElement(o$,{match:b,routeContext:{outlet:x,matches:H,isDataRoute:r!=null},children:te})};return r&&(b.route.ErrorBoundary||b.route.errorElement||I===0)?Me.createElement(a$,{location:r.location,revalidation:r.revalidation,component:U,error:M,children:q(),routeContext:{outlet:null,matches:H,isDataRoute:!0},unstable_onError:n}):q()},null)}function tI(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function l$(e){let t=Me.useContext(Av);return El(t,tI(e)),t}function c$(e){let t=Me.useContext(wb);return El(t,tI(e)),t}function u$(e){let t=Me.useContext(Pp);return El(t,tI(e)),t}function rI(e){let t=u$(e),r=t.matches[t.matches.length-1];return El(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function h$(){return rI("useRouteId")}function f$(){let e=Me.useContext(eI),t=c$("useRouteError"),r=rI("useRouteError");return e!==void 0?e:t.errors?.[r]}function A$(){let{router:e}=l$("useNavigate"),t=rI("useNavigate"),r=Me.useRef(!1);return I6(()=>{r.current=!0}),Me.useCallback(async(l,u={})=>{Ud(r.current,T6),r.current&&(typeof l=="number"?e.navigate(l):await e.navigate(l,{fromRouteId:t,...u}))},[e,t])}var yM={};function P6(e,t,r){!t&&!yM[e]&&(yM[e]=!0,Ud(!1,r))}Me.memo(d$);function d$({routes:e,future:t,state:r,unstable_onError:n}){return F6(e,void 0,r,n,t)}function Kx({to:e,replace:t,state:r,relative:n}){El(dv(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=Me.useContext(zd);Ud(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=Me.useContext(Pp),{pathname:d}=Pg(),a=bb(),v=J5(e,Y5(u),d,n==="path"),x=JSON.stringify(v);return Me.useEffect(()=>{a(JSON.parse(x),{replace:t,state:r,relative:n})},[a,x,n,t,r]),null}function My(e){El(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function p$({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:l,static:u=!1}){El(!dv(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=e.replace(/^\/*/,"/"),a=Me.useMemo(()=>({basename:d,navigator:l,static:u,future:{}}),[d,l,u]);typeof r=="string"&&(r=fv(r));let{pathname:v="/",search:x="",hash:b="",state:I=null,key:M="default"}=r,L=Me.useMemo(()=>{let U=fm(v,d);return U==null?null:{location:{pathname:U,search:x,hash:b,state:I,key:M},navigationType:n}},[d,v,x,b,I,M,n]);return Ud(L!=null,`<Router basename="${d}"> is not able to match the URL "${v}${x}${b}" because it does not start with the basename, so the <Router> won't render anything.`),L==null?null:Me.createElement(zd.Provider,{value:a},Me.createElement(S1.Provider,{children:t,value:L}))}function m$({children:e,location:t}){return r$(xT(e),t)}function xT(e,t=[]){let r=[];return Me.Children.forEach(e,(n,l)=>{if(!Me.isValidElement(n))return;let u=[...t,l];if(n.type===Me.Fragment){r.push.apply(r,xT(n.props.children,u));return}El(n.type===My,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),El(!n.props.index||!n.props.children,"An index route cannot have child routes.");let d={id:n.props.id||u.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(d.children=xT(n.props.children,u)),r.push(d)}),r}var qw="get",$w="application/x-www-form-urlencoded";function Eb(e){return e!=null&&typeof e.tagName=="string"}function g$(e){return Eb(e)&&e.tagName.toLowerCase()==="button"}function _$(e){return Eb(e)&&e.tagName.toLowerCase()==="form"}function v$(e){return Eb(e)&&e.tagName.toLowerCase()==="input"}function y$(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function x$(e,t){return e.button===0&&(!t||t==="_self")&&!y$(e)}var Wx=null;function w$(){if(Wx===null)try{new FormData(document.createElement("form"),0),Wx=!1}catch{Wx=!0}return Wx}var b$=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function UB(e){return e!=null&&!b$.has(e)?(Ud(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${$w}"`),null):e}function E$(e,t){let r,n,l,u,d;if(_$(e)){let a=e.getAttribute("action");n=a?fm(a,t):null,r=e.getAttribute("method")||qw,l=UB(e.getAttribute("enctype"))||$w,u=new FormData(e)}else if(g$(e)||v$(e)&&(e.type==="submit"||e.type==="image")){let a=e.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let v=e.getAttribute("formaction")||a.getAttribute("action");if(n=v?fm(v,t):null,r=e.getAttribute("formmethod")||a.getAttribute("method")||qw,l=UB(e.getAttribute("formenctype"))||UB(a.getAttribute("enctype"))||$w,u=new FormData(a,e),!w$()){let{name:x,type:b,value:I}=e;if(b==="image"){let M=x?`${x}.`:"";u.append(`${M}x`,"0"),u.append(`${M}y`,"0")}else x&&u.append(x,I)}}else{if(Eb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=qw,n=null,l=$w,d=e}return u&&l==="text/plain"&&(d=u,u=void 0),{action:n,method:r.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function nI(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function B$(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&fm(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function C$(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function S$(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function T$(e,t,r){let n=await Promise.all(e.map(async l=>{let u=t.routes[l.route.id];if(u){let d=await C$(u,r);return d.links?d.links():[]}return[]}));return L$(n.flat(1).filter(S$).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function xM(e,t,r,n,l,u){let d=(v,x)=>r[x]?v.route.id!==r[x].route.id:!0,a=(v,x)=>r[x].pathname!==v.pathname||r[x].route.path?.endsWith("*")&&r[x].params["*"]!==v.params["*"];return u==="assets"?t.filter((v,x)=>d(v,x)||a(v,x)):u==="data"?t.filter((v,x)=>{let b=n.routes[v.route.id];if(!b||!b.hasLoader)return!1;if(d(v,x)||a(v,x))return!0;if(v.route.shouldRevalidate){let I=v.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:v.params,defaultShouldRevalidate:!0});if(typeof I=="boolean")return I}return!0}):[]}function I$(e,t,{includeHydrateFallback:r}={}){return F$(e.map(n=>{let l=t.routes[n.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),r&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function F$(e){return[...new Set(e)]}function P$(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function L$(e,t){let r=new Set;return new Set(t),e.reduce((n,l)=>{let u=JSON.stringify(P$(l));return r.has(u)||(r.add(u),n.push({key:u,link:l})),n},[])}function L6(){let e=Me.useContext(Av);return nI(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function M$(){let e=Me.useContext(wb);return nI(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var iI=Me.createContext(void 0);iI.displayName="FrameworkContext";function M6(){let e=Me.useContext(iI);return nI(e,"You must render this element inside a <HydratedRouter> element"),e}function O$(e,t){let r=Me.useContext(iI),[n,l]=Me.useState(!1),[u,d]=Me.useState(!1),{onFocus:a,onBlur:v,onMouseEnter:x,onMouseLeave:b,onTouchStart:I}=t,M=Me.useRef(null);Me.useEffect(()=>{if(e==="render"&&d(!0),e==="viewport"){let R=q=>{q.forEach(te=>{d(te.isIntersecting)})},H=new IntersectionObserver(R,{threshold:.5});return M.current&&H.observe(M.current),()=>{H.disconnect()}}},[e]),Me.useEffect(()=>{if(n){let R=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(R)}}},[n]);let L=()=>{l(!0)},U=()=>{l(!1),d(!1)};return r?e!=="intent"?[u,M,{}]:[u,M,{onFocus:gy(a,L),onBlur:gy(v,U),onMouseEnter:gy(x,L),onMouseLeave:gy(b,U),onTouchStart:gy(I,L)}]:[!1,M,{}]}function gy(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function D$({page:e,...t}){let{router:r}=L6(),n=Me.useMemo(()=>b6(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?Me.createElement(k$,{page:e,matches:n,...t}):null}function R$(e){let{manifest:t,routeModules:r}=M6(),[n,l]=Me.useState([]);return Me.useEffect(()=>{let u=!1;return T$(e,t,r).then(d=>{u||l(d)}),()=>{u=!0}},[e,t,r]),n}function k$({page:e,matches:t,...r}){let n=Pg(),{manifest:l,routeModules:u}=M6(),{basename:d}=L6(),{loaderData:a,matches:v}=M$(),x=Me.useMemo(()=>xM(e,t,v,l,n,"data"),[e,t,v,l,n]),b=Me.useMemo(()=>xM(e,t,v,l,n,"assets"),[e,t,v,l,n]),I=Me.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let U=new Set,R=!1;if(t.forEach(q=>{let te=l.routes[q.route.id];!te||!te.hasLoader||(!x.some(J=>J.route.id===q.route.id)&&q.route.id in a&&u[q.route.id]?.shouldRevalidate||te.hasClientLoader?R=!0:U.add(q.route.id))}),U.size===0)return[];let H=B$(e,d,"data");return R&&U.size>0&&H.searchParams.set("_routes",t.filter(q=>U.has(q.route.id)).map(q=>q.route.id).join(",")),[H.pathname+H.search]},[d,a,n,l,x,t,e,u]),M=Me.useMemo(()=>I$(b,l),[b,l]),L=R$(b);return Me.createElement(Me.Fragment,null,I.map(U=>Me.createElement("link",{key:U,rel:"prefetch",as:"fetch",href:U,...r})),M.map(U=>Me.createElement("link",{key:U,rel:"modulepreload",href:U,...r})),L.map(({key:U,link:R})=>Me.createElement("link",{key:U,nonce:r.nonce,...R})))}function U$(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var O6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{O6&&(window.__reactRouterVersion="7.8.2")}catch{}function N$({basename:e,children:t,window:r}){let n=Me.useRef();n.current==null&&(n.current=Sq({window:r,v5Compat:!0}));let l=n.current,[u,d]=Me.useState({action:l.action,location:l.location}),a=Me.useCallback(v=>{Me.startTransition(()=>d(v))},[d]);return Me.useLayoutEffect(()=>l.listen(a),[l,a]),Me.createElement(p$,{basename:e,children:t,location:u.location,navigationType:u.action,navigator:l})}var D6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,R6=Me.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:l,reloadDocument:u,replace:d,state:a,target:v,to:x,preventScrollReset:b,viewTransition:I,...M},L){let{basename:U}=Me.useContext(zd),R=typeof x=="string"&&D6.test(x),H,q=!1;if(typeof x=="string"&&R&&(H=x,O6))try{let we=new URL(window.location.href),nt=x.startsWith("//")?new URL(we.protocol+x):new URL(x),_e=fm(nt.pathname,U);nt.origin===we.origin&&_e!=null?x=_e+nt.search+nt.hash:q=!0}catch{Ud(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let te=e$(x,{relative:l}),[J,se,ye]=O$(n,M),Se=H$(x,{replace:d,state:a,target:v,preventScrollReset:b,relative:l,viewTransition:I});function Be(we){t&&t(we),we.defaultPrevented||Se(we)}let De=Me.createElement("a",{...M,...ye,href:H||te,onClick:q||u?t:Be,ref:U$(L,se),target:v,"data-discover":!R&&r==="render"?"true":void 0});return J&&!R?Me.createElement(Me.Fragment,null,De,Me.createElement(D$,{page:te})):De});R6.displayName="Link";var z$=Me.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:l=!1,style:u,to:d,viewTransition:a,children:v,...x},b){let I=T1(d,{relative:x.relative}),M=Pg(),L=Me.useContext(wb),{navigator:U,basename:R}=Me.useContext(zd),H=L!=null&&q$(I)&&a===!0,q=U.encodeLocation?U.encodeLocation(I).pathname:I.pathname,te=M.pathname,J=L&&L.navigation&&L.navigation.location?L.navigation.location.pathname:null;r||(te=te.toLowerCase(),J=J?J.toLowerCase():null,q=q.toLowerCase()),J&&R&&(J=fm(J,R)||J);const se=q!=="/"&&q.endsWith("/")?q.length-1:q.length;let ye=te===q||!l&&te.startsWith(q)&&te.charAt(se)==="/",Se=J!=null&&(J===q||!l&&J.startsWith(q)&&J.charAt(q.length)==="/"),Be={isActive:ye,isPending:Se,isTransitioning:H},De=ye?t:void 0,we;typeof n=="function"?we=n(Be):we=[n,ye?"active":null,Se?"pending":null,H?"transitioning":null].filter(Boolean).join(" ");let nt=typeof u=="function"?u(Be):u;return Me.createElement(R6,{...x,"aria-current":De,className:we,ref:b,style:nt,to:d,viewTransition:a},typeof v=="function"?v(Be):v)});z$.displayName="NavLink";var Q$=Me.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:l,state:u,method:d=qw,action:a,onSubmit:v,relative:x,preventScrollReset:b,viewTransition:I,...M},L)=>{let U=K$(),R=W$(a,{relative:x}),H=d.toLowerCase()==="get"?"get":"post",q=typeof a=="string"&&D6.test(a),te=J=>{if(v&&v(J),J.defaultPrevented)return;J.preventDefault();let se=J.nativeEvent.submitter,ye=se?.getAttribute("formmethod")||d;U(se||J.currentTarget,{fetcherKey:t,method:ye,navigate:r,replace:l,state:u,relative:x,preventScrollReset:b,viewTransition:I})};return Me.createElement("form",{ref:L,method:H,action:R,onSubmit:n?v:te,...M,"data-discover":!q&&e==="render"?"true":void 0})});Q$.displayName="Form";function j$(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function k6(e){let t=Me.useContext(Av);return El(t,j$(e)),t}function H$(e,{target:t,replace:r,state:n,preventScrollReset:l,relative:u,viewTransition:d}={}){let a=bb(),v=Pg(),x=T1(e,{relative:u});return Me.useCallback(b=>{if(x$(b,t)){b.preventDefault();let I=r!==void 0?r:i1(v)===i1(x);a(e,{replace:I,state:n,preventScrollReset:l,relative:u,viewTransition:d})}},[v,a,x,r,n,t,e,l,u,d])}var V$=0,G$=()=>`__${String(++V$)}__`;function K$(){let{router:e}=k6("useSubmit"),{basename:t}=Me.useContext(zd),r=h$();return Me.useCallback(async(n,l={})=>{let{action:u,method:d,encType:a,formData:v,body:x}=E$(n,t);if(l.navigate===!1){let b=l.fetcherKey||G$();await e.fetch(b,r,l.action||u,{preventScrollReset:l.preventScrollReset,formData:v,body:x,formMethod:l.method||d,formEncType:l.encType||a,flushSync:l.flushSync})}else await e.navigate(l.action||u,{preventScrollReset:l.preventScrollReset,formData:v,body:x,formMethod:l.method||d,formEncType:l.encType||a,replace:l.replace,state:l.state,fromRouteId:r,flushSync:l.flushSync,viewTransition:l.viewTransition})},[e,t,r])}function W$(e,{relative:t}={}){let{basename:r}=Me.useContext(zd),n=Me.useContext(Pp);El(n,"useFormAction must be used inside a RouteContext");let[l]=n.matches.slice(-1),u={...T1(e||".",{relative:t})},d=Pg();if(e==null){u.search=d.search;let a=new URLSearchParams(u.search),v=a.getAll("index");if(v.some(b=>b==="")){a.delete("index"),v.filter(I=>I).forEach(I=>a.append("index",I));let b=a.toString();u.search=b?`?${b}`:""}}return(!e||e===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(u.pathname=u.pathname==="/"?r:am([r,u.pathname])),i1(u)}function q$(e,{relative:t}={}){let r=Me.useContext(S6);El(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=k6("useViewTransitionState"),l=T1(e,{relative:t});if(!r.isTransitioning)return!1;let u=fm(r.currentLocation.pathname,n)||r.currentLocation.pathname,d=fm(r.nextLocation.pathname,n)||r.nextLocation.pathname;return c2(l.pathname,d)!=null||c2(l.pathname,u)!=null}var $$=w6();function X$({onEnter:e}){return Nr.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center px-4 py-6 relative overflow-hidden",children:[Nr.jsx("div",{className:"absolute inset-0 pointer-events-none z-0",style:{backgroundImage:"url('22.jpg')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"100% 100%"}}),Nr.jsxs("div",{className:"relative z-10 max-w-6xl w-full bg-white/50 rounded-3xl shadow-2xl p-6 md:p-10 flex flex-col md:flex-row items-center gap-10",children:[Nr.jsxs("div",{className:"flex md:hidden flex-wrap justify-center gap-4 mb-6 relative z-30",children:[Nr.jsx("img",{src:"2.png",alt:"أمانة الحدود الشمالية",className:"w-32 object-contain"}),Nr.jsx("img",{src:"3.png",alt:"لوجو راية",className:"w-28 object-contain"}),Nr.jsx("img",{src:"4.png",alt:"لوجو فرصة",className:"w-28 object-contain"}),Nr.jsx("img",{src:"5.png",alt:"لوجو وزارة الإسكان",className:"w-28 object-contain"})]}),Nr.jsxs("div",{className:"hidden md:flex flex-col gap-8 md:flex-row md:gap-12 md:flex-1 items-center justify-center relative z-30",children:[Nr.jsx("img",{src:"2.png",alt:"أمانة الحدود الشمالية",className:"h-28 object-contain"}),"  ",Nr.jsx("img",{src:"4.png",alt:"لوجو راية",className:"h-20 object-contain"}),"              ",Nr.jsx("img",{src:"3.png",alt:"لوجو فرصة",className:"h-20 object-contain"}),"              ",Nr.jsx("img",{src:"5.png",alt:"لوجو وزارة الإسكان",className:"h-20 object-contain"}),"      "]}),Nr.jsxs("div",{className:"flex flex-col md:flex-1 items-center justify-between h-full max-w-md relative z-20",children:[Nr.jsx("img",{src:"map.png",alt:"صورة الخريطة",className:"w-full max-h-64 object-contain mb-4"}),Nr.jsx("img",{src:"1.png",alt:"لوجو الاستشاري",className:"w-36 object-contain mb-6"}),Nr.jsx("button",{onClick:e,className:"w-full bg-green-800 hover:bg-green-900 text-white font-semibold py-4 rounded-xl shadow-lg transition text-lg",children:"دخول إلى الخريطة"})]})]})]})}const Z$=({filters:e,onFilterChange:t,onReset:r,neighborhoods:n})=>Nr.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Nr.jsxs("select",{value:e.neighborhood,onChange:l=>t("neighborhood",l.target.value),className:"h-8 text-sm rounded px-2",children:[Nr.jsx("option",{value:"",children:"الحي"}),n.map(l=>Nr.jsx("option",{value:l,children:l},l))]}),Nr.jsxs("select",{value:e.investmentStatus,onChange:l=>t("investmentStatus",l.target.value),className:"h-8 text-sm rounded px-2",children:[Nr.jsx("option",{value:"",children:"حالة الاستثمار"}),Nr.jsx("option",{value:"مستثمر",children:"مستثمر"}),Nr.jsx("option",{value:"غير مستثمر",children:"غير مستثمر"}),Nr.jsx("option",{value:"قيد الطرح",children:"قيد الطرح"})]}),Nr.jsxs("select",{value:e.projectType,onChange:l=>t("projectType",l.target.value),className:"h-8 text-sm rounded px-2",children:[Nr.jsx("option",{value:"",children:"نوع المشروع"}),Nr.jsx("option",{value:"كبرى",children:"كبرى"}),Nr.jsx("option",{value:"متوسطة",children:"متوسطة"}),Nr.jsx("option",{value:"ناشئة",children:"ناشئة"}),Nr.jsx("option",{value:"مشاريع الخصخصة",children:"مشاريع الخصخصة"})]}),Nr.jsx("input",{type:"number",placeholder:"Min",value:e.minArea,onChange:l=>t("minArea",l.target.value),className:"h-8 w-16 text-sm rounded px-2",min:0}),Nr.jsx("input",{type:"number",placeholder:"Max",value:e.maxArea,onChange:l=>t("maxArea",l.target.value),className:"h-8 w-16 text-sm rounded px-2",min:0}),Nr.jsx("button",{onClick:r,className:"h-8 text-sm bg-white text-green-900 rounded px-2 font-semibold",children:"إعادة"})]});var Xw={exports:{}},Y$=Xw.exports,wM;function J$(){return wM||(wM=1,function(e,t){(function(r,n){e.exports=n()})(Y$,function(){var r,n,l;function u(a,v){if(!r)r=v;else if(!n)n=v;else{var x="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",b={};r(b),l=v(b),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(l.workerUrl=window.URL.createObjectURL(new Blob([x],{type:"text/javascript"})))}}u(["exports"],function(a){var v=1e-6,x=typeof Float32Array<"u"?Float32Array:Array;function b(c,i){var s=i[0],f=i[1],A=i[2],g=i[3],_=s*g-A*f;return _?(c[0]=g*(_=1/_),c[1]=-f*_,c[2]=-A*_,c[3]=s*_,c):null}function I(){var c=new x(9);return x!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function M(c,i){var s=i[0],f=i[1],A=i[2],g=i[3],_=i[4],C=i[5],T=i[6],P=i[7],k=i[8];return c[0]=_*k-C*P,c[1]=A*P-f*k,c[2]=f*C-A*_,c[3]=C*T-g*k,c[4]=s*k-A*T,c[5]=A*g-s*C,c[6]=g*P-_*T,c[7]=f*T-s*P,c[8]=s*_-f*g,c}function L(c,i,s){var f=i[0],A=i[1],g=i[2],_=i[3],C=i[4],T=i[5],P=i[6],k=i[7],N=i[8],j=s[0],X=s[1],Y=s[2],ae=s[3],ue=s[4],ge=s[5],Pe=s[6],Te=s[7],Ue=s[8];return c[0]=j*f+X*_+Y*P,c[1]=j*A+X*C+Y*k,c[2]=j*g+X*T+Y*N,c[3]=ae*f+ue*_+ge*P,c[4]=ae*A+ue*C+ge*k,c[5]=ae*g+ue*T+ge*N,c[6]=Pe*f+Te*_+Ue*P,c[7]=Pe*A+Te*C+Ue*k,c[8]=Pe*g+Te*T+Ue*N,c}function U(){var c=new x(16);return x!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c}function R(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function H(c,i){var s=i[0],f=i[1],A=i[2],g=i[3],_=i[4],C=i[5],T=i[6],P=i[7],k=i[8],N=i[9],j=i[10],X=i[11],Y=i[12],ae=i[13],ue=i[14],ge=i[15],Pe=s*C-f*_,Te=s*T-A*_,Ue=s*P-g*_,At=f*T-A*C,at=f*P-g*C,ot=A*P-g*T,_t=k*ae-N*Y,wt=k*ue-j*Y,Yt=k*ge-X*Y,Ft=N*ue-j*ae,ir=N*ge-X*ae,Ir=j*ge-X*ue,cr=Pe*Ir-Te*ir+Ue*Ft+At*Yt-at*wt+ot*_t;return cr?(c[0]=(C*Ir-T*ir+P*Ft)*(cr=1/cr),c[1]=(A*ir-f*Ir-g*Ft)*cr,c[2]=(ae*ot-ue*at+ge*At)*cr,c[3]=(j*at-N*ot-X*At)*cr,c[4]=(T*Yt-_*Ir-P*wt)*cr,c[5]=(s*Ir-A*Yt+g*wt)*cr,c[6]=(ue*Ue-Y*ot-ge*Te)*cr,c[7]=(k*ot-j*Ue+X*Te)*cr,c[8]=(_*ir-C*Yt+P*_t)*cr,c[9]=(f*Yt-s*ir-g*_t)*cr,c[10]=(Y*at-ae*Ue+ge*Pe)*cr,c[11]=(N*Ue-k*at-X*Pe)*cr,c[12]=(C*wt-_*Ft-T*_t)*cr,c[13]=(s*Ft-f*wt+A*_t)*cr,c[14]=(ae*Te-Y*At-ue*Pe)*cr,c[15]=(k*At-N*Te+j*Pe)*cr,c):null}function q(c,i,s){var f=i[0],A=i[1],g=i[2],_=i[3],C=i[4],T=i[5],P=i[6],k=i[7],N=i[8],j=i[9],X=i[10],Y=i[11],ae=i[12],ue=i[13],ge=i[14],Pe=i[15],Te=s[0],Ue=s[1],At=s[2],at=s[3];return c[0]=Te*f+Ue*C+At*N+at*ae,c[1]=Te*A+Ue*T+At*j+at*ue,c[2]=Te*g+Ue*P+At*X+at*ge,c[3]=Te*_+Ue*k+At*Y+at*Pe,c[4]=(Te=s[4])*f+(Ue=s[5])*C+(At=s[6])*N+(at=s[7])*ae,c[5]=Te*A+Ue*T+At*j+at*ue,c[6]=Te*g+Ue*P+At*X+at*ge,c[7]=Te*_+Ue*k+At*Y+at*Pe,c[8]=(Te=s[8])*f+(Ue=s[9])*C+(At=s[10])*N+(at=s[11])*ae,c[9]=Te*A+Ue*T+At*j+at*ue,c[10]=Te*g+Ue*P+At*X+at*ge,c[11]=Te*_+Ue*k+At*Y+at*Pe,c[12]=(Te=s[12])*f+(Ue=s[13])*C+(At=s[14])*N+(at=s[15])*ae,c[13]=Te*A+Ue*T+At*j+at*ue,c[14]=Te*g+Ue*P+At*X+at*ge,c[15]=Te*_+Ue*k+At*Y+at*Pe,c}function te(c,i,s){var f,A,g,_,C,T,P,k,N,j,X,Y,ae=s[0],ue=s[1],ge=s[2];return i===c?(c[12]=i[0]*ae+i[4]*ue+i[8]*ge+i[12],c[13]=i[1]*ae+i[5]*ue+i[9]*ge+i[13],c[14]=i[2]*ae+i[6]*ue+i[10]*ge+i[14],c[15]=i[3]*ae+i[7]*ue+i[11]*ge+i[15]):(A=i[1],g=i[2],_=i[3],C=i[4],T=i[5],P=i[6],k=i[7],N=i[8],j=i[9],X=i[10],Y=i[11],c[0]=f=i[0],c[1]=A,c[2]=g,c[3]=_,c[4]=C,c[5]=T,c[6]=P,c[7]=k,c[8]=N,c[9]=j,c[10]=X,c[11]=Y,c[12]=f*ae+C*ue+N*ge+i[12],c[13]=A*ae+T*ue+j*ge+i[13],c[14]=g*ae+P*ue+X*ge+i[14],c[15]=_*ae+k*ue+Y*ge+i[15]),c}function J(c,i,s){var f=s[0],A=s[1],g=s[2];return c[0]=i[0]*f,c[1]=i[1]*f,c[2]=i[2]*f,c[3]=i[3]*f,c[4]=i[4]*A,c[5]=i[5]*A,c[6]=i[6]*A,c[7]=i[7]*A,c[8]=i[8]*g,c[9]=i[9]*g,c[10]=i[10]*g,c[11]=i[11]*g,c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15],c}function se(c,i,s){var f=Math.sin(s),A=Math.cos(s),g=i[4],_=i[5],C=i[6],T=i[7],P=i[8],k=i[9],N=i[10],j=i[11];return i!==c&&(c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[3],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[4]=g*A+P*f,c[5]=_*A+k*f,c[6]=C*A+N*f,c[7]=T*A+j*f,c[8]=P*A-g*f,c[9]=k*A-_*f,c[10]=N*A-C*f,c[11]=j*A-T*f,c}function ye(c,i,s){var f=Math.sin(s),A=Math.cos(s),g=i[0],_=i[1],C=i[2],T=i[3],P=i[8],k=i[9],N=i[10],j=i[11];return i!==c&&(c[4]=i[4],c[5]=i[5],c[6]=i[6],c[7]=i[7],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[0]=g*A-P*f,c[1]=_*A-k*f,c[2]=C*A-N*f,c[3]=T*A-j*f,c[8]=g*f+P*A,c[9]=_*f+k*A,c[10]=C*f+N*A,c[11]=T*f+j*A,c}function Se(c,i,s){var f=Math.sin(s),A=Math.cos(s),g=i[0],_=i[1],C=i[2],T=i[3],P=i[4],k=i[5],N=i[6],j=i[7];return i!==c&&(c[8]=i[8],c[9]=i[9],c[10]=i[10],c[11]=i[11],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[0]=g*A+P*f,c[1]=_*A+k*f,c[2]=C*A+N*f,c[3]=T*A+j*f,c[4]=P*A-g*f,c[5]=k*A-_*f,c[6]=N*A-C*f,c[7]=j*A-T*f,c}function Be(c,i){return c[0]=i[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=i[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=i[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function De(c,i,s){var f,A,g,_=s[0],C=s[1],T=s[2],P=Math.hypot(_,C,T);return P<v?null:(_*=P=1/P,C*=P,T*=P,f=Math.sin(i),A=Math.cos(i),c[0]=_*_*(g=1-A)+A,c[1]=C*_*g+T*f,c[2]=T*_*g-C*f,c[3]=0,c[4]=_*C*g-T*f,c[5]=C*C*g+A,c[6]=T*C*g+_*f,c[7]=0,c[8]=_*T*g+C*f,c[9]=C*T*g-_*f,c[10]=T*T*g+A,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}function we(c,i){var s=i[0],f=i[1],A=i[2],g=i[3],_=s+s,C=f+f,T=A+A,P=s*_,k=f*_,N=f*C,j=A*_,X=A*C,Y=A*T,ae=g*_,ue=g*C,ge=g*T;return c[0]=1-N-Y,c[1]=k+ge,c[2]=j-ue,c[3]=0,c[4]=k-ge,c[5]=1-P-Y,c[6]=X+ae,c[7]=0,c[8]=j+ue,c[9]=X-ae,c[10]=1-P-N,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}Math.hypot||(Math.hypot=function(){for(var c=0,i=arguments.length;i--;)c+=arguments[i]*arguments[i];return Math.sqrt(c)});var nt=q;function _e(){var c=new x(3);return x!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function Ie(c){var i=new x(3);return i[0]=c[0],i[1]=c[1],i[2]=c[2],i}function Ze(c){return Math.hypot(c[0],c[1],c[2])}function st(c,i,s){var f=new x(3);return f[0]=c,f[1]=i,f[2]=s,f}function Et(c,i,s,f){return c[0]=i,c[1]=s,c[2]=f,c}function Ut(c,i,s){return c[0]=i[0]+s[0],c[1]=i[1]+s[1],c[2]=i[2]+s[2],c}function jt(c,i,s){return c[0]=i[0]-s[0],c[1]=i[1]-s[1],c[2]=i[2]-s[2],c}function bt(c,i,s){return c[0]=i[0]*s[0],c[1]=i[1]*s[1],c[2]=i[2]*s[2],c}function Nt(c,i,s){return c[0]=Math.min(i[0],s[0]),c[1]=Math.min(i[1],s[1]),c[2]=Math.min(i[2],s[2]),c}function ar(c,i,s){return c[0]=Math.max(i[0],s[0]),c[1]=Math.max(i[1],s[1]),c[2]=Math.max(i[2],s[2]),c}function lt(c,i,s){return c[0]=i[0]*s,c[1]=i[1]*s,c[2]=i[2]*s,c}function ie(c,i,s,f){return c[0]=i[0]+s[0]*f,c[1]=i[1]+s[1]*f,c[2]=i[2]+s[2]*f,c}function Le(c,i){var s=i[0]-c[0],f=i[1]-c[1],A=i[2]-c[2];return s*s+f*f+A*A}function Fe(c){var i=c[0],s=c[1],f=c[2];return i*i+s*s+f*f}function Re(c,i){return c[0]=-i[0],c[1]=-i[1],c[2]=-i[2],c}function et(c,i){var s=i[0],f=i[1],A=i[2],g=s*s+f*f+A*A;return g>0&&(g=1/Math.sqrt(g)),c[0]=i[0]*g,c[1]=i[1]*g,c[2]=i[2]*g,c}function xt(c,i){return c[0]*i[0]+c[1]*i[1]+c[2]*i[2]}function Dt(c,i,s){var f=i[0],A=i[1],g=i[2],_=s[0],C=s[1],T=s[2];return c[0]=A*T-g*C,c[1]=g*_-f*T,c[2]=f*C-A*_,c}function pt(c,i,s,f){var A=i[0],g=i[1],_=i[2];return c[0]=A+f*(s[0]-A),c[1]=g+f*(s[1]-g),c[2]=_+f*(s[2]-_),c}function Ct(c,i,s){var f=i[0],A=i[1],g=i[2],_=s[3]*f+s[7]*A+s[11]*g+s[15];return c[0]=(s[0]*f+s[4]*A+s[8]*g+s[12])/(_=_||1),c[1]=(s[1]*f+s[5]*A+s[9]*g+s[13])/_,c[2]=(s[2]*f+s[6]*A+s[10]*g+s[14])/_,c}function mr(c,i,s){var f=i[0],A=i[1],g=i[2];return c[0]=f*s[0]+A*s[3]+g*s[6],c[1]=f*s[1]+A*s[4]+g*s[7],c[2]=f*s[2]+A*s[5]+g*s[8],c}function Zt(c,i,s){var f=s[0],A=s[1],g=s[2],_=i[0],C=i[1],T=i[2],P=A*T-g*C,k=g*_-f*T,N=f*C-A*_,j=A*N-g*k,X=g*P-f*N,Y=f*k-A*P,ae=2*s[3];return k*=ae,N*=ae,X*=2,Y*=2,c[0]=_+(P*=ae)+(j*=2),c[1]=C+k+X,c[2]=T+N+Y,c}function sn(c){return c[0]=0,c[1]=0,c[2]=0,c}function er(c,i){return c[0]===i[0]&&c[1]===i[1]&&c[2]===i[2]}var mt=jt,En=bt,$r=Ze;function zn(){var c=new x(4);return x!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0),c}function an(c,i,s){return c[0]=i[0]*s,c[1]=i[1]*s,c[2]=i[2]*s,c[3]=i[3]*s,c}function Pn(c,i){var s=i[0],f=i[1],A=i[2],g=i[3],_=s*s+f*f+A*A+g*g;return _>0&&(_=1/Math.sqrt(_)),c[0]=s*_,c[1]=f*_,c[2]=A*_,c[3]=g*_,c}function yn(c,i,s){var f=i[0],A=i[1],g=i[2],_=i[3];return c[0]=s[0]*f+s[4]*A+s[8]*g+s[12]*_,c[1]=s[1]*f+s[5]*A+s[9]*g+s[13]*_,c[2]=s[2]*f+s[6]*A+s[10]*g+s[14]*_,c[3]=s[3]*f+s[7]*A+s[11]*g+s[15]*_,c}function Ci(){var c=new x(4);return x!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function Zn(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function Vi(c,i,s){s*=.5;var f=i[0],A=i[1],g=i[2],_=i[3],C=Math.sin(s),T=Math.cos(s);return c[0]=f*T+_*C,c[1]=A*T+g*C,c[2]=g*T-A*C,c[3]=_*T-f*C,c}function Ti(c,i,s){s*=.5;var f=i[0],A=i[1],g=i[2],_=i[3],C=Math.sin(s),T=Math.cos(s);return c[0]=f*T-g*C,c[1]=A*T+_*C,c[2]=g*T+f*C,c[3]=_*T-A*C,c}_e(),zn();var ui,ta,bi,ti=Pn,vi=(ui=_e(),ta=st(1,0,0),bi=st(0,1,0),function(c,i,s){var f=xt(i,s);return f<-.999999?(Dt(ui,ta,i),$r(ui)<1e-6&&Dt(ui,bi,i),et(ui,ui),function(A,g,_){_*=.5;var C=Math.sin(_);A[0]=C*g[0],A[1]=C*g[1],A[2]=C*g[2],A[3]=Math.cos(_)}(c,ui,Math.PI),c):f>.999999?(c[0]=0,c[1]=0,c[2]=0,c[3]=1,c):(Dt(ui,i,s),c[0]=ui[0],c[1]=ui[1],c[2]=ui[2],c[3]=1+f,ti(c,c))});function Dn(){var c=new x(2);return x!=Float32Array&&(c[0]=0,c[1]=0),c}function ua(c,i){var s=new x(2);return s[0]=c,s[1]=i,s}function ca(c,i,s){return c[0]=i[0]+s[0],c[1]=i[1]+s[1],c}function Gn(c,i,s){return c[0]=i[0]-s[0],c[1]=i[1]-s[1],c}function Li(c,i,s){return c[0]=i[0]*s,c[1]=i[1]*s,c}function xa(c){return Math.hypot(c[0],c[1])}function yi(c,i){var s=i[0],f=i[1],A=s*s+f*f;return A>0&&(A=1/Math.sqrt(A)),c[0]=i[0]*A,c[1]=i[1]*A,c}function Nn(c,i){return c[0]*i[0]+c[1]*i[1]}Ci(),Ci(),I();var ki,oo,wa=Gn;function ba(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}Dn();var Mi=function(){if(oo)return ki;function c(i,s,f,A){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(A-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=s,this.p2x=f,this.p2y=A}return oo=1,ki=c,c.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,s){if(s===void 0&&(s=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,A=0;A<8;A++){var g=this.sampleCurveX(f)-i;if(Math.abs(g)<s)return f;var _=this.sampleCurveDerivativeX(f);if(Math.abs(_)<1e-6)break;f-=g/_}var C=0,T=1;for(f=i,A=0;A<20&&(g=this.sampleCurveX(f),!(Math.abs(g-i)<s));A++)i>g?C=f:T=f,f=.5*(T-C)+C;return f},solve:function(i,s){return this.sampleCurveY(this.solveCurveX(i,s))}},ki}(),Ea=ba(Mi);function hr(c,i){this.x=c,this.y=i}function Bo(c,i){if(Array.isArray(c)){if(!Array.isArray(i)||c.length!==i.length)return!1;for(let s=0;s<c.length;s++)if(!Bo(c[s],i[s]))return!1;return!0}if(typeof c=="object"&&c!==null&&i!==null){if(typeof i!="object"||Object.keys(c).length!==Object.keys(i).length)return!1;for(const s in c)if(!Bo(c[s],i[s]))return!1;return!0}return c===i}hr.prototype={clone(){return new hr(this.x,this.y)},add(c){return this.clone()._add(c)},sub(c){return this.clone()._sub(c)},multByPoint(c){return this.clone()._multByPoint(c)},divByPoint(c){return this.clone()._divByPoint(c)},mult(c){return this.clone()._mult(c)},div(c){return this.clone()._div(c)},rotate(c){return this.clone()._rotate(c)},rotateAround(c,i){return this.clone()._rotateAround(c,i)},matMult(c){return this.clone()._matMult(c)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(c){return this.x===c.x&&this.y===c.y},dist(c){return Math.sqrt(this.distSqr(c))},distSqr(c){const i=c.x-this.x,s=c.y-this.y;return i*i+s*s},angle(){return Math.atan2(this.y,this.x)},angleTo(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith(c){return this.angleWithSep(c.x,c.y)},angleWithSep(c,i){return Math.atan2(this.x*i-this.y*c,this.x*c+this.y*i)},_matMult(c){const i=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=i,this},_add(c){return this.x+=c.x,this.y+=c.y,this},_sub(c){return this.x-=c.x,this.y-=c.y,this},_mult(c){return this.x*=c,this.y*=c,this},_div(c){return this.x/=c,this.y/=c,this},_multByPoint(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint(c){return this.x/=c.x,this.y/=c.y,this},_unit(){return this._div(this.mag()),this},_perp(){const c=this.y;return this.y=this.x,this.x=-c,this},_rotate(c){const i=Math.cos(c),s=Math.sin(c),f=s*this.x+i*this.y;return this.x=i*this.x-s*this.y,this.y=f,this},_rotateAround(c,i){const s=Math.cos(c),f=Math.sin(c),A=i.y+f*(this.x-i.x)+s*(this.y-i.y);return this.x=i.x+s*(this.x-i.x)-f*(this.y-i.y),this.y=A,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:hr},hr.convert=function(c){if(c instanceof hr)return c;if(Array.isArray(c))return new hr(+c[0],+c[1]);if(c.x!==void 0&&c.y!==void 0)return new hr(+c.x,+c.y);throw new Error("Expected [x, y] or {x, y} point format")};const xc=Math.PI/180,sl=180/Math.PI;function _n(c){return c*xc}function Tt(c){return c*sl}const pe=[[0,0],[1,0],[1,1],[0,1]];function be(c){if(c<=0)return 0;if(c>=1)return 1;const i=c*c,s=i*c;return 4*(c<.5?s:3*(c-i)+s-.75)}function Ve(c,i,s,f){const A=new Ea(c,i,s,f);return function(g){return A.solve(g)}}const rt=Ve(.25,.1,.25,1);function je(c,i,s){return Math.min(s,Math.max(i,c))}function oe(c,i,s){return(s=je((s-c)/(i-c),0,1))*s*(3-2*s)}function Ee(c,i,s){const f=s-i,A=((c-i)%f+f)%f+i;return A===i?s:A}function me(c,i,s){if(!c.length)return s(null,[]);let f=c.length;const A=new Array(c.length);let g=null;c.forEach((_,C)=>{i(_,(T,P)=>{T&&(g=T),A[C]=P,--f==0&&s(g,A)})})}function xe(c,...i){for(const s of i)for(const f in s)c[f]=s[f];return c}let Ne=1;function Oe(){return Ne++}function St(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Ht(c,i){c.forEach(s=>{i[s]&&(i[s]=i[s].bind(i))})}function Rt(c,i,s){const f={};for(const A in c)f[A]=i.call(this,c[A],A,c);return f}function Vt(c,i,s){const f={};for(const A in c)i.call(this,c[A],A,c)&&(f[A]=c[A]);return f}function Gt(c){return Array.isArray(c)?c.map(Gt):typeof c=="object"&&c?Rt(c,Gt):c}function br(c,i){for(let s=0;s<c.length;s++)if(i.indexOf(c[s])>=0)return!0;return!1}const qr={};function Hr(c){qr[c]||(typeof console<"u"&&console.warn(c),qr[c]=!0)}function Jr(c,i,s){return(s.y-c.y)*(i.x-c.x)>(i.y-c.y)*(s.x-c.x)}function en(c){let i=0;for(let s,f,A=0,g=c.length,_=g-1;A<g;_=A++)s=c[A],f=c[_],i+=(f.x-s.x)*(s.y+f.y);return i}function Vn([c,i,s]){const f=_n(i+90),A=_n(s);return{x:c*Math.cos(f)*Math.sin(A),y:c*Math.sin(f)*Math.sin(A),z:c*Math.cos(A),azimuthal:i,polar:s}}function Kn(c){return(typeof self<"u"||c!==void 0)&&typeof WorkerGlobalScope<"u"&&(c!==void 0?c:self)instanceof WorkerGlobalScope}function Sn(c){const i={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,f,A,g)=>{const _=A||g;return i[f]=!_||_.toLowerCase(),""}),i["max-age"]){const s=parseInt(i["max-age"],10);isNaN(s)?delete i["max-age"]:i["max-age"]=s}return i}let Ii=null;function ha(c,i){return[c[4*i],c[4*i+1],c[4*i+2],c[4*i+3]]}function sa(c,i,s,f){for(;i<s;){const A=i+s>>1;c[A]<f?i=A+1:s=A}return i}function Ya(c,i,s,f){for(;i<s;){const A=i+s>>1;c[A]<=f?i=A+1:s=A}return i}function Ra(c){return c>0?1/(1.001-c):1+c}function es(c){return c>0?1-1/(1.001-c):-c}function so(c,i,s){return(c-i.min)*(s.max-s.min)/(i.max-i.min)+s.min}const Ss={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ss.API_URL)return null;try{const c=new URL(Ss.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.1.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Co(c){return Ss.API_URL_REGEX.test(c)}function Rf(c){return Ss.API_SPRITE_REGEX.test(c)}let Hu,Ul,wc,Cl,qc,No;function fh(){return Hu==null&&(Hu=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Hu}const bc={now:()=>Cl!==void 0?Cl:performance.now(),setNow(c){Cl=c},restoreNow(){Cl=void 0},frame(c){const i=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(c,i=0){const{width:s,height:f}=c;qc||(qc=document.createElement("canvas"));const A=qc.getContext("2d",{willReadFrequently:!0});if(!A)throw new Error("failed to create canvas 2d context");return(s>qc.width||f>qc.height)&&(qc.width=s,qc.height=f),A.clearRect(-i,-i,s+2*i,f+2*i),A.drawImage(c,0,0,s,f),A.getImageData(-i,-i,s+2*i,f+2*i)},resolveURL:c=>(Ul||(Ul=document.createElement("a")),Ul.href=c,Ul.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(wc==null&&(wc=window.matchMedia("(prefers-reduced-motion: reduce)")),wc.matches)},hasCanvasFingerprintNoise(){if(No!==void 0)return No;if(!fh())return No=!1,!1;const c=new OffscreenCanvas(85,1),i=c.getContext("2d",{willReadFrequently:!0});let s=0;for(let A=0;A<c.width;++A)i.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,i.fillRect(A,0,1,1);const f=i.getImageData(0,0,c.width,c.height);s=0;for(let A=0;A<f.data.length;++A)if(A%4!=3&&s++!==f.data[A])return No=!0,!0;return No=!1,!1}};function Sl(c,i){const s=c.indexOf("?");if(s<0)return`${c}?${new URLSearchParams(i).toString()}`;const f=new URLSearchParams(c.slice(s));for(const A in i)f.set(A,i[A]);return`${c.slice(0,s)}?${f.toString()}`}function ll(c,i={persistentParams:[]}){const s=c.indexOf("?");if(s<0)return c;const f=new URLSearchParams,A=new URLSearchParams(c.slice(s));for(const _ of i.persistentParams){const C=A.get(_);C&&f.set(_,C)}const g=f.toString();return`${c.slice(0,s)}${g.length>0?`?${g}`:""}`}const cl="mapbox-tiles";let Nl=500,ma=50;const $c=["language","worldview","jobid"];let ec,Nh;function Ah(){try{return caches}catch{}}function zh(){const c=Ah();c&&ec==null&&(ec=c.open(cl))}let hf=1/0;const Vu={supported:!1,testSupport:function(c){!ul&&zl&&(Tl?ff(c):zo=c)}};let zo,zl,ul=!1,Tl=!1;const Hi=typeof self<"u"?self:{};function ff(c){const i=c.createTexture();c.bindTexture(c.TEXTURE_2D,i);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,zl),c.isContextLost())return;Vu.supported=!0}catch{}c.deleteTexture(i),ul=!0}Hi.document&&(zl=Hi.document.createElement("img"),zl.onload=function(){zo&&ff(zo),zo=null,Tl=!0},zl.onerror=function(){ul=!0,zo=null},zl.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ec={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Ec);class Ui extends Error{constructor(i,s,f){s===401&&Co(f)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=s,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const kf=Kn()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,hl=function(c,i){if(!(/^file:/.test(s=c.url)||/^file:/.test(kf())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(f,A){const g=new AbortController,_=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:kf(),referrerPolicy:f.referrerPolicy,signal:g.signal});let C=!1,T=!1;const P=(k=_.url).indexOf("sku=")>0&&Co(k);var k;f.type==="json"&&_.headers.set("Accept","application/json");const N=(X,Y,ae)=>{if(T)return;if(X&&X.message!=="SecurityError"&&Hr(X.toString()),Y&&ae)return j(Y);const ue=Date.now();fetch(_).then(ge=>{if(ge.ok){const Pe=P?ge.clone():null;return j(ge,Pe,ue)}return A(new Ui(ge.statusText,ge.status,f.url))}).catch(ge=>{ge.name!=="AbortError"&&A(new Error(`${ge.message} ${f.url}`))})},j=(X,Y,ae)=>{(f.type==="arrayBuffer"?X.arrayBuffer():f.type==="json"?X.json():X.text()).then(ue=>{T||(Y&&ae&&function(ge,Pe,Te){if(zh(),ec==null)return;const Ue=Sn(Pe.headers.get("Cache-Control")||"");if(Ue["no-store"])return;const At={status:Pe.status,statusText:Pe.statusText,headers:new Headers};Pe.headers.forEach((_t,wt)=>At.headers.set(wt,_t)),Ue["max-age"]&&At.headers.set("Expires",new Date(Te+1e3*Ue["max-age"]).toUTCString());const at=At.headers.get("Expires");if(!at||new Date(at).getTime()-Te<42e4)return;let ot=ll(ge.url,{persistentParams:$c});if(Pe.status===206){const _t=ge.headers.get("Range");if(!_t)return;At.status=200,ot=Sl(ot,{range:_t})}(function(_t,wt){if(Nh===void 0)try{new Response(new ReadableStream),Nh=!0}catch{Nh=!1}Nh?wt(_t.body):_t.blob().then(wt).catch(Yt=>Hr(Yt.message))})(Pe,_t=>{const wt=new Response((Yt=Pe.status)!==200&&Yt!==404&&[101,103,204,205,304].includes(Yt)?null:_t,At);var Yt;zh(),ec?.then(Ft=>Ft.put(ot,wt)).catch(Ft=>Hr(Ft.message))})}(_,Y,ae),C=!0,A(null,ue,X.headers.get("Cache-Control"),X.headers.get("Expires")))}).catch(ue=>{T||A(new Error(ue.message))})};return P?function(X,Y){if(zh(),ec==null)return Y(null);ec.then(ae=>{let ue=ll(X.url,{persistentParams:$c});const ge=X.headers.get("Range");ge&&(ue=Sl(ue,{range:ge})),ae.match(ue).then(Pe=>{const Te=function(Ue){if(!Ue)return!1;const At=new Date(Ue.headers.get("Expires")||0),at=Sn(Ue.headers.get("Cache-Control")||"");return Number(At)>Date.now()&&!at["no-cache"]}(Pe);ae.delete(ue).catch(Y),Te&&ae.put(ue,Pe.clone()).catch(Y),Y(null,Pe,Te)}).catch(Y)}).catch(Y)}(_,N):N(null,null),{cancel:()=>{T=!0,C||g.abort()}}}(c,i);if(Kn(self)&&self.worker.actor)return self.worker.actor.send("getResource",c,i,void 0,!0)}var s;return function(f,A){const g=new XMLHttpRequest;g.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const _ in f.headers)g.setRequestHeader(_,f.headers[_]);return f.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=f.credentials==="include",g.onerror=()=>{A(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let _=g.response;if(f.type==="json")try{_=JSON.parse(g.response)}catch(C){return A(C)}A(null,_,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else A(new Ui(g.statusText,g.status,f.url))},g.send(f.body),{cancel:()=>g.abort()}}(c,i)},Xc=function(c,i){return hl(xe(c,{type:"arrayBuffer"}),i)};function Kd(c){const i=document.createElement("a");return i.href=c,i.protocol===location.protocol&&i.host===location.host}const dh="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Zc,_u;Zc=[],_u=0;const tc=function(c,i){if(Vu.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),_u>=Ss.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:c,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return Zc.push(g),g}_u++;let s=!1;const f=()=>{if(!s)for(s=!0,_u--;Zc.length&&_u<Ss.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Zc.shift(),{requestParameters:_,callback:C,cancelled:T}=g;T||(g.cancel=tc(_,C).cancel)}},A=Xc(c,(g,_,C,T)=>{f(),g?i(g):_&&(self.createImageBitmap?function(P,k){const N=new Blob([new Uint8Array(P)],{type:"image/png"});createImageBitmap(N).then(j=>{k(null,j)}).catch(j=>{k(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(P,k)=>i(P,k,C,T)):function(P,k){const N=new Image;N.onload=()=>{k(null,N),URL.revokeObjectURL(N.src),N.onload=null,requestAnimationFrame(()=>{N.src=dh})},N.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const j=new Blob([new Uint8Array(P)],{type:"image/png"});N.src=P.byteLength?URL.createObjectURL(j):dh}(_,(P,k)=>i(P,k,C,T)))});return{cancel:()=>{A.cancel(),f()}}};var Gu,Bc,Uf,ph={exports:{}},Ku={exports:{}},mh={exports:{}},Cc=function(){if(Uf)return ph.exports;Uf=1;var c=(Gu||(Gu=1,Ku.exports=function(s,f){var A,g,_,C,T,P,k,N;for(g=s.length-(A=3&s.length),_=f,T=3432918353,P=461845907,N=0;N<g;)k=255&s.charCodeAt(N)|(255&s.charCodeAt(++N))<<8|(255&s.charCodeAt(++N))<<16|(255&s.charCodeAt(++N))<<24,++N,_=27492+(65535&(C=5*(65535&(_=(_^=k=(65535&(k=(k=(65535&k)*T+(((k>>>16)*T&65535)<<16)&4294967295)<<15|k>>>17))*P+(((k>>>16)*P&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(k=0,A){case 3:k^=(255&s.charCodeAt(N+2))<<16;case 2:k^=(255&s.charCodeAt(N+1))<<8;case 1:_^=k=(65535&(k=(k=(65535&(k^=255&s.charCodeAt(N)))*T+(((k>>>16)*T&65535)<<16)&4294967295)<<15|k>>>17))*P+(((k>>>16)*P&65535)<<16)&4294967295}return _^=s.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),Ku.exports),i=(Bc||(Bc=1,mh.exports=function(s,f){for(var A,g=s.length,_=f^g,C=0;g>=4;)A=1540483477*(65535&(A=255&s.charCodeAt(C)|(255&s.charCodeAt(++C))<<8|(255&s.charCodeAt(++C))<<16|(255&s.charCodeAt(++C))<<24))+((1540483477*(A>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(A=1540483477*(65535&(A^=A>>>24))+((1540483477*(A>>>16)&65535)<<16)),g-=4,++C;switch(g){case 3:_^=(255&s.charCodeAt(C+2))<<16;case 2:_^=(255&s.charCodeAt(C+1))<<8;case 1:_=1540483477*(65535&(_^=255&s.charCodeAt(C)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),mh.exports);return ph.exports=c,ph.exports.murmur3=c,ph.exports.murmur2=i,ph.exports}(),vu=ba(Cc);class rc{constructor(i,...s){xe(this,s[0]||{}),this.type=i}}class ts extends rc{constructor(i,s={}){super("error",xe({error:i},s))}}function Wu(c,i,s){s[c]&&s[c].indexOf(i)!==-1||(s[c]=s[c]||[],s[c].push(i))}function gh(c,i,s){if(s&&s[c]){const f=s[c].indexOf(i);f!==-1&&s[c].splice(f,1)}}class yu{on(i,s){return this._listeners=this._listeners||{},Wu(i,s,this._listeners),this}off(i,s){return gh(i,s,this._listeners),gh(i,s,this._oneTimeListeners),this}once(i,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Wu(i,s,this._oneTimeListeners),this):new Promise(f=>{this.once(i,f)})}fire(i,s){const f=typeof i=="string"?new rc(i,s):i,A=f.type;if(this.listens(A)){f.target=this;const g=this._listeners&&this._listeners[A]?this._listeners[A].slice():[];for(const T of g)T.call(this,f);const _=this._oneTimeListeners&&this._oneTimeListeners[A]?this._oneTimeListeners[A].slice():[];for(const T of _)gh(A,T,this._oneTimeListeners),T.call(this,f);const C=this._eventedParent;C&&(xe(f,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(f))}else f instanceof ts&&console.error(f.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,s){return this._eventedParent=i,this._eventedParentData=s,this}}class fo{constructor(i){typeof i=="string"?this.name=i:(this.name=i.name,this.iconsetId=i.iconsetId)}static from(i){return new fo(i)}static toString(i){return i.iconsetId?`${i.name}${i.iconsetId}`:i.name}static parse(i){const[s,f]=i.split("");return new fo({name:s,iconsetId:f})}static isEqual(i,s){return i.name===s.name&&i.iconsetId===s.iconsetId}toString(){return fo.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var nc,ne={},ze=function(){if(nc)return ne;nc=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(g){return(g=Math.round(g))<0?0:g>255?255:g}function s(g){return i(g[g.length-1]==="%"?parseFloat(g)/100*255:parseInt(g))}function f(g){return(_=g[g.length-1]==="%"?parseFloat(g)/100:parseFloat(g))<0?0:_>1?1:_;var _}function A(g,_,C){return C<0?C+=1:C>1&&(C-=1),6*C<1?g+(_-g)*C*6:2*C<1?_:3*C<2?g+(_-g)*(2/3-C)*6:g}try{ne.parseCSSColor=function(g){var _,C=g.replace(/ /g,"").toLowerCase();if(C in c)return c[C].slice();if(C[0]==="#")return C.length===4?(_=parseInt(C.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:C.length===7&&(_=parseInt(C.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var T=C.indexOf("("),P=C.indexOf(")");if(T!==-1&&P+1===C.length){var k=C.substr(0,T),N=C.substr(T+1,P-(T+1)).split(","),j=1;switch(k){case"rgba":if(N.length!==4)return null;j=f(N.pop());case"rgb":return N.length!==3?null:[s(N[0]),s(N[1]),s(N[2]),j];case"hsla":if(N.length!==4)return null;j=f(N.pop());case"hsl":if(N.length!==3)return null;var X=(parseFloat(N[0])%360+360)%360/360,Y=f(N[1]),ae=f(N[2]),ue=ae<=.5?ae*(Y+1):ae+Y-ae*Y,ge=2*ae-ue;return[i(255*A(ge,ue,X+1/3)),i(255*A(ge,ue,X)),i(255*A(ge,ue,X-1/3)),j];default:return null}}return null}}catch{}return ne}();class ft{constructor(i,s,f,A=1){this.r=i,this.g=s,this.b=f,this.a=A}static parse(i){if(!i)return;if(i instanceof ft)return i;if(typeof i!="string")return;const s=ze.parseCSSColor(i);return s?new ft(s[0]/255,s[1]/255,s[2]/255,s[3]):void 0}toString(){const[i,s,f,A]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*i)},${Math.round(255*s)},${Math.round(255*f)},${A})`}toNonPremultipliedRenderColor(i){const{r:s,g:f,b:A,a:g}=this;return new sr(i,s,f,A,g)}toPremultipliedRenderColor(i){const{r:s,g:f,b:A,a:g}=this;return new Xr(i,s*g,f*g,A*g,g)}clone(){return new ft(this.r,this.g,this.b,this.a)}}class Qt{constructor(i,s,f,A,g,_=!1){if(this.premultiplied=!1,this.premultiplied=_,i){const C=i.image.height,T=C*C;this.premultiplied?(s=g===0?0:s/g*(C-1),f=g===0?0:f/g*(C-1),A=g===0?0:A/g*(C-1)):(s*=C-1,f*=C-1,A*=C-1);const P=Math.floor(s),k=Math.floor(f),N=Math.floor(A),j=Math.ceil(s),X=Math.ceil(f),Y=Math.ceil(A),ae=s-P,ue=f-k,ge=A-N,Pe=i.image.data,Te=4*(P+k*T+N*C),Ue=4*(P+k*T+Y*C),At=4*(P+X*T+N*C),at=4*(P+X*T+Y*C),ot=4*(j+k*T+N*C),_t=4*(j+k*T+Y*C),wt=4*(j+X*T+N*C),Yt=4*(j+X*T+Y*C);if(Te<0||Yt>=Pe.length)throw new Error("out of range");this.r=tr(tr(tr(Pe[Te],Pe[Ue],ge),tr(Pe[At],Pe[at],ge),ue),tr(tr(Pe[ot],Pe[_t],ge),tr(Pe[wt],Pe[Yt],ge),ue),ae)/255*(this.premultiplied?g:1),this.g=tr(tr(tr(Pe[Te+1],Pe[Ue+1],ge),tr(Pe[At+1],Pe[at+1],ge),ue),tr(tr(Pe[ot+1],Pe[_t+1],ge),tr(Pe[wt+1],Pe[Yt+1],ge),ue),ae)/255*(this.premultiplied?g:1),this.b=tr(tr(tr(Pe[Te+2],Pe[Ue+2],ge),tr(Pe[At+2],Pe[at+2],ge),ue),tr(tr(Pe[ot+2],Pe[_t+2],ge),tr(Pe[wt+2],Pe[Yt+2],ge),ue),ae)/255*(this.premultiplied?g:1),this.a=g}else this.r=s,this.g=f,this.b=A,this.a=g}toArray(){const{r:i,g:s,b:f,a:A}=this;return[255*i,255*s,255*f,A]}toHslaArray(){let{r:i,g:s,b:f,a:A}=this;if(this.premultiplied){if(A===0)return[0,0,0,0];i/=A,s/=A,f/=A}const g=Math.min(Math.max(i,0),1),_=Math.min(Math.max(s,0),1),C=Math.min(Math.max(f,0),1),T=Math.min(g,_,C),P=Math.max(g,_,C),k=(T+P)/2;if(T===P)return[0,0,100*k,A];const N=P-T,j=k>.5?N/(2-P-T):N/(P+T);let X=0;return P===g?X=(_-C)/N+(_<C?6:0):P===_?X=(C-g)/N+2:P===C&&(X=(g-_)/N+4),X*=60,[Math.min(Math.max(X,0),360),Math.min(Math.max(100*j,0),100),Math.min(Math.max(100*k,0),100),A]}toArray01(){const{r:i,g:s,b:f,a:A}=this;return[i,s,f,A]}toArray01Scaled(i){const{r:s,g:f,b:A}=this;return[s*i,f*i,A*i]}toArray01Linear(){const{r:i,g:s,b:f,a:A}=this;return[Math.pow(i,2.2),Math.pow(s,2.2),Math.pow(f,2.2),A]}}class sr extends Qt{constructor(i,s,f,A,g){super(i,s,f,A,g,!1)}}class Xr extends Qt{constructor(i,s,f,A,g){super(i,s,f,A,g,!0)}}function tr(c,i,s){return c*(1-s)+i*s}function ri(c,i,s){return c.map((f,A)=>tr(f,i[A],s))}ft.black=new ft(0,0,0,1),ft.white=new ft(1,1,1,1),ft.transparent=new ft(0,0,0,0),ft.red=new ft(1,0,0,1),ft.blue=new ft(0,0,1,1);var Yn=Object.freeze({__proto__:null,array:ri,color:function(c,i,s){return new ft(tr(c.r,i.r,s),tr(c.g,i.g,s),tr(c.b,i.b,s),tr(c.a,i.a,s))},number:tr});function Bi(c,...i){for(const s of i)for(const f in s)c[f]=s[f];return c}class Si extends Error{constructor(i,s){super(s),this.message=s,this.key=i}}class Ga{constructor(i,s=[]){this.parent=i,this.bindings={};for(const[f,A]of s)this.bindings[f]=A}concat(i){return new Ga(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const xo={kind:"null"},Yr={kind:"number"},Un={kind:"string"},oi={kind:"boolean"},Ka={kind:"color"},Qo={kind:"object"},Oi={kind:"value"},qu={kind:"collator"},Af={kind:"formatted"},df={kind:"resolvedImage"};function os(c,i){return{kind:"array",itemType:c,N:i}}function Qa(c){if(c.kind==="array"){const i=Qa(c.itemType);return typeof c.N=="number"?`array<${i}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${i}>`}return c.kind}const cd=[xo,Yr,Un,oi,Ka,Af,Qo,os(Oi),df];function Yc(c,i){if(i.kind==="error")return null;if(c.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Yc(c.itemType,i.itemType))&&(typeof c.N!="number"||c.N===i.N))return null}else{if(c.kind===i.kind)return null;if(c.kind==="value"){for(const s of cd)if(!Yc(s,i))return null}}return`Expected ${Qa(c)} but found ${Qa(i)} instead.`}function ic(c,i){return i.some(s=>s.kind===c.kind)}function _s(c,i){return i.some(s=>s==="null"?c===null:s==="array"?Array.isArray(c):s==="object"?c&&!Array.isArray(c)&&typeof c=="object":s===typeof c)}function xu(c,i){return c.kind==="array"&&i.kind==="array"?c.N===i.N&&xu(c.itemType,i.itemType):c.kind===i.kind}class Sc{constructor(i,s,f){this.sensitivity=i?s?"variant":"case":s?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,s){return this.collator.compare(i,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Qh{constructor(i,s,f,A,g){this.text=i.normalize?i.normalize():i,this.image=s,this.scale=f,this.fontStack=A,this.textColor=g}}class zs{constructor(i){this.sections=i}static fromString(i){return new zs([new Qh(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||!!i.image&&i.image.hasPrimary())}static factory(i){return i instanceof zs?i:zs.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const s of this.sections){if(s.image){const A=s.image.getPrimary().id.toString();i.push(["image",A]);continue}i.push(s.text);const f={};s.fontStack&&(f["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(f["font-scale"]=s.scale),s.textColor&&(f["text-color"]=["rgba"].concat(s.textColor.toNonPremultipliedRenderColor(null).toArray())),i.push(f)}return i}}class ss{constructor(i,s={}){if(this.id=fo.from(i),this.options=Object.assign({},s),s.transform){const{a:f,b:A,c:g,d:_,e:C,f:T}=s.transform;this.options.transform=new DOMMatrix([f,A,g,_,C,T])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:i,b:s,c:f,d:A,e:g,f:_}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:i,b:s,c:f,d:A,e:g,f:_}})}static parse(i){let s,f,A,g;try{({name:s,iconsetId:f,params:A,transform:g}=JSON.parse(i)||{})}catch{return null}if(!s)return null;const{a:_,b:C,c:T,d:P,e:k,f:N}=g||{};return new ss({name:s,iconsetId:f},{params:A,transform:new DOMMatrix([_,C,T,P,k,N])})}scaleSelf(i,s){return this.options.transform.scaleSelf(i,s),this}}class fl{constructor(i,s,f,A,g=!1){this.primaryId=fo.from(i),this.primaryOptions=s,f&&(this.secondaryId=fo.from(f)),this.secondaryOptions=A,this.available=g}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new ss(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new ss(this.secondaryId,this.secondaryOptions):null}static from(i){return typeof i=="string"?fl.build({name:i}):i}static build(i,s,f,A){return!i||typeof i=="object"&&!("name"in i)?null:new fl(i,f,s,A)}}function wu(c,i,s,f){return typeof c=="number"&&c>=0&&c<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof s=="number"&&s>=0&&s<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,i,s,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,i,s,f]:[c,i,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Xn(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof ft||c instanceof Sc||c instanceof zs||c instanceof fl)return!0;if(Array.isArray(c)){for(const i of c)if(!Xn(i))return!1;return!0}if(typeof c=="object"){for(const i in c)if(!Xn(c[i]))return!1;return!0}return!1}function Rr(c){if(c===null)return xo;if(typeof c=="string")return Un;if(typeof c=="boolean")return oi;if(typeof c=="number")return Yr;if(c instanceof ft)return Ka;if(c instanceof Sc)return qu;if(c instanceof zs)return Af;if(c instanceof fl)return df;if(Array.isArray(c)){const i=c.length;let s;for(const f of c){const A=Rr(f);if(s){if(s===A)continue;s=Oi;break}s=A}return os(s||Oi,i)}return Qo}function jo(c){const i=typeof c;return c===null?"":i==="string"||i==="number"||i==="boolean"?String(c):c instanceof zs||c instanceof fl||c instanceof ft?c.toString():JSON.stringify(c)}class bn{constructor(i,s){this.type=i,this.value=s}static parse(i,s){if(i.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Xn(i[1]))return s.error("invalid value");const f=i[1];let A=Rr(f);const g=s.expectedType;return A.kind!=="array"||A.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(A=g),new bn(A,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ft?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof zs?this.value.serialize():this.value}}class Ao{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const Jc={string:Un,number:Yr,boolean:oi,object:Qo};class xn{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");let f,A=1;const g=i[0];if(g==="array"){let C,T;if(i.length>2){const P=i[1];if(typeof P!="string"||!(P in Jc)||P==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);C=Jc[P],A++}else C=Oi;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return s.error('The length argument to "array" must be a positive integer literal',2);T=i[2],A++}f=os(C,T)}else f=Jc[g];const _=[];for(;A<i.length;A++){const C=s.parse(i[A],A,Oi);if(!C)return null;_.push(C)}return new xn(f,_)}evaluate(i){for(let s=0;s<this.args.length;s++){const f=this.args[s].evaluate(i);if(!Yc(this.type,Rr(f)))return f;if(s===this.args.length-1)throw new Ao(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${Qa(Rr(f))} but was expected to be of type ${Qa(this.type)}.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,s=[i.kind];if(i.kind==="array"){const f=i.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){s.push(f.kind);const A=i.N;(typeof A=="number"||this.args.length>1)&&s.push(A)}}return s.concat(this.args.map(f=>f.serialize()))}}class Qs{constructor(i){this.type=Af,this.sections=i}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");const f=i[1];if(!Array.isArray(f)&&typeof f=="object")return s.error("First argument must be an image or text section.");const A=[];let g=!1;for(let _=1;_<=i.length-1;++_){const C=i[_];if(g&&typeof C=="object"&&!Array.isArray(C)){g=!1;let T=null;if(C["font-scale"]&&(T=s.parseObjectValue(C["font-scale"],_,"font-scale",Yr),!T))return null;let P=null;if(C["text-font"]&&(P=s.parseObjectValue(C["text-font"],_,"text-font",os(Un)),!P))return null;let k=null;if(C["text-color"]&&(k=s.parseObjectValue(C["text-color"],_,"text-color",Ka),!k))return null;const N=A[A.length-1];N.scale=T,N.font=P,N.textColor=k}else{const T=s.parse(i[_],_,Oi);if(!T)return null;const P=T.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,A.push({content:T,scale:null,font:null,textColor:null})}}return new Qs(A)}evaluate(i){return new zs(this.sections.map(s=>{const f=s.content.evaluate(i);return xu(Rr(f),df)?new Qh("",f,null,null,null):new Qh(jo(f),null,s.scale?s.scale.evaluate(i):null,s.font?s.font.evaluate(i).join(","):null,s.textColor?s.textColor.evaluate(i):null)}))}eachChild(i){for(const s of this.sections)i(s.content),s.scale&&i(s.scale),s.font&&i(s.font),s.textColor&&i(s.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const s of this.sections){i.push(s.content.serialize());const f={};s.scale&&(f["font-scale"]=s.scale.serialize()),s.font&&(f["text-font"]=s.font.serialize()),s.textColor&&(f["text-color"]=s.textColor.serialize()),i.push(f)}return i}}class js{constructor(i,s,f,A){this._imageWarnHistory={},this.type=df,this.namePrimary=i,this.nameSecondary=s,f&&(this.paramsPrimary=f.params,this.iconsetIdPrimary=f.iconset?f.iconset.id:void 0),A&&(this.paramsSecondary=A.params,this.iconsetIdSecondary=A.iconset?A.iconset.id:void 0)}static parse(i,s){if(i.length<2)return s.error("Expected two or more arguments.");let f=1;const A=[];function g(){if(f<i.length){const C=s.parse(i[f],f++,Un);return C?(A.push({image:C,options:{}}),!0):(s.error(A.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(f<i.length){const T=i[f];if((C=T)===null||typeof C!="object"||Array.isArray(C))return!0;const P=T.params,k=T.iconset,N=s.concat(f);if(!P&&!k)return f++,!0;if(P){if(typeof P!="object"||P.constructor!==Object)return N.error('Image options "params" should be an object'),!1;const j={},X=N.concat(void 0,"params");for(const Y in P){if(!Y)return X.error("Image parameter name should be non-empty"),!1;const ae=X.concat(void 0,Y).parse(P[Y],void 0,Ka,void 0,{typeAnnotation:"coerce"});if(!ae)return!1;j[Y]=ae}A[A.length-1].options.params=j}if(k){if(typeof k!="object"||k.constructor!==Object)return N.error('Image options "iconset" should be an object'),!1;if(!k.id)return N.error('Image options "iconset" should have an "id" property'),!1;A[A.length-1].options.iconset=k}return f++,!0}var C;return!0}for(let C=0;C<2;C++)if(!g()||!_())return;return new js(A[0].image,A[1]?A[1].image:void 0,A[0].options,A[1]?A[1].options:void 0)}evaluateParams(i,s){const f={};if(s){for(const A in s)if(s[A])try{f[A]=s[A].evaluate(i)}catch{continue}if(Object.keys(f).length!==0)return{params:f}}}evaluate(i){const s={name:this.namePrimary.evaluate(i),iconsetId:this.iconsetIdPrimary},f=this.nameSecondary?{name:this.nameSecondary.evaluate(i),iconsetId:this.iconsetIdSecondary}:void 0,A=fl.build(s,f,this.paramsPrimary?this.evaluateParams(i,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(i,this.paramsSecondary):void 0);if(A&&i.availableImages){const g=A.getPrimary().id;if(A.available=i.availableImages.some(_=>fo.isEqual(_,g)),A.available){const _=A.getSecondary()?A.getSecondary().id:null;_&&(A.available=i.availableImages.some(C=>fo.isEqual(C,_)))}}return A}eachChild(i){if(i(this.namePrimary),this.paramsPrimary)for(const s in this.paramsPrimary)this.paramsPrimary[s]&&i(this.paramsPrimary[s]);if(this.nameSecondary&&(i(this.nameSecondary),this.paramsSecondary))for(const s in this.paramsSecondary)this.paramsSecondary[s]&&i(this.paramsSecondary[s])}outputDefined(){return!1}serializeOptions(i,s){const f={};if(s&&(f.iconset={id:s}),i){f.params={};for(const A in i)i[A]&&(f.params[A]=i[A].serialize())}return Object.keys(f).length>0?f:void 0}serialize(){const i=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const s=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);s&&i.push(s)}if(this.nameSecondary&&(i.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const s=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);s&&i.push(s)}return i}}function ac(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const Ql={"to-boolean":oi,"to-color":Ka,"to-number":Yr,"to-string":Un};class Zs{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");const f=i[0],A=[];let g=xo;if(f==="to-array"){if(!Array.isArray(i[1]))return null;const _=i[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);g=os(s.expectedType.itemType,_)}else{if(!(_>0&&Xn(i[1][0])))return null;g=os(Rr(i[1][0]),_)}for(let C=0;C<_;C++){const T=i[1][C];let P;if(ac(T)==="array")P=s.parse(T,void 0,g.itemType);else{const k=ac(T);if(k!==g.itemType.kind)return s.error(`Expected ${g.itemType.kind} but found ${k}.`);P=s.registry.literal.parse(["literal",T===void 0?null:T],s)}if(!P)return null;A.push(P)}}else{if((f==="to-boolean"||f==="to-string")&&i.length!==2)return s.error("Expected one argument.");g=Ql[f];for(let _=1;_<i.length;_++){const C=s.parse(i[_],_,Oi);if(!C)return null;A.push(C)}}return new Zs(g,A)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let s,f;for(const A of this.args){if(s=A.evaluate(i),f=null,s instanceof ft)return s;if(typeof s=="string"){const g=i.parseColor(s);if(g)return g}else if(Array.isArray(s)&&(f=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:wu(s[0],s[1],s[2],s[3]),!f))return new ft(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Ao(f||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const f of this.args){if(s=f.evaluate(i),s===null)return 0;const A=Number(s);if(!isNaN(A))return A}throw new Ao(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?zs.fromString(jo(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?fl.build(jo(this.args[0].evaluate(i))):this.type.kind==="array"?this.args.map(s=>s.evaluate(i)):jo(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Qs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new js(this.args[0]).serialize();const i=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{i.push(s.serialize())}),i}}const Hs=["Unknown","Point","LineString","Polygon"];class bu{constructor(i,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=i,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Hs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:f,y:A}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(f*s-i[0])+this.featureDistanceData.bearing[1]*(A*s-i[1])}return 0}parseColor(i){let s=this._parseColorCache[i];return s||(s=this._parseColorCache[i]=ft.parse(i)),s}getConfig(i){return this.options?this.options.get(i):null}}class fa{constructor(i,s,f,A,g){this.name=i,this.type=s,this._evaluate=f,this.args=A,this._overloadIndex=g}evaluate(i){if(!this._evaluate){const s=fa.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,s){const f=i[0],A=fa.definitions[f];if(!A)return s.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(A)?A[0]:A.type,_=Array.isArray(A)?[[A[1],A[2]]]:A.overloads,C=[];let T=null,P=-1;for(const[k,N]of _){if(Array.isArray(k)&&k.length!==i.length-1)continue;C.push(k),P++,T=new DA(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const j=[];let X=!1;for(let Y=1;Y<i.length;Y++){const ae=i[Y],ue=Array.isArray(k)?k[Y-1]:k.type,ge=T.parse(ae,1+j.length,ue);if(!ge){X=!0;break}j.push(ge)}if(!X)if(Array.isArray(k)&&k.length!==j.length)T.error(`Expected ${k.length} arguments, but found ${j.length} instead.`);else{for(let Y=0;Y<j.length;Y++){const ae=Array.isArray(k)?k[Y]:k.type,ue=j[Y];T.concat(Y+1).checkSubtype(ae,ue.type)}if(T.errors.length===0)return new fa(f,g,N,j,P)}}if(C.length===1)s.errors.push(...T.errors);else{const k=(C.length?C:_.map(([j])=>j)).map(EA).join(" | "),N=[];for(let j=1;j<i.length;j++){const X=s.parse(i[j],1+N.length);if(!X)return null;N.push(Qa(X.type))}s.error(`Expected arguments of type ${k}, but found (${N.join(", ")}) instead.`)}return null}static register(i,s){fa.definitions=s;for(const f in s)i[f]=fa}}function EA(c){return Array.isArray(c)?`(${c.map(Qa).join(", ")})`:`(${Qa(c.type)}...)`}class ls{constructor(i,s,f){this.type=qu,this.locale=f,this.caseSensitive=i,this.diacriticSensitive=s}static parse(i,s){if(i.length!==2)return s.error("Expected one argument.");const f=i[1];if(typeof f!="object"||Array.isArray(f))return s.error("Collator options argument must be an object.");const A=f["case-sensitive"]===void 0?s.parse(!1,1,oi):s.parseObjectValue(f["case-sensitive"],1,"case-sensitive",oi);if(!A)return null;const g=f["diacritic-sensitive"]===void 0?s.parse(!1,1,oi):s.parseObjectValue(f["diacritic-sensitive"],1,"diacritic-sensitive",oi);if(!g)return null;let _=null;return f.locale&&(_=s.parseObjectValue(f.locale,1,"locale",Un),!_)?null:new ls(A,g,_)}evaluate(i){return new Sc(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}function lo(c,i,s=0,f=c.length-1,A=pf){for(;f>s;){if(f-s>600){const T=f-s+1,P=i-s+1,k=Math.log(T),N=.5*Math.exp(2*k/3),j=.5*Math.sqrt(k*N*(T-N)/T)*(P-T/2<0?-1:1);lo(c,i,Math.max(s,Math.floor(i-P*N/T+j)),Math.min(f,Math.floor(i+(T-P)*N/T+j)),A)}const g=c[i];let _=s,C=f;for(_h(c,s,i),A(c[f],g)>0&&_h(c,s,f);_<C;){for(_h(c,_,C),_++,C--;A(c[_],g)<0;)_++;for(;A(c[C],g)>0;)C--}A(c[s],g)===0?_h(c,s,C):(C++,_h(c,C,f)),C<=i&&(s=C+1),i<=C&&(f=C-1)}}function _h(c,i,s){const f=c[i];c[i]=c[s],c[s]=f}function pf(c,i){return c<i?-1:c>i?1:0}function BA(c){let i=0;for(let s,f,A=0,g=c.length,_=g-1;A<g;_=A++)s=c[A],f=c[_],i+=(f.x-s.x)*(s.y+f.y);return i}function Tc(c,i){c[0]=Math.min(c[0],i[0]),c[1]=Math.min(c[1],i[1]),c[2]=Math.max(c[2],i[0]),c[3]=Math.max(c[3],i[1])}function Ic(c,i){return!(c[0]<=i[0]||c[2]>=i[2]||c[1]<=i[1]||c[3]>=i[3])}function oc(c,i,s){const f=c[0]-i[0],A=c[1]-i[1],g=c[0]-s[0],_=c[1]-s[1];return f*_-g*A==0&&f*g<=0&&A*_<=0}function sc(c,i,s=!1){let f=!1;for(let C=0,T=i.length;C<T;C++){const P=i[C];for(let k=0,N=P.length,j=N-1;k<N;j=k++){const X=P[j],Y=P[k];if(oc(c,X,Y))return s;(g=X)[1]>(A=c)[1]!=(_=Y)[1]>A[1]&&A[0]<(_[0]-g[0])*(A[1]-g[1])/(_[1]-g[1])+g[0]&&(f=!f)}}var A,g,_;return f}function Nf(c,i,s,f){const A=f[0]-s[0],g=f[1]-s[1],_=(c[0]-s[0])*g-A*(c[1]-s[1]),C=(i[0]-s[0])*g-A*(i[1]-s[1]);return _>0&&C<0||_<0&&C>0}function Il(c,i,s,f){return(A=[f[0]-s[0],f[1]-s[1]])[0]*(g=[i[0]-c[0],i[1]-c[1]])[1]-A[1]*g[0]!=0&&!(!Nf(c,i,s,f)||!Nf(s,f,c,i));var A,g}function Eu(c){const i=new hr(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),s=new hr(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const f of c[0])i.x>f.x&&(i.x=f.x),i.y>f.y&&(i.y=f.y),s.x<f.x&&(s.x=f.x),s.y<f.y&&(s.y=f.y);return{min:i,max:s}}const Wa=8192;function Mo(c,i){const s=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,A=Math.pow(2,i.z);return[Math.round(s*A*Wa),Math.round(f*A*Wa)]}function vs(c,i){for(let s=0;s<i.length;s++)if(sc(c,i[s]))return!0;return!1}function Ts(c,i,s){for(const f of s)for(let A=0,g=f.length,_=g-1;A<g;_=A++)if(Il(c,i,f[_],f[A]))return!0;return!1}function Vs(c,i){for(let s=0;s<c.length;++s)if(!sc(c[s],i))return!1;for(let s=0;s<c.length-1;++s)if(Ts(c[s],c[s+1],i))return!1;return!0}function $u(c,i){for(let s=0;s<i.length;s++)if(Vs(c,i[s]))return!0;return!1}function eu(c,i,s){const f=[];for(let A=0;A<c.length;A++){const g=[];for(let _=0;_<c[A].length;_++){const C=Mo(c[A][_],s);Tc(i,C),g.push(C)}f.push(g)}return f}function tu(c,i,s){const f=[];for(let A=0;A<c.length;A++){const g=eu(c[A],i,s);f.push(g)}return f}function Wd(c,i,s,f){if(c[0]<s[0]||c[0]>s[2]){const A=.5*f;let g=c[0]-s[0]>A?-f:s[0]-c[0]>A?f:0;g===0&&(g=c[0]-s[2]>A?-f:s[2]-c[0]>A?f:0),c[0]+=g}Tc(i,c)}function qd(c,i,s,f){const A=Math.pow(2,f.z)*Wa,g=[f.x*Wa,f.y*Wa],_=[];if(!c)return _;for(const C of c)for(const T of C){const P=[T.x+g[0],T.y+g[1]];Wd(P,i,s,A),_.push(P)}return _}function zf(c,i,s,f){const A=Math.pow(2,f.z)*Wa,g=[f.x*Wa,f.y*Wa],_=[];if(!c)return _;for(const T of c){const P=[];for(const k of T){const N=[k.x+g[0],k.y+g[1]];Tc(i,N),P.push(N)}_.push(P)}if(i[2]-i[0]<=A/2){(C=i)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const T of _)for(const P of T)Wd(P,i,s,A)}var C;return _}class jh{constructor(i,s){this.type=oi,this.geojson=i,this.geometries=s}static parse(i,s){if(i.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Xn(i[1])){const f=i[1];if(f.type==="FeatureCollection")for(let A=0;A<f.features.length;++A){const g=f.features[A].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new jh(f,f.features[A].geometry)}else if(f.type==="Feature"){const A=f.geometry.type;if(A==="Polygon"||A==="MultiPolygon")return new jh(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new jh(f,f)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(s,f){const A=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(!_)return!1;if(f.type==="Polygon"){const C=eu(f.coordinates,g,_),T=qd(s.geometry(),A,g,_);if(!Ic(A,g))return!1;for(const P of T)if(!sc(P,C))return!1}if(f.type==="MultiPolygon"){const C=tu(f.coordinates,g,_),T=qd(s.geometry(),A,g,_);if(!Ic(A,g))return!1;for(const P of T)if(!vs(P,C))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(s,f){const A=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(!_)return!1;if(f.type==="Polygon"){const C=eu(f.coordinates,g,_),T=zf(s.geometry(),A,g,_);if(!Ic(A,g))return!1;for(const P of T)if(!Vs(P,C))return!1}if(f.type==="MultiPolygon"){const C=tu(f.coordinates,g,_),T=zf(s.geometry(),A,g,_);if(!Ic(A,g))return!1;for(const P of T)if(!$u(P,C))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const CA={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Al=1/298.257223563,SA=Al*(2-Al),Xu=Math.PI/180;class Hh{static fromTile(i,s,f){const A=Math.PI*(1-2*(i+.5)/Math.pow(2,s)),g=Math.atan(.5*(Math.exp(A)-Math.exp(-A)))/Xu;return new Hh(g,f)}static get units(){return CA}constructor(i,s){if(i===void 0)throw new Error("No latitude given.");if(s&&!CA[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(CA).join(", ")}`);const f=6378.137*Xu*(s?CA[s]:1),A=Math.cos(i*Xu),g=1/(1-SA*(1-A*A)),_=Math.sqrt(g);this.kx=f*_*A,this.ky=f*_*g*(1-SA)}distance(i,s){const f=Ys(i[0]-s[0])*this.kx,A=(i[1]-s[1])*this.ky;return Math.sqrt(f*f+A*A)}bearing(i,s){const f=Ys(s[0]-i[0])*this.kx;return Math.atan2(f,(s[1]-i[1])*this.ky)/Xu}destination(i,s,f){const A=f*Xu;return this.offset(i,Math.sin(A)*s,Math.cos(A)*s)}offset(i,s,f){return[i[0]+s/this.kx,i[1]+f/this.ky]}lineDistance(i){let s=0;for(let f=0;f<i.length-1;f++)s+=this.distance(i[f],i[f+1]);return s}area(i){let s=0;for(let f=0;f<i.length;f++){const A=i[f];for(let g=0,_=A.length,C=_-1;g<_;C=g++)s+=Ys(A[g][0]-A[C][0])*(A[g][1]+A[C][1])*(f?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(i,s){let f=0;if(s<=0)return i[0];for(let A=0;A<i.length-1;A++){const g=i[A],_=i[A+1],C=this.distance(g,_);if(f+=C,f>s)return mf(g,_,(s-(f-C))/C)}return i[i.length-1]}pointToSegmentDistance(i,s,f){let[A,g]=s,_=Ys(f[0]-A)*this.kx,C=(f[1]-g)*this.ky;if(_!==0||C!==0){const T=(Ys(i[0]-A)*this.kx*_+(i[1]-g)*this.ky*C)/(_*_+C*C);T>1?(A=f[0],g=f[1]):T>0&&(A+=_/this.kx*T,g+=C/this.ky*T)}return _=Ys(i[0]-A)*this.kx,C=(i[1]-g)*this.ky,Math.sqrt(_*_+C*C)}pointOnLine(i,s){let f=1/0,A=i[0][0],g=i[0][1],_=0,C=0;for(let T=0;T<i.length-1;T++){let P=i[T][0],k=i[T][1],N=Ys(i[T+1][0]-P)*this.kx,j=(i[T+1][1]-k)*this.ky,X=0;N===0&&j===0||(X=(Ys(s[0]-P)*this.kx*N+(s[1]-k)*this.ky*j)/(N*N+j*j),X>1?(P=i[T+1][0],k=i[T+1][1]):X>0&&(P+=N/this.kx*X,k+=j/this.ky*X)),N=Ys(s[0]-P)*this.kx,j=(s[1]-k)*this.ky;const Y=N*N+j*j;Y<f&&(f=Y,A=P,g=k,_=T,C=X)}return{point:[A,g],index:_,t:Math.max(0,Math.min(1,C))}}lineSlice(i,s,f){let A=this.pointOnLine(f,i),g=this.pointOnLine(f,s);if(A.index>g.index||A.index===g.index&&A.t>g.t){const P=A;A=g,g=P}const _=[A.point],C=A.index+1,T=g.index;!ud(f[C],_[0])&&C<=T&&_.push(f[C]);for(let P=C+1;P<=T;P++)_.push(f[P]);return ud(f[T],g.point)||_.push(g.point),_}lineSliceAlong(i,s,f){let A=0;const g=[];for(let _=0;_<f.length-1;_++){const C=f[_],T=f[_+1],P=this.distance(C,T);if(A+=P,A>i&&g.length===0&&g.push(mf(C,T,(i-(A-P))/P)),A>=s)return g.push(mf(C,T,(s-(A-P))/P)),g;A>i&&g.push(T)}return g}bufferPoint(i,s){const f=s/this.ky,A=s/this.kx;return[i[0]-A,i[1]-f,i[0]+A,i[1]+f]}bufferBBox(i,s){const f=s/this.ky,A=s/this.kx;return[i[0]-A,i[1]-f,i[2]+A,i[3]+f]}insideBBox(i,s){return Ys(i[0]-s[0])>=0&&Ys(i[0]-s[2])<=0&&i[1]>=s[1]&&i[1]<=s[3]}}function ud(c,i){return c[0]===i[0]&&c[1]===i[1]}function mf(c,i,s){const f=Ys(i[0]-c[0]);return[c[0]+f*s,c[1]+(i[1]-c[1])*s]}function Ys(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class vh{constructor(i=[],s=(f,A)=>f<A?-1:f>A?1:0){if(this.data=i,this.length=this.data.length,this.compare=s,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:s,compare:f}=this,A=s[i];for(;i>0;){const g=i-1>>1,_=s[g];if(f(A,_)>=0)break;s[i]=_,i=g}s[i]=A}_down(i){const{data:s,compare:f}=this,A=this.length>>1,g=s[i];for(;i<A;){let _=1+(i<<1);const C=_+1;if(C<this.length&&f(s[C],s[_])<0&&(_=C),f(s[_],g)>=0)break;s[i]=s[_],i=_}s[i]=g}}var Lr=8192;function Qf(c,i){return i.dist-c.dist}const TA=100,IA=50;function jf(c){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==c.length)return!1;for(let s=0;s<i.length;s++)if(i[s]!==c[s])return!1;return!0}function Vh(c){return c[1]-c[0]+1}function Fc(c,i){const s=c[1]>=c[0]&&c[1]<i;return s||console.warn("Distance Expression: Index is out of range"),s}function FA(c,i){if(c[0]>c[1])return[null,null];const s=Vh(c);if(i){if(s===2)return[c,null];const f=Math.floor(s/2);return[[c[0],c[0]+f],[c[0]+f,c[1]]]}{if(s===1)return[c,null];const f=Math.floor(s/2)-1;return[[c[0],c[0]+f],[c[0]+f+1,c[1]]]}}function Fl(c,i){const s=[1/0,1/0,-1/0,-1/0];if(!Fc(i,c.length))return s;for(let f=i[0];f<=i[1];++f)Tc(s,c[f]);return s}function yh(c){const i=[1/0,1/0,-1/0,-1/0];for(let s=0;s<c.length;++s)for(let f=0;f<c[s].length;++f)Tc(i,c[s][f]);return i}function Ho(c,i,s){if(jf(c)||jf(i))return NaN;let f=0,A=0;return c[2]<i[0]&&(f=i[0]-c[2]),c[0]>i[2]&&(f=c[0]-i[2]),c[1]>i[3]&&(A=c[1]-i[3]),c[3]<i[1]&&(A=i[1]-c[3]),s.distance([0,0],[f,A])}function ai(c){return 360*c-180}function $d(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function xh(c,i){const s=Math.pow(2,i.z),f=(c.y/Lr+i.y)/s;return[ai((c.x/Lr+i.x)/s),$d(f)]}function Sm(c,i){const s=[];for(let f=0;f<c.length;++f)s.push(xh(c[f],i));return s}function Hf(c,i,s){const f=s.pointOnLine(i,c).point;return s.distance(c,f)}function PA(c,i,s,f,A){const g=s.slice(f[0],f[1]+1);let _=1/0;for(let C=i[0];C<=i[1];++C)if((_=Math.min(_,Hf(c[C],g,A)))===0)return 0;return _}function di(c,i,s,f,A){const g=Math.min(A.pointToSegmentDistance(c,s,f),A.pointToSegmentDistance(i,s,f)),_=Math.min(A.pointToSegmentDistance(s,c,i),A.pointToSegmentDistance(f,c,i));return Math.min(g,_)}function Xd(c,i,s,f,A){if(!Fc(i,c.length)||!Fc(f,s.length))return NaN;let g=1/0;for(let _=i[0];_<i[1];++_)for(let C=f[0];C<f[1];++C){if(Il(c[_],c[_+1],s[C],s[C+1]))return 0;g=Math.min(g,di(c[_],c[_+1],s[C],s[C+1],A))}return g}function LA(c,i,s,f,A){if(!Fc(i,c.length)||!Fc(f,s.length))return NaN;let g=1/0;for(let _=i[0];_<=i[1];++_)for(let C=f[0];C<=f[1];++C)if((g=Math.min(g,A.distance(c[_],s[C])))===0)return g;return g}function Vf(c,i,s){if(sc(c,i,!0))return 0;let f=1/0;for(const A of i){const g=A.length;if(g<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(A[0]!==A[g-1]&&(f=Math.min(f,s.pointToSegmentDistance(c,A[g-1],A[0])))===0||(f=Math.min(f,Hf(c,A,s)))===0)return f}return f}function hd(c,i,s,f){if(!Fc(i,c.length))return NaN;for(let g=i[0];g<=i[1];++g)if(sc(c[g],s,!0))return 0;let A=1/0;for(let g=i[0];g<i[1];++g)for(const _ of s)for(let C=0,T=_.length,P=T-1;C<T;P=C++){if(Il(c[g],c[g+1],_[P],_[C]))return 0;A=Math.min(A,di(c[g],c[g+1],_[P],_[C],f))}return A}function MA(c,i){for(const s of c)for(let f=0;f<=s.length-1;++f)if(sc(s[f],i,!0))return!0;return!1}function fd(c,i,s,f=1/0){const A=yh(c),g=yh(i);if(f!==1/0&&Ho(A,g,s)>=f)return f;if(Ic(A,g)){if(MA(c,i))return 0}else if(MA(i,c))return 0;let _=f;for(const C of c)for(let T=0,P=C.length,k=P-1;T<P;k=T++)for(const N of i)for(let j=0,X=N.length,Y=X-1;j<X;Y=j++){if(Il(C[k],C[T],N[Y],N[j]))return 0;_=Math.min(_,di(C[k],C[T],N[Y],N[j],s))}return _}function Gf(c,i,s,f,A,g,_){if(g===null||_===null)return;const C=Ho(Fl(f,g),Fl(A,_),s);C<i&&c.push({dist:C,range1:g,range2:_})}function Kf(c,i,s,f,A=1/0){let g=Math.min(f.distance(c[0],s[0][0]),A);if(g===0)return g;const _=new vh([{dist:0,range1:[0,c.length-1],range2:[0,0]}],Qf),C=i?IA:TA,T=yh(s);for(;_.length;){const P=_.pop();if(P.dist>=g)continue;const k=P.range1;if(Vh(k)<=C){if(!Fc(k,c.length))return NaN;if(i){const N=hd(c,k,s,f);if((g=Math.min(g,N))===0)return g}else for(let N=k[0];N<=k[1];++N){const j=Vf(c[N],s,f);if((g=Math.min(g,j))===0)return g}}else{const N=FA(k,i);if(N[0]!==null){const j=Ho(Fl(c,N[0]),T,f);j<g&&_.push({dist:j,range1:N[0],range2:[0,0]})}if(N[1]!==null){const j=Ho(Fl(c,N[1]),T,f);j<g&&_.push({dist:j,range1:N[1],range2:[0,0]})}}}return g}function Rp(c,i,s,f,A,g=1/0){let _=Math.min(g,A.distance(c[0],s[0]));if(_===0)return _;const C=new vh([{dist:0,range1:[0,c.length-1],range2:[0,s.length-1]}],Qf),T=i?IA:TA,P=f?IA:TA;for(;C.length;){const k=C.pop();if(k.dist>=_)continue;const N=k.range1,j=k.range2;if(Vh(N)<=T&&Vh(j)<=P){if(!Fc(N,c.length)||!Fc(j,s.length))return NaN;if(i&&f?_=Math.min(_,Xd(c,N,s,j,A)):i||f?i&&!f?_=Math.min(_,PA(s,j,c,N,A)):!i&&f&&(_=Math.min(_,PA(c,N,s,j,A))):_=Math.min(_,LA(c,N,s,j,A)),_===0)return _}else{const X=FA(N,i),Y=FA(j,f);Gf(C,_,A,c,s,X[0],Y[0]),Gf(C,_,A,c,s,X[0],Y[1]),Gf(C,_,A,c,s,X[1],Y[0]),Gf(C,_,A,c,s,X[1],Y[1])}}return _}function kp(c,i,s,f,A=1/0){let g=A;const _=Fl(c,[0,c.length-1]);for(const C of s)if(!(g!==1/0&&Ho(_,Fl(C,[0,C.length-1]),f)>=g)&&(g=Math.min(g,Rp(c,i,C,!0,f,g)),g===0))return g;return g}function Zd(c,i,s,f,A=1/0){let g=A;const _=Fl(c,[0,c.length-1]);for(const C of s){if(g!==1/0&&Ho(_,yh(C),f)>=g)continue;const T=Kf(c,i,C,f,g);if(isNaN(T))return T;if((g=Math.min(g,T))===0)return g}return g}function Yd(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class wh{constructor(i,s){this.type=Yr,this.geojson=i,this.geometries=s}static parse(i,s){if(i.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(Xn(i[1])){const f=i[1];if(f.type==="FeatureCollection"){for(let A=0;A<f.features.length;++A)if(Yd(f.features[A].geometry.type))return new wh(f,f.features[A].geometry)}else if(f.type==="Feature"){if(Yd(f.geometry.type))return new wh(f,f.geometry)}else if(Yd(f.type))return new wh(f,f)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const s=i.geometry(),f=i.canonicalID();if(s!=null&&f!=null){if(i.geometryType()==="Point")return function(A,g,_){const C=[];for(const P of A)for(const k of P)C.push(xh(k,g));const T=new Hh(C[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?Rp(C,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",T):_.type==="MultiLineString"?kp(C,!1,_.coordinates,T):_.type==="Polygon"||_.type==="MultiPolygon"?Zd(C,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,T):null}(s,f,this.geometries);if(i.geometryType()==="LineString")return function(A,g,_){const C=[];for(const P of A){const k=[];for(const N of P)k.push(xh(N,g));C.push(k)}const T=new Hh(C[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return kp(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",C,T);if(_.type==="MultiLineString"){let P=1/0;for(let k=0;k<_.coordinates.length;k++){const N=kp(_.coordinates[k],!0,C,T,P);if(isNaN(N))return N;if((P=Math.min(P,N))===0)return P}return P}if(_.type==="Polygon"||_.type==="MultiPolygon"){let P=1/0;for(let k=0;k<C.length;k++){const N=Zd(C[k],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,T,P);if(isNaN(N))return N;if((P=Math.min(P,N))===0)return P}return P}return null}(s,f,this.geometries);if(i.geometryType()==="Polygon")return function(A,g,_){const C=[];for(const P of function(k,N){const j=k.length;if(j<=1)return[k];const X=[];let Y,ae;for(let ue=0;ue<j;ue++){const ge=BA(k[ue]);ge!==0&&(k[ue].area=Math.abs(ge),ae===void 0&&(ae=ge<0),ae===ge<0?(Y&&X.push(Y),Y=[k[ue]]):Y.push(k[ue]))}return Y&&X.push(Y),X}(A)){const k=[];for(let N=0;N<P.length;++N)k.push(Sm(P[N],g));C.push(k)}const T=new Hh(C[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return Zd(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",C,T);if(_.type==="MultiLineString"){let P=1/0;for(let k=0;k<_.coordinates.length;k++){const N=Zd(_.coordinates[k],!0,C,T,P);if(isNaN(N))return N;if((P=Math.min(P,N))===0)return P}return P}return _.type==="Polygon"||_.type==="MultiPolygon"?function(P,k,N){let j=1/0;for(const X of P)for(const Y of k){const ae=fd(X,Y,N,j);if(isNaN(ae))return ae;if((j=Math.min(j,ae))===0)return j}return j}(_.type==="Polygon"?[_.coordinates]:_.coordinates,C,T):null}(s,f,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Zu(c){if(c instanceof fa&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof jh||c instanceof wh)return!1;if(c instanceof OA)return c.featureConstant;let i=!0;return c.eachChild(s=>{i&&!Zu(s)&&(i=!1)}),i}function gf(c){if(c instanceof fa&&c.name==="feature-state")return!1;let i=!0;return c.eachChild(s=>{i&&!gf(s)&&(i=!1)}),i}function bh(c){if(c instanceof OA)return new Set([c.key]);let i=new Set;return c.eachChild(s=>{i=new Set([...i,...bh(s)])}),i}function _f(c,i){if(c instanceof fa&&i.indexOf(c.name)>=0)return!1;let s=!0;return c.eachChild(f=>{s&&!_f(f,i)&&(s=!1)}),s}function Jd(c,i,s){return[c,i,s].filter(Boolean).join("")}function ep(c,i){switch(c){case"string":return jo(i);case"number":return+i;case"boolean":return!!i;case"color":return ft.parse(i);case"formatted":return zs.fromString(jo(i));case"resolvedImage":return fl.build(jo(i))}return i}function Up(c,i,s,f){return f!==void 0&&(c=f*Math.round(c/f)),i!==void 0&&c<i&&(c=i),s!==void 0&&c>s&&(c=s),c}class OA{constructor(i,s,f,A=!1){this.type=i,this.key=s,this.scope=f,this.featureConstant=A}static parse(i,s){let f=s.expectedType;if(f==null&&(f=Oi),i.length<2||i.length>3)return s.error("Invalid number of arguments for 'config' expression.");const A=s.parse(i[1],1);if(!(A instanceof bn))return s.error("Key name of 'config' expression must be a string literal.");let g,_=!0;const C=jo(A.value);if(i.length>=3){const T=s.parse(i[2],2);if(!(T instanceof bn))return s.error("Scope of 'config' expression must be a string literal.");g=jo(T.value)}if(s.options){const T=Jd(C,g,s._scope),P=s.options.get(T);P&&(_=Zu(P.value||P.default))}return new OA(f,C,g,_)}evaluate(i){const s=Jd(this.key,this.scope,i.scope),f=i.getConfig(s);if(!f)return null;const{type:A,value:g,values:_,minValue:C,maxValue:T,stepValue:P}=f,k=f.default.evaluate(i);let N=k;if(g){const j=i.scope;i.scope=(j||"").split("").slice(1).join(""),N=g.evaluate(i),i.scope=j}return A&&(N=ep(A,N)),N===void 0||C===void 0&&T===void 0&&P===void 0||(typeof N=="number"?N=Up(N,C,T,P):Array.isArray(N)&&(N=N.map(j=>typeof j=="number"?Up(j,C,T,P):j))),g!==void 0&&N!==void 0&&_&&!_.includes(N)&&(N=k,A&&(N=ep(A,N))),(A&&A!==this.type||N!==void 0&&!xu(Rr(N),this.type))&&(N=ep(this.type.kind,N)),N}eachChild(){}outputDefined(){return!1}serialize(){const i=["config",this.key];return this.scope&&i.concat(this.scope),i}}class tp{constructor(i,s){this.type=s.type,this.name=i,this.boundExpression=s}static parse(i,s){if(i.length!==2||typeof i[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const f=i[1];return s.scope.has(f)?new tp(f,s.scope.get(f)):s.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class DA{constructor(i,s=[],f,A=new Ga,g=[],_,C){this.registry=i,this.path=s,this.key=s.map(T=>typeof T=="string"?`['${T}']`:`[${T}]`).join(""),this.scope=A,this.errors=g,this.expectedType=f,this._scope=_,this.options=C}parse(i,s,f,A,g={}){return s||f?this.concat(s,null,f,A)._parse(i,g):this._parse(i,g)}parseObjectValue(i,s,f,A,g,_={}){return this.concat(s,f,A,g)._parse(i,_)}_parse(i,s){function f(A,g,_){return _==="assert"?new xn(g,[A]):_==="coerce"?new Zs(g,[A]):A}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const A=typeof i[0]=="string"?this.registry[i[0]]:void 0;if(A){let g=A.parse(i,this);if(!g)return null;if(this.expectedType){const _=this.expectedType,C=g.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||C.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string"){if(this.checkSubtype(_,C))return null}else g=f(g,_,s.typeAnnotation||"coerce");else g=f(g,_,s.typeAnnotation||"assert")}if(!(g instanceof bn)&&g.type.kind!=="resolvedImage"&&Pl(g)){const _=new bu(this._scope,this.options);try{g=new bn(g.type,g.evaluate(_))}catch(C){return this.error(C.message),null}}return g}return Zs.parse(["to-array",i],this)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,s,f,A){let g=typeof i=="number"?this.path.concat(i):this.path;g=typeof s=="string"?g.concat(s):g;const _=A?this.scope.concat(A):this.scope;return new DA(this.registry,g,f||null,_,this.errors,this._scope,this.options)}error(i,...s){const f=`${this.key}${s.map(A=>`[${A}]`).join("")}`;this.errors.push(new Si(f,i))}checkSubtype(i,s){const f=Yc(i,s);return f&&this.error(f),f}}function Pl(c){if(c instanceof tp)return Pl(c.boundExpression);if(c instanceof fa&&c.name==="error"||c instanceof ls||c instanceof jh||c instanceof wh||c instanceof OA)return!1;const i=c instanceof Zs||c instanceof xn;let s=!0;return c.eachChild(f=>{s=i?s&&Pl(f):s&&f instanceof bn}),!!s&&Zu(c)&&_f(c,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function lc(c,i){const s=c.length-1;let f,A,g=0,_=s,C=0;for(;g<=_;)if(C=Math.floor((g+_)/2),f=c[C],A=c[C+1],f<=i){if(C===s||i<A)return C;g=C+1}else{if(!(f>i))throw new Ao("Input is not a number.");_=C-1}return 0}class dl{constructor(i,s,f){this.type=i,this.input=s,this.labels=[],this.outputs=[];for(const[A,g]of f)this.labels.push(A),this.outputs.push(g)}static parse(i,s){if(i.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return s.error("Expected an even number of arguments.");const f=s.parse(i[1],1,Yr);if(!f)return null;const A=[];let g=null;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);for(let _=1;_<i.length;_+=2){const C=_===1?-1/0:i[_],T=i[_+1],P=_,k=_+1;if(typeof C!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(A.length&&A[A.length-1][0]>=C)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const N=s.parse(T,k,g);if(!N)return null;g=g||N.type,A.push([C,N])}return new dl(g,f,A)}evaluate(i){const s=this.labels,f=this.outputs;if(s.length===1)return f[0].evaluate(i);const A=this.input.evaluate(i);if(A<=s[0])return f[0].evaluate(i);const g=s.length;return A>=s[g-1]?f[g-1].evaluate(i):f[lc(s,A)].evaluate(i)}eachChild(i){i(this.input);for(const s of this.outputs)i(s)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&i.push(this.labels[s]),i.push(this.outputs[s].serialize());return i}}const Yu=.95047,Wf=1.08883,Ll=4/29,Js=6/29,Tm=3*Js*Js,Np=Js*Js*Js,vf=Math.PI/180,qf=180/Math.PI;function Gh(c){return c>Np?Math.pow(c,1/3):c/Tm+Ll}function $f(c){return c>Js?c*c*c:Tm*(c-Ll)}function Ad(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Bu(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function ru(c){const i=Bu(c.r),s=Bu(c.g),f=Bu(c.b),A=Gh((.4124564*i+.3575761*s+.1804375*f)/Yu),g=Gh((.2126729*i+.7151522*s+.072175*f)/1);return{l:116*g-16,a:500*(A-g),b:200*(g-Gh((.0193339*i+.119192*s+.9503041*f)/Wf)),alpha:c.a}}function ka(c){let i=(c.l+16)/116,s=isNaN(c.a)?i:i+c.a/500,f=isNaN(c.b)?i:i-c.b/200;return i=1*$f(i),s=Yu*$f(s),f=Wf*$f(f),new ft(Ad(3.2404542*s-1.5371385*i-.4985314*f),Ad(-.969266*s+1.8760108*i+.041556*f),Ad(.0556434*s-.2040259*i+1.0572252*f),c.alpha)}function po(c,i,s){const f=i-c;return c+s*(f>180||f<-180?f-360*Math.round(f/360):f)}const nu={forward:ru,reverse:ka,interpolate:function(c,i,s){return{l:tr(c.l,i.l,s),a:tr(c.a,i.a,s),b:tr(c.b,i.b,s),alpha:tr(c.alpha,i.alpha,s)}}},Is={forward:function(c){const{l:i,a:s,b:f}=ru(c),A=Math.atan2(f,s)*qf;return{h:A<0?A+360:A,c:Math.sqrt(s*s+f*f),l:i,alpha:c.a}},reverse:function(c){const i=c.h*vf,s=c.c;return ka({l:c.l,a:Math.cos(i)*s,b:Math.sin(i)*s,alpha:c.alpha})},interpolate:function(c,i,s){return{h:po(c.h,i.h,s),c:tr(c.c,i.c,s),l:tr(c.l,i.l,s),alpha:tr(c.alpha,i.alpha,s)}}};var Ml=Object.freeze({__proto__:null,hcl:Is,lab:nu});class Fs{constructor(i,s,f,A,g){this.type=i,this.operator=s,this.interpolation=f,this.input=A,this.labels=[],this.outputs=[];for(const[_,C]of g)this.labels.push(_),this.outputs.push(C)}static interpolationFactor(i,s,f,A){let g=0;if(i.name==="exponential")g=yf(s,i.base,f,A);else if(i.name==="linear")g=yf(s,1,f,A);else if(i.name==="cubic-bezier"){const _=i.controlPoints;g=new Ea(_[0],_[1],_[2],_[3]).solve(yf(s,1,f,A))}return g}static parse(i,s){let[f,A,g,..._]=i;if(!Array.isArray(A)||A.length===0)return s.error("Expected an interpolation type expression.",1);if(A[0]==="linear")A={name:"linear"};else if(A[0]==="exponential"){const P=A[1];if(typeof P!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);A={name:"exponential",base:P}}else{if(A[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(A[0])}`,1,0);{const P=A.slice(1);if(P.length!==4||P.some(k=>typeof k!="number"||k<0||k>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);A={name:"cubic-bezier",controlPoints:P}}}if(i.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length-1>3&&(i.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(g=s.parse(g,2,Yr),!g)return null;const C=[];let T=null;f==="interpolate-hcl"||f==="interpolate-lab"?T=Ka:s.expectedType&&s.expectedType.kind!=="value"&&(T=s.expectedType);for(let P=0;P<_.length;P+=2){const k=_[P],N=_[P+1],j=P+3,X=P+4;if(typeof k!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(C.length&&C[C.length-1][0]>=k)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const Y=s.parse(N,X,T);if(!Y)return null;T=T||Y.type,C.push([k,Y])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new Fs(T,f,A,g,C):s.error(`Type ${Qa(T)} is not interpolatable.`)}evaluate(i){const s=this.labels,f=this.outputs;if(s.length===1)return f[0].evaluate(i);const A=this.input.evaluate(i);if(A<=s[0])return f[0].evaluate(i);const g=s.length;if(A>=s[g-1])return f[g-1].evaluate(i);const _=lc(s,A),C=Fs.interpolationFactor(this.interpolation,A,s[_],s[_+1]),T=f[_].evaluate(i),P=f[_+1].evaluate(i);return this.operator==="interpolate"?Yn[this.type.kind.toLowerCase()](T,P,C):this.operator==="interpolate-hcl"?Is.reverse(Is.interpolate(Is.forward(T),Is.forward(P),C)):nu.reverse(nu.interpolate(nu.forward(T),nu.forward(P),C))}eachChild(i){i(this.input);for(const s of this.outputs)i(s)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const s=[this.operator,i,this.input.serialize()];for(let f=0;f<this.labels.length;f++)s.push(this.labels[f],this.outputs[f].serialize());return s}}function yf(c,i,s,f){const A=f-s,g=c-s;return A===0?0:i===1?g/A:(Math.pow(i,g)-1)/(Math.pow(i,A)-1)}class Ol{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expectected at least one argument.");let f=null;const A=s.expectedType;A&&A.kind!=="value"&&(f=A);const g=[];for(const C of i.slice(1)){const T=s.parse(C,1+g.length,f,void 0,{typeAnnotation:"omit"});if(!T)return null;f=f||T.type,g.push(T)}const _=A&&g.some(C=>Yc(A,C.type));return new Ol(_?Oi:f,g)}evaluate(i){let s,f=null,A=0;for(const g of this.args){if(A++,f=g.evaluate(i),f&&f instanceof fl&&!f.available&&(s||(s=f),f=null,A===this.args.length))return s;if(f!==null)break}return f}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(s=>{i.push(s.serialize())}),i}}class xf{constructor(i,s){this.type=s.type,this.bindings=[].concat(i),this.result=s}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const s of this.bindings)i(s[1]);i(this.result)}static parse(i,s){if(i.length<4)return s.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const f=[];for(let g=1;g<i.length-1;g+=2){const _=i[g];if(typeof _!="string")return s.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return s.error("Variable names must contain only alphanumeric characters or '_'.",g);const C=s.parse(i[g+1],g+1);if(!C)return null;f.push([_,C])}const A=s.parse(i[i.length-1],i.length-1,s.expectedType,f);return A?new xf(f,A):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[s,f]of this.bindings)i.push(s,f.serialize());return i.push(this.result.serialize()),i}}class dd{constructor(i,s,f){this.type=i,this.index=s,this.input=f}static parse(i,s){if(i.length!==3)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=s.parse(i[1],1,Yr),A=s.parse(i[2],2,os(s.expectedType||Oi));return f&&A?new dd(A.type.itemType,f,A):null}evaluate(i){const s=this.index.evaluate(i),f=this.input.evaluate(i);if(s<0)throw new Ao(`Array index out of bounds: ${s} < 0.`);if(s>=f.length)throw new Ao(`Array index out of bounds: ${s} > ${f.length-1}.`);if(s!==Math.floor(s))throw new Ao(`Array index must be an integer, but found ${s} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return f[s]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class pd{constructor(i,s,f){this.type=i,this.index=s,this.input=f}static parse(i,s){if(i.length!==3)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=s.parse(i[1],1,Yr),A=s.parse(i[2],2,os(s.expectedType||Oi));return f&&A?new pd(A.type.itemType,f,A):null}evaluate(i){const s=this.index.evaluate(i),f=this.input.evaluate(i);if(s<0)throw new Ao(`Array index out of bounds: ${s} < 0.`);if(s>f.length-1)throw new Ao(`Array index out of bounds: ${s} > ${f.length-1}.`);if(s===Math.floor(s))return f[s];const A=Math.floor(s),g=Math.ceil(s),_=f[A],C=f[g];if(typeof _!="number"||typeof C!="number")throw new Ao(`Cannot interpolate between non-number values at index ${s}.`);const T=s-A;return _*(1-T)+C*T}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class Kh{constructor(i,s){this.type=oi,this.needle=i,this.haystack=s}static parse(i,s){if(i.length!==3)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=s.parse(i[1],1,Oi),A=s.parse(i[2],2,Oi);return f&&A?ic(f.type,[oi,Un,Yr,xo,Oi])?new Kh(f,A):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qa(f.type)} instead`):null}evaluate(i){const s=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(f==null)return!1;if(!_s(s,["boolean","string","number","null"]))throw new Ao(`Expected first argument to be of type boolean, string, number or null, but found ${Qa(Rr(s))} instead.`);if(!_s(f,["string","array"]))throw new Ao(`Expected second argument to be of type array or string, but found ${Qa(Rr(f))} instead.`);return f.indexOf(s)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class md{constructor(i,s,f){this.type=Yr,this.needle=i,this.haystack=s,this.fromIndex=f}static parse(i,s){if(i.length<=2||i.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const f=s.parse(i[1],1,Oi),A=s.parse(i[2],2,Oi);if(!f||!A)return null;if(!ic(f.type,[oi,Un,Yr,xo,Oi]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qa(f.type)} instead`);if(i.length===4){const g=s.parse(i[3],3,Yr);return g?new md(f,A,g):null}return new md(f,A)}evaluate(i){const s=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!_s(s,["boolean","string","number","null"]))throw new Ao(`Expected first argument to be of type boolean, string, number or null, but found ${Qa(Rr(s))} instead.`);if(!_s(f,["string","array"]))throw new Ao(`Expected second argument to be of type array or string, but found ${Qa(Rr(f))} instead.`);if(this.fromIndex){const A=this.fromIndex.evaluate(i);return f.indexOf(s,A)}return f.indexOf(s)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Cu{constructor(i,s,f,A,g,_){this.inputType=i,this.type=s,this.input=f,this.cases=A,this.outputs=g,this.otherwise=_}static parse(i,s){if(i.length<5)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return s.error("Expected an even number of arguments.");let f,A;s.expectedType&&s.expectedType.kind!=="value"&&(A=s.expectedType);const g={},_=[];for(let P=2;P<i.length-1;P+=2){let k=i[P];const N=i[P+1];Array.isArray(k)||(k=[k]);const j=s.concat(P);if(k.length===0)return j.error("Expected at least one branch label.");for(const Y of k){if(typeof Y!="number"&&typeof Y!="string")return j.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return j.error("Numeric branch labels must be integer values.");if(f){if(j.checkSubtype(f,Rr(Y)))return null}else f=Rr(Y);if(g[String(Y)]!==void 0)return j.error("Branch labels must be unique.");g[String(Y)]=_.length}const X=s.parse(N,P,A);if(!X)return null;A=A||X.type,_.push(X)}const C=s.parse(i[1],1,Oi);if(!C)return null;const T=s.parse(i[i.length-1],i.length-1,A);return T?C.type.kind!=="value"&&s.concat(1).checkSubtype(f,C.type)?null:new Cu(f,A,C,g,_,T):null}evaluate(i){const s=this.input.evaluate(i);return(xu(Rr(s),this.inputType)&&this.outputs[this.cases[s]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),f=[],A={};for(const _ of s){const C=A[this.cases[_]];C===void 0?(A[this.cases[_]]=f.length,f.push([this.cases[_],[_]])):f[C][1].push(_)}const g=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,C]of f)i.push(C.length===1?g(C[0]):C.map(g)),i.push(this.outputs[_].serialize());return i.push(this.otherwise.serialize()),i}}class wf{constructor(i,s,f){this.type=i,this.branches=s,this.otherwise=f}static parse(i,s){if(i.length<4)return s.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return s.error("Expected an odd number of arguments.");let f;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);const A=[];for(let _=1;_<i.length-1;_+=2){const C=s.parse(i[_],_,oi);if(!C)return null;const T=s.parse(i[_+1],_+1,f);if(!T)return null;A.push([C,T]),f=f||T.type}const g=s.parse(i[i.length-1],i.length-1,f);return g?new wf(f,A,g):null}evaluate(i){for(const[s,f]of this.branches)if(s.evaluate(i))return f.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[s,f]of this.branches)i(s),i(f);i(this.otherwise)}outputDefined(){return this.branches.every(([i,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(s=>{i.push(s.serialize())}),i}}class z{constructor(i,s,f,A){this.type=i,this.input=s,this.beginIndex=f,this.endIndex=A}static parse(i,s){if(i.length<=2||i.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const f=s.parse(i[1],1,Oi),A=s.parse(i[2],2,Yr);if(!f||!A)return null;if(!ic(f.type,[os(Oi),Un,Oi]))return s.error(`Expected first argument to be of type array or string, but found ${Qa(f.type)} instead`);if(i.length===4){const g=s.parse(i[3],3,Yr);return g?new z(f.type,f,A,g):null}return new z(f.type,f,A)}evaluate(i){const s=this.input.evaluate(i),f=this.beginIndex.evaluate(i);if(!_s(s,["string","array"]))throw new Ao(`Expected first argument to be of type array or string, but found ${Qa(Rr(s))} instead.`);if(this.endIndex){const A=this.endIndex.evaluate(i);return s.slice(f,A)}return s.slice(f)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class W{constructor(i,s){this.type=os(Un),this.str=i,this.delimiter=s}static parse(i,s){if(i.length!==3)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=s.parse(i[1],1,Un),A=s.parse(i[2],2,Un);return f&&A?new W(f,A):void 0}evaluate(i){const s=this.str.evaluate(i),f=this.delimiter.evaluate(i);return s.split(f)}eachChild(i){i(this.str),i(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function ce(c,i){return c==="=="||c==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function ve(c,i,s,f){return f.compare(i,s)===0}function Qe(c,i,s){const f=c!=="=="&&c!=="!=";return class U6{constructor(g,_,C){this.type=oi,this.lhs=g,this.rhs=_,this.collator=C,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const C=g[0];let T=_.parse(g[1],1,Oi);if(!T)return null;if(!ce(C,T.type))return _.concat(1).error(`"${C}" comparisons are not supported for type '${Qa(T.type)}'.`);let P=_.parse(g[2],2,Oi);if(!P)return null;if(!ce(C,P.type))return _.concat(2).error(`"${C}" comparisons are not supported for type '${Qa(P.type)}'.`);if(T.type.kind!==P.type.kind&&T.type.kind!=="value"&&P.type.kind!=="value")return _.error(`Cannot compare types '${Qa(T.type)}' and '${Qa(P.type)}'.`);f&&(T.type.kind==="value"&&P.type.kind!=="value"?T=new xn(P.type,[T]):T.type.kind!=="value"&&P.type.kind==="value"&&(P=new xn(T.type,[P])));let k=null;if(g.length===4){if(T.type.kind!=="string"&&P.type.kind!=="string"&&T.type.kind!=="value"&&P.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(k=_.parse(g[3],3,qu),!k)return null}return new U6(T,P,k)}evaluate(g){const _=this.lhs.evaluate(g),C=this.rhs.evaluate(g);if(f&&this.hasUntypedArgument){const T=Rr(_),P=Rr(C);if(T.kind!==P.kind||T.kind!=="string"&&T.kind!=="number")throw new Ao(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${T.kind}, ${P.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const T=Rr(_),P=Rr(C);if(T.kind!=="string"||P.kind!=="string")return i(g,_,C)}return this.collator?s(g,_,C,this.collator.evaluate(g)):i(g,_,C)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[c];return this.eachChild(_=>{g.push(_.serialize())}),g}}}const qe=Qe("==",function(c,i,s){return i===s},ve),Je=Qe("!=",function(c,i,s){return i!==s},function(c,i,s,f){return!ve(0,i,s,f)}),ut=Qe("<",function(c,i,s){return i<s},function(c,i,s,f){return f.compare(i,s)<0}),dt=Qe(">",function(c,i,s){return i>s},function(c,i,s,f){return f.compare(i,s)>0}),vt=Qe("<=",function(c,i,s){return i<=s},function(c,i,s,f){return f.compare(i,s)<=0}),Wt=Qe(">=",function(c,i,s){return i>=s},function(c,i,s,f){return f.compare(i,s)>=0});class dr{constructor(i,s,f,A,g,_){this.type=Un,this.number=i,this.locale=s,this.currency=f,this.unit=A,this.minFractionDigits=g,this.maxFractionDigits=_}static parse(i,s){if(i.length!==3)return s.error("Expected two arguments.");const f=s.parse(i[1],1,Yr);if(!f)return null;const A=i[2];if(typeof A!="object"||Array.isArray(A))return s.error("NumberFormat options argument must be an object.");let g=null;if(A.locale&&(g=s.parseObjectValue(A.locale,2,"locale",Un),!g))return null;let _=null;if(A.currency&&(_=s.parseObjectValue(A.currency,2,"currency",Un),!_))return null;let C=null;if(A.unit&&(C=s.parseObjectValue(A.unit,2,"unit",Un),!C))return null;let T=null;if(A["min-fraction-digits"]&&(T=s.parseObjectValue(A["min-fraction-digits"],2,"min-fraction-digits",Yr),!T))return null;let P=null;return A["max-fraction-digits"]&&(P=s.parseObjectValue(A["max-fraction-digits"],2,"max-fraction-digits",Yr),!P)?null:new dr(f,g,_,C,T,P)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class yt{constructor(i){this.type=Yr,this.input=i}static parse(i,s){if(i.length!==2)return s.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=s.parse(i[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Qa(f.type)} instead.`):new yt(f):null}evaluate(i){const s=this.input.evaluate(i);if(typeof s=="string"||Array.isArray(s))return s.length;throw new Ao(`Expected value to be of type string or array, but found ${Qa(Rr(s))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(s=>{i.push(s.serialize())}),i}}function rr(c){return function(){c=1831565813+(c|=0)|0;let i=Math.imul(c^c>>>15,1|c);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const lr={"==":qe,"!=":Je,">":dt,"<":ut,">=":Wt,"<=":vt,array:xn,at:dd,"at-interpolated":pd,boolean:xn,case:wf,coalesce:Ol,collator:ls,format:Qs,image:js,in:Kh,"index-of":md,interpolate:Fs,"interpolate-hcl":Fs,"interpolate-lab":Fs,length:yt,let:xf,literal:bn,match:Cu,number:xn,"number-format":dr,object:xn,slice:z,step:dl,string:xn,"to-boolean":Zs,"to-color":Zs,"to-number":Zs,"to-string":Zs,var:tp,within:jh,distance:wh,config:OA,split:W};function Qr(c,[i,s,f,A]){i=i.evaluate(c),s=s.evaluate(c),f=f.evaluate(c);const g=A?A.evaluate(c):1,_=wu(i,s,f,g);if(_)throw new Ao(_);return new ft(i/255,s/255,f/255,g)}function gr(c,[i,s,f,A]){i=i.evaluate(c),s=s.evaluate(c),f=f.evaluate(c);const g=A?A.evaluate(c):1,_=function(P,k,N,j){return typeof P=="number"&&P>=0&&P<=360?typeof k=="number"&&k>=0&&k<=100&&typeof N=="number"&&N>=0&&N<=100?j===void 0||typeof j=="number"&&j>=0&&j<=1?null:`Invalid hsla value [${[P,k,N,j].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof j=="number"?[P,k,N,j]:[P,k,N]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof j=="number"?[P,k,N,j]:[P,k,N]).join(", ")}]: 'h' must be between 0 and 360.`}(i,s,f,g);if(_)throw new Ao(_);const C=`hsla(${i}, ${s}%, ${f}%, ${g})`,T=ft.parse(C);if(!T)throw new Ao(`Failed to parse HSLA color: ${C}`);return T}function Ur(c,i){return c in i}function zr(c,i){const s=i[c];return s===void 0?null:s}function Gr(c){return{type:c}}function rn(c){return{result:"success",value:c}}function ni(c){return{result:"error",value:c}}function Qn(c,i){return!!c&&!!c.parameters&&c.parameters.indexOf(i)>-1}function ra(c){return c["property-type"]==="data-driven"}function si(c){return Qn(c.expression,"measure-light")}function Fa(c){return Qn(c.expression,"zoom")}function Vo(c){return!!c.expression&&c.expression.interpolated}function aa(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Jn(c){return c}function Tn(c,i){const s=i.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",A=f||!(f||c.property!==void 0),g=c.type||(Vo(i)?"exponential":"interval");if(s&&((c=Bi({},c)).stops&&(c.stops=c.stops.map(P=>[P[0],ft.parse(P[1])])),c.default=ft.parse(c.default?c.default:i.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!Ml[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let _,C,T;if(g==="exponential")_=To;else if(g==="interval")_=Ba;else if(g==="categorical"){_=Gi,C=Object.create(null);for(const P of c.stops)C[P[0]]=P[1];T=typeof c.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);_=Go}if(f){const P={},k=[];for(let X=0;X<c.stops.length;X++){const Y=c.stops[X],ae=Y[0].zoom;P[ae]===void 0&&(P[ae]={zoom:ae,type:c.type,property:c.property,default:c.default,stops:[]},k.push(ae)),P[ae].stops.push([Y[0].value,Y[1]])}const N=[];for(const X of k)N.push([P[X].zoom,Tn(P[X],i)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:Fs.interpolationFactor.bind(void 0,j),zoomStops:N.map(X=>X[0]),evaluate:({zoom:X},Y)=>To({stops:N,base:c.base},i,X).evaluate(X,Y)}}if(A){const P=g==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:Fs.interpolationFactor.bind(void 0,P),zoomStops:c.stops.map(k=>k[0]),evaluate:({zoom:k})=>_(c,i,k,C,T)}}return{kind:"source",evaluate(P,k){const N=k&&k.properties?k.properties[c.property]:void 0;return N===void 0?So(c.default,i.default):_(c,i,N,C,T)}}}function So(c,i,s){return c!==void 0?c:i!==void 0?i:s!==void 0?s:void 0}function Gi(c,i,s,f,A){return So(typeof s===A?f[s]:void 0,c.default,i.default)}function Ba(c,i,s){if(ac(s)!=="number")return So(c.default,i.default);const f=c.stops.length;if(f===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[f-1][0])return c.stops[f-1][1];const A=lc(c.stops.map(g=>g[0]),s);return c.stops[A][1]}function To(c,i,s){const f=c.base!==void 0?c.base:1;if(ac(s)!=="number")return So(c.default,i.default);const A=c.stops.length;if(A===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[A-1][0])return c.stops[A-1][1];const g=lc(c.stops.map(k=>k[0]),s),_=function(k,N,j,X){const Y=X-j,ae=k-j;return Y===0?0:N===1?ae/Y:(Math.pow(N,ae)-1)/(Math.pow(N,Y)-1)}(s,f,c.stops[g][0],c.stops[g+1][0]),C=c.stops[g][1],T=c.stops[g+1][1];let P=Yn[i.type]||Jn;if(c.colorSpace&&c.colorSpace!=="rgb"){const k=Ml[c.colorSpace];P=(N,j)=>k.reverse(k.interpolate(k.forward(N),k.forward(j),_))}return typeof C.evaluate=="function"?{evaluate(...k){const N=C.evaluate.apply(void 0,k),j=T.evaluate.apply(void 0,k);if(N!==void 0&&j!==void 0)return P(N,j,_)}}:P(C,T,_)}function Go(c,i,s){return i.type==="color"?s=ft.parse(s):i.type==="formatted"?s=zs.fromString(s.toString()):i.type==="resolvedImage"?s=fl.build(s.toString()):ac(s)===i.type||i.type==="enum"&&i.values[s]||(s=void 0),So(s,c.default,i.default)}fa.register(lr,{error:[{kind:"error"},[Un],(c,[i])=>{throw new Ao(i.evaluate(c))}],typeof:[Un,[Oi],(c,[i])=>Qa(Rr(i.evaluate(c)))],"to-rgba":[os(Yr,4),[Ka],(c,[i])=>i.evaluate(c).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[os(Yr,4),[Ka],(c,[i])=>i.evaluate(c).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[Ka,[Yr,Yr,Yr],Qr],rgba:[Ka,[Yr,Yr,Yr,Yr],Qr],hsl:[Ka,[Yr,Yr,Yr],gr],hsla:[Ka,[Yr,Yr,Yr,Yr],gr],has:{type:oi,overloads:[[[Un],(c,[i])=>Ur(i.evaluate(c),c.properties())],[[Un,Qo],(c,[i,s])=>Ur(i.evaluate(c),s.evaluate(c))]]},get:{type:Oi,overloads:[[[Un],(c,[i])=>zr(i.evaluate(c),c.properties())],[[Un,Qo],(c,[i,s])=>zr(i.evaluate(c),s.evaluate(c))]]},"feature-state":[Oi,[Un],(c,[i])=>zr(i.evaluate(c),c.featureState||{})],properties:[Qo,[],c=>c.properties()],"geometry-type":[Un,[],c=>c.geometryType()],worldview:[Un,[],c=>c.globals.worldview||""],id:[Oi,[],c=>c.id()],zoom:[Yr,[],c=>c.globals.zoom],pitch:[Yr,[],c=>c.globals.pitch||0],"distance-from-center":[Yr,[],c=>c.distanceFromCenter()],"measure-light":[Yr,[Un],(c,[i])=>c.measureLight(i.evaluate(c))],"heatmap-density":[Yr,[],c=>c.globals.heatmapDensity||0],"line-progress":[Yr,[],c=>c.globals.lineProgress||0],"raster-value":[Yr,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[Yr,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[Yr,[],c=>c.globals.skyRadialProgress||0],accumulated:[Oi,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[Yr,Gr(Yr),(c,i)=>{let s=0;for(const f of i)s+=f.evaluate(c);return s}],"*":[Yr,Gr(Yr),(c,i)=>{let s=1;for(const f of i)s*=f.evaluate(c);return s}],"-":{type:Yr,overloads:[[[Yr,Yr],(c,[i,s])=>i.evaluate(c)-s.evaluate(c)],[[Yr],(c,[i])=>-i.evaluate(c)]]},"/":[Yr,[Yr,Yr],(c,[i,s])=>i.evaluate(c)/s.evaluate(c)],"%":[Yr,[Yr,Yr],(c,[i,s])=>i.evaluate(c)%s.evaluate(c)],ln2:[Yr,[],()=>Math.LN2],pi:[Yr,[],()=>Math.PI],e:[Yr,[],()=>Math.E],"^":[Yr,[Yr,Yr],(c,[i,s])=>Math.pow(i.evaluate(c),s.evaluate(c))],sqrt:[Yr,[Yr],(c,[i])=>Math.sqrt(i.evaluate(c))],log10:[Yr,[Yr],(c,[i])=>Math.log(i.evaluate(c))/Math.LN10],ln:[Yr,[Yr],(c,[i])=>Math.log(i.evaluate(c))],log2:[Yr,[Yr],(c,[i])=>Math.log(i.evaluate(c))/Math.LN2],sin:[Yr,[Yr],(c,[i])=>Math.sin(i.evaluate(c))],cos:[Yr,[Yr],(c,[i])=>Math.cos(i.evaluate(c))],tan:[Yr,[Yr],(c,[i])=>Math.tan(i.evaluate(c))],asin:[Yr,[Yr],(c,[i])=>Math.asin(i.evaluate(c))],acos:[Yr,[Yr],(c,[i])=>Math.acos(i.evaluate(c))],atan:[Yr,[Yr],(c,[i])=>Math.atan(i.evaluate(c))],min:[Yr,Gr(Yr),(c,i)=>Math.min(...i.map(s=>s.evaluate(c)))],max:[Yr,Gr(Yr),(c,i)=>Math.max(...i.map(s=>s.evaluate(c)))],abs:[Yr,[Yr],(c,[i])=>Math.abs(i.evaluate(c))],round:[Yr,[Yr],(c,[i])=>{const s=i.evaluate(c);return s<0?-Math.round(-s):Math.round(s)}],floor:[Yr,[Yr],(c,[i])=>Math.floor(i.evaluate(c))],ceil:[Yr,[Yr],(c,[i])=>Math.ceil(i.evaluate(c))],"filter-==":[oi,[Un,Oi],(c,[i,s])=>c.properties()[i.value]===s.value],"filter-id-==":[oi,[Oi],(c,[i])=>c.id()===i.value],"filter-type-==":[oi,[Un],(c,[i])=>c.geometryType()===i.value],"filter-<":[oi,[Un,Oi],(c,[i,s])=>{const f=c.properties()[i.value],A=s.value;return typeof f==typeof A&&f<A}],"filter-id-<":[oi,[Oi],(c,[i])=>{const s=c.id(),f=i.value;return typeof s==typeof f&&s<f}],"filter->":[oi,[Un,Oi],(c,[i,s])=>{const f=c.properties()[i.value],A=s.value;return typeof f==typeof A&&f>A}],"filter-id->":[oi,[Oi],(c,[i])=>{const s=c.id(),f=i.value;return typeof s==typeof f&&s>f}],"filter-<=":[oi,[Un,Oi],(c,[i,s])=>{const f=c.properties()[i.value],A=s.value;return typeof f==typeof A&&f<=A}],"filter-id-<=":[oi,[Oi],(c,[i])=>{const s=c.id(),f=i.value;return typeof s==typeof f&&s<=f}],"filter->=":[oi,[Un,Oi],(c,[i,s])=>{const f=c.properties()[i.value],A=s.value;return typeof f==typeof A&&f>=A}],"filter-id->=":[oi,[Oi],(c,[i])=>{const s=c.id(),f=i.value;return typeof s==typeof f&&s>=f}],"filter-has":[oi,[Oi],(c,[i])=>i.value in c.properties()],"filter-has-id":[oi,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[oi,[os(Un)],(c,[i])=>i.value.indexOf(c.geometryType())>=0],"filter-id-in":[oi,[os(Oi)],(c,[i])=>i.value.indexOf(c.id())>=0],"filter-in-small":[oi,[Un,os(Oi)],(c,[i,s])=>s.value.indexOf(c.properties()[i.value])>=0],"filter-in-large":[oi,[Un,os(Oi)],(c,[i,s])=>function(f,A,g,_){for(;g<=_;){const C=g+_>>1;if(A[C]===f)return!0;A[C]>f?_=C-1:g=C+1}return!1}(c.properties()[i.value],s.value,0,s.value.length-1)],all:{type:oi,overloads:[[[oi,oi],(c,[i,s])=>i.evaluate(c)&&s.evaluate(c)],[Gr(oi),(c,i)=>{for(const s of i)if(!s.evaluate(c))return!1;return!0}]]},any:{type:oi,overloads:[[[oi,oi],(c,[i,s])=>i.evaluate(c)||s.evaluate(c)],[Gr(oi),(c,i)=>{for(const s of i)if(s.evaluate(c))return!0;return!1}]]},"!":[oi,[oi],(c,[i])=>!i.evaluate(c)],"is-supported-script":[oi,[Un],(c,[i])=>{const s=c.globals&&c.globals.isSupportedScript;return!s||s(i.evaluate(c))}],upcase:[Un,[Un],(c,[i])=>i.evaluate(c).toUpperCase()],downcase:[Un,[Un],(c,[i])=>i.evaluate(c).toLowerCase()],concat:[Un,Gr(Oi),(c,i)=>i.map(s=>jo(s.evaluate(c))).join("")],"resolved-locale":[Un,[qu],(c,[i])=>i.evaluate(c).resolvedLocale()],random:[Yr,[Yr,Yr,Oi],(c,i)=>{const[s,f,A]=i.map(_=>_.evaluate(c));if(s>f||s===f)return s;let g;if(typeof A=="string")g=function(_){let C=0;if(_.length===0)return C;for(let T=0;T<_.length;T++)C=(C<<5)-C+_.charCodeAt(T),C|=0;return C}(A);else{if(typeof A!="number")throw new Ao(`Invalid seed input: ${A}`);g=A}return s+rr(g)()*(f-s)}]});class ys{constructor(i,s,f,A){this.expression=i,this._warningHistory={},this._evaluator=new bu(f,A),this._defaultValue=s?function(g){return g.type==="color"&&(aa(g.default)||Array.isArray(g.default))?new ft(0,0,0,0):g.type==="color"?ft.parse(g.default)||null:g.default===void 0?null:g.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this.configDependencies=bh(i)}evaluateWithoutErrorHandling(i,s,f,A,g,_,C,T){return this._evaluator.globals=i,this._evaluator.feature=s,this._evaluator.featureState=f,this._evaluator.canonical=A||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(i,s,f,A,g,_,C,T){this._evaluator.globals=i,this._evaluator.feature=s||null,this._evaluator.featureState=f||null,this._evaluator.canonical=A||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=T||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new Ao(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${P.message}`)),this._defaultValue}}}function Ko(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in lr}function Wo(c,i,s,f){const A=new DA(lr,[],i?function(_){const C={color:Ka,string:Un,number:Yr,enum:Un,boolean:oi,formatted:Af,resolvedImage:df};return _.type==="array"?os(C[_.value]||Oi,_.length):C[_.type]}(i):void 0,void 0,void 0,s,f),g=A.parse(c,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?rn(new ys(g,i,s,f)):ni(A.errors)}class Ps{constructor(i,s,f,A){this.kind=i,this._styleExpression=s,this.isLightConstant=f,this.isLineProgressConstant=A,this.isStateDependent=i!=="constant"&&!gf(s.expression),this.configDependencies=bh(s.expression)}evaluateWithoutErrorHandling(i,s,f,A,g,_){return this._styleExpression.evaluateWithoutErrorHandling(i,s,f,A,g,_)}evaluate(i,s,f,A,g,_){return this._styleExpression.evaluate(i,s,f,A,g,_)}}class ro{constructor(i,s,f,A,g,_){this.kind=i,this.zoomStops=f,this._styleExpression=s,this.isStateDependent=i!=="camera"&&!gf(s.expression),this.isLightConstant=g,this.isLineProgressConstant=_,this.configDependencies=bh(s.expression),this.interpolationType=A}evaluateWithoutErrorHandling(i,s,f,A,g,_){return this._styleExpression.evaluateWithoutErrorHandling(i,s,f,A,g,_)}evaluate(i,s,f,A,g,_){return this._styleExpression.evaluate(i,s,f,A,g,_)}interpolationFactor(i,s,f){return this.interpolationType?Fs.interpolationFactor(this.interpolationType,i,s,f):0}}function Pa(c,i,s,f){if((c=Wo(c,i,s,f)).result==="error")return c;const A=c.value.expression,g=Zu(A);if(!g&&!ra(i))return ni([new Si("","data expressions not supported")]);const _=_f(A,["zoom","pitch","distance-from-center"]);if(!_&&!Fa(i))return ni([new Si("","zoom expressions not supported")]);const C=_f(A,["measure-light"]);if(!C&&!si(i))return ni([new Si("","measure-light expression not supported")]);const T=_f(A,["line-progress"]);if(!T&&!function(N){return Qn(N.expression,"line-progress")}(i))return ni([new Si("","line-progress expression not supported")]);const P=i.expression&&i.expression.relaxZoomRestriction,k=wo(A);return k||_||P?k instanceof Si?ni([k]):k instanceof Fs&&!Vo(i)?ni([new Si("",'"interpolate" expressions cannot be used with this property')]):rn(k?new ro(g&&T?"camera":"composite",c.value,k.labels,k instanceof Fs?k.interpolation:void 0,C,T):new Ps(g&&T?"constant":"source",c.value,C,T)):ni([new Si("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class La{constructor(i,s){this._parameters=i,this._specification=s,Bi(this,Tn(this._parameters,this._specification))}static deserialize(i){return new La(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function wo(c){let i=null;if(c instanceof xf)i=wo(c.result);else if(c instanceof Ol){for(const s of c.args)if(i=wo(s),i)break}else(c instanceof dl||c instanceof Fs)&&c.input instanceof fa&&c.input.name==="zoom"&&(i=c);return i instanceof Si||c.eachChild(s=>{const f=wo(s);f instanceof Si?i=f:i&&f&&i!==f&&(i=new Si("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}var qa,cs,rs=function(){if(cs)return qa;cs=1,qa=i;var c=3;function i(s,f,A){var g=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var _=new Int32Array(this.arrayBuffer);s=_[0],this.d=(f=_[1])+2*(A=_[2]);for(var C=0;C<this.d*this.d;C++){var T=_[c+C],P=_[c+C+1];g.push(T===P?null:_.subarray(T,P))}var k=_[c+g.length+1];this.keys=_.subarray(_[c+g.length],k),this.bboxes=_.subarray(k),this.insert=this._insertReadonly}else{this.d=f+2*A;for(var N=0;N<this.d*this.d;N++)g.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=s,this.padding=A,this.scale=f/s,this.uid=0;var j=A/f*s;this.min=-j,this.max=s+j}return i.prototype.insert=function(s,f,A,g,_){this._forEachCell(f,A,g,_,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(f),this.bboxes.push(A),this.bboxes.push(g),this.bboxes.push(_)},i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},i.prototype._insertCell=function(s,f,A,g,_,C){this.cells[_].push(C)},i.prototype.query=function(s,f,A,g,_){var C=this.min,T=this.max;if(s<=C&&f<=C&&T<=A&&T<=g&&!_)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(s,f,A,g,this._queryCell,P,{},_),P},i.prototype._queryCell=function(s,f,A,g,_,C,T,P){var k=this.cells[_];if(k!==null)for(var N=this.keys,j=this.bboxes,X=0;X<k.length;X++){var Y=k[X];if(T[Y]===void 0){var ae=4*Y;(P?P(j[ae+0],j[ae+1],j[ae+2],j[ae+3]):s<=j[ae+2]&&f<=j[ae+3]&&A>=j[ae+0]&&g>=j[ae+1])?(T[Y]=!0,C.push(N[Y])):T[Y]=!1}}},i.prototype._forEachCell=function(s,f,A,g,_,C,T,P){for(var k=this._convertToCellCoord(s),N=this._convertToCellCoord(f),j=this._convertToCellCoord(A),X=this._convertToCellCoord(g),Y=k;Y<=j;Y++)for(var ae=N;ae<=X;ae++){var ue=this.d*ae+Y;if((!P||P(this._convertFromCellCoord(Y),this._convertFromCellCoord(ae),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(ae+1)))&&_.call(this,s,f,A,g,ue,C,T,P))return}},i.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},i.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,f=c+this.cells.length+1+1,A=0,g=0;g<this.cells.length;g++)A+=this.cells[g].length;var _=new Int32Array(f+A+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var C=f,T=0;T<s.length;T++){var P=s[T];_[c+T]=C,_.set(P,C),C+=P.length}return _[c+s.length]=C,_.set(this.keys,C),_[c+s.length+1]=C+=this.keys.length,_.set(this.bboxes,C),C+=this.bboxes.length,_.buffer},qa}(),ja=ba(rs);const Gs={};function Mr(c,i,s={}){Object.defineProperty(c,"_classRegistryKey",{value:i,writable:!1}),Gs[i]={klass:c,omit:s.omit||[]}}Mr(Object,"Object"),ja.serialize=function(c,i){const s=c.toArrayBuffer();return i&&i.add(s),{buffer:s}},ja.deserialize=function(c){return new ja(c.buffer)},Object.defineProperty(ja,"name",{value:"Grid"}),Mr(ja,"Grid"),delete hr.prototype.constructor,typeof DOMMatrix<"u"&&Mr(DOMMatrix,"DOMMatrix"),Mr(ft,"Color"),Mr(Error,"Error"),Mr(zs,"Formatted"),Mr(Qh,"FormattedSection"),Mr(Ui,"AJAXError"),Mr(fl,"ResolvedImage"),Mr(La,"StylePropertyFunction"),Mr(ys,"StyleExpression",{omit:["_evaluator"]}),Mr(fo,"ImageId"),Mr(ss,"ImageVariant"),Mr(ro,"ZoomDependentExpression"),Mr(Ps,"ZoomConstantExpression"),Mr(fa,"CompoundExpression",{omit:["_evaluate"]});for(const c in lr)Gs[lr[c]._classRegistryKey]||Mr(lr[c],`Expression${c}`);function co(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function ns(c){return self.ImageBitmap&&c instanceof ImageBitmap}function qo(c,i){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(co(c)||ns(c))return i&&i.add(c),c;if(ArrayBuffer.isView(c))return i&&i.add(c.buffer),c;if(c instanceof ImageData)return i&&i.add(c.data.buffer),c;if(Array.isArray(c)){const s=[];for(const f of c)s.push(qo(f,i));return s}if(c instanceof Map){const s={$name:"Map",entries:[]};for(const[f,A]of c.entries())s.entries.push(qo(f),qo(A,i));return s}if(c instanceof Set){const s={$name:"Set"};let f=0;for(const A of c.values())s[++f]=qo(A);return s}if(c instanceof DOMMatrix){const s={$name:"DOMMatrix"},f=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const A of f)s[A]=c[A];return s}if(typeof c=="bigint")return{$name:"BigInt",value:c.toString()};if(typeof c=="object"){const s=c.constructor,f=s._classRegistryKey;if(!f)throw new Error(`Can't serialize object of unregistered class "${s.name}".`);const A=s.serialize?s.serialize(c,i):{};if(!s.serialize){for(const g in c)c.hasOwnProperty(g)&&(Gs[f].omit.indexOf(g)>=0||(A[g]=qo(c[g],i)));c instanceof Error&&(A.message=c.message)}if(A.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(A.$name=f),A}throw new Error("can't serialize object of type "+typeof c)}function bo(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||co(c)||ns(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(bo);if(typeof c=="object"){const i=c.$name||"Object";if(i==="Map"){const A=c.entries||[],g=new Map;for(let _=0;_<A.length;_+=2)g.set(bo(A[_]),bo(A[_+1]));return g}if(i==="Set"){const A=new Set;for(const g of Object.keys(c))g!=="$name"&&A.add(bo(c[g]));return A}if(i==="DOMMatrix"){let A;return A=c.is2D?[c.a,c.b,c.c,c.d,c.e,c.f]:[c.m11,c.m12,c.m13,c.m14,c.m21,c.m22,c.m23,c.m24,c.m31,c.m32,c.m33,c.m34,c.m41,c.m42,c.m43,c.m44],new DOMMatrix(A)}if(i==="BigInt")return BigInt(c.value);const{klass:s}=Gs[i];if(!s)throw new Error(`Can't deserialize unregistered class "${i}".`);if(s.deserialize)return s.deserialize(c);const f=Object.create(s.prototype);for(const A of Object.keys(c))A!=="$name"&&(f[A]=bo(c[A]));return f}throw new Error("can't deserialize object of type "+typeof c)}const hn={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function us(c){for(const i of c)if(el(i.charCodeAt(0)))return!0;return!1}function jl(c){for(const i of c)if(!Io(i.charCodeAt(0)))return!1;return!0}function Io(c){return!(hn.Arabic(c)||hn["Arabic Supplement"](c)||hn["Arabic Extended-A"](c)||hn["Arabic Presentation Forms-A"](c)||hn["Arabic Presentation Forms-B"](c))}function el(c){return!(c!==746&&c!==747&&(c<4352||!(hn["Bopomofo Extended"](c)||hn.Bopomofo(c)||hn["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||hn["CJK Compatibility Ideographs"](c)||hn["CJK Compatibility"](c)||hn["CJK Radicals Supplement"](c)||hn["CJK Strokes"](c)||!(!hn["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||hn["CJK Unified Ideographs Extension A"](c)||hn["CJK Unified Ideographs"](c)||hn["Enclosed CJK Letters and Months"](c)||hn["Hangul Compatibility Jamo"](c)||hn["Hangul Jamo Extended-A"](c)||hn["Hangul Jamo Extended-B"](c)||hn["Hangul Jamo"](c)||hn["Hangul Syllables"](c)||hn.Hiragana(c)||hn["Ideographic Description Characters"](c)||hn.Kanbun(c)||hn["Kangxi Radicals"](c)||hn["Katakana Phonetic Extensions"](c)||hn.Katakana(c)&&c!==12540||!(!hn["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!hn["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||hn["Unified Canadian Aboriginal Syllabics"](c)||hn["Unified Canadian Aboriginal Syllabics Extended"](c)||hn["Vertical Forms"](c)||hn["Yijing Hexagram Symbols"](c)||hn["Yi Syllables"](c)||hn["Yi Radicals"](c))))}function cc(c){return!(el(c)||function(i){return!!(hn["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||hn["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||hn["Letterlike Symbols"](i)||hn["Number Forms"](i)||hn["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||hn["Control Pictures"](i)&&i!==9251||hn["Optical Character Recognition"](i)||hn["Enclosed Alphanumerics"](i)||hn["Geometric Shapes"](i)||hn["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||hn["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||hn["CJK Symbols and Punctuation"](i)||hn.Katakana(i)||hn["Private Use Area"](i)||hn["CJK Compatibility Forms"](i)||hn["Small Form Variants"](i)||hn["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(c))}function Su(c){return hn.Arabic(c)||hn["Arabic Supplement"](c)||hn["Arabic Extended-A"](c)||hn["Arabic Presentation Forms-A"](c)||hn["Arabic Presentation Forms-B"](c)}function Ls(c){return c>=1424&&c<=2303||hn["Arabic Presentation Forms-A"](c)||hn["Arabic Presentation Forms-B"](c)}function Ms(c,i){return!(!i&&Ls(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||hn.Khmer(c))}function bf(c){for(const i of c)if(Ls(i.charCodeAt(0)))return!0;return!1}const xs={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let Ef=null,$o=xs.unavailable,Wh=null;const rp=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&($o=xs.error),Ef&&Ef(c)};function Fo(){iu.fire(new rc("pluginStateChange",{pluginStatus:$o,pluginURL:Wh}))}const iu=new yu,gd=function(){return $o},np=function(){if($o!==xs.deferred||!Wh)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");$o=xs.loading,Fo(),Wh&&Xc({url:Wh},c=>{c?rp(c):($o=xs.loaded,Fo())})},au={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>$o===xs.loaded||au.applyArabicShaping!=null,isLoading:()=>$o===xs.loading,setState(c){$o=c.pluginStatus,Wh=c.pluginURL},isParsing:()=>$o===xs.parsing,isParsed:()=>$o===xs.parsed,getPluginURL:()=>Wh};class oa{constructor(i,s){this.zoom=i,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness,this.worldview=s.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return function(s,f){for(const A of s)if(!Ms(A.charCodeAt(0),f))return!1;return!0}(i,au.isLoaded())}}class Pc{constructor(i,s,f,A){this.property=i,this.value=s,this.expression=function(g,_,C,T){if(aa(g))return new La(g,_);if(Ko(g)||Array.isArray(g)&&g.length>0){const P=Pa(g,_,C,T);if(P.result==="error")throw new Error(P.value.map(k=>`${k.key}: ${k.message}`).join(", "));return P.value}{let P=g;return typeof g=="string"&&_.type==="color"&&(P=ft.parse(g)),{kind:"constant",configDependencies:new Set,evaluate:()=>P}}}(s===void 0?i.specification.default:s,i.specification,f,A)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,s,f){return this.property.possiblyEvaluate(this,i,s,f)}}class Po{constructor(i,s,f){this.property=i,this.value=new Pc(i,void 0,s,f)}transitioned(i,s){return new ws(this.property,this.value,s,xe({},i.transition,this.transition),i.now)}untransitioned(){return new ws(this.property,this.value,null,{},0)}}class is{constructor(i,s,f){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._scope=s,this._options=f,this.configDependencies=new Set}getValue(i){return Gt(this._values[i].value.value)}setValue(i,s){this._values.hasOwnProperty(i)||(this._values[i]=new Po(this._values[i].property,this._scope,this._options)),this._values[i].value=new Pc(this._values[i].property,s===null?void 0:Gt(s),this._scope,this._options),this._values[i].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].value.expression.configDependencies]))}setTransitionOrValue(i,s){s&&(this._options=s);const f=this._properties.properties;if(i)for(const A in i){const g=i[A];if(A.endsWith("-transition")){const _=A.slice(0,-11);f[_]&&this.setTransition(_,g)}else f.hasOwnProperty(A)&&this.setValue(A,g)}}getTransition(i){return Gt(this._values[i].transition)}setTransition(i,s){this._values.hasOwnProperty(i)||(this._values[i]=new Po(this._values[i].property)),this._values[i].transition=Gt(s)||void 0}serialize(){const i={};for(const s of Object.keys(this._values)){const f=this.getValue(s);f!==void 0&&(i[s]=f);const A=this.getTransition(s);A!==void 0&&(i[`${s}-transition`]=A)}return i}transitioned(i,s){const f=new Xf(this._properties);for(const A of Object.keys(this._values))f._values[A]=this._values[A].transitioned(i,s._values[A]);return f}untransitioned(){const i=new Xf(this._properties);for(const s of Object.keys(this._values))i._values[s]=this._values[s].untransitioned();return i}}class ws{constructor(i,s,f,A,g){const _=A.delay||0,C=A.duration||0;g=g||0,this.property=i,this.value=s,this.begin=g+_,this.end=this.begin+C,i.specification.transition&&(A.delay||A.duration)&&(this.prior=f)}possiblyEvaluate(i,s,f){const A=i.now||0,g=this.value.possiblyEvaluate(i,s,f),_=this.prior;if(_){if(A>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(A<this.begin)return _.possiblyEvaluate(i,s,f);{const C=(A-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(i,s,f),g,be(C))}}return g}}class Xf{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,s,f){const A=new Ju(this._properties);for(const g of Object.keys(this._values))A._values[g]=this._values[g].possiblyEvaluate(i,s,f);return A}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Hl{constructor(i,s,f){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._scope=s,this._options=f,this.configDependencies=new Set}getValue(i){return Gt(this._values[i].value)}setValue(i,s){this._values[i]=new Pc(this._values[i].property,s===null?void 0:Gt(s),this._scope,this._options),this._values[i].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].expression.configDependencies]))}serialize(){const i={};for(const s of Object.keys(this._values)){const f=this.getValue(s);f!==void 0&&(i[s]=f)}return i}possiblyEvaluate(i,s,f){const A=new Ju(this._properties);for(const g of Object.keys(this._values))A._values[g]=this._values[g].possiblyEvaluate(i,s,f);return A}}class Tu{constructor(i,s,f){this.property=i,this.value=s,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,s,f,A){return this.property.evaluate(this.value,this.parameters,i,s,f,A)}}class Ju{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class ur{constructor(i){this.specification=i}possiblyEvaluate(i,s){return i.expression.evaluate(s)}interpolate(i,s,f){const A=Yn[this.specification.type];return A?A(i,s,f):i}}class Kr{constructor(i,s){this.specification=i,this.overrides=s}possiblyEvaluate(i,s,f,A){return new Tu(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(s,null,{},f,A)}:i.expression,s)}interpolate(i,s,f){if(i.value.kind!=="constant"||s.value.kind!=="constant")return i;if(i.value.value===void 0||s.value.value===void 0)return new Tu(this,{kind:"constant",value:void 0},i.parameters);const A=Yn[this.specification.type];return A?new Tu(this,{kind:"constant",value:A(i.value.value,s.value.value,f)},i.parameters):i}evaluate(i,s,f,A,g,_){return i.kind==="constant"?i.value:i.evaluate(s,f,A,g,_)}}class Eh{constructor(i){this.specification=i}possiblyEvaluate(i,s,f,A){return!!i.expression.evaluate(s,null,{},f,A)}interpolate(){return!1}}class _a{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new oa(0,{});for(const f in i){const A=i[f];A.specification.overridable&&this.overridableProperties.push(f);const g=this.defaultPropertyValues[f]=new Pc(A,void 0),_=this.defaultTransitionablePropertyValues[f]=new Po(A);this.defaultTransitioningPropertyValues[f]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=g.possiblyEvaluate(s)}}}Mr(Kr,"DataDrivenProperty"),Mr(ur,"DataConstantProperty"),Mr(Eh,"ColorRampProperty");var Bt=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"expression"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function Lc(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function qh(c){if(Array.isArray(c))return c.map(qh);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const i={};for(const s in c)i[s]=qh(c[s]);return i}return Lc(c)}function Bf(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const i of c.slice(1))if(!Bf(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function ou(c,i="",s=null,f="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Bf(c)||(c=Yf(c));const A=c;let g=!0;try{g=function(k){if(!Zf(k))return k;let N=qh(k);return RA(N),N=ip(N),N}(A)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(A,null,2)}
        `)}let _=null,C=null;if(f!=="background"&&f!=="sky"&&f!=="slot"){C=Bt[`filter_${f}`];const k=Wo(g,C,i,s);if(k.result==="error")throw new Error(k.value.map(N=>`${N.key}: ${N.message}`).join(", "));_=(N,j,X)=>k.value.evaluate(N,j,{},X)}let T=null,P=null;if(g!==A){const k=Wo(A,C,i,s);if(k.result==="error")throw new Error(k.value.map(N=>`${N.key}: ${N.message}`).join(", "));T=(N,j,X,Y,ae)=>k.value.evaluate(N,j,{},X,void 0,void 0,Y,ae),P=!Zu(k.value.expression)}return{filter:_,dynamicFilter:T||void 0,needGeometry:Cf(g),needFeature:!!P}}function ip(c){if(!Array.isArray(c))return c;const i=function(s){if(Iu.has(s[0])){for(let f=1;f<s.length;f++)if(Zf(s[f]))return!0}return s}(c);return i===!0?i:i.map(s=>ip(s))}function RA(c){let i=!1;const s=[];if(c[0]==="case"){for(let f=1;f<c.length-1;f+=2)i=i||Zf(c[f]),s.push(c[f+1]);s.push(c[c.length-1])}else if(c[0]==="match"){i=i||Zf(c[1]);for(let f=2;f<c.length-1;f+=2)s.push(c[f+1]);s.push(c[c.length-1])}else if(c[0]==="step"){i=i||Zf(c[1]);for(let f=1;f<c.length-1;f+=2)s.push(c[f+1])}i&&(c.length=0,c.push("any",...s));for(let f=1;f<c.length;f++)RA(c[f])}function Zf(c){if(!Array.isArray(c))return!1;if((i=c[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let s=1;s<c.length;s++)if(Zf(c[s]))return!0;return!1}const Iu=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Im(c,i){return c<i?-1:c>i?1:0}function Cf(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let i=1;i<c.length;i++)if(Cf(c[i]))return!0;return!1}function Yf(c){if(!c)return!0;const i=c[0];return c.length<=1?i!=="any":i==="=="?Jf(c[1],c[2],"=="):i==="!="?Oc(Jf(c[1],c[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Jf(c[1],c[2],i):i==="any"?(s=c.slice(1),["any"].concat(s.map(Yf))):i==="all"?["all"].concat(c.slice(1).map(Yf)):i==="none"?["all"].concat(c.slice(1).map(Yf).map(Oc)):i==="in"?Mc(c[1],c.slice(2)):i==="!in"?Oc(Mc(c[1],c.slice(2))):i==="has"?Bh(c[1]):i!=="!has"||Oc(Bh(c[1]));var s}function Jf(c,i,s){switch(c){case"$type":return[`filter-type-${s}`,i];case"$id":return[`filter-id-${s}`,i];default:return[`filter-${s}`,c,i]}}function Mc(c,i){if(i.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(s=>typeof s!=typeof i[0])?["filter-in-large",c,["literal",i.sort(Im)]]:["filter-in-small",c,["literal",i]]}}function Bh(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Oc(c){return["!",c]}const eh="";function $h(c,i){return i?`${c}${eh}${i}`:c}const _d="-transition",Fm=new Set(["fill","line","background","hillshade","raster"]);class Ks extends yu{constructor(i,s,f,A,g){if(super(),this.id=i.id,this.fqid=$h(this.id,f),this.type=i.type,this.scope=f,this.lut=A,this.options=g,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,i.type!=="custom"){if(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type&&i.type!=="background"&&i.type!=="sky"&&i.type!=="slot"){this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter;const _=Wo(this.filter,Bt[`filter_${i.type}`]);_.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,..._.value.configDependencies]))}if(i.slot&&(this.slot=i.slot),s.layout&&(this._unevaluatedLayout=new Hl(s.layout,this.scope,g),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint){this._transitionablePaint=new is(s.paint,this.scope,g);for(const _ in i.paint)this.setPaintProperty(_,i.paint[_]);for(const _ in i.layout)this.setLayoutProperty(_,i.layout[_]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ju(s.paint)}}}onAdd(i){}onRemove(i){}isDraped(i){return!this.is3D(!0)&&Fm.has(this.type)}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,s){if(this.type==="custom"&&i==="visibility")return void(this.visibility=s);const f=this._unevaluatedLayout;f._properties.properties[i]&&(f.setValue(i,s),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),i==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(i){return i.endsWith(_d)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,s){const f=this._transitionablePaint,A=f._properties.properties;if(i.endsWith(_d)){const N=i.slice(0,-11);return A[N]&&f.setTransition(N,s||void 0),!1}if(!A[i])return!1;const g=f._values[i],_=g.value.isDataDriven(),C=g.value;f.setValue(i,s),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),this._handleSpecialPaintPropertyUpdate(i);const T=f._values[i].value,P=T.isDataDriven(),k=i.endsWith("pattern")||i==="line-dasharray";return P||_||k||this._handleOverridablePaintPropertyUpdate(i,C,T)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,s,f){return null}_handleOverridablePaintPropertyUpdate(i,s,f){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,s)}serialize(){return Vt({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(i,s)=>!(i===void 0||s==="layout"&&!Object.keys(i).length||s==="paint"&&!Object.keys(i).length))}is3D(i){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const i in this.paint._values){const s=this.paint.get(i);if(s instanceof Tu&&ra(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(i){this._filterCompiled||(this._featureFilter=ou(this.filter,this.scope,i),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(i){this._stats&&(i.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(i){}queryIntersectsFeature(i,s,f,A,g,_,C,T,P){}}const ap={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class op{constructor(i,s){this._structArray=i,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Da{constructor(){this.capacity=-1,this.resize(0)}static serialize(i,s){return i._trim(),s&&s.add(i.arrayBuffer),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const s=Object.create(this.prototype);return s.arrayBuffer=i.arrayBuffer,s.length=i.length,s.capacity=i.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...i){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...i){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Di(c,i=1){let s=0,f=0;return{members:c.map(A=>{const g=ap[A.type].BYTES_PER_ELEMENT,_=s=Pm(s,Math.max(i,g)),C=A.components||1;return f=Math.max(f,g),s+=g*C,{name:A.name,type:A.type,components:C,offset:_}}),size:Pm(s,Math.max(f,i)),alignment:i}}function Pm(c,i){return Math.ceil(c/i)*i}class Dc extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s){const f=this.length;return this.resize(f+1),this.emplace(f,i,s)}emplace(i,s,f){const A=2*i;return this.int16[A+0]=s,this.int16[A+1]=f,i}}Dc.prototype.bytesPerElement=4,Mr(Dc,"StructArrayLayout2i4");class sp extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,f){const A=this.length;return this.resize(A+1),this.emplace(A,i,s,f)}emplace(i,s,f,A){const g=3*i;return this.int16[g+0]=s,this.int16[g+1]=f,this.int16[g+2]=A,i}}sp.prototype.bytesPerElement=6,Mr(sp,"StructArrayLayout3i6");class vd extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,f,A){const g=this.length;return this.resize(g+1),this.emplace(g,i,s,f,A)}emplace(i,s,f,A,g){const _=4*i;return this.int16[_+0]=s,this.int16[_+1]=f,this.int16[_+2]=A,this.int16[_+3]=g,i}}vd.prototype.bytesPerElement=8,Mr(vd,"StructArrayLayout4i8");class yd extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.float32[1*i+0]=s,i}}yd.prototype.bytesPerElement=4,Mr(yd,"StructArrayLayout1f4");class kg extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f){const A=this.length;return this.resize(A+1),this.emplace(A,i,s,f)}emplace(i,s,f,A){const g=4*i,_=2*i;return this.int16[g+0]=s,this.int16[g+1]=f,this.float32[_+1]=A,i}}kg.prototype.bytesPerElement=8,Mr(kg,"StructArrayLayout2i1f8");class Lm extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,f){const A=this.length;return this.resize(A+1),this.emplace(A,i,s,f)}emplace(i,s,f,A){const g=4*i;return this.int16[g+0]=s,this.int16[g+1]=f,this.int16[g+2]=A,i}}Lm.prototype.bytesPerElement=8,Mr(Lm,"StructArrayLayout3i8");class zp extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,s,f,A,g)}emplace(i,s,f,A,g,_){const C=5*i;return this.int16[C+0]=s,this.int16[C+1]=f,this.int16[C+2]=A,this.int16[C+3]=g,this.int16[C+4]=_,i}}zp.prototype.bytesPerElement=10,Mr(zp,"StructArrayLayout5i10");class Qp extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C){const T=this.length;return this.resize(T+1),this.emplace(T,i,s,f,A,g,_,C)}emplace(i,s,f,A,g,_,C,T){const P=6*i,k=12*i,N=3*i;return this.int16[P+0]=s,this.int16[P+1]=f,this.uint8[k+4]=A,this.uint8[k+5]=g,this.uint8[k+6]=_,this.uint8[k+7]=C,this.float32[N+2]=T,i}}Qp.prototype.bytesPerElement=12,Mr(Qp,"StructArrayLayout2i4ub1f12");class Rc extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f){const A=this.length;return this.resize(A+1),this.emplace(A,i,s,f)}emplace(i,s,f,A){const g=3*i;return this.float32[g+0]=s,this.float32[g+1]=f,this.float32[g+2]=A,i}}Rc.prototype.bytesPerElement=12,Mr(Rc,"StructArrayLayout3f12");class kA extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,s,f,A,g)}emplace(i,s,f,A,g,_){const C=6*i,T=3*i;return this.uint16[C+0]=s,this.uint16[C+1]=f,this.uint16[C+2]=A,this.uint16[C+3]=g,this.float32[T+2]=_,i}}kA.prototype.bytesPerElement=12,Mr(kA,"StructArrayLayout4ui1f12");class lp extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,f,A){const g=this.length;return this.resize(g+1),this.emplace(g,i,s,f,A)}emplace(i,s,f,A,g){const _=4*i;return this.uint16[_+0]=s,this.uint16[_+1]=f,this.uint16[_+2]=A,this.uint16[_+3]=g,i}}lp.prototype.bytesPerElement=8,Mr(lp,"StructArrayLayout4ui8");class Mm extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_){const C=this.length;return this.resize(C+1),this.emplace(C,i,s,f,A,g,_)}emplace(i,s,f,A,g,_,C){const T=6*i;return this.int16[T+0]=s,this.int16[T+1]=f,this.int16[T+2]=A,this.int16[T+3]=g,this.int16[T+4]=_,this.int16[T+5]=C,i}}Mm.prototype.bytesPerElement=12,Mr(Mm,"StructArrayLayout6i12");class Fu extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C,T,P,k,N,j){const X=this.length;return this.resize(X+1),this.emplace(X,i,s,f,A,g,_,C,T,P,k,N,j)}emplace(i,s,f,A,g,_,C,T,P,k,N,j,X){const Y=12*i;return this.int16[Y+0]=s,this.int16[Y+1]=f,this.int16[Y+2]=A,this.int16[Y+3]=g,this.uint16[Y+4]=_,this.uint16[Y+5]=C,this.uint16[Y+6]=T,this.uint16[Y+7]=P,this.int16[Y+8]=k,this.int16[Y+9]=N,this.int16[Y+10]=j,this.int16[Y+11]=X,i}}Fu.prototype.bytesPerElement=24,Mr(Fu,"StructArrayLayout4i4ui4i24");class UA extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_){const C=this.length;return this.resize(C+1),this.emplace(C,i,s,f,A,g,_)}emplace(i,s,f,A,g,_,C){const T=10*i,P=5*i;return this.int16[T+0]=s,this.int16[T+1]=f,this.int16[T+2]=A,this.float32[P+2]=g,this.float32[P+3]=_,this.float32[P+4]=C,i}}UA.prototype.bytesPerElement=20,Mr(UA,"StructArrayLayout3i3f20");class Xh extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A){const g=this.length;return this.resize(g+1),this.emplace(g,i,s,f,A)}emplace(i,s,f,A,g){const _=4*i;return this.float32[_+0]=s,this.float32[_+1]=f,this.float32[_+2]=A,this.float32[_+3]=g,i}}Xh.prototype.bytesPerElement=16,Mr(Xh,"StructArrayLayout4f16");class Om extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint32[1*i+0]=s,i}}Om.prototype.bytesPerElement=4,Mr(Om,"StructArrayLayout1ul4");class Zh extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s){const f=this.length;return this.resize(f+1),this.emplace(f,i,s)}emplace(i,s,f){const A=2*i;return this.uint16[A+0]=s,this.uint16[A+1]=f,i}}Zh.prototype.bytesPerElement=4,Mr(Zh,"StructArrayLayout2ui4");class Dm extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C,T,P,k,N,j,X){const Y=this.length;return this.resize(Y+1),this.emplace(Y,i,s,f,A,g,_,C,T,P,k,N,j,X)}emplace(i,s,f,A,g,_,C,T,P,k,N,j,X,Y){const ae=20*i,ue=10*i;return this.int16[ae+0]=s,this.int16[ae+1]=f,this.int16[ae+2]=A,this.int16[ae+3]=g,this.int16[ae+4]=_,this.float32[ue+3]=C,this.float32[ue+4]=T,this.float32[ue+5]=P,this.float32[ue+6]=k,this.int16[ae+14]=N,this.uint32[ue+8]=j,this.uint16[ae+18]=X,this.uint16[ae+19]=Y,i}}Dm.prototype.bytesPerElement=40,Mr(Dm,"StructArrayLayout5i4f1i1ul2ui40");class cp extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C){const T=this.length;return this.resize(T+1),this.emplace(T,i,s,f,A,g,_,C)}emplace(i,s,f,A,g,_,C,T){const P=8*i;return this.int16[P+0]=s,this.int16[P+1]=f,this.int16[P+2]=A,this.int16[P+4]=g,this.int16[P+5]=_,this.int16[P+6]=C,this.int16[P+7]=T,i}}cp.prototype.bytesPerElement=16,Mr(cp,"StructArrayLayout3i2i2i16");class Yh extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,s,f,A,g)}emplace(i,s,f,A,g,_){const C=4*i,T=8*i;return this.float32[C+0]=s,this.float32[C+1]=f,this.float32[C+2]=A,this.int16[T+6]=g,this.int16[T+7]=_,i}}Yh.prototype.bytesPerElement=16,Mr(Yh,"StructArrayLayout2f1f2i16");class NA extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_){const C=this.length;return this.resize(C+1),this.emplace(C,i,s,f,A,g,_)}emplace(i,s,f,A,g,_,C){const T=20*i,P=5*i;return this.uint8[T+0]=s,this.uint8[T+1]=f,this.float32[P+1]=A,this.float32[P+2]=g,this.float32[P+3]=_,this.float32[P+4]=C,i}}NA.prototype.bytesPerElement=20,Mr(NA,"StructArrayLayout2ub4f20");class Ua extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,f){const A=this.length;return this.resize(A+1),this.emplace(A,i,s,f)}emplace(i,s,f,A){const g=3*i;return this.uint16[g+0]=s,this.uint16[g+1]=f,this.uint16[g+2]=A,i}}Ua.prototype.bytesPerElement=6,Mr(Ua,"StructArrayLayout3ui6");class up extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue,ge,Pe,Te,Ue,At){const at=this.length;return this.resize(at+1),this.emplace(at,i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue,ge,Pe,Te,Ue,At)}emplace(i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue,ge,Pe,Te,Ue,At,at){const ot=30*i,_t=15*i,wt=60*i;return this.int16[ot+0]=s,this.int16[ot+1]=f,this.int16[ot+2]=A,this.float32[_t+2]=g,this.float32[_t+3]=_,this.uint16[ot+8]=C,this.uint16[ot+9]=T,this.uint32[_t+5]=P,this.uint32[_t+6]=k,this.uint32[_t+7]=N,this.uint16[ot+16]=j,this.uint16[ot+17]=X,this.uint16[ot+18]=Y,this.float32[_t+10]=ae,this.float32[_t+11]=ue,this.uint8[wt+48]=ge,this.uint8[wt+49]=Pe,this.uint8[wt+50]=Te,this.uint32[_t+13]=Ue,this.int16[ot+28]=At,this.uint8[wt+58]=at,i}}up.prototype.bytesPerElement=60,Mr(up,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Rm extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue,ge,Pe,Te,Ue,At,at,ot,_t,wt,Yt,Ft,ir,Ir,cr,xr,Tr,$t){const wr=this.length;return this.resize(wr+1),this.emplace(wr,i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue,ge,Pe,Te,Ue,At,at,ot,_t,wt,Yt,Ft,ir,Ir,cr,xr,Tr,$t)}emplace(i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue,ge,Pe,Te,Ue,At,at,ot,_t,wt,Yt,Ft,ir,Ir,cr,xr,Tr,$t,wr){const Mt=20*i,Xt=40*i,Fr=80*i;return this.float32[Mt+0]=s,this.float32[Mt+1]=f,this.int16[Xt+4]=A,this.int16[Xt+5]=g,this.int16[Xt+6]=_,this.int16[Xt+7]=C,this.int16[Xt+8]=T,this.int16[Xt+9]=P,this.int16[Xt+10]=k,this.int16[Xt+11]=N,this.int16[Xt+12]=j,this.uint16[Xt+13]=X,this.uint16[Xt+14]=Y,this.uint16[Xt+15]=ae,this.uint16[Xt+16]=ue,this.uint16[Xt+17]=ge,this.uint16[Xt+18]=Pe,this.uint16[Xt+19]=Te,this.uint16[Xt+20]=Ue,this.uint16[Xt+21]=At,this.uint16[Xt+22]=at,this.uint16[Xt+23]=ot,this.uint16[Xt+24]=_t,this.uint16[Xt+25]=wt,this.uint16[Xt+26]=Yt,this.uint16[Xt+27]=Ft,this.uint32[Mt+14]=ir,this.float32[Mt+15]=Ir,this.float32[Mt+16]=cr,this.float32[Mt+17]=xr,this.float32[Mt+18]=Tr,this.uint8[Fr+76]=$t,this.uint16[Xt+39]=wr,i}}Rm.prototype.bytesPerElement=80,Mr(Rm,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class km extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_){const C=this.length;return this.resize(C+1),this.emplace(C,i,s,f,A,g,_)}emplace(i,s,f,A,g,_,C){const T=6*i;return this.float32[T+0]=s,this.float32[T+1]=f,this.float32[T+2]=A,this.float32[T+3]=g,this.float32[T+4]=_,this.float32[T+5]=C,i}}km.prototype.bytesPerElement=24,Mr(km,"StructArrayLayout6f24");class zA extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,s,f,A,g)}emplace(i,s,f,A,g,_){const C=5*i;return this.float32[C+0]=s,this.float32[C+1]=f,this.float32[C+2]=A,this.float32[C+3]=g,this.float32[C+4]=_,i}}zA.prototype.bytesPerElement=20,Mr(zA,"StructArrayLayout5f20");class Um extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C){const T=this.length;return this.resize(T+1),this.emplace(T,i,s,f,A,g,_,C)}emplace(i,s,f,A,g,_,C,T){const P=7*i;return this.float32[P+0]=s,this.float32[P+1]=f,this.float32[P+2]=A,this.float32[P+3]=g,this.float32[P+4]=_,this.float32[P+5]=C,this.float32[P+6]=T,i}}Um.prototype.bytesPerElement=28,Mr(Um,"StructArrayLayout7f28");class hp extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C,T,P,k,N){const j=this.length;return this.resize(j+1),this.emplace(j,i,s,f,A,g,_,C,T,P,k,N)}emplace(i,s,f,A,g,_,C,T,P,k,N,j){const X=11*i;return this.float32[X+0]=s,this.float32[X+1]=f,this.float32[X+2]=A,this.float32[X+3]=g,this.float32[X+4]=_,this.float32[X+5]=C,this.float32[X+6]=T,this.float32[X+7]=P,this.float32[X+8]=k,this.float32[X+9]=N,this.float32[X+10]=j,i}}hp.prototype.bytesPerElement=44,Mr(hp,"StructArrayLayout11f44");class Ug extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C,T,P){const k=this.length;return this.resize(k+1),this.emplace(k,i,s,f,A,g,_,C,T,P)}emplace(i,s,f,A,g,_,C,T,P,k){const N=9*i;return this.float32[N+0]=s,this.float32[N+1]=f,this.float32[N+2]=A,this.float32[N+3]=g,this.float32[N+4]=_,this.float32[N+5]=C,this.float32[N+6]=T,this.float32[N+7]=P,this.float32[N+8]=k,i}}Ug.prototype.bytesPerElement=36,Mr(Ug,"StructArrayLayout9f36");class tl extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s){const f=this.length;return this.resize(f+1),this.emplace(f,i,s)}emplace(i,s,f){const A=2*i;return this.float32[A+0]=s,this.float32[A+1]=f,i}}tl.prototype.bytesPerElement=8,Mr(tl,"StructArrayLayout2f8");class uc extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,f,A){const g=this.length;return this.resize(g+1),this.emplace(g,i,s,f,A)}emplace(i,s,f,A,g){const _=6*i;return this.uint32[3*i+0]=s,this.uint16[_+2]=f,this.uint16[_+3]=A,this.uint16[_+4]=g,i}}uc.prototype.bytesPerElement=12,Mr(uc,"StructArrayLayout1ul3ui12");class Nm extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint16[1*i+0]=s,i}}Nm.prototype.bytesPerElement=2,Mr(Nm,"StructArrayLayout1ui2");class jp extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue){const ge=this.length;return this.resize(ge+1),this.emplace(ge,i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue)}emplace(i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue,ge){const Pe=16*i;return this.float32[Pe+0]=s,this.float32[Pe+1]=f,this.float32[Pe+2]=A,this.float32[Pe+3]=g,this.float32[Pe+4]=_,this.float32[Pe+5]=C,this.float32[Pe+6]=T,this.float32[Pe+7]=P,this.float32[Pe+8]=k,this.float32[Pe+9]=N,this.float32[Pe+10]=j,this.float32[Pe+11]=X,this.float32[Pe+12]=Y,this.float32[Pe+13]=ae,this.float32[Pe+14]=ue,this.float32[Pe+15]=ge,i}}jp.prototype.bytesPerElement=64,Mr(jp,"StructArrayLayout16f64");class xd extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,f,A,g,_,C){const T=this.length;return this.resize(T+1),this.emplace(T,i,s,f,A,g,_,C)}emplace(i,s,f,A,g,_,C,T){const P=10*i,k=5*i;return this.uint16[P+0]=s,this.uint16[P+1]=f,this.uint16[P+2]=A,this.uint16[P+3]=g,this.float32[k+2]=_,this.float32[k+3]=C,this.float32[k+4]=T,i}}xd.prototype.bytesPerElement=20,Mr(xd,"StructArrayLayout4ui3f20");class zm extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.int16[1*i+0]=s,i}}zm.prototype.bytesPerElement=2,Mr(zm,"StructArrayLayout1i2");class Hp extends Da{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint8[1*i+0]=s,i}}Hp.prototype.bytesPerElement=1,Mr(Hp,"StructArrayLayout1ub1");class Vp extends op{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Vp.prototype.size=40;class Ng extends Dm{get(i){return new Vp(this,i)}}Mr(Ng,"CollisionBoxArray");class fp extends op{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}fp.prototype.size=60;class Ap extends up{get(i){return new fp(this,i)}}Mr(Ap,"PlacedSymbolArray");class Qm extends op{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}Qm.prototype.size=80;class jm extends Rm{get(i){return new Qm(this,i)}}Mr(jm,"SymbolInstanceArray");class Gp extends yd{getoffsetX(i){return this.float32[1*i+0]}}Mr(Gp,"GlyphOffsetArray");class zg extends Dc{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}Mr(zg,"SymbolLineVertexArray");class dp extends op{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}dp.prototype.size=12;class Kp extends uc{get(i){return new dp(this,i)}}Mr(Kp,"FeatureIndexArray");class G0 extends Zh{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}Mr(G0,"FillExtrusionCentroidArray");class Qg extends op{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Qg.prototype.size=6;class Hm extends sp{get(i){return new Qg(this,i)}}Mr(Hm,"FillExtrusionWallArray");const jg=Di([{name:"a_pos",components:2,type:"Int16"}],4),Vm=Di([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),eA=Di([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class no{constructor(i=[]){this.segments=i}_prepareSegment(i,s,f,A){let g=this.segments[this.segments.length-1];return i>no.MAX_VERTEX_ARRAY_LENGTH&&Hr(`Max vertices per segment is ${no.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!g||g.vertexLength+i>no.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==A)&&(g={vertexOffset:s,primitiveOffset:f,vertexLength:0,primitiveLength:0},A!==void 0&&(g.sortKey=A),this.segments.push(g)),g}prepareSegment(i,s,f,A){return this._prepareSegment(i,s.length,f.length,A)}get(){return this.segments}destroy(){for(const i of this.segments)for(const s in i.vaos)i.vaos[s].destroy()}static simpleSegment(i,s,f,A){return new no([{vertexOffset:i,primitiveOffset:s,vertexLength:f,primitiveLength:A,vaos:{},sortKey:0}])}}function Hg(c,i){return 256*(c=je(Math.floor(c),0,255))+je(Math.floor(i),0,255)}no.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Mr(no,"SegmentVector");const Vg=Di([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Gm=Di([{name:"a_pattern_b",components:4,type:"Uint16"}]),K0=Di([{name:"a_dash",components:4,type:"Uint16"}]);class tA{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,s,f,A){this.ids.push(pl(i)),this.positions.push(s,f,A)}eachPosition(i,s){const f=pl(i);let A=0,g=this.ids.length-1;for(;A<g;){const _=A+g>>1;this.ids[_]>=f?g=_:A=_+1}for(;this.ids[A]===f;)s(this.positions[3*A],this.positions[3*A+1],this.positions[3*A+2]),A++}static serialize(i,s){const f=new Float64Array(i.ids),A=new Uint32Array(i.positions);return Gg(f,A,0,f.length-1),s&&(s.add(f.buffer),s.add(A.buffer)),{ids:f,positions:A}}static deserialize(i){const s=new tA;let f;s.ids=i.ids,s.positions=i.positions;for(const A of s.ids)A!==f&&s.uniqueIds.push(A),f=A;return s.indexed=!0,s}}function pl(c){const i=+c;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:vu(String(c))}function Gg(c,i,s,f){for(;s<f;){const A=c[s+f>>1];let g=s-1,_=f+1;for(;;){do g++;while(c[g]<A);do _--;while(c[_]>A);if(g>=_)break;Km(c,g,_),Km(i,3*g,3*_),Km(i,3*g+1,3*_+1),Km(i,3*g+2,3*_+2)}_-s<f-_?(Gg(c,i,s,_),s=_+1):(Gg(c,i,_+1,f),f=_)}}function Km(c,i,s){const f=c[i];c[i]=c[s],c[s]=f}Mr(tA,"FeaturePositionMap");class su{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,s),this.initialized=!0),!!this.location}set(i,s,f){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Dl extends su{constructor(i){super(i),this.current=0}set(i,s,f){this.fetchUniformLocation(i,s)&&this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}}class Xo extends su{constructor(i){super(i),this.current=0}set(i,s,f){this.fetchUniformLocation(i,s)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class jn extends su{constructor(i){super(i),this.current=[0,0]}set(i,s,f){this.fetchUniformLocation(i,s)&&(f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1])))}}class Jh extends su{constructor(i){super(i),this.current=[0,0,0]}set(i,s,f){this.fetchUniformLocation(i,s)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2])))}}class wd extends su{constructor(i){super(i),this.current=[0,0,0,0]}set(i,s,f){this.fetchUniformLocation(i,s)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class Wm extends su{constructor(i){super(i),this.current=ft.transparent.toPremultipliedRenderColor(null)}set(i,s,f){this.fetchUniformLocation(i,s)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const W0=new Float32Array(16);class rA extends su{constructor(i){super(i),this.current=W0}set(i,s,f){if(this.fetchUniformLocation(i,s)){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let A=1;A<16;A++)if(f[A]!==this.current[A]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}}}const qm=new Float32Array(9),$m=new Float32Array(4);class Xm extends su{constructor(i){super(i),this.current=$m}set(i,s,f){if(this.fetchUniformLocation(i,s)){for(let A=0;A<4;A++)if(f[A]!==this.current[A]){this.current=f,this.gl.uniformMatrix2fv(this.location,!1,f);break}}}}function Zm(c){return[Hg(255*c.r,255*c.g),Hg(255*c.b,255*c.a)]}class pp{constructor(i,s,f,A){this.value=i,this.uniformNames=s.map(g=>`u_${g}`),this.type=f,this.context=A}setUniform(i,s,f,A,g){const _=A.constantOr(this.value);s.set(i,g,_ instanceof ft?_.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):_)}getBinding(i,s){return this.type==="color"?new Wm(i):new Xo(i)}}class QA{constructor(i,s){this.uniformNames=s.map(f=>`u_${f}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(i,s){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br),this.patternTransition=s?s.tl.concat(s.br):this.pattern}setUniform(i,s,f,A,g){let _=null;g!=="u_pattern"&&g!=="u_dash"||(_=this.pattern),g==="u_pattern_b"&&(_=this.patternTransition),g==="u_pixel_ratio"&&(_=this.pixelRatio),_&&s.set(i,g,_)}getBinding(i,s){return s==="u_pattern"||s==="u_pattern_b"||s==="u_dash"?new wd(i):new Xo(i)}}class ef{constructor(i,s,f,A){this.expression=i,this.type=f,this.maxValue=0,this.paintVertexAttributes=s.map(g=>({name:`a_${g}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new A}populatePaintArray(i,s,f,A,g,_,C,T){const P=this.paintVertexArray.length,k=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new oa(0,{brightness:_,worldview:T}),s,{},g,A,C):this.expression.kind==="constant"&&this.expression.value,N=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new oa(0,{brightness:_,worldview:T}),s,{},g,A,C):this.lutExpression.value)==="none";this.paintVertexArray.resize(i),this._setPaintValue(P,i,k,N?null:this.context.lut)}updatePaintArray(i,s,f,A,g,_,C,T){const P=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:C,worldview:T},f,A,void 0,g):this.expression.kind==="constant"&&this.expression.value,k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new oa(0,{brightness:C,worldview:T}),f,A,void 0,g):this.lutExpression.value)==="none";this._setPaintValue(i,s,P,k?null:this.context.lut)}_setPaintValue(i,s,f,A){if(this.type==="color"){const g=Zm(f.toPremultipliedRenderColor(A));for(let _=i;_<s;_++)this.paintVertexArray.emplace(_,g[0],g[1])}else{for(let g=i;g<s;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Oo{constructor(i,s,f,A,g,_){this.expression=i,this.uniformNames=s.map(C=>`u_${C}_t`),this.type=f,this.useIntegerZoom=A,this.context=g,this.maxValue=0,this.paintVertexAttributes=s.map(C=>({name:`a_${C}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(i,s,f,A,g,_,C,T){const P=this.expression.evaluate(new oa(this.context.zoom,{brightness:_,worldview:T}),s,{},g,A,C),k=this.expression.evaluate(new oa(this.context.zoom+1,{brightness:_,worldview:T}),s,{},g,A,C),N=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new oa(0,{brightness:_,worldview:T}),s,{},g,A,C):this.lutExpression.value)==="none",j=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(j,i,P,k,N?null:this.context.lut)}updatePaintArray(i,s,f,A,g,_,C,T){const P=this.expression.evaluate({zoom:this.context.zoom,brightness:C,worldview:T},f,A,void 0,g),k=this.expression.evaluate({zoom:this.context.zoom+1,brightness:C,worldview:T},f,A,void 0,g),N=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new oa(0,{brightness:C,worldview:T}),f,A,void 0,g):this.lutExpression.value)==="none";this._setPaintValue(i,s,P,k,N?null:this.context.lut)}_setPaintValue(i,s,f,A,g){if(this.type==="color"){const _=Zm(f.toPremultipliedRenderColor(g)),C=Zm(f.toPremultipliedRenderColor(g));for(let T=i;T<s;T++)this.paintVertexArray.emplace(T,_[0],_[1],C[0],C[1])}else{for(let _=i;_<s;_++)this.paintVertexArray.emplace(_,f,A);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(A))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,s,f,A,g){const _=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,C=je(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);s.set(i,g,C)}getBinding(i,s){return new Xo(i)}}class Os{constructor(i,s,f,A,g){this.expression=i,this.layerId=g,this.paintVertexAttributes=(f==="array"?K0:Vg).members;for(let _=0;_<s.length;++_);this.paintVertexArray=new A,this.paintTransitionVertexArray=new lp}populatePaintArray(i,s,f,A){const g=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(g,i,s.patterns&&s.patterns[this.layerId],f)}updatePaintArray(i,s,f,A,g,_,C){this._setPaintValues(i,s,f.patterns&&f.patterns[this.layerId],_)}_setPaintValues(i,s,f,A){if(!A||!f)return;const g=A[f[0]],_=A[f[1]];if(g){if(g){const{tl:C,br:T,pixelRatio:P}=g;for(let k=i;k<s;k++)this.paintVertexArray.emplace(k,C[0],C[1],T[0],T[1],P)}if(_){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:C,br:T}=_;for(let P=i;P<s;P++)this.paintTransitionVertexArray.emplace(P,C[0],C[1],T[0],T[1])}}}upload(i){const s=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,s)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=i.createVertexBuffer(this.paintTransitionVertexArray,Gm.members,s))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class Ds{constructor(i,s,f=()=>!0){this.binders={},this._buffers=[],this.context=s;const A=[];for(const g in i.paint._values){const _=i.paint.get(g);if(g.endsWith("-use-theme")||!f(g)||!(_ instanceof Tu&&ra(_.property.specification)))continue;const C=tf(g,i.type),T=_.value,P=_.property.specification.type,k=!!_.property.useIntegerZoom,N=g==="line-dasharray"||g.endsWith("pattern"),j=i.paint.get(`${g}-use-theme`),X=g==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant"||j&&j.value.kind!=="constant";if(T.kind!=="constant"||X)if(T.kind==="source"||X||N){const Y=X0(g,P,"source");this.binders[g]=N?new Os(T,C,P,Y,i.id):new ef(T,C,P,Y),A.push(`/a_${g}`)}else{const Y=X0(g,P,"composite");this.binders[g]=new Oo(T,C,P,k,s,Y),A.push(`/z_${g}`)}else this.binders[g]=N?new QA(T.value,C):new pp(T.value,C,P,s),A.push(`/u_${g}`);j&&(this.binders[g].lutExpression=j.value)}this.cacheKey=A.sort().join("")}getMaxValue(i){const s=this.binders[i];return s instanceof ef||s instanceof Oo?s.maxValue:0}populatePaintArrays(i,s,f,A,g,_,C,T){for(const P in this.binders){const k=this.binders[P];k.context=this.context,(k instanceof ef||k instanceof Oo||k instanceof Os)&&k.populatePaintArray(i,s,f,A,g,_,C,T)}}setConstantPatternPositions(i,s){for(const f in this.binders){const A=this.binders[f];A instanceof QA&&A.setConstantPatternPositions(i,s)}}getPatternTransitionVertexBuffer(i){const s=this.binders[i];return s instanceof Os?s.paintTransitionVertexBuffer:null}updatePaintArrays(i,s,f,A,g,_,C,T,P,k){let N=!1;const j=Object.keys(i),X=j.length!==0&&!T,Y=X?j:s.uniqueIds;this.context.lut=g.lut;for(const ae in this.binders){const ue=this.binders[ae];if(ue.context=this.context,(ue instanceof ef||ue instanceof Oo||ue instanceof Os)&&ue.expression&&ue.expression.kind&&ue.expression.kind!=="constant"&&(ue.expression.isStateDependent===!0||ue.expression.isLightConstant===!1)){const ge=g.paint.get(ae);ue.expression=ge.value;for(const Pe of Y){const Te=i[Pe.toString()];s.eachPosition(Pe,(Ue,At,at)=>{const ot=A.feature(Ue);ue.updatePaintArray(At,at,ot,Te,_,C,P,k)})}if(!X)for(const Pe of f.uniqueIds){const Te=i[Pe.toString()];f.eachPosition(Pe,(Ue,At,at)=>{const ot=A.feature(Ue);ue.updatePaintArray(At,at,ot,Te,_,C,P,k)})}N=!0}}return N}defines(){const i=[];for(const s in this.binders){const f=this.binders[s];(f instanceof pp||f instanceof QA)&&i.push(...f.uniformNames.map(A=>`#define HAS_UNIFORM_${A}`))}return i}getBinderAttributes(){const i=[];for(const s in this.binders){const f=this.binders[s];if(f instanceof ef||f instanceof Oo||f instanceof Os)for(let A=0;A<f.paintVertexAttributes.length;A++)i.push(f.paintVertexAttributes[A].name);if(f instanceof Os)for(let A=0;A<Gm.members.length;A++)i.push(Gm.members[A].name)}return i}getBinderUniforms(){const i=[];for(const s in this.binders){const f=this.binders[s];if(f instanceof pp||f instanceof QA||f instanceof Oo)for(const A of f.uniformNames)i.push(A)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const s=[];for(const f in this.binders){const A=this.binders[f];if(A instanceof pp||A instanceof QA||A instanceof Oo)for(const g of A.uniformNames)s.push({name:g,property:f,binding:A.getBinding(i,g)})}return s}setUniforms(i,s,f,A,g){for(const{name:_,property:C,binding:T}of f)this.binders[C].setUniform(i,T,g,A.get(C),_)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const s=this.binders[i];(s instanceof ef||s instanceof Oo||s instanceof Os)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer),s instanceof Os&&s.paintTransitionVertexBuffer&&this._buffers.push(s.paintTransitionVertexBuffer)}}upload(i){for(const s in this.binders){const f=this.binders[s];(f instanceof ef||f instanceof Oo||f instanceof Os)&&f.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const s=this.binders[i];(s instanceof ef||s instanceof Oo||s instanceof Os)&&s.destroy()}}}class Pu{constructor(i,s,f=()=>!0){this.programConfigurations={};for(const A of i)this.programConfigurations[A.id]=new Ds(A,s,f);this.needsUpload=!1,this._featureMap=new tA,this._featureMapWithoutIds=new tA,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,s,f,A,g,_,C,T,P){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(i,s,A,g,_,C,T,P);s.id!==void 0?this._featureMap.add(s.id,f,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,f,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,s,f,A,g,_,C,T){for(const P of f)this.needsUpload=this.programConfigurations[P.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,s,P,A,g,_,C||0,T)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const q0={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function tf(c,i){return q0[c]||[c.replace(`${i}-`,"").replace(/-/g,"_")]}const $0={"line-pattern":{source:kA,composite:kA},"fill-pattern":{source:kA,composite:kA},"fill-extrusion-pattern":{source:kA,composite:kA},"line-dasharray":{source:lp,composite:lp}},Sf={color:{source:tl,composite:Xh},number:{source:yd,composite:tl}};function X0(c,i,s){const f=$0[c];return f&&f[s]||Sf[i][s]}Mr(pp,"ConstantBinder"),Mr(QA,"PatternConstantBinder"),Mr(ef,"SourceExpressionBinder"),Mr(Os,"PatternCompositeBinder"),Mr(Oo,"CompositeExpressionBinder"),Mr(Ds,"ProgramConfiguration",{omit:["_buffers"]}),Mr(Pu,"ProgramConfigurationSet");const Vl=Lr/Math.PI/2,Kg=5,p=6,o=16383,h=64,m=[h,32,16],w=-Vl,E=Vl;function S(c,i,s,f=Vl){return s=_n(s),[c*Math.sin(s)*f,-i*f,c*Math.cos(s)*f]}function F(c,i,s){return S(Math.cos(_n(c)),Math.sin(_n(c)),i,s)}const D=63710088e-1,Q=2*Math.PI*D;class V{constructor(i,s){if(isNaN(i)||isNaN(s))throw new Error(`Invalid LngLat object: (${i}, ${s})`);if(this.lng=+i,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new V(Ee(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const s=Math.PI/180,f=this.lat*s,A=i.lat*s,g=Math.sin(f)*Math.sin(A)+Math.cos(f)*Math.cos(A)*Math.cos((i.lng-this.lng)*s);return D*Math.acos(Math.min(g,1))}toBounds(i=0){const s=360*i/40075017,f=s/Math.cos(Math.PI/180*this.lat);return new Z({lng:this.lng-f,lat:this.lat-s},{lng:this.lng+f,lat:this.lat+s})}toEcef(i){return F(this.lat,this.lng,Vl+i*Vl/D)}static convert(i){if(i instanceof V)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new V(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new V(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Z{constructor(i,s){if(i)if(s)this.setSouthWest(i).setNorthEast(s);else if(i.length===4){const f=i;this.setSouthWest([f[0],f[1]]).setNorthEast([f[2],f[3]])}else{const f=i;this.setSouthWest(f[0]).setNorthEast(f[1])}}setNorthEast(i){return this._ne=i instanceof V?new V(i.lng,i.lat):V.convert(i),this}setSouthWest(i){return this._sw=i instanceof V?new V(i.lng,i.lat):V.convert(i),this}extend(i){const s=this._sw,f=this._ne;let A,g;if(i instanceof V)A=i,g=i;else{if(!(i instanceof Z))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Z.convert(i)):this.extend(V.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(V.convert(i)):this;if(A=i._sw,g=i._ne,!A||!g)return this}return s||f?(s.lng=Math.min(A.lng,s.lng),s.lat=Math.min(A.lat,s.lat),f.lng=Math.max(g.lng,f.lng),f.lat=Math.max(g.lat,f.lat)):(this._sw=new V(A.lng,A.lat),this._ne=new V(g.lng,g.lat)),this}getCenter(){return new V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new V(this.getWest(),this.getNorth())}getSouthEast(){return new V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:s,lat:f}=V.convert(i);let A=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(A=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&A}static convert(i){if(i)return i instanceof Z?i:new Z(i)}}const K=0,ee=25.5;function he(c){return Q*Math.cos(c*Math.PI/180)}function le(c){return(180+c)/360}function Ae(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function fe(c,i){return c/he(i)}function Ce(c){return 360*c-180}function ke(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function He(c,i){return c*he(ke(i))}const $e=85.051129;function it(c){return Math.cos(_n(je(c,-$e,$e)))}function ct(c,i){const s=je(i,K,ee),f=Math.pow(2,s);return it(c)*Q/(512*f)}function Xe(c){return 1/Math.cos(c*Math.PI/180)}function Ye(c,i=0){const s=Math.exp(Math.PI*(1-(c.y+i/Lr)/(1<<c.z)*2));return 80150034*s/(s*s+1)/Lr/(1<<c.z)}class tt{constructor(i,s,f=0){this.x=+i,this.y=+s,this.z=+f}static fromLngLat(i,s=0){const f=V.convert(i);return new tt(le(f.lng),Ae(f.lat),fe(s,f.lat))}toLngLat(){return new V(Ce(this.x),ke(this.y))}toAltitude(){return He(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Q*Xe(ke(this.y))}}function Pt(c,i,s,f,A,g,_,C,T){const P=(i+f)/2,k=(s+A)/2,N=new hr(P,k);C(N),function(j,X,Y,ae,ue,ge){const Pe=Y-ue,Te=ae-ge;return Math.abs((ae-X)*Pe-(Y-j)*Te)/Math.hypot(Pe,Te)}(N.x,N.y,g.x,g.y,_.x,_.y)>=T?(Pt(c,i,s,P,k,g,N,C,T),Pt(c,P,k,f,A,N,_,C,T)):c.push(_)}function gt(c,i,s){let f=c[0],A=f.x,g=f.y;i(f);const _=[f];for(let C=1;C<c.length;C++){const T=c[C],{x:P,y:k}=T;i(T),Pt(_,A,g,P,k,f,T,i,s),A=P,g=k,f=T}return _}function Jt(c,i,s,f){if(f(i,s)){const A=i.add(s)._mult(.5);Jt(c,i,A,f),Jt(c,A,s,f)}else c.push(s)}function kt(c,i){let s=c[0];const f=[s];for(let A=1;A<c.length;A++){const g=c[A];Jt(f,s,g,i),s=g}return f}const or=Math.pow(2,14)-1,pr=-or-1;function It(c,i){const s=Math.round(c.x*i),f=Math.round(c.y*i);return c.x=je(s,pr,or),c.y=je(f,pr,or),(s<c.x||s>c.x+1||f<c.y||f>c.y+1)&&Hr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function ht(c,i,s){const f=c.loadGeometry(),A=c.extent,g=Lr/A;if(i&&s&&s.projection.isReprojectedInTileSpace){const _=1<<i.z,{scale:C,x:T,y:P,projection:k}=s,N=j=>{const X=Ce((i.x+j.x/A)/_),Y=ke((i.y+j.y/A)/_),ae=k.project(X,Y);j.x=(ae.x*C-T)*A,j.y=(ae.y*C-P)*A};for(let j=0;j<f.length;j++)if(c.type!==1)f[j]=gt(f[j],N,1);else{const X=[];for(const Y of f[j])Y.x<0||Y.x>=A||Y.y<0||Y.y>=A||(N(Y),X.push(Y));f[j]=X}}for(const _ of f)for(const C of _)It(C,g);return f}function zt(c,i){return{type:c.type,id:c.id,properties:c.properties,geometry:i?ht(c):[]}}class Ot{constructor(i,s,f,A,g){this.properties={},this.extent=f,this.type=0,this.id=void 0,this._pbf=i,this._geometry=-1,this._keys=A,this._values=g,i.readFields(fr,this,s)}loadGeometry(){const i=this._pbf;i.pos=this._geometry;const s=i.readVarint()+i.pos,f=[];let A,g=1,_=0,C=0,T=0;for(;i.pos<s;){if(_<=0){const P=i.readVarint();g=7&P,_=P>>3}if(_--,g===1||g===2)C+=i.readSVarint(),T+=i.readSVarint(),g===1&&(A&&f.push(A),A=[]),A&&A.push(new hr(C,T));else{if(g!==7)throw new Error(`unknown command ${g}`);A&&A.push(A[0].clone())}}return A&&f.push(A),f}bbox(){const i=this._pbf;i.pos=this._geometry;const s=i.readVarint()+i.pos;let f=1,A=0,g=0,_=0,C=1/0,T=-1/0,P=1/0,k=-1/0;for(;i.pos<s;){if(A<=0){const N=i.readVarint();f=7&N,A=N>>3}if(A--,f===1||f===2)g+=i.readSVarint(),_+=i.readSVarint(),g<C&&(C=g),g>T&&(T=g),_<P&&(P=_),_>k&&(k=_);else if(f!==7)throw new Error(`unknown command ${f}`)}return[C,P,T,k]}toGeoJSON(i,s,f){const A=this.extent*Math.pow(2,f),g=this.extent*i,_=this.extent*s,C=this.loadGeometry();function T(j){return[360*(j.x+g)/A-180,360/Math.PI*Math.atan(Math.exp((1-2*(j.y+_)/A)*Math.PI))-90]}function P(j){return j.map(T)}let k;if(this.type===1){const j=[];for(const Y of C)j.push(Y[0]);const X=P(j);k=j.length===1?{type:"Point",coordinates:X[0]}:{type:"MultiPoint",coordinates:X}}else if(this.type===2){const j=C.map(P);k=j.length===1?{type:"LineString",coordinates:j[0]}:{type:"MultiLineString",coordinates:j}}else{if(this.type!==3)throw new Error("unknown feature type");{const j=function(Y){const ae=Y.length;if(ae<=1)return[Y];const ue=[];let ge,Pe;for(let Te=0;Te<ae;Te++){const Ue=Ar(Y[Te]);Ue!==0&&(Pe===void 0&&(Pe=Ue<0),Pe===Ue<0?(ge&&ue.push(ge),ge=[Y[Te]]):ge&&ge.push(Y[Te]))}return ge&&ue.push(ge),ue}(C),X=[];for(const Y of j)X.push(Y.map(P));k=X.length===1?{type:"Polygon",coordinates:X[0]}:{type:"MultiPolygon",coordinates:X}}}const N={type:"Feature",geometry:k,properties:this.properties};return this.id!=null&&(N.id=this.id),N}}function fr(c,i,s){c===1?i.id=s.readVarint():c===2?function(f,A){const g=f.readVarint()+f.pos;for(;f.pos<g;){const _=A._keys[f.readVarint()],C=A._values[f.readVarint()];A.properties[_]=C}}(s,i):c===3?i.type=s.readVarint():c===4&&(i._geometry=s.pos)}function Ar(c){let i=0;for(let s,f,A=0,g=c.length,_=g-1;A<g;_=A++)s=c[A],f=c[_],i+=(f.x-s.x)*(s.y+f.y);return i}Ot.types=["Unknown","Point","LineString","Polygon"];class yr{constructor(i,s){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(Br,this,s),this.length=this._features.length}feature(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];const s=this._pbf.readVarint()+this._pbf.pos;return new Ot(this._pbf,s,this.extent,this._keys,this._values)}}function Br(c,i,s){c===15?i.version=s.readVarint():c===1?i.name=s.readString():c===5?i.extent=s.readVarint():c===2?i._features.push(s.pos):c===3?i._keys.push(s.readString()):c===4&&i._values.push(function(f){let A=null;const g=f.readVarint()+f.pos;for(;f.pos<g;){const _=f.readVarint()>>3;A=_===1?f.readString():_===2?f.readFloat():_===3?f.readDouble():_===4?f.readVarint64():_===5?f.readVarint():_===6?f.readSVarint():_===7?f.readBoolean():null}if(A==null)throw new Error("unknown feature value");return A}(s))}class ln{constructor(i,s){this.layers=i.readFields(dn,{},s)}}function dn(c,i,s){if(c===3){const f=new yr(s,s.readVarint()+s.pos);f.length&&(i[f.name]=f)}}const Wr="3d_elevation_id",An="level";class cn{constructor(){this._valid=!1}reset(i){return this.feature=i,this._valid=!0,this._geometry=i.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(i,s){return this._valid&&i(s(this._geometry)),this}require(i,s,f){return this.get(i,!0,s,f)}optional(i,s,f){return this.get(i,!1,s,f)}success(){return this._valid}get(i,s,f,A){const g=this.feature.properties.hasOwnProperty(i)?+this.feature.properties[i]:void 0;return this._valid&&g!==void 0&&!Number.isNaN(g)?f(A?A(g):g):s&&(this._valid=!1),this}}class Ln{constructor(i,s){this.featureFunc=i,this.vertexFunc=s}parseFeature(i,s,f){return this.featureFunc(i,s,f)}parseVertex(i,s,f){return this.vertexFunc(i,s,f)}}const Wn=new Ln((c,i,s)=>c.reset(i).require(Wr,f=>{s.id=f}).optional("fixed_height_relative",f=>{s.constantHeight=f},ji.decodeRelativeHeight).geometry(f=>{s.bounds=f},Eu).success(),(c,i,s)=>c.reset(i).require(Wr,f=>{s.id=f}).require("elevation_idx",f=>{s.idx=f}).require("extent",f=>{s.extent=f}).require("height_relative",f=>{s.height=f},ji.decodeRelativeHeight).geometry(f=>{s.position=f},ji.getPoint).success()),hi=new Ln((c,i,s)=>c.reset(i).require(Wr,f=>{s.id=f}).optional("fixed_height",f=>{s.constantHeight=f},ji.decodeMetricHeight).geometry(f=>{s.bounds=f},Eu).success(),(c,i,s)=>c.reset(i).require(Wr,f=>{s.id=f}).require("elevation_idx",f=>{s.idx=f}).require("extent",f=>{s.extent=f}).require("height",f=>{s.height=f},ji.decodeMetricHeight).geometry(f=>{s.position=f},ji.getPoint).success());class ji{static getPoint(i){return ua(i[0][0].x,i[0][0].y)}static decodeRelativeHeight(i){return 1e-4*i*5}static decodeMetricHeight(i){return 1e-4*i}static parse(i){const s=[],f=[],A=i.length,g=new cn;for(let C=0;C<A;C++){const T=i.feature(C),P=T.properties.version,k=(_=P)?_==="1.0.1"?hi:void 0:Wn;if(k===void 0){Hr(`Unknown elevation feature version number ${P||"(unknown)"}`);continue}const N=T.properties.hasOwnProperty("type")?T.properties.type:void 0;if(N){if(Ot.types[T.type]==="Point"&&N==="curve_point"){const j={};k.parseVertex(g,T,j)&&s.push(j)}else if(Ot.types[T.type]==="Polygon"&&N==="curve_meta"){const j={};k.parseFeature(g,T,j)&&f.push(j)}}}var _;return{vertices:s,features:f}}}class Hn{constructor(i,s){this.pos=i,this.dir=s}intersectsPlane(i,s,f){const A=Nn(s,this.dir);if(Math.abs(A)<1e-6)return!1;const g=((i[0]-this.pos[0])*s[0]+(i[1]-this.pos[1])*s[1])/A;return f[0]=this.pos[0]+this.dir[0]*g,f[1]=this.pos[1]+this.dir[1]*g,!0}}class Wi{constructor(i,s){this.pos=i,this.dir=s}intersectsPlane(i,s,f){const A=xt(s,this.dir);if(Math.abs(A)<1e-6)return!1;const g=((i[0]-this.pos[0])*s[0]+(i[1]-this.pos[1])*s[1]+(i[2]-this.pos[2])*s[2])/A;return f[0]=this.pos[0]+this.dir[0]*g,f[1]=this.pos[1]+this.dir[1]*g,f[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(i,s,f){if(function(X,Y){var ae=X[0],ue=X[1],ge=X[2],Pe=Y[0],Te=Y[1],Ue=Y[2];return Math.abs(ae-Pe)<=v*Math.max(1,Math.abs(ae),Math.abs(Pe))&&Math.abs(ue-Te)<=v*Math.max(1,Math.abs(ue),Math.abs(Te))&&Math.abs(ge-Ue)<=v*Math.max(1,Math.abs(ge),Math.abs(Ue))}(this.pos,i)||s===0)return f[0]=f[1]=f[2]=0,!1;const[A,g,_]=this.dir,C=this.pos[0]-i[0],T=this.pos[1]-i[1],P=this.pos[2]-i[2],k=A*A+g*g+_*_,N=2*(C*A+T*g+P*_),j=N*N-4*k*(C*C+T*T+P*P-s*s);if(j<0){const X=Math.max(-N/2,0),Y=C+A*X,ae=T+g*X,ue=P+_*X,ge=Math.hypot(Y,ae,ue);return f[0]=Y*s/ge,f[1]=ae*s/ge,f[2]=ue*s/ge,!1}{const X=(-N-Math.sqrt(j))/(2*k);if(X<0){const Y=Math.hypot(C,T,P);return f[0]=C*s/Y,f[1]=T*s/Y,f[2]=P*s/Y,!1}return f[0]=C+A*X,f[1]=T+g*X,f[2]=P+_*X,!0}}}class Ji{constructor(i,s,f,A,g){this.TL=i,this.TR=s,this.BR=f,this.BL=A,this.horizon=g}static fromInvProjectionMatrix(i,s,f){const A=[-1,1,1],g=[1,1,1],_=[1,-1,1],C=[-1,-1,1],T=Ct(A,A,i),P=Ct(g,g,i),k=Ct(_,_,i),N=Ct(C,C,i);return new Ji(T,P,k,N,s/f)}}function va(c,i,s){let f=1/0,A=-1/0;const g=[];for(const _ of c){mt(g,_,i);const C=xt(g,s);f=Math.min(f,C),A=Math.max(A,C)}return[f,A]}function ei(c,i){let s=!0;for(let f=0;f<c.planes.length;f++){const A=c.planes[f];let g=0;for(let _=0;_<i.length;_++)g+=xt(A,i[_])+A[3]>=0;if(g===0)return 0;g!==i.length&&(s=!1)}return s?2:1}function qi(c,i){for(const s of c.projections){const f=va(i,c.points[0],s.axis);if(s.projection[1]<f[0]||s.projection[0]>f[1])return 0}return 1}function Ni(c,i){let s=0;const f=[0,0,0,0];for(let _=0;_<c.length;_++)f[0]=c[_][0],f[1]=c[_][1],f[2]=c[_][2],f[3]=1,(A=f)[0]*(g=i)[0]+A[1]*g[1]+A[2]*g[2]+A[3]*g[3]>=0&&s++;var A,g;return s}class na{constructor(i,s){this.points=i||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=In.fromPoints(this.points),this.projections=[],this.frustumEdges=[mt([],this.points[2],this.points[3]),mt([],this.points[0],this.points[3]),mt([],this.points[4],this.points[0]),mt([],this.points[5],this.points[1]),mt([],this.points[6],this.points[2]),mt([],this.points[7],this.points[3])];for(const f of this.frustumEdges){const A=[0,-f[2],f[1]],g=[f[2],0,-f[0]];this.projections.push({axis:A,projection:va(this.points,this.points[0],A)}),this.projections.push({axis:g,projection:va(this.points,this.points[0],g)})}}static fromInvProjectionMatrix(i,s,f,A){const g=Math.pow(2,f),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const k=yn([],P,i),N=1/k[3]/s*g;return(j=k)[0]=(X=k)[0]*(Y=[N,N,A?1/k[3]:N,N])[0],j[1]=X[1]*Y[1],j[2]=X[2]*Y[2],j[3]=X[3]*Y[3],j;var j,X,Y}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const k=et([],Dt([],mt([],_[P[0]],_[P[1]]),mt([],_[P[2]],_[P[1]]))),N=-xt(k,_[P[1]]);return k.concat(N)}),T=[];for(let P=0;P<_.length;P++)T.push([_[P][0],_[P][1],_[P][2]]);return new na(T,C)}intersectsPrecise(i,s,f){for(let A=0;A<s.length;A++)if(!Ni(i,s[A]))return 0;for(let A=0;A<this.planes.length;A++)if(!Ni(i,this.planes[A]))return 0;for(const A of f)for(const g of this.frustumEdges){const _=Dt([],A,g),C=Ze(_);if(C===0)continue;lt(_,_,1/C);const T=va(this.points,this.points[0],_),P=va(i,this.points[0],_);if(T[0]>P[1]||P[0]>T[1])return 0}return 1}containsPoint(i){for(const s of this.planes){const f=s[3];if(xt([s[0],s[1],s[2]],i)+f<0)return!1}return!0}}class In{static fromPoints(i){const s=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const A of i)Nt(s,s,A),ar(f,f,A);return new In(s,f)}static fromTileIdAndHeight(i,s,f){const A=1<<i.canonical.z,g=i.canonical.x,_=i.canonical.y;return new In([g/A,_/A,s],[(g+1)/A,(_+1)/A,f])}static applyTransform(i,s){const f=i.getCorners();for(let A=0;A<f.length;++A)Ct(f[A],f[A],s);return In.fromPoints(f)}static applyTransformFast(i,s){const f=[s[12],s[13],s[14]],A=[...f];for(let g=0;g<3;g++)for(let _=0;_<3;_++){const C=s[4*_+g],T=C*i.min[_],P=C*i.max[_];f[g]+=Math.min(T,P),A[g]+=Math.max(T,P)}return new In(f,A)}static projectAabbCorners(i,s){const f=i.getCorners();for(let A=0;A<f.length;++A)Ct(f[A],f[A],s);return f}constructor(i,s){this.min=i,this.max=s,this.center=lt([],Ut([],this.min,this.max),.5)}quadrant(i){const s=[i%2==0,i<2],f=Ie(this.min),A=Ie(this.max);for(let g=0;g<s.length;g++)f[g]=s[g]?this.min[g]:this.center[g],A[g]=s[g]?this.center[g]:this.max[g];return A[2]=this.max[2],new In(f,A)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,s=this.max;return[[i[0],i[1],i[2]],[s[0],i[1],i[2]],[s[0],s[1],i[2]],[i[0],s[1],i[2]],[i[0],i[1],s[2]],[s[0],i[1],s[2]],[s[0],s[1],s[2]],[i[0],s[1],s[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?ei(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?ei(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,s){return s||this.intersects(i)?qi(i,this.getCorners()):0}intersectsPreciseFlat(i,s){return s||this.intersectsFlat(i)?qi(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let s=0;s<3;++s)if(this.min[s]>i.max[s]||i.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],i.min[s]),this.max[s]=Math.max(this.max[s],i.max[s])}encapsulatePoint(i){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],i[s]),this.max[s]=Math.max(this.max[s],i[s])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}Mr(In,"Aabb");class Aa{constructor(i,s){this.feature=i,this.metersToTile=s,this.index=0}get(){const i=this.feature.vertices[this.index],s=this.feature.vertexProps[this.index].dir,f=s[1],A=-s[0],g=(i.extent+1)*this.metersToTile;return[new hr(Math.trunc(i.position[0]+f*g),Math.trunc(i.position[1]+A*g)),new hr(Math.trunc(i.position[0]-f*g),Math.trunc(i.position[1]-A*g))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class ea{constructor(i,s,f,A,g,_){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=i,this.heightRange={min:f,max:f},this.safeArea=s,this.constantHeight=f,this.constantHeight==null&&(this.constantHeight!=null||A.length!==0)){this.vertices=A,this.edges=g,this.edges=this.edges.filter(C=>{return C.a<this.vertices.length&&C.b<this.vertices.length&&!((T=this.vertices[C.a].position)[0]===(P=this.vertices[C.b].position)[0]&&T[1]===P[1]);var T,P}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const C of this.vertices)this.vertexProps.push({dir:ua(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,C.height),this.heightRange.max=Math.max(this.heightRange.max,C.height);for(const C of this.edges){const T=this.vertices[C.a].position,P=this.vertices[C.b].position,k=Gn(Dn(),P,T),N=xa(k),j=Li(Dn(),k,1/N);this.edgeProps.push({vec:k,dir:j,len:N});const X=this.vertexProps[C.a].dir,Y=this.vertexProps[C.b].dir;ca(X,X,j),ca(Y,Y,j)}for(const C of this.vertexProps)C.dir[0]===0&&C.dir[1]===0||yi(C.dir,C.dir);this.tessellate(_)}}pointElevation(i){if(this.constantHeight!=null)return this.constantHeight;const s=this.getClosestEdge(i);if(s==null)return 0;const[f,A]=s;return tr(this.vertices[this.edges[f].a].height,this.vertices[this.edges[f].b].height,A)}computeSlopeNormal(i,s){const f=this.getClosestEdge(i);if(!f)return st(0,0,1);const A=f[0],g=this.edges[A],_=this.edgeProps[A].vec,C=st(_[0],_[1],(this.vertices[g.b].height-this.vertices[g.a].height)*s),T=st(C[1],-C[0],0);Dt(T,T,C);const P=Ze(T);return P>0?lt(T,T,1/P):st(0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(i){if(this.edges.length===0)return;let s=0,f=Number.POSITIVE_INFINITY,A=0;const g=ua(i.x,i.y);for(let _=0;_<this.edges.length;_++){const C=this.edges[_],T=this.edgeProps[_].dir,P=new Hn(g,this.edgeProps[_].dir),k=this.vertices[C.a].position,N=this.vertices[C.b].position,j=Dn(),X=Dn(),Y=P.intersectsPlane(k,this.vertexProps[C.a].dir,j),ae=P.intersectsPlane(N,this.vertexProps[C.b].dir,X);if(!Y||!ae)continue;const ue=Gn(Dn(),X,j),ge=Gn(Dn(),g,j),Pe=Nn(ue,ue),Te=Pe>0?Nn(ge,ue)/Pe:0,Ue=je(Te,0,1),At=Math.abs((Te-Ue)*this.edgeProps[_].len),at=Gn(Dn(),g,k),ot=At+Math.abs(Nn(at,ua(T[1],-T[0])));ot<f&&(s=_,f=ot,A=Ue)}return[s,A]}tessellate(i){for(let s=this.edges.length-1;s>=0;--s){const f=this.edges[s].a,A=this.edges[s].b,{position:g,height:_,extent:C}=this.vertices[f],{position:T,height:P,extent:k}=this.vertices[A],N=this.vertexProps[f].dir,j=this.vertexProps[A].dir,X=st(g[0]/i,g[1]/i,_),Y=st(T[0]/i,T[1]/i,P),ae=st(N[1],-N[0],0);lt(ae,ae,C);const ue=st(j[1],-j[0],0);if(lt(ue,ue,k),this.distSqLines(st(X[0]+.5*ae[0],X[1]+.5*ae[1],X[2]+.5*ae[2]),st(Y[0]-.5*ue[0],Y[1]-.5*ue[1],Y[2]-.5*ue[2]),st(X[0]-.5*ae[0],X[1]-.5*ae[1],X[2]-.5*ae[2]),st(Y[0]+.5*ue[0],Y[1]+.5*ue[1],Y[2]+.5*ue[2]))<=.0025000000000000005)continue;const ge=this.vertices.length,Pe=ca(Dn(),g,T);this.vertices.push({position:Li(Pe,Pe,.5),height:.5*(_+P),extent:.5*(C+k)});const Te=ca(Dn(),N,j);this.vertexProps.push({dir:yi(Te,Te)}),this.edges.splice(s,1),this.edgeProps.splice(s,1),this.edges.push({a:f,b:ge}),this.edges.push({a:ge,b:A});const Ue=Gn(Dn(),this.vertices[ge].position,g),At=xa(Ue),at={vec:Ue,dir:Li(Dn(),Ue,1/At),len:At};this.edgeProps.push(at),this.edgeProps.push(at)}}distSqLines(i,s,f,A){const g=jt(_e(),s,i),_=jt(_e(),A,f),C=jt(_e(),i,f),T=xt(g,g),P=xt(g,_),k=xt(g,C),N=xt(_,_),j=xt(_,C),X=T*N-P*P;if(X===0){const ue=xt(C,_)/xt(_,_);return Le(pt(_e(),f,A,ue),i)}const Y=(P*j-k*N)/X,ae=(T*j-P*k)/X;return Le(pt(_e(),i,s,Y),pt(_e(),f,A,ae))}}class io{static parseFrom(i,s){const f=ji.parse(i);if(!f)return[];let{vertices:A,features:g}=f;const _=1/Ye(s);g.sort((k,N)=>k.id-N.id),A.sort((k,N)=>k.id-N.id||k.idx-N.idx),A=A.filter((k,N,j)=>N===j.findIndex(X=>X.id===k.id&&X.idx===k.idx));const C=new Array;let T=0;const P=A.length;for(const k of g){if(k.constantHeight){C.push(new ea(k.id,k.bounds,k.constantHeight));continue}for(;T!==P&&A[T].id<k.id;)T++;if(T===P||A[T].id!==k.id)continue;const N=new Array,j=new Array,X=T;for(;T!==P&&A[T].id===k.id;){const Y=A[T];if(N.push({position:Y.position,height:Y.height,extent:Y.extent}),T!==X&&A[T-1].idx===Y.idx-1){const ae=T-X;j.push({a:ae-1,b:ae})}T++}C.push(new ea(k.id,k.bounds,void 0,N,j,_))}return C}static getElevationFeature(i,s){if(!s)return;const f=+i.properties[Wr];return Number.isNaN(f)?void 0:s.find(A=>A.id===f)}}class Ki{constructor(i,s){this.zScale=1,this.xOffset=0,this.yOffset=0,i.equals(s)||(this.zScale=Math.pow(2,s.z-i.z),this.xOffset=(i.x*this.zScale-s.x)*Lr,this.yOffset=(i.y*this.zScale-s.y)*Lr)}constantElevation(i,s){if(i.constantHeight!=null)return this.computeBiasedHeight(i.constantHeight,s)}pointElevation(i,s,f){const A=this.constantElevation(s,f);return A??(i.x=i.x*this.zScale+this.xOffset,i.y=i.y*this.zScale+this.yOffset,this.computeBiasedHeight(s.pointElevation(i),f))}computeBiasedHeight(i,s){return s<=0?i:i+s*oe(0,s,i>=0?i:Math.abs(.5*i))}}Mr(ea,"ElevationFeature");class ia{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new Dc,this.indexArray=new Ua,this.segments=new no,this.programConfigurations=new Pu(i.layers,{zoom:i.zoom,lut:i.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new yd),this.worldview=i.worldview}updateFootprints(i,s){}populate(i,s,f,A){const g=this.layers[0],_=[];let C=null;g.type==="circle"&&(C=g.layout.get("circle-sort-key"));for(const{feature:P,id:k,index:N,sourceLayerIndex:j}of i){const X=this.layers[0]._featureFilter.needGeometry,Y=zt(P,X);if(!this.layers[0]._featureFilter.filter(new oa(this.zoom,{worldview:this.worldview}),Y,f))continue;const ae=C?C.evaluate(Y,{},f):void 0,ue={id:k,properties:P.properties,type:P.type,sourceLayerIndex:j,index:N,geometry:X?Y.geometry:ht(P,f,A),patterns:{},sortKey:ae};_.push(ue)}C&&_.sort((P,k)=>P.sortKey-k.sortKey);let T=null;A.projection.name==="globe"&&(this.globeExtVertexArray=new Mm,T=A.projection);for(const P of _){const{geometry:k,index:N,sourceLayerIndex:j}=P,X=i[N].feature;this.addFeature(P,k,N,s.availableImages,f,T,s.brightness,s.elevationFeatures),s.featureIndex.insert(X,k,N,j,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(i,s,f,A,g,_,C){this.programConfigurations.updatePaintArrays(i,s,g,f,A,_,C,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,jg.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,eA.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,Vm.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(i,s,f,A,g,_,C,T){let P;this.elevationMode!=="none"&&(P=io.getElevationFeature(i,T));for(const k of s)for(const N of k){const j=N.x,X=N.y;if(j<0||j>=Lr||X<0||X>=Lr)continue;if(_){const ue=_.projectTilePoint(j,X,g),ge=_.upVector(g,j,X);this.addGlobeExtVertex(ue,ge),this.addGlobeExtVertex(ue,ge),this.addGlobeExtVertex(ue,ge),this.addGlobeExtVertex(ue,ge)}const Y=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),ae=Y.vertexLength;if(this.addCircleVertex(j,X,-1,-1),this.addCircleVertex(j,X,1,-1),this.addCircleVertex(j,X,1,1),this.addCircleVertex(j,X,-1,1),this.elevationMode!=="none"){const ue=P?P.pointElevation(new hr(j,X)):0;this.hasElevation=this.hasElevation||ue!==0;for(let ge=0;ge<4;ge++)this.elevatedLayoutVertexArray.emplaceBack(ue)}this.indexArray.emplaceBack(ae,ae+1,ae+2),this.indexArray.emplaceBack(ae,ae+2,ae+3),Y.vertexLength+=4,Y.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{},A,g,C,void 0,this.worldview)}addCircleVertex(i,s,f,A){this.layoutVertexArray.emplaceBack(2*i+(f+1)/2,2*s+(A+1)/2)}addGlobeExtVertex(i,s){this.globeExtVertexArray.emplaceBack(i.x,i.y,i.z,s[0]*16384,s[1]*16384,s[2]*16384)}}function ga(c,i){for(let s=0;s<c.length;s++)if(Kl(i,c[s]))return!0;for(let s=0;s<i.length;s++)if(Kl(c,i[s]))return!0;return!!ml(c,i)}function Zo(c,i,s){return!!Kl(c,i)||!!rl(i,c,s)}function Ma(c,i){if(c.length===1)return Lu(i,c[0]);for(let s=0;s<i.length;s++){const f=i[s];for(let A=0;A<f.length;A++)if(Kl(c,f[A]))return!0}for(let s=0;s<c.length;s++)if(Lu(i,c[s]))return!0;for(let s=0;s<i.length;s++)if(ml(c,i[s]))return!0;return!1}function Do(c,i,s){if(c.length>1){if(ml(c,i))return!0;for(let f=0;f<i.length;f++)if(rl(i[f],c,s))return!0}for(let f=0;f<c.length;f++)if(rl(c[f],i,s))return!0;return!1}function ml(c,i){if(c.length===0||i.length===0)return!1;for(let s=0;s<c.length-1;s++){const f=c[s],A=c[s+1];for(let g=0;g<i.length-1;g++)if(Gl(f,A,i[g],i[g+1]))return!0}return!1}function Gl(c,i,s,f){return Jr(c,s,f)!==Jr(i,s,f)&&Jr(c,i,s)!==Jr(c,i,f)}function Rl(c,i,s){return(c.x-s.x)*(i.y-s.y)-(c.y-s.y)*(i.x-s.x)}function gl(c,i,s,f){const A=Rl(c,i,f),g=Rl(c,i,s);if(Math.sign(A)===Math.sign(g))return;const _=Rl(s,f,c),C=_+g-A;return Math.sign(_)!==Math.sign(C)?[_/(_-C),g/(g-A)]:void 0}function rl(c,i,s){const f=s*s;if(i.length===1)return c.distSqr(i[0])<f;for(let A=1;A<i.length;A++)if(lu(c,i[A-1],i[A])<f)return!0;return!1}function lu(c,i,s){const f=i.distSqr(s);if(f===0)return c.distSqr(i);const A=((c.x-i.x)*(s.x-i.x)+(c.y-i.y)*(s.y-i.y))/f;return c.distSqr(A<0?i:A>1?s:s.sub(i)._mult(A)._add(i))}function Lu(c,i){let s,f,A,g=!1;for(let _=0;_<c.length;_++){s=c[_];for(let C=0,T=s.length-1;C<s.length;T=C++)f=s[C],A=s[T],f.y>i.y!=A.y>i.y&&i.x<(A.x-f.x)*(i.y-f.y)/(A.y-f.y)+f.x&&(g=!g)}return g}function Kl(c,i){let s=!1;for(let f=0,A=c.length-1;f<c.length;A=f++){const g=c[f],_=c[A];g.y>i.y!=_.y>i.y&&i.x<(_.x-g.x)*(i.y-g.y)/(_.y-g.y)+g.x&&(s=!s)}return s}function mo(c,i,s,f,A){for(const _ of c)if(i<=_.x&&s<=_.y&&f>=_.x&&A>=_.y)return!0;const g=[new hr(i,s),new hr(i,A),new hr(f,A),new hr(f,s)];if(c.length>2){for(const _ of g)if(Kl(c,_))return!0}for(let _=0;_<c.length-1;_++)if(go(c[_],c[_+1],g))return!0;return!1}function go(c,i,s){const f=s[0],A=s[2];if(c.x<f.x&&i.x<f.x||c.x>A.x&&i.x>A.x||c.y<f.y&&i.y<f.y||c.y>A.y&&i.y>A.y)return!1;const g=Jr(c,i,s[0]);return g!==Jr(c,i,s[1])||g!==Jr(c,i,s[2])||g!==Jr(c,i,s[3])}function Ca(c,i,s,f,A,g){let _=i.y-c.y,C=c.x-i.x;if(g=g||0){const T=_*_+C*C;if(T===0)return!0;const P=Math.sqrt(T);_/=P,C/=P}return!((s.x-c.x)*_+(s.y-c.y)*C-g<0||(f.x-c.x)*_+(f.y-c.y)*C-g<0||(A.x-c.x)*_+(A.y-c.y)*C-g<0)}function hs(c,i,s,f,A,g,_){return!(Ca(c,i,f,A,g,_)||Ca(i,s,f,A,g,_)||Ca(s,c,f,A,g,_)||Ca(f,A,c,i,s,_)||Ca(A,g,c,i,s,_)||Ca(g,f,c,i,s,_))}function Rs(c,i,s){const f=i.paint.get(c).value;return f.kind==="constant"?f.value:s.programConfigurations.get(i.id).getMaxValue(c)}function uo(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Mu(c,i,s,f,A){if(!i[0]&&!i[1])return c;const g=hr.convert(i)._mult(A);s==="viewport"&&g._rotate(-f);const _=[];for(let C=0;C<c.length;C++)_.push(c[C].sub(g));return _}function nA(c,i,s,f){const A=hr.convert(c)._mult(f);return i==="viewport"&&A._rotate(-s),A}let jA,bd;function HA(c,i,s){var f=2*Math.PI*6378137/256/Math.pow(2,s);return[c*f-2*Math.PI*6378137/2,i*f-2*Math.PI*6378137/2]}Mr(ia,"CircleBucket",{omit:["layers"]});class kc{constructor(i,s,f){this.z=i,this.x=s,this.y=f,this.key=Ou(0,i,i,s,f)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}isChildOf(i){const s=this.z-i.z;return i.z===0||i.z<this.z&&i.x===this.x>>s&&i.y===this.y>>s}url(i,s){const f=function(g,_,C){var T=HA(256*g,256*(_=Math.pow(2,C)-_-1),C),P=HA(256*(g+1),256*(_+1),C);return T[0]+","+T[1]+","+P[0]+","+P[1]}(this.x,this.y,this.z),A=function(g,_,C){let T,P="";for(let k=g;k>0;k--)T=1<<k-1,P+=(_&T?1:0)+(C&T?2:0);return P}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",A).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ch{constructor(i,s){this.wrap=i,this.canonical=s,this.key=Ou(i,s.z,s.z,s.x,s.y)}}class Yo{constructor(i,s,f,A,g){this.overscaledZ=i,this.wrap=s,this.canonical=new kc(f,+A,+g),this.key=s===0&&i===f?this.canonical.key:Ou(s,i,f,A,g)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const s=this.canonical.z-i;return i>this.canonical.z?new Yo(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Yo(i,this.wrap,i,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(i,s=!0){if(this.overscaledZ===i&&s)return this.key;if(i>this.canonical.z)return Ou(this.wrap*+s,i,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-i;return Ou(this.wrap*+s,i,i,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const s=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>s&&i.canonical.y===this.canonical.y>>s}children(i){if(this.overscaledZ>=i)return[new Yo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,f=2*this.canonical.x,A=2*this.canonical.y;return[new Yo(s,this.wrap,s,f,A),new Yo(s,this.wrap,s,f+1,A),new Yo(s,this.wrap,s,f,A+1),new Yo(s,this.wrap,s,f+1,A+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Yo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Yo(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ch(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ou(c,i,s,f,A){const g=1<<Math.min(s,22);let _=g*(A%g)+f%g;return c&&s<22&&(_+=g*g*((c<0?-2*c-1:2*c)%(1<<2*(22-s)))),16*(32*_+s)+(i-s)}const Ed=[c=>{let i=c.canonical.x-1,s=c.wrap;return i<0&&(i=(1<<c.canonical.z)-1,s--),new Yo(c.overscaledZ,s,c.canonical.z,i,c.canonical.y)},c=>{let i=c.canonical.x+1,s=c.wrap;return i===1<<c.canonical.z&&(i=0,s++),new Yo(c.overscaledZ,s,c.canonical.z,i,c.canonical.y)},c=>new Yo(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new Yo(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];Mr(kc,"CanonicalTileID"),Mr(Yo,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Z0=Di([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Y0}=Z0,Wg=Di([{name:"a_pos_3",components:3,type:"Int16"}]);var J1=Di([{name:"a_pos",type:"Int16",components:2}]);function Wp(c){return c*Vl/D}const y=[new In([w,w,w],[E,E,E]),new In([w,w,w],[0,0,E]),new In([0,w,w],[E,0,E]),new In([w,0,w],[0,E,E]),new In([0,0,w],[E,E,E])];function B(c,i,s,f=!0){const A=lt([],c._camera.position,c.worldSize),g=[i,s,1,1];yn(g,g,c.pixelMatrixInverse),an(g,g,1/g[3]);const _=et([],mt([],g,A)),C=c.globeMatrix,T=[C[12],C[13],C[14]],P=mt([],T,A),k=Ze(P),N=et([],P),j=c.worldSize/(2*Math.PI),X=xt(N,_),Y=Math.asin(j/k);if(Y<Math.acos(X)){if(!f)return null;const Yt=[],Ft=[];lt(Yt,_,k/X),et(Ft,mt(Ft,Yt,P)),et(_,Ut(_,P,lt(_,Ft,Math.tan(Y)*k)))}const ae=[];new Wi(A,_).closestPointOnSphere(T,j,ae);const ue=et([],ha(C,0)),ge=et([],ha(C,1)),Pe=et([],ha(C,2)),Te=xt(ue,ae),Ue=xt(ge,ae),At=xt(Pe,ae),at=Tt(Math.asin(-Ue/j));let ot=Tt(Math.atan2(Te,At));ot=c.center.lng+function(Yt,Ft){const ir=(Ft-Yt+180)%360-180;return ir<-180?ir+360:ir}(c.center.lng,ot);const _t=le(ot),wt=je(Ae(at),0,1);return new tt(_t,wt)}class O{constructor(i,s,f){this.a=mt([],i,f),this.b=mt([],s,f),this.center=f;const A=et([],this.a),g=et([],this.b);this.angle=Math.acos(xt(A,g))}}function G(c,i){if(c.angle===0)return null;let s;return s=c.a[i]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[i]/c.a[i]/Math.sin(c.angle)-1/Math.tan(c.angle)),s<0||s>1?null:function(f,A,g,_){const C=Math.sin(g);return f*(Math.sin((1-_)*g)/C)+A*(Math.sin(_*g)/C)}(c.a[i],c.b[i],c.angle,je(s,0,1))+c.center[i]}function re(c){if(c.z<=1)return y[c.z+2*c.y+c.x];const i=Or(qt(c));return In.fromPoints(i)}function de(c,i,s){return lt(c,c,1-s),ie(c,c,i,s)}function We(c,i,s){for(const f of c)Ct(f,f,i),lt(f,f,s)}function Lt(c,i,s,f){const A=i/c.worldSize,g=c.globeMatrix;if(s.z<=1){const wt=re(s).getCorners();return We(wt,g,A),In.fromPoints(wt)}const _=qt(s,f),C=Or(_,Vl+Wp(c._tileCoverLift));We(C,g,A);const T=Number.MAX_VALUE,P=[-T,-T,-T],k=[T,T,T];if(_.contains(c.center)){for(const Ft of C)Nt(k,k,Ft),ar(P,P,Ft);P[2]=0;const wt=c.point,Yt=[wt.x*A,wt.y*A,0];return Nt(k,k,Yt),ar(P,P,Yt),new In(k,P)}if(c._tileCoverLift>0){for(const wt of C)Nt(k,k,wt),ar(P,P,wt);return new In(k,P)}const N=[g[12]*A,g[13]*A,g[14]*A],j=_.getCenter(),X=je(c.center.lat,-$e,$e),Y=je(j.lat,-$e,$e),ae=le(c.center.lng),ue=Ae(X);let ge=ae-le(j.lng);const Pe=ue-Ae(Y);ge>.5?ge-=1:ge<-.5&&(ge+=1);let Te=0;Math.abs(ge)>Math.abs(Pe)?Te=ge>=0?1:3:(Te=Pe>=0?0:2,ie(N,N,[g[4]*A,g[5]*A,g[6]*A],-Math.sin(_n(Pe>=0?_.getSouth():_.getNorth()))*Vl));const Ue=C[Te],At=C[(Te+1)%4],at=new O(Ue,At,N),ot=[G(at,0)||Ue[0],G(at,1)||Ue[1],G(at,2)||Ue[2]],_t=nr(c.zoom);if(_t>0){const wt=function({x:Ft,y:ir,z:Ir},cr,xr,Tr,$t){const wr=1/(1<<Ir);let Mt=Ft*wr,Xt=Mt+wr,Fr=ir*wr,Er=Fr+wr,mn=0;const on=(Mt+Xt)/2-Tr;return on>.5?mn=-1:on<-.5&&(mn=1),Mt=((Mt+mn)*cr-(Tr*=cr))*xr+Tr,Xt=((Xt+mn)*cr-Tr)*xr+Tr,Fr=(Fr*cr-($t*=cr))*xr+$t,Er=(Er*cr-$t)*xr+$t,[[Mt,Er,0],[Xt,Er,0],[Xt,Fr,0],[Mt,Fr,0]]}(s,i,c._pixelsPerMercatorPixel,ae,ue);for(let Ft=0;Ft<C.length;Ft++)de(C[Ft],wt[Ft],_t);const Yt=Ut([],wt[Te],wt[(Te+1)%4]);lt(Yt,Yt,.5),de(ot,Yt,_t)}for(const wt of C)Nt(k,k,wt),ar(P,P,wt);return k[2]=Math.min(Ue[2],At[2]),Nt(k,k,ot),ar(P,P,ot),new In(k,P)}function qt({x:c,y:i,z:s},f=!1){const A=1/(1<<s),g=new V(Ce(c*A),i===(1<<s)-1&&f?-90:ke((i+1)*A)),_=new V(Ce((c+1)*A),i===0&&f?90:ke(i*A));return new Z(g,_)}function Or(c,i=Vl){const s=_n(c.getNorth()),f=_n(c.getSouth()),A=Math.cos(s),g=Math.cos(f),_=Math.sin(s),C=Math.sin(f),T=c.getWest(),P=c.getEast();return[S(g,C,T,i),S(g,C,P,i),S(A,_,P,i),S(A,_,T,i)]}function pn(c,i,s,f){const A=1<<s.z,g=(c/Lr+s.x)/A;return F(ke((i/Lr+s.y)/A),Ce(g),f)}function wn({min:c,max:i}){return o/Math.max(i[0]-c[0],i[1]-c[1],i[2]-c[2])}const vn=new Float64Array(16);function qn(c){const i=wn(c),s=Be(vn,[i,i,i]);return te(s,s,Re([],c.min))}function fi(c){const i=(f=c.min,(s=vn)[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=f[0],s[13]=f[1],s[14]=f[2],s[15]=1,s);var s,f;const A=1/wn(c);return J(i,i,[A,A,A])}function pi(c){const i=Lr/(2*Math.PI);return c/(2*Math.PI)/i}function _l(c,i){return Lr/(512*Math.pow(2,c))*wn(re(i))}function _r(c,i,s,f,A){const g=pi(s),_=[c,i,-s/(2*Math.PI)],C=R(new Float64Array(16));return te(C,C,_),J(C,C,[g,g,g]),se(C,C,_n(-A)),ye(C,C,_n(-f)),C}function nr(c){return oe(Kg,p,c)}function Sr(c,i){const s=F(i.lat,i.lng),f=function(Y){const ae=F(Y._center.lat,Y._center.lng);let ue=Dt([],st(0,1,0),ae);const ge=De([],-Y.angle,ae);ue=Ct(ue,ue,ge),De(ge,-Y._pitch,ue);const Pe=et([],ae);return lt(Pe,Pe,Wp(Y.cameraToCenterDistance/Y.pixelsPerMeter)),Ct(Pe,Pe,ge),Ut([],ae,Pe)}(c);return _=(A=jt([],f,s))[0],C=A[1],T=A[2],P=(g=s)[0],k=g[1],N=g[2],X=(j=Math.sqrt(_*_+C*C+T*T)*Math.sqrt(P*P+k*k+N*N))&&xt(A,g)/j,Math.acos(Math.min(Math.max(X,-1),1));var A,g,_,C,T,P,k,N,j,X}function Bn(c,i){return Sr(c,i)>Math.PI/2*1.01}const Ei=_n(85),$i=Math.cos(Ei),Xi=Math.sin(Ei),la=U(),hc=c=>{const i=[];return c.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i};function _o(c,i,s,f,A,g,_,C,T){if(g&&c.queryGeometry.isAboveHorizon)return!1;g&&(T*=c.pixelToTileUnitsFactor);const P=c.tileID.canonical,k=s.projection.upVectorScale(P,s.center.lat,s.worldSize).metersToTile;for(const N of i)for(const j of N){const X=j.add(C),Y=A&&s.elevation?s.elevation.exaggeration()*A.getElevationAt(X.x,X.y,!0):0,ae=s.projection.projectTilePoint(X.x,X.y,P);if(Y>0){const Te=s.projection.upVector(P,X.x,X.y);ae.x+=Te[0]*k*Y,ae.y+=Te[1]*k*Y,ae.z+=Te[2]*k*Y}const ue=g?X:mp(ae.x,ae.y,ae.z,f),ge=g?c.tilespaceRays.map(Te=>Y9(Te,Y)):c.queryGeometry.screenGeometry,Pe=yn([],[ae.x,ae.y,ae.z,1],f);if(!_&&g?T*=Pe[3]/s.cameraToCenterDistance:_&&!g&&(T*=s.cameraToCenterDistance/Pe[3]),g){const Te=ke((j.y/Lr+P.y)/(1<<P.z));T/=s.projection.pixelsPerMeter(Te,1)/fe(1,Te)}if(Zo(ge,ue,T))return!0}return!1}function mp(c,i,s,f){const A=yn([],[c,i,s,1],f);return new hr(A[0]/A[3],A[1]/A[3])}const ex=st(0,0,0),Z9=st(0,0,1);function Y9(c,i){const s=_e();return ex[2]=i,c.intersectsPlane(ex,Z9,s),new hr(s[0],s[1])}class PF extends ia{}let LF,MF,OF,DF;function RF(c,{width:i,height:s},f,A){if(A){if(A instanceof Uint8ClampedArray)A=new Uint8Array(A.buffer);else if(A.length!==i*s*f)throw new RangeError("mismatched image size")}else A=new Uint8Array(i*s*f);return c.width=i,c.height=s,c.data=A,c}function kF(c,i,s){const{width:f,height:A}=i;f===c.width&&A===c.height||(wE(c,i,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,f),height:Math.min(c.height,A)},s,null),c.width=f,c.height=A,c.data=i.data)}function wE(c,i,s,f,A,g,_,C){if(A.width===0||A.height===0)return i;if(A.width>c.width||A.height>c.height||s.x>c.width-A.width||s.y>c.height-A.height)throw new RangeError("out of range source coordinates for image copy");if(A.width>i.width||A.height>i.height||f.x>i.width-A.width||f.y>i.height-A.height)throw new RangeError("out of range destination coordinates for image copy");const T=c.data,P=i.data,k=g===4&&C;for(let N=0;N<A.height;N++){const j=((s.y+N)*c.width+s.x)*g,X=((f.y+N)*i.width+f.x)*g;if(k)for(let Y=0;Y<A.width;Y++){const ae=j+Y*g+3,ue=X+Y*g;P[ue+0]=255,P[ue+1]=255,P[ue+2]=255,P[ue+3]=T[ae]}else if(_)for(let Y=0;Y<A.width;Y++){const ae=j+Y*g,ue=X+Y*g,ge=new ft(T[ae+0]/255,T[ae+1]/255,T[ae+2]/255,T[ae+3]).toNonPremultipliedRenderColor(_).toArray();P[ue+0]=ge[0],P[ue+1]=ge[1],P[ue+2]=ge[2],P[ue+3]=ge[3]}else for(let Y=0;Y<A.width*g;Y++)P[X+Y]=T[j+Y]}return i}Mr(PF,"HeatmapBucket",{omit:["layers"]});class Ym{constructor(i,s){RF(this,i,1,s)}resize(i){kF(this,new Ym(i),1)}clone(){return new Ym({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,s,f,A,g){wE(i,s,f,A,g,1,null)}}class Uc{constructor(i,s){RF(this,i,4,s)}resize(i){kF(this,new Uc(i),4)}replace(i,s){s?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Uc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,s,f,A,g,_,C){wE(i,s,f,A,g,4,_,C)}}class UF{constructor(i,s){this.width=i.width,this.height=i.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function Mv(c){const i={},s=c.resolution||256,f=c.clips?c.clips.length:1,A=c.image||new Uc({width:s,height:f}),g=(_,C,T)=>{i[c.evaluationKey]=T;const P=c.expression.evaluate(i),k=P?P.toNonPremultipliedRenderColor(null):null;k&&(A.data[_+C+0]=Math.floor(255*k.r),A.data[_+C+1]=Math.floor(255*k.g),A.data[_+C+2]=Math.floor(255*k.b),A.data[_+C+3]=Math.floor(255*k.a))};if(c.clips)for(let _=0,C=0;_<f;++_,C+=4*s)for(let T=0,P=0;T<s;T++,P+=4){const k=T/(s-1),{start:N,end:j}=c.clips[_];g(C,P,N*(1-k)+j*k)}else for(let _=0,C=0;_<s;_++,C+=4)g(0,C,_/(s-1));return A}Mr(Ym,"AlphaImage"),Mr(Uc,"RGBAImage");const J9=Di([{name:"a_pos",components:2,type:"Int16"}],4),eG=Di([{name:"a_road_z_offset",components:1,type:"Float32"}],4),tG=Di([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),rG=Di([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function J0(c,i,s=2){const f=i&&i.length,A=f?i[0]*s:c.length;let g=NF(c,0,A,s,!0);const _=[];if(!g||g.next===g.prev)return _;let C,T,P;if(f&&(g=function(k,N,j,X){const Y=[];for(let ae=0,ue=N.length;ae<ue;ae++){const ge=NF(k,N[ae]*X,ae<ue-1?N[ae+1]*X:k.length,X,!1);ge===ge.next&&(ge.steiner=!0),Y.push(uG(ge))}Y.sort(sG);for(let ae=0;ae<Y.length;ae++)j=lG(Y[ae],j);return j}(c,i,g,s)),c.length>80*s){C=c[0],T=c[1];let k=C,N=T;for(let j=s;j<A;j+=s){const X=c[j],Y=c[j+1];X<C&&(C=X),Y<T&&(T=Y),X>k&&(k=X),Y>N&&(N=Y)}P=Math.max(k-C,N-T),P=P!==0?32767/P:0}return Ov(g,_,s,C,T,P,0),_}function NF(c,i,s,f,A){let g;if(A===function(_,C,T,P){let k=0;for(let N=C,j=T-P;N<T;N+=P)k+=(_[j]-_[N])*(_[N+1]+_[j+1]),j=N;return k}(c,i,s,f)>0)for(let _=i;_<s;_+=f)g=HF(_/f|0,c[_],c[_+1],g);else for(let _=s-f;_>=i;_-=f)g=HF(_/f|0,c[_],c[_+1],g);return g&&e_(g,g.next)&&(kv(g),g=g.next),g}function qg(c,i){if(!c)return c;i||(i=c);let s,f=c;do if(s=!1,f.steiner||!e_(f,f.next)&&kl(f.prev,f,f.next)!==0)f=f.next;else{if(kv(f),f=i=f.prev,f===f.next)break;s=!0}while(s||f!==i);return i}function Ov(c,i,s,f,A,g,_){if(!c)return;!_&&g&&function(T,P,k,N){let j=T;do j.z===0&&(j.z=bE(j.x,j.y,P,k,N)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==T);j.prevZ.nextZ=null,j.prevZ=null,function(X){let Y,ae=1;do{let ue,ge=X;X=null;let Pe=null;for(Y=0;ge;){Y++;let Te=ge,Ue=0;for(let at=0;at<ae&&(Ue++,Te=Te.nextZ,Te);at++);let At=ae;for(;Ue>0||At>0&&Te;)Ue!==0&&(At===0||!Te||ge.z<=Te.z)?(ue=ge,ge=ge.nextZ,Ue--):(ue=Te,Te=Te.nextZ,At--),Pe?Pe.nextZ=ue:X=ue,ue.prevZ=Pe,Pe=ue;ge=Te}Pe.nextZ=null,ae*=2}while(Y>1)}(j)}(c,f,A,g);let C=c;for(;c.prev!==c.next;){const T=c.prev,P=c.next;if(g?iG(c,f,A,g):nG(c))i.push(T.i,c.i,P.i),kv(c),c=P.next,C=P.next;else if((c=P)===C){_?_===1?Ov(c=aG(qg(c),i),i,s,f,A,g,2):_===2&&oG(c,i,s,f,A,g):Ov(qg(c),i,s,f,A,g,1);break}}}function nG(c){const i=c.prev,s=c,f=c.next;if(kl(i,s,f)>=0)return!1;const A=i.x,g=s.x,_=f.x,C=i.y,T=s.y,P=f.y,k=Math.min(A,g,_),N=Math.min(C,T,P),j=Math.max(A,g,_),X=Math.max(C,T,P);let Y=f.next;for(;Y!==i;){if(Y.x>=k&&Y.x<=j&&Y.y>=N&&Y.y<=X&&Dv(A,C,g,T,_,P,Y.x,Y.y)&&kl(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function iG(c,i,s,f){const A=c.prev,g=c,_=c.next;if(kl(A,g,_)>=0)return!1;const C=A.x,T=g.x,P=_.x,k=A.y,N=g.y,j=_.y,X=Math.min(C,T,P),Y=Math.min(k,N,j),ae=Math.max(C,T,P),ue=Math.max(k,N,j),ge=bE(X,Y,i,s,f),Pe=bE(ae,ue,i,s,f);let Te=c.prevZ,Ue=c.nextZ;for(;Te&&Te.z>=ge&&Ue&&Ue.z<=Pe;){if(Te.x>=X&&Te.x<=ae&&Te.y>=Y&&Te.y<=ue&&Te!==A&&Te!==_&&Dv(C,k,T,N,P,j,Te.x,Te.y)&&kl(Te.prev,Te,Te.next)>=0||(Te=Te.prevZ,Ue.x>=X&&Ue.x<=ae&&Ue.y>=Y&&Ue.y<=ue&&Ue!==A&&Ue!==_&&Dv(C,k,T,N,P,j,Ue.x,Ue.y)&&kl(Ue.prev,Ue,Ue.next)>=0))return!1;Ue=Ue.nextZ}for(;Te&&Te.z>=ge;){if(Te.x>=X&&Te.x<=ae&&Te.y>=Y&&Te.y<=ue&&Te!==A&&Te!==_&&Dv(C,k,T,N,P,j,Te.x,Te.y)&&kl(Te.prev,Te,Te.next)>=0)return!1;Te=Te.prevZ}for(;Ue&&Ue.z<=Pe;){if(Ue.x>=X&&Ue.x<=ae&&Ue.y>=Y&&Ue.y<=ue&&Ue!==A&&Ue!==_&&Dv(C,k,T,N,P,j,Ue.x,Ue.y)&&kl(Ue.prev,Ue,Ue.next)>=0)return!1;Ue=Ue.nextZ}return!0}function aG(c,i){let s=c;do{const f=s.prev,A=s.next.next;!e_(f,A)&&QF(f,s,s.next,A)&&Rv(f,A)&&Rv(A,f)&&(i.push(f.i,s.i,A.i),kv(s),kv(s.next),s=c=A),s=s.next}while(s!==c);return qg(s)}function oG(c,i,s,f,A,g){let _=c;do{let C=_.next.next;for(;C!==_.prev;){if(_.i!==C.i&&hG(_,C)){let T=jF(_,C);return _=qg(_,_.next),T=qg(T,T.next),Ov(_,i,s,f,A,g,0),void Ov(T,i,s,f,A,g,0)}C=C.next}_=_.next}while(_!==c)}function sG(c,i){let s=c.x-i.x;return s===0&&(s=c.y-i.y,s===0)&&(s=(c.next.y-c.y)/(c.next.x-c.x)-(i.next.y-i.y)/(i.next.x-i.x)),s}function lG(c,i){const s=function(A,g){let _=g;const C=A.x,T=A.y;let P,k=-1/0;if(e_(A,_))return _;do{if(e_(A,_.next))return _.next;if(T<=_.y&&T>=_.next.y&&_.next.y!==_.y){const ae=_.x+(T-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(ae<=C&&ae>k&&(k=ae,P=_.x<_.next.x?_:_.next,ae===C))return P}_=_.next}while(_!==g);if(!P)return null;const N=P,j=P.x,X=P.y;let Y=1/0;_=P;do{if(C>=_.x&&_.x>=j&&C!==_.x&&zF(T<X?C:k,T,j,X,T<X?k:C,T,_.x,_.y)){const ae=Math.abs(T-_.y)/(C-_.x);Rv(_,A)&&(ae<Y||ae===Y&&(_.x>P.x||_.x===P.x&&cG(P,_)))&&(P=_,Y=ae)}_=_.next}while(_!==N);return P}(c,i);if(!s)return i;const f=jF(s,c);return qg(f,f.next),qg(s,s.next)}function cG(c,i){return kl(c.prev,c,i.prev)<0&&kl(i.next,c,c.next)<0}function bE(c,i,s,f,A){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-s)*A|0)|c<<8))|c<<4))|c<<2))|c<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-f)*A|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function uG(c){let i=c,s=c;do(i.x<s.x||i.x===s.x&&i.y<s.y)&&(s=i),i=i.next;while(i!==c);return s}function zF(c,i,s,f,A,g,_,C){return(A-_)*(i-C)>=(c-_)*(g-C)&&(c-_)*(f-C)>=(s-_)*(i-C)&&(s-_)*(g-C)>=(A-_)*(f-C)}function Dv(c,i,s,f,A,g,_,C){return!(c===_&&i===C)&&zF(c,i,s,f,A,g,_,C)}function hG(c,i){return c.next.i!==i.i&&c.prev.i!==i.i&&!function(s,f){let A=s;do{if(A.i!==s.i&&A.next.i!==s.i&&A.i!==f.i&&A.next.i!==f.i&&QF(A,A.next,s,f))return!0;A=A.next}while(A!==s);return!1}(c,i)&&(Rv(c,i)&&Rv(i,c)&&function(s,f){let A=s,g=!1;const _=(s.x+f.x)/2,C=(s.y+f.y)/2;do A.y>C!=A.next.y>C&&A.next.y!==A.y&&_<(A.next.x-A.x)*(C-A.y)/(A.next.y-A.y)+A.x&&(g=!g),A=A.next;while(A!==s);return g}(c,i)&&(kl(c.prev,c,i.prev)||kl(c,i.prev,i))||e_(c,i)&&kl(c.prev,c,c.next)>0&&kl(i.prev,i,i.next)>0)}function kl(c,i,s){return(i.y-c.y)*(s.x-i.x)-(i.x-c.x)*(s.y-i.y)}function e_(c,i){return c.x===i.x&&c.y===i.y}function QF(c,i,s,f){const A=rx(kl(c,i,s)),g=rx(kl(c,i,f)),_=rx(kl(s,f,c)),C=rx(kl(s,f,i));return A!==g&&_!==C||!(A!==0||!tx(c,s,i))||!(g!==0||!tx(c,f,i))||!(_!==0||!tx(s,c,f))||!(C!==0||!tx(s,i,f))}function tx(c,i,s){return i.x<=Math.max(c.x,s.x)&&i.x>=Math.min(c.x,s.x)&&i.y<=Math.max(c.y,s.y)&&i.y>=Math.min(c.y,s.y)}function rx(c){return c>0?1:c<0?-1:0}function Rv(c,i){return kl(c.prev,c,c.next)<0?kl(c,i,c.next)>=0&&kl(c,c.prev,i)>=0:kl(c,i,c.prev)<0||kl(c,c.next,i)<0}function jF(c,i){const s=EE(c.i,c.x,c.y),f=EE(i.i,i.x,i.y),A=c.next,g=i.prev;return c.next=i,i.prev=c,s.next=A,A.prev=s,f.next=s,s.prev=f,g.next=f,f.prev=g,f}function HF(c,i,s,f){const A=EE(c,i,s);return f?(A.next=f.next,A.prev=f,f.next.prev=A,f.next=A):(A.prev=A,A.next=A),A}function kv(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function EE(c,i,s){return{i:c,x:i,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Uv(c,i){const s=c.length;if(s<=1)return[c];const f=[];let A,g;for(let _=0;_<s;_++){const C=en(c[_]);C!==0&&(c[_].area=Math.abs(C),g===void 0&&(g=C<0),g===C<0?(A&&f.push(A),A=[c[_]]):A.push(c[_]))}if(A&&f.push(A),i>1)for(let _=0;_<f.length;_++)f[_].length<=i||(lo(f[_],i,1,f[_].length-1,fG),f[_]=f[_].slice(0,i));return f}function fG(c,i){return i.area-c.area}function VF(c,i,s=1){if(!c)return null;const f=typeof c=="string"?fl.from(c).getPrimary():c.getPrimary(),A=typeof c=="string"?null:c.getSecondary();for(const g of[f,A]){if(!g)continue;const _=g.id.toString();i.has(_)||i.set(_,[]),g.scaleSelf(s),i.get(_).push(g)}return{primary:f.toString(),secondary:A?A.toString():null}}function BE(c,i,s,f){const A=f.patternDependencies;let g=!1;for(const _ of i){const C=_.paint.get(`${c}-pattern`);C.isConstant()||(g=!0),VF(C.constantOr(null),A,s)&&(g=!0)}return g}function CE(c,i,s,f,A,g){const _=g.patternDependencies;for(const C of i){const T=C.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let P=T.evaluate({zoom:f},s,{},g.availableImages);P=P&&P.name?P.name:P;const k=VF(P,_,A);if(!k)continue;const{primary:N,secondary:j}=k;N&&(s.patterns[C.id]=[N,j].filter(Boolean))}}return s}class GF{constructor(){this.polygons=new Map}add(i,...s){this.polygons.has(i)?this.polygons.get(i).push(...s):this.polygons.set(i,s)}merge(i){for(const[s,f]of i.polygons)this.add(s,...f)}}class $g{constructor(){this.portals=[]}static evaluate(i){if(i.length===0)return new $g;let s=[];for(const P of i)s.push(...P.portals);if(s.length===0)return new $g;const f=(P,k)=>P<=0&&k<=0||P>=Lr&&k>=Lr;for(const P of s){const k=P.va,N=P.vb;(f(k.x,N.x)||f(k.y,N.y))&&(P.type="border")}const A=s.filter(P=>P.type!=="unevaluated"),g=s.filter(P=>P.type==="unevaluated");if(g.length===0)return new $g;g.sort((P,k)=>P.hash===k.hash?P.isTunnel===k.isTunnel?0:P.isTunnel?-1:1:P.hash<k.hash?1:-1),s=A.concat(g);let _=A.length,C=_,T=_;do if(C++,C===s.length||s[_].hash!==s[C].hash){if(C-_==2){T<_&&(s[T]=s[_],s[_]=null);const P=s[T],k=s[C-1];P.type=P.isTunnel!==k.isTunnel?"tunnel":"polygon",P.connection={a:P.connection.a,b:k.connection.a},T++}_=C}while(_!==s.length);return s.splice(T),s.sort((P,k)=>P.hash<k.hash?1:-1),{portals:s}}}Mr($g,"ElevationPortalGraph"),Mr(GF,"ElevationPolygons");class AG{constructor(i,s,f){this.outPositions=i,this.outNormals=s,this.outIndices=f,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(i,s,f){let A=i[2];f!=null&&(A*=f);const g=this.getVec3Bits(i)<<96n|this.getVec3Bits(s),_=this.vertexLookup.get(g);if(_!=null)return _;const C=this.outPositions.length;this.vertexLookup.set(g,C);const T=Math.trunc(16384*s[0]),P=Math.trunc(16384*s[1]),k=Math.trunc(16384*s[2]);return this.outPositions.emplaceBack(i[0],i[1],A),this.outNormals.emplaceBack(T,P,k),C}addTriangle(i,s,f){this.outIndices.emplaceBack(i,s,f)}addTriangles(i,s,f){if(i.length===0)return;const A=f.length===1,g=_e(),_=_e();for(let C=0;C<i.length;C+=3){const T=s[i[C+0]],P=s[i[C+1]],k=s[i[C+2]],N=A?f[0]:f[i[C+1]],j=A?f[0]:f[i[C+2]];Et(g,T.x,T.y,A?f[0]:f[i[C+0]]);const X=this.addVertex(g,_);Et(g,P.x,P.y,N);const Y=this.addVertex(g,_);Et(g,k.x,k.y,j);const ae=this.addVertex(g,_);this.outIndices.emplaceBack(X,Y,ae)}}addQuad(i,s,f,A,g,_){const C=this.addVertex(i,g,_),T=this.addVertex(s,g,_),P=this.addVertex(f,g,_),k=this.addVertex(A,g,_);this.addTriangle(C,T,P),this.addTriangle(P,k,C)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}getBits(i){return this.view.setFloat32(0,i),BigInt(this.view.getUint32(0))}getVec3Bits(i){return this.getBits(i[0])<<64n|this.getBits(i[1])<<32n|this.getBits(i[2])}}class rf{constructor(i,s,f,A){this.unevaluatedPortals=new $g,this.portalPolygons=new GF,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new kg,this.vertexNormals=new Lm,this.indexArray=new Ua,this.tileToMeters=Ye(i),this.bridgeProgramConfigurations=new Pu(s,{zoom:f,lut:A},g=>g!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new Pu(s,{zoom:f,lut:A},g=>g!=="fill-bridge-guard-rail-color")}addVertices(i,s){const f=this.unevalVertices.length;for(let A=0;A<i.length;A++)this.unevalVertices.push(i[A]),this.unevalHeights.push(s[A]);return f}addTriangles(i,s,f){const A=f?this.unevalTunnelTriangles:this.unevalTriangles;for(const g of i)A.push(g+s)}addRenderableRing(i,s,f,A,g,_){const C=[new hr(g.min.x,g.min.y),new hr(g.max.x,g.min.y),new hr(g.max.x,g.max.y),new hr(g.min.x,g.max.y)];for(let T=0;T<f-1;T++){const P=s+T,k=P+1,N=this.unevalVertices[P],j=this.unevalVertices[k];if(!(N.x>=g.min.x&&N.x<=g.max.x&&N.y>=g.min.y&&N.y<=g.max.y||j.x>=g.min.x&&j.x<=g.max.x&&j.y>=g.min.y&&j.y<=g.max.y||go(N,j,C))||this.isOnBorder(N.x,j.x)||this.isOnBorder(N.y,j.y))continue;const X=rf.computeEdgeHash(this.unevalVertices[P],this.unevalVertices[k]);let Y,ae=this.vertexHashLookup.get(rf.computePosHash(N));ae!=null?Y=ae.next:(ae=this.vertexHashLookup.get(rf.computePosHash(j)),Y=ae!=null?ae.prev:X),this.unevalEdges.push({polygonIdx:i,a:P,b:k,hash:X,portalHash:Y,isTunnel:A,type:"unevaluated",featureInfo:_})}}addPortalCandidates(i,s,f,A,g){if(s.length===0)return;this.portalPolygons.add(i,{geometry:s,zLevel:g});const _=s[0];this.vertexHashLookup.clear();let C=rf.computeEdgeHash(_[_.length-2],_[_.length-1]);for(let T=0;T<_.length-1;T++){const P=_[T+0],k=_[T+1],N=ua(k.x-P.x,k.y-P.y),j=xa(N);if(j===0)continue;let X="unevaluated";const Y=A.pointElevation(P),ae=A.pointElevation(k);Math.abs(Y)<.01&&Math.abs(ae)<.01?X="entrance":(this.isOnBorder(P.x,k.x)||this.isOnBorder(P.y,k.y))&&(X="border");const ue=rf.computeEdgeHash(P,k);this.unevaluatedPortals.portals.push({connection:{a:i,b:void 0},va:P,vb:k,vab:N,length:j,hash:ue,isTunnel:f,type:X});const ge=rf.computePosHash(P);this.vertexHashLookup.set(ge,{prev:C,next:ue}),C=ue}}construct(i){if(this.unevalVertices.length===0)return;const s=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),f=j=>{j.primitiveLength=this.indexArray.length-j.primitiveOffset},A=new AG(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(i.portals,this.unevalEdges);const g=s(),_=s(),C=s(),T=(j,X)=>{j.sort((ae,ue)=>ae.type===X&&ue.type!==X?-1:ae.type!==X&&ue.type===X?1:0);const Y=j.findIndex(ae=>ae.type!==X);return Y>=0?Y:j.length};let P=0;this.unevalEdges.length>0&&(P=T(this.unevalEdges,"none"),this.constructBridgeStructures(A,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:P},this.tileToMeters)),f(C);const k=s(),N=s();if(this.unevalEdges.length>0){const j=this.unevalEdges.splice(P),X=T(j,"tunnel")+P;this.unevalEdges.push(...j),this.constructTunnelStructures(A,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:P},{min:P,max:X})}f(k),A.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),f(N),A.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),f(_),A.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),f(g),this.maskSegments=no.simpleSegment(0,N.primitiveOffset,0,N.primitiveLength),this.depthSegments=no.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength),this.renderableBridgeSegments=no.simpleSegment(0,C.primitiveOffset,0,C.primitiveLength),this.renderableTunnelSegments=no.simpleSegment(0,k.primitiveOffset,0,k.primitiveLength),this.shadowCasterSegments=no.simpleSegment(0,g.primitiveOffset,0,g.primitiveLength)}update(i,s,f,A,g,_,C,T){this.bridgeProgramConfigurations.updatePaintArrays(i,s,g,f,A,_,C,T),this.tunnelProgramConfigurations.updatePaintArrays(i,s,g,f,A,_,C,T)}upload(i){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=i.createVertexBuffer(this.vertexPositions,tG.members),this.vertexBufferNormal=i.createVertexBuffer(this.vertexNormals,rG.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(i),this.tunnelProgramConfigurations.upload(i))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(i,s,f,A,g){const _=(C,T)=>{for(let P=0;P<T.length-1;P++){const k=T[P].featureIndex,N=T[P+1].vertexStart,j=i.feature(k);C.populatePaintArrays(N,j,k,{},f,s,A,void 0,g)}};_(this.bridgeProgramConfigurations,this.bridgeFeatureSections),_(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(i,s,f,A,g){const _=new Map;for(let C=A;C<g;C++){const T=f[C],P=T.a,k=T.b,N=rf.computePosHash(i[P]),j=rf.computePosHash(i[k]);let X=_.get(N);X||(X={},_.set(N,X));let Y=_.get(j);Y||(Y={},_.set(j,Y)),s[P]<=0&&s[k]<=0||(X.to=k,Y.from=P)}return _}isTerminalVertex(i,s){const f=rf.computePosHash(this.unevalVertices[i]),A=s.get(f);return!A||!A.from||!A.to}constructBridgeStructures(i,s,f,A,g,_){i.clearVertexLookup();const C=this.computeVertexConnections(s,f,A,g.min,g.max),T=1/_,P=.5*T,k=(xr,Tr)=>Et(xr,s[Tr].x,s[Tr].y,f[Tr]*T),N=_e(),j=_e(),X=_e(),Y=_e(),ae=_e(),ue=(xr,Tr)=>{const $t=C.get(rf.computePosHash(s[Tr])),wr=$t.from,Mt=$t.to;if(!wr||!Mt)return;k(N,wr),k(j,Tr),k(X,Mt),sn(Y),er(N,j)||(mt(ae,j,N),et(Y,ae)),er(X,j)||(mt(ae,X,j),Ut(Y,Y,et(ae,ae)));const Xt=$r(Y);return Xt>0?lt(xr,Y,1/Xt):void 0};let ge=Number.POSITIVE_INFINITY;this.sortSubarray(A,g.min,g.max,(xr,Tr)=>xr.featureInfo.featureIndex-Tr.featureInfo.featureIndex);const Pe=_e(),Te=_e(),Ue=_e(),At=_e(),at=_e(),ot=_e(),_t=_e(),wt=_e(),Yt=_e(),Ft=[_e(),_e(),_e(),_e()],ir=[_e(),_e(),_e(),_e()],Ir=[{coord:new hr(0,0),height:0},{coord:new hr(0,0),height:0}],cr=(xr,Tr)=>xr>Tr;for(let xr=g.min;xr<g.max;xr++){const Tr=A[xr];if(!Tr.featureInfo.guardRailEnabled||!this.prepareEdgePoints(Ir,s,f,Tr,cr))continue;const[$t,wr]=Ir;if(Et(Pe,$t.coord.x,$t.coord.y,T*$t.height),Et(Te,wr.coord.x,wr.coord.y,T*wr.height),er(Pe,Te))continue;mt(Ue,Te,Pe),et(Ue,Ue);const Mt=ue(wt,Tr.a)||Ue,Xt=ue(Yt,Tr.b)||Ue;Et(At,Mt[1],-Mt[0],0),et(At,At),Et(at,Xt[1],-Xt[0],0),et(at,at),Dt(wt,At,Mt),et(ot,wt),Dt(wt,at,Xt),et(_t,wt),Ut(Ft[0],Pe,lt(wt,mt(wt,At,ot),P)),Ut(Ft[1],Pe,lt(wt,Ut(wt,At,ot),P)),Ut(Ft[2],Pe,lt(wt,ot,P)),Ft[3]=Pe,Ut(ir[0],Te,lt(wt,mt(wt,at,_t),P)),Ut(ir[1],Te,lt(wt,Ut(wt,at,_t),P)),Ut(ir[2],Te,lt(wt,_t,P)),ir[3]=Te,ge=this.addFeatureSection(Tr.featureInfo.featureIndex,ge,this.bridgeFeatureSections,i);const Fr=i.addVertex(Ft[0],At,_),Er=i.addVertex(Ft[1],At,_),mn=i.addVertex(ir[0],at,_),on=i.addVertex(ir[1],at,_);i.addTriangle(Fr,Er,mn),i.addTriangle(Er,on,mn);const vr=i.addVertex(Ft[1],ot,_),Cr=i.addVertex(Ft[2],ot,_),fn=i.addVertex(ir[1],_t,_),tn=i.addVertex(ir[2],_t,_);i.addTriangle(vr,Cr,fn),i.addTriangle(Cr,tn,fn),Re(At,At),Re(at,at);const Dr=i.addVertex(Ft[2],At,_),nn=i.addVertex(Ft[3],At,_),Cn=i.addVertex(ir[2],at,_),kn=i.addVertex(ir[3],at,_);i.addTriangle(Dr,nn,Cn),i.addTriangle(nn,kn,Cn);const li=this.isTerminalVertex(Tr.a,C),$n=this.isTerminalVertex(Tr.b,C);$t.height<.01&&li&&i.addQuad(Ft[3],Ft[2],Ft[1],Ft[0],Re(Mt,Mt),_),wr.height<.01&&$n&&i.addQuad(ir[0],ir[1],ir[2],ir[3],Xt,_)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}constructTunnelStructures(i,s,f,A,g,_){i.clearVertexLookup();let C=Number.POSITIVE_INFINITY;const T=(ge,Pe)=>ge.featureInfo.featureIndex-Pe.featureInfo.featureIndex;this.sortSubarray(A,g.min,g.max,T),this.sortSubarray(A,_.min,_.max,T);const P=ge=>et(ge,ge),k=[{coord:new hr(0,0),height:0},{coord:new hr(0,0),height:0}],N=(ge,Pe)=>ge<Pe,j=_e(),X=_e(),Y=_e(),ae=_e(),ue=_e();for(let ge=g.min;ge<g.max;ge++){if(!this.prepareEdgePoints(k,s,f,A[ge],N))continue;const[Pe,Te]=k,Ue=P(Et(ue,-(Te.coord.y-Pe.coord.y),Te.coord.x-Pe.coord.x,0));C=this.addFeatureSection(A[ge].featureInfo.featureIndex,C,this.tunnelFeatureSections,i),i.addQuad(Et(j,Pe.coord.x,Pe.coord.y,Pe.height),Et(X,Te.coord.x,Te.coord.y,Te.height),Et(Y,Te.coord.x,Te.coord.y,A[ge].isTunnel?-.1:0),Et(ae,Pe.coord.x,Pe.coord.y,A[ge].isTunnel?-.1:0),Ue)}for(let ge=_.min;ge<_.max;ge++){const Pe=A[ge];Pe.isTunnel&&([Pe.a,Pe.b]=[Pe.b,Pe.a]);const Te=s[Pe.a],Ue=s[Pe.b],At=P(Et(ue,-(Ue.y-Te.y),Ue.x-Te.x,0));C=this.addFeatureSection(Pe.featureInfo.featureIndex,C,this.tunnelFeatureSections,i),i.addQuad(Et(j,Ue.x,Ue.y,0),Et(X,Te.x,Te.y,0),Et(Y,Te.x,Te.y,f[Pe.a]+4),Et(ae,Ue.x,Ue.y,f[Pe.b]+4),At),i.addQuad(Et(j,Te.x,Te.y,0),Et(X,Ue.x,Ue.y,0),Et(Y,Ue.x,Ue.y,f[Pe.b]+4),Et(ae,Te.x,Te.y,f[Pe.a]+4),At)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}setElevatedPoint(i,s,f,A){i.coord.x=s,i.coord.y=f,i.height=A}prepareEdgePoints(i,s,f,A,g){let _=s[A.a].x,C=s[A.a].y,T=s[A.b].x,P=s[A.b].y,k=f[A.a],N=f[A.b];const j=g(k,0),X=g(N,0);if(j&&X)return this.setElevatedPoint(i[0],_,C,k),this.setElevatedPoint(i[1],T,P,N),!0;if(!j&&!X)return!1;if(j){if(!X){const Y=N/(N-k);T=tr(T,_,Y),P=tr(P,C,Y),N=tr(N,k,Y)}}else{const Y=k/(k-N);_=tr(_,T,Y),C=tr(C,P,Y),k=tr(k,N,Y)}return this.setElevatedPoint(i[0],_,C,k),this.setElevatedPoint(i[1],T,P,N),!0}prepareEdges(i,s){if(s.length===0)return;s.sort((C,T)=>C.hash===T.hash?T.polygonIdx-C.polygonIdx:T.hash>C.hash?1:-1);let f=0,A=0,g=0,_=s[f].polygonIdx;do A++,(A===s.length||s[f].hash!==s[A].hash)&&((A-f==1||s[A-1].polygonIdx!==_)&&(g<f&&(s[g]=s[f],s[f]=null),s[g].type="none",g++),f=A,f!==s.length&&(_=s[f].polygonIdx));while(f!==s.length);if(s.splice(g),s.length!==0&&i.length!==0){s.sort((P,k)=>P.portalHash<k.portalHash?1:-1);let C=0,T=0;for(;C!==s.length&&T!==i.length;){const P=s[C],k=i[T];P.portalHash>k.hash?C++:k.hash>P.portalHash?T++:(P.type=k.type,C++)}}}isOnBorder(i,s){return i<=0&&s<=0||i>=Lr&&s>=Lr}addFeatureSection(i,s,f,A){return i!==s&&(s=i,f.push({featureIndex:i,vertexStart:A.getVertexCount()}),A.clearVertexLookup()),s}sortSubarray(i,s,f,A){const g=i.slice(s,f);g.sort(A),i.splice(s,g.length,...g)}static computeEdgeHash(i,s){return(i.y===s.y&&i.x>s.x||i.y>s.y)&&([i,s]=[s,i]),BigInt(rf.computePosHash(i))<<32n|BigInt(rf.computePosHash(s))}static computePosHash(i){return((65535&i.x)<<16|65535&i.y)>>>0}}var KF,WF={exports:{}},qF=(KF||(KF=1,function(c,i){(function(s){function f(Ge,Ke){return Ge>Ke?1:Ge<Ke?-1:0}var A=function(Ge,Ke){Ge===void 0&&(Ge=f),Ke===void 0&&(Ke=!1),this._compare=Ge,this._root=null,this._size=0,this._noDuplicates=!!Ke},g={size:{configurable:!0}};function _(Ge,Ke,Kt,Pr,Vr){var jr=Vr-Pr;if(jr>0){var un=Pr+Math.floor(jr/2),Mn={key:Ke[un],data:Kt[un],parent:Ge};return Mn.left=_(Mn,Ke,Kt,Pr,un),Mn.right=_(Mn,Ke,Kt,un+1,Vr),Mn}return null}function C(Ge,Ke,Kt,Pr,Vr){if(!(Kt>=Pr)){for(var jr=Ge[Kt+Pr>>1],un=Kt-1,Mn=Pr+1;;){do un++;while(Vr(Ge[un],jr)<0);do Mn--;while(Vr(Ge[Mn],jr)>0);if(un>=Mn)break;var Fi=Ge[un];Ge[un]=Ge[Mn],Ge[Mn]=Fi,Fi=Ke[un],Ke[un]=Ke[Mn],Ke[Mn]=Fi}C(Ge,Ke,Kt,Mn,Vr),C(Ge,Ke,Mn+1,Pr,Vr)}}A.prototype.rotateLeft=function(Ge){var Ke=Ge.right;Ke&&(Ge.right=Ke.left,Ke.left&&(Ke.left.parent=Ge),Ke.parent=Ge.parent),Ge.parent?Ge===Ge.parent.left?Ge.parent.left=Ke:Ge.parent.right=Ke:this._root=Ke,Ke&&(Ke.left=Ge),Ge.parent=Ke},A.prototype.rotateRight=function(Ge){var Ke=Ge.left;Ke&&(Ge.left=Ke.right,Ke.right&&(Ke.right.parent=Ge),Ke.parent=Ge.parent),Ge.parent?Ge===Ge.parent.left?Ge.parent.left=Ke:Ge.parent.right=Ke:this._root=Ke,Ke&&(Ke.right=Ge),Ge.parent=Ke},A.prototype._splay=function(Ge){for(;Ge.parent;){var Ke=Ge.parent;Ke.parent?Ke.left===Ge&&Ke.parent.left===Ke?(this.rotateRight(Ke.parent),this.rotateRight(Ke)):Ke.right===Ge&&Ke.parent.right===Ke?(this.rotateLeft(Ke.parent),this.rotateLeft(Ke)):Ke.left===Ge&&Ke.parent.right===Ke?(this.rotateRight(Ke),this.rotateLeft(Ke)):(this.rotateLeft(Ke),this.rotateRight(Ke)):Ke.left===Ge?this.rotateRight(Ke):this.rotateLeft(Ke)}},A.prototype.splay=function(Ge){for(var Ke,Kt,Pr,Vr,jr;Ge.parent;)(Kt=(Ke=Ge.parent).parent)&&Kt.parent?((Pr=Kt.parent).left===Kt?Pr.left=Ge:Pr.right=Ge,Ge.parent=Pr):(Ge.parent=null,this._root=Ge),Vr=Ge.left,jr=Ge.right,Ge===Ke.left?(Kt&&(Kt.left===Ke?(Ke.right?(Kt.left=Ke.right,Kt.left.parent=Kt):Kt.left=null,Ke.right=Kt,Kt.parent=Ke):(Vr?(Kt.right=Vr,Vr.parent=Kt):Kt.right=null,Ge.left=Kt,Kt.parent=Ge)),jr?(Ke.left=jr,jr.parent=Ke):Ke.left=null,Ge.right=Ke,Ke.parent=Ge):(Kt&&(Kt.right===Ke?(Ke.left?(Kt.right=Ke.left,Kt.right.parent=Kt):Kt.right=null,Ke.left=Kt,Kt.parent=Ke):(jr?(Kt.left=jr,jr.parent=Kt):Kt.left=null,Ge.right=Kt,Kt.parent=Ge)),Vr?(Ke.right=Vr,Vr.parent=Ke):Ke.right=null,Ge.left=Ke,Ke.parent=Ge)},A.prototype.replace=function(Ge,Ke){Ge.parent?Ge===Ge.parent.left?Ge.parent.left=Ke:Ge.parent.right=Ke:this._root=Ke,Ke&&(Ke.parent=Ge.parent)},A.prototype.minNode=function(Ge){if(Ge===void 0&&(Ge=this._root),Ge)for(;Ge.left;)Ge=Ge.left;return Ge},A.prototype.maxNode=function(Ge){if(Ge===void 0&&(Ge=this._root),Ge)for(;Ge.right;)Ge=Ge.right;return Ge},A.prototype.insert=function(Ge,Ke){var Kt=this._root,Pr=null,Vr=this._compare;if(this._noDuplicates)for(;Kt;){if(Pr=Kt,Vr(Kt.key,Ge)===0)return;Kt=Vr(Kt.key,Ge)<0?Kt.right:Kt.left}else for(;Kt;)Pr=Kt,Kt=Vr(Kt.key,Ge)<0?Kt.right:Kt.left;return Kt={key:Ge,data:Ke,left:null,right:null,parent:Pr},Pr?Vr(Pr.key,Kt.key)<0?Pr.right=Kt:Pr.left=Kt:this._root=Kt,this.splay(Kt),this._size++,Kt},A.prototype.find=function(Ge){for(var Ke=this._root,Kt=this._compare;Ke;){var Pr=Kt(Ke.key,Ge);if(Pr<0)Ke=Ke.right;else{if(!(Pr>0))return Ke;Ke=Ke.left}}return null},A.prototype.contains=function(Ge){for(var Ke=this._root,Kt=this._compare;Ke;){var Pr=Kt(Ge,Ke.key);if(Pr===0)return!0;Ke=Pr<0?Ke.left:Ke.right}return!1},A.prototype.remove=function(Ge){var Ke=this.find(Ge);if(!Ke)return!1;if(this.splay(Ke),Ke.left)if(Ke.right){var Kt=this.minNode(Ke.right);Kt.parent!==Ke&&(this.replace(Kt,Kt.right),Kt.right=Ke.right,Kt.right.parent=Kt),this.replace(Ke,Kt),Kt.left=Ke.left,Kt.left.parent=Kt}else this.replace(Ke,Ke.left);else this.replace(Ke,Ke.right);return this._size--,!0},A.prototype.removeNode=function(Ge){if(!Ge)return!1;if(this.splay(Ge),Ge.left)if(Ge.right){var Ke=this.minNode(Ge.right);Ke.parent!==Ge&&(this.replace(Ke,Ke.right),Ke.right=Ge.right,Ke.right.parent=Ke),this.replace(Ge,Ke),Ke.left=Ge.left,Ke.left.parent=Ke}else this.replace(Ge,Ge.left);else this.replace(Ge,Ge.right);return this._size--,!0},A.prototype.erase=function(Ge){var Ke=this.find(Ge);if(Ke){this.splay(Ke);var Kt=Ke.left,Pr=Ke.right,Vr=null;Kt&&(Kt.parent=null,Vr=this.maxNode(Kt),this.splay(Vr),this._root=Vr),Pr&&(Kt?Vr.right=Pr:this._root=Pr,Pr.parent=Vr),this._size--}},A.prototype.pop=function(){var Ge=this._root,Ke=null;if(Ge){for(;Ge.left;)Ge=Ge.left;Ke={key:Ge.key,data:Ge.data},this.remove(Ge.key)}return Ke},A.prototype.next=function(Ge){var Ke=Ge;if(Ke)if(Ke.right)for(Ke=Ke.right;Ke&&Ke.left;)Ke=Ke.left;else for(Ke=Ge.parent;Ke&&Ke.right===Ge;)Ge=Ke,Ke=Ke.parent;return Ke},A.prototype.prev=function(Ge){var Ke=Ge;if(Ke)if(Ke.left)for(Ke=Ke.left;Ke&&Ke.right;)Ke=Ke.right;else for(Ke=Ge.parent;Ke&&Ke.left===Ge;)Ge=Ke,Ke=Ke.parent;return Ke},A.prototype.forEach=function(Ge){for(var Ke=this._root,Kt=[],Pr=!1,Vr=0;!Pr;)Ke?(Kt.push(Ke),Ke=Ke.left):Kt.length>0?(Ge(Ke=Kt.pop(),Vr++),Ke=Ke.right):Pr=!0;return this},A.prototype.range=function(Ge,Ke,Kt,Pr){for(var Vr=[],jr=this._compare,un=this._root;Vr.length!==0||un;)if(un)Vr.push(un),un=un.left;else{if(jr((un=Vr.pop()).key,Ke)>0)break;if(jr(un.key,Ge)>=0&&Kt.call(Pr,un))return this;un=un.right}return this},A.prototype.keys=function(){for(var Ge=this._root,Ke=[],Kt=[],Pr=!1;!Pr;)Ge?(Ke.push(Ge),Ge=Ge.left):Ke.length>0?(Ge=Ke.pop(),Kt.push(Ge.key),Ge=Ge.right):Pr=!0;return Kt},A.prototype.values=function(){for(var Ge=this._root,Ke=[],Kt=[],Pr=!1;!Pr;)Ge?(Ke.push(Ge),Ge=Ge.left):Ke.length>0?(Ge=Ke.pop(),Kt.push(Ge.data),Ge=Ge.right):Pr=!0;return Kt},A.prototype.at=function(Ge){for(var Ke=this._root,Kt=[],Pr=!1,Vr=0;!Pr;)if(Ke)Kt.push(Ke),Ke=Ke.left;else if(Kt.length>0){if(Ke=Kt.pop(),Vr===Ge)return Ke;Vr++,Ke=Ke.right}else Pr=!0;return null},A.prototype.load=function(Ge,Ke,Kt){if(Ge===void 0&&(Ge=[]),Ke===void 0&&(Ke=[]),Kt===void 0&&(Kt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var Pr=Ge.length;return Kt&&C(Ge,Ke,0,Pr-1,this._compare),this._root=_(null,Ge,Ke,0,Pr),this._size=Pr,this},A.prototype.min=function(){var Ge=this.minNode(this._root);return Ge?Ge.key:null},A.prototype.max=function(){var Ge=this.maxNode(this._root);return Ge?Ge.key:null},A.prototype.isEmpty=function(){return this._root===null},g.size.get=function(){return this._size},A.createTree=function(Ge,Ke,Kt,Pr,Vr){return new A(Kt,Vr).load(Ge,Ke,Pr)},Object.defineProperties(A.prototype,g);var T=0,P=1,k=2,N=3,j=0,X=1,Y=2,ae=3;function ue(Ge,Ke,Kt){Ke===null?(Ge.inOut=!1,Ge.otherInOut=!0):(Ge.isSubject===Ke.isSubject?(Ge.inOut=!Ke.inOut,Ge.otherInOut=Ke.otherInOut):(Ge.inOut=!Ke.otherInOut,Ge.otherInOut=Ke.isVertical()?!Ke.inOut:Ke.inOut),Ke&&(Ge.prevInResult=!ge(Ke,Kt)||Ke.isVertical()?Ke.prevInResult:Ke));var Pr=ge(Ge,Kt);Ge.resultTransition=Pr?function(Vr,jr){var un,Mn=!Vr.inOut,Fi=!Vr.otherInOut;switch(jr){case j:un=Mn&&Fi;break;case X:un=Mn||Fi;break;case ae:un=Mn^Fi;break;case Y:un=Vr.isSubject?Mn&&!Fi:Fi&&!Mn}return un?1:-1}(Ge,Kt):0}function ge(Ge,Ke){switch(Ge.type){case T:switch(Ke){case j:return!Ge.otherInOut;case X:return Ge.otherInOut;case Y:return Ge.isSubject&&Ge.otherInOut||!Ge.isSubject&&!Ge.otherInOut;case ae:return!0}break;case k:return Ke===j||Ke===X;case N:return Ke===Y;case P:return!1}return!1}var Pe=function(Ge,Ke,Kt,Pr,Vr){this.left=Ke,this.point=Ge,this.otherEvent=Kt,this.isSubject=Pr,this.type=Vr||T,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},Te={inResult:{configurable:!0}};function Ue(Ge,Ke){return Ge[0]===Ke[0]&&Ge[1]===Ke[1]}Pe.prototype.isBelow=function(Ge){var Ke=this.point,Kt=this.otherEvent.point;return this.left?(Ke[0]-Ge[0])*(Kt[1]-Ge[1])-(Kt[0]-Ge[0])*(Ke[1]-Ge[1])>0:(Kt[0]-Ge[0])*(Ke[1]-Ge[1])-(Ke[0]-Ge[0])*(Kt[1]-Ge[1])>0},Pe.prototype.isAbove=function(Ge){return!this.isBelow(Ge)},Pe.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},Te.inResult.get=function(){return this.resultTransition!==0},Pe.prototype.clone=function(){var Ge=new Pe(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ge.contourId=this.contourId,Ge.resultTransition=this.resultTransition,Ge.prevInResult=this.prevInResult,Ge.isExteriorRing=this.isExteriorRing,Ge.inOut=this.inOut,Ge.otherInOut=this.otherInOut,Ge},Object.defineProperties(Pe.prototype,Te);var At=11102230246251565e-32,at=134217729,ot=(3+8*At)*At;function _t(Ge,Ke,Kt,Pr,Vr){var jr,un,Mn,Fi,Pi=Ke[0],mi=Pr[0],Sa=0,Eo=0;mi>Pi==mi>-Pi?(jr=Pi,Pi=Ke[++Sa]):(jr=mi,mi=Pr[++Eo]);var Ai=0;if(Sa<Ge&&Eo<Kt)for(mi>Pi==mi>-Pi?(Mn=jr-((un=Pi+jr)-Pi),Pi=Ke[++Sa]):(Mn=jr-((un=mi+jr)-mi),mi=Pr[++Eo]),jr=un,Mn!==0&&(Vr[Ai++]=Mn);Sa<Ge&&Eo<Kt;)mi>Pi==mi>-Pi?(Mn=jr-((un=jr+Pi)-(Fi=un-jr))+(Pi-Fi),Pi=Ke[++Sa]):(Mn=jr-((un=jr+mi)-(Fi=un-jr))+(mi-Fi),mi=Pr[++Eo]),jr=un,Mn!==0&&(Vr[Ai++]=Mn);for(;Sa<Ge;)Mn=jr-((un=jr+Pi)-(Fi=un-jr))+(Pi-Fi),Pi=Ke[++Sa],jr=un,Mn!==0&&(Vr[Ai++]=Mn);for(;Eo<Kt;)Mn=jr-((un=jr+mi)-(Fi=un-jr))+(mi-Fi),mi=Pr[++Eo],jr=un,Mn!==0&&(Vr[Ai++]=Mn);return jr===0&&Ai!==0||(Vr[Ai++]=jr),Ai}function wt(Ge){return new Float64Array(Ge)}var Yt=33306690738754716e-32,Ft=22204460492503146e-32,ir=11093356479670487e-47,Ir=wt(4),cr=wt(8),xr=wt(12),Tr=wt(16),$t=wt(4);function wr(Ge,Ke,Kt){var Pr=function(Vr,jr,un,Mn,Fi,Pi){var mi=(jr-Pi)*(un-Fi),Sa=(Vr-Fi)*(Mn-Pi),Eo=mi-Sa;if(mi===0||Sa===0||mi>0!=Sa>0)return Eo;var Ai=Math.abs(mi+Sa);return Math.abs(Eo)>=Yt*Ai?Eo:-function(Ja,Na,da,vo,Xa,za,Ha){var ya,gi,Ta,yo,Fn,Zi,Za,Lo,eo,Ws,Oa,ks,Sh,Nc,fc,Th,vp,qs,vl=Ja-Xa,zc=da-Xa,Du=Na-za,cu=vo-za;Ir[0]=(fc=(Lo=vl-(Za=(Zi=at*vl)-(Zi-vl)))*(Ws=cu-(eo=(Zi=at*cu)-(Zi-cu)))-((Nc=vl*cu)-Za*eo-Lo*eo-Za*Ws))-((Oa=fc-(vp=(Lo=Du-(Za=(Zi=at*Du)-(Zi-Du)))*(Ws=zc-(eo=(Zi=at*zc)-(Zi-zc)))-((Th=Du*zc)-Za*eo-Lo*eo-Za*Ws)))+(Fn=fc-Oa))+(Fn-vp),Ir[1]=(Sh=Nc-((ks=Nc+Oa)-(Fn=ks-Nc))+(Oa-Fn))-((Oa=Sh-Th)+(Fn=Sh-Oa))+(Fn-Th),Ir[2]=ks-((qs=ks+Oa)-(Fn=qs-ks))+(Oa-Fn),Ir[3]=qs;var ag=function(EBe,oM){for(var sM=oM[0],PB=1;PB<4;PB++)sM+=oM[PB];return sM}(0,Ir),py=Ft*Ha;if(ag>=py||-ag>=py||(ya=Ja-(vl+(Fn=Ja-vl))+(Fn-Xa),Ta=da-(zc+(Fn=da-zc))+(Fn-Xa),gi=Na-(Du+(Fn=Na-Du))+(Fn-za),yo=vo-(cu+(Fn=vo-cu))+(Fn-za),ya===0&&gi===0&&Ta===0&&yo===0)||(py=ir*Ha+ot*Math.abs(ag),(ag+=vl*yo+cu*ya-(Du*Ta+zc*gi))>=py||-ag>=py))return ag;$t[0]=(fc=(Lo=ya-(Za=(Zi=at*ya)-(Zi-ya)))*(Ws=cu-(eo=(Zi=at*cu)-(Zi-cu)))-((Nc=ya*cu)-Za*eo-Lo*eo-Za*Ws))-((Oa=fc-(vp=(Lo=gi-(Za=(Zi=at*gi)-(Zi-gi)))*(Ws=zc-(eo=(Zi=at*zc)-(Zi-zc)))-((Th=gi*zc)-Za*eo-Lo*eo-Za*Ws)))+(Fn=fc-Oa))+(Fn-vp),$t[1]=(Sh=Nc-((ks=Nc+Oa)-(Fn=ks-Nc))+(Oa-Fn))-((Oa=Sh-Th)+(Fn=Sh-Oa))+(Fn-Th),$t[2]=ks-((qs=ks+Oa)-(Fn=qs-ks))+(Oa-Fn),$t[3]=qs;var Aq=_t(4,Ir,4,$t,cr);$t[0]=(fc=(Lo=vl-(Za=(Zi=at*vl)-(Zi-vl)))*(Ws=yo-(eo=(Zi=at*yo)-(Zi-yo)))-((Nc=vl*yo)-Za*eo-Lo*eo-Za*Ws))-((Oa=fc-(vp=(Lo=Du-(Za=(Zi=at*Du)-(Zi-Du)))*(Ws=Ta-(eo=(Zi=at*Ta)-(Zi-Ta)))-((Th=Du*Ta)-Za*eo-Lo*eo-Za*Ws)))+(Fn=fc-Oa))+(Fn-vp),$t[1]=(Sh=Nc-((ks=Nc+Oa)-(Fn=ks-Nc))+(Oa-Fn))-((Oa=Sh-Th)+(Fn=Sh-Oa))+(Fn-Th),$t[2]=ks-((qs=ks+Oa)-(Fn=qs-ks))+(Oa-Fn),$t[3]=qs;var dq=_t(Aq,cr,4,$t,xr);$t[0]=(fc=(Lo=ya-(Za=(Zi=at*ya)-(Zi-ya)))*(Ws=yo-(eo=(Zi=at*yo)-(Zi-yo)))-((Nc=ya*yo)-Za*eo-Lo*eo-Za*Ws))-((Oa=fc-(vp=(Lo=gi-(Za=(Zi=at*gi)-(Zi-gi)))*(Ws=Ta-(eo=(Zi=at*Ta)-(Zi-Ta)))-((Th=gi*Ta)-Za*eo-Lo*eo-Za*Ws)))+(Fn=fc-Oa))+(Fn-vp),$t[1]=(Sh=Nc-((ks=Nc+Oa)-(Fn=ks-Nc))+(Oa-Fn))-((Oa=Sh-Th)+(Fn=Sh-Oa))+(Fn-Th),$t[2]=ks-((qs=ks+Oa)-(Fn=qs-ks))+(Oa-Fn),$t[3]=qs;var pq=_t(dq,xr,4,$t,Tr);return Tr[pq-1]}(Vr,jr,un,Mn,Fi,Pi,Ai)}(Ge[0],Ge[1],Ke[0],Ke[1],Kt[0],Kt[1]);return Pr>0?-1:Pr<0?1:0}function Mt(Ge,Ke){var Kt=Ge.point,Pr=Ke.point;return Kt[0]>Pr[0]?1:Kt[0]<Pr[0]?-1:Kt[1]!==Pr[1]?Kt[1]>Pr[1]?1:-1:function(Vr,jr,un,Mn){return Vr.left!==jr.left?Vr.left?1:-1:wr(un,Vr.otherEvent.point,jr.otherEvent.point)!==0?Vr.isBelow(jr.otherEvent.point)?-1:1:!Vr.isSubject&&jr.isSubject?1:-1}(Ge,Ke,Kt)}function Xt(Ge,Ke,Kt){var Pr=new Pe(Ke,!1,Ge,Ge.isSubject),Vr=new Pe(Ke,!0,Ge.otherEvent,Ge.isSubject);return Ue(Ge.point,Ge.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ge),Pr.contourId=Vr.contourId=Ge.contourId,Mt(Vr,Ge.otherEvent)>0&&(Ge.otherEvent.left=!0,Vr.left=!1),Ge.otherEvent.otherEvent=Vr,Ge.otherEvent=Pr,Kt.push(Vr),Kt.push(Pr),Kt}function Fr(Ge,Ke){return Ge[0]*Ke[1]-Ge[1]*Ke[0]}function Er(Ge,Ke){return Ge[0]*Ke[0]+Ge[1]*Ke[1]}function mn(Ge,Ke,Kt){var Pr=function(Fi,Pi,mi,Sa,Eo){var Ai=[Pi[0]-Fi[0],Pi[1]-Fi[1]],Ja=[Sa[0]-mi[0],Sa[1]-mi[1]];function Na(Zi,Za,Lo){return[Zi[0]+Za*Lo[0],Zi[1]+Za*Lo[1]]}var da=[mi[0]-Fi[0],mi[1]-Fi[1]],vo=Fr(Ai,Ja),Xa=vo*vo,za=Er(Ai,Ai);if(Xa>0){var Ha=Fr(da,Ja)/vo;if(Ha<0||Ha>1)return null;var ya=Fr(da,Ai)/vo;return ya<0||ya>1?null:Ha===0||Ha===1?[Na(Fi,Ha,Ai)]:ya===0||ya===1?[Na(mi,ya,Ja)]:[Na(Fi,Ha,Ai)]}if((Xa=(vo=Fr(da,Ai))*vo)>0)return null;var gi=Er(Ai,da)/za,Ta=gi+Er(Ai,Ja)/za,yo=Math.min(gi,Ta),Fn=Math.max(gi,Ta);return yo<=1&&Fn>=0?yo===1?[Na(Fi,yo>0?yo:0,Ai)]:Fn===0?[Na(Fi,Fn<1?Fn:1,Ai)]:[Na(Fi,yo>0?yo:0,Ai),Na(Fi,Fn<1?Fn:1,Ai)]:null}(Ge.point,Ge.otherEvent.point,Ke.point,Ke.otherEvent.point),Vr=Pr?Pr.length:0;if(Vr===0||Vr===1&&(Ue(Ge.point,Ke.point)||Ue(Ge.otherEvent.point,Ke.otherEvent.point))||Vr===2&&Ge.isSubject===Ke.isSubject)return 0;if(Vr===1)return Ue(Ge.point,Pr[0])||Ue(Ge.otherEvent.point,Pr[0])||Xt(Ge,Pr[0],Kt),Ue(Ke.point,Pr[0])||Ue(Ke.otherEvent.point,Pr[0])||Xt(Ke,Pr[0],Kt),1;var jr=[],un=!1,Mn=!1;return Ue(Ge.point,Ke.point)?un=!0:Mt(Ge,Ke)===1?jr.push(Ke,Ge):jr.push(Ge,Ke),Ue(Ge.otherEvent.point,Ke.otherEvent.point)?Mn=!0:Mt(Ge.otherEvent,Ke.otherEvent)===1?jr.push(Ke.otherEvent,Ge.otherEvent):jr.push(Ge.otherEvent,Ke.otherEvent),un&&Mn||un?(Ke.type=P,Ge.type=Ke.inOut===Ge.inOut?k:N,un&&!Mn&&Xt(jr[1].otherEvent,jr[0].point,Kt),2):Mn?(Xt(jr[0],jr[1].point,Kt),3):jr[0]!==jr[3].otherEvent?(Xt(jr[0],jr[1].point,Kt),Xt(jr[1],jr[2].point,Kt),3):(Xt(jr[0],jr[1].point,Kt),Xt(jr[3].otherEvent,jr[2].point,Kt),3)}function on(Ge,Ke){if(Ge===Ke)return 0;if(wr(Ge.point,Ge.otherEvent.point,Ke.point)!==0||wr(Ge.point,Ge.otherEvent.point,Ke.otherEvent.point)!==0)return Ue(Ge.point,Ke.point)?Ge.isBelow(Ke.otherEvent.point)?-1:1:Ge.point[0]===Ke.point[0]?Ge.point[1]<Ke.point[1]?-1:1:Mt(Ge,Ke)===1?Ke.isAbove(Ge.point)?-1:1:Ge.isBelow(Ke.point)?-1:1;if(Ge.isSubject!==Ke.isSubject)return Ge.isSubject?-1:1;var Kt=Ge.point,Pr=Ke.point;return Kt[0]===Pr[0]&&Kt[1]===Pr[1]?(Kt=Ge.otherEvent.point)[0]===(Pr=Ke.otherEvent.point)[0]&&Kt[1]===Pr[1]?0:Ge.contourId>Ke.contourId?1:-1:Mt(Ge,Ke)===1?1:-1}var vr=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Cr(Ge,Ke,Kt,Pr){var Vr,jr=Ge+1,un=Ke[Ge].point,Mn=Ke.length;for(jr<Mn&&(Vr=Ke[jr].point);jr<Mn&&Vr[0]===un[0]&&Vr[1]===un[1];){if(!Kt[jr])return jr;++jr<Mn&&(Vr=Ke[jr].point)}for(jr=Ge-1;Kt[jr]&&jr>Pr;)jr--;return jr}vr.prototype.isExterior=function(){return this.holeOf==null};var fn=Dr,tn=Dr;function Dr(Ge,Ke){if(!(this instanceof Dr))return new Dr(Ge,Ke);if(this.data=Ge||[],this.length=this.data.length,this.compare=Ke||nn,this.length>0)for(var Kt=(this.length>>1)-1;Kt>=0;Kt--)this._down(Kt)}function nn(Ge,Ke){return Ge<Ke?-1:Ge>Ke?1:0}Dr.prototype={push:function(Ge){this.data.push(Ge),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ge=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ge}},peek:function(){return this.data[0]},_up:function(Ge){for(var Ke=this.data,Kt=this.compare,Pr=Ke[Ge];Ge>0;){var Vr=Ge-1>>1,jr=Ke[Vr];if(Kt(Pr,jr)>=0)break;Ke[Ge]=jr,Ge=Vr}Ke[Ge]=Pr},_down:function(Ge){for(var Ke=this.data,Kt=this.compare,Pr=this.length>>1,Vr=Ke[Ge];Ge<Pr;){var jr=1+(Ge<<1),un=jr+1,Mn=Ke[jr];if(un<this.length&&Kt(Ke[un],Mn)<0&&(jr=un,Mn=Ke[un]),Kt(Mn,Vr)>=0)break;Ke[Ge]=Mn,Ge=jr}Ke[Ge]=Vr}},fn.default=tn;var Cn=Math.max,kn=Math.min,li=0;function $n(Ge,Ke,Kt,Pr,Vr,jr){var un,Mn,Fi,Pi,mi,Sa;for(un=0,Mn=Ge.length-1;un<Mn;un++)if(Pi=Ge[un+1],mi=new Pe(Fi=Ge[un],!1,void 0,Ke),Sa=new Pe(Pi,!1,mi,Ke),mi.otherEvent=Sa,Fi[0]!==Pi[0]||Fi[1]!==Pi[1]){mi.contourId=Sa.contourId=Kt,jr||(mi.isExteriorRing=!1,Sa.isExteriorRing=!1),Mt(mi,Sa)>0?Sa.left=!0:mi.left=!0;var Eo=Fi[0],Ai=Fi[1];Vr[0]=kn(Vr[0],Eo),Vr[1]=kn(Vr[1],Ai),Vr[2]=Cn(Vr[2],Eo),Vr[3]=Cn(Vr[3],Ai),Pr.push(mi),Pr.push(Sa)}}var zi=[];function xi(Ge,Ke,Kt){typeof Ge[0][0][0]=="number"&&(Ge=[Ge]),typeof Ke[0][0][0]=="number"&&(Ke=[Ke]);var Pr=function(Ai,Ja,Na){var da=null;return Ai.length*Ja.length==0&&(Na===j?da=zi:Na===Y?da=Ai:Na!==X&&Na!==ae||(da=Ai.length===0?Ja:Ai)),da}(Ge,Ke,Kt);if(Pr)return Pr===zi?null:Pr;var Vr=[1/0,1/0,-1/0,-1/0],jr=[1/0,1/0,-1/0,-1/0],un=function(Ai,Ja,Na,da,vo){var Xa,za,Ha,ya,gi,Ta,yo=new fn(null,Mt);for(Ha=0,ya=Ai.length;Ha<ya;Ha++)for(gi=0,Ta=(Xa=Ai[Ha]).length;gi<Ta;gi++)(za=gi===0)&&li++,$n(Xa[gi],!0,li,yo,Na,za);for(Ha=0,ya=Ja.length;Ha<ya;Ha++)for(gi=0,Ta=(Xa=Ja[Ha]).length;gi<Ta;gi++)za=gi===0,vo===Y&&(za=!1),za&&li++,$n(Xa[gi],!1,li,yo,da,za);return yo}(Ge,Ke,Vr,jr,Kt);if(Pr=function(Ai,Ja,Na,da,vo){var Xa=null;return(Na[0]>da[2]||da[0]>Na[2]||Na[1]>da[3]||da[1]>Na[3])&&(vo===j?Xa=zi:vo===Y?Xa=Ai:vo!==X&&vo!==ae||(Xa=Ai.concat(Ja))),Xa}(Ge,Ke,Vr,jr,Kt))return Pr===zi?null:Pr;for(var Mn=function(Ai){var Ja,Na,da=function(Ha){var ya,gi,Ta,yo,Fn=[];for(gi=0,Ta=Ha.length;gi<Ta;gi++)((ya=Ha[gi]).left&&ya.inResult||!ya.left&&ya.otherEvent.inResult)&&Fn.push(ya);for(var Zi=!1;!Zi;)for(Zi=!0,gi=0,Ta=Fn.length;gi<Ta;gi++)gi+1<Ta&&Mt(Fn[gi],Fn[gi+1])===1&&(yo=Fn[gi],Fn[gi]=Fn[gi+1],Fn[gi+1]=yo,Zi=!1);for(gi=0,Ta=Fn.length;gi<Ta;gi++)(ya=Fn[gi]).otherPos=gi;for(gi=0,Ta=Fn.length;gi<Ta;gi++)(ya=Fn[gi]).left||(yo=ya.otherPos,ya.otherPos=ya.otherEvent.otherPos,ya.otherEvent.otherPos=yo);return Fn}(Ai),vo={},Xa=[],za=function(){if(!vo[Ja]){var Ha=Xa.length,ya=function(Fn,Zi,Za){var Lo=new vr;if(Fn.prevInResult!=null){var eo=Fn.prevInResult,Ws=eo.outputContourId;if(eo.resultTransition>0){var Oa=Zi[Ws];if(Oa.holeOf!=null){var ks=Oa.holeOf;Zi[ks].holeIds.push(Za),Lo.holeOf=ks,Lo.depth=Zi[Ws].depth}else Zi[Ws].holeIds.push(Za),Lo.holeOf=Ws,Lo.depth=Zi[Ws].depth+1}else Lo.holeOf=null,Lo.depth=Zi[Ws].depth}else Lo.holeOf=null,Lo.depth=0;return Lo}(da[Ja],Xa,Ha),gi=function(Fn){vo[Fn]=!0,Fn<da.length&&da[Fn]&&(da[Fn].outputContourId=Ha)},Ta=Ja,yo=Ja;for(ya.points.push(da[Ja].point);gi(Ta),gi(Ta=da[Ta].otherPos),ya.points.push(da[Ta].point),!((Ta=Cr(Ta,da,vo,yo))==yo||Ta>=da.length)&&da[Ta];);Xa.push(ya)}};for(Ja=0,Na=da.length;Ja<Na;Ja++)za();return Xa}(function(Ai,Ja,Na,da,vo,Xa){for(var za,Ha,ya,gi=new A(on),Ta=[],yo=Math.min(da[2],vo[2]);Ai.length!==0;){var Fn=Ai.pop();if(Ta.push(Fn),Xa===j&&Fn.point[0]>yo||Xa===Y&&Fn.point[0]>da[2])break;if(Fn.left){Ha=za=gi.insert(Fn),za=za!==(ya=gi.minNode())?gi.prev(za):null,Ha=gi.next(Ha);var Zi=za?za.key:null;if(ue(Fn,Zi,Xa),Ha&&mn(Fn,Ha.key,Ai)===2&&(ue(Fn,Zi,Xa),ue(Ha.key,Fn,Xa)),za&&mn(za.key,Fn,Ai)===2){var Za=za;ue(Zi,(Za=Za!==ya?gi.prev(Za):null)?Za.key:null,Xa),ue(Fn,Zi,Xa)}}else Ha=za=gi.find(Fn=Fn.otherEvent),za&&Ha&&(za=za!==ya?gi.prev(za):null,Ha=gi.next(Ha),gi.remove(Fn),Ha&&za&&mn(za.key,Ha.key,Ai))}return Ta}(un,0,0,Vr,jr,Kt)),Fi=[],Pi=0;Pi<Mn.length;Pi++){var mi=Mn[Pi];if(mi.isExterior()){for(var Sa=[mi.points],Eo=0;Eo<mi.holeIds.length;Eo++)Sa.push(Mn[mi.holeIds[Eo]].points);Fi.push(Sa)}}return Fi}var $a={UNION:X,DIFFERENCE:Y,INTERSECTION:j,XOR:ae};s.diff=function(Ge,Ke){return xi(Ge,Ke,Y)},s.intersection=function(Ge,Ke){return xi(Ge,Ke,j)},s.operations=$a,s.union=function(Ge,Ke){return xi(Ge,Ke,X)},s.xor=function(Ge,Ke){return xi(Ge,Ke,ae)},Object.defineProperty(s,"__esModule",{value:!0})})(i)}(0,WF.exports)),WF.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function nx(c,i,s,f){const A=[],g=f===0?(_,C,T,P,k,N)=>{_.push(new hr(N,T+(N-C)/(P-C)*(k-T)))}:(_,C,T,P,k,N)=>{_.push(new hr(C+(N-T)/(k-T)*(P-C),N))};for(const _ of c){const C=[];for(const T of _){if(T.length<=2)continue;const P=[];for(let j=0;j<T.length-1;j++){const X=T[j].x,Y=T[j].y,ae=T[j+1].x,ue=T[j+1].y,ge=f===0?X:Y,Pe=f===0?ae:ue;ge<i?Pe>i&&g(P,X,Y,ae,ue,i):ge>s?Pe<s&&g(P,X,Y,ae,ue,s):P.push(T[j]),Pe<i&&ge>=i&&g(P,X,Y,ae,ue,i),Pe>s&&ge<=s&&g(P,X,Y,ae,ue,s)}let k=T[T.length-1];const N=f===0?k.x:k.y;N>=i&&N<=s&&P.push(k),P.length&&(k=P[P.length-1],P[0].x===k.x&&P[0].y===k.y||P.push(P[0]),C.push(P))}C.length&&A.push(C)}return A}function dG(c,i){const s=SE(c),f=SE([i]),A=qF.intersection(s,f);return A==null?[]:$F(A)}function pG(c,i){let f=SE(c,65536);for(;i.valid();i.next()){const[A,g]=i.get(),_=A.x*65536,C=A.y*65536,T=g.x*65536,P=g.y*65536,k=T-_,N=P-C,j=Math.hypot(k,N),X=Math.trunc(N/j*3),Y=-Math.trunc(k/j*3);f=qF.diff(f,[[[_,C],[T,P],[T+X,P+Y],[_+X,C+Y],[_,C]]])}return $F(f,1/65536)}function SE(c,i=1){return[c.map(s=>s.map(f=>[f.x*i,f.y*i]))]}function $F(c,i=1){return c.map(s=>s.map((f,A)=>{const g=f.map(_=>new hr(_[0]*i,_[1]*i).round());return A>0&&g.reverse(),g}))}class TE{constructor(i,s){this.layoutVertexArray=new Dc,this.indexArray=new Ua,this.lineIndexArray=new Zh,this.triangleSegments=new no,this.lineSegments=new no,this.programConfigurations=new Pu(i.layers,{zoom:i.zoom,lut:i.lut}),this.uploaded=!1,s&&(this.elevatedLayoutVertexArray=new yd)}update(i,s,f,A,g,_,C,T){this.programConfigurations.updatePaintArrays(i,s,g,f,A,_,C,T)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,J9.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.lineIndexBuffer=i.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,eG.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(i,s,f,A,g,_,C){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,s,f,A,g,_,void 0,C)}}class IE{constructor(i){this.zoom=i.zoom,this.pixelRatio=i.pixelRatio,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=i.lut,this.bufferData=new TE(i,!1),this.elevationBufferData=new TE(i,!0),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=i.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=i.sourceLayerIndex,this.worldview=i.worldview}updateFootprints(i,s){}populate(i,s,f,A){this.hasPattern=BE("fill",this.layers,this.pixelRatio,s);const g=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:C,id:T,index:P,sourceLayerIndex:k}of i){const N=this.layers[0]._featureFilter.needGeometry,j=zt(C,N);if(!this.layers[0]._featureFilter.filter(new oa(this.zoom,{worldview:this.worldview}),j,f))continue;const X=g?g.evaluate(j,{},f,s.availableImages):void 0,Y={id:T,properties:C.properties,type:C.type,sourceLayerIndex:k,index:P,geometry:N?j.geometry:ht(C,f,A),patterns:{},sortKey:X};_.push(Y)}g&&_.sort((C,T)=>C.sortKey-T.sortKey);for(const C of _){const{geometry:T,index:P,sourceLayerIndex:k}=C;if(this.hasPattern){const N=CE("fill",this.layers,C,this.zoom,this.pixelRatio,s);this.patternFeatures.push(N)}else this.addFeature(C,T,P,f,{},s.availableImages,s.brightness,s.elevationFeatures);s.featureIndex.insert(i[P].feature,T,P,k,this.index)}}update(i,s,f,A,g,_,C){this.bufferData.update(i,s,f,A,g,_,C,this.worldview),this.elevationBufferData.update(i,s,f,A,g,_,C,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(i,s,f,A,g,_,C,this.worldview)}addFeatures(i,s,f,A,g,_){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,s,f,A,_,i.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(i){this.bufferData.upload(i),this.elevationBufferData.upload(i),this.elevatedStructures&&this.elevatedStructures.upload(i)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(i,s,f,A,g,_=[],C,T){const P=Uv(s,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(i,P,A,f,T):this.addGeometry(P,this.bufferData),this.bufferData.populatePaintArrays(i,f,g,_,A,C,this.worldview),this.elevationBufferData.populatePaintArrays(i,f,g,_,A,C,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(i,s,f,A,g){this.elevatedStructures&&(this.elevatedStructures.construct(i),this.elevatedStructures.populatePaintArrays(s,f,A,g,this.worldview))}addElevatedRoadFeature(i,s,f,A,g){const _=new Array,C=io.getElevationFeature(i,g);if(!C)return void this.addGeometry(s,this.bufferData);{const P=this.clipPolygonsToTile(s,1);P.length>0&&_.push({polygons:P,elevationFeature:C,elevationTileID:f})}const T={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(i,{},f),featureIndex:A};for(const P of _)if(P.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new rf(P.elevationTileID,this.layers,this.zoom,this.lut));const N=P.elevationFeature.isTunnel();let j=0;i.properties.hasOwnProperty(An)&&(j=+i.properties[An]);for(const X of P.polygons)this.elevatedStructures.addPortalCandidates(P.elevationFeature.id,X,N,P.elevationFeature,j)}P.elevationFeature.constantHeight==null&&(P.polygons=this.prepareElevatedPolygons(P.polygons,P.elevationFeature,P.elevationTileID));const k=new Ki(f,P.elevationTileID);this.addElevatedGeometry(P.polygons,k,P.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,A,T)}}addElevatedGeometry(i,s,f,A,g,_){const C={elevation:f,elevationSampler:s,bias:A,index:g,featureInfo:_},[T,P]=this.addGeometry(i,this.elevationBufferData,C);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:T,max:P}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,T),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,P))}addGeometry(i,s,f){let A=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,_=null;f&&(_=f.elevationSampler.constantElevation(f.elevation,f.bias),_!=null&&(A=_,g=_));const C=(T,P,k)=>{if(f!=null)if(P.push(T),_!=null)s.elevatedLayoutVertexArray.emplaceBack(_),k.push(_);else{const N=f.elevationSampler.pointElevation(T,f.elevation,f.bias);s.elevatedLayoutVertexArray.emplaceBack(N),k.push(N),A=Math.min(A,N),g=Math.max(g,N)}};for(const T of i){let P=0;for(const Te of T)P+=Te.length;const k=s.triangleSegments.prepareSegment(P,s.layoutVertexArray,s.indexArray),N=k.vertexLength,j=[],X=[],Y=[],ae=[],ue=[],ge=s.layoutVertexArray.length;for(const Te of T){if(Te.length===0)continue;Te!==T[0]&&X.push(j.length/2);const Ue=s.lineSegments.prepareSegment(Te.length,s.layoutVertexArray,s.lineIndexArray),At=Ue.vertexLength;f&&ue.push(s.layoutVertexArray.length-ge),C(Te[0],Y,ae),s.layoutVertexArray.emplaceBack(Te[0].x,Te[0].y),s.lineIndexArray.emplaceBack(At+Te.length-1,At),j.push(Te[0].x),j.push(Te[0].y);for(let at=1;at<Te.length;at++)C(Te[at],Y,ae),s.layoutVertexArray.emplaceBack(Te[at].x,Te[at].y),s.lineIndexArray.emplaceBack(At+at-1,At+at),j.push(Te[at].x),j.push(Te[at].y);Ue.vertexLength+=Te.length,Ue.primitiveLength+=Te.length}const Pe=J0(j,X);for(let Te=0;Te<Pe.length;Te+=3)s.indexArray.emplaceBack(N+Pe[Te],N+Pe[Te+1],N+Pe[Te+2]);if(Pe.length>0&&f&&this.elevationMode==="hd-road-base"){const Te=f.elevation.isTunnel(),Ue=f.elevation.safeArea,At=this.elevatedStructures.addVertices(Y,ae);this.elevatedStructures.addTriangles(Pe,At,Te);const at=ue.length;if(at>0){for(let ot=0;ot<at-1;ot++)this.elevatedStructures.addRenderableRing(f.index,ue[ot]+At,ue[ot+1]-ue[ot],Te,Ue,f.featureInfo);this.elevatedStructures.addRenderableRing(f.index,ue[at-1]+At,Y.length-ue[at-1],Te,Ue,f.featureInfo)}}k.vertexLength+=P,k.primitiveLength+=Pe.length/3}return[A,g]}prepareElevatedPolygons(i,s,f){const A=1/Ye(f),g=[];for(const _ of i){const C=pG(_,new Aa(s,A));g.push(...C)}return g}clipPolygonsToTile(i,s){const f=-s,A=-s,g=Lr+s,_=Lr+s;let C=0;const T=[],P=[];for(;C<i.length;C++){const j=i[C],X=Eu(j);(X.min.x>=f&&X.max.x<=g&&X.min.y>=A&&X.max.y<=_?T:P).push(j)}if(T.length===i.length)return i;const k=[new hr(f,A),new hr(g,A),new hr(g,_),new hr(f,_),new hr(f,A)],N=T;for(const j of P)N.push(...dG(j,k));return N}}let XF,ZF,YF,JF;Mr(IE,"FillBucket",{omit:["layers","patternFeatures"]}),Mr(TE,"FillBufferData"),Mr(rf,"ElevatedStructures");class ix{constructor(i,s,f,A){if(this.triangleCount=s.length/3,this.min=new hr(0,0),this.max=new hr(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||i.length===0)return;const[g,_]=[i[0].clone(),i[0].clone()];for(let N=1;N<i.length;++N){const j=i[N];g.x=Math.min(g.x,j.x),g.y=Math.min(g.y,j.y),_.x=Math.max(_.x,j.x),_.y=Math.max(_.y,j.y)}if(A){const N=Math.ceil(Math.max(_.x-g.x,_.y-g.y)/A);f=Math.max(f,N)}if(f===0)return;this.min=g,this.max=_;const C=this.max.sub(this.min);C.x=Math.max(C.x,1),C.y=Math.max(C.y,1);const T=Math.max(C.x,C.y)/f;this.cellsX=Math.max(1,Math.ceil(C.x/T)),this.cellsY=Math.max(1,Math.ceil(C.y/T)),this.xScale=1/T,this.yScale=1/T;const P=[];for(let N=0;N<this.triangleCount;N++){const j=i[s[3*N+0]].sub(this.min),X=i[s[3*N+1]].sub(this.min),Y=i[s[3*N+2]].sub(this.min),ae=gp(Math.floor(Math.min(j.x,X.x,Y.x)),this.xScale,this.cellsX),ue=gp(Math.floor(Math.max(j.x,X.x,Y.x)),this.xScale,this.cellsX),ge=gp(Math.floor(Math.min(j.y,X.y,Y.y)),this.yScale,this.cellsY),Pe=gp(Math.floor(Math.max(j.y,X.y,Y.y)),this.yScale,this.cellsY),Te=new hr(0,0),Ue=new hr(0,0),At=new hr(0,0),at=new hr(0,0);for(let ot=ge;ot<=Pe;++ot){Te.y=Ue.y=ot*T,At.y=at.y=(ot+1)*T;for(let _t=ae;_t<=ue;++_t)Te.x=At.x=_t*T,Ue.x=at.x=(_t+1)*T,(hs(j,X,Y,Te,Ue,at)||hs(j,X,Y,Te,at,At))&&P.push({cellIdx:ot*this.cellsX+_t,triIdx:N})}}if(P.length===0)return;P.sort((N,j)=>N.cellIdx-j.cellIdx||N.triIdx-j.triIdx);let k=0;for(;k<P.length;){const N=P[k].cellIdx,j={start:this.payload.length,len:0};for(;k<P.length&&P[k].cellIdx===N;)++j.len,this.payload.push(P[k++].triIdx);this.cells[N]=j}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(i,s){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>i.x||i.y>this.max.y||this.min.y>i.y)return;const f=gp(i.x-this.min.x,this.xScale,this.cellsX),A=gp(i.y-this.min.y,this.yScale,this.cellsY),g=this.cells[A*this.cellsX+f];if(g){this._lazyInitLookup();for(let _=0;_<g.len;_++){const C=this.payload[g.start+_],T=Math.floor(C/8),P=1<<C%8;if(!(this.lookup[T]&P)&&(this.lookup[T]|=P,s.push(C),s.length===this.triangleCount))return}}}query(i,s,f){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>s.x||i.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const A=gp(i.x-this.min.x,this.xScale,this.cellsX),g=gp(s.x-this.min.x,this.xScale,this.cellsX),_=gp(i.y-this.min.y,this.yScale,this.cellsY),C=gp(s.y-this.min.y,this.yScale,this.cellsY);for(let T=_;T<=C;T++)for(let P=A;P<=g;P++){const k=this.cells[T*this.cellsX+P];if(k)for(let N=0;N<k.len;N++){const j=this.payload[k.start+N],X=Math.floor(j/8),Y=1<<j%8;if(!(this.lookup[X]&Y)&&(this.lookup[X]|=Y,f.push(j),f.length===this.triangleCount))return}}}}function gp(c,i,s){return Math.max(0,Math.min(s-1,Math.floor(c*i)))}Mr(ix,"TriangleGridIndex");class e4{constructor(i){this.zoom=i.zoom,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[],this.worldview=i.worldview}updateFootprints(i,s){for(const f of this.footprints)s.push({footprint:f,id:i})}populate(i,s,f,A){const g=[];for(const{feature:_,id:C,index:T,sourceLayerIndex:P}of i){const k=this.layers[0]._featureFilter.needGeometry,N=zt(_,k);if(!this.layers[0]._featureFilter.filter(new oa(this.zoom,{worldview:this.worldview}),N,f))continue;const j={id:C,properties:_.properties,type:_.type,sourceLayerIndex:P,index:T,geometry:k?N.geometry:ht(_,f,A),patterns:{}};g.push(j)}for(const _ of g){const{geometry:C,index:T,sourceLayerIndex:P}=_;this.addFeature(_,C,T,f,{},s.availableImages,s.brightness),s.featureIndex.insert(i[T].feature,C,T,P,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(i){}update(i,s,f,A,g,_,C){}destroy(){}addFeature(i,s,f,A,g,_=[],C){for(const T of Uv(s,2)){const P=[],k=[],N=[],j=new hr(1/0,1/0),X=new hr(-1/0,-1/0);for(const ue of T)if(ue.length!==0){ue!==T[0]&&N.push(k.length/2);for(let ge=0;ge<ue.length;ge++)k.push(ue[ge].x),k.push(ue[ge].y),P.push(ue[ge]),j.x=Math.min(j.x,ue[ge].x),j.y=Math.min(j.y,ue[ge].y),X.x=Math.max(X.x,ue[ge].x),X.y=Math.max(X.y,ue[ge].y)}const Y=J0(k,N),ae=new ix(P,Y,8,256);this.footprints.push({vertices:P,indices:Y,grid:ae,min:j,max:X})}}}Mr(e4,"ClipBucket",{omit:["layers"]});const mG=Di([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),gG=Di([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),_G=Di([{name:"a_centroid_pos",components:2,type:"Uint16"}]),vG=Di([{name:"a_join_normal_inside",components:3,type:"Int16"}]),yG=Di([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),xG=Di([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:wG}=mG,Nv=Number.MAX_SAFE_INTEGER,t4=Nv-1;function r4(c,i,s,f){return c.order<i||c.order===Nv||!(c.clipMask&s)||function(A,g){return g.length!==0&&g.find(_=>_===A)===void 0}(f,c.clipScope)}function ax(c,i){return c.x-i.x||c.y-i.y}function n4(c,i){return ax(c.min,i.min)===0&&ax(c.max,i.max)===0}function FE(c,i){return!(c.min.x>i.max.x||c.max.x<i.min.x||c.min.y>i.max.y||c.max.y<i.min.y)}function ox(c,i){if(c.length!==i.length)return!1;for(let s=0;s<c.length;s++)if(c[s].sourceId!==i[s].sourceId||!n4(c[s],i[s])||c[s].order!==i[s].order||c[s].clipMask!==i[s].clipMask||!Bo(c[s].clipScope,i[s].clipScope))return!1;return!0}function i4(c,i,s){const f=1/Lr,A=1/(1<<s.canonical.z),g=(i.x*f+s.canonical.x)*A+s.wrap,_=(i.y*f+s.canonical.y)*A;return{min:new hr((c.x*f+s.canonical.x)*A+s.wrap,(c.y*f+s.canonical.y)*A),max:new hr(g,_)}}function bG(c,i,s){const f=1<<s.canonical.z,A=((i.x-s.wrap)*f-s.canonical.x)*Lr,g=(i.y*f-s.canonical.y)*Lr;return{min:new hr(((c.x-s.wrap)*f-s.canonical.x)*Lr,(c.y*f-s.canonical.y)*Lr),max:new hr(A,g)}}function PE(c,i,s,f,A,g,_){const C=c.indices,T=c.vertices,P=[];for(let k=f;k<f+A;k+=3){const N=i[s[k+0]+g],j=i[s[k+1]+g],X=i[s[k+2]+g],Y=Math.min(N.x,j.x,X.x),ae=Math.max(N.x,j.x,X.x),ue=Math.min(N.y,j.y,X.y),ge=Math.max(N.y,j.y,X.y);P.length=0,c.grid.query(new hr(Y,ue),new hr(ae,ge),P);for(let Pe=0;Pe<P.length;Pe++){const Te=P[Pe];if(hs(T[C[3*Te+0]],T[C[3*Te+1]],T[C[3*Te+2]],N,j,X,_))return!0}}return!1}function a4(c,i,s,f){if(!c||!s)return!1;let A=c.vertices;if(!i.canonical.equals(f.canonical)||i.wrap!==f.wrap){if(s.vertices.length<c.vertices.length)return a4(s,f,c,i);const g=i.canonical,_=f.canonical,C=Math.pow(2,_.z-g.z);A=c.vertices.map(T=>new hr((T.x+g.x*Lr)*C-_.x*Lr,(T.y+g.y*Lr)*C-_.y*Lr))}return PE(s,A,c.indices,0,c.indices.length,0,0)}function o4(c,i,s,f){const A=Math.pow(2,f.z-s.z);return new hr((c+s.x*Lr)*A-f.x*Lr,(i+s.y*Lr)*A-f.y*Lr)}function LE(c,i){const s=[];i.grid.queryPoint(c,s);const f=i.indices,A=i.vertices;for(let g=0;g<s.length;g++){const _=s[g];if(Kl([A[f[3*_+0]],A[f[3*_+1]],A[f[3*_+2]]],c))return!0}return!1}const ME=[new hr(0,0),new hr(Lr,0),new hr(Lr,Lr),new hr(0,Lr)];function s4(c,i){const s=[];let f=[];if(!i||c.length<2)return[c];if(c.length===2)return go(c[0],c[1],ME)?[c]:[];for(let A=0;A<c.length+2;A++){const g=c[A%c.length],_=c[(A+1)%c.length],C=go(A===0?c[c.length-1]:c[(A-1)%c.length],g,ME),T=go(g,_,ME),P=C||T;P&&f.push(g),P&&T||f.length>0&&(f.length>1&&s.push(f),f=[])}return f.length>1&&s.push(f),s}const OE=Ot.types,EG=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],BG=["fill-extrusion-flood-light-ground-radius"],CG=Math.pow(2,13),SG=Math.pow(2,15)-1,l4=new hr(0,1),Jm=2147483648;function zv(c,i,s,f,A,g,_,C){c.emplaceBack((i<<1)+_,(s<<1)+g,(Math.floor(f*CG)<<1)+A,Math.round(C))}function Qv(c,i,s){c.emplaceBack(i.x*Lr,i.y*Lr,s?1:0)}function sx(c,i,s,f,A,g){c.emplaceBack(i.x,i.y,(s.x<<1)+f,(s.y<<1)+A,g)}function jv(c,i,s){c.emplaceBack(i.x,i.y,i.z,s[0]*16384,s[1]*16384,s[2]*16384)}class c4{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class u4{constructor(){this.centroidXY=new hr(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new hr(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new hr(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new hr(this.max.x-this.min.x,this.max.y-this.min.y)}}class h4{constructor(){this.acc=new hr(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,s){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=s.x,i.min.y=i.max.y=s.y)}appendEdge(i,s,f){this.accCount++,this.acc._add(s);let A=!!this.borders;s.x<i.min.x?(i.min.x=s.x,A=!0):s.x>i.max.x&&(i.max.x=s.x,A=!0),s.y<i.min.y?(i.min.y=s.y,A=!0):s.y>i.max.y&&(i.max.y=s.y,A=!0),((s.x===0||s.x===Lr)&&s.x===f.x)!=((s.y===0||s.y===Lr)&&s.y===f.y)&&this.processBorderOverlap(s,f),A&&this.checkBorderIntersection(s,f)}checkBorderIntersection(i,s){s.x<0!=i.x<0&&this.addBorderIntersection(0,tr(s.y,i.y,(0-s.x)/(i.x-s.x))),s.x>Lr!=i.x>Lr&&this.addBorderIntersection(1,tr(s.y,i.y,(Lr-s.x)/(i.x-s.x))),s.y<0!=i.y<0&&this.addBorderIntersection(2,tr(s.x,i.x,(0-s.y)/(i.y-s.y))),s.y>Lr!=i.y>Lr&&this.addBorderIntersection(3,tr(s.x,i.x,(Lr-s.y)/(i.y-s.y)))}addBorderIntersection(i,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[i];s<f[0]&&(f[0]=s),s>f[1]&&(f[1]=s)}processBorderOverlap(i,s){if(i.x===s.x){if(i.y===s.y)return;const f=i.x===0?0:1;this.addBorderIntersection(f,s.y),this.addBorderIntersection(f,i.y)}else{const f=i.y===0?2:3;this.addBorderIntersection(f,s.x),this.addBorderIntersection(f,i.x)}}centroid(){return this.accCount===0?new hr(0,0):new hr(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((i,s)=>i+ +(s[0]!==Number.MAX_VALUE),0):0}}function f4(c,i){const s=c.add(i)._unit(),f=je(c.x*s.x+c.y*s.y,-1,1);var A,g,_;return A=Math.acos(f),Math.min(4,Math.max(-4,Math.tan(A)))/4*SG*((g=c).x*(_=i).y-g.y*_.x<0?-1:1)}const TG=[c=>c.x<0,c=>c.x>Lr,c=>c.y<0,c=>c.y>Lr];function IG(c,i,s,f){const A=[4];if(f===0)return A;s._mult(f);const g=c.sub(s),_=i.sub(s),C=[c,i,g,_];for(let T=0;T<4;T++)for(const P of C)if(TG[T](P)){A.push(T);break}return A}class DE{constructor(i){this.vertexArray=new zp,this.indexArray=new Ua,this.programConfigurations=new Pu(i.layers,{zoom:i.zoom,lut:i.lut},s=>BG.includes(s)),this._segments=new no,this.hiddenByLandmarkVertexArray=new Hp,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new no}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(i,s,f,A=!1){const g=i.length;if(g>2){let _=Math.max(0,this._segments.get().length-1);const C=this._segments._prepareSegment(4*g,this.vertexArray.length,2*this._segmentToGroundQuads[_].length);let T;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{const P=i[0],k=i[1];T=f4(P.sub(i[g-1])._perp()._unit(),k.sub(P)._perp()._unit())}for(let P=0;P<g;P++){const k=P===g-1?0:P+1,N=i[P],j=i[k],X=i[k===g-1?0:k+1],Y=j.sub(N)._perp()._unit(),ae=f4(Y,X.sub(j)._perp()._unit()),ue=T,ge=ae;if(RE(N,j,s)||A&&p4(N,s)&&p4(j,s)){T=ae;continue}const Pe=C.vertexLength;sx(this.vertexArray,N,j,1,1,ue),sx(this.vertexArray,N,j,1,0,ue),sx(this.vertexArray,N,j,0,1,ge),sx(this.vertexArray,N,j,0,0,ge),C.vertexLength+=4;const Te=IG(N,j,Y,f);for(const Ue of Te)this._segmentToGroundQuads[_].push({id:Pe,region:Ue}),this._segmentToRegionTriCounts[_][Ue]+=2,C.primitiveLength+=2;T=ae}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),s=i.length;for(let f=0;f<s;f++)this._segmentToGroundQuads[f].sort((A,g)=>A.region-g.region);for(let f=0;f<s;f++){const A=this._segmentToGroundQuads[f],g=i[f],_=this._segmentToRegionTriCounts[f];_.reduce((T,P)=>T+P,0);let C=0;for(let T=0;T<=4;T++){const P=_[T];if(P!==0){let k=this.regionSegments[T];k||(k=this.regionSegments[T]=new no);const N={vertexOffset:g.vertexOffset,primitiveOffset:g.primitiveOffset+C,vertexLength:g.vertexLength,primitiveLength:P};k.get().push(N)}C+=P}for(let T=0;T<A.length;T++){const P=A[T].id;this.indexArray.emplaceBack(P,P+1,P+3),this.indexArray.emplaceBack(P,P+3,P+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,s,f,A,g,_,C){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,s,f,A,g,_,void 0,C)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,gG.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,s,f,A,g,_,C,T){this.hasData()&&this.programConfigurations.updatePaintArrays(i,s,f,A,g,_,C,T)}updateHiddenByLandmark(i){this.updateHiddenByLandmarkRange(i.groundVertexArrayOffset,i.groundVertexCount,!!(i.flags&Jm))}updateHiddenByLandmarkRange(i,s,f){if(!this.hasData())return;const A=s+i;if(s!==0){for(let g=i;g<A;++g)this.hiddenByLandmarkVertexArray.emplace(g,f?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,yG.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const s=this.regionSegments[i];s&&s.destroy()}}}}class lx{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.pixelRatio=i.pixelRatio,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Ua,this.footprintVertices=new Dc,this.footprintSegments=[],this.layoutVertexArray=new vd,this.centroidVertexArray=new G0,this.wallVertexArray=new Hm,this.indexArray=new Ua,this.programConfigurations=new Pu(i.layers,{zoom:i.zoom,lut:i.lut},s=>EG.includes(s)),this.segments=new no,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new DE(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=i.worldview}updateFootprints(i,s){}populate(i,s,f,A){this.features=[],this.hasPattern=BE("fill-extrusion",this.layers,this.pixelRatio,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Ye(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:g,id:_,index:C,sourceLayerIndex:T}of i){const P=this.layers[0]._featureFilter.needGeometry,k=zt(g,P);if(!this.layers[0]._featureFilter.filter(new oa(this.zoom,{worldview:this.worldview}),k,f))continue;const N={id:_,sourceLayerIndex:T,index:C,geometry:P?k.geometry:ht(g,f,A),properties:g.properties,type:g.type,patterns:{}},j=this.layoutVertexArray.length,X=OE[N.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:g.id,feature:CE("fill-extrusion",this.layers,N,this.zoom,this.pixelRatio,s)});else if(this.wallMode)for(const Y of N.geometry)for(const ae of s4(Y,X))this.addFeature(g.id,N,[ae],C,f,{},s.availableImages,A,s.brightness);else this.addFeature(g.id,N,N.geometry,C,f,{},s.availableImages,A,s.brightness);s.featureIndex.insert(g,N.geometry,C,T,this.index,j)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,s,f,A,g,_){for(const{featureId:C,feature:T}of this.features){const P=OE[T.type]==="Polygon",{geometry:k}=T;if(this.wallMode)for(const N of k)for(const j of s4(N,P))this.addFeature(C,T,[j],T.index,s,f,A,g,_);else this.addFeature(C,T,k,T.index,s,f,A,g,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(i,s,f,A,g,_,C){this.programConfigurations.updatePaintArrays(i,s,g,f,A,_,C,this.worldview),this.groundEffect.update(i,s,g,f,A,_,C,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,wG),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.wallVertexBuffer=i.createVertexBuffer(this.wallVertexArray,vG.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,xG.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,_G.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,s,f,A,g,_,C,T,P){const k=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(s,{})/this.tileToMeter,N=[new hr(0,0),new hr(Lr,Lr)],j=T.projection,X=j.name==="globe",Y=this.wallMode||OE[s.type]==="Polygon",ae=new h4;ae.centroidDataIndex=this.centroidData.length;const ue=new u4;ue.buildingId=i,s.properties&&s.properties.hasOwnProperty("building_id")&&(ue.buildingId=s.properties.building_id);const ge=this.layers[0].paint.get("fill-extrusion-base").evaluate(s,{},g)<=0,Pe=this.layers[0].paint.get("fill-extrusion-height").evaluate(s,{},g);let Te;if(ue.height=Pe,ue.vertexArrayOffset=this.layoutVertexArray.length,ue.groundVertexArrayOffset=this.groundEffect.vertexArray.length,X&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Mm),this.wallMode){if(X)return void Hr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(f.length!==1)return;Te=function(Ft){const ir=Ft[0].x===Ft[Ft.length-1].x&&Ft[0].y===Ft[Ft.length-1].y;(function(Cr){let fn=0;const tn=Cr.length;for(let Dr=0;Dr<tn;Dr++)fn+=(Cr[(Dr+1)%tn].x-Cr[Dr].x)*(Cr[(Dr+1)%tn].y+Cr[Dr].y);return fn>=0})(Ft)||(Ft=Ft.reverse());const cr={geometry:[],joinNormals:[],indices:[]},xr=[],Tr=[],$t=[];let wr=Ft.length;for(;wr>=2&&Ft[wr-1].equals(Ft[wr-2]);)wr--;if(wr<(ir?3:2))return cr;let Mt,Xt,Fr,Er,mn,on=0;for(;on<wr-1&&Ft[on].equals(Ft[on+1]);)on++;ir&&(Mt=Ft[wr-2],mn=Ft[on].sub(Mt)._unit()._perp());for(let Cr=on;Cr<wr;Cr++){if(Fr=Cr===wr-1?ir?Ft[on+1]:void 0:Ft[Cr+1],Fr&&Ft[Cr].equals(Fr))continue;mn&&(Er=mn),Mt&&(Xt=Mt),Mt=Ft[Cr],mn=Fr?Fr.sub(Mt)._unit()._perp():Er,Er=Er||mn;let fn=Er.add(mn);fn.x===0&&fn.y===0||fn._unit();const tn=fn.x*mn.x+fn.y*mn.y,Dr=tn!==0?1/tn:1/0,nn=Er.x*mn.y-Er.y*mn.x>0;let Cn="miter";const kn=2;Cn==="miter"&&Dr>kn&&(Cn="bevel"),Cn==="bevel"&&(Dr>100&&(Cn="flipbevel"),Dr<kn&&(Cn="miter"));const li=($n,zi,xi,$a)=>{const Ge=new hr($n.x,$n.y),Ke=new hr($n.x,$n.y);Ge.x+=zi.x*$a,Ge.y+=zi.y*$a,Ke.x-=zi.x*Math.max(xi,1),Ke.y-=zi.y*Math.max(xi,1),$t.push(zi),xr.push(Ge),Tr.push(Ke)};if(Cn==="miter")fn._mult(Dr),li(Mt,fn,0,0);else if(Cn==="flipbevel")fn=mn.mult(-1),li(Mt,fn,0,0),li(Mt,fn.mult(-1),0,0);else{const $n=-Math.sqrt(Dr*Dr-1),zi=nn?$n:0,xi=nn?0:$n;Xt&&li(Mt,Er,zi,xi),Fr&&li(Mt,mn,zi,xi)}}cr.geometry=[...xr,...Tr.reverse(),xr[0]],cr.joinNormals=[...$t,...$t.reverse(),$t[$t.length-1]];const vr=cr.geometry.length-1;for(let Cr=0;Cr<vr/2;Cr++)if(Cr+1<vr/2){let fn=Cr,tn=Cr+1,Dr=vr-1-Cr,nn=vr-2-Cr;fn=fn===0?vr-1:fn-1,tn=tn===0?vr-1:tn-1,Dr=Dr===0?vr-1:Dr-1,nn=nn===0?vr-1:nn-1,cr.indices.push(Dr),cr.indices.push(tn),cr.indices.push(fn),cr.indices.push(Dr),cr.indices.push(nn),cr.indices.push(tn)}return cr}(f[0]),f=[Te.geometry]}const Ue=(Ft,ir)=>Ft<(ir.length-1)/2||Ft===ir.length-1,At=this.wallMode?[f]:Uv(f,500);for(let Ft=At.length-1;Ft>=0;Ft--){const ir=At[Ft];(ir.length===0||(at=ir[0]).every(Ir=>Ir.x<=0)||at.every(Ir=>Ir.x>=Lr)||at.every(Ir=>Ir.y<=0)||at.every(Ir=>Ir.y>=Lr))&&At.splice(Ft,1)}var at;let ot;if(X)ot=v4(At,N,g);else{ot=[];for(const Ft of At)ot.push({polygon:Ft,bounds:N})}const _t=Y?this.edgeRadius:0,wt=_t>0&&this.zoom<17,Yt=(Ft,ir)=>{if(Ft.length===0)return!1;const Ir=Ft[Ft.length-1];return ir.x===Ir.x&&ir.y===Ir.y};for(const{polygon:Ft,bounds:ir}of ot){let Ir=0,cr=0;for(const wr of Ft)Y&&!wr[0].equals(wr[wr.length-1])&&wr.push(wr[0]),cr+=Y?wr.length-1:wr.length;const xr=this.segments.prepareSegment((Y?5:4)*cr,this.layoutVertexArray,this.indexArray);ue.footprintSegIdx<0&&(ue.footprintSegIdx=this.footprintSegments.length),ue.polygonSegIdx<0&&(ue.polygonSegIdx=this.polygonSegments.length);const Tr={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},$t=new c4;if($t.vertexOffset=this.footprintVertices.length,$t.indexOffset=3*this.footprintIndices.length,$t.ringIndices=[],Y){const wr=[],Mt=[];Ir=xr.vertexLength;for(let Fr=0;Fr<Ft.length;Fr++){const Er=Ft[Fr];Er.length&&Fr!==0&&Mt.push(wr.length/2);const mn=[];let on,vr;on=Er[1].sub(Er[0])._perp()._unit(),$t.ringIndices.push(Er.length-1);for(let Cr=1;Cr<Er.length;Cr++){const fn=Er[Cr],tn=Er[Cr===Er.length-1?1:Cr+1],Dr=fn.clone();if(_t){vr=tn.sub(fn)._perp()._unit();const nn=on.add(vr)._unit(),Cn=_t*Math.min(4,1/(on.x*nn.x+on.y*nn.y));Dr.x+=Cn*nn.x,Dr.y+=Cn*nn.y,Dr.x=Math.round(Dr.x),Dr.y=Math.round(Dr.y),on=vr}if(!ge||_t!==0&&!wt||Yt(mn,Dr)||mn.push(Dr),zv(this.layoutVertexArray,Dr.x,Dr.y,0,0,1,1,0),this.wallMode){const nn=Ue(Cr,Er);Qv(this.wallVertexArray,Te.joinNormals[Cr],!nn)}xr.vertexLength++,this.footprintVertices.emplaceBack(fn.x,fn.y),wr.push(fn.x,fn.y),X&&jv(this.layoutVertexExtArray,j.projectTilePoint(Dr.x,Dr.y,g),j.upVector(g,Dr.x,Dr.y))}ge&&(_t===0||wt)&&(mn.length!==0&&Yt(mn,mn[0])&&mn.pop(),this.groundEffect.addData(mn,ir,k))}const Xt=this.wallMode?Te.indices:J0(wr,Mt);for(let Fr=0;Fr<Xt.length;Fr+=3)this.footprintIndices.emplaceBack($t.vertexOffset+Xt[Fr+0],$t.vertexOffset+Xt[Fr+1],$t.vertexOffset+Xt[Fr+2]),this.indexArray.emplaceBack(Ir+Xt[Fr],Ir+Xt[Fr+2],Ir+Xt[Fr+1]),xr.primitiveLength++;$t.indexCount+=Xt.length,$t.vertexCount+=this.footprintVertices.length-$t.vertexOffset}for(let wr=0;wr<Ft.length;wr++){const Mt=Ft[wr];ae.startRing(ue,Mt[0]);let Xt=Mt.length>4&&m4(Mt[Mt.length-2],Mt[0],Mt[1]),Fr=_t?FG(Mt[Mt.length-2],Mt[0],Mt[1],_t):0;const Er=[];let mn,on,vr;on=Mt[1].sub(Mt[0])._perp()._unit();let Cr=!0;for(let fn=1,tn=0;fn<Mt.length;fn++){let Dr=Mt[fn-1],nn=Mt[fn];const Cn=Mt[fn===Mt.length-1?1:fn+1];if(ae.appendEdge(ue,nn,Dr),RE(nn,Dr,ir)){_t&&(on=Cn.sub(nn)._perp()._unit(),Cr=!Cr);continue}const kn=nn.sub(Dr)._perp(),li=kn.x/(Math.abs(kn.x)+Math.abs(kn.y)),$n=kn.y>0?1:0,zi=Dr.dist(nn);if(tn+zi>32768&&(tn=0),_t){vr=Cn.sub(nn)._perp()._unit();let Ke=d4(Dr,nn,Cn,A4(on,vr),_t);isNaN(Ke)&&(Ke=0);const Kt=nn.sub(Dr)._unit();Dr=Dr.add(Kt.mult(Fr))._round(),nn=nn.add(Kt.mult(-Ke))._round(),Fr=Ke,on=vr,ge&&this.zoom>=17&&(Yt(Er,Dr)||Er.push(Dr),Yt(Er,nn)||Er.push(nn))}const xi=xr.vertexLength,$a=Mt.length>4&&m4(Dr,nn,Cn);let Ge=g4(tn,Xt,Cr);if(zv(this.layoutVertexArray,Dr.x,Dr.y,li,$n,0,0,Ge),zv(this.layoutVertexArray,Dr.x,Dr.y,li,$n,0,1,Ge),this.wallMode){const Ke=Ue(fn-1,Mt),Kt=Te.joinNormals[fn-1];Qv(this.wallVertexArray,Kt,Ke),Qv(this.wallVertexArray,Kt,Ke)}if(tn+=zi,Ge=g4(tn,$a,!Cr),Xt=$a,zv(this.layoutVertexArray,nn.x,nn.y,li,$n,0,0,Ge),zv(this.layoutVertexArray,nn.x,nn.y,li,$n,0,1,Ge),this.wallMode){const Ke=Ue(fn,Mt),Kt=Te.joinNormals[fn];Qv(this.wallVertexArray,Kt,Ke),Qv(this.wallVertexArray,Kt,Ke)}if(xr.vertexLength+=4,this.indexArray.emplaceBack(xi+0,xi+1,xi+2),this.indexArray.emplaceBack(xi+1,xi+3,xi+2),xr.primitiveLength+=2,_t){const Ke=Ir+(fn===1?Mt.length-2:fn-2),Kt=fn===1?Ir:Ke+1;if(this.indexArray.emplaceBack(xi+1,Ke,xi+3),this.indexArray.emplaceBack(Ke,Kt,xi+3),xr.primitiveLength+=2,mn===void 0&&(mn=xi),!RE(Cn,Mt[fn],ir)){const Pr=fn===Mt.length-1?mn:xr.vertexLength;this.indexArray.emplaceBack(xi+2,xi+3,Pr),this.indexArray.emplaceBack(xi+3,Pr+1,Pr),this.indexArray.emplaceBack(xi+3,Kt,Pr+1),xr.primitiveLength+=3}Cr=!Cr}if(X){const Ke=this.layoutVertexExtArray,Kt=j.projectTilePoint(Dr.x,Dr.y,g),Pr=j.projectTilePoint(nn.x,nn.y,g),Vr=j.upVector(g,Dr.x,Dr.y),jr=j.upVector(g,nn.x,nn.y);jv(Ke,Kt,Vr),jv(Ke,Kt,Vr),jv(Ke,Pr,jr),jv(Ke,Pr,jr)}}Y&&(Ir+=Mt.length-1),ge&&_t&&this.zoom>=17&&(Er.length!==0&&Yt(Er,Er[0])&&Er.pop(),this.groundEffect.addData(Er,ir,k,_t>0))}this.footprintSegments.push($t),Tr.triangleCount=this.indexArray.length-Tr.triangleArrayOffset,this.polygonSegments.push(Tr),++ue.footprintSegLen,++ue.polygonSegLen}if(ue.vertexCount=this.layoutVertexArray.length-ue.vertexArrayOffset,ue.groundVertexCount=this.groundEffect.vertexArray.length-ue.groundVertexArrayOffset,ue.vertexCount!==0){if(ue.centroidXY=ae.borders?l4:this.encodeCentroid(ae,ue),this.centroidData.push(ue),ae.borders){this.featuresOnBorder.push(ae);const Ft=this.featuresOnBorder.length-1;for(let ir=0;ir<ae.borders.length;ir++)ae.borders[ir][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ir].push(Ft)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,A,_,C,g,P,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(s,A,_,C,g,P,this.worldview),this.maxHeight=Math.max(this.maxHeight,Pe)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort((s,f)=>this.featuresOnBorder[s].borders[i][0]-this.featuresOnBorder[f].borders[i][0])}splitToSubtiles(){const i=[];for(let C=0;C<this.centroidData.length;C++){const T=this.centroidData[C],P=+(T.min.y+T.max.y>Lr),k=2*P+(+(T.min.x+T.max.x>Lr)^P);for(let N=0;N<T.polygonSegLen;N++){const j=T.polygonSegIdx+N;i.push({centroidIdx:C,subtile:k,polygonSegmentIdx:j,triangleSegmentIdx:this.polygonSegments[j].triangleSegIdx})}}const s=new Ua;i.sort((C,T)=>C.triangleSegmentIdx===T.triangleSegmentIdx?C.subtile-T.subtile:C.triangleSegmentIdx-T.triangleSegmentIdx);let f=0,A=0,g=0;for(const C of i){if(C.triangleSegmentIdx!==f)break;g++}const _=i.length;for(;A!==i.length;){f=i[A].triangleSegmentIdx;let C=0,T=A,P=A;for(let k=T;k<g&&i[k].subtile===C;k++)P++;for(;T!==g;){const k=i[T];C=k.subtile;const N=this.centroidData[k.centroidIdx].min.clone(),j=this.centroidData[k.centroidIdx].max.clone(),X={vertexOffset:this.segments.segments[f].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[f].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let Y=T;Y<P;Y++){const ae=i[Y],ue=this.polygonSegments[ae.polygonSegmentIdx],ge=this.centroidData[ae.centroidIdx].min,Pe=this.centroidData[ae.centroidIdx].max,Te=this.indexArray.uint16;for(let Ue=ue.triangleArrayOffset;Ue<ue.triangleArrayOffset+ue.triangleCount;Ue++)s.emplaceBack(Te[3*Ue],Te[3*Ue+1],Te[3*Ue+2]);X.primitiveLength+=ue.triangleCount,N.x=Math.min(N.x,ge.x),N.y=Math.min(N.y,ge.y),j.x=Math.max(j.x,Pe.x),j.y=Math.max(j.y,Pe.y)}X.primitiveLength>0&&this.triangleSubSegments.push({segment:X,min:N,max:j}),T=P;for(let Y=T;Y<g&&i[Y].subtile===i[T].subtile;Y++)P++}A=g;for(let k=A;k<_&&i[k].triangleSegmentIdx===i[A].triangleSegmentIdx;k++)g++}s._trim(),this.indexArray=s}getVisibleSegments(i,s,f){const A=new no;if(this.wallMode){for(const ae of this.triangleSubSegments)A.segments.push(ae.segment);return A}let g=0,_=0;const C=1<<i.canonical.z;if(s){const ae=s.getMinMaxForTile(i);ae&&(g=ae.min,_=ae.max)}_+=this.maxHeight;const T=i.toUnwrapped();let P;const k=[T.canonical.x/C+T.wrap,T.canonical.y/C],N=[(T.canonical.x+1)/C+T.wrap,(T.canonical.y+1)/C],j=(ae,ue,ge)=>[ae[0]*(1-ge[0])+ue[0]*ge[0],ae[1]*(1-ge[1])+ue[1]*ge[1]],X=[],Y=[];for(const ae of this.triangleSubSegments){X[0]=ae.min.x/Lr,X[1]=ae.min.y/Lr,Y[0]=ae.max.x/Lr,Y[1]=ae.max.y/Lr;const ue=j(k,N,X),ge=j(k,N,Y);if(new In([ue[0],ue[1],g],[ge[0],ge[1],_]).intersectsPrecise(f)===0){P&&(A.segments.push(P),P=void 0);continue}const Pe=ae.segment;P&&P.vertexOffset!==Pe.vertexOffset&&(A.segments.push(P),P=void 0),P?(P.vertexLength+=Pe.vertexLength,P.primitiveLength+=Pe.primitiveLength):P={vertexOffset:Pe.vertexOffset,primitiveLength:Pe.primitiveLength,vertexLength:Pe.vertexLength,primitiveOffset:Pe.primitiveOffset,sortKey:void 0,vaos:{}}}return P&&A.segments.push(P),A}encodeCentroid(i,s){const f=i.centroid(),A=s.span(),g=Math.min(7,Math.round(A.x*this.tileToMeter/10)),_=Math.min(7,Math.round(A.y*this.tileToMeter/10));return new hr(je(f.x,1,Lr-1)<<3|g,je(f.y,1,Lr-1)<<3|_)}encodeBorderCentroid(i){if(!i.borders)return new hr(0,0);const s=i.borders,f=Number.MAX_VALUE;if(s[0][0]!==f||s[1][0]!==f){const A=s[0][0]!==f?0:1;return new hr(6|(s[0][0]!==f?0:65528),(s[A][0]+s[A][1])/2<<3|6)}{const A=s[2][0]!==f?2:3;return new hr((s[A][0]+s[A][1])/2<<3|6,6|(s[2][0]!==f?0:65528))}}showCentroid(i){const s=this.centroidData[i.centroidDataIndex];s.flags&=2147483647,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const s=i.vertexArrayOffset,f=i.vertexCount+i.vertexArrayOffset,A=i.flags&Jm?l4:i.centroidXY,g=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==A.y||g!==A.x){for(let _=s;_<f;++_)this.centroidVertexArray.emplace(_,A.x,A.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,s,f){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const A=s.getReplacementRegionsForTile(i.toUnwrapped());if(ox(this.activeReplacements,A))return;if(this.activeReplacements=A,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const _ of this.centroidData)_.flags&=2147483647;const g=[];for(const _ of this.activeReplacements){if(_.order<f)continue;const C=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-i.canonical.z));if(_.footprint.buildingId){const T=_.footprint.buildingId;for(const P of this.centroidData)P.buildingId===T&&(P.flags|=Jm)}else for(const T of this.centroidData)if(!(T.flags&Jm||_.min.x>T.max.x||T.min.x>_.max.x||_.min.y>T.max.y||T.min.y>_.max.y))for(let P=0;P<T.footprintSegLen;P++){const k=this.footprintSegments[T.footprintSegIdx+P];if(g.length=0,PG(this.footprintVertices,k.vertexOffset,k.vertexCount,_.footprintTileId.canonical,i.canonical,g),PE(_.footprint,g,this.footprintIndices.uint16,k.indexOffset,k.indexCount,-k.vertexOffset,-C)){T.flags|=Jm;break}}}for(const _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,s,f){let A=!1;for(let g=0;g<f.footprintSegLen;g++){const _=this.footprintSegments[f.footprintSegIdx+g];let C=0;for(const T of _.ringIndices){for(let P=C,k=T+C-1;P<T+C;k=P++){const N=this.footprintVertices.int16[2*(P+_.vertexOffset)+0],j=this.footprintVertices.int16[2*(P+_.vertexOffset)+1],X=this.footprintVertices.int16[2*(k+_.vertexOffset)+1];j>s!=X>s&&i<(this.footprintVertices.int16[2*(k+_.vertexOffset)+0]-N)*(s-j)/(X-j)+N&&(A=!A)}C=T}}return A}getHeightAtTileCoord(i,s){let f=Number.NEGATIVE_INFINITY,A=!0;const g=4*(i+Lr)*Lr+(s+Lr);if(this.partLookup.hasOwnProperty(g)){const _=this.partLookup[g];return _?{height:_.height,hidden:!!(_.flags&Jm)}:void 0}for(const _ of this.centroidData)i>_.max.x||_.min.x>i||s>_.max.y||_.min.y>s||_.height<=f||this.footprintContainsPoint(i,s,_)&&(f=_.height,this.partLookup[g]=_,A=!!(_.flags&Jm));if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:A};this.partLookup[g]=void 0}}function A4(c,i){const s=c.add(i)._unit();return c.x*s.x+c.y*s.y}function FG(c,i,s,f){const A=i.sub(c)._perp()._unit(),g=s.sub(i)._perp()._unit();return d4(c,i,s,A4(A,g),f)}function d4(c,i,s,f,A){const g=Math.sqrt(1-f*f);return Math.min(c.dist(i)/3,i.dist(s)/3,A*g/f)}function RE(c,i,s){return c.x<s[0].x&&i.x<s[0].x||c.x>s[1].x&&i.x>s[1].x||c.y<s[0].y&&i.y<s[0].y||c.y>s[1].y&&i.y>s[1].y}function p4(c,i){return c.x<i[0].x||c.x>i[1].x||c.y<i[0].y||c.y>i[1].y}function m4(c,i,s){if(c.x<0||c.x>=Lr||i.x<0||i.x>=Lr||s.x<0||s.x>=Lr)return!1;const f=s.sub(i),A=f.perp(),g=c.sub(i);return(f.x*g.x+f.y*g.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(g.x*g.x+g.y*g.y))>-.866&&A.x*g.x+A.y*g.y<0}function g4(c,i,s){const f=i?2|c:-3&c;return s?1|f:-2&f}function _4(){const c=Math.PI/32,i=Math.tan(c),s=D;return s*Math.sqrt(1+2*i*i)-s}function v4(c,i,s){const f=1<<s.z,A=Ce(s.x/f),g=Ce((s.x+1)/f),_=ke(s.y/f),C=ke((s.y+1)/f);return function(T,P,k,N,j=0,X){const Y=[];if(!T.length||!k||!N)return Y;const ae=(at,ot)=>{for(const _t of at)Y.push({polygon:_t,bounds:ot})},ue=Math.ceil(Math.log2(k)),ge=Math.ceil(Math.log2(N)),Pe=ue-ge,Te=[];for(let at=0;at<Math.abs(Pe);at++)Te.push(Pe>0?0:1);for(let at=0;at<Math.min(ue,ge);at++)Te.push(0),Te.push(1);let Ue=T;if(Ue=nx(Ue,P[0].y-j,P[1].y+j,1),Ue=nx(Ue,P[0].x-j,P[1].x+j,0),!Ue.length)return Y;const At=[];for(Te.length?At.push({polygons:Ue,bounds:P,depth:0}):ae(Ue,P);At.length;){const at=At.pop(),ot=at.depth,_t=Te[ot],wt=at.bounds[0],Yt=at.bounds[1],Ft=_t===0?wt.x:wt.y,ir=_t===0?Yt.x:Yt.y,Ir=X?X(_t,Ft,ir):.5*(Ft+ir),cr=nx(at.polygons,Ft-j,Ir+j,_t),xr=nx(at.polygons,Ir-j,ir+j,_t);if(cr.length){const Tr=[wt,new hr(_t===0?Ir:Yt.x,_t===1?Ir:Yt.y)];Te.length>ot+1?At.push({polygons:cr,bounds:Tr,depth:ot+1}):ae(cr,Tr)}if(xr.length){const Tr=[new hr(_t===0?Ir:wt.x,_t===1?Ir:wt.y),Yt];Te.length>ot+1?At.push({polygons:xr,bounds:Tr,depth:ot+1}):ae(xr,Tr)}}return Y}(c,i,Math.ceil((g-A)/11.25),Math.ceil((_-C)/11.25),1,(T,P,k)=>{if(T===0)return .5*(P+k);{const N=ke((s.y+P/Lr)/f);return(Ae(.5*(ke((s.y+k/Lr)/f)+N))*f-s.y)*Lr}})}function PG(c,i,s,f,A,g){const _=Math.pow(2,f.z-A.z);for(let C=0;C<s;C++){let T=c.int16[2*(C+i)+0],P=c.int16[2*(C+i)+1];T=(T+A.x*Lr)*_-f.x*Lr,P=(P+A.y*Lr)*_-f.y*Lr,g.push(new hr(T,P))}}let y4,x4;Mr(lx,"FillExtrusionBucket",{omit:["layers","features"]}),Mr(u4,"PartData"),Mr(c4,"FootprintSegment"),Mr(h4,"BorderCentroidData"),Mr(DE,"GroundEffect");class Xg extends hr{constructor(i,s,f){super(i,s),this.z=f}}class w4 extends Xg{constructor(i,s,f,A){super(i,s,f),this.w=A}}function b4(c,i,s,f){const A=s==="x"?"y":"x",g=(f-c[s])/(i[s]-c[s]);c[A]=Math.round(c[A]+(i[A]-c[A])*g),c[s]=f,c.hasOwnProperty("z")&&(c.z=tr(c.z,i.z,g)),c.hasOwnProperty("w")&&(c.w=tr(c.w,i.w,g))}function E4(c,i,s,f){const A=s,g=f;for(const _ of["x","y"]){let C=c,T=i;C[_]>=T[_]&&(C=i,T=c),C[_]<A&&T[_]>A&&b4(C,T,_,A),C[_]<g&&T[_]>g&&b4(T,C,_,g)}}function cx(c,i,s,f,A,g){const _=[];for(let C=0;C<c.length;C++){const T=c[C];let P;const k=_.length;let N=0;for(let j=0;j<T.length-1;j++){let X=T[j],Y=T[j+1],ae=0;const ue=N;let ge,Pe;g&&(ae=Math.hypot(Y.x-X.x,Y.y-X.y),N+=ae,ge=X,Pe=Y),X.x<i&&Y.x<i||(X.x<i?X=new hr(i,X.y+(i-X.x)/(Y.x-X.x)*(Y.y-X.y))._round():Y.x<i&&(Y=new hr(i,X.y+(i-X.x)/(Y.x-X.x)*(Y.y-X.y))._round()),X.y<s&&Y.y<s||(X.y<s?X=new hr(X.x+(s-X.y)/(Y.y-X.y)*(Y.x-X.x),s)._round():Y.y<s&&(Y=new hr(X.x+(s-X.y)/(Y.y-X.y)*(Y.x-X.x),s)._round()),X.x>=f&&Y.x>=f||(X.x>=f?X=new hr(f,X.y+(f-X.x)/(Y.x-X.x)*(Y.y-X.y))._round():Y.x>=f&&(Y=new hr(f,X.y+(f-X.x)/(Y.x-X.x)*(Y.y-X.y))._round()),X.y>=A&&Y.y>=A||(X.y>=A?X=new hr(X.x+(A-X.y)/(Y.y-X.y)*(Y.x-X.x),A)._round():Y.y>=A&&(Y=new hr(X.x+(A-X.y)/(Y.y-X.y)*(Y.x-X.x),A)._round()),P&&X.equals(P[P.length-1])||(P=[X],_.push(P),g&&g.push({progress:{min:ue+B4(ge,Pe,X)*ae,max:1},parentIndex:C,prevPoint:ge,nextPoint:Pe})),P.push(Y),g&&(g[g.length-1].progress.max=ue+B4(ge,Pe,Y)*ae,g[g.length-1].nextPoint=Pe)))))}if(g&&N>0)for(let j=k;j<_.length;j++)g[j].progress.min/=N,g[j].progress.max/=N}return _}function LG(c,i,s,f,A){if(c.length<2)return void f.push(c);const g=[];for(;i.valid();){const[P,k]=i.get();for(let N=0;N<c.length-1;N++){const j=c[N],X=c[N+1],Y=gl(j,X,P,k);if(Y){const[ae]=Y,ue=new hr(tr(j.x,X.x,ae),tr(j.y,X.y,ae));g.push({t:N+ae,distance:0,point:ue})}}i.next()}if(g.length===0)return void f.push(c);g.sort((P,k)=>P.t-k.t);let _=0,C=0,T=[];for(f.push(T);_!==c.length;){if(C===g.length){for(;_!==c.length;)T.length!==0&&T[T.length-1].equals(c[_])||T.push(c[_]),_++;break}g[C].t<=_?(T.length!==0&&T[T.length-1].equals(g[C].point)||T.push(g[C].point),Math.trunc(g[C].t),C++):(T.length!==0&&T[T.length-1].equals(c[_])||T.push(c[_]),_++)}}function B4(c,i,s){return c.x!==i.x?(s.x-c.x)/(i.x-c.x):c.y!==i.y?(s.y-c.y)/(i.y-c.y):0}function Hv(c,i){return c.x*i.x+c.y*i.y}function C4(c,i){if(c.length===1){let s=0;const f=i[s++];let A;for(;!A||f.equals(A);)if(A=i[s++],!A)return 1/0;for(;s<i.length;s++){const g=i[s],_=c[0],C=A.sub(f),T=g.sub(f),P=_.sub(f),k=Hv(C,C),N=Hv(C,T),j=Hv(T,T),X=Hv(P,C),Y=Hv(P,T),ae=k*j-N*N,ue=(j*X-N*Y)/ae,ge=(k*Y-N*X)/ae,Pe=f.z*(1-ue-ge)+A.z*ue+g.z*ge;if(isFinite(Pe))return Pe}return 1/0}{let s=1/0;for(const f of i)s=Math.min(s,f.z);return s}}function S4(c,i,s,f,A,g,_,C){const T=_*A.getElevationAt(c,i,!0,!0),P=g[0]!==0,k=P?g[1]===0?_*(g[0]/7-450):_*function(N,j,X){const Y=Math.floor(j[0]/8),ae=Math.floor(j[1]/8),ue=10*(j[0]-8*Y),ge=10*(j[1]-8*ae),Pe=N.getElevationAt(Y,ae,!0,!0),Te=N.getMeterToDEM(X),Ue=Math.floor(.5*(ue*Te-1)),At=Math.floor(.5*(ge*Te-1)),at=N.tileCoordToPixel(Y,ae),ot=2*Ue+1,_t=2*At+1,wt=function(xr,Tr,$t,wr,Mt){return[xr.getElevationAtPixel(Tr,$t,!0),xr.getElevationAtPixel(Tr+Mt,$t,!0),xr.getElevationAtPixel(Tr,$t+Mt,!0),xr.getElevationAtPixel(Tr+wr,$t+Mt,!0)]}(N,at.x-Ue,at.y-At,ot,_t),Yt=Math.abs(wt[0]-wt[1]),Ft=Math.abs(wt[2]-wt[3]),ir=Math.abs(wt[0]-wt[2])+Math.abs(wt[1]-wt[3]),Ir=Math.min(.25,.5*Te*(Yt+Ft)/ot),cr=Math.min(.25,.5*Te*ir/_t);return Pe+Math.max(Ir*ue,cr*ge)}(A,g,C):T;return{base:T+(s===0?-1:s),top:P?Math.max(k+f,T+s+2):T+f}}class MG{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class OG{constructor(){this.tasks={},this.taskQueue=[],Ht(["process"],this),this.invoker=new MG(this.process),this.nextId=0}add(i,s){const f=this.nextId++,A=function({type:g,isSymbolTile:_,zoom:C}){return C=C||0,g==="message"?0:g!=="maybePrepare"||_?g!=="parseTile"||_?g==="parseTile"&&_?300-C:g==="maybePrepare"&&_?400-C:500:200-C:100-C}(s);if(A===0){try{i()}finally{}return null}return this.tasks[f]={fn:i,metadata:s,priority:A,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const s=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let i=null,s=1/0;for(let A=0;A<this.taskQueue.length;A++){const g=this.tasks[this.taskQueue[A]];g.priority<s&&(s=g.priority,i=A)}if(i===null)return null;const f=this.taskQueue[i];return this.taskQueue.splice(i,1),f}remove(){this.invoker.remove()}}class T4{constructor(i,s,f){this.target=i,this.parent=s,this.mapId=f,this.callbacks={},this.cancelCallbacks={},Ht(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new OG}send(i,s,f,A,g=!1,_){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(f.metadata=_,this.callbacks[C]=f);const T=new Set;return this.target.postMessage({id:C,type:i,hasCallback:!!f,targetMapId:A,mustQueue:g,sourceMapId:this.mapId,data:qo(s,T)},T),{cancel:()=>{f&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:A,sourceMapId:this.mapId})}}}receive(i){const s=i.data;if(!s)return;const f=s.id;if(f&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const A=this.cancelCallbacks[f];delete this.cancelCallbacks[f],A&&A.cancel()}else if(s.mustQueue||Kn(self)){const A=this.callbacks[f],g=this.scheduler.add(()=>this.processTask(f,s),A&&A.metadata||{type:"message"});g&&(this.cancelCallbacks[f]=g)}else this.processTask(f,s)}processTask(i,s){if(delete this.cancelCallbacks[i],s.type==="<response>"){const f=this.callbacks[i];delete this.callbacks[i],f&&(s.error?f(bo(s.error)):f(null,bo(s.data)))}else{const f=new Set,A=s.hasCallback?(_,C)=>{this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:_?qo(_):null,data:qo(C,f)},f)}:()=>{},g=bo(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,g,A);else if(this.parent.getWorkerSource){const _=s.type.split("."),{source:C,scope:T}=g;this.parent.getWorkerSource(s.sourceMapId,_[0],C,T)[_[1]](g,A)}else A(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Vv={workerUrl:"",workerClass:null,workerParams:void 0};const kE="mapboxgl_preloaded_worker_pool";class Zg{constructor(){this.active={}}acquire(i,s=Zg.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<s;)this.workers.push(Vv.workerClass!=null?new Vv.workerClass:new self.Worker(Vv.workerUrl,Vv.workerParams));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[kE]}numActive(){return Object.keys(this.active).length}}Zg.workerCount=2;class t_{constructor(i,s,f="Worker",A=Zg.workerCount){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=Oe();const g=this.workerPool.acquire(this.id,A);for(let _=0;_<g.length;_++){const C=new t_.Actor(g[_],s,this.id);C.name=`${f} ${_}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,s,f){me(this.actors,(A,g)=>{A.send(i,s,g)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}let Gv,UE;function ux(){return Gv||(Gv=new Zg),Gv}t_.Actor=T4;class DG{constructor(i){this.module=i}createIntArray(i){const s=new Int32Array(i),f=this.module.malloc(s.length*s.BYTES_PER_ELEMENT);return this.module.heap32.set(s,f/s.BYTES_PER_ELEMENT),f}createFloatArray(i){const s=new Float32Array(i),f=this.module.malloc(s.length*s.BYTES_PER_ELEMENT);return this.module.heapF32.set(s,f/s.BYTES_PER_ELEMENT),f}createStringBuffer(i){const s=this.module.malloc(i.length+1);for(let f=0;f<i.length;++f)this.module.heapU8[s+f]=i.charCodeAt(f);return this.module.heapU8[s+i.length]=0,s}readStringBuffer(i){let s="";for(;this.module.heapU8[i]!==0;)s+=String.fromCharCode(this.module.heapU8[i]),++i;return s}setStyle(i){const s=i.entranceColorRgb,f=i.facadeGlazingColorRgb,A=i.roofColorRgb,g=i.wallColorRgb,_=i.normalScale;this.module.setStyle(s[0],s[1],s[2],f[0],f[1],f[2],A[0],A[1],A[2],g[0],g[1],g[2],_[0],_[1],_[2],i.tileToMeters)}setAOOptions(i,s){this.module.setAOOptions(i?1:0,s)}setMetricOptions(i,s){this.module.setMetricOptions(i?1:0,s)}setStructuralOptions(i){this.module.setStructuralOptions(i?1:0)}setFacadeOptions(i,s){this.module.setFacadeOptions(i,s?1:0)}setFauxFacadeOptions(i,s,f){this.module.setFauxFacadeOptions(i?1:0,s?1:0,f)}setFacadeClassifierOptions(i){this.module.setFacadeClassifierOptions(i)}generateMesh(i,s){for(const C of i){const T=this.createStringBuffer(C.roofType),P=[0],k=[];for(const X of C.coordinates)if(Array.isArray(X)){for(const Y of X)k.push(Y.x),k.push(Y.y);P.push(k.length)}const N=this.createIntArray(P),j=this.createFloatArray(k);this.module.addFeature(C.id,C.sourceId,C.minHeight,C.height,T,C.roofType.length,j,N,P.length-1),this.module.free(T),this.module.free(N),this.module.free(j)}for(const C of s){let T;T=C.entrances?JSON.parse(C.entrances):[];const P=this.createFloatArray(T),k=[];for(const j of C.coordinates)k.push(j.x),k.push(j.y);const N=this.createFloatArray(k);this.module.addFacade(C.sourceId,C.crossPerc,C.distanceToRoad,P,T.length,N,k.length),this.module.free(P),this.module.free(N)}if(!this.module.generateMesh()){const C=this.module.getLastError();return this.readStringBuffer(C)}const f=this.module.getMeshCount(),A=new Array(f);for(let C=0;C<f;C++){const T=this.module.getPositionsPtr(C),P=this.module.getPositionsLength(C),k=new Float32Array(this.module.heapF32.buffer,T,P),N=this.module.getNormalsPtr(C),j=this.module.getNormalsLength(C),X=new Float32Array(this.module.heapF32.buffer,N,j),Y=this.module.getColorsPtr(C),ae=this.module.getColorsLength(C),ue=new Uint8Array(this.module.heapU8.buffer,Y,ae),ge=this.module.getAOPtr(C),Pe=this.module.getAOLength(C),Te=new Float32Array(this.module.heapF32.buffer,ge,Pe),Ue=this.module.getUVPtr(C),At=this.module.getUVLength(C),at=new Float32Array(this.module.heapF32.buffer,Ue,At),ot=this.module.getFauxFacadePtr(C),_t=this.module.getFauxFacadeLength(C),wt=new Uint8Array(this.module.heapU8.buffer,ot,_t),Yt=this.module.getIndicesPtr(C),Ft=this.module.getIndicesLength(C),ir=new Int32Array(this.module.heap32.buffer,Yt,Ft),Ir=this.module.getBuildingPart(C),cr=this.readStringBuffer(Ir);A[C]={positions:k,normals:X,colors:ue,ao:Te,uv:at,isFauxFacade:wt,indices:ir,buildingPart:cr}}const g=this.module.getRingCount(),_=[];for(let C=0;C<g;C++){const T=this.module.getRingPtr(C),P=this.module.getRingLength(C),k=new Float32Array(this.module.heapF32.buffer,T,P);_.push(k)}return{meshes:A,modifiedPolygonRings:_}}}let Kv,NE,Bd,r_,zE,n_=null,i_=null,I4=null,hx=null;function F4(){return Kn(self)&&self.worker.dracoUrl?self.worker.dracoUrl:NE||Ss.DRACO_URL}function P4(){if(Kn(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(r_)return r_;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return r_=WebAssembly.validate(c)?Ss.MESHOPT_SIMD_URL:Ss.MESHOPT_URL,r_}function RG(){return hx}const fx={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},kG={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Wv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function L4(c,i,s){const f=s.json.bufferViews.length,A=s.buffers.length;i.bufferView=f,s.json.bufferViews[f]={buffer:A,byteLength:c.byteLength},s.buffers[A]=c}const QE="KHR_draco_mesh_compression";function UG(c,i){const s=c.extensions&&c.extensions[QE];if(!s)return;const f=new Bd.Decoder,A=R4(i,s.bufferView),g=new Bd.Mesh;if(!f.DecodeArrayToMesh(A,A.byteLength,g))throw new Error("Failed to decode Draco mesh");const _=i.json.accessors[c.indices],C=fx[_.componentType],T=_.count*C.BYTES_PER_ELEMENT,P=Bd._malloc(T);C===Uint16Array?f.GetTrianglesUInt16Array(g,T,P):f.GetTrianglesUInt32Array(g,T,P),L4(Bd.memory.buffer.slice(P,P+T),_,i),Bd._free(P);for(const k of Object.keys(s.attributes)){const N=f.GetAttributeByUniqueId(g,s.attributes[k]),j=i.json.accessors[c.attributes[k]],X=kG[j.componentType],Y=j.count*Wv[j.type]*fx[j.componentType].BYTES_PER_ELEMENT,ae=Bd._malloc(Y);f.GetAttributeDataArrayForAllPoints(g,N,Bd[X],Y,ae),L4(Bd.memory.buffer.slice(ae,ae+Y),j,i),Bd._free(ae)}f.destroy(),g.destroy(),delete c.extensions[QE]}const Ax="EXT_meshopt_compression";function NG(c,i){if(!c.extensions||!c.extensions[Ax])return;const s=c.extensions[Ax],f=new Uint8Array(i.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),A=new Uint8Array(s.count*s.byteStride);zE.decodeGltfBuffer(A,s.count,s.byteStride,f,s.mode,s.filter),c.buffer=i.buffers.length,c.byteOffset=0,i.buffers[c.buffer]=A.buffer,delete c.extensions[Ax]}const M4=1179937895,O4=new TextDecoder("utf8");function D4(c,i){return new URL(c,i).href}function zG(c,i,s,f){return fetch(D4(c.uri,f)).then(A=>A.arrayBuffer()).then(A=>{i.buffers[s]=A})}function R4(c,i){const s=c.json.bufferViews[i];return new Uint8Array(c.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function QG(c,i,s,f){if(c.uri){const A=D4(c.uri,f);return fetch(A).then(g=>g.blob()).then(g=>createImageBitmap(g)).then(g=>{i.images[s]=g})}if(c.bufferView!==void 0){const A=R4(i,c.bufferView),g=new Blob([A],{type:c.mimeType});return createImageBitmap(g).then(_=>{i.images[s]=_})}}function k4(c,i=0,s){const f={json:null,images:[],buffers:[]};if(new Uint32Array(c,i,1)[0]===M4){const k=new Uint32Array(c,i);let N=2;const j=(k[N++]>>2)-3,X=k[N++]>>2;if(N++,f.json=JSON.parse(O4.decode(k.subarray(N,N+X))),N+=X,N<j){const Y=k[N++];N++;const ae=i+(N<<2);f.buffers[0]=c.slice(ae,ae+Y)}}else f.json=JSON.parse(O4.decode(new Uint8Array(c,i)));const{buffers:A,images:g,meshes:_,extensionsUsed:C,bufferViews:T}=f.json;let P=Promise.resolve();if(A){const k=[];for(let N=0;N<A.length;N++){const j=A[N];j.uri?k.push(zG(j,f,N,s)):f.buffers[N]||(f.buffers[N]=null)}P=Promise.all(k)}return P.then(()=>{const k=[],N=C&&C.includes(QE),j=C&&C.includes(Ax);if(N&&k.push(function(){if(!Bd)return Kv??(Kv=function(X){let Y,ae=null;function ue(){Y=new Uint8Array(ae.buffer)}function ge(){throw new Error("Unexpected Draco error.")}const Pe={a:{a:ge,d:function(Te,Ue,At){return Y.copyWithin(Te,Ue,Ue+At)},c:function(Te){const Ue=Y.length,At=Math.max(Te>>>0,Math.ceil(1.2*Ue)),at=Math.ceil((At-Ue)/65536);try{return ae.grow(at),ue(),!0}catch{return!1}},b:ge}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(X,Pe):X.then(Te=>Te.arrayBuffer()).then(Te=>WebAssembly.instantiate(Te,Pe))).then(Te=>{const{Rb:Ue,Qb:At,P:at,T:ot,X:_t,Ja:wt,La:Yt,Qa:Ft,Va:ir,Wa:Ir,eb:cr,jb:xr,f:Tr,e:$t,yb:wr,zb:Mt,Ab:Xt,Bb:Fr,Db:Er,Gb:mn}=Te.instance.exports;ae=$t;const on=(()=>{let vr=0,Cr=0,fn=0,tn=0;return Dr=>{fn&&(Ue(tn),Ue(vr),Cr+=fn,fn=vr=0),vr||(Cr+=128,vr=At(Cr));const nn=Dr.length+7&-8;let Cn=vr;nn>=Cr&&(fn=nn,Cn=tn=At(nn));for(let kn=0;kn<Dr.length;kn++)Y[Cn+kn]=Dr[kn];return Cn}})();return ue(),Tr(),{memory:$t,_free:Ue,_malloc:At,Mesh:class{constructor(){this.ptr=at()}destroy(){ot(this.ptr)}},Decoder:class{constructor(){this.ptr=wt()}destroy(){xr(this.ptr)}DecodeArrayToMesh(vr,Cr,fn){const tn=on(vr),Dr=Yt(this.ptr,tn,Cr,fn.ptr);return!!_t(Dr)}GetAttributeByUniqueId(vr,Cr){return{ptr:Ft(this.ptr,vr.ptr,Cr)}}GetTrianglesUInt16Array(vr,Cr,fn){ir(this.ptr,vr.ptr,Cr,fn)}GetTrianglesUInt32Array(vr,Cr,fn){Ir(this.ptr,vr.ptr,Cr,fn)}GetAttributeDataArrayForAllPoints(vr,Cr,fn,tn,Dr){cr(this.ptr,vr.ptr,Cr.ptr,fn,tn,Dr)}},DT_INT8:wr(),DT_UINT8:Mt(),DT_INT16:Xt(),DT_UINT16:Fr(),DT_UINT32:Er(),DT_FLOAT32:mn()}})}(fetch(F4())),Kv.then(X=>{Bd=X,Kv=void 0}))}()),j&&k.push(function(){if(zE)return;const X=function(Y){let ae;const ue=WebAssembly.instantiateStreaming(Y,{}).then(Te=>{ae=Te.instance,ae.exports.__wasm_call_ctors()}),ge={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Pe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ue,supported:!0,decodeGltfBuffer(Te,Ue,At,at,ot,_t){(function(wt,Yt,Ft,ir,Ir,cr,xr){const Tr=wt.exports.sbrk,$t=ir+3&-4,wr=Tr($t*Ir),Mt=Tr(cr.length),Xt=new Uint8Array(wt.exports.memory.buffer);Xt.set(cr,Mt);const Fr=Yt(wr,ir,Ir,Mt,cr.length);if(Fr===0&&xr&&xr(wr,$t,Ir),Ft.set(Xt.subarray(wr,wr+ir*Ir)),Tr(wr-Tr(0)),Fr!==0)throw new Error(`Malformed buffer data: ${Fr}`)})(ae,ae.exports[Pe[ot]],Te,Ue,At,at,ae.exports[ge[_t]])}}}(fetch(P4()));return X.ready.then(()=>{zE=X})}()),g)for(let X=0;X<g.length;X++)k.push(QG(g[X],f,X,s));return(k.length?Promise.all(k):Promise.resolve()).then(()=>{if(N&&_)for(const{primitives:X}of _)for(const Y of X)UG(Y,f);if(j&&_&&T)for(const X of T)NG(X,f);return f})})}function jE(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function HE(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class VE{constructor(i,s,f,A){this.context=i,this.format=f,this.useMipmap=A&&A.useMipmap,this.texture=i.gl.createTexture(),this.update(s,{premultiply:A&&A.premultiply})}update(i,s){const f=i&&i instanceof HTMLVideoElement&&i.width===0?i.videoWidth:i.width,A=i&&i instanceof HTMLVideoElement&&i.height===0?i.videoHeight:i.height,{context:g}=this,{gl:_}=g,{x:C,y:T}=s&&s.position?s.position:{x:0,y:0},P=C+f,k=T+A;!this.size||this.size[0]===P&&this.size[1]===k||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!s||s.premultiply!==!1));const N=i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap;if(!this.size&&P>0&&k>0){const j=this.useMipmap?Math.floor(Math.log2(Math.max(P,k)))+1:1;_.texStorage2D(_.TEXTURE_2D,j,this.format,P,k),this.size=[P,k]}if(this.size)if(N)_.texSubImage2D(_.TEXTURE_2D,0,C,T,jE(this.format),HE(this.format),i);else{const j=i.data;j&&_.texSubImage2D(_.TEXTURE_2D,0,C,T,f,A,jE(this.format),HE(this.format),j)}this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(i,s,f=!1){const{context:A}=this,{gl:g}=A;g.bindTexture(g.TEXTURE_2D,this.texture),i!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,i),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap&&!f?i===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),s!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,s),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(i,s,f,A,g){const{context:_}=this,{gl:C}=_;C.bindTexture(C.TEXTURE_2D,this.texture),s!==this.magFilter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,s),this.magFilter=s),i!==this.minFilter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,this.useMipmap?i===C.NEAREST?C.NEAREST_MIPMAP_NEAREST:C.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),f!==this.wrapS&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,f),this.wrapS=f),A!==this.wrapT&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,A),this.wrapT=A),g!==this.compareMode&&(g?(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_MODE,C.COMPARE_REF_TO_TEXTURE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_FUNC,g)):C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_MODE,C.NONE),this.compareMode=g)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class qv{constructor(i,s){this.context=i,this.texture=s}bind(i,s){const{context:f}=this,{gl:A}=f;A.bindTexture(A.TEXTURE_2D,this.texture),i!==this.minFilter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,i),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,i),this.minFilter=i),s!==this.wrapS&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,s),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,s),this.wrapS=s)}}const jG=Di([{name:"a_pos_3f",components:3,type:"Float32"}]),HG=Di([{name:"a_color_3f",components:3,type:"Float32"}]),VG=Di([{name:"a_color_4f",components:4,type:"Float32"}]),GG=Di([{name:"a_uv_2f",components:2,type:"Float32"}]),KG=Di([{name:"a_normal_3f",components:3,type:"Float32"}]),WG=Di([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),qG=Di([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function U4(c,i){const s=dx(c.projection,c.zoom,c.width,c.height),f=function(g,_,C,T,P){const k=new V(C.lng-180*eg,C.lat),N=new V(C.lng+180*eg,C.lat),j=g.project(k.lng,k.lat),X=g.project(N.lng,N.lat),Y=-Math.atan2(X.y-j.y,X.x-j.x),ae=tt.fromLngLat(C);ae.y=je(ae.y,-1+eg,1-eg);const ue=ae.toLngLat(),ge=g.project(ue.lng,ue.lat),Pe=tt.fromLngLat(ue);Pe.x+=eg;const Te=Pe.toLngLat(),Ue=g.project(Te.lng,Te.lat),At=z4(Ue.x-ge.x,Ue.y-ge.y,Y),at=tt.fromLngLat(ue);at.y+=eg;const ot=at.toLngLat(),_t=g.project(ot.lng,ot.lat),wt=z4(_t.x-ge.x,_t.y-ge.y,Y),Yt=Math.abs(At.x)/Math.abs(wt.y),Ft=R([]);Se(Ft,Ft,-Y*(1-(P?0:T)));const ir=R([]);return J(ir,ir,[1,1-(1-Yt)*T,1]),ir[4]=-wt.x/wt.y*T,Se(ir,ir,Y),q(ir,Ft,ir),ir}(c.projection,0,c.center,s,i),A=N4(c);return J(f,f,[A,A,1]),f}function N4(c){const i=c.projection,s=dx(c.projection,c.zoom,c.width,c.height),f=GE(i,c.center),A=GE(i,V.convert(i.center));return Math.pow(2,f*s+(1-s)*A)}function dx(c,i,s,f,A=1/0){const g=c.range;if(!g)return 0;const _=Math.min(A,Math.max(s,f)),C=Math.log(_/1024)/Math.LN2;return oe(g[0]+C,g[1]+C,i)}const eg=1/4e4;function GE(c,i){const s=je(i.lat,-$e,$e),f=new V(i.lng-180*eg,s),A=new V(i.lng+180*eg,s),g=c.project(f.lng,s),_=c.project(A.lng,s),C=tt.fromLngLat(f),T=tt.fromLngLat(A),P=_.x-g.x,k=_.y-g.y,N=T.x-C.x,j=T.y-C.y,X=Math.sqrt((N*N+j*j)/(P*P+k*k));return Math.log(X)/Math.LN2}function z4(c,i,s){const f=Math.cos(s),A=Math.sin(s);return{x:c*f-i*A,y:c*A+i*f}}function Q4(c,i,s){R(c),Se(c,c,_n(i[2])),se(c,c,_n(i[0])),ye(c,c,_n(i[1])),J(c,c,s),q(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function px(c,i,s,f,A,g,_,C){const T=[s[0]-i[0],s[1]-i[1],0],P=[f[0]-i[0],f[1]-i[1],0];if(Ze(T)<1e-12||Ze(P)<1e-12)return Zn(c);const k=Dt([],T,P);et(k,k),jt(P,f,i),T[2]=(g-A)*C,P[2]=(_-A)*C;const N=T;return Dt(N,T,P),et(N,N),vi(c,k,N)}function KE(c,i,s=!1){const f=nr(i.zoom),A=function(g,_,C){const T=_.worldSize,P=[g[12],g[13],g[14]],k=ke(P[1]/T),N=Ce(P[0]/T),j=R([]),X=fe(1,k)*T,Y=fe(1,0)*T*ct(k,_.zoom),ae=1/pi(T);let ue=Y*ae;if(C){const Ue=dx(_.projection,_.zoom,_.width,_.height,1024);ue=ae*_.projection.pixelSpaceConversion(_.center.lat,T,Ue)}const ge=F(k,N);Ut(ge,ge,lt([],et([],ge),X*ue*P[2]));const Pe=function(Ue){const At=[Ue[0],Ue[1],Ue[2]];let at=[0,1,0];const ot=Dt([],at,At);return Dt(at,At,ot),Fe(at)===0&&(at=[0,1,0],Dt(ot,At,at)),et(ot,ot),et(at,at),et(At,At),[ot[0],ot[1],ot[2],0,at[0],at[1],at[2],0,At[0],At[1],At[2],0,Ue[0],Ue[1],Ue[2],1]}(ge);J(j,j,[ue,ue,ue*X]),te(j,j,[-P[0],-P[1],-P[2]]);const Te=q([],_.globeMatrix,Pe);return q(Te,Te,j),q(Te,Te,g),Te}(c,i,s);if(f>0){const g=function(_,C){const T=C.worldSize,P=fe(1,0)*T*ct(C.center.lat,C.zoom)/pi(T),k=fe(1,C.center.lat)*T,N=R([]);return ye(N,N,_n(C.center.lng)),se(N,N,_n(C.center.lat)),te(N,N,[0,0,Vl]),J(N,N,[P,P,P*k]),te(N,N,[C.point.x-.5*T,C.point.y-.5*T,0]),q(N,N,_),q(N,C.globeMatrix,N)}(c,i);return function(_,C,T){const P=(Y,ae,ue)=>{const ge=Ze(Y),Pe=Ze(ae),Te=de(Y,ae,ue);return lt(Te,Te,1/Ze(Te)*tr(ge,Pe,ue))},k=P([_[0],_[1],_[2]],[C[0],C[1],C[2]],T),N=P([_[4],_[5],_[6]],[C[4],C[5],C[6]],T),j=P([_[8],_[9],_[10]],[C[8],C[9],C[10]],T),X=de([_[12],_[13],_[14]],[C[12],C[13],C[14]],T);return[k[0],k[1],k[2],0,N[0],N[1],N[2],0,j[0],j[1],j[2],0,X[0],X[1],X[2],1]}(A,g,f)}return A}function j4(c,i,s,f){const A=In.projectAabbCorners(f,s);let g=Number.MAX_VALUE,_=-1;for(let P=0;P<A.length;++P){const k=A[P];k[0]=(.5*k[0]+.5)*i.width,k[1]=(.5-.5*k[1])*i.height,k[2]<g&&(_=P,g=k[2])}const C=P=>new hr(A[P][0],A[P][1]);let T;switch(_){case 0:case 6:T=[C(1),C(5),C(4),C(7),C(3),C(2),C(1)];break;case 1:case 7:T=[C(0),C(4),C(5),C(6),C(2),C(3),C(0)];break;case 3:case 5:T=[C(1),C(0),C(4),C(7),C(6),C(2),C(1)];break;default:T=[C(1),C(5),C(6),C(7),C(3),C(0),C(1)]}if(ga(c,T))return g}const Yg=64,a_={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function H4(c,i,s,f,A,g,_,C,T,P=!1){const k=s.zoom,N=s.project(f),j=ct(f.lat,k),X=1/j;R(c),te(c,c,[N.x+_[0]*X,N.y+_[1]*X,_[2]]);let Y=1,ae=1;const ue=s.worldSize;if(P){if(s.projection.name==="mercator"){let Ue=0;s.elevation&&(Ue=s.elevation.getAtPointOrZero(new tt(N.x/ue,N.y/ue),0));const At=yn([],[N.x,N.y,Ue,1],s.projMatrix)[3]/s.cameraToCenterDistance;Y=At,ae=At*ct(s.center.lat,k)}else if(s.projection.name==="globe"){const Ue=KE(c,s),At=[0,0,0,1];yn(At,At,q([],s.projMatrix,Ue));const at=At[3]/s.cameraToCenterDistance,ot=nr(k),_t=s.projection.pixelsPerMeter(f.lat,ue)*ct(f.lat,k),wt=s.projection.pixelsPerMeter(s.center.lat,ue)*ct(s.center.lat,k);Y=at/tr(_t,it(s.center.lat),ot),ae=at*j/_t,Y*=wt,ae*=wt}}else Y=X;J(c,c,[Y,Y,ae]);const ge=[...c],Pe=i.orientation,Te=[];if(Q4(Te,[Pe[0]+A[0],Pe[1]+A[1],Pe[2]+A[2]],g),q(c,ge,Te),C&&s.elevation){let Ue=0;const At=[];if(T&&s.elevation){Ue=function(ot,_t,wt,Yt,Ft){const ir=_t.elevation;if(!ir)return 0;const Ir=In.projectAabbCorners(wt,Yt),cr=fe(1,Ft.lat)*_t.worldSize,xr=function(Cr,fn){const tn=[0,0,1],Dr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const nn of Dr){const Cn=Cr[nn.corners[0]],kn=Cr[nn.corners[1]],li=Cr[nn.corners[2]],$n=[kn[0]-Cn[0],kn[1]-Cn[1],fn*(kn[2]-Cn[2])],zi=Dt($n,$n,[li[0]-Cn[0],li[1]-Cn[1],fn*(li[2]-Cn[2])]);et(zi,zi),nn.dotProductWithUp=xt(zi,tn)}return Dr.sort((nn,Cn)=>nn.dotProductWithUp-Cn.dotProductWithUp),Dr[0].corners}(Ir,cr),Tr=Ir[xr[0]],$t=Ir[xr[1]],wr=Ir[xr[2]],Mt=Ir[xr[3]],Xt=ir.getAtPointOrZero(new tt(Tr[0]/_t.worldSize,Tr[1]/_t.worldSize),0),Fr=ir.getAtPointOrZero(new tt($t[0]/_t.worldSize,$t[1]/_t.worldSize),0),Er=ir.getAtPointOrZero(new tt(wr[0]/_t.worldSize,wr[1]/_t.worldSize),0),mn=ir.getAtPointOrZero(new tt(Mt[0]/_t.worldSize,Mt[1]/_t.worldSize),0),on=(Xt+mn)/2,vr=(Fr+Er)/2;return on>vr?Fr<Er?px(ot,$t,Mt,Tr,Fr,mn,Xt,cr):px(ot,wr,Tr,Mt,Er,Xt,mn,cr):Xt<mn?px(ot,Tr,$t,wr,Xt,Fr,Er,cr):px(ot,Mt,wr,$t,mn,Er,Fr,cr),Math.max(on,vr)}(At,s,i.aabb,c,f);const at=q([],we([],At),Te);q(c,ge,at)}else Ue=s.elevation.getAtPointOrZero(new tt(N.x/ue,N.y/ue),0);Ue!==0&&(c[14]+=Ue)}}function $v(c,i,s=!1){c.uploaded||(c.gfxTexture=new VE(i,c.image,s?i.gl.R8:i.gl.RGBA8,{useMipmap:c.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function $G(c,i,s){c.indexBuffer=i.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=i.createVertexBuffer(c.vertexArray,jG.members,!1,!0),c.normalArray&&(c.normalBuffer=i.createVertexBuffer(c.normalArray,KG.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=i.createVertexBuffer(c.texcoordArray,GG.members,!1,!0)),c.colorArray&&(c.colorBuffer=i.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?HG:VG).members,!1,!0)),c.featureArray&&(c.pbrBuffer=i.createVertexBuffer(c.featureArray,qG.members,!0)),c.segments=no.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const f=c.material;f.pbrMetallicRoughness.baseColorTexture&&$v(f.pbrMetallicRoughness.baseColorTexture,i),f.pbrMetallicRoughness.metallicRoughnessTexture&&$v(f.pbrMetallicRoughness.metallicRoughnessTexture,i),f.normalTexture&&$v(f.normalTexture,i),f.occlusionTexture&&$v(f.occlusionTexture,i,s),f.emissionTexture&&$v(f.emissionTexture,i)}function WE(c,i,s){if(c.meshes)for(const f of c.meshes)$G(f,i,s);if(c.children)for(const f of c.children)WE(f,i,s)}function mx(c){if(c.meshes)for(const i of c.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(c.children)for(const i of c.children)mx(i)}function qE(c){if(c.meshes)for(const s of c.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((i=s.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(c.children)for(const s of c.children)qE(s)}function Jg(c,i){const s=c.json.bufferViews[i.bufferView],f=fx[i.componentType];return new f(c.buffers[s.buffer],(i.byteOffset||0)+(s.byteOffset||0),i.count*(s.byteStride&&s.byteStride!==Wv[i.type]*f.BYTES_PER_ELEMENT?s.byteStride/f.BYTES_PER_ELEMENT:Wv[i.type]))}function $E(c,i,s,f){const A=fx[i.componentType],g=function(k){switch(k){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(A),_=c.json.bufferViews[i.bufferView],C=_.byteStride?_.byteStride/A.BYTES_PER_ELEMENT:Wv[i.type],T=s.float32,P=T.length/s.capacity;for(let k=0,N=0;k<i.count*C;k+=C,N+=P)for(let j=0;j<P;j++)T[N+j]=f[k+j]*g;s._trim()}function XG(c,i,s){const f=c.indices,A=c.attributes,g={};g.indexArray=new Ua;const _=i.json.accessors[f],C=_.count/3;g.indexArray.reserve(C);const T=Jg(i,_);for(let j=0;j<C;j++)g.indexArray.emplaceBack(T[3*j],T[3*j+1],T[3*j+2]);g.indexArray._trim(),g.vertexArray=new Rc;const P=i.json.accessors[A.POSITION];g.vertexArray.reserve(P.count);const k=Jg(i,P);for(let j=0;j<P.count;j++)g.vertexArray.emplaceBack(k[3*j],k[3*j+1],k[3*j+2]);if(g.vertexArray._trim(),g.aabb=new In(P.min,P.max),g.centroid=function(j,X){const Y=[0,0,0],ae=j.length;if(ae>0){for(let ue=0;ue<ae;ue++){const ge=3*j[ue];Y[0]+=X[ge],Y[1]+=X[ge+1],Y[2]+=X[ge+2]}Y[0]/=ae,Y[1]/=ae,Y[2]/=ae}return Y}(T,k),A.COLOR_0!==void 0){const j=i.json.accessors[A.COLOR_0],X=Wv[j.type],Y=Jg(i,j);g.colorArray=X===3?new Rc:new Xh,g.colorArray.resize(j.count),$E(i,j,g.colorArray,Y)}if(A.NORMAL!==void 0){g.normalArray=new Rc;const j=i.json.accessors[A.NORMAL];g.normalArray.resize(j.count);const X=Jg(i,j);$E(i,j,g.normalArray,X)}if(A.TEXCOORD_0!==void 0&&s.length>0){g.texcoordArray=new tl;const j=i.json.accessors[A.TEXCOORD_0];g.texcoordArray.resize(j.count);const X=Jg(i,j);$E(i,j,g.texcoordArray,X)}if(A._FEATURE_ID_RGBA4444!==void 0){const j=i.json.accessors[A._FEATURE_ID_RGBA4444];i.json.extensionsUsed&&i.json.extensionsUsed.includes("EXT_meshopt_compression")&&(g.featureData=Jg(i,j))}A._FEATURE_RGBA4444!==void 0&&(g.featureData=new Uint32Array(Jg(i,i.json.accessors[A._FEATURE_RGBA4444]).buffer));const N=c.material;return g.material=function(j,X){const{emissiveFactor:Y=[0,0,0],alphaMode:ae="OPAQUE",alphaCutoff:ue=.5,normalTexture:ge,occlusionTexture:Pe,emissiveTexture:Te,doubleSided:Ue}=j,{baseColorFactor:At=[1,1,1,1],metallicFactor:at=1,roughnessFactor:ot=1,baseColorTexture:_t,metallicRoughnessTexture:wt}=j.pbrMetallicRoughness||{},Yt=Pe?X[Pe.index]:void 0;if(Pe&&Pe.extensions&&Pe.extensions.KHR_texture_transform&&Yt){const Ft=Pe.extensions.KHR_texture_transform;Yt.offsetScale=[Ft.offset[0],Ft.offset[1],Ft.scale[0],Ft.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new ft(...At),metallicFactor:at,roughnessFactor:ot,baseColorTexture:_t?X[_t.index]:void 0,metallicRoughnessTexture:wt?X[wt.index]:void 0},doubleSided:Ue,emissiveFactor:new ft(...Y),alphaMode:ae,alphaCutoff:ue,normalTexture:ge?X[ge.index]:void 0,occlusionTexture:Yt,emissionTexture:Te?X[Te.index]:void 0,defined:j.defined===void 0}}(N!==void 0?i.json.materials[N]:{defined:!1},s),g}function V4(c,i,s){const{matrix:f,rotation:A,translation:g,scale:_,mesh:C,extras:T,children:P}=c,k={};if(k.matrix=f||function(N,j,X,Y){var ae=j[0],ue=j[1],ge=j[2],Pe=j[3],Te=ae+ae,Ue=ue+ue,At=ge+ge,at=ae*Te,ot=ae*Ue,_t=ae*At,wt=ue*Ue,Yt=ue*At,Ft=ge*At,ir=Pe*Te,Ir=Pe*Ue,cr=Pe*At,xr=Y[0],Tr=Y[1],$t=Y[2];return N[0]=(1-(wt+Ft))*xr,N[1]=(ot+cr)*xr,N[2]=(_t-Ir)*xr,N[3]=0,N[4]=(ot-cr)*Tr,N[5]=(1-(at+Ft))*Tr,N[6]=(Yt+ir)*Tr,N[7]=0,N[8]=(_t+Ir)*$t,N[9]=(Yt-ir)*$t,N[10]=(1-(at+wt))*$t,N[11]=0,N[12]=X[0],N[13]=X[1],N[14]=X[2],N[15]=1,N}([],A||[0,0,0,1],g||[0,0,0],_||[1,1,1]),C!==void 0){k.meshes=s[C];const N=k.anchor=[0,0];for(const j of k.meshes){const{min:X,max:Y}=j.aabb;N[0]+=X[0]+Y[0],N[1]+=X[1]+Y[1]}N[0]=Math.floor(N[0]/k.meshes.length/2),N[1]=Math.floor(N[1]/k.meshes.length/2)}if(T&&(T.id&&(k.id=T.id),T.lights&&(k.lights=function(N){if(!N.length)return[];const j=function(ge){const Pe=atob(ge),Te=new Uint8Array(Pe.length);for(let Ue=0;Ue<Pe.length;Ue++)Te[Ue]=Pe.codePointAt(Ue);return Te}(N),X=[],Y=j.length/24,ae=new Uint16Array(j.buffer),ue=new Float32Array(j.buffer);for(let ge=0;ge<Y;ge++){const Pe=ae[2*ge*6]/30,Te=ae[2*ge*6+1]/30,Ue=ae[2*ge*6+10]/100,At=ue[6*ge+1],at=ue[6*ge+2],ot=ue[6*ge+3],_t=ue[6*ge+4],wt=ot-At,Yt=_t-at,Ft=Math.hypot(wt,Yt);X.push({pos:[At+.5*wt,at+.5*Yt,Te],normal:[Yt/Ft,-wt/Ft,0],width:Ft,height:Pe,depth:Ue,points:[At,at,ot,_t]})}return X}(T.lights))),P){const N=[];for(const j of P)N.push(V4(i.json.nodes[j],i,s));k.children=N}return k}function ZG(c){if(c.vertices.length===0||c.indices.length===0)return null;const i=new ix(c.vertices,c.indices,8,256),[s,f]=[i.min.clone(),i.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:i,min:s,max:f}}function YG(c){if(!c.extras||!c.extras.ground)return null;const i=c.extras.ground;if(!i||!Array.isArray(i)||i.length===0)return null;const s=i[0];if(!s||!Array.isArray(s)||s.length===0)return null;const f=[];for(const _ of s){if(!Array.isArray(_)||_.length!==2)continue;const C=_[0],T=_[1];typeof C=="number"&&typeof T=="number"&&f.push(new hr(C,T))}if(f.length<3)return null;f.length>1&&f[f.length-1].equals(f[0])&&f.pop();let A=0;for(let _=0;_<f.length;_++){const C=f[_],T=f[(_+1)%f.length],P=f[(_+2)%f.length];A+=(C.x-T.x)*(P.y-T.y)-(P.x-T.x)*(C.y-T.y)}A>0&&f.reverse();const g=J0(f.flatMap(_=>[_.x,_.y]),[]);return g.length===0?null:{vertices:f,indices:g}}function JG(c,i){const s=[],f=[];let A=0;const g=[];for(const _ of c){A=s.length;const C=_.vertexArray.float32,T=_.indexArray.uint16;for(let P=0;P<_.vertexArray.length;P++)g[0]=C[3*P+0],g[1]=C[3*P+1],g[2]=C[3*P+2],Ct(g,g,i),s.push(new hr(g[0],g[1]));for(let P=0;P<3*_.indexArray.length;P++)f.push(T[P]+A)}if(f.length%3!=0)return null;for(let _=0;_<f.length;_+=3){const C=s[f[_+0]],T=s[f[_+1]],P=s[f[_+2]];(C.x-T.x)*(P.y-T.y)-(P.x-T.x)*(C.y-T.y)>0&&([f[_+1],f[_+2]]=[f[_+2],f[_+1]])}return{vertices:s,indices:f}}function G4(c){const i=function(T,P){const k=[],N=WebGL2RenderingContext;if(T.json.textures)for(const j of T.json.textures){const X={magFilter:N.LINEAR,minFilter:N.NEAREST,wrapS:N.REPEAT,wrapT:N.REPEAT};j.sampler!==void 0&&Object.assign(X,T.json.samplers[j.sampler]),k.push({image:P[j.source],sampler:X,uploaded:!1})}return k}(c,c.images),s=function(T,P){const k=[];for(const N of T.json.meshes){const j=[];for(const X of N.primitives)j.push(XG(X,T,P));k.push(j)}return k}(c,i),{scenes:f,scene:A,nodes:g}=c.json,_=f?f[A||0].nodes:g,C=[];for(const T of _)C.push(V4(g[T],c,s));return function(T,P,k){const N={},j=new Set;for(let X=0;X<T.length;X++){const Y=k[P[X]];if(!Y.extras)continue;const ae=Y.extras["mapbox:footprint:version"],ue=Y.extras["mapbox:footprint:id"];(ae||ue)&&j.add(X),ae==="1.0.0"&&ue&&(N[ue]=X)}for(let X=0;X<T.length;X++){if(j.has(X))continue;const Y=T[X],ae=k[P[X]];if(!ae.extras)continue;let ue=null;Y.id in N&&(ue=JG(T[N[Y.id]].meshes,Y.matrix)),ue||(ue=YG(ae)),ue&&(Y.footprint=ZG(ue))}if(j.size>0){const X=Array.from(j.values()).sort((Y,ae)=>Y-ae);for(let Y=X.length-1;Y>=0;Y--)T.splice(X[Y],1)}}(C,_,c.json.nodes),C}function eK(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const i=c.vertexArray.float32,s=c.aabb.min[0]-1,f=c.aabb.min[1]-1,A=Yg/(c.aabb.max[0]-s+2),g=Yg/(c.aabb.max[1]-f+2);for(let _=0;_<i.length;_+=3){const C=i[_+2],T=(i[_+0]-s)*A|0,P=(i[_+1]-f)*g|0;C>c.heightmap[P*Yg+T]&&(c.heightmap[P*Yg+T]=C)}}function K4(c,i,s,f,A){s.reserve(s.length+4*c.length),f.reserve(f.length+10*c.length),A.reserve(A.length+10*c.length);let g=f.length;for(const _ of c){const C=Math.min(10,Math.max(4,1.3*_.height))*i,T=[-_.normal[1],_.normal[0],0],P=Math.min(.29,.1*_.width/_.depth),k=_.width-2*_.depth*i*(P+.01),N=ie([],_.pos,T,k/2),j=ie([],_.pos,T,-k/2),X=[N[0],N[1],N[2]+_.height],Y=[j[0],j[1],j[2]+_.height],ae=ie([],_.normal,T,P);lt(ae,ae,C);const ue=ie([],_.normal,T,-P);lt(ue,ue,C),Ut(ae,N,ae),Ut(ue,j,ue),N[2]+=.1,j[2]+=.1,f.emplaceBack(ae[0],ae[1],ae[2]),f.emplaceBack(ue[0],ue[1],ue[2]),f.emplaceBack(N[0],N[1],N[2]),f.emplaceBack(j[0],j[1],j[2]),f.emplaceBack(X[0],X[1],X[2]),f.emplaceBack(Y[0],Y[1],Y[2]),f.emplaceBack(N[0],N[1],N[2]),f.emplaceBack(j[0],j[1],j[2]),f.emplaceBack(ae[0],ae[1],ae[2]),f.emplaceBack(ue[0],ue[1],ue[2]);const ge=k/C/2;A.emplaceBack(-ge-P,-1,ge,.8),A.emplaceBack(ge+P,-1,ge,.8),A.emplaceBack(-ge,0,ge,1.3),A.emplaceBack(ge,0,ge,1.3),A.emplaceBack(ge+P,-.8,ge,.7),A.emplaceBack(ge+P,-.8,ge,.7),A.emplaceBack(0,0,ge,1.3),A.emplaceBack(0,0,ge,1.3),A.emplaceBack(ge+P,-1.2,ge,.8),A.emplaceBack(ge+P,-1.2,ge,.8),s.emplaceBack(6+g,4+g,8+g),s.emplaceBack(7+g,9+g,5+g),s.emplaceBack(0+g,1+g,2+g),s.emplaceBack(1+g,3+g,2+g),g+=10}}function tK(c,i){const s={};s.indexArray=new Ua,s.vertexArray=new Rc,s.colorArray=new Xh,K4(c,i,s.indexArray,s.vertexArray,s.colorArray);const f={defined:!0};f.emissiveFactor=ft.black;const A={};return A.baseColorFactor=ft.white,f.pbrMetallicRoughness=A,s.material=f,s.aabb=new In([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}const W4=Di([{name:"a_pos_3f",components:3,type:"Float32"}]),rK=Di([{name:"a_normal_3",components:3,type:"Int16"}]),q4=Di([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),nK=Di([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),$4=Ot.types,XE=32767;function iK(c,i){const s=Lr+i;for(const f of c)for(const A of f)if(A.x<-i||A.x>s||A.y<-i||A.y>s)return!1;return!0}class X4{constructor(i){this.layoutAOArray=[],this.indexArrayForConflationUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.footprintLookup={},this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.hasPattern=!1,this.worldview=i.worldview,this.layoutVertexArray=new Rc,this.layoutNormalArray=new sp,this.layoutColorArray=new Zh,this.indexArray=new Ua,this.indexArrayForConflation=new Ua,this.entranceBloom={layoutVertexArray:new Rc,layoutVertexBuffer:null,layoutAttenuationArray:new Xh,layoutAttenuationBuffer:null,layoutColorArray:new Zh,layoutColorBuffer:null,indexArray:new Ua,indexArrayForConflation:new Ua,indexBuffer:null,segmentsBucket:new no},this.programConfigurations=new Pu(i.layers,{zoom:i.zoom,lut:i.lut}),this.segmentsBucket=new no,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=i.projection,this.groundEffect=new DE(i)}get segments(){return this.segmentsBucket}get bloomGeometry(){return this.entranceBloom}updateFootprints(i,s){for(const f of this.footprints)s.push({footprint:f,id:i})}prepare(){return function(){if(hx!=null||I4!=null)return null;if(i_!=null)return i_;const i=fetch(Ss.BUILDING_GEN_URL);return i_=function(s){let f,A,g,_;function C(){f=new Uint8Array(_.buffer),A=new Int32Array(_.buffer),g=new Float32Array(_.buffer)}function T(){throw new Error("Unexpected BuildingGen error.")}const P=()=>{},k={a:{a:T,f:function(N){const j=f.length,X=Math.max(N>>>0,Math.ceil(1.2*j)),Y=Math.ceil((X-j)/65536);try{return _.grow(Y),C(),!0}catch{return!1}},g:T,b:P,c:P,d:P,e:P}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(s,k):s.then(N=>N.arrayBuffer()).then(N=>WebAssembly.instantiate(N,k))).then(N=>{const j=N.instance.exports;return(0,j.g)(),_=j.f,C(),new DG({setStyle:j.h,setAOOptions:j.i,setMetricOptions:j.j,setStructuralOptions:j.k,setFacadeOptions:j.l,setFauxFacadeOptions:j.m,setFacadeClassifierOptions:j.n,addFeature:j.o,addFacade:j.p,generateMesh:j.q,getLastError:j.r,getMeshCount:j.s,getPositionsPtr:j.t,getPositionsLength:j.u,getNormalsPtr:j.v,getNormalsLength:j.w,getColorsPtr:j.x,getColorsLength:j.y,getAOPtr:j.z,getAOLength:j.A,getUVPtr:j.B,getUVLength:j.C,getFauxFacadePtr:j.D,getFauxFacadeLength:j.E,getIndicesPtr:j.F,getIndicesLength:j.G,getBuildingPart:j.H,getRingCount:j.I,getRingPtr:j.J,getRingLength:j.K,free:j.L,malloc:j.M,heapU8:f,heap32:A,heapF32:g})})}(i).then(s=>(i_=null,hx=s,hx)).catch(s=>{Hr("Could not load building-gen"),i_=null,I4=s}),i_}()}populate(i,s,f,A){const g=RG();if(!g)return;const _=Ye(f);this.tileToMeter=_,this.brightness=s.brightness,g.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,_],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:_,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),g.setAOOptions(!1,.3),g.setMetricOptions(!1,16),g.setStructuralOptions(!0),g.setFacadeOptions(4,!0),g.setFauxFacadeOptions(!1,!1,1),g.setFacadeClassifierOptions(3);const C=new Map;for(const{feature:T}of i){if($4[T.type]!=="LineString")continue;const P=this.layers[0]._featureFilter.needGeometry,k=zt(T,P);if(!this.layers[0]._featureFilter.filter(new oa(this.zoom),k,f))continue;const N=P?k.geometry:ht(T,f,A),j=[];for(const ue of N)for(const ge of ue)j.push({x:ge.x,y:ge.y});const X={coordinates:j,crossPerc:T.properties.cross_perc,distanceToRoad:T.properties.distance_to_road,entrances:T.properties.entrances,sourceId:0},Y=T.properties.source_id;let ae=C.get(Y);ae||(ae=[],C.set(Y,ae)),ae.push(X)}this.maxHeight=0;for(const{feature:T,index:P}of i){if($4[T.type]==="LineString")continue;const k=this.layers[0]._featureFilter.needGeometry,N=zt(T,k);if(!this.layers[0]._featureFilter.filter(new oa(this.zoom),N,f))continue;const j=k?N.geometry:ht(T,f,A),X=Uv(j,500);if(!iK(j,163))continue;const Y=this.layers[0],ae=Y.layout.get("building-base").evaluate(T,{},f),ue=Y.layout.get("building-height").evaluate(T,{},f),ge=Y.layout.get("building-roof-shape").evaluate(T,{},f),Pe=Y.paint.get("building-ambient-occlusion-intensity"),Te=Y.paint.get("building-ambient-occlusion-ground-radius")/this.tileToMeter;if(ge==="flat")continue;const Ue=T.properties.source_id;let At;At=C.has(Ue)?C.get(Ue):[];const at=[],ot=new hr(1/0,1/0),_t=new hr(-1/0,-1/0);for(const vr of X)if(vr.length>0){const Cr=[];for(const fn of vr){const tn=[];for(let Dr=fn.length-1;Dr>=0;Dr--){const nn=fn[Dr];tn.push({x:nn.x,y:nn.y}),ot.x=Math.min(ot.x,nn.x),ot.y=Math.min(ot.y,nn.y),_t.x=Math.max(_t.x,nn.x),_t.y=Math.max(_t.y,nn.y)}Cr.push(tn)}at.push({id:T.id,height:ue,minHeight:ae,sourceId:0,roofType:ge,coordinates:Cr})}const wt=g.generateMesh(at,At);if(typeof wt=="string"||wt.meshes.length===0||wt.modifiedPolygonRings.length===0)continue;let Yt=0;for(const vr of wt.meshes)Yt+=vr.positions.length/3;const Ft=this.segmentsBucket.prepareSegment(Yt,this.layoutVertexArray,this.indexArray),ir=[];let Ir=null,cr=0,xr=-1;const Tr=this.indexArray.length;let $t=0;for(const vr of wt.meshes){const Cr=this.layoutVertexArray.length;if(vr.buildingPart==="entrance"){const tn=new Array;for(let kn=0;kn<vr.indices.length;kn+=12){const li=vr.positions[kn+0],$n=vr.positions[kn+1],zi=vr.positions[kn+3],xi=vr.positions[kn+4],$a=vr.positions[kn+2],Ge=vr.positions[kn+8]-$a,Ke=1,Kt=zi-li,Pr=xi-$n,Vr=Math.hypot(Kt,Pr);tn.push({pos:[li+.5*Kt,$n+.5*Pr,$a],normal:[Pr/Vr,-Kt/Vr,0],width:Vr,height:Ge,depth:Ke,points:[li,$n,zi,xi]})}const Dr=this.entranceBloom.segmentsBucket.prepareSegment(10*tn.length,this.entranceBloom.layoutVertexArray,this.entranceBloom.indexArray),nn=this.entranceBloom.layoutVertexArray.length;cr=this.entranceBloom.indexArray.length,K4(tn,.5/this.tileToMeter,this.entranceBloom.indexArray,this.entranceBloom.layoutVertexArray,this.entranceBloom.layoutAttenuationArray);const Cn=this.entranceBloom.layoutVertexArray.length-nn;xr=this.entranceBloom.indexArray.length-cr;for(let kn=0;kn<Cn;kn++)this.entranceBloom.layoutColorArray.emplaceBack(65535,65535);Dr.vertexLength+=Cn,Dr.primitiveLength+=xr,Ir={part:vr.buildingPart,vertexOffset:nn,vertexLength:Cn}}for(let tn=0;tn<vr.positions.length;tn+=3)$t=Math.max($t,vr.positions[tn+2]),this.layoutVertexArray.emplaceBack(vr.positions[tn],vr.positions[tn+1],vr.positions[tn+2]);for(let tn=0;tn<vr.normals.length;tn+=3)this.layoutNormalArray.emplaceBack(vr.normals[tn+0]*XE,vr.normals[tn+1]*XE,vr.normals[tn+2]*XE);for(let tn=0;tn<vr.ao.length;tn++)this.layoutAOArray.push(vr.ao[tn]);for(let tn=0;tn<vr.colors.length;tn+=3){const Dr=1+(vr.ao[tn/3]-1)*Pe;this.layoutColorArray.emplaceBack(vr.colors[tn]*Dr<<8|vr.colors[tn+1]*Dr,vr.colors[tn+2]*Dr<<8)}const fn=Ft.vertexLength;for(let tn=0;tn<vr.indices.length;tn+=3)this.indexArray.emplaceBack(fn+vr.indices[tn],fn+vr.indices[tn+1],fn+vr.indices[tn+2]);Ft.vertexLength+=vr.positions.length/3,Ft.primitiveLength+=vr.indices.length/3,(vr.buildingPart==="roof"||vr.buildingPart==="wall"||vr.buildingPart==="facade_glazing"||vr.buildingPart==="entrance")&&ir.push({part:vr.buildingPart,vertexOffset:Cr,vertexLength:vr.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,$t),this.buildingFeatures.push({feature:N,segment:Ft,parts:ir,buildingBloom:Ir});const wr=this.indexArray.length-Tr,Mt=[],Xt=[],Fr=new hr(1/0,1/0),Er=new hr(-1/0,-1/0),mn=this.groundEffect.vertexArray.length;for(const vr of wt.modifiedPolygonRings){const Cr=[],fn=new hr(1/0,1/0),tn=new hr(-1/0,-1/0);for(let Dr=0;Dr<vr.length;Dr+=2){const nn=vr.length-Dr-2;fn.x=Math.min(fn.x,vr[nn]),fn.y=Math.min(fn.y,vr[nn+1]),tn.x=Math.max(tn.x,vr[nn]),tn.y=Math.max(tn.y,vr[nn+1]);const Cn=new hr(vr[nn],vr[nn+1]);Cr.push(Cn),Mt.push(Cn.x,Cn.y),Xt.push(Cn.clone())}Fr.x=Math.min(Fr.x,fn.x),Fr.y=Math.min(Fr.y,fn.y),Er.x=Math.max(Er.x,tn.x),Er.y=Math.max(Er.y,tn.y),this.groundEffect.addData(Cr,[fn,tn],Te)}const on=this.groundEffect.vertexArray.length-mn;(ot.x<0||_t.x>Lr||ot.y<0||_t.y>Lr)&&this.featuresOnBorder.push({featureId:T.id,footprintIndex:this.footprints.length});{const vr=J0(Mt,null,2),Cr=new ix(Xt,vr,8,256);let fn=T.id;T.properties&&T.properties.hasOwnProperty("building_id")&&(fn=T.properties.building_id),this.footprints.push({vertices:Xt,indices:vr,grid:Cr,min:Fr,max:Er,buildingId:fn,hiddenFlags:0,indicesOffset:Tr,indicesLength:wr,bloomIndicesOffset:cr,bloomIndicesLength:xr,groundEffectVertexOffset:mn,groundEffectVertexLength:on,segment:Ft,height:$t})}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,T,P,{},s.availableImages,f,s.brightness),this.groundEffect.addPaintPropertiesData(T,P,{},s.availableImages,f,s.brightness)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0])}update(i,s,f,A,g,_,C){this.programConfigurations.updatePaintArrays(i,s,g,f,A,_,C),this.groundEffect.update(i,s,g,f,A,_,C)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,W4.members),this.layoutNormalBuffer=i.createVertexBuffer(this.layoutNormalArray,rK.members),this.entranceBloom.layoutVertexBuffer=i.createVertexBuffer(this.entranceBloom.layoutVertexArray,W4.members),this.entranceBloom.layoutAttenuationBuffer=i.createVertexBuffer(this.entranceBloom.layoutAttenuationArray,nK.members),this.uploadUpdatedColorBuffer(i),this.uploadUpdatedIndexBuffer(i),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.layoutNormalBuffer.destroy(),this.layoutColorBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segmentsBucket.destroy(),this.entranceBloom.layoutVertexBuffer.destroy(),this.entranceBloom.layoutColorBuffer.destroy(),this.entranceBloom.layoutAttenuationBuffer.destroy(),this.entranceBloom.indexBuffer.destroy(),this.entranceBloom.segmentsBucket.destroy())}updateFootprintHiddenFlags(i,s,f=!0){let A=!1;const g=f?s:0,_=0|(f?-1:~s);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const C of i){const T=this.footprints[C],P=T.hiddenFlags&_|g;T.hiddenFlags!==P&&(T.hiddenFlags=P,A=!0,this.groundEffect.updateHiddenByLandmarkRange(T.groundEffectVertexOffset,T.groundEffectVertexLength,T.hiddenFlags!==0))}return A&&(this.indexArrayForConflationUploaded=!1),A}uploadUpdatedIndexBuffer(i){if(this.groundEffect.uploadHiddenByLandmark(i),!this.indexArrayForConflationUploaded&&this.indexArray.length!==0){this.indexArrayForConflation.resize(this.indexArray.length),this.indexArrayForConflation.uint16.set(this.indexArray.uint16),this.entranceBloom.indexArrayForConflation.resize(this.entranceBloom.indexArray.length),this.entranceBloom.indexArrayForConflation.uint16.set(this.entranceBloom.indexArray.uint16);for(const s of this.footprints){const f=s.indicesOffset+s.indicesLength;if(s.hiddenFlags!==0){for(let g=s.indicesOffset;g<f;g++)this.indexArrayForConflation.uint16[3*g+0]=0,this.indexArrayForConflation.uint16[3*g+1]=0,this.indexArrayForConflation.uint16[3*g+2]=0;const A=s.bloomIndicesOffset+s.bloomIndicesLength;for(let g=s.bloomIndicesOffset;g<A;g++)this.entranceBloom.indexArrayForConflation.uint16[3*g+0]=0,this.entranceBloom.indexArrayForConflation.uint16[3*g+1]=0,this.entranceBloom.indexArrayForConflation.uint16[3*g+2]=0}}this.indexBuffer?this.indexBuffer.updateData(this.indexArrayForConflation):this.indexBuffer=i.createIndexBuffer(this.indexArrayForConflation,!0),this.entranceBloom.indexBuffer?this.entranceBloom.indexBuffer.updateData(this.entranceBloom.indexArrayForConflation):this.entranceBloom.indexBuffer=i.createIndexBuffer(this.entranceBloom.indexArrayForConflation,!0),this.indexArrayForConflationUploaded=!0}}uploadUpdatedColorBuffer(i){this.layoutColorBuffer?this.layoutColorBuffer.updateData(this.layoutColorArray):this.layoutColorBuffer=i.createVertexBuffer(this.layoutColorArray,q4.members,!0),this.entranceBloom.layoutColorBuffer?this.entranceBloom.layoutColorBuffer.updateData(this.entranceBloom.layoutColorArray):this.entranceBloom.layoutColorBuffer=i.createVertexBuffer(this.entranceBloom.layoutColorArray,q4.members,!0)}evaluate(i){const s=i.paint.get("building-ambient-occlusion-intensity");for(const f of this.buildingFeatures){const A=f.feature;A.properties["building-part"]="roof";const g=i.paint.get("building-color").evaluate(A,{},this.canonical),_=i.paint.get("building-emissive-strength").evaluate(A,{},this.canonical);A.properties["building-part"]="wall";const C=i.paint.get("building-color").evaluate(A,{},this.canonical),T=i.paint.get("building-emissive-strength").evaluate(A,{},this.canonical);A.properties["building-part"]="window";const P=i.paint.get("building-color").evaluate(A,{},this.canonical),k=i.paint.get("building-emissive-strength").evaluate(A,{},this.canonical);A.properties["building-part"]="door";const N=i.paint.get("building-color").evaluate(A,{},this.canonical),j=i.paint.get("building-emissive-strength").evaluate(A,{},this.canonical);for(const Y of f.parts){let ae,ue=g;Y.part==="roof"?(ue=g,ae=_):Y.part==="wall"?(ue=C,ae=T):Y.part==="facade_glazing"?(ue=P,ae=k):Y.part==="entrance"&&(ue=N,ae=j),ae=je(ae,0,1);for(let ge=0;ge<Y.vertexLength;ge++){const Pe=Y.vertexOffset+ge,Te=1+(this.layoutAOArray[Pe]-1)*s;this.layoutColorArray.emplace(Pe,ue.r*Te*255<<8|ue.g*Te*255,ue.b*Te*255<<8|255*ae)}}const X=f.buildingBloom;if(X)for(let Y=0;Y<X.vertexLength;Y++)this.bloomGeometry.layoutColorArray.emplace(X.vertexOffset+Y,255*N.r<<8|255*N.g,255*N.b<<8|51*j)}}needsEvaluation(i,s){const f=i.transform.projectionOptions,A=i.style.getBrightness();return!(this.uploaded&&f.name===this.projection.name&&this.brightness===A||(this.projection=f,this.brightness=A,0))}updateReplacement(i,s,f){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const A=s.getReplacementRegionsForTile(i.toUnwrapped());if(ox(this.activeReplacements,A))return;this.activeReplacements=A;for(const _ of this.footprints)_.hiddenFlags&=-2;const g=[];for(const _ of this.activeReplacements){if(_.order<=t4)continue;const C=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-i.canonical.z));for(const T of this.footprints)T.min.x>_.max.x||T.max.x<_.min.x||T.min.y>_.max.y||T.max.y<_.min.y||(g.length=0,aK(T.vertices,0,T.vertices.length,_.footprintTileId.canonical,i.canonical,g),PE(_.footprint,g,T.indices,0,T.indices.length,0,-C)&&(T.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const _ of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(_.groundEffectVertexOffset,_.groundEffectVertexLength,_.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getHeightAtTileCoord(i,s){let f=Number.NEGATIVE_INFINITY,A=!0;const g=4*(i+Lr)*Lr+(s+Lr);if(this.footprintLookup.hasOwnProperty(g)){const C=this.footprintLookup[g];return C?{height:C.height,hidden:C.hiddenFlags!==0}:void 0}const _=new hr(i,s);for(const C of this.footprints)i>C.max.x||C.min.x>i||s>C.max.y||C.min.y>s||C.height<=f||LE(_,C)&&(f=C.height,this.footprintLookup[g]=C,A=C.hiddenFlags!==0);if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:A};this.footprintLookup[g]=void 0}}function aK(c,i,s,f,A,g){const _=Math.pow(2,f.z-A.z);for(let C=0;C<s;C++){let T=c[C+i].x,P=c[C+i].y;T=(T+A.x*Lr)*_-f.x*Lr,P=(P+A.y*Lr)*_-f.y*Lr,g.push(new hr(T,P))}}let Z4,Y4;Mr(X4,"BuildingBucket",{omit:["layers"]});const oK=Di([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),sK=Di([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:lK}=oK,cK=Di([{name:"a_packed",components:3,type:"Float32"}]),{members:uK}=cK,hK=Di([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:fK}=hK;class J4{constructor(i,s){this.width=i,this.height=s,this.nextRow=0,this.image=new Ym({width:i,height:s}),this.positions={},this.uploaded=!1}getDash(i,s){const f=this.getKey(i,s);return this.positions[f]}trim(){const i=this.width,s=this.height=St(this.nextRow);this.image.resize({width:i,height:s})}getKey(i,s){return i.join(",")+s}getDashRanges(i,s,f){const A=[];let g=i.length%2==1?-i[i.length-1]*f:0,_=i[0]*f,C=!0;A.push({left:g,right:_,isDash:C,zeroLength:i[0]===0});let T=i[0];for(let P=1;P<i.length;P++){C=!C;const k=i[P];g=T*f,T+=k,_=T*f,A.push({left:g,right:_,isDash:C,zeroLength:k===0})}return A}addRoundDash(i,s,f){const A=s/2;for(let g=-f;g<=f;g++){const _=this.width*(this.nextRow+f+g);let C=0,T=i[C];for(let P=0;P<this.width;P++){P/T.right>1&&(T=i[++C]);const k=Math.abs(P-T.left),N=Math.abs(P-T.right),j=Math.min(k,N);let X;const Y=g/f*(A+1);if(T.isDash){const ae=A-Math.abs(Y);X=Math.sqrt(j*j+ae*ae)}else X=A-Math.sqrt(j*j+Y*Y);this.image.data[_+P]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(i,s){for(let T=i.length-1;T>=0;--T){const P=i[T],k=i[T+1];P.zeroLength?i.splice(T,1):k&&k.isDash===P.isDash&&(k.left=P.left,i.splice(T,1))}const f=i[0],A=i[i.length-1];f.isDash===A.isDash&&(f.left=A.left-this.width,A.right=f.right+this.width);const g=this.width*this.nextRow;let _=0,C=i[_];for(let T=0;T<this.width;T++){T/C.right>1&&(C=i[++_]);const P=Math.abs(T-C.left),k=Math.abs(T-C.right),N=Math.min(P,k);this.image.data[g+T]=Math.max(0,Math.min(255,(C.isDash?N:-N)+s+128))}}addDash(i,s){const f=this.getKey(i,s);if(this.positions[f])return this.positions[f];const A=s==="round",g=A?7:0,_=2*g+1;if(this.nextRow+_>this.height)return Hr("LineAtlas out of space"),null;i.length===0&&i.push(1);let C=0;for(let k=0;k<i.length;k++)i[k]<0&&(Hr("Negative value is found in line dasharray, replacing values with 0"),i[k]=0),C+=i[k];if(C!==0){const k=this.width/C,N=this.getDashRanges(i,this.width,k);A?this.addRoundDash(N,k,g):this.addRegularDash(N,s==="square"?.5*k:0)}const T=this.nextRow+g;this.nextRow+=_;const P={tl:[T,g],br:[C,0]};return this.positions[f]=P,P}}Mr(J4,"LineAtlas");const AK=Ot.types,dK=Math.cos(Math.PI/180*37.5),pK=Math.cos(Math.PI/180*5);class ZE{constructor(i){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=i.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=i.overscaling,this.pixelRatio=i.pixelRatio,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Qp,this.layoutVertexArray2=new Rc,this.patternVertexArray=new Rc,this.indexArray=new Ua,this.programConfigurations=new Pu(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new no,this.maxLineLength=0,this.zOffsetVertexArray=new Rc,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=i.tessellationStep?i.tessellationStep:Lr/64,this.worldview=i.worldview}updateFootprints(i,s){}populate(i,s,f,A){this.hasPattern=BE("line",this.layers,this.pixelRatio,s);const g=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Ye(f);const _=this.layers[0].layout.get("line-elevation-reference");if(_==="hd-road-markup")this.elevationType="road";else{const j=this.layers[0].layout.get("line-z-offset"),X=j.isConstant()&&!j.constantOr(0);this.elevationType=_!=="sea"&&_!=="ground"&&X?"none":"offset",this.elevationType==="offset"&&_==="none"&&Hr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const C=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&C!==void 0;const T=[];for(const{feature:j,id:X,index:Y,sourceLayerIndex:ae}of i){const ue=this.layers[0]._featureFilter.needGeometry,ge=zt(j,ue);if(!this.layers[0]._featureFilter.filter(new oa(this.zoom,{worldview:this.worldview}),ge,f))continue;const Pe=g?g.evaluate(ge,{},f):void 0,Te={id:X,properties:j.properties,type:j.type,sourceLayerIndex:ae,index:Y,geometry:ue?ge.geometry:ht(j,f,A),patterns:{},sortKey:Pe};T.push(Te)}g&&T.sort((j,X)=>j.sortKey-X.sortKey);const{lineAtlas:P,featureIndex:k}=s,N=this.addConstantDashes(P);for(const j of T){const{geometry:X,index:Y,sourceLayerIndex:ae}=j;if(N&&this.addFeatureDashes(j,P),this.hasPattern){const ue=CE("line",this.layers,j,this.zoom,this.pixelRatio,s);this.patternFeatures.push(ue)}else this.addFeature(j,X,Y,f,P.positions,s.availableImages,s.brightness,s.elevationFeatures);k.insert(i[Y].feature,X,Y,ae,this.index)}}addConstantDashes(i){let s=!1;for(const f of this.layers){const A=f.paint.get("line-dasharray").value,g=f.layout.get("line-cap").value;if(A.kind!=="constant"||g.kind!=="constant")s=!0;else{const _=g.value,C=A.value;if(!C)continue;i.addDash(C,_)}}return s}addFeatureDashes(i,s){const f=this.zoom;for(const A of this.layers){const g=A.paint.get("line-dasharray").value,_=A.layout.get("line-cap").value;if(g.kind==="constant"&&_.kind==="constant")continue;let C,T;if(g.kind==="constant"){if(C=g.value,!C)continue}else C=g.evaluate({zoom:f},i);T=_.kind==="constant"?_.value:_.evaluate({zoom:f},i),s.addDash(C,T),i.patterns[A.id]=[s.getKey(C,T)]}}update(i,s,f,A,g,_,C,T){this.programConfigurations.updatePaintArrays(i,s,g,f,A,_,C,T)}addFeatures(i,s,f,A,g,_){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,s,f,A,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,uK)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=i.createVertexBuffer(this.patternVertexArray,fK)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,sK.members,!0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,lK),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,s,f,A,g,_,C,T){const P=this.layers[0].layout,k=P.get("line-join").evaluate(i,{}),N=P.get("line-cap").evaluate(i,{}),j=P.get("line-miter-limit"),X=P.get("line-round-limit");this.lineClips=this.lineFeatureClips(i),this.lineFeature=i,this.zOffsetValue=P.get("line-z-offset").value;const Y=this.layers[0].paint.get("line-width").value;if(Y.kind!=="constant"&&Y.isLineProgressConstant===!1&&(this.variableWidthValue=Y),this.elevationType==="road"){const ae=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(i,s,A,T,k,N,j,X)){const[ue,ge]=this.clipRuntimeLinesToTile(s,1);for(let Pe=0;Pe<ue.length;Pe++){const Te=ue[Pe],Ue=ge[Pe],At={progress:{min:Ue.progress.min,max:Ue.progress.max},nextDir:this.computeSegNextDir(Ue,Te),prevDir:this.computeSegPrevDir(Ue,Te)};this.addLine(Te,i,A,k,N,j,X,At)}this.fillNonElevatedRoadSegment(ae)}}else for(const ae of s)this.addLine(ae,i,A,k,N,j,X);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,g,_,A,C,void 0,this.worldview)}computeSegNextDir(i,s){return i.nextPoint.sub(s.at(-2)).unit()}computeSegPrevDir(i,s){return s[1].sub(i.prevPoint).unit()}clipLinesToTile(i,s){return cx(i,-s,-s,Lr+s,Lr+s)}clipRuntimeLinesToTile(i,s){const f=[];return[cx(i,-s,-s,Lr+s,Lr+s,f),f]}addElevatedRoadFeature(i,s,f,A,g,_,C,T){const P=[],k=io.getElevationFeature(i,A);if(k){const N=this.clipLinesToTile(s,1),j=this.prepareElevatedLines(N,k,f);for(const X of j)P.push({geometry:X,elevation:k,elevationTileID:f,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(P.length===0)return!1;for(const N of P){const j=this.layoutVertexArray.length;this.addLine(N.geometry,i,f,g,_,C,T);const X=new Ki(f,N.elevationTileID);if(N.elevation)for(let Y=j;Y<this.layoutVertexArray.length;Y++){const ae=new hr(this.layoutVertexArray.int16[6*Y]>>1,this.layoutVertexArray.int16[6*Y+1]>>1),ue=X.pointElevation(ae,N.elevation,.05);this.updateHeightRange(ue),this.zOffsetVertexArray.emplaceBack(ue,0,0)}else this.fillNonElevatedRoadSegment(j)}return!0}prepareElevatedLines(i,s,f){if(s.constantHeight!=null)return i;const A=[],g=1/Ye(f);for(const _ of i)LG(_,new Aa(s,g),0,A);return A}fillNonElevatedRoadSegment(i){for(let s=i;s<this.layoutVertexArray.length;s++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(i){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,i),this.heightRange.max=Math.max(this.heightRange.max,i)):this.heightRange={min:i,max:i}}addLine(i,s,f,A,g,_,C,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const P=A==="none";this.patternJoinNone=this.hasPattern&&P,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const k=T&&T.progress.min>0,N=T&&T.progress.max<1;if(this.lineClips){let _t={min:this.lineClips.start,max:this.lineClips.end},wt=1;if(T){const ir=this.lineClips.end-this.lineClips.start;_t=function(Ir,cr,xr){return{min:so(Ir.min,cr,xr),max:so(Ir.max,cr,xr)}}(T.progress,{min:0,max:1},_t),ir>0&&(wt=(_t.max-_t.min)/ir)}const Yt=+s.properties.mapbox_clip_feature_len,Ft=+s.properties.mapbox_clip_seg_len;if(Number.isNaN(Yt)||Number.isNaN(Ft)){for(let Ir=0;Ir<i.length-1;Ir++)this.totalDistance+=i[Ir].dist(i[Ir+1]);const ir=this.totalDistance/(_t.max-_t.min);this.totalFeatureLength=Number.isFinite(ir)?ir:0,this.lineClips.start=_t.min,this.lineClips.end=_t.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Yt,this.distance=Ft*wt,this.lineClips.start=_t.min,this.lineClips.end=_t.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const j=AK[s.type]==="Polygon";let X=i.length;for(;X>=2&&i[X-1].equals(i[X-2]);)X--;let Y=0;for(;Y<X-1&&i[Y].equals(i[Y+1]);)Y++;if(X<(j?3:2))return;A==="bevel"&&(_=1.05);const ae=this.segments.prepareSegment(10*X,this.layoutVertexArray,this.indexArray);let ue,ge,Pe,Te,Ue,At,at,ot;T&&T.prevDir&&(At=T.prevDir.perp()),T&&T.nextDir&&(at=T.nextDir.perp()),this.e1=this.e2=-1,j&&(ue=i[X-2],Ue=i[Y].sub(ue)._unit()._perp());for(let _t=Y;_t<X;_t++){if(Pe=_t===X-1?j?i[Y+1]:void 0:i[_t+1],Pe&&i[_t].equals(Pe))continue;Ue&&(Te=Ue),ue&&(ge=ue),ue=i[_t],ot=this.evaluateLineProgressFeatures(ge?ge.dist(ue):0),Ue=Pe?Pe.sub(ue)._unit()._perp():Te,Te=Te||Ue;const wt=ge&&Pe;let Yt=wt?A:j||P?"butt":g;const Ft=Te.x*Ue.x+Te.y*Ue.y;if(P){const Mt=function(Xt){if(Xt.patternJoinNone){const Fr=Xt.segmentPoints.length/2,Er=Xt.lineSoFar-Xt.segmentStart;for(let mn=0;mn<Fr;++mn){const on=Xt.segmentPoints[2*mn+1],vr=Math.round(Xt.segmentPoints[2*mn])+.5+.25*on;Xt.patternVertexArray.emplaceBack(vr,Er,Xt.segmentStart),Xt.patternVertexArray.emplaceBack(vr,Er,Xt.segmentStart)}Xt.segmentPoints.length=0}Xt.e1=Xt.e2=-1};if(wt&&Ft<pK){this.updateDistance(ge,ue),this.addCurrentVertex(ue,Te,1,1,ae,ot),Mt(this),this.addCurrentVertex(ue,Ue,-1,-1,ae,ot);continue}if(ge){if(!Pe){this.updateDistance(ge,ue),this.addCurrentVertex(ue,Te,1,1,ae,ot),Mt(this);continue}Yt="miter"}}let ir=Te.add(Ue);ir.x===0&&ir.y===0||ir._unit();const Ir=ir.x*Ue.x+ir.y*Ue.y,cr=Ir!==0?1/Ir:1/0,xr=2*Math.sqrt(2-2*Ir),Tr=Ir<dK&&ge&&Pe,$t=Te.x*Ue.y-Te.y*Ue.x>0,wr=this.overscaling<=16?15*Lr/(512*this.overscaling):0;if(wt&&Yt==="round"){if(cr<C)Yt="miter";else if(cr<=2){const Mt=YE(ue,-10,Lr+10);Yt=this.elevationType==="offset"&&(Mt||this.hasCrossSlope)?"miter":"fakeround"}}if(Yt==="miter"&&cr>_&&(Yt="bevel"),Yt==="bevel"&&(cr>2&&(Yt="flipbevel"),cr<_&&(Yt="miter")),ge&&!(Yt==="miter"&&Tr)&&this.updateDistance(ge,ue),Yt==="miter")if(Tr){const Mt=ue.dist(ge);if(Mt>2*wr){const Fr=ue.sub(ue.sub(ge)._mult(wr/Mt)._round());this.updateDistance(ge,Fr),this.addCurrentVertex(Fr,Te,0,0,ae,ot),ge=Fr}this.updateDistance(ge,ue),ir._mult(cr),this.addCurrentVertex(ue,ir,0,0,ae,ot);const Xt=ue.dist(Pe);if(Xt>2*wr){const Fr=ue.add(Pe.sub(ue)._mult(wr/Xt)._round());this.updateDistance(ue,Fr),this.addCurrentVertex(Fr,Ue,0,0,ae,ot),ue=Fr}}else ir._mult(cr),this.addCurrentVertex(ue,ir,0,0,ae,ot);else if(Yt==="flipbevel"){if(cr>100)ir=Ue.mult(-1);else{const Mt=cr*Te.add(Ue).mag()/Te.sub(Ue).mag();ir._perp()._mult(Mt*($t?-1:1))}this.addCurrentVertex(ue,ir,0,0,ae,ot),this.addCurrentVertex(ue,ir.mult(-1),0,0,ae,ot)}else if(Yt==="bevel"||Yt==="fakeround"){ot!=null&&ge&&this.addCurrentVertex(ue,at||Te,-1,-1,ae,ot);const Mt=ue.dist(ge)<=2*wr&&Yt!=="bevel",Xt=ir.mult($t?1:-1);Xt._mult(cr);const Fr=Ue.mult($t?-1:1),Er=Te.mult($t?-1:1),mn=this.evaluateLineProgressFeatures(this.distance);if(ot==null&&(this.addHalfVertex(ue,Xt.x,Xt.y,!1,!$t,0,ae,mn),Mt||this.addHalfVertex(ue,Xt.x+2*Er.x,Xt.y+2*Er.y,!1,$t,0,ae,mn)),Yt==="fakeround"){const on=Math.round(180*xr/Math.PI/20);this.addHalfVertex(ue,Er.x,Er.y,!1,$t,0,ae,mn);for(let vr=0;vr<on;vr++){let Cr=vr/on;if(Cr!==.5){const tn=Cr-.5;Cr+=Cr*tn*(Cr-1)*((1.0904+Ft*(Ft*(3.55645-1.43519*Ft)-3.2452))*tn*tn+(.848013+Ft*(.215638*Ft-1.06021)))}const fn=Fr.sub(Er)._mult(Cr)._add(Er)._unit();this.addHalfVertex(ue,fn.x,fn.y,!1,$t,0,ae,mn)}this.addHalfVertex(ue,Fr.x,Fr.y,!1,$t,0,ae,mn)}Mt||ot!=null||this.addHalfVertex(ue,Xt.x+2*Fr.x,Xt.y+2*Fr.y,!1,$t,0,ae,mn),ot!=null&&Pe&&this.addCurrentVertex(ue,At||Ue,1,1,ae,ot)}else if(Yt==="butt")this.addCurrentVertex(ue,ir,0,0,ae,ot);else if(Yt==="square"){if(!ge){const Mt=k?0:-1;this.addCurrentVertex(ue,ir,Mt,Mt,ae,ot)}if(this.addCurrentVertex(ue,ir,0,0,ae,ot),ge){const Mt=N?0:1;this.addCurrentVertex(ue,ir,Mt,Mt,ae,ot)}}else if(Yt==="round"){if(ge){const Mt=!wt&&at?at:Te;this.addCurrentVertex(ue,Mt,0,0,ae,ot),!wt&&N||this.addCurrentVertex(ue,Mt,1,1,ae,ot,!0)}if(Pe){const Mt=!wt&&At?At:Ue;!wt&&k||this.addCurrentVertex(ue,Mt,-1,-1,ae,ot,!0),this.addCurrentVertex(ue,Mt,0,0,ae,ot)}}}}addVerticesTo(i,s,f,A,g,_,C,T,P,k){const N=(s.w-i.w)/this.tessellationStep|0;let j=0;const X=this.scaledDistance;if(N>1){this.lineSoFar=i.w;const ae=(s.x-i.x)/N,ue=(s.y-i.y)/N,ge=(s.z-i.z)/N,Pe=(s.w-i.w)/N;for(let Te=1;Te<N;++Te){i.x+=ae,i.y+=ue,i.z+=ge,this.lineSoFar+=Pe,j+=Pe;const Ue=this.evaluateLineProgressFeatures(this.prevDistance+j);this.scaledDistance=(this.prevDistance+j)/this.totalDistance,this.addHalfVertex(i,f,A,k,!1,C,P,Ue),this.addHalfVertex(i,g,_,k,!0,-T,P,Ue)}}this.lineSoFar=s.w,this.scaledDistance=X;const Y=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(s,f,A,k,!1,C,P,Y),this.addHalfVertex(s,g,_,k,!0,-T,P,Y)}evaluateLineProgressFeatures(i){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+i)/this.totalFeatureLength):Hr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let s=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(s=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:s}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:s}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:s}}addCurrentVertex(i,s,f,A,g,_,C=!1){const T=s.x+s.y*f,P=s.y-s.x*f,k=s.y*A-s.x,N=-s.y-s.x*A;if(_!=null){const j=this.elevationType==="offset",X=-10,Y=Lr+10,ae=_.zOffset,ue=new w4(i.x,i.y,ae,this.lineSoFar),ge=!!j&&YE(i,X,Y),Pe=this.lineSoFar,Te=this.distance;if(this.currentVertex)if(ge){const Ue=this.currentVertexIsOutside,At=this.currentVertex,at=new w4(i.x,i.y,ae,this.lineSoFar);if(E4(At,at,X,Y),!YE(at,X,Y)){if(Ue){this.e1=this.e2=-1,this.distance-=At.dist(ue),this.lineSoFar=At.w;const ot=this.evaluateLineProgressFeatures(At.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(At,T,P,C,!1,f,g,ot),this.addHalfVertex(At,k,N,C,!0,-A,g,ot),this.prevDistance=this.distance}this.distance=this.prevDistance+At.dist(at),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(At,at,T,P,k,N,f,A,g,C),this.distance=Te,this.scaledDistance=this.distance/this.totalDistance}}else{const Ue=this.currentVertex;if(this.currentVertexIsOutside){E4(Ue,ue,X,Y),this.e1=this.e2=-1,this.distance-=Ue.dist(ue),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=Ue.w;const At=this.evaluateLineProgressFeatures(Ue.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ue,T,P,C,!1,f,g,At),this.addHalfVertex(Ue,k,N,C,!0,-A,g,At),this.prevDistance=this.distance,this.distance=Te,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(Ue,ue,T,P,k,N,f,A,g,C)}else ge||(this.addHalfVertex(i,T,P,C,!1,f,g,_),this.addHalfVertex(i,k,N,C,!0,-A,g,_));this.currentVertex=ue,this.currentVertexIsOutside=ge,this.lineSoFar=Pe}else this.addHalfVertex(i,T,P,C,!1,f,g,_),this.addHalfVertex(i,k,N,C,!0,-A,g,_)}addHalfVertex({x:i,y:s},f,A,g,_,C,T,P){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,C)),this.layoutVertexArray.emplaceBack((i<<1)+(g?1:0),(s<<1)+(_?1:0),Math.round(63*f)+128,Math.round(63*A)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const N=tr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,N)}const k=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),T.primitiveLength++),_?this.e2=k:this.e1=k,P!=null&&this.zOffsetVertexArray.emplaceBack(P.zOffset,P.variableWidth,P.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(i,s){this.prevDistance=this.distance,this.distance+=i.dist(s),this.updateScaledDistance()}}function YE(c,i,s){return c.x<i||c.x>s||c.y<i||c.y>s}let eP,tP;function rP(c,i,s){return i*(Lr/(c.tileSize*Math.pow(2,s-c.tileID.overscaledZ)))}Mr(ZE,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const nP=(c,i,s)=>(1-s)*c+s*i;function iP(c,i){return 1/rP(c,1,i.tileZoom)}function aP(c,i,s,f){return c.translatePosMatrix(f||i.tileID.projMatrix,i,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const oP=c=>{const i=[];sP(c)&&i.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const s=c.paint.get("line-trim-offset");s[0]===0&&s[1]===0||i.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&i.push("RENDER_LINE_BORDER");const f=c.layout.get("line-join").constantOr("miter")==="none",A=!!c.paint.get("line-pattern").constantOr(1);return f&&A&&i.push("LINE_JOIN_NONE"),i};function sP(c){const i=c.paint.get("line-dasharray").value;return i.value||i.kind!=="constant"}let JE;const lP=()=>JE||(JE={layout:eP||(eP=new _a({"line-cap":new Kr(Bt.layout_line["line-cap"]),"line-join":new Kr(Bt.layout_line["line-join"]),"line-miter-limit":new ur(Bt.layout_line["line-miter-limit"]),"line-round-limit":new ur(Bt.layout_line["line-round-limit"]),"line-sort-key":new Kr(Bt.layout_line["line-sort-key"]),"line-z-offset":new Kr(Bt.layout_line["line-z-offset"]),"line-elevation-reference":new ur(Bt.layout_line["line-elevation-reference"]),"line-cross-slope":new ur(Bt.layout_line["line-cross-slope"]),visibility:new ur(Bt.layout_line.visibility),"line-width-unit":new ur(Bt.layout_line["line-width-unit"])})),paint:tP||(tP=new _a({"line-opacity":new Kr(Bt.paint_line["line-opacity"]),"line-color":new Kr(Bt.paint_line["line-color"]),"line-translate":new ur(Bt.paint_line["line-translate"]),"line-translate-anchor":new ur(Bt.paint_line["line-translate-anchor"]),"line-width":new Kr(Bt.paint_line["line-width"]),"line-gap-width":new Kr(Bt.paint_line["line-gap-width"]),"line-offset":new Kr(Bt.paint_line["line-offset"]),"line-blur":new Kr(Bt.paint_line["line-blur"]),"line-dasharray":new Kr(Bt.paint_line["line-dasharray"]),"line-pattern":new Kr(Bt.paint_line["line-pattern"]),"line-pattern-cross-fade":new ur(Bt.paint_line["line-pattern-cross-fade"]),"line-gradient":new Eh(Bt.paint_line["line-gradient"]),"line-trim-offset":new ur(Bt.paint_line["line-trim-offset"]),"line-trim-fade-range":new ur(Bt.paint_line["line-trim-fade-range"]),"line-trim-color":new ur(Bt.paint_line["line-trim-color"]),"line-emissive-strength":new ur(Bt.paint_line["line-emissive-strength"]),"line-border-width":new Kr(Bt.paint_line["line-border-width"]),"line-border-color":new Kr(Bt.paint_line["line-border-color"]),"line-occlusion-opacity":new ur(Bt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},JE);class mK extends Kr{possiblyEvaluate(i,s){return s=new oa(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition,worldview:s.worldview}),super.possiblyEvaluate(i,s)}evaluate(i,s,f,A){return s=xe({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(i,s,f,A)}}let Xv;function cP(c,i){return i>0?i+2*c:c}const gK=Di([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_K=Di([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),vK=Di([{name:"a_projected_pos",components:4,type:"Float32"}],4);Di([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const yK=Di([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),xK=Di([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),wK=Di([{name:"a_texb",components:2,type:"Uint16"}]),bK=Di([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),EK=Di([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const uP=Di([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),BK=Di([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Di([{name:"triangle",components:3,type:"Uint16"}]),Di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Di([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Di([{type:"Float32",name:"offsetX"}]),Di([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Wl=24;function CK(c,i,s){return c.sections.forEach(f=>{f.text=function(A,g,_){const C=g.layout.get("text-transform").evaluate(_,{});return C==="uppercase"?A=A.toLocaleUpperCase():C==="lowercase"&&(A=A.toLocaleLowerCase()),au.applyArabicShaping&&(A=au.applyArabicShaping(A)),A}(f.text,i,s)}),c}const Zv={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function SK(c){return c==="︶"||c==="﹈"||c==="︸"||c==="﹄"||c==="﹂"||c==="︾"||c==="︼"||c==="︺"||c==="︘"||c==="﹀"||c==="︐"||c==="︓"||c==="︔"||c==="｀"||c==="￣"||c==="︑"||c==="︒"}function TK(c){return c==="︵"||c==="﹇"||c==="︷"||c==="﹃"||c==="﹁"||c==="︽"||c==="︻"||c==="︹"||c==="︗"||c==="︿"}const eB=4294967296,hP=1/eB,fP=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let gx=class{constructor(c=new Uint8Array(16)){this.buf=ArrayBuffer.isView(c)?c:new Uint8Array(c),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(c,i,s=this.length){for(;this.pos<s;){const f=this.readVarint(),A=f>>3,g=this.pos;this.type=7&f,c(A,i,this),this.pos===g&&this.skip(f)}return i}readMessage(c,i){return this.readFields(c,i,this.readVarint()+this.pos)}readFixed32(){const c=this.dataView.getUint32(this.pos,!0);return this.pos+=4,c}readSFixed32(){const c=this.dataView.getInt32(this.pos,!0);return this.pos+=4,c}readFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*eB;return this.pos+=8,c}readSFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*eB;return this.pos+=8,c}readFloat(){const c=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,c}readDouble(){const c=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,c}readVarint(c){const i=this.buf;let s,f;return f=i[this.pos++],s=127&f,f<128?s:(f=i[this.pos++],s|=(127&f)<<7,f<128?s:(f=i[this.pos++],s|=(127&f)<<14,f<128?s:(f=i[this.pos++],s|=(127&f)<<21,f<128?s:(f=i[this.pos],s|=(15&f)<<28,function(A,g,_){const C=_.buf;let T,P;if(P=C[_.pos++],T=(112&P)>>4,P<128||(P=C[_.pos++],T|=(127&P)<<3,P<128)||(P=C[_.pos++],T|=(127&P)<<10,P<128)||(P=C[_.pos++],T|=(127&P)<<17,P<128)||(P=C[_.pos++],T|=(127&P)<<24,P<128)||(P=C[_.pos++],T|=(1&P)<<31,P<128))return o_(A,T,g);throw new Error("Expected varint not more than 10 bytes")}(s,c,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const c=this.readVarint();return c%2==1?(c+1)/-2:c/2}readBoolean(){return!!this.readVarint()}readString(){const c=this.readVarint()+this.pos,i=this.pos;return this.pos=c,c-i>=12&&fP?fP.decode(this.buf.subarray(i,c)):function(s,f,A){let g="",_=f;for(;_<A;){const C=s[_];let T,P,k,N=null,j=C>239?4:C>223?3:C>191?2:1;if(_+j>A)break;j===1?C<128&&(N=C):j===2?(T=s[_+1],(192&T)==128&&(N=(31&C)<<6|63&T,N<=127&&(N=null))):j===3?(T=s[_+1],P=s[_+2],(192&T)==128&&(192&P)==128&&(N=(15&C)<<12|(63&T)<<6|63&P,(N<=2047||N>=55296&&N<=57343)&&(N=null))):j===4&&(T=s[_+1],P=s[_+2],k=s[_+3],(192&T)==128&&(192&P)==128&&(192&k)==128&&(N=(15&C)<<18|(63&T)<<12|(63&P)<<6|63&k,(N<=65535||N>=1114112)&&(N=null))),N===null?(N=65533,j=1):N>65535&&(N-=65536,g+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),g+=String.fromCharCode(N),_+=j}return g}(this.buf,i,c)}readBytes(){const c=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,c);return this.pos=c,i}readPackedVarint(c=[],i){const s=this.readPackedEnd();for(;this.pos<s;)c.push(this.readVarint(i));return c}readPackedSVarint(c=[]){const i=this.readPackedEnd();for(;this.pos<i;)c.push(this.readSVarint());return c}readPackedBoolean(c=[]){const i=this.readPackedEnd();for(;this.pos<i;)c.push(this.readBoolean());return c}readPackedFloat(c=[]){const i=this.readPackedEnd();for(;this.pos<i;)c.push(this.readFloat());return c}readPackedDouble(c=[]){const i=this.readPackedEnd();for(;this.pos<i;)c.push(this.readDouble());return c}readPackedFixed32(c=[]){const i=this.readPackedEnd();for(;this.pos<i;)c.push(this.readFixed32());return c}readPackedSFixed32(c=[]){const i=this.readPackedEnd();for(;this.pos<i;)c.push(this.readSFixed32());return c}readPackedFixed64(c=[]){const i=this.readPackedEnd();for(;this.pos<i;)c.push(this.readFixed64());return c}readPackedSFixed64(c=[]){const i=this.readPackedEnd();for(;this.pos<i;)c.push(this.readSFixed64());return c}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(c){const i=7&c;if(i===0)for(;this.buf[this.pos++]>127;);else if(i===2)this.pos=this.readVarint()+this.pos;else if(i===5)this.pos+=4;else{if(i!==1)throw new Error(`Unimplemented type: ${i}`);this.pos+=8}}writeTag(c,i){this.writeVarint(c<<3|i)}realloc(c){let i=this.length||16;for(;i<this.pos+c;)i*=2;if(i!==this.length){const s=new Uint8Array(i);s.set(this.buf),this.buf=s,this.dataView=new DataView(s.buffer),this.length=i}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeSFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*hP),!0),this.pos+=8}writeSFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*hP),!0),this.pos+=8}writeVarint(c){(c=+c||0)>268435455||c<0?function(i,s){let f,A;if(i>=0?(f=i%4294967296|0,A=i/4294967296|0):(f=~(-i%4294967296),A=~(-i/4294967296),4294967295^f?f=f+1|0:(f=0,A=A+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(g,_,C){C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,C.buf[C.pos]=127&(g>>>=7)}(f,0,s),function(g,_){const C=(7&g)<<4;_.buf[_.pos++]|=C|((g>>>=3)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g)))))}(A,s)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))}writeSVarint(c){this.writeVarint(c<0?2*-c-1:2*c)}writeBoolean(c){this.writeVarint(+c)}writeString(c){c=String(c),this.realloc(4*c.length),this.pos++;const i=this.pos;this.pos=function(f,A,g){for(let _,C,T=0;T<A.length;T++){if(_=A.charCodeAt(T),_>55295&&_<57344){if(!C){_>56319||T+1===A.length?(f[g++]=239,f[g++]=191,f[g++]=189):C=_;continue}if(_<56320){f[g++]=239,f[g++]=191,f[g++]=189,C=_;continue}_=C-55296<<10|_-56320|65536,C=null}else C&&(f[g++]=239,f[g++]=191,f[g++]=189,C=null);_<128?f[g++]=_:(_<2048?f[g++]=_>>6|192:(_<65536?f[g++]=_>>12|224:(f[g++]=_>>18|240,f[g++]=_>>12&63|128),f[g++]=_>>6&63|128),f[g++]=63&_|128)}return g}(this.buf,c,this.pos);const s=this.pos-i;s>=128&&AP(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s}writeFloat(c){this.realloc(4),this.dataView.setFloat32(this.pos,c,!0),this.pos+=4}writeDouble(c){this.realloc(8),this.dataView.setFloat64(this.pos,c,!0),this.pos+=8}writeBytes(c){const i=c.length;this.writeVarint(i),this.realloc(i);for(let s=0;s<i;s++)this.buf[this.pos++]=c[s]}writeRawMessage(c,i){this.pos++;const s=this.pos;c(i,this);const f=this.pos-s;f>=128&&AP(s,f,this),this.pos=s-1,this.writeVarint(f),this.pos+=f}writeMessage(c,i,s){this.writeTag(c,2),this.writeRawMessage(i,s)}writePackedVarint(c,i){i.length&&this.writeMessage(c,IK,i)}writePackedSVarint(c,i){i.length&&this.writeMessage(c,FK,i)}writePackedBoolean(c,i){i.length&&this.writeMessage(c,MK,i)}writePackedFloat(c,i){i.length&&this.writeMessage(c,PK,i)}writePackedDouble(c,i){i.length&&this.writeMessage(c,LK,i)}writePackedFixed32(c,i){i.length&&this.writeMessage(c,OK,i)}writePackedSFixed32(c,i){i.length&&this.writeMessage(c,DK,i)}writePackedFixed64(c,i){i.length&&this.writeMessage(c,RK,i)}writePackedSFixed64(c,i){i.length&&this.writeMessage(c,kK,i)}writeBytesField(c,i){this.writeTag(c,2),this.writeBytes(i)}writeFixed32Field(c,i){this.writeTag(c,5),this.writeFixed32(i)}writeSFixed32Field(c,i){this.writeTag(c,5),this.writeSFixed32(i)}writeFixed64Field(c,i){this.writeTag(c,1),this.writeFixed64(i)}writeSFixed64Field(c,i){this.writeTag(c,1),this.writeSFixed64(i)}writeVarintField(c,i){this.writeTag(c,0),this.writeVarint(i)}writeSVarintField(c,i){this.writeTag(c,0),this.writeSVarint(i)}writeStringField(c,i){this.writeTag(c,2),this.writeString(i)}writeFloatField(c,i){this.writeTag(c,5),this.writeFloat(i)}writeDoubleField(c,i){this.writeTag(c,1),this.writeDouble(i)}writeBooleanField(c,i){this.writeVarintField(c,+i)}};function o_(c,i,s){return s?4294967296*i+(c>>>0):4294967296*(i>>>0)+(c>>>0)}function AP(c,i,s){const f=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));s.realloc(f);for(let A=s.pos-1;A>=c;A--)s.buf[A+f]=s.buf[A]}function IK(c,i){for(let s=0;s<c.length;s++)i.writeVarint(c[s])}function FK(c,i){for(let s=0;s<c.length;s++)i.writeSVarint(c[s])}function PK(c,i){for(let s=0;s<c.length;s++)i.writeFloat(c[s])}function LK(c,i){for(let s=0;s<c.length;s++)i.writeDouble(c[s])}function MK(c,i){for(let s=0;s<c.length;s++)i.writeBoolean(c[s])}function OK(c,i){for(let s=0;s<c.length;s++)i.writeFixed32(c[s])}function DK(c,i){for(let s=0;s<c.length;s++)i.writeSFixed32(c[s])}function RK(c,i){for(let s=0;s<c.length;s++)i.writeFixed64(c[s])}function kK(c,i){for(let s=0;s<c.length;s++)i.writeSFixed64(c[s])}const tB=3;function UK(c,i,s){i.glyphs=[],c===1&&s.readMessage(NK,i)}function NK(c,i,s){if(c===3){const{id:f,bitmap:A,width:g,height:_,left:C,top:T,advance:P}=s.readMessage(zK,{});i.glyphs.push({id:f,bitmap:new Ym({width:g+2*tB,height:_+2*tB},A),metrics:{width:g,height:_,left:C,top:T,advance:P}})}else c===4?i.ascender=s.readSVarint():c===5&&(i.descender=s.readSVarint())}function zK(c,i,s){c===1?i.id=s.readVarint():c===2?i.bitmap=s.readBytes():c===3?i.width=s.readVarint():c===4?i.height=s.readVarint():c===5?i.left=s.readSVarint():c===6?i.top=s.readSVarint():c===7&&(i.advance=s.readVarint())}const dP=tB,nf={horizontal:1,vertical:2,horizontalOnly:3};class Yv{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(i,s){const f=new Yv;return f.scale=i||1,f.fontStack=s,f}static forImage(i){const s=new Yv;return s.image=i,s}}class s_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,s,f){const A=new s_;for(let g=0;g<i.sections.length;g++){const _=i.sections[g];_.image?A.addImageSection(_,f):A.addTextSection(_,s)}return A}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=function(s,f){let A="";for(let g=0;g<s.length;g++){const _=s.charCodeAt(g+1)||null,C=s.charCodeAt(g-1)||null;A+=!f&&(_&&cc(_)&&!Zv[s[g+1]]||C&&cc(C)&&!Zv[s[g-1]])||!Zv[s[g]]?s[g]:Zv[s[g]]}return A}(this.text,i)}trim(){let i=0;for(let f=0;f<this.text.length&&_x[this.text.charCodeAt(f)];f++)i++;let s=this.text.length;for(let f=this.text.length-1;f>=0&&f>=i&&_x[this.text.charCodeAt(f)];f--)s--;this.text=this.text.substring(i,s),this.sectionIndex=this.sectionIndex.slice(i,s)}substring(i,s){const f=new s_;return f.text=this.text.substring(i,s),f.sectionIndex=this.sectionIndex.slice(i,s),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,s)=>Math.max(i,this.sections[s].scale),0)}addTextSection(i,s){this.text+=i.text,this.sections.push(Yv.forText(i.scale,i.fontStack||s));const f=this.sections.length-1;for(let A=0;A<i.text.length;++A)this.sectionIndex.push(f)}addImageSection(i,s){const f=i.image?i.image.getPrimary():null;if(!f)return void Hr("Can't add FormattedSection with an empty image.");f.scaleSelf(s);const A=this.getNextImageSectionCharCode();A?(this.text+=String.fromCodePoint(A),this.sections.push(Yv.forImage(f)),this.sectionIndex.push(this.sections.length-1)):Hr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function rB(c,i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae=1){const ue=s_.fromFeature(c,A,ae);N===nf.vertical&&ue.verticalizePunctuation(j);let ge=[];const Pe=function(ot,_t,wt,Yt,Ft,ir){if(!ot)return[];const Ir=[],cr=function(wr,Mt,Xt,Fr,Er,mn){let on=0;for(let vr=0;vr<wr.length();vr++){const Cr=wr.getSection(vr);on+=pP(wr.getCodePoint(vr),Cr,Fr,Er,Mt,mn)}return on/Math.max(1,Math.ceil(on/Xt))}(ot,_t,wt,Yt,Ft,ir),xr=ot.text.indexOf("​")>=0;let Tr=0;for(let wr=0;wr<ot.length();wr++){const Mt=ot.getSection(wr),Xt=ot.getCodePoint(wr);if(_x[Xt]||(Tr+=pP(Xt,Mt,Yt,Ft,_t,ir)),wr<ot.length()-1){const Fr=!(($t=Xt)<11904||!(hn["Bopomofo Extended"]($t)||hn.Bopomofo($t)||hn["CJK Compatibility Forms"]($t)||hn["CJK Compatibility Ideographs"]($t)||hn["CJK Compatibility"]($t)||hn["CJK Radicals Supplement"]($t)||hn["CJK Strokes"]($t)||hn["CJK Symbols and Punctuation"]($t)||hn["CJK Unified Ideographs Extension A"]($t)||hn["CJK Unified Ideographs"]($t)||hn["Enclosed CJK Letters and Months"]($t)||hn["Halfwidth and Fullwidth Forms"]($t)||hn.Hiragana($t)||hn["Ideographic Description Characters"]($t)||hn["Kangxi Radicals"]($t)||hn["Katakana Phonetic Extensions"]($t)||hn.Katakana($t)||hn["Vertical Forms"]($t)||hn["Yi Radicals"]($t)||hn["Yi Syllables"]($t)));(QK[Xt]||Fr||Mt.image)&&Ir.push(gP(wr+1,Tr,cr,Ir,jK(Xt,ot.getCodePoint(wr+1),Fr&&xr),!1))}}var $t;return _P(gP(ot.length(),Tr,cr,Ir,0,!0))}(ue,P,g,i,f,X),{processBidirectionalText:Te,processStyledBidirectionalText:Ue}=au;if(Te&&ue.sections.length===1){const ot=Te(ue.toString(),Pe);for(const _t of ot){const wt=new s_;wt.text=_t,wt.sections=ue.sections;for(let Yt=0;Yt<_t.length;Yt++)wt.sectionIndex.push(0);ge.push(wt)}}else if(Ue){const ot=Ue(ue.text,ue.sectionIndex,Pe);for(const _t of ot){const wt=new s_;wt.text=_t[0],wt.sectionIndex=_t[1],wt.sections=ue.sections,ge.push(wt)}}else ge=function(ot,_t){const wt=[],Yt=ot.text;let Ft=0;for(const ir of _t)wt.push(ot.substring(Ft,ir)),Ft=ir;return Ft<Yt.length&&wt.push(ot.substring(Ft,Yt.length)),wt}(ue,Pe);const At=[],at={positionedLines:At,text:ue.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(ot,_t,wt,Yt,Ft,ir,Ir,cr,xr,Tr,$t,wr){let Mt=0,Xt=0,Fr=0;const Er=cr==="right"?1:cr==="left"?0:.5;let mn=!1;for(const Dr of Ft){const nn=Dr.getSections();for(const Cn of nn){if(Cn.image)continue;const kn=_t[Cn.fontStack];if(kn&&(mn=kn.ascender!==void 0&&kn.descender!==void 0,!mn))break}if(!mn)break}let on=0;for(const Dr of Ft){Dr.trim();const nn=Dr.getMaxScale(),Cn=(nn-1)*Wl,kn={positionedGlyphs:[],lineOffset:0};ot.positionedLines[on]=kn;const li=kn.positionedGlyphs;let $n=0;if(!Dr.length()){Xt+=ir,++on;continue}let zi=0,xi=0;for(let Ge=0;Ge<Dr.length();Ge++){const Ke=Dr.getSection(Ge),Kt=Dr.getSectionIndex(Ge),Pr=Dr.getCodePoint(Ge);let Vr=Ke.scale,jr=null,un=null,Mn=null,Fi=Wl,Pi=0,mi=xr;mi===nf.vertical&&((vr=Pr)===12312||vr===12313||vr===12316||vr===12540||vr===12448)&&(mi=nf.horizontal);const Sa=!(mi===nf.horizontal||!$t&&!el(Pr)||$t&&(_x[Pr]||Su(Pr)));if(Ke.image){const Eo=Yt.get(Ke.image.toString());if(!Eo)continue;Mn=Ke.image,ot.iconsInText=ot.iconsInText||!0,un=Eo.paddedRect;const Ai=Eo.displaySize;Vr=Vr*Wl/wr,jr={width:Ai[0],height:Ai[1],left:0,top:-dP,advance:Sa?Ai[1]:Ai[0],localGlyph:!1},Pi=mn?-jr.height*Vr:nn*Wl-17-Ai[1]*Vr,Fi=jr.advance;const Ja=(Sa?Ai[0]:Ai[1])*Vr-Wl*nn;Ja>0&&Ja>$n&&($n=Ja)}else{const Eo=wt[Ke.fontStack];if(!Eo)continue;Eo[Pr]&&(un=Eo[Pr]);const Ai=_t[Ke.fontStack];if(!Ai)continue;const Ja=Ai.glyphs[Pr];if(!Ja)continue;if(jr=Ja.metrics,Fi=Pr!==8203?Wl:0,mn){const Na=Ai.ascender!==void 0?Math.abs(Ai.ascender):0,da=Ai.descender!==void 0?Math.abs(Ai.descender):0,vo=(Na+da)*Vr;zi<vo&&(zi=vo,xi=(Na-da)/2*Vr),Pi=-Na*Vr}else Pi=(nn-Vr)*Wl-17}Sa?(ot.verticalizable=!0,li.push({glyph:Pr,image:Mn,x:Mt,y:Xt+Pi,vertical:Sa,scale:Vr,localGlyph:jr.localGlyph,fontStack:Ke.fontStack,sectionIndex:Kt,metrics:jr,rect:un}),Mt+=Fi*Vr+Tr):(li.push({glyph:Pr,image:Mn,x:Mt,y:Xt+Pi,vertical:Sa,scale:Vr,localGlyph:jr.localGlyph,fontStack:Ke.fontStack,sectionIndex:Kt,metrics:jr,rect:un}),Mt+=jr.advance*Vr+Tr)}li.length!==0&&(Fr=Math.max(Mt-Tr,Fr),mn?vP(li,Er,$n,xi,ir*nn/2):vP(li,Er,$n,0,ir/2)),Mt=0;const $a=ir*nn+$n;kn.lineOffset=Math.max($n,Cn),Xt+=$a,++on}var vr;const Cr=Xt,{horizontalAlign:fn,verticalAlign:tn}=nB(Ir);(function(Dr,nn,Cn,kn,li,$n){const zi=(nn-Cn)*li,xi=-$n*kn;for(const $a of Dr)for(const Ge of $a.positionedGlyphs)Ge.x+=zi,Ge.y+=xi})(ot.positionedLines,Er,fn,tn,Fr,Cr),ot.top+=-tn*Cr,ot.bottom=ot.top+Cr,ot.left+=-fn*Fr,ot.right=ot.left+Fr,ot.hasBaseline=mn}(at,i,s,f,ge,_,C,T,N,P,j,Y),!function(ot){for(const _t of ot)if(_t.positionedGlyphs.length!==0)return!1;return!0}(At))return at}const _x={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},QK={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function pP(c,i,s,f,A,g){if(i.image){const _=f.get(i.image.toString());return _?_.displaySize[0]*i.scale*Wl/g+A:0}{const _=s[i.fontStack],C=_&&_.glyphs[c];return C?C.metrics.advance*i.scale+A:0}}function mP(c,i,s,f){const A=Math.pow(c-i,2);return f?c<i?A/2:2*A:A+Math.abs(s)*s}function jK(c,i,s){let f=0;return c===10&&(f-=1e4),s&&(f+=150),c!==40&&c!==65288||(f+=50),i!==41&&i!==65289||(f+=50),f}function gP(c,i,s,f,A,g){let _=null,C=mP(i,s,A,g);for(const T of f){const P=mP(i-T.x,s,A,g)+T.badness;P<=C&&(_=T,C=P)}return{index:c,x:i,priorBreak:_,badness:C}}function _P(c){return c?_P(c.priorBreak).concat(c.index):[]}function nB(c){let i=.5,s=.5;switch(c){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:i,verticalAlign:s}}function vP(c,i,s,f,A){if(!(i||s||f||A))return;const g=c.length-1,_=c[g],C=(_.x+_.metrics.advance*_.scale)*i;for(let T=0;T<=g;T++)c[T].x-=C,c[T].y+=s+f+A}function yP(c){return c.imagePrimary!==void 0&&c.top!==void 0&&c.bottom!==void 0&&c.left!==void 0&&c.right!==void 0}function HK(c,i,s,f){const{horizontalAlign:A,verticalAlign:g}=nB(f),_=s[0]-c.displaySize[0]*A,C=s[1]-c.displaySize[1]*g;return{imagePrimary:c,imageSecondary:i,top:C,bottom:C+c.displaySize[1],left:_,right:_+c.displaySize[0]}}function xP(c,i,s,f,A,g){const _=c.imagePrimary;let C;if(_.content){const ue=_.content,ge=_.pixelRatio||1;C=[ue[0]/ge,ue[1]/ge,_.displaySize[0]-ue[2]/ge,_.displaySize[1]-ue[3]/ge]}const T=i.left*g,P=i.right*g;let k,N,j,X;s==="width"||s==="both"?(X=A[0]+T-f[3],N=A[0]+P+f[1]):(X=A[0]+(T+P-_.displaySize[0])/2,N=X+_.displaySize[0]);const Y=i.top*g,ae=i.bottom*g;return s==="height"||s==="both"?(k=A[1]+Y-f[0],j=A[1]+ae+f[2]):(k=A[1]+(Y+ae-_.displaySize[1])/2,j=k+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:k,right:N,bottom:j,left:X,collisionPadding:C}}function wP(c){return!c.imagePrimary.stretchX}function bP(c){return!c.imagePrimary.stretchY}function EP(c){return{width:c.right-c.left,height:c.bottom-c.top}}const _p=128;function BP(c,i,s){const{expression:f}=i;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new oa(c+1,{worldview:s}))};if(f.kind==="source")return{kind:"source"};{const{zoomStops:A,interpolationType:g}=f;let _=0;for(;_<A.length&&A[_]<=c;)_++;_=Math.max(0,_-1);let C=_;for(;C<A.length&&A[C]<c+1;)C++;C=Math.min(A.length-1,C);const T=A[_],P=A[C];return f.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:P,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:P,minSize:f.evaluate(new oa(T,{worldview:s})),maxSize:f.evaluate(new oa(P,{worldview:s})),interpolationType:g}}}function iB(c,{uSize:i,uSizeT:s},{lowerSize:f,upperSize:A}){return c.kind==="source"?f/_p:c.kind==="composite"?tr(f/_p,A/_p,s):i}function Jv(c,i,s=1){let f=0,A=0;if(c.kind==="constant")A=c.layoutSize*s;else if(c.kind!=="source"){const{interpolationType:g,minZoom:_,maxZoom:C}=c,T=g?je(Fs.interpolationFactor(g,i,_,C),0,1):0;c.kind==="camera"?A=tr(c.minSize,c.maxSize,T)*s:f=T*s}return{uSizeT:f,uSize:A}}class qp extends hr{constructor(i,s,f,A,g){super(i,s),this.angle=A,this.z=f,g!==void 0&&(this.segment=g)}clone(){return new qp(this.x,this.y,this.z,this.angle,this.segment)}}function CP(c,i,s,f,A){if(i.segment===void 0)return!0;let g=i,_=i.segment+1,C=0;for(;C>-s/2;){if(_--,_<0)return!1;C-=c[_].dist(g),g=c[_]}C+=c[_].dist(c[_+1]),_++;const T=[];let P=0;for(;C<s/2;){const k=c[_],N=c[_+1];if(!N)return!1;let j=c[_-1].angleTo(k)-k.angleTo(N);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:C,angleDelta:j}),P+=j;C-T[0].distance>f;)P-=T.shift().angleDelta;if(P>A)return!1;_++,C+=k.dist(N)}return!0}function SP(c){let i=0;for(let s=0;s<c.length-1;s++)i+=c[s].dist(c[s+1]);return i}function TP(c,i,s){return c?.6*i*s:0}function IP(c,i){return Math.max(c?c.right-c.left:0,i?i.right-i.left:0)}function VK(c,i,s,f,A,g){const _=TP(s,A,g),C=IP(s,f)*g;let T=0;const P=SP(c)/2;for(let k=0;k<c.length-1;k++){const N=c[k],j=c[k+1],X=N.dist(j);if(T+X>P){const Y=(P-T)/X,ae=tr(N.x,j.x,Y),ue=tr(N.y,j.y,Y),ge=new qp(ae,ue,0,j.angleTo(N),k);return!_||CP(c,ge,C,_,i)?ge:void 0}T+=X}}function GK(c,i,s,f,A,g,_,C,T){const P=TP(f,g,_),k=IP(f,A),N=k*_,j=c[0].x===0||c[0].x===T||c[0].y===0||c[0].y===T;return i-N<i/4&&(i=N+i/4),FP(c,j?i/2*C%i:(k/2+2*g)*_*C%i,i,P,s,N,j,!1,T)}function FP(c,i,s,f,A,g,_,C,T){const P=g/2,k=SP(c);let N=0,j=i-s,X=[];for(let Y=0;Y<c.length-1;Y++){const ae=c[Y],ue=c[Y+1],ge=ae.dist(ue),Pe=ue.angleTo(ae);for(;j+s<N+ge;){j+=s;const Te=(j-N)/ge,Ue=tr(ae.x,ue.x,Te),At=tr(ae.y,ue.y,Te);if(Ue>=0&&Ue<T&&At>=0&&At<T&&j-P>=0&&j+P<=k){const at=new qp(Ue,At,0,Pe,Y);f&&!CP(c,at,g,f,A)||X.push(at)}}N+=ge}return C||X.length||_||(X=FP(c,N/2,s,f,A,g,_,!0,T)),X}function PP(c){let i=0,s=0;for(const _ of c)i+=_.w*_.h,s=Math.max(s,_.w);c.sort((_,C)=>C.h-_.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),s),h:1/0}];let A=0,g=0;for(const _ of c)for(let C=f.length-1;C>=0;C--){const T=f[C];if(!(_.w>T.w||_.h>T.h)){if(_.x=T.x,_.y=T.y,g=Math.max(g,_.y+_.h),A=Math.max(A,_.x+_.w),_.w===T.w&&_.h===T.h){const P=f.pop();P&&C<f.length&&(f[C]=P)}else _.h===T.h?(T.x+=_.w,T.w-=_.w):_.w===T.w?(T.y+=_.h,T.h-=_.h):(f.push({x:T.x+_.w,y:T.y,w:T.w-_.w,h:_.h}),T.y+=_.h,T.h-=_.h);break}}return{w:A,h:g,fill:i/(A*g)||0}}Mr(qp,"Anchor");const e0=1;class ey{static getImagePositionScale(i,s,f){if(s&&i&&i.options&&i.options.transform){const A=i.options.transform;return{x:A.a,y:A.d}}return{x:f,y:f}}constructor(i,s,f,A){this.paddedRect=i;const{pixelRatio:g,version:_,stretchX:C,stretchY:T,content:P,sdf:k,usvg:N}=s;this.pixelRatio=g,this.stretchX=C,this.stretchY=T,this.content=P,this.version=_,this.padding=f,this.sdf=k,this.usvg=N,this.scale=ey.getImagePositionScale(A,N,g)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function aB(c,i,s){const f=ss.parse(c),A=function(g,_,C=[1,1]){return{x:0,y:0,w:(g.data?g.data.width:g.width*C[0])+2*_,h:(g.data?g.data.height:g.height*C[1])+2*_}}(i,s,[f.options.transform.a,f.options.transform.d]);return{bin:A,imagePosition:new ey(A,i,s,f),imageVariant:f}}class LP{constructor(i,s,f){const A=new Map,g=new Map;this.haveRenderCallbacks=[];const _=[];this.addImages(i,A,e0,_),this.addImages(s,g,2,_);const{w:C,h:T}=PP(_),P=new Uc({width:C||1,height:T||1});for(const[k,N]of i.entries()){const j=A.get(k).paddedRect;Uc.copy(N.data,P,{x:0,y:0},{x:j.x+e0,y:j.y+e0},N.data,f,N.sdf)}for(const[k,N]of s.entries()){const j=g.get(k),X=j.paddedRect;let Y=j.padding;const ae=X.x+Y,ue=X.y+Y,ge=N.data.width,Pe=N.data.height;Y=Y>1?Y-1:Y,Uc.copy(N.data,P,{x:0,y:0},{x:ae,y:ue},N.data,f),Uc.copy(N.data,P,{x:0,y:Pe-Y},{x:ae,y:ue-Y},{width:ge,height:Y},f),Uc.copy(N.data,P,{x:0,y:0},{x:ae,y:ue+Pe},{width:ge,height:Y},f),Uc.copy(N.data,P,{x:ge-Y,y:0},{x:ae-Y,y:ue},{width:Y,height:Pe},f),Uc.copy(N.data,P,{x:0,y:0},{x:ae+ge,y:ue},{width:Y,height:Pe},f),Uc.copy(N.data,P,{x:ge-Y,y:Pe-Y},{x:ae-Y,y:ue-Y},{width:Y,height:Y},f),Uc.copy(N.data,P,{x:0,y:Pe-Y},{x:ae+ge,y:ue-Y},{width:Y,height:Y},f),Uc.copy(N.data,P,{x:0,y:0},{x:ae+ge,y:ue+Pe},{width:Y,height:Y},f),Uc.copy(N.data,P,{x:ge-Y,y:0},{x:ae-Y,y:ue+Pe},{width:Y,height:Y},f)}this.lut=f,this.image=P,this.iconPositions=A,this.patternPositions=g}addImages(i,s,f,A){for(const[g,_]of i.entries()){const{bin:C,imagePosition:T,imageVariant:P}=aB(g,_,f);s.set(g,T),A.push(C),_.hasRenderCallback&&this.haveRenderCallbacks.push(P.id)}}patchUpdatedImages(i,s,f){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(A=>i.hasImage(A,f)),i.dispatchRenderCallbacks(this.haveRenderCallbacks,f);for(const A of i.getUpdatedImages(f)){for(const g of this.iconPositions.keys()){const _=ss.parse(g);if(fo.isEqual(_.id,A)){const C=i.getImage(A,f);this.patchUpdatedImage(this.iconPositions.get(g),C,s)}}for(const g of this.patternPositions.keys()){const _=ss.parse(g);if(fo.isEqual(_.id,A)){const C=i.getImage(A,f);this.patchUpdatedImage(this.patternPositions.get(g),C,s)}}}}patchUpdatedImage(i,s,f){if(!i||!s||i.version===s.version)return;i.version=s.version;const[A,g]=i.tl,_=i.sdf;if(this.lut||_){const C={width:s.data.width,height:s.data.height},T=new Uc(C);Uc.copy(s.data,T,{x:0,y:0},{x:0,y:0},C,this.lut,_),f.update(T,{position:{x:A,y:g}})}else f.update(s.data,{position:{x:A,y:g}})}}Mr(ey,"ImagePosition"),Mr(LP,"ImageAtlas");const ty=1e20;function MP(c,i,s,f,A,g,_,C,T){for(let P=i;P<i+f;P++)OP(c,s*g+P,g,A,_,C,T);for(let P=s;P<s+A;P++)OP(c,P*g+i,1,f,_,C,T)}function OP(c,i,s,f,A,g,_){g[0]=0,_[0]=-ty,_[1]=ty,A[0]=c[i];for(let C=1,T=0,P=0;C<f;C++){A[C]=c[i+C*s];const k=C*C;do{const N=g[T];P=(A[C]-A[N]+k-N*N)/(C-N)/2}while(P<=_[T]&&--T>-1);T++,g[T]=C,_[T]=P,_[T+1]=ty}for(let C=0,T=0;C<f;C++){for(;_[T+1]<C;)T++;const P=g[T],k=C-P;c[i+C*s]=A[P]+k*k}}const Cd=2,oB={none:0,ideographs:1,all:2};class l_{constructor(i,s,f){this.requestManager=i,this.localGlyphMode=s,this.localFontFamily=f,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,s){const f=[],A=this.url||Ss.GLYPHS_URL;for(const g in i)for(const _ of i[g])f.push({stack:g,id:_});me(f,({stack:g,id:_},C)=>{let T=this.entries[g];T||(T=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let P=T.glyphs[_];if(P!==void 0)return void C(null,{stack:g,id:_,glyph:P});if(P=this._tinySDF(T,g,_),P)return T.glyphs[_]=P,void C(null,{stack:g,id:_,glyph:P});const k=Math.floor(_/256);if(256*k>65535)return Hr("glyphs > 65535 not supported"),void C(null,{stack:g,id:_,glyph:P});if(T.ranges[k])return void C(null,{stack:g,id:_,glyph:P});let N=T.requests[k];N||(N=T.requests[k]=[],l_.loadGlyphRange(g,k,A,this.requestManager,(j,X)=>{if(X){T.ascender=X.ascender,T.descender=X.descender;for(const Y in X.glyphs)this._doesCharSupportLocalGlyph(+Y)||(T.glyphs[+Y]=X.glyphs[+Y]);T.ranges[k]=!0}for(const Y of N)Y(j,X);delete T.requests[k]})),N.push((j,X)=>{j?C(j):X&&C(null,{stack:g,id:_,glyph:X.glyphs[_]||null})})},(g,_)=>{if(g)s(g);else if(_){const C={};for(const{stack:T,id:P,glyph:k}of _)C[T]===void 0&&(C[T]={}),C[T].glyphs===void 0&&(C[T].glyphs={}),C[T].glyphs[P]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},C[T].ascender=this.entries[T].ascender,C[T].descender=this.entries[T].descender;s(null,C)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==oB.none&&(this.localGlyphMode===oB.all?!!this.localFontFamily:!!this.localFontFamily&&(hn["CJK Unified Ideographs"](i)||hn["Hangul Syllables"](i)||hn.Hiragana(i)||hn.Katakana(i)||hn["CJK Symbols and Punctuation"](i)||hn["CJK Unified Ideographs Extension A"](i)||hn["CJK Unified Ideographs Extension B"](i)||hn.Osage(i)))}_tinySDF(i,s,f){const A=this.localFontFamily;if(!A||!this._doesCharSupportLocalGlyph(f))return;let g=i.tinySDF;if(!g){let ae="400";/bold/i.test(s)?ae="900":/medium/i.test(s)?ae="500":/light/i.test(s)&&(ae="200"),g=i.tinySDF=new l_.TinySDF({fontFamily:A,fontWeight:ae,fontSize:24*Cd,buffer:3*Cd,radius:8*Cd}),g.fontWeight=ae}if(this.localGlyphs[g.fontWeight][f])return this.localGlyphs[g.fontWeight][f];const _=String.fromCodePoint(f),{data:C,width:T,height:P,glyphWidth:k,glyphHeight:N,glyphLeft:j,glyphTop:X,glyphAdvance:Y}=g.draw(_);return this.localGlyphs[g.fontWeight][f]={id:f,bitmap:new Ym({width:T,height:P},C),metrics:{width:k/Cd,height:N/Cd,left:j/Cd,top:X/Cd-27,advance:Y/Cd,localGlyph:!0}}}}l_.loadGlyphRange=function(c,i,s,f,A){const g=256*i,_=g+255,C=f.transformRequest(f.normalizeGlyphsURL(s).replace("{fontstack}",c).replace("{range}",`${g}-${_}`),Ec.Glyphs);Xc(C,(T,P)=>{if(T)A(T);else if(P){const k={},N=function(j){return new gx(j).readFields(UK,{})}(P);for(const j of N.glyphs)k[j.id]=j;A(null,{glyphs:k,ascender:N.ascender,descender:N.descender})}})},l_.TinySDF=class{constructor({fontSize:c=24,buffer:i=3,radius:s=8,cutoff:f=.25,fontFamily:A="sans-serif",fontWeight:g="normal",fontStyle:_="normal"}={}){this.buffer=i,this.cutoff=f,this.radius=s;const C=this.size=c+4*i,T=this._createCanvas(C),P=this.ctx=T.getContext("2d",{willReadFrequently:!0});P.font=`${_} ${g} ${c}px ${A}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(c){const i=document.createElement("canvas");return i.width=i.height=c,i}draw(c){const{width:i,actualBoundingBoxAscent:s,actualBoundingBoxDescent:f,actualBoundingBoxLeft:A,actualBoundingBoxRight:g}=this.ctx.measureText(c),_=Math.ceil(s),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-A))),T=Math.min(this.size-this.buffer,_+Math.ceil(f)),P=C+2*this.buffer,k=T+2*this.buffer,N=Math.max(P*k,0),j=new Uint8ClampedArray(N),X={data:j,width:P,height:k,glyphWidth:C,glyphHeight:T,glyphTop:_,glyphLeft:0,glyphAdvance:i};if(C===0||T===0)return X;const{ctx:Y,buffer:ae,gridInner:ue,gridOuter:ge}=this;Y.clearRect(ae,ae,C,T),Y.fillText(c,ae,ae+_);const Pe=Y.getImageData(ae,ae,C,T);ge.fill(ty,0,N),ue.fill(0,0,N);for(let Te=0;Te<T;Te++)for(let Ue=0;Ue<C;Ue++){const At=Pe.data[4*(Te*C+Ue)+3]/255;if(At===0)continue;const at=(Te+ae)*P+Ue+ae;if(At===1)ge[at]=0,ue[at]=ty;else{const ot=.5-At;ge[at]=ot>0?ot*ot:0,ue[at]=ot<0?ot*ot:0}}MP(ge,0,0,P,k,P,this.f,this.v,this.z),MP(ue,ae,ae,C,T,P,this.f,this.v,this.z);for(let Te=0;Te<N;Te++){const Ue=Math.sqrt(ge[Te])-Math.sqrt(ue[Te]);j[Te]=Math.round(255-255*(Ue/this.radius+this.cutoff))}return X}};const tg=e0;function DP(c,i){return c+i[1]-i[0]}function RP(c,i,s,f,A=1){const g=[],_=c.imagePrimary,C=_.pixelRatio,T=_.paddedRect.w-2*tg,P=_.paddedRect.h-2*tg,k=(c.right-c.left)*A,N=(c.bottom-c.top)*A,j=_.stretchX||[[0,T]],X=_.stretchY||[[0,P]],Y=j.reduce(DP,0),ae=X.reduce(DP,0),ue=T-Y,ge=P-ae;let Pe=0,Te=Y,Ue=0,At=ae,at=0,ot=ue,_t=0,wt=ge;if(_.content&&f){const Ft=_.content;Pe=vx(j,0,Ft[0]),Ue=vx(X,0,Ft[1]),Te=vx(j,Ft[0],Ft[2]),At=vx(X,Ft[1],Ft[3]),at=Ft[0]-Pe,_t=Ft[1]-Ue,ot=Ft[2]-Ft[0]-Te,wt=Ft[3]-Ft[1]-At}const Yt=(Ft,ir,Ir,cr)=>{const xr=yx(Ft.stretch-Pe,Te,k,c.left*A),Tr=xx(Ft.fixed-at,ot,Ft.stretch,Y),$t=yx(ir.stretch-Ue,At,N,c.top*A),wr=xx(ir.fixed-_t,wt,ir.stretch,ae),Mt=yx(Ir.stretch-Pe,Te,k,c.left*A),Xt=xx(Ir.fixed-at,ot,Ir.stretch,Y),Fr=yx(cr.stretch-Ue,At,N,c.top*A),Er=xx(cr.fixed-_t,wt,cr.stretch,ae),mn=new hr(xr,$t),on=new hr(Mt,$t),vr=new hr(Mt,Fr),Cr=new hr(xr,Fr),fn=new hr(Tr/C,wr/C),tn=new hr(Xt/C,Er/C),Dr=i*Math.PI/180;if(Dr){const zi=Math.sin(Dr),xi=Math.cos(Dr),$a=[xi,-zi,zi,xi];mn._matMult($a),on._matMult($a),Cr._matMult($a),vr._matMult($a)}const nn=Ft.stretch+Ft.fixed,Cn=Ir.stretch+Ir.fixed,kn=ir.stretch+ir.fixed,li=cr.stretch+cr.fixed,$n=c.imageSecondary;return{tl:mn,tr:on,bl:Cr,br:vr,texPrimary:{x:_.paddedRect.x+tg+nn,y:_.paddedRect.y+tg+kn,w:Cn-nn,h:li-kn},texSecondary:$n?{x:$n.paddedRect.x+tg+nn,y:$n.paddedRect.y+tg+kn,w:Cn-nn,h:li-kn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fn,pixelOffsetBR:tn,minFontScaleX:ot/C/k,minFontScaleY:wt/C/N,isSDF:s}};if(f&&(_.stretchX||_.stretchY)){const Ft=kP(j,ue,Y),ir=kP(X,ge,ae);for(let Ir=0;Ir<Ft.length-1;Ir++){const cr=Ft[Ir],xr=Ft[Ir+1];for(let Tr=0;Tr<ir.length-1;Tr++)g.push(Yt(cr,ir[Tr],xr,ir[Tr+1]))}}else g.push(Yt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:P+1}));return g}function vx(c,i,s){let f=0;for(const A of c)f+=Math.max(i,Math.min(s,A[1]))-Math.max(i,Math.min(s,A[0]));return f}function kP(c,i,s){const f=[{fixed:-tg,stretch:0}];for(const[A,g]of c){const _=f[f.length-1];f.push({fixed:A-_.stretch,stretch:_.stretch}),f.push({fixed:A-_.stretch,stretch:_.stretch+(g-A)})}return f.push({fixed:i+tg,stretch:s}),f}function yx(c,i,s,f){return c/i*s+f}function xx(c,i,s,f){return c-i*s/f}function KK(c,i,s,f){const A=i+c.positionedLines[f].lineOffset;return f===0?s+A/2:s+(A+(i+c.positionedLines[f-1].lineOffset))/2}function WK(c,i=1,s=!1){let f=1/0,A=1/0,g=-1/0,_=-1/0;const C=c[0];for(let X=0;X<C.length;X++){const Y=C[X];(!X||Y.x<f)&&(f=Y.x),(!X||Y.y<A)&&(A=Y.y),(!X||Y.x>g)&&(g=Y.x),(!X||Y.y>_)&&(_=Y.y)}const T=Math.min(g-f,_-A);let P=T/2;const k=new vh([],qK);if(T===0)return new hr(f,A);for(let X=f;X<g;X+=T)for(let Y=A;Y<_;Y+=T)k.push(new c_(X+P,Y+P,P,c));let N=function(X){let Y=0,ae=0,ue=0;const ge=X[0];for(let Pe=0,Te=ge.length,Ue=Te-1;Pe<Te;Ue=Pe++){const At=ge[Pe],at=ge[Ue],ot=At.x*at.y-at.x*At.y;ae+=(At.x+at.x)*ot,ue+=(At.y+at.y)*ot,Y+=3*ot}return new c_(ae/Y,ue/Y,0,X)}(c),j=k.length;for(;k.length;){const X=k.pop();(X.d>N.d||!N.d)&&(N=X,s&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,j)),X.max-N.d<=i||(P=X.h/2,k.push(new c_(X.p.x-P,X.p.y-P,P,c)),k.push(new c_(X.p.x+P,X.p.y-P,P,c)),k.push(new c_(X.p.x-P,X.p.y+P,P,c)),k.push(new c_(X.p.x+P,X.p.y+P,P,c)),j+=4)}return s&&(console.log(`num probes: ${j}`),console.log(`best distance: ${N.d}`)),N.p}function qK(c,i){return i.max-c.max}class c_{constructor(i,s,f,A){this.p=new hr(i,s),this.h=f,this.d=function(g,_){let C=!1,T=1/0;for(let P=0;P<_.length;P++){const k=_[P];for(let N=0,j=k.length,X=j-1;N<j;X=N++){const Y=k[N],ae=k[X];Y.y>g.y!=ae.y>g.y&&g.x<(ae.x-Y.x)*(g.y-Y.y)/(ae.y-Y.y)+Y.x&&(C=!C),T=Math.min(T,lu(g,Y,ae))}}return(C?1:-1)*Math.sqrt(T)}(this.p,A),this.max=this.d+this.h*Math.SQRT2}}const $K=Object.keys,sB=Number.POSITIVE_INFINITY,XK=Math.sqrt(2);function UP(c,[i,s]){let f=0,A=0;if(s===sB){i<0&&(i=0);const g=i/XK;switch(c){case"top-right":case"top-left":A=g-7;break;case"bottom-right":case"bottom-left":A=7-g;break;case"bottom":A=7-i;break;case"top":A=i-7}switch(c){case"top-right":case"bottom-right":f=-g;break;case"top-left":case"bottom-left":f=g;break;case"left":f=i;break;case"right":f=-i}}else{switch(i=Math.abs(i),s=Math.abs(s),c){case"top-right":case"top-left":case"top":A=s-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-s}switch(c){case"top-right":case"bottom-right":case"right":f=-i;break;case"top-left":case"bottom-left":case"left":f=i}}return[f,A]}function wx(c,i,s,f,A,g,_,C,T){if(!i||!i.usvg)return;const P=EP(f),k=EP(A),N=g!=="both"&&g!=="width"||!wP(f)?1:k.width/P.width,j=g!=="both"&&g!=="height"||!bP(f)?1:k.height/P.height;s.scaleSelf(N,j);const X=s.toString();_.set(X,s),C.set(X,i);const{imagePosition:Y}=aB(X,i,e0);T.set(X,Y)}function NP(c,i,s,f,A,g,_,C,T){if(!c)return;const P=function(k,N,j,X,Y,ae){if(k.kind==="camera")return k.maxSize;if(k.kind==="composite"){const ue=N.possiblyEvaluate(new oa(k.maxZoom,{worldview:ae}),j).evaluate(Y,{},j),ge=N.possiblyEvaluate(new oa(k.minZoom,{worldview:ae}),j).evaluate(Y,{},j);return Math.max(ue,ge)}return N.possiblyEvaluate(new oa(X,{worldview:ae})).evaluate(Y,{},j)}(i,s,f,A,g,T);return c.scaleSelf(P*C*_)}function zP(c,i,s,f,A,g,_,C,T){return{iconPrimary:NP(c.getPrimary(),i,s,f,A,g,_,C,T),iconSecondary:NP(c.getSecondary(),i,s,f,A,g,_,C,T)}}function ZK(c,i,s){if(!i)return;const f=s.get(c.toString()),A=s.get(i.toString());A&&(f.paddedRect.w===A.paddedRect.w&&f.paddedRect.h===A.paddedRect.h||Hr(`Mismatch in icon variant sizes: ${c.toString()} and ${i.toString()}`),f.usvg!==A.usvg&&Hr(`Mismatch in icon variant image types: ${c.id} and ${i.id}`))}function QP(c,i,s,f){if(!c)return;const A=i.get(s.toString());if(c.imagePrimary=A,f){const g=i.get(f.toString());c.imageSecondary=g}}function YK(c,i){for(const s in c.horizontal)jP(c.horizontal[s],i);jP(c.vertical,i)}function jP(c,i){if(c){for(const s of c.positionedLines)for(const f of s.positionedGlyphs)if(f.image!==null){const A=f.image.toString();f.rect=i.get(A).paddedRect}}}function lB(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function JK(c,i,s,f,A,g,_,C,T){const P=cB(g.horizontal)||g.vertical,k=s.get("icon-text-fit-padding").evaluate(f,{},A);let N,j=i;return i&&T!=="none"&&(c.allowVerticalPlacement&&g.vertical&&(N=xP(i,g.vertical,T,k,C,_)),P&&(j=xP(i,P,T,k,C,_))),{defaultShapedIcon:j,verticallyShapedIcon:N}}function eW(c,i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue,ge,Pe,Te){let Ue=_.textMaxSize.evaluate(i,{},j);Ue===void 0?Ue=C*_.textScaleFactor:Ue*=_.textScaleFactor;const At=c.layers[0].layout,at=cB(s.horizontal)||s.vertical,ot=X.name==="globe",_t=Wl,wt=c.tilePixelRatio*Ue/_t,Yt=(Tr=c.overscaling,c.zoom>18&&Tr>2&&(Tr>>=1),Math.max(Lr/(512*Tr),1)*At.get("symbol-spacing")),Ft=At.get("text-padding")*c.tilePixelRatio,ir=At.get("icon-padding")*c.tilePixelRatio,Ir=_n(At.get("text-max-angle")),cr=At.get("icon-rotation-alignment")==="map"&&Te!=="point",xr=Yt/2;var Tr;c.hasAnyIconTextFit===!1&&ue!=="none"&&(c.hasAnyIconTextFit=!0);const $t=i.properties?+i.properties[Wr]:null,wr=$t&&c.elevationFeatureIdToIndex?c.elevationFeatureIdToIndex.get($t):65535,Mt=(Xt,Fr,Er)=>{if(Fr.x<0||Fr.x>=Lr||Fr.y<0||Fr.y>=Lr)return;let mn=null;if(ot){const{x:on,y:vr,z:Cr}=X.projectTilePoint(Fr.x,Fr.y,Er);mn={anchor:new qp(on,vr,Cr,0,void 0),up:X.upVector(Er,Fr.x,Fr.y)}}(function(on,vr,Cr,fn,tn,Dr,nn,Cn,kn,li,$n,zi,xi,$a,Ge,Ke,Kt,Pr,Vr,jr,un,Mn,Fi,Pi,mi,Sa,Eo,Ai,Ja){const Na=on.addToLineVertexArray(vr,fn);let da,vo,Xa,za,Ha,ya,gi,Ta=0,yo=0,Fn=0,Zi=0,Za=-1,Lo=-1;const eo={};let Ws=vu("");const Oa=Cr?Cr.anchor:vr,ks=Ai!=="none";let Sh=0,Nc=0;if(kn._unevaluatedLayout.getValue("text-radial-offset")===void 0){const qs=kn.layout.get("text-offset").evaluate(un,{},mi);Sh=qs[0]*Wl,Nc=qs[1]*Wl}else Sh=kn.layout.get("text-radial-offset").evaluate(un,{},mi)*Wl,Nc=sB;if(on.allowVerticalPlacement&&tn.vertical){const qs=tn.vertical;if(Ge)ya=uB(qs),Cn&&(gi=uB(Cn));else{const vl=kn.layout.get("text-rotate").evaluate(un,{},mi)+90;Xa=bx(li,Oa,vr,$n,zi,xi,qs,$a,vl,Ke),Cn&&(za=bx(li,Oa,vr,$n,zi,xi,Cn,Pr,vl))}}if(Dr){const qs=on.iconSizeData,vl=kn.layout.get("icon-rotate").evaluate(un,{},mi),zc=RP(Dr,vl,Fi,ks,Mn.iconScaleFactor),Du=Cn?RP(Cn,vl,Fi,ks,Mn.iconScaleFactor):void 0;vo=bx(li,Oa,vr,$n,zi,xi,Dr,Pr,vl,null),Ta=4*zc.length;let cu=null;qs.kind==="source"?(cu=[_p*kn.layout.get("icon-size").evaluate(un,{},mi)*Mn.iconScaleFactor],cu[0]>rg&&Hr(`${on.layerIds[0]}: Value for "icon-size" is >= ${ry}. Reduce your "icon-size".`)):qs.kind==="composite"&&(cu=[_p*Mn.compositeIconSizes[0].evaluate(un,{},mi)*Mn.iconScaleFactor,_p*Mn.compositeIconSizes[1].evaluate(un,{},mi)*Mn.iconScaleFactor],(cu[0]>rg||cu[1]>rg)&&Hr(`${on.layerIds[0]}: Value for "icon-size" is >= ${ry}. Reduce your "icon-size".`)),on.addSymbols(on.icon,zc,cu,jr,Vr,un,void 0,Cr,vr,Na.lineStartIndex,Na.lineLength,-1,Pi,mi,Sa,Eo),Za=on.icon.placedSymbolArray.length-1,Du&&(yo=4*Du.length,on.addSymbols(on.icon,Du,cu,jr,Vr,un,nf.vertical,Cr,vr,Na.lineStartIndex,Na.lineLength,-1,Pi,mi,Sa,Eo),Lo=on.icon.placedSymbolArray.length-1)}for(const qs in tn.horizontal){const vl=qs,zc=tn.horizontal[vl];da||(Ws=vu(zc.text),Ge?Ha=uB(zc):da=bx(li,Oa,vr,$n,zi,xi,zc,$a,kn.layout.get("text-rotate").evaluate(un,{},mi),Ke));const Du=zc.positionedLines.length===1;if(Fn+=HP(on,Cr,vr,zc,nn,kn,Ge,un,Ke,Na,tn.vertical?nf.horizontal:nf.horizontalOnly,Du?$K(tn.horizontal):[vl],eo,Za,Mn,Pi,mi,Sa),Du)break}tn.vertical&&(Zi+=HP(on,Cr,vr,tn.vertical,nn,kn,Ge,un,Ke,Na,nf.vertical,["vertical"],eo,Lo,Mn,Pi,mi,Sa));let fc=-1;const Th=(qs,vl)=>qs?Math.max(qs,vl):vl;fc=Th(Ha,fc),fc=Th(ya,fc),fc=Th(gi,fc);const vp=fc>-1?1:0;on.glyphOffsetArray.length>=65535&&Hr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),un.sortKey!==void 0&&on.addToSortKeyRanges(on.symbolInstances.length,un.sortKey),on.symbolInstances.emplaceBack(vr.x,vr.y,Oa.x,Oa.y,Oa.z,eo.right>=0?eo.right:-1,eo.center>=0?eo.center:-1,eo.left>=0?eo.left:-1,eo.vertical>=0?eo.vertical:-1,Za,Lo,Ws,da!==void 0?da:on.collisionBoxArray.length,da!==void 0?da+1:on.collisionBoxArray.length,Xa!==void 0?Xa:on.collisionBoxArray.length,Xa!==void 0?Xa+1:on.collisionBoxArray.length,vo!==void 0?vo:on.collisionBoxArray.length,vo!==void 0?vo+1:on.collisionBoxArray.length,za||on.collisionBoxArray.length,za?za+1:on.collisionBoxArray.length,$n,Fn,Zi,Ta,yo,vp,0,Sh,Nc,fc,0,ks?1:0,Ja)})(c,Fr,mn,Xt,s,f,g,A,c.layers[0],c.collisionBoxArray,i.index,i.sourceLayerIndex,c.index,Ft,Pe,P,0,ir,cr,ge,i,_,k,N,j,Y,ae,ue,wr)};if(Te==="line")for(const Xt of cx(i.geometry,0,0,Lr,Lr)){const Fr=GK(Xt,Yt,Ir,s.vertical||at,f,_t,wt,c.overscaling,Lr);for(const Er of Fr)at&&tW(c,at.text,xr,Er)||Mt(Xt,Er,j)}else if(Te==="line-center"){for(const Xt of i.geometry)if(Xt.length>1){const Fr=VK(Xt,Ir,s.vertical||at,f,_t,wt);Fr&&Mt(Xt,Fr,j)}}else if(i.type==="Polygon")for(const Xt of Uv(i.geometry,0)){const Fr=WK(Xt,16);Mt(Xt[0],new qp(Fr.x,Fr.y,0,0,void 0),j)}else if(i.type==="LineString")for(const Xt of i.geometry)Mt(Xt,new qp(Xt[0].x,Xt[0].y,0,0,void 0),j);else if(i.type==="Point")for(const Xt of i.geometry)for(const Fr of Xt)Mt([Fr],new qp(Fr.x,Fr.y,0,0,void 0),j)}const ry=255,rg=ry*_p;function HP(c,i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue,ge){const Pe=function(At,at,ot,_t,wt,Yt,Ft,ir){const Ir=[];if(at.positionedLines.length===0)return Ir;const cr=_t.layout.get("text-rotate").evaluate(Yt,{})*Math.PI/180,xr=function(Xt){const Fr=Xt[0],Er=Xt[1],mn=Fr*Er;return mn>0?[Fr,-Er]:mn<0?[-Fr,Er]:Fr===0?[Er,Fr]:[Er,-Fr]}(ot);let Tr=Math.abs(at.top-at.bottom);for(const Xt of at.positionedLines)Tr-=Xt.lineOffset;const $t=at.positionedLines.length,wr=Tr/$t;let Mt=at.top-ot[1];for(let Xt=0;Xt<$t;++Xt){const Fr=at.positionedLines[Xt];Mt=KK(at,wr,Mt,Xt);for(const Er of Fr.positionedGlyphs){if(!Er.rect)continue;const mn=Er.rect||{};let on=dP+1,vr=!0,Cr=1,fn=0;if(Er.image){const un=Ft.get(Er.image.toString());if(!un)continue;if(un.sdf){Hr("SDF images are not supported in formatted text and will be ignored.");continue}vr=!1,Cr=un.pixelRatio,on=e0/Cr}const tn=(wt||ir)&&Er.vertical,Dr=Er.metrics.advance*Er.scale/2,nn=Er.metrics,Cn=Er.rect;if(Cn===null)continue;ir&&at.verticalizable&&(fn=Er.image?Dr-Er.metrics.width*Er.scale/2:0);const kn=wt?[Er.x+Dr,Er.y]:[0,0];let li=[0,0],$n=[0,0],zi=!1;wt||(tn?($n=[Er.x+Dr+xr[0],Er.y+xr[1]-fn],zi=!0):li=[Er.x+Dr+ot[0],Er.y+ot[1]-fn]);const xi=Cn.w*Er.scale/(Cr*(Er.localGlyph?Cd:1)),$a=Cn.h*Er.scale/(Cr*(Er.localGlyph?Cd:1));let Ge,Ke,Kt,Pr;if(tn){const un=Er.y-Mt,Mn=new hr(-Dr,Dr-un),Fi=-Math.PI/2,Pi=new hr(...$n);Ge=new hr(-Dr+li[0],li[1]),Ge._rotateAround(Fi,Mn)._add(Pi),Ge.x+=-un+Dr,Ge.y-=(nn.left-on)*Er.scale;const mi=Er.image?nn.advance*Er.scale:Wl*Er.scale,Sa=String.fromCodePoint(Er.glyph);SK(Sa)?Ge.x+=(1-on)*Er.scale:TK(Sa)?Ge.x+=mi-nn.height*Er.scale+(-on-1)*Er.scale:Ge.x+=Er.image||nn.width+2*on===Cn.w&&nn.height+2*on===Cn.h?(mi-$a)/2:(mi-(nn.height+2*on)*Er.scale)/2,Ke=new hr(Ge.x,Ge.y-xi),Kt=new hr(Ge.x+$a,Ge.y),Pr=new hr(Ge.x+$a,Ge.y-xi)}else{const un=(nn.left-on)*Er.scale-Dr+li[0],Mn=(-nn.top-on)*Er.scale+li[1],Fi=un+xi,Pi=Mn+$a;Ge=new hr(un,Mn),Ke=new hr(Fi,Mn),Kt=new hr(un,Pi),Pr=new hr(Fi,Pi)}if(cr){let un;un=wt?new hr(0,0):zi?new hr(xr[0],xr[1]):new hr(ot[0],ot[1]),Ge._rotateAround(cr,un),Ke._rotateAround(cr,un),Kt._rotateAround(cr,un),Pr._rotateAround(cr,un)}const Vr=new hr(0,0),jr=new hr(0,0);Ir.push({tl:Ge,tr:Ke,bl:Kt,br:Pr,texPrimary:mn,texSecondary:void 0,writingMode:at.writingMode,glyphOffset:kn,sectionIndex:Er.sectionIndex,isSDF:vr,pixelOffsetTL:Vr,pixelOffsetBR:jr,minFontScaleX:0,minFontScaleY:0})}}return Ir}(0,f,T,g,_,C,A,c.allowVerticalPlacement),Te=c.textSizeData;let Ue=null;Te.kind==="source"?(Ue=[_p*g.layout.get("text-size").evaluate(C,{},ue)*Y.textScaleFactor],Ue[0]>rg&&Hr(`${c.layerIds[0]}: Value for "text-size" is >= ${ry}. Reduce your "text-size".`)):Te.kind==="composite"&&(Ue=[_p*Y.compositeTextSizes[0].evaluate(C,{},ue)*Y.textScaleFactor,_p*Y.compositeTextSizes[1].evaluate(C,{},ue)*Y.textScaleFactor],(Ue[0]>rg||Ue[1]>rg)&&Hr(`${c.layerIds[0]}: Value for "text-size" is >= ${ry}. Reduce your "text-size".`)),c.addSymbols(c.text,Pe,Ue,T,_,C,k,i,s,P.lineStartIndex,P.lineLength,X,ae,ue,ge,!1);for(const At of N)j[At]=c.text.placedSymbolArray.length-1;return 4*Pe.length}function cB(c){for(const i in c)return c[i];return null}function bx(c,i,s,f,A,g,_,C,T,P){let k=_.top,N=_.bottom,j=_.left,X=_.right;if(yP(_)&&_.collisionPadding){const Y=_.collisionPadding;j-=Y[0],k-=Y[1],X+=Y[2],N+=Y[3]}if(T){const Y=new hr(j,k),ae=new hr(X,k),ue=new hr(j,N),ge=new hr(X,N),Pe=_n(T);let Te=new hr(0,0);P&&(Te=new hr(P[0],P[1])),Y._rotateAround(Pe,Te),ae._rotateAround(Pe,Te),ue._rotateAround(Pe,Te),ge._rotateAround(Pe,Te),j=Math.min(Y.x,ae.x,ue.x,ge.x),X=Math.max(Y.x,ae.x,ue.x,ge.x),k=Math.min(Y.y,ae.y,ue.y,ge.y),N=Math.max(Y.y,ae.y,ue.y,ge.y)}return c.emplaceBack(i.x,i.y,i.z,s.x,s.y,j,k,X,N,C,f,A,g),c.length-1}function uB(c){yP(c)&&c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const i=c.bottom-c.top;return i>0?Math.max(10,i):null}function tW(c,i,s,f){const A=c.compareText;if(i in A){const g=A[i];for(let _=g.length-1;_>=0;_--)if(f.dist(g[_])<s)return!0}else A[i]=[];return A[i].push(f),!1}function VP(c,i){const s=c.fovAboveCenter,f=c.elevation?c.elevation.getMinElevationBelowMSL()*i:0,A=(c._camera.position[2]*c.worldSize-f)/Math.cos(c._pitch),g=Math.sin(s)*A/Math.sin(Math.max(Math.PI/2-c._pitch-s,.01));let _=Math.sin(c._pitch)*g+A;const C=A*(1/c._horizonShift);if(!c.elevation||c.elevation.exaggeration()===0){let T=Math.max(c.zoom-17,0);c.isOrthographic&&(T/=10),_*=1+T}return Math.min(1.01*_,C)}function ny(c,i){if(!i.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:i};const s=Math.pow(2,-c.z),f=c.x*s,A=(c.x+1)*s,g=c.y*s,_=(c.y+1)*s,C=Ce(f),T=Ce(A),P=ke(g),k=ke(_),N=i.project(C,P),j=i.project(T,P),X=i.project(T,k),Y=i.project(C,k);let ae=Math.min(N.x,j.x,X.x,Y.x),ue=Math.min(N.y,j.y,X.y,Y.y),ge=Math.max(N.x,j.x,X.x,Y.x),Pe=Math.max(N.y,j.y,X.y,Y.y);const Te=s/16;function Ue(at,ot,_t,wt,Yt,Ft){const ir=(_t+Yt)/2,Ir=(wt+Ft)/2,cr=i.project(Ce(ir),ke(Ir)),xr=Math.max(0,ae-cr.x,ue-cr.y,cr.x-ge,cr.y-Pe);ae=Math.min(ae,cr.x),ge=Math.max(ge,cr.x),ue=Math.min(ue,cr.y),Pe=Math.max(Pe,cr.y),xr>Te&&(Ue(at,cr,_t,wt,ir,Ir),Ue(cr,ot,ir,Ir,Yt,Ft))}Ue(N,j,f,g,A,g),Ue(j,X,A,g,A,_),Ue(X,Y,A,_,f,_),Ue(Y,N,f,_,f,g),ae-=Te,ue-=Te,ge+=Te,Pe+=Te;const At=1/Math.max(ge-ae,Pe-ue);return{scale:At,x:ae*At,y:ue*At,x2:ge*At,y2:Pe*At,projection:i}}function GP(c,{x:i,y:s},f=0){return new hr(((i-f)*c.scale-c.x)*Lr,(s*c.scale-c.y)*Lr)}const rW=R(new Float32Array(16));class ng{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,s){return{x:0,y:0,z:0}}unproject(i,s){return new V(0,0)}projectTilePoint(i,s,f){return{x:i,y:s,z:0}}locationPoint(i,s,f,A=!0){return i._coordinatePoint(i.locationCoordinate(s,f),A)}pixelsPerMeter(i,s){return fe(1,i)*s}pixelSpaceConversion(i,s,f){return 1}farthestPixelDistance(i){return VP(i,i.pixelsPerMeter)}pointCoordinate(i,s,f,A){const g=i.horizonLineFromTop(!1),_=new hr(s,Math.max(g,f));return i.rayIntersectionCoordinate(i.pointRayIntersection(_,A))}pointCoordinate3D(i,s,f){const A=new hr(s,f);if(i.elevation)return i.elevation.pointCoordinate(A);{const g=this.pointCoordinate(i,A.x,A.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(i,s){if(i.elevation&&i.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(i,s.x,s.y);const f=i.horizonLineFromTop();return s.y<f}createInversionMatrix(i,s){return rW}createTileMatrix(i,s,f){let A,g,_;const C=f.canonical,T=R(new Float64Array(16));if(this.isReprojectedInTileSpace){const P=ny(C,this);A=1,g=P.x+f.wrap*P.scale,_=P.y,J(T,T,[A/P.scale,A/P.scale,i.pixelsPerMeter/s])}else A=s/i.zoomScale(C.z),g=(C.x+Math.pow(2,C.z)*f.wrap)*A,_=C.y*A;return te(T,T,[g,_,0]),J(T,T,[A/Lr,A/Lr,1]),T}upVector(i,s,f){return[0,0,1]}upVectorScale(i,s,f){return{metersToTile:1}}}class nW extends ng{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[s,f]=this.parallels=i.parallels||[29.5,45.5],A=Math.sin(_n(s));this.n=(A+Math.sin(_n(f)))/2,this.c=1+A*(2*this.n-A),this.r0=Math.sqrt(this.c)/this.n}project(i,s){const{n:f,c:A,r0:g}=this,_=_n(i-this.center[0]),C=_n(s),T=Math.sqrt(A-2*f*Math.sin(C))/f;return{x:T*Math.sin(_*f),y:T*Math.cos(_*f)-g,z:0}}unproject(i,s){const{n:f,c:A,r0:g}=this,_=g+s;let C=Math.atan2(i,Math.abs(_))*Math.sign(_);_*f<0&&(C-=Math.PI*Math.sign(i)*Math.sign(_));const T=_n(this.center[0])*f;C=Ee(C,-Math.PI-T,Math.PI-T);const P=je(Tt(C/f)+this.center[0],-180,180),k=Math.asin(je((A-(i*i+_*_)*f*f)/(2*f),-1,1)),N=je(Tt(k),-$e,$e);return new V(P,N)}}const iy=1.340264,ay=-.081106,oy=893e-6,sy=.003796,Ex=Math.sqrt(3)/2;class iW extends ng{project(i,s){s=s/180*Math.PI,i=i/180*Math.PI;const f=Math.asin(Ex*Math.sin(s)),A=f*f,g=A*A*A;return{x:.5*(i*Math.cos(f)/(Ex*(iy+3*ay*A+g*(7*oy+9*sy*A)))/Math.PI+.5),y:1-.5*(f*(iy+ay*A+g*(oy+sy*A))/Math.PI+1),z:0}}unproject(i,s){i=(2*i-.5)*Math.PI;let f=s=(2*(1-s)-1)*Math.PI,A=f*f,g=A*A*A;for(let k,N,j,X=0;X<12&&(N=f*(iy+ay*A+g*(oy+sy*A))-s,j=iy+3*ay*A+g*(7*oy+9*sy*A),k=N/j,f=je(f-k,-Math.PI/3,Math.PI/3),A=f*f,g=A*A*A,!(Math.abs(k)<1e-12));++X);const _=Ex*i*(iy+3*ay*A+g*(7*oy+9*sy*A))/Math.cos(f),C=Math.asin(Math.sin(f)/Ex),T=je(180*_/Math.PI,-180,180),P=je(180*C/Math.PI,-$e,$e);return new V(T,P)}}class aW extends ng{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,s){return{x:.5+i/360,y:.5-s/360,z:0}}unproject(i,s){const f=360*(i-.5),A=je(360*(.5-s),-$e,$e);return new V(f,A)}}const u_=Math.PI/2;function Bx(c){return Math.tan((u_+c)/2)}class oW extends ng{constructor(i){super(i),this.center=i.center||[0,30];const[s,f]=this.parallels=i.parallels||[30,30];let A=_n(s),g=_n(f);this.southernCenter=A+g<0,this.southernCenter&&(A=-A,g=-g);const _=Math.cos(A),C=Bx(A);this.n=A===g?Math.sin(A):Math.log(_/Math.cos(g))/Math.log(Bx(g)/C),this.f=_*Math.pow(Bx(A),this.n)/this.n}project(i,s){s=_n(s),this.southernCenter&&(s=-s),i=_n(i-this.center[0]);const f=1e-6,{n:A,f:g}=this;g>0?s<-u_+f&&(s=-u_+f):s>u_-f&&(s=u_-f);const _=g/Math.pow(Bx(s),A);let C=_*Math.sin(A*i),T=g-_*Math.cos(A*i);return C=.5*(C/Math.PI+.5),T=.5*(T/Math.PI+.5),{x:C,y:this.southernCenter?T:1-T,z:0}}unproject(i,s){i=(2*i-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:f,f:A}=this,g=A-s,_=Math.sign(g),C=Math.sign(f)*Math.sqrt(i*i+g*g);let T=Math.atan2(i,Math.abs(g))*_;g*f<0&&(T-=Math.PI*Math.sign(i)*_);const P=je(Tt(T/f)+this.center[0],-180,180),k=je(Tt(2*Math.atan(Math.pow(A/C,1/f))-u_),-$e,$e);return new V(P,this.southernCenter?-k:k)}}class KP extends ng{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,s){return{x:le(i),y:Ae(s),z:0}}unproject(i,s){const f=Ce(i),A=ke(s);return new V(f,A)}}const WP=_n($e);class sW extends ng{project(i,s){const f=(s=_n(s))*s,A=f*f;return{x:.5*((i=_n(i))*(.8707-.131979*f+A*(A*(.003971*f-.001529*A)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+f*(.015085+A*(.028874*f-.044475-.005916*A)))/Math.PI+1),z:0}}unproject(i,s){i=(2*i-.5)*Math.PI;let f=s=(2*(1-s)-1)*Math.PI,A=25,g=0,_=f*f;do{_=f*f;const P=_*_;g=(f*(1.007226+_*(.015085+P*(.028874*_-.044475-.005916*P)))-s)/(1.007226+_*(.045255+P*(.259866*_-.311325-.005916*11*P))),f=je(f-g,-WP,WP)}while(Math.abs(g)>1e-6&&--A>0);_=f*f;const C=je(Tt(i/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),T=Tt(f);return new V(C,T)}}const qP=_n($e);class lW extends ng{project(i,s){s=_n(s),i=_n(i);const f=Math.cos(s),A=2/Math.PI,g=Math.acos(f*Math.cos(i/2)),_=Math.sin(g)/g,C=.5*(i*A+2*f*Math.sin(i/2)/_)||0,T=.5*(s+Math.sin(s)/_)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(i,s){let f=i=(2*i-.5)*Math.PI,A=s=(2*(1-s)-1)*Math.PI,g=25;const _=1e-6;let C=0,T=0;do{const P=Math.cos(A),k=Math.sin(A),N=2*k*P,j=k*k,X=P*P,Y=Math.cos(f/2),ae=Math.sin(f/2),ue=2*Y*ae,ge=ae*ae,Pe=1-X*Y*Y,Te=Pe?1/Pe:0,Ue=Pe?Math.acos(P*Y)*Math.sqrt(1/Pe):0,At=.5*(2*Ue*P*ae+2*f/Math.PI)-i,at=.5*(Ue*k+A)-s,ot=.5*Te*(X*ge+Ue*P*Y*j)+1/Math.PI,_t=Te*(ue*N/4-Ue*k*ae),wt=.125*Te*(N*ae-Ue*k*X*ue),Yt=.5*Te*(j*Y+Ue*ge*P)+.5,Ft=_t*wt-Yt*ot;C=(at*_t-At*Yt)/Ft,T=(At*wt-at*ot)/Ft,f=je(f-C,-Math.PI,Math.PI),A=je(A-T,-qP,qP)}while((Math.abs(C)>_||Math.abs(T)>_)&&--g>0);return new V(Tt(f),Tt(A))}}class $P extends ng{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(_n(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,s){const{scale:f,cosPhi:A}=this;return{x:_n(i)*A*f+.5,y:-Math.sin(_n(s))/A*f+.5,z:0}}unproject(i,s){const{scale:f,cosPhi:A}=this,g=-(s-.5)/f,_=je(Tt((i-.5)/f)/A,-180,180),C=Math.asin(je(g*A,-1,1)),T=je(Tt(C),-$e,$e);return new V(_,T)}}class cW extends KP{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,s,f){const A=pn(i,s,f);return Ct(A,A,qn(re(f))),{x:A[0],y:A[1],z:A[2]}}locationPoint(i,s,f){const A=F(s.lat,s.lng),g=et([],A),_=f?i._centerAltitude+f:i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(s),i._centerAltitude):i._centerAltitude;ie(A,A,g,fe(1,0)*Lr*_);const C=R(new Float64Array(16));return q(C,i.pixelMatrix,i.globeMatrix),Ct(A,A,C),new hr(A[0],A[1])}pixelsPerMeter(i,s){return fe(1,0)*s}pixelSpaceConversion(i,s,f){const A=fe(1,i)*s,g=tr(fe(1,45)*s,A,f);return this.pixelsPerMeter(i,s)/g}createTileMatrix(i,s,f){const A=fi(re(f.canonical));return q(new Float64Array(16),i.globeMatrix,A)}createInversionMatrix(i,s){const{center:f}=i,A=qn(re(s));return ye(A,A,_n(f.lng)),se(A,A,_n(f.lat)),J(A,A,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(A)}pointCoordinate(i,s,f,A){return B(i,s,f,!0)||new tt(0,0)}pointCoordinate3D(i,s,f){const A=this.pointCoordinate(i,s,f,0);return[A.x,A.y,A.z]}isPointAboveHorizon(i,s){return!B(i,s.x,s.y,!1)}farthestPixelDistance(i){const s=function(A,g){const _=A.cameraToCenterDistance,C=A._centerAltitude*g,T=A._camera,P=A._camera.forward(),k=Ut([],lt([],P,-_),[0,0,C]),N=A.worldSize/(2*Math.PI),j=[0,0,-N],X=A.width/A.height,Y=Math.tan(A.fovAboveCenter),ae=lt([],T.up(),Y),ue=lt([],T.right(),Y*X),ge=et([],Ut([],Ut([],P,ae),ue)),Pe=[];let Te;if(new Wi(k,ge).closestPointOnSphere(j,N,Pe)){const Ue=Ut([],Pe,j),At=mt([],Ue,k);Te=Math.cos(A.fovAboveCenter)*Ze(At)}else{const Ue=mt([],k,j),At=mt([],j,k);et(At,At);const at=Ze(Ue)-N;Te=Math.sqrt(at*(at+2*N));const ot=Math.acos(Te/(N+at))-Math.acos(xt(P,At));Te*=Math.cos(ot)}return 1.01*Te}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),f=nr(i.zoom);if(f>0){const A=VP(i,fe(1,i.center.lat)*i.worldSize),g=i.worldSize/(2*Math.PI),_=Math.max(i.width,i.height)/i.worldSize*Math.PI;return tr(s,A+g*(1-Math.cos(_)),Math.pow(f,10))}return s}upVector(i,s,f){return pn(s,f,i,1)}upVectorScale(i){return{metersToTile:Wp(wn(re(i)))}}}function XP(c){const i=c.parallels,s=!!i&&Math.abs(i[0]+i[1])<.01;switch(c.name){case"mercator":return new KP(c);case"equirectangular":return new aW(c);case"naturalEarth":return new sW(c);case"equalEarth":return new iW(c);case"winkelTripel":return new lW(c);case"albers":return s?new $P(c):new nW(c);case"lambertConformalConic":return s?new $P(c):new oW(c);case"globe":return new cW(c)}throw new Error(`Invalid projection name: ${c.name}`)}const uW=Ot.types,hW=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cx(c,i,s,f,A,g,_,C,T,P,k,N,j){const X=C?Math.min(rg,Math.round(C[0])):0,Y=C?Math.min(rg,Math.round(C[1])):0;c.emplaceBack(i,s,Math.round(32*f),Math.round(32*A),g,_,(X<<1)+(T?1:0),Y,16*P,16*k,256*N,256*j)}function Sx(c,i,s){c.emplaceBack(i,s)}function Tx(c,i,s,f,A,g,_){c.emplaceBack(i,s,f,A,g,_)}const Ix=(c,i,s,f)=>{for(let A=0;A<i;A++)c.emplaceBack(s[0],s[1],s[2],f[0],f[1],f[2])};function Fx(c,i,s,f,A){c.emplaceBack(i,s,f,A),c.emplaceBack(i,s,f,A),c.emplaceBack(i,s,f,A),c.emplaceBack(i,s,f,A)}function fW(c){for(const i of c.sections)if(bf(i.text))return!0;return!1}class hB{constructor(i){this.layoutVertexArray=new Fu,this.indexArray=new Ua,this.programConfigurations=i,this.segments=new no,this.dynamicLayoutVertexArray=new Xh,this.opacityVertexArray=new Om,this.placedSymbolArray=new Ap,this.iconTransitioningVertexArray=new Zh,this.globeExtVertexArray=new UA,this.zOffsetVertexArray=new yd,this.orientationVertexArray=new km}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(i,s,f,A,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,gK.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,vK.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,hW,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,wK.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,_K.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||g)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,yK.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=i.createVertexBuffer(this.orientationVertexArray,xK.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||A)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Mr(hB,"SymbolBuffers");class fB{constructor(i,s,f){this.layoutVertexArray=new i,this.layoutAttributes=s,this.indexArray=new f,this.segments=new no,this.collisionVertexArray=new NA,this.collisionVertexArrayExt=new Xh}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,bK.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,EK.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Mr(fB,"CollisionBuffers");class Px{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.lut=i.lut,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(_=>_.fqid),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=R([]),this.placementViewportMatrix=R([]);const s=this.layers[0]._unevaluatedLayout._values;this.worldview=i.worldview,this.textSizeData=BP(this.zoom,s["text-size"],this.worldview),this.iconSizeData=BP(this.zoom,s["icon-size"],this.worldview);const f=this.layers[0].layout,A=f.get("symbol-sort-key"),g=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&A.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(_=>nf[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1}createArrays(){this.text=new hB(new Pu(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("text")||i.startsWith("symbol"))),this.icon=new hB(new Pu(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("icon")||i.startsWith("symbol"))),this.glyphOffsetArray=new Gp,this.lineVertexArray=new zg,this.symbolInstances=new jm}calculateGlyphDependencies(i,s,f,A,g){for(const _ of i){const C=_.codePointAt(0);if(C===void 0)break;if(s[C]=!0,A&&g&&C<=65535){const T=Zv[_];T&&(s[T.charCodeAt(0)]=!0)}}}updateFootprints(i,s){}updateReplacement(i,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const f=s.getReplacementRegionsForTile(i.toUnwrapped(),!0);return!ox(this.activeReplacements,f)&&(this.activeReplacements=f,!0)}populate(i,s,f,A){const g=this.layers[0],_=g.layout,C=this.projection.name==="globe",T=_.get("text-font"),P=_.get("text-field"),k=_.get("icon-image"),[N,j]=_.get("icon-size-scale-range"),X=je(s.scaleFactor||1,N,j),Y=(P.value.kind!=="constant"||P.value.value instanceof zs&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),ae=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,ue=_.get("symbol-sort-key");if(this.features=[],!Y&&!ae)return;const ge=s.iconDependencies,Pe=s.glyphDependencies,Te=s.availableImages,Ue=new oa(this.zoom,{worldview:this.worldview});for(const{feature:At,id:at,index:ot,sourceLayerIndex:_t}of i){const wt=g._featureFilter.needGeometry,Yt=zt(At,wt);if(!g._featureFilter.filter(Ue,Yt,f))continue;if(wt||(Yt.geometry=ht(At,f,A)),C&&At.type!==1&&f.z<=5){const xr=Yt.geometry,Tr=.98078528056,$t=(wr,Mt)=>xt(pn(wr.x,wr.y,f,1),pn(Mt.x,Mt.y,f,1))<Tr;for(let wr=0;wr<xr.length;wr++)xr[wr]=kt(xr[wr],$t)}let Ft,ir;if(Y){const xr=g.getValueAndResolveTokens("text-field",Yt,f,Te),Tr=zs.factory(xr);fW(Tr)&&(this.hasRTLText=!0),(!this.hasRTLText||gd()==="unavailable"||this.hasRTLText&&au.isParsed())&&(Ft=CK(Tr,g,Yt))}if(ae){const xr=g.getValueAndResolveTokens("icon-image",Yt,f,Te);ir=typeof xr=="string"?fl.build(xr):xr}if(!Ft&&!ir)continue;const Ir=this.sortFeaturesByKey?ue.evaluate(Yt,{},f):void 0,cr={id:at,text:Ft,icon:ir,index:ot,sourceLayerIndex:_t,geometry:Yt.geometry,properties:At.properties,type:uW[At.type],sortKey:Ir};if(this.features.push(cr),ir){const xr=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Tr,iconSecondary:$t}=zP(ir,this.iconSizeData,xr["icon-size"],f,this.zoom,cr,this.pixelRatio,X,this.worldview),wr=Tr.id.toString();if(ge.has(wr)?ge.get(wr).push(Tr):ge.set(wr,[Tr]),$t){this.hasAnySecondaryIcon=!0;const Mt=$t.id.toString();ge.has(Mt)?ge.get(Mt).push($t):ge.set(Mt,[$t])}}if(Ft){const xr=T.evaluate(Yt,{},f).join(","),Tr=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(nf.vertical)>=0;for(const $t of Ft.sections)if($t.image){const wr=$t.image.getPrimary().scaleSelf(this.pixelRatio),Mt=wr.id.toString(),Xt=ge.get(Mt)||[];Xt.push(wr),ge.set(Mt,Xt)}else{const wr=us(Ft.toString()),Mt=$t.fontStack||xr,Xt=Pe[Mt]=Pe[Mt]||{};this.calculateGlyphDependencies($t.text,Xt,Tr,this.allowVerticalPlacement,wr)}}}if(_.get("symbol-placement")==="line"&&(this.features=function(At){const at={},ot={},_t=[];let wt=0;function Yt(cr){_t.push(At[cr]),wt++}function Ft(cr,xr,Tr){const $t=ot[cr];return delete ot[cr],ot[xr]=$t,_t[$t].geometry[0].pop(),_t[$t].geometry[0]=_t[$t].geometry[0].concat(Tr[0]),$t}function ir(cr,xr,Tr){const $t=at[xr];return delete at[xr],at[cr]=$t,_t[$t].geometry[0].shift(),_t[$t].geometry[0]=Tr[0].concat(_t[$t].geometry[0]),$t}function Ir(cr,xr,Tr){const $t=Tr?xr[0][xr[0].length-1]:xr[0][0];return`${cr}:${$t.x}:${$t.y}`}for(let cr=0;cr<At.length;cr++){const xr=At[cr],Tr=xr.geometry,$t=xr.text?xr.text.toString():null;if(!$t){Yt(cr);continue}const wr=Ir($t,Tr),Mt=Ir($t,Tr,!0);if(wr in ot&&Mt in at&&ot[wr]!==at[Mt]){const Xt=ir(wr,Mt,Tr),Fr=Ft(wr,Mt,_t[Xt].geometry);delete at[wr],delete ot[Mt],ot[Ir($t,_t[Fr].geometry,!0)]=Fr,_t[Xt].geometry=null}else wr in ot?Ft(wr,Mt,Tr):Mt in at?ir(wr,Mt,Tr):(Yt(cr),at[wr]=wt-1,ot[Mt]=wt-1)}return _t.filter(cr=>cr.geometry)}(this.features)),_.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",s.elevationFeatures){!this.elevationFeatures&&s.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const At of s.elevationFeatures)this.elevationFeatureIdToIndex.set(At.id,this.elevationFeatures.length),this.elevationFeatures.push(At)}}else _.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((At,at)=>At.sortKey-at.sortKey)}update(i,s,f,A,g,_,C){this.text.programConfigurations.updatePaintArrays(i,s,g,f,A,_,C,this.worldview),this.icon.programConfigurations.updatePaintArrays(i,s,g,f,A,_,C,this.worldview)}updateRoadElevation(i){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let s=!1;const f=Ye(i),A=1/f;let g=!1,_=!1;for(let C=0;C<this.symbolInstances.length;C++){const T=this.symbolInstances.get(C),P=st(1,0,0),k=st(0,1,0),{numHorizontalGlyphVertices:N,numVerticalGlyphVertices:j,numIconVertices:X,numVerticalIconVertices:Y}=T,ae=N>0||j>0,ue=X>0,ge=this.elevationFeatures[T.elevationFeatureIndex];if(ge){const Pe=new hr(T.tileAnchorX,T.tileAnchorY),Te=.075+ge.pointElevation(Pe);T.zOffset!==Te&&(s=!0,T.zOffset=Te);const Ue=ge.computeSlopeNormal(Pe,A),At=vi(Ci(),st(0,0,1),Ue);Zt(P,P,At),Zt(k,k,At),P[2]*=f,k[2]*=f,P[0]===1&&P[1]===0&&P[2]===0&&k[0]===0&&k[1]===1&&k[2]===0||(g=g||ae,_=_||ue)}if(ae&&(Ix(this.text.orientationVertexArray,N,P,k),Ix(this.text.orientationVertexArray,j,P,k)),ue){const{placedIconSymbolIndex:Pe,verticalPlacedIconSymbolIndex:Te}=T;Pe>=0&&Ix(this.icon.orientationVertexArray,X,P,k),Te>=0&&Ix(this.icon.orientationVertexArray,Y,P,k)}}g||(this.text.orientationVertexArray=void 0),_||(this.icon.orientationVertexArray=void 0),s&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const i=(g,_,C)=>{f+=_,f>g.length&&g.resize(f);for(let T=-_;T<0;T++)g.emplace(T+f,C)},s=(g,_,C)=>{A+=_,A>g.length&&g.resize(A);for(let T=-_;T<0;T++)g.emplace(T+A,C)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let f=0,A=0;for(let g=0;g<this.symbolInstances.length;g++){const _=this.symbolInstances.get(g),{numHorizontalGlyphVertices:C,numVerticalGlyphVertices:T,numIconVertices:P}=_,k=_.zOffset,N=P>0;if((C>0||T>0)&&(i(this.text.zOffsetVertexArray,C,k),i(this.text.zOffsetVertexArray,T,k)),N){const{placedIconSymbolIndex:j,verticalPlacedIconSymbolIndex:X}=_;j>=0&&s(this.icon.zOffsetVertexArray,P,k),X>=0&&s(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,k)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=XP(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,s){const f=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:A,y:g}of s)this.lineVertexArray.emplaceBack(A,g);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae,ue){const ge=i.indexArray,Pe=i.layoutVertexArray,Te=i.globeExtVertexArray,Ue=i.segments.prepareSegment(4*s.length,Pe,ge,this.canOverlap?_.sortKey:void 0),At=this.glyphOffsetArray.length,at=Ue.vertexLength,ot=this.allowVerticalPlacement&&C===nf.vertical?Math.PI/2:0,_t=_.text&&_.text.sections;for(let Yt=0;Yt<s.length;Yt++){const{tl:Ft,tr:ir,bl:Ir,br:cr,texPrimary:xr,texSecondary:Tr,pixelOffsetTL:$t,pixelOffsetBR:wr,minFontScaleX:Mt,minFontScaleY:Xt,glyphOffset:Fr,isSDF:Er,sectionIndex:mn}=s[Yt],on=Ue.vertexLength,vr=Fr[1];if(Cx(Pe,P.x,P.y,Ft.x,vr+Ft.y,xr.x,xr.y,f,Er,$t.x,$t.y,Mt,Xt),Cx(Pe,P.x,P.y,ir.x,vr+ir.y,xr.x+xr.w,xr.y,f,Er,wr.x,$t.y,Mt,Xt),Cx(Pe,P.x,P.y,Ir.x,vr+Ir.y,xr.x,xr.y+xr.h,f,Er,$t.x,wr.y,Mt,Xt),Cx(Pe,P.x,P.y,cr.x,vr+cr.y,xr.x+xr.w,xr.y+xr.h,f,Er,wr.x,wr.y,Mt,Xt),T){const{x:Cr,y:fn,z:tn}=T.anchor,[Dr,nn,Cn]=T.up;Tx(Te,Cr,fn,tn,Dr,nn,Cn),Tx(Te,Cr,fn,tn,Dr,nn,Cn),Tx(Te,Cr,fn,tn,Dr,nn,Cn),Tx(Te,Cr,fn,tn,Dr,nn,Cn),Fx(i.dynamicLayoutVertexArray,Cr,fn,tn,ot)}else Fx(i.dynamicLayoutVertexArray,P.x,P.y,P.z,ot);if(ue){const Cr=Tr||xr;Sx(i.iconTransitioningVertexArray,Cr.x,Cr.y),Sx(i.iconTransitioningVertexArray,Cr.x+Cr.w,Cr.y),Sx(i.iconTransitioningVertexArray,Cr.x,Cr.y+Cr.h),Sx(i.iconTransitioningVertexArray,Cr.x+Cr.w,Cr.y+Cr.h)}ge.emplaceBack(on,on+1,on+2),ge.emplaceBack(on+1,on+2,on+3),Ue.vertexLength+=4,Ue.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Fr[0]),Yt!==s.length-1&&mn===s[Yt+1].sectionIndex||i.programConfigurations.populatePaintArrays(Pe.length,_,_.index,{},X,Y,ae,_t&&_t[mn],this.worldview)}const wt=T?T.anchor:P;i.placedSymbolArray.emplaceBack(wt.x,wt.y,wt.z,P.x,P.y,At,this.glyphOffsetArray.length-At,at,k,N,P.segment,f?f[0]:0,f?f[1]:0,A[0],A[1],C,0,0,0,j,0)}_commitLayoutVertex(i,s,f,A,g,_,C){i.emplaceBack(s,f,A,g,_,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(i,s,f,A,g,_,C){const T=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),P=T.vertexLength,k=C.tileAnchorX,N=C.tileAnchorY;for(let X=0;X<4;X++)f.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(f.collisionVertexArrayExt,s,i.padding,C.zOffset),this._commitLayoutVertex(f.layoutVertexArray,A,g,_,k,N,new hr(i.x1,i.y1)),this._commitLayoutVertex(f.layoutVertexArray,A,g,_,k,N,new hr(i.x2,i.y1)),this._commitLayoutVertex(f.layoutVertexArray,A,g,_,k,N,new hr(i.x2,i.y2)),this._commitLayoutVertex(f.layoutVertexArray,A,g,_,k,N,new hr(i.x1,i.y2)),T.vertexLength+=4;const j=f.indexArray;j.emplaceBack(P,P+1),j.emplaceBack(P+1,P+2),j.emplaceBack(P+2,P+3),j.emplaceBack(P+3,P),T.primitiveLength+=4}_addTextDebugCollisionBoxes(i,s,f,A,g,_){for(let C=A;C<g;C++){const T=f.get(C),P=this.getSymbolInstanceTextSize(i,_,s,C);this._addCollisionDebugVertices(T,P,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(i,s,f,A,g,_){for(let C=A;C<g;C++){const T=f.get(C),P=this.getSymbolInstanceIconSize(i,s,_.placedIconSymbolIndex);this._addCollisionDebugVertices(T,P,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}generateCollisionDebugBuffers(i,s,f){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fB(cp,uP.members,Zh),this.iconCollisionBox=new fB(cp,uP.members,Zh);const A=Jv(this.iconSizeData,i),g=Jv(this.textSizeData,i,f);for(let _=0;_<this.symbolInstances.length;_++){const C=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(g,i,s,C.textBoxStartIndex,C.textBoxEndIndex,C),this._addTextDebugCollisionBoxes(g,i,s,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C),this._addIconDebugCollisionBoxes(A,i,s,C.iconBoxStartIndex,C.iconBoxEndIndex,C),this._addIconDebugCollisionBoxes(A,i,s,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C)}}getSymbolInstanceTextSize(i,s,f,A){const g=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:A),_=iB(this.textSizeData,i,g)/Wl;return this.tilePixelRatio*_}getSymbolInstanceIconSize(i,s,f){const A=this.icon.placedSymbolArray.get(f),g=iB(this.iconSizeData,i,A);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(i,s,f,A){i.emplaceBack(s,-f,-f,A),i.emplaceBack(s,f,-f,A),i.emplaceBack(s,f,f,A),i.emplaceBack(s,-f,f,A)}_updateTextDebugCollisionBoxes(i,s,f,A,g,_,C){for(let T=A;T<g;T++){const P=f.get(T),k=this.getSymbolInstanceTextSize(i,_,s,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,P.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(i,s,f,A,g,_,C){for(let T=A;T<g;T++){const P=f.get(T),k=this.getSymbolInstanceIconSize(i,s,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,P.padding,_.zOffset)}}updateCollisionDebugBuffers(i,s,f,A){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const g=Jv(this.iconSizeData,i,A),_=Jv(this.textSizeData,i,f);for(let C=0;C<this.symbolInstances.length;C++){const T=this.symbolInstances.get(C);this._updateTextDebugCollisionBoxes(_,i,s,T.textBoxStartIndex,T.textBoxEndIndex,T,f),this._updateTextDebugCollisionBoxes(_,i,s,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T,f),this._updateIconDebugCollisionBoxes(g,i,s,T.iconBoxStartIndex,T.iconBoxEndIndex,T,A),this._updateIconDebugCollisionBoxes(g,i,s,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T,A)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,s,f,A,g,_,C,T,P){const k={};if(s<f){const{x1:N,y1:j,x2:X,y2:Y,padding:ae,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Pe,tileAnchorX:Te,tileAnchorY:Ue,featureIndex:At}=i.get(s);k.textBox={x1:N,y1:j,x2:X,y2:Y,padding:ae,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Pe,tileAnchorX:Te,tileAnchorY:Ue},k.textFeatureIndex=At}if(A<g){const{x1:N,y1:j,x2:X,y2:Y,padding:ae,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Pe,tileAnchorX:Te,tileAnchorY:Ue,featureIndex:At}=i.get(A);k.verticalTextBox={x1:N,y1:j,x2:X,y2:Y,padding:ae,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Pe,tileAnchorX:Te,tileAnchorY:Ue},k.verticalTextFeatureIndex=At}if(_<C){const{x1:N,y1:j,x2:X,y2:Y,padding:ae,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Pe,tileAnchorX:Te,tileAnchorY:Ue,featureIndex:At}=i.get(_);k.iconBox={x1:N,y1:j,x2:X,y2:Y,padding:ae,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Pe,tileAnchorX:Te,tileAnchorY:Ue},k.iconFeatureIndex=At}if(T<P){const{x1:N,y1:j,x2:X,y2:Y,padding:ae,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Pe,tileAnchorX:Te,tileAnchorY:Ue,featureIndex:At}=i.get(T);k.verticalIconBox={x1:N,y1:j,x2:X,y2:Y,padding:ae,projectedAnchorX:ue,projectedAnchorY:ge,projectedAnchorZ:Pe,tileAnchorX:Te,tileAnchorY:Ue},k.verticalIconFeatureIndex=At}return k}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const f=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,s){const f=i.placedSymbolArray.get(s),A=f.vertexStartIndex+4*f.numGlyphs;for(let g=f.vertexStartIndex;g<A;g+=4)i.indexArray.emplaceBack(g,g+1,g+2),i.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(i),f=Math.cos(i),A=[],g=[],_=[];for(let C=0;C<this.symbolInstances.length;++C){_.push(C);const T=this.symbolInstances.get(C);A.push(0|Math.round(s*T.tileAnchorX+f*T.tileAnchorY)),g.push(T.featureIndex)}return _.sort((C,T)=>A[C]-A[T]||g[T]-g[C]),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((i,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(i).zOffset)}addToSortKeyRanges(i,s){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===s?f.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const f=this.symbolInstances.get(s);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:P}=f;A>=0&&this.addIndicesForPlacedSymbol(this.text,A),g>=0&&g!==A&&this.addIndicesForPlacedSymbol(this.text,g),_>=0&&_!==g&&_!==A&&this.addIndicesForPlacedSymbol(this.text,_),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ZP,YP,AB;Mr(Px,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Px.addDynamicAttributes=Fx;class JP{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:xo,this.defaultValue=i}evaluate(i){if(i.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(i.formattedSection))return s.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Mr(JP,"FormatSectionOverride",{omit:["defaultValue"]});const dB=()=>AB||(AB={layout:ZP||(ZP=new _a({"symbol-placement":new ur(Bt.layout_symbol["symbol-placement"]),"symbol-spacing":new ur(Bt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ur(Bt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Kr(Bt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ur(Bt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new ur(Bt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new ur(Bt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new ur(Bt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ur(Bt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ur(Bt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ur(Bt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Kr(Bt.layout_symbol["icon-size"]),"icon-size-scale-range":new ur(Bt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Kr(Bt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kr(Bt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Kr(Bt.layout_symbol["icon-image"]),"icon-rotate":new Kr(Bt.layout_symbol["icon-rotate"]),"icon-padding":new ur(Bt.layout_symbol["icon-padding"]),"icon-keep-upright":new ur(Bt.layout_symbol["icon-keep-upright"]),"icon-offset":new Kr(Bt.layout_symbol["icon-offset"]),"icon-anchor":new Kr(Bt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ur(Bt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ur(Bt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ur(Bt.layout_symbol["text-rotation-alignment"]),"text-field":new Kr(Bt.layout_symbol["text-field"]),"text-font":new Kr(Bt.layout_symbol["text-font"]),"text-size":new Kr(Bt.layout_symbol["text-size"]),"text-size-scale-range":new ur(Bt.layout_symbol["text-size-scale-range"]),"text-max-width":new Kr(Bt.layout_symbol["text-max-width"]),"text-line-height":new Kr(Bt.layout_symbol["text-line-height"]),"text-letter-spacing":new Kr(Bt.layout_symbol["text-letter-spacing"]),"text-justify":new Kr(Bt.layout_symbol["text-justify"]),"text-radial-offset":new Kr(Bt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ur(Bt.layout_symbol["text-variable-anchor"]),"text-anchor":new Kr(Bt.layout_symbol["text-anchor"]),"text-max-angle":new ur(Bt.layout_symbol["text-max-angle"]),"text-writing-mode":new ur(Bt.layout_symbol["text-writing-mode"]),"text-rotate":new Kr(Bt.layout_symbol["text-rotate"]),"text-padding":new ur(Bt.layout_symbol["text-padding"]),"text-keep-upright":new ur(Bt.layout_symbol["text-keep-upright"]),"text-transform":new Kr(Bt.layout_symbol["text-transform"]),"text-offset":new Kr(Bt.layout_symbol["text-offset"]),"text-allow-overlap":new ur(Bt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ur(Bt.layout_symbol["text-ignore-placement"]),"text-optional":new ur(Bt.layout_symbol["text-optional"]),visibility:new ur(Bt.layout_symbol.visibility)})),paint:YP||(YP=new _a({"icon-opacity":new Kr(Bt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Kr(Bt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Kr(Bt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Kr(Bt.paint_symbol["text-emissive-strength"]),"icon-color":new Kr(Bt.paint_symbol["icon-color"]),"icon-halo-color":new Kr(Bt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Kr(Bt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Kr(Bt.paint_symbol["icon-halo-blur"]),"icon-translate":new ur(Bt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ur(Bt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new ur(Bt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Kr(Bt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Kr(Bt.paint_symbol["text-occlusion-opacity"]),"text-color":new Kr(Bt.paint_symbol["text-color"],{runtimeType:Ka,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Kr(Bt.paint_symbol["text-halo-color"]),"text-halo-width":new Kr(Bt.paint_symbol["text-halo-width"]),"text-halo-blur":new Kr(Bt.paint_symbol["text-halo-blur"]),"text-translate":new ur(Bt.paint_symbol["text-translate"]),"text-translate-anchor":new ur(Bt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new ur(Bt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new ur(Bt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new ur(Bt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new ur(Bt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Kr(Bt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},AB);class Lx extends Ks{constructor(i,s,f,A){super(i,dB(),s,f,A),this._colorAdjustmentMatrix=R([]),this.hasInitialOcclusionOpacityProperties=i.paint!==void 0&&("icon-occlusion-opacity"in i.paint||"text-occlusion-opacity"in i.paint)}recalculate(i,s){super.recalculate(i,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const A=[];for(const g of f)A.indexOf(g)<0&&A.push(g);this.layout._values["text-writing-mode"]=A}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(i,s,f,A){return this._saturation===i&&this._contrast===s&&this._brightnessMin===f&&this._brightnessMax===A||(this._colorAdjustmentMatrix=function(g,_,C,T){g=es(g),_=Ra(_);const P=U(),k=g/3,N=1-2*k,j=[N,k,k,0,k,N,k,0,k,k,N,0,0,0,0,1],X=.5-.5*_,Y=T-C;return q(P,[Y,0,0,0,0,Y,0,0,0,0,Y,0,C,C,C,1],[_,0,0,0,0,_,0,0,0,0,_,0,X,X,X,1]),q(P,P,j),P}(i,s,f,A),this._saturation=i,this._contrast=s,this._brightnessMin=f,this._brightnessMax=A),this._colorAdjustmentMatrix}getValueAndResolveTokens(i,s,f,A){const g=this.layout.get(i).evaluate(s,{},f,A),_=this._unevaluatedLayout._values[i];return _.isDataDriven()||Ko(_.value)||!g?g:function(C,T){return T.replace(/{([^{}]+)}/g,(P,k)=>k in C?String(C[k]):"")}(s.properties,g)}createBucket(i){return new Px(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of dB().paint.overridableProperties){if(!Lx.hasPaintOverride(this.layout,i))continue;const s=this.paint.get(i),f=new JP(s),A=new ys(f,s.property.specification,this.scope,this.options);let g=null;g=s.value.kind==="constant"||s.value.kind==="source"?new Ps("source",A):new ro("composite",A,s.value.zoomStops,s.value.interpolationType),this.paint._values[i]=new Tu(s.property,g,s.parameters)}}_handleOverridablePaintPropertyUpdate(i,s,f){return!(!this.layout||s.isDataDriven()||f.isDataDriven())&&Lx.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,s){const f=i.get("text-field"),A=dB().paint.properties[s];let g=!1;const _=C=>{for(const T of C)if(A.overrides&&A.overrides.hasOverride(T))return void(g=!0)};if(f.value.kind==="constant"&&f.value.value instanceof zs)_(f.value.value.sections);else if(f.value.kind==="source"){const C=P=>{g||(P instanceof bn&&Rr(P.value)===Af?_(P.value.sections):P instanceof Qs?_(P.sections):P.eachChild(C))},T=f.value;T._styleExpression&&C(T._styleExpression.expression)}return g}getProgramIds(){return["symbol"]}getDefaultProgramParams(i,s,f){return{config:new Ds(this,{zoom:s,lut:f}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let eL,tL,rL,nL;var pB=Di([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Mx(c,i,s,f,A,g,_,C){const T=[c,i,1,s,f,1,A,g,1],P=[_,C,1],k=M([],T),[N,j,X]=mr(P,P,k);return L(T,T,[N,0,0,0,j,0,0,0,X])}function iL(c,i,s,f,A,g,_,C){const T=function(P,k,N,j,X,Y,ae,ue){const ge=Mx(0,0,1,0,1,1,0,1),Pe=Mx(P,k,N,j,X,Y,ae,ue);return L(Pe,Pe,M([],ge))}(c,i,s,f,A,g,_,C);return[T[2]/T[8]/Lr,T[5]/T[8]/Lr]}function Ox(c){return[c[0],Math.min(Math.max(c[1],-$e),$e)]}class aL extends yu{constructor(i,s,f,A){super(),this.id=i,this.dispatcher=f,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(A),this.options=s,this._dirty=!1}load(i,s){if(this._loaded=s||!1,this.fire(new rc("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=tc(this.map._requestManager.transformRequest(this.url,Ec.Image),(f,A)=>{this._imageRequest=null,this._loaded=!0,f?this.fire(new ts(f)):A&&(this.image=A instanceof HTMLImageElement?bc.getImageData(A):A,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new qv(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new rc("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(i){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof qv||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,this._unsupportedCoords=!1,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=i[0][1],f=i[0][1];for(const g of i)g[1]>f&&(f=g[1]),g[1]<s&&(s=g[1]);const A=(f+s)/2;if(A>$e?this.onNorthPole=!0:A<-$e&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const g=i.map(tt.fromLngLat);this.tileID=function(_){let C=1/0,T=1/0,P=-1/0,k=-1/0;for(const ae of _)C=Math.min(C,ae.x),T=Math.min(T,ae.y),P=Math.max(P,ae.x),k=Math.max(k,ae.y);const N=Math.max(P-C,k-T),j=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),X=Math.pow(2,j);let Y=Math.floor((C+P)/2*X);return Y>1&&(Y-=1),new kc(j,Y,Math.floor((T+k)/2*X))}(g),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new rc("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof qv||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(i){for(const ge in this.tiles){const Pe=this.tiles[ge];Pe.state!=="loaded"&&(Pe.state="loaded",Pe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=ny(new kc(0,0,0),this.map.transform.projection),f=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ge){const Pe=ge[1].x-ge[0].x,Te=ge[1].y-ge[0].y,Ue=ge[2].x-ge[1].x,At=ge[2].y-ge[1].y,at=ge[3].x-ge[2].x,ot=ge[3].y-ge[2].y,_t=ge[0].x-ge[3].x,wt=ge[0].y-ge[3].y,Yt=Pe*At-Ue*Te,Ft=Ue*ot-at*At,ir=at*wt-_t*ot,Ir=_t*Te-Pe*wt;return Yt>0&&Ft>0&&ir>0&&Ir>0||Yt<0&&Ft<0&&ir<0&&Ir<0}(f))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const A=ny(this.tileID,this.map.transform.projection),[g,_,C,T]=this.coordinates.map(ge=>{const Pe=A.projection.project(ge[0],ge[1]);return GP(A,Pe)._round()});this.perspectiveTransform=iL(g.x,g.y,_.x,_.y,C.x,C.y,T.x,T.y);const P=this._boundsArray=new vd;P.emplaceBack(g.x,g.y,0,0),P.emplaceBack(_.x,_.y,Lr,0),P.emplaceBack(T.x,T.y,0,Lr),P.emplaceBack(C.x,C.y,Lr,Lr),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=i.createVertexBuffer(P,pB.members),this.boundsSegments=no.simpleSegment(0,0,4,2);const k=[],N=[Ox((j=this.coordinates)[0]),Ox(j[1]),Ox(j[2]),Ox(j[3])];var j;const[X,Y,ae,ue]=function(ge){let Pe=ge[0][0],Te=Pe,Ue=ge[0][1],At=Ue;for(let at=1;at<ge.length;at++)ge[at][0]<Pe?Pe=ge[at][0]:ge[at][0]>Te&&(Te=ge[at][0]),ge[at][1]<Ue?Ue=ge[at][1]:ge[at][1]>At&&(At=ge[at][1]);return[Pe,Ue,Te-Pe,At-Ue]}(N);{const ge=new vd,[Pe,Te,Ue,At]=function($t){let wr=$t[0].x,Mt=wr,Xt=$t[0].y,Fr=Xt;for(let Er=1;Er<$t.length;Er++)$t[Er].x<wr?wr=$t[Er].x:$t[Er].x>Mt&&(Mt=$t[Er].x),$t[Er].y<Xt?Xt=$t[Er].y:$t[Er].y>Fr&&(Fr=$t[Er].y);return[wr,Xt,Mt-wr,Fr-Xt]}(f),at=$t=>[($t.x-Pe)/Ue,($t.y-Te)/At],[ot,_t,wt,Yt]=f.map(at),Ft=function($t,wr,Mt,Xt,Fr,Er,mn,on){const vr=Mx(0,0,1,0,1,1,0,1);return L(vr,vr,M([],Mx($t,wr,Mt,Xt,Fr,Er,mn,on)))}(ot[0],ot[1],_t[0],_t[1],wt[0],wt[1],Yt[0],Yt[1]);this.elevatedGlobePerspectiveTransform=iL(ot[0],ot[1],_t[0],_t[1],wt[0],wt[1],Yt[0],Yt[1]);const ir=($t,wr)=>{k.push($t.lng);const Mt=Math.round(($t.lng-X)/ae*Lr),Xt=Math.round(($t.lat-Y)/ue*Lr),Fr=at(wr),Er=mr([],[Fr[0],Fr[1],1],Ft),mn=Math.round(Er[0]/Er[2]*Lr),on=Math.round(Er[1]/Er[2]*Lr);ge.emplaceBack(Mt,Xt,mn,on)},Ir=f[3].x-f[0].x,cr=f[3].y-f[0].y,xr=f[2].x-f[1].x,Tr=f[2].y-f[1].y;for(let $t=0;$t<65;$t++){const wr=$t/64,Mt=[f[0].x+wr*Ir,f[0].y+wr*cr],Xt=[f[1].x+wr*xr,f[1].y+wr*Tr],Fr=Xt[0]-Mt[0],Er=Xt[1]-Mt[1];for(let mn=0;mn<65;mn++){const on=mn/64,vr={x:Mt[0]+Fr*on,y:Mt[1]+Er*on};ir(s.projection.unproject(vr.x,vr.y),vr)}}this.elevatedGlobeVertexBuffer=i.createVertexBuffer(ge,pB.members)}{this.maxLongitudeTriangleSize=0;let ge=[],Pe=new Ua;const Te=(Ue,At,at)=>{Pe.emplaceBack(Ue,At,at);const ot=k[Ue],_t=k[At],wt=k[at],Yt=Math.min(Math.min(ot,_t),wt),Ft=Math.max(Math.max(ot,_t),wt)-Yt;Ft>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ft),ge.push(Yt+Ft/2)};for(let Ue=0;Ue<64;Ue++)for(let At=0;At<64;At++){const at=65*Ue+At,ot=at+1,_t=at+65,wt=_t+1;Te(at,_t,ot),Te(ot,_t,wt)}[ge,Pe]=function(Ue,At){const at=Array.from({length:Ue.length},(wt,Yt)=>Yt);at.sort((wt,Yt)=>Ue[wt]-Ue[Yt]);const ot=[],_t=new Ua;for(let wt=0;wt<at.length;wt++){const Yt=at[wt];ot.push(Ue[Yt]);const Ft=3*Yt,ir=Ft+1;_t.emplaceBack(At.uint16[Ft],At.uint16[ir],At.uint16[ir+1])}return[ot,_t]}(ge,Pe),this.elevatedGlobeTrianglesCenterLongitudes=ge,this.elevatedGlobeIndexBuffer=i.createIndexBuffer(Pe)}this.elevatedGlobeSegments=no.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,ae/Lr,0,ue/Lr,0,0,Y,X,0])}prepare(){const i=Object.keys(this.tiles).length!==0;if(this.tileID&&!i)return;const s=this.map.painter.context,f=s.gl;!this._dirty||this.texture instanceof qv||(this.texture?this.texture.update(this.image):(this.texture=new VE(s,this.image,f.RGBA8),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(s)}loadTile(i,s){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},s(null)):(i.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(i){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const f=this.elevatedGlobeTrianglesCenterLongitudes;let A=(g=i+180)+360*Math.round((f[0]-g)/360);var g;const _=new no,C=(N,j)=>{_.segments.push({vertexOffset:0,primitiveOffset:N,vertexLength:s.segments[0].vertexLength,primitiveLength:j,sortKey:void 0,vaos:{}})},T=.51*this.maxLongitudeTriangleSize;if(Math.abs(f[0]-A)<=T){const N=Ya(f,0,f.length,A+T);return N===f.length||C(N,sa(f,N+1,f.length,A+360-T)-N),_}A<f[0]&&(A+=360);const P=sa(f,0,f.length,A-T);if(P===f.length)return C(0,f.length),_;C(0,P-0);const k=Ya(f,P+1,f.length,A+T);return k!==f.length&&C(k,f.length-k),_}}const AW=(Math.pow(256,2)-1)/16907520;class oL extends Ks{constructor(i,s,f,A){super(i,{layout:rL||(rL=new _a({visibility:new ur(Bt.layout_raster.visibility)})),paint:nL||(nL=new _a({"raster-opacity":new ur(Bt.paint_raster["raster-opacity"]),"raster-color":new Eh(Bt.paint_raster["raster-color"]),"raster-color-mix":new ur(Bt.paint_raster["raster-color-mix"]),"raster-color-range":new ur(Bt.paint_raster["raster-color-range"]),"raster-hue-rotate":new ur(Bt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ur(Bt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ur(Bt.paint_raster["raster-brightness-max"]),"raster-saturation":new ur(Bt.paint_raster["raster-saturation"]),"raster-contrast":new ur(Bt.paint_raster["raster-contrast"]),"raster-resampling":new ur(Bt.paint_raster["raster-resampling"]),"raster-fade-duration":new ur(Bt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new ur(Bt.paint_raster["raster-emissive-strength"]),"raster-array-band":new ur(Bt.paint_raster["raster-array-band"]),"raster-elevation":new ur(Bt.paint_raster["raster-elevation"]),"raster-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},s,f,A),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(i){return!(i&&i._source instanceof aL&&(i._source.onNorthPole||i._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(i){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[f,A]=i||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(f)&&isNaN(A)||f===this._curRampRange[0]&&A===this._curRampRange[1]||(this.colorRamp=Mv({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:f,end:A}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[f,A])}}let sL,lL,cL,uL,hL;class fL extends Ks{constructor(i,s,f,A){super(i,{layout:sL||(sL=new _a({visibility:new ur(Bt["layout_raster-particle"].visibility)})),paint:lL||(lL=new _a({"raster-particle-array-band":new ur(Bt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new ur(Bt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Eh(Bt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new ur(Bt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new ur(Bt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new ur(Bt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new ur(Bt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new ur(Bt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},s,f,A),this._updateColorRamp(),this.lastInvalidatedAt=bc.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(i){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(i){return!1}_handleSpecialPaintPropertyUpdate(i){i!=="raster-particle-color"&&i!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),i==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Mv({expression:i,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=bc.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class dW extends Ks{constructor(i,s){super(i,{},s,null),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(i){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(i){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}function mB(c,i,s){const f=[0,0,1],A=Zn([]);return Ti(A,A,s?-_n(c)+Math.PI:_n(c)),Vi(A,A,-_n(i)),Zt(f,f,A),et(f,f)}const AL={None:0,Model:1,Symbol:2,FillExtrusion:4};class Dx{constructor(i,s,f,A){this.message=(i?`${i}: `:"")+f,A&&(this.identifier=A),s!=null&&s.__line__&&(this.line=s.__line__)}}function gB(c,i){const s=c.indexOf("://")===-1;try{return new URL(c,s&&i?"http://example.com":void 0),!0}catch{return!1}}class dL{constructor(i,s){this.feature=i,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class pL{constructor(){this.instancedDataArray=new jp,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class _B{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=i.projection,this.index=i.index,this.worldview=i.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=i.styleDefinedModelURLs}updateFootprints(i,s){}populate(i,s,f,A){this.tileToMeter=Ye(f);const g=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:_,id:C,index:T,sourceLayerIndex:P}of i){const k=C??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),N=zt(_,g);if(!this.layers[0]._featureFilter.filter(new oa(this.zoom,{worldview:this.worldview}),N,f))continue;const j={id:k,sourceLayerIndex:P,index:T,geometry:g?N.geometry:ht(_,f,A),properties:_.properties,type:_.type,patterns:{}},X=this.addFeature(j,j.geometry,N);X&&s.featureIndex.insert(_,j.geometry,T,P,this.index,this.instancesPerModel[X].instancedDataArray.length,Lr/32)}this.lookup=null}update(i,s,f,A){for(const g in this.instancesPerModel){const _=this.instancesPerModel[g];for(const C in i)_.idToFeaturesIndex.hasOwnProperty(C)&&(this.evaluate(_.features[_.idToFeaturesIndex[C]],i[C],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const s in this.instancesPerModel){const f=this.instancesPerModel[s];for(const A of f.features){const g=this.layers[0],_=A.feature,C=this.canonical,T=g.paint.get("model-rotation").evaluate(_,{},C),P=g.paint.get("model-scale").evaluate(_,{},C),k=g.paint.get("model-translation").evaluate(_,{},C);er(A.rotation,T)&&er(A.scale,P)&&er(A.translation,k)||(this.evaluate(A,A.featureStates,f,!0),i=!0)}}return i}updateReplacement(i,s,f,A){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const g=s.getReplacementRegionsForTile(i.toUnwrapped(),!0);if(ox(this.activeReplacements,g))return!1;this.activeReplacements=g;let _=!1;for(const C in this.instancesPerModel){const T=this.instancesPerModel[C],P=T.instancedDataArray;for(const k of T.features){const N=k.instancedDataOffset,j=k.instancedDataCount;for(let X=0;X<j;X++){const Y=16*(X+N);let ae=P.float32[Y+0];const ue=ae>Lr;ae=ue?ae-Lr:ae;const ge=Math.floor(ae),Pe=P.float32[Y+1];let Te=!1;for(const Ue of this.activeReplacements)if(!r4(Ue,f,AL.Model,A)&&!(Ue.min.x>ge||ge>Ue.max.x||Ue.min.y>Pe||Pe>Ue.max.y)&&(Te=LE(o4(ge,Pe,i.canonical,Ue.footprintTileId.canonical),Ue.footprint),Te))break;P.float32[Y]=Te?ae+Lr:ae,_=_||Te!==ue}}}return _}isEmpty(){for(const i in this.instancesPerModel)if(this.instancesPerModel[i].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const s in this.instancesPerModel){const f=this.instancesPerModel[s];f.instancedDataArray.length<0||f.instancedDataArray.length===0||(f.instancedDataBuffer?f.instancedDataBuffer.updateData(f.instancedDataArray):f.instancedDataBuffer=i.createVertexBuffer(f.instancedDataArray,WG.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const f=this.instancesPerModel[s];f.instancedDataArray.length!==0&&f.instancedDataBuffer&&f.instancedDataBuffer.destroy()}const i=this.layers[0].modelManager;if(i&&this.modelUris&&this.modelsRequested)for(const s of this.modelUris)i.removeModel(s,"",!0)}addFeature(i,s,f){const A=this.layers[0],g=A.layout.get("model-id").evaluate(f,{},this.canonical);if(!g)return Hr(`modelId is not evaluated for layer ${A.id} and it is not going to get rendered.`),g;(gB(g,!1)||this.styleDefinedModelURLs[g]!==void 0)&&(this.modelUris.includes(g)||this.modelUris.push(g)),this.instancesPerModel[g]||(this.instancesPerModel[g]=new pL);const _=this.instancesPerModel[g],C=_.instancedDataArray,T=new dL(f,C.length);for(const P of s)for(const k of P){if(k.x<0||k.x>=Lr||k.y<0||k.y>=Lr)continue;const N=(this.lookupDim-1)/Lr,j=this.lookupDim*(k.y*N|0)+k.x*N|0;if(this.lookup){if(this.lookup[j]!==0)continue;this.lookup[j]=1}this.instanceCount++;const X=C.length;C.resize(X+1),_.instancesEvaluatedElevation.push(0),C.float32[16*X]=k.x,C.float32[16*X+1]=k.y}return T.instancedDataCount=_.instancedDataArray.length-T.instancedDataOffset,T.instancedDataCount>0&&(i.id&&(_.idToFeaturesIndex[i.id]=_.features.length),_.features.push(T),this.evaluate(T,{},_,!1)),g}getModelUris(){return this.modelUris}evaluate(i,s,f,A){const g=this.layers[0],_=i.feature,C=this.canonical,T=i.rotation=g.paint.get("model-rotation").evaluate(_,s,C),P=i.scale=g.paint.get("model-scale").evaluate(_,s,C),k=i.translation=g.paint.get("model-translation").evaluate(_,s,C),N=g.paint.get("model-color").evaluate(_,s,C);N.a=g.paint.get("model-color-mix-intensity").evaluate(_,s,C);const j=[];this.maxVerticalOffset<k[2]&&(this.maxVerticalOffset=k[2]),this.maxScale=Math.max(Math.max(this.maxScale,P[0]),Math.max(P[1],P[2])),Q4(j,T,P);const X=Math.round(100*N.a)+N.b/1.05;for(let Y=0;Y<i.instancedDataCount;++Y){const ae=i.instancedDataOffset+Y,ue=16*ae,ge=f.instancedDataArray.float32;let Pe=0;A&&(Pe=ge[ue+6]-f.instancesEvaluatedElevation[ae]);const Te=0|ge[ue+1];ge[ue]=(0|ge[ue])+N.r/1.05,ge[ue+1]=Te+N.g/1.05,ge[ue+2]=X,ge[ue+3]=1/(C.z>10?this.tileToMeter:Ye(C,Te)),ge[ue+4]=k[0],ge[ue+5]=k[1],ge[ue+6]=k[2]+Pe,ge[ue+7]=j[0],ge[ue+8]=j[1],ge[ue+9]=j[2],ge[ue+10]=j[4],ge[ue+11]=j[5],ge[ue+12]=j[6],ge[ue+13]=j[8],ge[ue+14]=j[9],ge[ue+15]=j[10],f.instancesEvaluatedElevation[ae]=k[2]}}}let mL,gL;Mr(_B,"ModelBucket",{omit:["layers"]}),Mr(pL,"PerModelAttributes"),Mr(dL,"ModelFeature");class h_{constructor(i,s,f){this._demTile=i,this._dem=this._demTile.dem,this._scale=s,this._offset=f}static create(i,s,f){const A=f||i.findDEMTileFor(s);if(!A||!A.dem)return;const g=A.dem,_=A.tileID,C=1<<s.canonical.z-_.canonical.z;return new h_(A,g.dim/Lr/C,[(s.canonical.x/C-_.canonical.x)*g.dim,(s.canonical.y/C-_.canonical.y)*g.dim])}tileCoordToPixel(i,s){const f=s*this._scale+this._offset[1];return new hr(Math.floor(i*this._scale+this._offset[0]),Math.floor(f))}getElevationAt(i,s,f,A){const g=i*this._scale+this._offset[0],_=s*this._scale+this._offset[1],C=Math.floor(g),T=Math.floor(_),P=this._dem;return A=!!A,f?tr(tr(P.get(C,T,A),P.get(C,T+1,A),_-T),tr(P.get(C+1,T,A),P.get(C+1,T+1,A),_-T),g-C):P.get(C,T,A)}getElevationAtPixel(i,s,f){return this._dem.get(i,s,!!f)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*fe(1,i)*this._dem.stride}}const vB=new Float32Array(262144),t0=new Uint8Array(262144);function _L(c){let i=0;if(c.meshes)for(const s of c.meshes)i=Math.max(i,s.aabb.max[2]);if(c.children)for(const s of c.children)i=Math.max(i,_L(s));return i}function vL(c,i,s){if(c.meshes)for(const f of c.meshes){if(f.aabb.min[0]===1/0)continue;const A=In.applyTransform(f.aabb,c.matrix);s.insert(i,A.min[0],A.min[1],A.max[0],A.max[1])}if(c.children)for(const f of c.children)vL(f,i,s)}const yL=["","wall","door","roof","window","lamp","logo"];class xL{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:i.id,geometry:[],properties:{height:_L(i)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new In([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let i=0;const s=new In([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const f of this.node.meshes)this.node.lightMeshIndex!==i&&(f.transformedAabb=In.applyTransformFast(f.aabb,this.node.matrix),s.encapsulate(f.transformedAabb)),i++;this.aabb=s}return this.aabb}}class Rx{constructor(i,s,f,A,g,_,C,T){this.id=f,this.layers=i,this.layerIds=this.layers.map(P=>P.fqid),this.stateDependentLayerIds=this.layers.filter(P=>P.isStateDependent()).map(P=>P.id),this.modelTraits|=a_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,A&&(this.modelTraits|=a_.HasMapboxMeshFeatures),g&&(this.modelTraits|=a_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.worldview=T,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const P of s)this.nodesInfo.push(new xL(P)),vL(P,C.featureIndexArray.length,C.grid),C.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,C.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(i,s){for(const f of this.getNodesInfo()){const A=f.node;A.footprint&&s.push({footprint:A.footprint,id:i})}}update(i){const s=Object.keys(i).length!==0;if(s&&!this.stateDependentLayers.length)return;const f=s?this.stateDependentLayers:this.layers;if(!Bo(i,this.states))for(const A of f)this.evaluate(A,i);this.states=structuredClone(i)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const f of s){const A=f.node;this.uploaded?this.updatePbrBuffer(A):WE(A,i,!0)}for(const f of s)mx(f.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let s=!1;if(!i.meshes)return s;for(const f of i.meshes)f.pbrBuffer&&(f.pbrBuffer.updateData(f.featureArray),s=!0);return s}needsReEvaluation(i,s,f){const A=i.transform.projectionOptions,g=i.style.getBrightness(),_=this.brightness!==g;if(!this.uploaded||this.dirty||A.name!==this.projection.name||ly(f.paint.get("model-color").value,_)||ly(f.paint.get("model-color-mix-intensity").value,_)||ly(f.paint.get("model-roughness").value,_)||ly(f.paint.get("model-emissive-strength").value,_)||ly(f.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=A,this.brightness=g;const C=this.getNodesInfo();for(const T of C)T.state=null;return!0}return!1}evaluateTransform(i,s){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const f=this.getNodesInfo(),A=this.id.canonical;for(const g of f){const _=g.feature;g.evaluatedTranslation=s.paint.get("model-translation").evaluate(_,{},A),g.evaluatedScale=s.paint.get("model-scale").evaluate(_,{},A)}}evaluate(i,s){const f=this.getNodesInfo();for(const A of f){if(!A.node.meshes)continue;const g=A.feature,_=s&&s[g.id];if(Bo(_,A.state))continue;A.state=structuredClone(_);const C=A.node.meshes&&A.node.meshes[0].featureData,T=A.evaluatedColor[2],P=A.evaluatedRMEA[2],k=this.id.canonical;if(A.hasTranslucentParts=!1,C){for(let N=0;N<yL.length;N++){const j=yL[N];j.length&&(g.properties.part=j);const X=i.paint.get("model-color").evaluate(g,_,k).toPremultipliedRenderColor(null),Y=i.paint.get("model-color-mix-intensity").evaluate(g,_,k);A.evaluatedColor[N]=[X.r,X.g,X.b,Y],A.evaluatedRMEA[N][0]=i.paint.get("model-roughness").evaluate(g,_,k),A.evaluatedRMEA[N][2]=i.paint.get("model-emissive-strength").evaluate(g,_,k),A.evaluatedRMEA[N][3]=X.a,A.emissionHeightBasedParams[N]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(g,_,k),!A.hasTranslucentParts&&X.a<1&&(A.hasTranslucentParts=!0)}delete g.properties.part,mW(A,T!==A.evaluatedColor[2]||P!==A.evaluatedRMEA[2],this.modelTraits)}else A.evaluatedRMEA[0][2]=i.paint.get("model-emissive-strength").evaluate(g,_,k);A.evaluatedTranslation=i.paint.get("model-translation").evaluate(g,_,k),A.evaluatedScale=i.paint.get("model-scale").evaluate(g,_,k),this.updatePbrBuffer(A.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,s,f,A){const g=i.findDEMTileFor(f);if(g&&(g.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(g.dem&&g.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=g.tileID.overscaledZ;const _=h_.create(i,f,g);if(!_)return;this.modelTraits&a_.HasMapboxMeshFeatures&&this.updateDEM(i,_,f,A);for(const C of this.getNodesInfo()){const T=C.node;if(!T.footprint||!T.footprint.vertices||!T.footprint.vertices.length)continue;const P=T.footprint.vertices;let k=_.getElevationAt(P[0].x,P[0].y,!0,!0);for(let N=1;N<P.length;N++)k=Math.min(k,_.getElevationAt(P[N].x,P[N].y,!0,!0));T.elevation=k}}this.terrainTile=g.tileID.canonical,this.terrainExaggeration=s}}updateDEM(i,s,f,A){let g=s._dem._modifiedForSources[A];if(g===void 0&&(s._dem._modifiedForSources[A]=[],g=s._dem._modifiedForSources[A]),g.includes(f.canonical))return;const _=s._dem.dim;g.push(f.canonical);let C=!1;for(const T of this.getNodesInfo()){const P=T.node;if(!P.footprint||!P.footprint.grid)continue;const k=P.footprint.grid,N=s.tileCoordToPixel(k.min.x,k.min.y),j=s.tileCoordToPixel(k.max.x,k.max.y),X=Math.min(Math.min(_-j.y,N.x),Math.min(N.y,_-j.x));if(X<0)continue;const Y=je(X,2,5);let ae=Math.max(0,N.x-Y),ue=Math.max(0,N.y-Y),ge=Math.min(j.x+Y,_-1),Pe=Math.min(j.y+Y,_-1);for(let at=ue;at<=Pe;++at)for(let ot=ae;ot<=ge;++ot)t0[at*_+ot]=255;let Te=0,Ue=0;for(let at=0;at<k.cellsY;++at)for(let ot=0;ot<k.cellsX;++ot){if(!k.cells[at*k.cellsX+ot])continue;const _t=s.tileCoordToPixel(k.min.x+ot/k.xScale,k.min.y+at/k.yScale),wt=s.tileCoordToPixel(k.min.x+(ot+1)/k.xScale,k.min.y+(at+1)/k.yScale);for(let Yt=_t.y;Yt<=Math.min(wt.y+1,_-1);++Yt)for(let Ft=_t.x;Ft<=Math.min(wt.x+1,_-1);++Ft)t0[Yt*_+Ft]===255&&(t0[Yt*_+Ft]=0,Te+=s.getElevationAtPixel(Ft,Yt),Ue++)}const At=Te/Ue;ae=Math.max(1,N.x-Y),ue=Math.max(1,N.y-Y),ge=Math.min(j.x+Y,_-2),Pe=Math.min(j.y+Y,_-2),C=!0;for(let at=ue;at<=Pe;++at)for(let ot=ae;ot<=ge;++ot)t0[at*_+ot]===0&&(vB[at*_+ot]=s._dem.set(ot,at,At));for(let at=1;at<Y;++at){ae=Math.max(1,N.x-at),ue=Math.max(1,N.y-at),ge=Math.min(j.x+at,_-2),Pe=Math.min(j.y+at,_-2);for(let ot=ue;ot<=Pe;++ot)for(let _t=ae;_t<=ge;++_t){const wt=ot*_+_t;if(t0[wt]===255){let Yt=0,Ft=0,ir=-1,Ir=-1;for(let cr=-1;cr<=1;++cr)for(let xr=-1;xr<=1;++xr){const Tr=(ot+cr)*_+_t+xr;if(t0[Tr]>=at)continue;const $t=vB[Tr],wr=Math.abs($t);wr>Ft&&(Yt=$t,Ft=wr,ir=xr,Ir=cr)}if(Ft>.1){const cr=1-(at+.5*Math.abs(ir*Ir))/Y;let xr=s._dem.get(_t,ot)+Yt*cr;const Tr=s._dem.get(_t+ir,ot+Ir),$t=s._dem.get(_t-ir,ot-Ir,!0);(xr-Tr)*(xr-$t)>0&&(xr=(Tr+$t)/2),vB[wt]=s._dem.set(_t,ot,xr),t0[wt]=at}}}}}C&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=bc.now())}setFilter(i){this.filter=i?ou(i):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(i=>this.filter.filter(new oa(this.id.overscaledZ,{worldview:this.worldview}),i.feature,this.id.canonical)):this.nodesInfo}destroy(){const i=this.getNodesInfo();for(const s of i)mx(s.node),qE(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(i,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const f=s.getReplacementRegionsForTile(i.toUnwrapped());for(const A of this.getNodesInfo()){const g=A.node.footprint;A.hiddenByReplacement=!!g&&!f.find(_=>_.footprint===g)}}getHeightAtTileCoord(i,s){const f=[],A=[0,0,0],g=R([]);for(const _ of this.getNodesInfo()){const C=_.node.meshes[0],T=C.transformedAabb;if(i<T.min[0]||s<T.min[1]||i>T.max[0]||s>T.max[1])continue;if(_.node.hidden===!0)return{height:1/0,maxHeight:_.feature.properties.height,hidden:!1,verticalScale:_.evaluatedScale[2]};H(g,_.node.matrix),A[0]=i,A[1]=s,Ct(A,A,g);const P=(A[0]-C.aabb.min[0])/(C.aabb.max[0]-C.aabb.min[0])*Yg|0,k=Math.min(63,(A[1]-C.aabb.min[1])/(C.aabb.max[1]-C.aabb.min[1])*Yg|0)*Yg+Math.min(63,P),N=C.heightmap[k];if(!(N<0&&_.node.footprint))return _.hiddenByReplacement?void 0:{height:N,maxHeight:_.feature.properties.height,hidden:!1,verticalScale:_.evaluatedScale[2]};if(_.node.footprint.grid.query(new hr(i,s),new hr(i,s),f),f.length>0)return{height:void 0,maxHeight:_.feature.properties.height,hidden:_.hiddenByReplacement,verticalScale:_.evaluatedScale[2]}}}}function ly(c,i){return c instanceof Ps&&!c.isLightConstant&&i}function pW(c,i,s,f,A,g,_,C){let T=(61440&i|(61440&i)>>4)>>8,P=(3840&i|(3840&i)>>4)>>4,k=240&i|(240&i)>>4;s[3]>0&&(T=tr(T,255*s[0],s[3]),P=tr(P,255*s[1],s[3]),k=tr(k,255*s[2],s[3]));const N=T<<8|P,j=k<<8|Math.floor(255*f[3]),X=function(at){const ot=je(at,0,2);return Math.min(Math.round(.5*ot*255),255)}(f[2])<<8|15*f[0]<<4|15*f[1],Y=je(A[0],0,1),ae=je(A[1],0,1),ue=je(A[2],0,1),ge=je(A[3],0,1);let Pe,Te,Ue,At;if(Y!==ae&&_!==g&&ae!==Y){const at=_-g;Te=1/(at*(ae-Y)),Ue=-(g+at*Y)/(at*(ae-Y));const ot=je(A[4],-1,1);At=Math.pow(10,ot),Pe=255*ue<<8|255*ge}else Pe=65535,Te=0,Ue=1,At=1;if(c.emplaceBack(N,j,X,Pe,Te,Ue,At),C){const at=C.length;C.clear();for(let ot=0;ot<at;ot++)C.emplaceBack(N,j,X,Pe,Te,Ue,At)}}function mW(c,i,s){const f=c.node;let A=0;const g=s&a_.HasMeshoptCompression;for(const _ of f.meshes){if(f.lights&&f.lightMeshIndex===A||!_.featureData)continue;_.featureArray=new xd,_.featureArray.reserve(_.featureData.length);let C=i;for(const T of _.featureData){const P=g?65535&T:T>>16&65535,k=g?T>>16&65535:65535&T,N=(15&k)<8?15&k:0,j=c.evaluatedRMEA[N],X=c.evaluatedColor[N],Y=c.emissionHeightBasedParams[N];let ae;if(C&&N===2&&f.lights&&(ae=new xd,ae.resize(10*f.lights.length)),pW(_.featureArray,P,X,j,Y,_.aabb.min[2],_.aabb.max[2],ae),ae&&C){C=!1;const ue=f.meshes[f.lightMeshIndex];ue.featureArray=ae,ue.featureArray._trim()}}_.featureArray._trim(),A++}}function wL(c,i,s,f){const A=1<<c.z;i.lat=ke((f/Lr+c.y)/A),i.lng=Ce((s/Lr+c.x)/A)}function gW(c,i,s,f){const A=c.getNodesInfo()[i];if(!A||A.hiddenByReplacement||!A.node.meshes)return;let g=Number.MAX_VALUE;const _=A.node,C=s.tile,T=f.calculatePosMatrix(C.tileID.toUnwrapped(),f.worldSize),P=A.evaluatedScale;let k=0;f.elevation&&_.elevation&&(k=_.elevation*f.elevation.exaggeration()),te(T,T,[(_.anchor?_.anchor[0]:0)*(P[0]-1),(_.anchor?_.anchor[1]:0)*(P[1]-1),k]),J(T,T,P);const N=s.queryGeometry,j=N.isPointQuery()?N.screenBounds:N.screenGeometry,X=function(ae){const ue=q([],T,ae.matrix);q(ue,f.expandedFarZProjMatrix,ue);for(let ge=0;ge<ae.meshes.length;++ge){const Pe=ae.meshes[ge];if(ge===ae.lightMeshIndex)continue;const Te=j4(j,f,ue,Pe.aabb);Te!=null&&(g=Math.min(Te,g))}if(ae.children)for(const ge of ae.children)X(ge)};if(X(_),g===Number.MAX_VALUE)return;const Y=new V(0,0);return wL(C.tileID.canonical,Y,A.node.anchor[0],A.node.anchor[1]),{intersectionZ:g,position:Y,feature:A.feature}}Mr(Rx,"Tiled3dModelBucket",{omit:["layers"]}),Mr(xL,"Tiled3dModelFeature");const _W={circle:class extends Ks{constructor(c,i,s,f){super(c,{layout:jA||(jA=new _a({"circle-sort-key":new Kr(Bt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new ur(Bt.layout_circle["circle-elevation-reference"]),visibility:new ur(Bt.layout_circle.visibility)})),paint:bd||(bd=new _a({"circle-radius":new Kr(Bt.paint_circle["circle-radius"]),"circle-color":new Kr(Bt.paint_circle["circle-color"]),"circle-blur":new Kr(Bt.paint_circle["circle-blur"]),"circle-opacity":new Kr(Bt.paint_circle["circle-opacity"]),"circle-translate":new ur(Bt.paint_circle["circle-translate"]),"circle-translate-anchor":new ur(Bt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ur(Bt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ur(Bt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Kr(Bt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Kr(Bt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Kr(Bt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new ur(Bt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},i,s,f)}createBucket(c){return new ia(c)}queryRadius(c){const i=c;return Rs("circle-radius",this,i)+Rs("circle-stroke-width",this,i)+uo(this.paint.get("circle-translate"))}queryIntersectsFeature(c,i,s,f,A,g,_,C){const T=nA(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,c.pixelToTileUnitsFactor),P=this.paint.get("circle-radius").evaluate(i,s)+this.paint.get("circle-stroke-width").evaluate(i,s);return _o(c,f,g,_,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,P)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,i,s){const f=hc(this);return{config:new Ds(this,{zoom:i,lut:s}),defines:f,overrideFog:!1}}is3D(c){return!c&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends Ks{createBucket(c){return new PF(c)}constructor(c,i,s,f){super(c,{layout:LF||(LF=new _a({visibility:new ur(Bt.layout_heatmap.visibility)})),paint:MF||(MF=new _a({"heatmap-radius":new Kr(Bt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Kr(Bt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ur(Bt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Eh(Bt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ur(Bt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},i,s,f),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Mv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(c){return Rs("heatmap-radius",this,c)}queryIntersectsFeature(c,i,s,f,A,g,_,C){const T=this.paint.get("heatmap-radius").evaluate(i,s);return _o(c,f,g,_,C,!0,!0,new hr(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,i,s){return c==="heatmap"?{config:new Ds(this,{zoom:i,lut:s}),overrideFog:!1}:{}}},hillshade:class extends Ks{constructor(c,i,s,f){super(c,{layout:OF||(OF=new _a({visibility:new ur(Bt.layout_hillshade.visibility)})),paint:DF||(DF=new _a({"hillshade-illumination-direction":new ur(Bt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ur(Bt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ur(Bt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ur(Bt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ur(Bt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ur(Bt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new ur(Bt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},i,s,f)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,i,s){return{overrideFog:!1}}},fill:class extends Ks{constructor(c,i,s,f){super(c,{layout:XF||(XF=new _a({"fill-sort-key":new Kr(Bt.layout_fill["fill-sort-key"]),visibility:new ur(Bt.layout_fill.visibility),"fill-elevation-reference":new ur(Bt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new Kr(Bt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:ZF||(ZF=new _a({"fill-antialias":new ur(Bt.paint_fill["fill-antialias"]),"fill-opacity":new Kr(Bt.paint_fill["fill-opacity"]),"fill-color":new Kr(Bt.paint_fill["fill-color"]),"fill-outline-color":new Kr(Bt.paint_fill["fill-outline-color"]),"fill-translate":new ur(Bt.paint_fill["fill-translate"]),"fill-translate-anchor":new ur(Bt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Kr(Bt.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new ur(Bt.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new ur(Bt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Kr(Bt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new Kr(Bt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new Kr(Bt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},i,s,f)}getProgramIds(){const c=this.paint.get("fill-pattern"),i=c&&c.constantOr(1),s=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(c,i,s){return{config:new Ds(this,{zoom:i,lut:s}),overrideFog:!1}}recalculate(c,i){super.recalculate(c,i);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new IE(c)}queryRadius(){return uo(this.paint.get("fill-translate"))}queryIntersectsFeature(c,i,s,f,A,g){return!c.queryGeometry.isAboveHorizon&&Ma(Mu(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,c.pixelToTileUnitsFactor),f)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(c){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const i=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return c!=null?i&&!c:i}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends Ks{constructor(c,i,s,f){super(c,{layout:y4||(y4=new _a({visibility:new ur(Bt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new ur(Bt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:x4||(x4=new _a({"fill-extrusion-opacity":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Kr(Bt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Kr(Bt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new Kr(Bt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Kr(Bt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Kr(Bt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Kr(Bt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Kr(Bt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Kr(Bt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new ur(Bt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},i,s,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new lx(c)}queryRadius(){return uo(this.paint.get("fill-extrusion-translate"))}is3D(c){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,i,s,f,A,g,_,C,T){const P=nA(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,c.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(i,s),N=this.paint.get("fill-extrusion-base").evaluate(i,s),j=[0,0],X=C&&g.elevation,Y=g.elevation?g.elevation.exaggeration():1,ae=c.tile.getBucket(this);if(X&&ae instanceof lx){const Ue=ae.centroidVertexArray,At=T+1;At<Ue.length&&(j[0]=Ue.geta_centroid_pos0(At),j[1]=Ue.geta_centroid_pos1(At))}if(j[0]===0&&j[1]===1)return!1;g.projection.name==="globe"&&(f=v4([f],[new hr(0,0),new hr(Lr,Lr)],c.tileID.canonical).map(Ue=>Ue.polygon).flat());const ue=X?C:null,[ge,Pe]=function(Ue,At,at,ot,_t,wt,Yt,Ft,ir,Ir,cr){return Ue.projection.name==="globe"?function(xr,Tr,$t,wr,Mt,Xt,Fr,Er,mn,on,vr){const Cr=[],fn=[],tn=xr.projection.upVectorScale(vr,xr.center.lat,xr.worldSize).metersToTile,Dr=[0,0,0,1],nn=[0,0,0,1],Cn=(li,$n,zi,xi)=>{li[0]=$n,li[1]=zi,li[2]=xi,li[3]=1},kn=_4();$t>0&&($t+=kn),wr+=kn;for(const li of Tr){const $n=[],zi=[];for(const xi of li){const $a=xi.x+Mt.x,Ge=xi.y+Mt.y,Ke=xr.projection.projectTilePoint($a,Ge,vr),Kt=xr.projection.upVector(vr,xi.x,xi.y);let Pr=$t,Vr=wr;if(Fr){const jr=S4($a,Ge,$t,wr,Fr,Er,mn,on);Pr+=jr.base,Vr+=jr.top}$t!==0?Cn(Dr,Ke.x+Kt[0]*tn*Pr,Ke.y+Kt[1]*tn*Pr,Ke.z+Kt[2]*tn*Pr):Cn(Dr,Ke.x,Ke.y,Ke.z),Cn(nn,Ke.x+Kt[0]*tn*Vr,Ke.y+Kt[1]*tn*Vr,Ke.z+Kt[2]*tn*Vr),Ct(Dr,Dr,Xt),Ct(nn,nn,Xt),$n.push(new Xg(Dr[0],Dr[1],Dr[2])),zi.push(new Xg(nn[0],nn[1],nn[2]))}Cr.push($n),fn.push(zi)}return[Cr,fn]}(Ue,At,at,ot,_t,wt,Yt,Ft,ir,Ir,cr):Yt?function(xr,Tr,$t,wr,Mt,Xt,Fr,Er,mn){const on=[],vr=[],Cr=[0,0,0,1];for(const fn of xr){const tn=[],Dr=[];for(const nn of fn){const Cn=nn.x+wr.x,kn=nn.y+wr.y,li=S4(Cn,kn,Tr,$t,Xt,Fr,Er,mn);Cr[0]=Cn,Cr[1]=kn,Cr[2]=li.base,Cr[3]=1,yn(Cr,Cr,Mt),Cr[3]=Math.max(Cr[3],1e-5);const $n=new Xg(Cr[0]/Cr[3],Cr[1]/Cr[3],Cr[2]/Cr[3]);Cr[0]=Cn,Cr[1]=kn,Cr[2]=li.top,Cr[3]=1,yn(Cr,Cr,Mt),Cr[3]=Math.max(Cr[3],1e-5);const zi=new Xg(Cr[0]/Cr[3],Cr[1]/Cr[3],Cr[2]/Cr[3]);tn.push($n),Dr.push(zi)}on.push(tn),vr.push(Dr)}return[on,vr]}(At,at,ot,_t,wt,Yt,Ft,ir,Ir):function(xr,Tr,$t,wr,Mt){const Xt=[],Fr=[],Er=Mt[8]*Tr,mn=Mt[9]*Tr,on=Mt[10]*Tr,vr=Mt[11]*Tr,Cr=Mt[8]*$t,fn=Mt[9]*$t,tn=Mt[10]*$t,Dr=Mt[11]*$t;for(const nn of xr){const Cn=[],kn=[];for(const li of nn){const $n=li.x+wr.x,zi=li.y+wr.y,xi=Mt[0]*$n+Mt[4]*zi+Mt[12],$a=Mt[1]*$n+Mt[5]*zi+Mt[13],Ge=Mt[2]*$n+Mt[6]*zi+Mt[14],Ke=Mt[3]*$n+Mt[7]*zi+Mt[15],Kt=xi+Er,Pr=$a+mn,Vr=Ge+on,jr=Math.max(Ke+vr,1e-5),un=xi+Cr,Mn=$a+fn,Fi=Ge+tn,Pi=Math.max(Ke+Dr,1e-5);Cn.push(new Xg(Kt/jr,Pr/jr,Vr/jr)),kn.push(new Xg(un/Pi,Mn/Pi,Fi/Pi))}Xt.push(Cn),Fr.push(kn)}return[Xt,Fr]}(At,at,ot,_t,wt)}(g,f,N,k,P,_,ue,j,Y,g.center.lat,c.tileID.canonical),Te=c.queryGeometry;return function(Ue,At,at){let ot=1/0;Ma(at,At)&&(ot=C4(at,At[0]));for(let _t=0;_t<At.length;_t++){const wt=At[_t],Yt=Ue[_t];for(let Ft=0;Ft<wt.length-1;Ft++){const ir=wt[Ft],Ir=[ir,wt[Ft+1],Yt[Ft+1],Yt[Ft],ir];ga(at,Ir)&&(ot=Math.min(ot,C4(at,Ir)))}}return ot!==1/0&&ot}(ge,Pe,Te.isPointQuery()?Te.screenBounds:Te.screenGeometry)}},building:class extends Ks{constructor(c,i,s,f){super(c,{layout:Z4||(Z4=new _a({visibility:new ur(Bt.layout_building.visibility),"building-facade":new Kr(Bt.layout_building["building-facade"]),"building-facade-floors":new Kr(Bt.layout_building["building-facade-floors"]),"building-facade-window":new Kr(Bt.layout_building["building-facade-window"]),"building-roof-shape":new Kr(Bt.layout_building["building-roof-shape"]),"building-height":new Kr(Bt.layout_building["building-height"]),"building-base":new Kr(Bt.layout_building["building-base"])})),paint:Y4||(Y4=new _a({"building-opacity":new ur(Bt.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new ur(Bt.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new ur(Bt.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new ur(Bt.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new ur(Bt.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new ur(Bt.paint_building["building-vertical-scale"]),"building-cast-shadows":new ur(Bt.paint_building["building-cast-shadows"]),"building-color":new Kr(Bt.paint_building["building-color"]),"building-emissive-strength":new Kr(Bt.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new ur(Bt.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new ur(Bt.paint_building["building-cutoff-fade-range"]),"building-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},i,s,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new X4(c)}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(c){return!0}},line:class extends Ks{constructor(c,i,s,f){const A=lP();super(c,A,i,s,f),A.layout&&(this.layout=new Ju(A.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof dl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,i){super.recalculate(c,i),this.paint._values["line-floorwidth"]=(()=>{if(Xv)return Xv;const s=lP();return Xv=new mK(s.paint.properties["line-width"].specification),Xv.useIntegerZoom=!0,Xv})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new ZE(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,i,s){const f=oP(this);return{config:new Ds(this,{zoom:i,lut:s}),defines:f,overrideFog:!1}}queryRadius(c){const i=c,s=cP(Rs("line-width",this,i),Rs("line-gap-width",this,i)),f=Rs("line-offset",this,i);return s/2+Math.abs(f)+uo(this.paint.get("line-translate"))}queryIntersectsFeature(c,i,s,f,A,g){if(c.queryGeometry.isAboveHorizon)return!1;const _=Mu(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,c.pixelToTileUnitsFactor),C=c.pixelToTileUnitsFactor/2*cP(this.paint.get("line-width").evaluate(i,s),this.paint.get("line-gap-width").evaluate(i,s)),T=this.paint.get("line-offset").evaluate(i,s);return T&&(f=function(P,k){const N=[],j=new hr(0,0);for(let X=0;X<P.length;X++){const Y=P[X],ae=[];for(let ue=0;ue<Y.length;ue++){const ge=Y[ue],Pe=Y[ue+1],Te=ue===0?j:ge.sub(Y[ue-1])._unit()._perp(),Ue=ue===Y.length-1?j:Pe.sub(ge)._unit()._perp(),At=Te._add(Ue)._unit();At._mult(1/(At.x*Ue.x+At.y*Ue.y)),ae.push(At._mult(k)._add(ge))}N.push(ae)}return N}(f,T*c.pixelToTileUnitsFactor)),function(P,k,N){for(let j=0;j<k.length;j++){const X=k[j];if(P.length>=3){for(let Y=0;Y<X.length;Y++)if(Kl(P,X[Y]))return!0}if(Do(P,X,N))return!0}return!1}(_,f,C)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(c){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:Lx,background:class extends Ks{constructor(c,i,s,f){super(c,{layout:eL||(eL=new _a({visibility:new ur(Bt.layout_background.visibility)})),paint:tL||(tL=new _a({"background-pitch-alignment":new ur(Bt.paint_background["background-pitch-alignment"]),"background-color":new ur(Bt.paint_background["background-color"]),"background-pattern":new ur(Bt.paint_background["background-pattern"]),"background-opacity":new ur(Bt.paint_background["background-opacity"]),"background-emissive-strength":new ur(Bt.paint_background["background-emissive-strength"]),"background-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},i,s,f)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,i,s){return{overrideFog:!1}}is3D(c){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:oL,"raster-particle":fL,sky:class extends Ks{constructor(c,i,s,f){super(c,{layout:cL||(cL=new _a({visibility:new ur(Bt.layout_sky.visibility)})),paint:uL||(uL=new _a({"sky-type":new ur(Bt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ur(Bt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ur(Bt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ur(Bt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ur(Bt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Eh(Bt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ur(Bt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ur(Bt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ur(Bt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},i,s,f),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Mv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(c,i){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),A=!f,g=c.style.light,_=g.properties.get("position");return A&&g.properties.get("anchor")==="viewport"&&Hr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),A?mB(_.azimuthal,90-_.polar,i):mB(f[0],90-f[1],i)}const s=this.paint.get("sky-gradient-center");return mB(s[0],90-s[1],i)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Ks{constructor(c,i,s,f){super(c,{paint:hL||(hL=new _a({}))},i,null)}},model:class extends Ks{constructor(c,i,s,f){super(c,{layout:mL||(mL=new _a({visibility:new ur(Bt.layout_model.visibility),"model-id":new Kr(Bt.layout_model["model-id"])})),paint:gL||(gL=new _a({"model-opacity":new Kr(Bt.paint_model["model-opacity"]),"model-rotation":new Kr(Bt.paint_model["model-rotation"]),"model-scale":new Kr(Bt.paint_model["model-scale"]),"model-translation":new Kr(Bt.paint_model["model-translation"]),"model-color":new Kr(Bt.paint_model["model-color"]),"model-color-mix-intensity":new Kr(Bt.paint_model["model-color-mix-intensity"]),"model-type":new ur(Bt.paint_model["model-type"]),"model-cast-shadows":new ur(Bt.paint_model["model-cast-shadows"]),"model-receive-shadows":new ur(Bt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new ur(Bt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Kr(Bt.paint_model["model-emissive-strength"]),"model-roughness":new Kr(Bt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Kr(Bt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new ur(Bt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new ur(Bt.paint_model["model-front-cutoff"]),"model-color-use-theme":new Kr({type:"string",default:"default","property-type":"data-driven"})}))},i,s,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new _B(c)}getProgramIds(){return["model"]}is3D(c){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof Rx?Lr-1:0}queryIntersectsFeature(c,i,s,f,A,g){if(!this.modelManager)return!1;const _=this.modelManager,C=c.tile.getBucket(this);if(!(C&&C instanceof _B))return!1;for(const T in C.instancesPerModel){const P=C.instancesPerModel[T],k=i.id!==void 0?i.id:i.properties&&i.properties.hasOwnProperty("id")?i.properties.id:void 0;if(P.idToFeaturesIndex.hasOwnProperty(k)){const N=P.features[P.idToFeaturesIndex[k]],j=_.getModel(T,this.scope);if(!j)return!1;let X=U();const Y=new V(0,0),ae=C.canonical;let ue=Number.MAX_VALUE;for(let ge=0;ge<N.instancedDataCount;++ge){const Pe=16*(N.instancedDataOffset+ge),Te=P.instancedDataArray.float32,Ue=[Te[Pe+4],Te[Pe+5],Te[Pe+6]];wL(ae,Y,Te[Pe],0|Te[Pe+1]),H4(X,j,g,Y,N.rotation,N.scale,Ue,!1,!1,!1),g.projection.name==="globe"&&(X=KE(X,g));const At=q([],g.projMatrix,X),at=c.queryGeometry,ot=j4(at.isPointQuery()?at.screenBounds:at.screenGeometry,g,At,j.aabb);ot!=null&&(ue=Math.min(ot,ue))}return ue!==Number.MAX_VALUE&&ue}}return!1}_handleOverridablePaintPropertyUpdate(c,i,s){return!(!this.layout||i.isDataDriven()||s.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const i=this._transitionablePaint._values[c];return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof ro}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Ks{constructor(c,i,s,f){super(c,{layout:YF||(YF=new _a({"clip-layer-types":new ur(Bt.layout_clip["clip-layer-types"]),"clip-layer-scope":new ur(Bt.layout_clip["clip-layer-scope"])})),paint:JF||(JF=new _a({}))},i,s,f)}recalculate(c,i){super.recalculate(c,i)}createBucket(c){return new e4(c)}is3D(c){return!0}}},yB=new ft(0,0,0),xB={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},wB={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},kx={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},vW={PAINT_ORDER_FILL_AND_STROKE:1},cy={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},bL={MASK_TYPE_LUMINANCE:1};function yW(c,i,s){c===1&&i.icons.push(function(f,A){return function(g){if(g.usvg_tree.height||(g.usvg_tree.height=g.usvg_tree.width),!g.metadata)return g;const{metadata:_}=g;if(_.content_area){const{content_area:C}=_;C.top==null&&(C.top=C.left),C.width==null&&(C.width=g.usvg_tree.width),C.height==null&&(C.height=C.width)}return _.stretch_x&&_.stretch_x.length&&EL(_,"x"),_.stretch_y&&_.stretch_y.length&&EL(_,"y"),g}(f.readFields(xW,{name:void 0},A))}(s,s.readVarint()+s.pos))}function EL(c,i){const s=[],f=c[`stretch_${i}`];let A=null;for(let g=0;g<f.length;g++)A===null?A=s.length===0?f[0]:s[s.length-1][1]+f[g]:(s.push([A,A+f[g]]),A=null);c[`stretch_${i}_areas`]=s}function xW(c,i,s){c===1?i.name=s.readString():c===2?i.metadata=function(f,A){return f.readFields(wW,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},A)}(s,s.readVarint()+s.pos):c===3&&(i.usvg_tree=function(f,A){return f.readFields(BW,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},A)}(s,s.readVarint()+s.pos),i.data="usvg_tree")}function wW(c,i,s){c===1?i.stretch_x=s.readPackedVarint():c===2?i.stretch_y=s.readPackedVarint():c===3?i.content_area=function(f,A){return f.readFields(bW,{left:0},A)}(s,s.readVarint()+s.pos):c===4&&i.variables.push(function(f,A){return f.readFields(EW,{name:void 0},A)}(s,s.readVarint()+s.pos))}function bW(c,i,s){c===1?i.left=s.readVarint():c===2?i.width=s.readVarint():c===3?i.top=s.readVarint():c===4&&(i.height=s.readVarint())}function EW(c,i,s){c===1?i.name=s.readString():c===2&&(i.rgb_color=zx(s.readVarint()),i.value="rgb_color")}function BW(c,i,s){c===1?i.width=i.height=s.readVarint():c===2?i.height=s.readVarint():c===3?i.children.push(Ux(s,s.readVarint()+s.pos)):c===4?i.linear_gradients.push(function(f,A){return f.readFields(LW,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},A)}(s,s.readVarint()+s.pos)):c===5?i.radial_gradients.push(function(f,A){return f.readFields(OW,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},A)}(s,s.readVarint()+s.pos)):c===7?i.clip_paths.push(function(f,A){return f.readFields(DW,{children:[]},A)}(s,s.readVarint()+s.pos)):c===8&&i.masks.push(function(f,A){const g=f.readFields(RW,{left:0,width:20,mask_type:bL.MASK_TYPE_LUMINANCE,children:[]},A);return g.height==null&&(g.height=g.width),g.top==null&&(g.top=g.left),g}(s,s.readVarint()+s.pos))}function Ux(c,i){return c.readFields(CW,{},i)}function CW(c,i,s){c===1?(i.group=function(f,A){return f.readFields(SW,{opacity:255,children:[]},A)}(s,s.readVarint()+s.pos),i.node="group"):c===2&&(i.path=function(f,A){return f.readFields(IW,{paint_order:1,commands:[],step:1,diffs:[],rule:xB.PATH_RULE_NON_ZERO},A)}(s,s.readVarint()+s.pos),i.node="path")}function SW(c,i,s){c===1?i.transform=Nx(s,s.readVarint()+s.pos):c===2?i.opacity=s.readVarint():c===5?i.clip_path_idx=s.readVarint():c===6?i.mask_idx=s.readVarint():c===7&&i.children.push(Ux(s,s.readVarint()+s.pos))}function Nx(c,i){return c.readFields(TW,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},i)}function TW(c,i,s){c===1?i.sx=s.readFloat():c===2?i.ky=s.readFloat():c===3?i.kx=s.readFloat():c===4?i.sy=s.readFloat():c===5?i.tx=s.readFloat():c===6&&(i.ty=s.readFloat())}function IW(c,i,s){c===1?i.fill=function(f,A){return f.readFields(FW,{rgb_color:yB,paint:"rgb_color",opacity:255},A)}(s,s.readVarint()+s.pos):c===2?i.stroke=function(f,A){return f.readFields(PW,{rgb_color:yB,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},A)}(s,s.readVarint()+s.pos):c===3?i.paint_order=s.readVarint():c===5?s.readPackedVarint(i.commands):c===6?i.step=s.readFloat():c===7?s.readPackedSVarint(i.diffs):c===8&&(i.rule=s.readVarint())}function FW(c,i,s){c===1?(i.rgb_color=zx(s.readVarint()),i.paint="rgb_color"):c===2?(i.linear_gradient_idx=s.readVarint(),i.paint="linear_gradient_idx"):c===3?(i.radial_gradient_idx=s.readVarint(),i.paint="radial_gradient_idx"):c===5&&(i.opacity=s.readVarint())}function zx(c){return new ft((c>>16&255)/255,(c>>8&255)/255,(255&c)/255,1)}function PW(c,i,s){c===1?(i.rgb_color=zx(s.readVarint()),i.paint="rgb_color"):c===2?(i.linear_gradient_idx=s.readVarint(),i.paint="linear_gradient_idx"):c===3?(i.radial_gradient_idx=s.readVarint(),i.paint="radial_gradient_idx"):c===5?s.readPackedFloat(i.dasharray):c===6?i.dashoffset=s.readFloat():c===7?i.miterlimit=s.readFloat():c===8?i.opacity=s.readVarint():c===9?i.width=s.readFloat():c===10?i.linecap=s.readVarint():c===11&&(i.linejoin=s.readVarint())}function LW(c,i,s){c===1?i.transform=Nx(s,s.readVarint()+s.pos):c===2?i.spread_method=s.readVarint():c===3?i.stops.push(BL(s,s.readVarint()+s.pos)):c===4?i.x1=s.readFloat():c===5?i.y1=s.readFloat():c===6?i.x2=s.readFloat():c===7&&(i.y2=s.readFloat())}function BL(c,i){return c.readFields(MW,{offset:0,opacity:255,rgb_color:yB},i)}function MW(c,i,s){c===1?i.offset=s.readFloat():c===2?i.opacity=s.readVarint():c===3&&(i.rgb_color=zx(s.readVarint()))}function OW(c,i,s){c===1?i.transform=Nx(s,s.readVarint()+s.pos):c===2?i.spread_method=s.readVarint():c===3?i.stops.push(BL(s,s.readVarint()+s.pos)):c===4?i.cx=s.readFloat():c===5?i.cy=s.readFloat():c===6?i.r=s.readFloat():c===7?i.fx=s.readFloat():c===8?i.fy=s.readFloat():c===9&&(i.fr=s.readFloat())}function DW(c,i,s){c===1?i.transform=Nx(s,s.readVarint()+s.pos):c===2?i.clip_path_idx=s.readVarint():c===3&&i.children.push(Ux(s,s.readVarint()+s.pos))}function RW(c,i,s){c===1?i.left=i.top=s.readFloat():c===2?i.width=i.height=s.readFloat():c===3?i.top=s.readFloat():c===4?i.height=s.readFloat():c===5?i.mask_type=s.readVarint():c===6?i.mask_idx=s.readVarint():c===7&&i.children.push(Ux(s,s.readVarint()+s.pos))}class kW{static calculate(i={},s=[]){const f=new Map,A=new Map;if(Object.keys(i).length===0)return f;s.forEach(g=>{A.set(g.name,g.rgb_color||new ft(0,0,0))});for(const[g,_]of Object.entries(i))A.has(g)?f.set(A.get(g).toString(),_):console.warn(`Ignoring unknown image variable "${g}"`);return f}}function f_(c,i=255,s){const f=i/255,A=c.toString(),g=s.has(A)?s.get(A).clone():c.clone();return g.a*=f,g.toString()}function uy(c,i){if(!fh()){const s=document.createElement("canvas");return s.width=c,s.height=i,s}return new OffscreenCanvas(c,i)}function UW(c,i){const s=kW.calculate(i.params,c.metadata?c.metadata.variables:[]),f=c.usvg_tree,A=f.width,g=f.height,_=i.transform?i.transform:new DOMMatrix,C=Math.max(1,Math.round(A*_.a)),T=Math.max(1,Math.round(g*_.d)),P=new DOMMatrix([C/A,0,0,T/g,0,0]),k=uy(C,T).getContext("2d");return bB(k,P,f,f,s),k.getImageData(0,0,C,T)}function bB(c,i,s,f,A){for(const g of f.children)CL(c,i,s,g,A)}function CL(c,i,s,f,A){f.group?(c.save(),function(g,_,C,T,P){const k=T.mask_idx!=null?C.masks[T.mask_idx]:null,N=T.clip_path_idx!=null?C.clip_paths[T.clip_path_idx]:null;if(T.transform&&(_=A_(T.transform).preMultiplySelf(_)),!function(Y,ae,ue){return Y.opacity!==255||ae||ue}(T,N!=null,k!=null))return void bB(g,_,C,T,P);const j=uy(g.canvas.width,g.canvas.height),X=j.getContext("2d");bB(X,_,C,T,P),N&&ML(X,_,C,N),k&&OL(X,_,C,k,P),g.globalAlpha=T.opacity/255,g.drawImage(j,0,0)}(c,i,s,f.group,A),c.restore()):f.path&&(c.save(),function(g,_,C,T,P){g.setTransform(_),T.paint_order===vW.PAINT_ORDER_FILL_AND_STROKE?(SL(g,C,T,P),IL(g,C,T,P)):(IL(g,C,T,P),SL(g,C,T,P))}(c,i,s,f.path,A),c.restore())}function SL(c,i,s,f){const A=s.fill;if(!A)return;const g=A.opacity/255;switch(c.save(),c.beginPath(),DL(s,c),A.paint){case"rgb_color":c.fillStyle=f_(A.rgb_color,A.opacity,f);break;case"linear_gradient_idx":{const _=i.linear_gradients[A.linear_gradient_idx];_.transform&&c.setTransform(A_(_.transform).preMultiplySelf(c.getTransform())),c.fillStyle=FL(c,_,g,f);break}case"radial_gradient_idx":{const _=i.radial_gradients[A.radial_gradient_idx];_.transform&&c.setTransform(A_(_.transform).preMultiplySelf(c.getTransform())),c.fillStyle=PL(c,_,g,f)}}c.fill(TL(s)),c.restore()}function TL(c){return c.rule===xB.PATH_RULE_NON_ZERO?"nonzero":c.rule===xB.PATH_RULE_EVEN_ODD?"evenodd":void 0}function IL(c,i,s,f){const A=s.stroke;if(!A)return;const g=RL(s);c.lineWidth=A.width,c.miterLimit=A.miterlimit,c.setLineDash(A.dasharray),c.lineDashOffset=A.dashoffset;const _=A.opacity/255;switch(A.paint){case"rgb_color":c.strokeStyle=f_(A.rgb_color,A.opacity,f);break;case"linear_gradient_idx":c.strokeStyle=FL(c,i.linear_gradients[A.linear_gradient_idx],_,f,!0);break;case"radial_gradient_idx":c.strokeStyle=PL(c,i.radial_gradients[A.radial_gradient_idx],_,f,!0)}switch(A.linejoin){case kx.LINE_JOIN_MITER_CLIP:case kx.LINE_JOIN_MITER:c.lineJoin="miter";break;case kx.LINE_JOIN_ROUND:c.lineJoin="round";break;case kx.LINE_JOIN_BEVEL:c.lineJoin="bevel"}switch(A.linecap){case wB.LINE_CAP_BUTT:c.lineCap="butt";break;case wB.LINE_CAP_ROUND:c.lineCap="round";break;case wB.LINE_CAP_SQUARE:c.lineCap="square"}c.stroke(g)}function FL(c,i,s,f,A=!1){if(i.stops.length===1){const j=i.stops[0];return f_(j.rgb_color,j.opacity*s,f)}const{x1:g,y1:_,x2:C,y2:T}=i;let P=new DOMPoint(g,_),k=new DOMPoint(C,T);if(A){const j=A_(i.transform);P=j.transformPoint(P),k=j.transformPoint(k)}const N=c.createLinearGradient(P.x,P.y,k.x,k.y);for(const j of i.stops)N.addColorStop(j.offset,f_(j.rgb_color,j.opacity*s,f));return N}function PL(c,i,s,f,A=!1){if(i.stops.length===1){const ge=i.stops[0];return f_(ge.rgb_color,ge.opacity*s,f)}const g=A_(i.transform),{fx:_,fy:C,fr:T,cx:P,cy:k,r:N}=i;let j=new DOMPoint(_,C),X=new DOMPoint(P,k),Y=T,ae=N;if(A){j=g.transformPoint(j),X=g.transformPoint(X);const ge=(g.a+g.d)/2;Y=T*ge,ae=i.r*ge}const ue=c.createRadialGradient(j.x,j.y,Y,X.x,X.y,ae);for(const ge of i.stops)ue.addColorStop(ge.offset,f_(ge.rgb_color,ge.opacity*s,f));return ue}function LL(c,i,s,f){const A=f.transform?A_(f.transform).preMultiplySelf(i):i,g=uy(c.canvas.width,c.canvas.height),_=g.getContext("2d");for(const T of f.children)if(T.group)LL(_,A,s,T.group);else if(T.path){const P=T.path,k=new Path2D;k.addPath(RL(P),A),_.fill(k,TL(P))}const C=f.clip_path_idx!=null?s.clip_paths[f.clip_path_idx]:null;C&&ML(_,A,s,C),c.globalCompositeOperation="source-over",c.drawImage(g,0,0)}function ML(c,i,s,f){const A=uy(c.canvas.width,c.canvas.height);LL(A.getContext("2d"),i,s,f),c.globalCompositeOperation="destination-in",c.drawImage(A,0,0)}function OL(c,i,s,f,A){if(f.children.length===0)return;const g=f.mask_idx!=null?s.masks[f.mask_idx]:null;g&&OL(c,i,s,g,A);const _=c.canvas.width,C=c.canvas.height,T=uy(_,C),P=T.getContext("2d"),k=f.width,N=f.height,j=f.left,X=f.top,Y=new Path2D,ae=new Path2D;ae.rect(j,X,k,N),Y.addPath(ae,i),P.clip(Y);for(const Pe of f.children)CL(P,i,s,Pe,A);const ue=P.getImageData(0,0,_,C),ge=ue.data;if(f.mask_type===bL.MASK_TYPE_LUMINANCE)for(let Pe=0;Pe<ge.length;Pe+=4)ge[Pe+3]=ge[Pe+3]/255*(.2126*ge[Pe]+.7152*ge[Pe+1]+.0722*ge[Pe+2]);P.putImageData(ue,0,0),c.globalCompositeOperation="destination-in",c.drawImage(T,0,0)}function A_(c){return c?new DOMMatrix([c.sx,c.ky,c.kx,c.sy,c.tx,c.ty]):new DOMMatrix}function DL(c,i){const s=c.step;let f=c.diffs[0]*s,A=c.diffs[1]*s;i.moveTo(f,A);for(let g=0,_=2;g<c.commands.length;g++)switch(c.commands[g]){case cy.PATH_COMMAND_MOVE:f+=c.diffs[_++]*s,A+=c.diffs[_++]*s,i.moveTo(f,A);break;case cy.PATH_COMMAND_LINE:f+=c.diffs[_++]*s,A+=c.diffs[_++]*s,i.lineTo(f,A);break;case cy.PATH_COMMAND_QUAD:{const C=f+c.diffs[_++]*s,T=A+c.diffs[_++]*s;f=C+c.diffs[_++]*s,A=T+c.diffs[_++]*s,i.quadraticCurveTo(C,T,f,A);break}case cy.PATH_COMMAND_CUBIC:{const C=f+c.diffs[_++]*s,T=A+c.diffs[_++]*s,P=C+c.diffs[_++]*s,k=T+c.diffs[_++]*s;f=P+c.diffs[_++]*s,A=k+c.diffs[_++]*s,i.bezierCurveTo(C,T,P,k,f,A);break}case cy.PATH_COMMAND_CLOSE:i.closePath()}return i}function RL(c){return DL(c,new Path2D)}class Qx{constructor(i){this.capacity=i,this.cache=new Map}get(i){if(!this.cache.has(i))return;const s=this.cache.get(i);return this.cache.delete(i),this.cache.set(i,s),s}put(i,s){this.cache.has(i)?this.cache.delete(i):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(i,s)}delete(i){this.cache.delete(i)}}Mr(Qx,"LRUCache");class EB{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(i){return new Uc(i,i.data)}getFromCache(i,s,f){return this.cacheMap.has(f)||this.cacheMap.set(f,new Qx(150)),this.cacheMap.get(f).get($h(i.toString(),s))}setInCache(i,s,f,A){this.cacheDependenciesMap.has(A)||this.cacheDependenciesMap.set(A,new Map),this.cacheMap.has(A)||this.cacheMap.set(A,new Qx(150));const g=this.cacheDependenciesMap.get(A),_=$h(i.id.toString(),f);g.get(_)||g.set(_,new Set);const C=this.cacheMap.get(A),T=i.toString();g.get(_).add(T),C.put($h(i.toString(),f),s)}removeImagesFromCacheByIds(i,s,f=0){if(!this.cacheMap.has(f)||!this.cacheDependenciesMap.has(f))return;const A=this.cacheMap.get(f),g=this.cacheDependenciesMap.get(f);for(const _ of i){const C=$h(_.toString(),s);if(g.has(C)){for(const T of g.get(C))A.delete(T);g.delete(C)}}}rasterize(i,s,f,A,g=UW){const _=this.getFromCache(i,f,A);if(_)return _.clone();const C=g(s.icon,i.options),T=EB._getImage(C);return this.setInCache(i,T,f,A),T.clone()}}class kL{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,s){const f=this.toIdx(i,s);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(i,s){return this.leaves[this.toIdx(i,s)]}toIdx(i,s){return s*this.size+i}}function UL(c,i,s,f){let A=0,g=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(f[_])<1e-15){if(s[_]<c[_]||s[_]>i[_])return null}else{const C=1/f[_];let T=(c[_]-s[_])*C,P=(i[_]-s[_])*C;if(T>P){const k=T;T=P,P=k}if(T>A&&(A=T),P<g&&(g=P),A>g)return null}return A}function NL(c,i,s,f,A,g,_,C,T,P,k){const N=f-c,j=A-i,X=g-s,Y=_-c,ae=C-i,ue=T-s,ge=k[1]*ue-k[2]*ae,Pe=k[2]*Y-k[0]*ue,Te=k[0]*ae-k[1]*Y,Ue=N*ge+j*Pe+X*Te;if(Math.abs(Ue)<1e-15)return null;const At=1/Ue,at=P[0]-c,ot=P[1]-i,_t=P[2]-s,wt=(at*ge+ot*Pe+_t*Te)*At;if(wt<0||wt>1)return null;const Yt=ot*X-_t*j,Ft=_t*N-at*X,ir=at*j-ot*N,Ir=(k[0]*Yt+k[1]*Ft+k[2]*ir)*At;return Ir<0||wt+Ir>1?null:(Y*Yt+ae*Ft+ue*ir)*At}function zL(c,i,s){return(c-i)/(s-i)}function QL(c,i,s,f,A,g,_,C,T){const P=1<<s,k=g-f,N=_-A,j=(c+1)/P*k+f,X=(i+0)/P*N+A,Y=(i+1)/P*N+A;C[0]=(c+0)/P*k+f,C[1]=X,T[0]=j,T[1]=Y}class jL{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(g){const _=Math.ceil(Math.log2(g.dim/8)),C=[];let T=Math.ceil(Math.pow(2,_));const P=1/T,k=(X,Y,ae,ue,ge)=>{const Pe=ue?1:0,Te=(X+1)*ae-Pe,Ue=Y*ae,At=(Y+1)*ae-Pe;ge[0]=X*ae,ge[1]=Ue,ge[2]=Te,ge[3]=At};let N=new kL(T);const j=[];for(let X=0;X<T*T;X++){k(X%T,Math.floor(X/T),P,!1,j);const Y=ig(j[0],j[1],g),ae=ig(j[2],j[1],g),ue=ig(j[2],j[3],g),ge=ig(j[0],j[3],g);N.minimums.push(Math.min(Y,ae,ue,ge)),N.maximums.push(Math.max(Y,ae,ue,ge)),N.leaves.push(1)}for(C.push(N),T/=2;T>=1;T/=2){const X=C[C.length-1];N=new kL(T);for(let Y=0;Y<T*T;Y++){k(Y%T,Math.floor(Y/T),2,!0,j);const ae=X.getElevation(j[0],j[1]),ue=X.getElevation(j[2],j[1]),ge=X.getElevation(j[2],j[3]),Pe=X.getElevation(j[0],j[3]),Te=X.isLeaf(j[0],j[1]),Ue=X.isLeaf(j[2],j[1]),At=X.isLeaf(j[2],j[3]),at=X.isLeaf(j[0],j[3]),ot=Math.min(ae.min,ue.min,ge.min,Pe.min),_t=Math.max(ae.max,ue.max,ge.max,Pe.max),wt=Te&&Ue&&At&&at;N.maximums.push(_t),N.minimums.push(ot),N.leaves.push(_t-ot<=5&&wt?1:0)}C.push(N)}return C}(this.dem),f=s.length-1,A=s[f];this._addNode(A.minimums[0],A.maximums[0],A.leaves[0]),this._construct(s,0,0,f,0)}raycastRoot(i,s,f,A,g,_,C=1){return UL([i,s,-100],[f,A,this.maximums[0]*C],g,_)}raycast(i,s,f,A,g,_,C=1){if(!this.nodeCount)return null;const T=this.raycastRoot(i,s,f,A,g,_,C);if(T==null)return null;const P=[],k=[],N=[],j=[],X=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;X.length>0;){const{idx:Y,t:ae,nodex:ue,nodey:ge,depth:Pe}=X.pop();if(this.leaves[Y]){QL(ue,ge,Pe,i,s,f,A,N,j);const Ue=1<<Pe,At=(ue+0)/Ue,at=(ue+1)/Ue,ot=(ge+0)/Ue,_t=(ge+1)/Ue,wt=ig(At,ot,this.dem)*C,Yt=ig(at,ot,this.dem)*C,Ft=ig(at,_t,this.dem)*C,ir=ig(At,_t,this.dem)*C,Ir=NL(N[0],N[1],wt,j[0],N[1],Yt,j[0],j[1],Ft,g,_),cr=NL(j[0],j[1],Ft,N[0],j[1],ir,N[0],N[1],wt,g,_),xr=Math.min(Ir!==null?Ir:Number.MAX_VALUE,cr!==null?cr:Number.MAX_VALUE);if(xr!==Number.MAX_VALUE)return xr;{const Tr=ie([],g,_,ae);if(HL(wt,Yt,ir,Ft,zL(Tr[0],N[0],j[0]),zL(Tr[1],N[1],j[1]))>=Tr[2])return ae}continue}let Te=0;for(let Ue=0;Ue<this._siblingOffset.length;Ue++){QL((ue<<1)+this._siblingOffset[Ue][0],(ge<<1)+this._siblingOffset[Ue][1],Pe+1,i,s,f,A,N,j),N[2]=-100,j[2]=this.maximums[this.childOffsets[Y]+Ue]*C;const At=UL(N,j,g,_);if(At!=null){const at=At;P[Ue]=at;let ot=!1;for(let _t=0;_t<Te&&!ot;_t++)at>=P[k[_t]]&&(k.splice(_t,0,Ue),ot=!0);ot||(k[Te]=Ue),Te++}}for(let Ue=0;Ue<Te;Ue++){const At=k[Ue];X.push({idx:this.childOffsets[Y]+At,t:P[At],nodex:(ue<<1)+this._siblingOffset[At][0],nodey:(ge<<1)+this._siblingOffset[At][1],depth:Pe+1})}}return null}_addNode(i,s,f){return this.minimums.push(i),this.maximums.push(s),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(i,s,f,A,g){if(i[A].isLeaf(s,f)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const _=A-1,C=i[_];let T=0,P=0;for(let k=0;k<this._siblingOffset.length;k++){const N=2*s+this._siblingOffset[k][0],j=2*f+this._siblingOffset[k][1],X=C.getElevation(N,j),Y=C.isLeaf(N,j),ae=this._addNode(X.min,X.max,Y);Y&&(T|=1<<k),P||(P=ae)}for(let k=0;k<this._siblingOffset.length;k++)T&1<<k||this._construct(i,2*s+this._siblingOffset[k][0],2*f+this._siblingOffset[k][1],_,P+k)}}function HL(c,i,s,f,A,g){return tr(tr(c,s,g),tr(i,f,g),A)}function ig(c,i,s){const f=s.dim,A=je(c*f-.5,0,f-1),g=je(i*f-.5,0,f-1),_=Math.floor(A),C=Math.floor(g),T=Math.min(_+1,f-1),P=Math.min(C+1,f-1);return HL(s.get(_,C),s.get(T,C),s.get(_,P),s.get(T,P),A-_,g-C)}const NW={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function zW(c,i,s){return(256*c*256+256*i+s)/10-1e4}function QW(c,i,s){return 256*c+i+s/256-32768}class jx{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,s,f,A=!1){if(this.uid=i,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return void Hr(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const g=this.dim=s.height-2,_=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=A,this._modifiedForSources={},!A){for(let T=0;T<g;T++)_[this._idx(-1,T)]=_[this._idx(0,T)],_[this._idx(g,T)]=_[this._idx(g-1,T)],_[this._idx(T,-1)]=_[this._idx(T,0)],_[this._idx(T,g)]=_[this._idx(T,g-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(g,-1)]=_[this._idx(g-1,0)],_[this._idx(-1,g)]=_[this._idx(0,g-1)],_[this._idx(g,g)]=_[this._idx(g-1,g-1)]}const C=f==="terrarium"?QW:zW;for(let T=0;T<_.length;++T){const P=4*T;this.floatView[T]=C(this.pixels[P],this.pixels[P+1],this.pixels[P+2])}this._timestamp=bc.now()}_buildQuadTree(){this._tree=new jL(this)}get(i,s,f=!1){f&&(i=je(i,-1,this.dim),s=je(s,-1,this.dim));const A=this._idx(i,s);return this.floatView[A]}set(i,s,f){const A=this._idx(i,s),g=this.floatView[A];return this.floatView[A]=f,f-g}static getUnpackVector(i){return NW[i]}_idx(i,s){if(i<-1||i>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(i+1)}static pack(i,s){const f=[0,0,0,0],A=jx.getUnpackVector(s);let g=Math.floor((i+A[3])/A[2]);return f[2]=g%256,g=Math.floor(g/256),f[1]=g%256,g=Math.floor(g/256),f[0]=g,f}getPixels(){return new UF({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,s,f){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let A=s*this.dim,g=s*this.dim+this.dim,_=f*this.dim,C=f*this.dim+this.dim;switch(s){case-1:A=g-1;break;case 1:g=A+1}switch(f){case-1:_=C-1;break;case 1:C=_+1}const T=-s*this.dim,P=-f*this.dim;for(let k=_;k<C;k++)for(let N=A;N<g;N++){const j=4*this._idx(N,k),X=4*this._idx(N+T,k+P);this.pixels[j+0]=i.pixels[X+0],this.pixels[j+1]=i.pixels[X+1],this.pixels[j+2]=i.pixels[X+2],this.pixels[j+3]=i.pixels[X+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function jW(c,i,s){c===1?i.headerLength=s.readFixed32():c===2?i.x=s.readVarint():c===3?i.y=s.readVarint():c===4?i.z=s.readVarint():c===5&&i.layers.push(function(f,A){return f.readFields(WW,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},A)}(s,s.readVarint()+s.pos))}function HW(c,i,s){c===1?(i.delta_filter=function(f,A){return f.readFields(VW,{blockSize:0},A)}(s,s.readVarint()+s.pos),i.filter="delta_filter"):c===2?(s.readVarint(),i.filter="zigzag_filter"):c===3?(s.readVarint(),i.filter="bitshuffle_filter"):c===4&&(s.readVarint(),i.filter="byteshuffle_filter")}function VW(c,i,s){c===1&&(i.blockSize=s.readVarint())}function GW(c,i,s){c===1?(s.readVarint(),i.codec="gzip_data"):c===2?(s.readVarint(),i.codec="jpeg_image"):c===3?(s.readVarint(),i.codec="webp_image"):c===4&&(s.readVarint(),i.codec="png_image")}function KW(c,i,s){let f=0,A=0;c===1?i.firstByte=s.readFixed64():c===2?i.lastByte=s.readFixed64():c===3?i.filters.push(function(g,_){return g.readFields(HW,{},_)}(s,s.readVarint()+s.pos)):c===4?i.codec=function(g,_){return g.readFields(GW,{},_)}(s,s.readVarint()+s.pos):c===5?A=s.readFloat():c===6?f=s.readFloat():c===7?i.bands.push(s.readString()):c===8?i.offset=s.readDouble():c===9&&(i.scale=s.readDouble()),i.offset===0&&(i.offset=A),i.scale===0&&(i.scale=f)}function WW(c,i,s){c===1?i.version=s.readVarint():c===2?i.name=s.readString():c===3?i.units=s.readString():c===4?i.tileSize=s.readVarint():c===5?i.buffer=s.readVarint():c===6?i.pixelFormat=s.readVarint():c===7&&i.dataIndex.push(function(f,A){return f.readFields(KW,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},A)}(s,s.readVarint()+s.pos))}function qW(c,i,s){if(c===2)(function(f,A,g){f.readFields($W,g,A)})(s,s.readVarint()+s.pos,i);else if(c===3)throw new Error("Not implemented")}function $W(c,i,s){if(c===1){let f=0;const A=s.readVarint()+s.pos;for(;s.pos<A;)i[f++]=s.readVarint()}}function XW(c,i){if(i.length!==4)throw new Error(`Expected data of dimension 4 but got ${i.length}.`);let s=i[3];for(let f=2;f>=1;f--){const A=f===1?1:0,g=f===2?1:0;for(let _=0;_<i[0];_++){const C=i[1]*_;for(let T=A;T<i[1];T++){const P=i[2]*(T+C);for(let k=g;k<i[2];k++){const N=i[3]*(k+P);for(let j=0;j<i[3];j++){const X=N+j;c[X]+=c[X-s]}}}}s*=i[f]}return c}function ZW(c){for(let i=0,s=c.length;i<s;i++)c[i]=c[i]>>>1^-(1&c[i]);return c}function YW(c,i){switch(i){case"uint32":return c;case"uint16":for(let s=0;s<c.length;s+=2){const f=c[s],A=c[s+1];c[s]=(240&f)>>4|(61440&f)>>8|(240&A)<<4|61440&A,c[s+1]=15&f|(3840&f)>>4|(15&A)<<8|(3840&A)<<4}return c;case"uint8":for(let s=0;s<c.length;s+=4){const f=c[s],A=c[s+1],g=c[s+2],_=c[s+3];c[s+0]=(192&f)>>6|(192&A)>>4|(192&g)>>2|192&_,c[s+1]=(48&f)>>4|(48&A)>>2|48&g|(48&_)<<2,c[s+2]=(12&f)>>2|12&A|(12&g)<<2|(12&_)<<4,c[s+3]=3&f|(3&A)<<2|(3&g)<<4|(3&_)<<6}return c;default:throw new Error(`Invalid pixel format, "${i}"`)}}Mr(jx,"DEMData"),Mr(jL,"DemMinMaxQuadTree",{omit:["dem"]});var iA=Uint8Array,hy=Uint16Array,JW=Int32Array,VL=new iA([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),GL=new iA([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),eq=new iA([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),KL=function(c,i){for(var s=new hy(31),f=0;f<31;++f)s[f]=i+=1<<c[f-1];var A=new JW(s[30]);for(f=1;f<30;++f)for(var g=s[f];g<s[f+1];++g)A[g]=g-s[f]<<5|f;return{b:s,r:A}},WL=KL(VL,2),qL=WL.b,tq=WL.r;qL[28]=258,tq[258]=28;for(var rq=KL(GL,0).b,$L=new hy(32768),nl=0;nl<32768;++nl){var d_=(43690&nl)>>1|(21845&nl)<<1;$L[nl]=((65280&(d_=(61680&(d_=(52428&d_)>>2|(13107&d_)<<2))>>4|(3855&d_)<<4))>>8|(255&d_)<<8)>>1}var fy=function(c,i,s){for(var f=c.length,A=0,g=new hy(i);A<f;++A)c[A]&&++g[c[A]-1];var _,C=new hy(i);for(A=1;A<i;++A)C[A]=C[A-1]+g[A-1]<<1;_=new hy(1<<i);var T=15-i;for(A=0;A<f;++A)if(c[A])for(var P=A<<4|c[A],k=i-c[A],N=C[c[A]-1]++<<k,j=N|(1<<k)-1;N<=j;++N)_[$L[N]>>T]=P;return _},Ay=new iA(288);for(nl=0;nl<144;++nl)Ay[nl]=8;for(nl=144;nl<256;++nl)Ay[nl]=9;for(nl=256;nl<280;++nl)Ay[nl]=7;for(nl=280;nl<288;++nl)Ay[nl]=8;var XL=new iA(32);for(nl=0;nl<32;++nl)XL[nl]=5;var nq=fy(Ay,9),iq=fy(XL,5),BB=function(c){for(var i=c[0],s=1;s<c.length;++s)c[s]>i&&(i=c[s]);return i},Sd=function(c,i,s){var f=i/8|0;return(c[f]|c[f+1]<<8)>>(7&i)&s},CB=function(c,i){var s=i/8|0;return(c[s]|c[s+1]<<8|c[s+2]<<16)>>(7&i)},aq=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Td=function(c,i,s){var f=new Error(i||aq[c]);if(f.code=c,Error.captureStackTrace&&Error.captureStackTrace(f,Td),!s)throw f;return f},oq=new iA(0),sq=typeof TextDecoder<"u"&&new TextDecoder;try{sq.decode(oq,{stream:!0})}catch{}const lq={gzip_data:"gzip"};class VA extends Error{constructor(i){super(i),this.name="MRTError"}}const cq={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},ZL={uint32:1,uint16:2,uint8:4},uq={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let SB;class Hx{constructor(i=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=i}getLayer(i){const s=this.layers[i];if(!s)throw new VA(`Layer '${i}' not found`);return s}getHeaderLength(i){const s=new Uint8Array(i),f=new DataView(i);if(s[0]!==13)throw new VA("File is not a valid MRT.");return f.getUint32(1,!0)}parseHeader(i){const s=new Uint8Array(i),f=this.getHeaderLength(i);if(s.length<f)throw new VA(`Expected header with length >= ${f} but got buffer of length ${s.length}`);const A=new SB(s.subarray(0,f)).readFields(jW,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==A.x||this.y!==A.y||this.z!==A.z))throw new VA(`Invalid attempt to parse header ${A.z}/${A.x}/${A.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=A.x,this.y=A.y,this.z=A.z;for(const g of A.layers)this.layers[g.name]=new YL(g,{cacheSize:this._cacheSize});return this}createDecodingTask(i){const s=[],f=this.getLayer(i.layerName);for(let A of i.blockIndices){const g=f.dataIndex[A],_=g.firstByte-i.firstByte,C=g.lastByte-i.firstByte;if(f._blocksInProgress.has(A))continue;const T={layerName:f.name,firstByte:_,lastByte:C,pixelFormat:f.pixelFormat,blockIndex:A,blockShape:[g.bands.length].concat(f.bandShape),buffer:f.buffer,codec:g.codec.codec,filters:g.filters.map(P=>P.filter)};f._blocksInProgress.add(A),s.push(T)}return new JL(s,()=>{s.forEach(A=>f._blocksInProgress.delete(A.blockIndex))},(A,g)=>{if(s.forEach(_=>f._blocksInProgress.delete(_.blockIndex)),A)throw A;g.forEach(_=>{this.getLayer(_.layerName).processDecodedData(_)})})}}class YL{constructor({version:i,name:s,units:f,tileSize:A,pixelFormat:g,buffer:_,dataIndex:C},T){if(this.version=i,this.version!==1)throw new VA(`Cannot parse raster layer encoded with MRT version ${i}`);this.name=s,this.units=f,this.tileSize=A,this.buffer=_,this.pixelFormat=cq[g],this.dataIndex=C,this.bandShape=[A+2*_,A+2*_,ZL[this.pixelFormat]],this._decodedBlocks=new Qx(T?T.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return ZL[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:i})=>i).flat()}processDecodedData(i){const s=i.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,i.data)}getBlockForBand(i){let s=0;switch(typeof i){case"string":for(const[f,A]of this.dataIndex.entries()){for(const[g,_]of A.bands.entries())if(_===i)return{bandIndex:s+g,blockIndex:f,blockBandIndex:g};s+=A.bands.length}break;case"number":for(const[f,A]of this.dataIndex.entries()){if(i>=s&&i<s+A.bands.length)return{bandIndex:i,blockIndex:f,blockBandIndex:i-s};s+=A.bands.length}break;default:throw new VA(`Invalid band \`${JSON.stringify(i)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(i){let s=1/0,f=-1/0;const A=[],g=new Set;for(const _ of i){const{blockIndex:C}=this.getBlockForBand(_);if(C<0)throw new VA(`Invalid band: ${JSON.stringify(_)}`);const T=this.dataIndex[C];A.includes(C)||A.push(C),g.add(C),s=Math.min(s,T.firstByte),f=Math.max(f,T.lastByte)}if(g.size>this.cacheSize)throw new VA(`Number of blocks to decode (${g.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:f,blockIndices:A}}hasBand(i){const{blockIndex:s}=this.getBlockForBand(i);return s>=0}hasDataForBand(i){const{blockIndex:s}=this.getBlockForBand(i);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(i){const{blockIndex:s,blockBandIndex:f}=this.getBlockForBand(i);if(s<0)throw new VA(`Band not found: ${JSON.stringify(i)}`);const A=this._decodedBlocks.get(s.toString());if(!A)throw new VA(`Data for band ${JSON.stringify(i)} of layer "${this.name}" not decoded.`);const g=this.dataIndex[s],_=this.bandShape.reduce((P,k)=>P*k,1),C=f*_,T=A.subarray(C,C+_);return{data:T,bytes:new Uint8Array(T.buffer).subarray(T.byteOffset,T.byteOffset+T.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:g.offset,scale:g.scale}}}Hx.setPbf=function(c){SB=c};class JL{constructor(i,s,f){this.tasks=i,this._onCancel=s,this._onComplete=f,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(i,s){this._finalized||(this._onComplete(i,s),this._finalized=!0)}}Hx.performDecoding=function(c,i){const s=new Uint8Array(c);return Promise.all(i.tasks.map(f=>{const{layerName:A,firstByte:g,lastByte:_,pixelFormat:C,blockShape:T,blockIndex:P,filters:k,codec:N}=f,j=s.subarray(g,_+1),X=new Uint32Array(T[0]*T[1]*T[2]);let Y;if(N!=="gzip_data")throw new VA(`Unhandled codec: ${N}`);return Y=function(ae,ue){if(!globalThis.DecompressionStream&&ue==="gzip_data")return Promise.resolve(((Ue=function(ot){ot[0]==31&&ot[1]==139&&ot[2]==8||Td(6,"invalid gzip data");var _t=ot[3],wt=10;4&_t&&(wt+=2+(ot[10]|ot[11]<<8));for(var Yt=(_t>>3&1)+(_t>>4&1);Yt>0;Yt-=!ot[wt++]);return wt+(2&_t)}(Te=ae))+8>Te.length&&Td(6,"invalid gzip data"),function(ot,_t,wt,Yt){var Ft=ot.length;if(!Ft||_t.f&&!_t.l)return wt||new iA(0);var ir=!wt,Ir=ir||_t.i!=2,cr=_t.i;ir&&(wt=new iA(3*Ft));var xr,Tr,$t=function(vo){var Xa=wt.length;if(vo>Xa){var za=new iA(Math.max(2*Xa,vo));za.set(wt),wt=za}},wr=_t.f||0,Mt=_t.p||0,Xt=_t.b||0,Fr=_t.l,Er=_t.d,mn=_t.m,on=_t.n,vr=8*Ft;do{if(!Fr){wr=Sd(ot,Mt,1);var Cr=Sd(ot,Mt+1,3);if(Mt+=3,!Cr){var fn=ot[(Ge=4+((Mt+7)/8|0))-4]|ot[Ge-3]<<8,tn=Ge+fn;if(tn>Ft){cr&&Td(0);break}Ir&&$t(Xt+fn),wt.set(ot.subarray(Ge,tn),Xt),_t.b=Xt+=fn,_t.p=Mt=8*tn,_t.f=wr;continue}if(Cr==1)Fr=nq,Er=iq,mn=9,on=5;else if(Cr==2){var Dr=Sd(ot,Mt,31)+257,nn=Sd(ot,Mt+10,15)+4,Cn=Dr+Sd(ot,Mt+5,31)+1;Mt+=14;for(var kn=new iA(Cn),li=new iA(19),$n=0;$n<nn;++$n)li[eq[$n]]=Sd(ot,Mt+3*$n,7);Mt+=3*nn;var zi=BB(li),xi=(1<<zi)-1,$a=fy(li,zi);for($n=0;$n<Cn;){var Ge,Ke=$a[Sd(ot,Mt,xi)];if(Mt+=15&Ke,(Ge=Ke>>4)<16)kn[$n++]=Ge;else{var Kt=0,Pr=0;for(Ge==16?(Pr=3+Sd(ot,Mt,3),Mt+=2,Kt=kn[$n-1]):Ge==17?(Pr=3+Sd(ot,Mt,7),Mt+=3):Ge==18&&(Pr=11+Sd(ot,Mt,127),Mt+=7);Pr--;)kn[$n++]=Kt}}var Vr=kn.subarray(0,Dr),jr=kn.subarray(Dr);mn=BB(Vr),on=BB(jr),Fr=fy(Vr,mn),Er=fy(jr,on)}else Td(1);if(Mt>vr){cr&&Td(0);break}}Ir&&$t(Xt+131072);for(var un=(1<<mn)-1,Mn=(1<<on)-1,Fi=Mt;;Fi=Mt){var Pi=(Kt=Fr[CB(ot,Mt)&un])>>4;if((Mt+=15&Kt)>vr){cr&&Td(0);break}if(Kt||Td(2),Pi<256)wt[Xt++]=Pi;else{if(Pi==256){Fi=Mt,Fr=null;break}var mi=Pi-254;Pi>264&&(mi=Sd(ot,Mt,(1<<(Ai=VL[$n=Pi-257]))-1)+qL[$n],Mt+=Ai);var Sa=Er[CB(ot,Mt)&Mn],Eo=Sa>>4;if(Sa||Td(3),Mt+=15&Sa,jr=rq[Eo],Eo>3){var Ai=GL[Eo];jr+=CB(ot,Mt)&(1<<Ai)-1,Mt+=Ai}if(Mt>vr){cr&&Td(0);break}Ir&&$t(Xt+131072);var Ja=Xt+mi;if(Xt<jr){var Na=0-jr,da=Math.min(jr,Ja);for(Na+Xt<0&&Td(3);Xt<da;++Xt)wt[Xt]=(void 0)[Na+Xt]}for(;Xt<Ja;++Xt)wt[Xt]=wt[Xt-jr]}}_t.l=Fr,_t.p=Fi,_t.b=Xt,_t.f=wr,Fr&&(wr=1,_t.m=mn,_t.d=Er,_t.n=on)}while(!wr);return Xt!=wt.length&&ir?(xr=wt,((Tr=Xt)==null||Tr>xr.length)&&(Tr=xr.length),new iA(xr.subarray(0,Tr))):wt.subarray(0,Xt)}(Te.subarray(Ue,-8),{i:2},new iA(((ge=Te)[(Pe=ge.length)-4]|ge[Pe-3]<<8|ge[Pe-2]<<16|ge[Pe-1]<<24)>>>0))));var ge,Pe,Te,Ue;const At=lq[ue];if(!At)throw new Error(`Unhandled codec: ${ue}`);const at=new globalThis.DecompressionStream(At);return new Response(new Blob([ae]).stream().pipeThrough(at)).arrayBuffer().then(ot=>new Uint8Array(ot))}(j,N).then(ae=>(function(ue,ge){ue.readFields(qW,ge)}(new SB(ae),X),new uq[C](X.buffer))),Y.then(ae=>{for(let ue=k.length-1;ue>=0;ue--)switch(k[ue]){case"delta_filter":XW(ae,T);break;case"zigzag_filter":ZW(ae);break;case"bitshuffle_filter":YW(ae,C);break;default:throw new VA(`Unhandled filter "${k[ue]}"`)}return{layerName:A,blockIndex:P,data:ae}}).catch(ae=>{throw ae})}))},Mr(JL,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Mr(Hx,"MapboxRasterTile"),Mr(YL,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class eM{constructor(i){this._stringToNumber={},this._numberToString=[];for(let s=0;s<i.length;s++){const f=i[s];this._stringToNumber[f]=s,this._numberToString[s]=f}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const hq=["id","tile","layer","source","sourceLayer","state"];class p_{constructor(i,s,f,A,g){this.type="Feature",this._vectorTileFeature=i,this._z=s,this._x=f,this._y=A,this.properties=i.properties,this.id=g}clone(){const i=new p_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(i.state=Object.assign({},this.state)),this.layer&&(i.layer=Object.assign({},this.layer)),this.source&&(i.source=this.source),this.sourceLayer&&(i.sourceLayer=this.sourceLayer),i}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of hq)this[s]!==void 0&&(i[s]=this[s]);return i}}class tM{constructor(i,s){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new ja(Lr,16,0),this.featureIndexArray=new Kp,this.promoteId=s,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(i,s,f,A,g,_=0,C=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,A,g,_);const P=this.grid;for(let k=0;k<s.length;k++){const N=s[k],j=[1/0,1/0,-1/0,-1/0];for(let X=0;X<N.length;X++){const Y=N[X];j[0]=Math.min(j[0],Y.x),j[1]=Math.min(j[1],Y.y),j[2]=Math.max(j[2],Y.x),j[3]=Math.max(j[3],Y.y)}C!==0&&(j[0]-=C,j[1]-=C,j[2]+=C,j[3]+=C),j[0]<Lr&&j[1]<Lr&&j[2]>=0&&j[3]>=0&&P.insert(T,j[0],j[1],j[2],j[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new ln(new gx(this.rawTileData)).layers,this.sourceLayerCoder=new eM(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,s){const{tilespaceGeometry:f,transform:A,tileTransform:g,pixelPosMatrix:_,availableImages:C,worldview:T}=s;this.loadVTLayers(),this.serializedLayersCache.clear();const P=f.bufferedTilespaceBounds,k=this.grid.query(P.min.x,P.min.y,P.max.x,P.max.y,(Y,ae,ue,ge)=>mo(f.bufferedTilespaceGeometry,Y,ae,ue,ge));k.sort(fq);let N=null;A.elevation&&k.length>0&&(N=h_.create(A.elevation,this.tileID));const j={};let X;for(let Y=0;Y<k.length;Y++){const ae=k[Y];if(ae===X)continue;X=ae;const ue=this.featureIndexArray.get(ae);let ge=null;this.is3DTile?this.loadMatchingModelFeature(j,ue,i,f,A,T):this.loadMatchingFeature(j,ue,i,C,T,(Pe,Te,Ue,At=0)=>(ge||(ge=ht(Pe,this.tileID.canonical,g)),Te.queryIntersectsFeature(f,Pe,Ue,ge,this.z,A,_,N,At)))}return j}loadMatchingFeature(i,s,f,A,g,_){const{featureIndex:C,bucketIndex:T,sourceLayerIndex:P,layoutVertexArrayOffset:k}=s,N=this.bucketLayerIDs[T],j=f.layers,X=Object.keys(j);if(X.length&&!br(X,N))return;const Y=f.sourceCache,ae=this.sourceLayerCoder.decode(P),ue=this.vtLayers[ae].feature(C),ge=this.getId(ue,ae);for(let Pe=0;Pe<N.length;Pe++){const Te=N[Pe];if(!j[Te])continue;const{styleLayer:Ue,targets:At}=j[Te];let at={};ge!==void 0&&(at=Y.getFeatureState(Ue.sourceLayer,ge));const ot=!_||_(ue,Ue,at,k);if(!ot)continue;const _t=new p_(ue,this.z,this.x,this.y,ge);_t.tile=this.tileID.canonical,_t.state=at;let wt=this.serializedLayersCache.get(Te);wt||(wt=Ue.serialize(),wt.id=Te,this.serializedLayersCache.set(Te,wt)),_t.source=wt.source,_t.sourceLayer=wt["source-layer"],_t.layer=xe({},wt),_t.layer.paint=rM(wt.paint,Ue.paint,ue,at,A),_t.layer.layout=rM(wt.layout,Ue.layout,ue,at,A);let Yt=!1;for(const Ft of At){this.updateFeatureProperties(_t,Ft);const{filter:ir}=Ft;if(ir){if(ue.properties=_t.properties,ir.needGeometry){const Ir=zt(ue,!0);if(!ir.filter(new oa(this.tileID.overscaledZ,{worldview:g}),Ir,this.tileID.canonical))continue}else if(!ir.filter(new oa(this.tileID.overscaledZ,{worldview:g}),ue))continue}Yt=!0,Ft.targetId&&this.addFeatureVariant(_t,Ft)}Yt&&this.appendToResult(i,Te,C,_t,ot)}}loadMatchingModelFeature(i,s,f,A,g,_){const{featureIndex:C,bucketIndex:T}=s,P=this.bucketLayerIDs[T],k=f.layers,N=Object.keys(k);if(!N.length||br(N,P))for(let j=0;j<P.length;j++){const X=P[j],{styleLayer:Y,targets:ae}=k[X];if(Y.type!=="model")continue;const ue=A.tile,ge=ue.getBucket(Y);if(!(ge&&ge instanceof Rx))continue;const Pe=gW(ge,C,A,g);if(!Pe)continue;const{z:Te,x:Ue,y:At}=ue.tileID.canonical,{feature:at,intersectionZ:ot,position:_t}=Pe;let wt={};at.id!==void 0&&(wt=f.sourceCache.getFeatureState(Y.sourceLayer,at.id));const Yt=new p_({},Te,Ue,At,at.id);Yt.tile=this.tileID.canonical,Yt.state=wt,Yt.properties=at.properties,Yt.geometry={type:"Point",coordinates:[_t.lng,_t.lat]};let Ft=this.serializedLayersCache.get(X);Ft||(Ft=Y.serialize(),Ft.id=X,this.serializedLayersCache.set(X,Ft)),Yt.source=Ft.source,Yt.sourceLayer=Ft["source-layer"],Yt.layer=xe({},Ft);let ir=!1;for(const Ir of ae){this.updateFeatureProperties(Yt,Ir);const{filter:cr}=Ir;if(cr){if(at.properties=Yt.properties,cr.needGeometry){if(!cr.filter(new oa(this.tileID.overscaledZ,{worldview:_}),at,this.tileID.canonical))continue}else if(!cr.filter(new oa(this.tileID.overscaledZ,{worldview:_}),at))continue}ir=!0,Ir.targetId&&this.addFeatureVariant(Yt,Ir)}ir&&this.appendToResult(i,X,C,Yt,ot)}}updateFeatureProperties(i,s,f){if(s.properties){const A={};for(const g in s.properties){const _=s.properties[g].evaluate({zoom:this.z},i._vectorTileFeature,i.state,i.tile,f);_!=null&&(A[g]=_)}i.properties=A}}addFeatureVariant(i,s,f){const A={target:s.target,namespace:s.namespace,uniqueFeatureID:s.uniqueFeatureID};s.properties&&(A.properties=i.properties),i.variants=i.variants||{},i.variants[s.targetId]=i.variants[s.targetId]||[],i.variants[s.targetId].push(A)}appendToResult(i,s,f,A,g){let _=i[s];_===void 0&&(_=i[s]=[]),_.push({featureIndex:f,feature:A,intersectionZ:g})}lookupSymbolFeatures(i,s,f,A,g,_){const C={};this.loadVTLayers();for(const T of i)this.loadMatchingFeature(C,{bucketIndex:s,sourceLayerIndex:f,featureIndex:T,layoutVertexArrayOffset:0},A,g,_);return C}loadFeature(i){const{featureIndex:s,sourceLayerIndex:f}=i;this.loadVTLayers();const A=this.sourceLayerCoder.decode(f),g=this.vtFeatures[A];if(g[s])return g[s];const _=this.vtLayers[A].feature(s);return g[s]=_,_}hasLayer(i){for(const s of this.bucketLayerIDs)for(const f of s)if(i===f)return!0;return!1}getId(i,s){let f=i.id;if(this.promoteId){const A=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[s];if(A!=null)if(Array.isArray(A)){if(!this.promoteIdExpression){const g=Wo(A);if(g.result!=="success"){const _=g.value.map(C=>`${C.key}: ${C.message}`).join(", ");return void Hr(`Failed to create expression for promoteId: ${_}`)}this.promoteIdExpression=g.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new bu),f=this.promoteIdExpression.evaluate({zoom:0},i)}else f=i.properties[A];typeof f=="boolean"&&(f=Number(f))}return f}}function rM(c,i,s,f,A){return Rt(c,(g,_)=>{const C=i instanceof Ju?i.get(_):null;return C&&C.evaluate?C.evaluate(s,f,void 0,A):C})}function fq(c,i){return i-c}Mr(tM,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const nM=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class TB{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,f]=new Uint8Array(i,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const A=f>>4;if(A!==1)throw new Error(`Got v${A} data when expected v1.`);const g=nM[15&f];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(i,2,1),[C]=new Uint32Array(i,4,1);return new TB(C,_,g,i)}constructor(i,s=64,f=Float64Array,A){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=f,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const g=nM.indexOf(this.ArrayType),_=2*i*this.ArrayType.BYTES_PER_ELEMENT,C=i*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-C%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${f}.`);A&&A instanceof ArrayBuffer?(this.data=A,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+C+T,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+_+C+T),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+C+T,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=i)}add(i,s){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=i,this.coords[this._pos++]=s,f}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return IB(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,s,f,A){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:C}=this,T=[0,g.length-1,0],P=[];for(;T.length;){const k=T.pop()||0,N=T.pop()||0,j=T.pop()||0;if(N-j<=C){for(let ue=j;ue<=N;ue++){const ge=_[2*ue],Pe=_[2*ue+1];ge>=i&&ge<=f&&Pe>=s&&Pe<=A&&P.push(g[ue])}continue}const X=j+N>>1,Y=_[2*X],ae=_[2*X+1];Y>=i&&Y<=f&&ae>=s&&ae<=A&&P.push(g[X]),(k===0?i<=Y:s<=ae)&&(T.push(j),T.push(X-1),T.push(1-k)),(k===0?f>=Y:A>=ae)&&(T.push(X+1),T.push(N),T.push(1-k))}return P}within(i,s,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:A,coords:g,nodeSize:_}=this,C=[0,A.length-1,0],T=[],P=f*f;for(;C.length;){const k=C.pop()||0,N=C.pop()||0,j=C.pop()||0;if(N-j<=_){for(let ue=j;ue<=N;ue++)aM(g[2*ue],g[2*ue+1],i,s)<=P&&T.push(A[ue]);continue}const X=j+N>>1,Y=g[2*X],ae=g[2*X+1];aM(Y,ae,i,s)<=P&&T.push(A[X]),(k===0?i-f<=Y:s-f<=ae)&&(C.push(j),C.push(X-1),C.push(1-k)),(k===0?i+f>=Y:s+f>=ae)&&(C.push(X+1),C.push(N),C.push(1-k))}return T}}function IB(c,i,s,f,A,g){if(A-f<=s)return;const _=f+A>>1;iM(c,i,_,f,A,g),IB(c,i,s,f,_-1,1-g),IB(c,i,s,_+1,A,1-g)}function iM(c,i,s,f,A,g){for(;A>f;){if(A-f>600){const P=A-f+1,k=s-f+1,N=Math.log(P),j=.5*Math.exp(2*N/3),X=.5*Math.sqrt(N*j*(P-j)/P)*(k-P/2<0?-1:1);iM(c,i,s,Math.max(f,Math.floor(s-k*j/P+X)),Math.min(A,Math.floor(s+(P-k)*j/P+X)),g)}const _=i[2*s+g];let C=f,T=A;for(dy(c,i,f,s),i[2*A+g]>_&&dy(c,i,f,A);C<T;){for(dy(c,i,C,T),C++,T--;i[2*C+g]<_;)C++;for(;i[2*T+g]>_;)T--}i[2*f+g]===_?dy(c,i,f,T):(T++,dy(c,i,T,A)),T<=s&&(f=T+1),s<=T&&(A=T-1)}}function dy(c,i,s,f){FB(c,s,f),FB(i,2*s,2*f),FB(i,2*s+1,2*f+1)}function FB(c,i,s){const f=c[i];c[i]=c[s],c[s]=f}function aM(c,i,s,f){const A=c-s,g=i-f;return A*A+g*g}a.$=fa,a.A=rc,a.B=ss,a.C=$h,a.D=t_,a.E=yu,a.F=2,a.G=ey,a.H=PP,a.I=fo,a.J=ac,a.K=class extends Dx{},a.L=Bi,a.M=Lc,a.N=Vo,a.O=ra,a.P=hr,a.Q=Fa,a.R=Ec,a.S=Ko,a.T=VE,a.U=qh,a.V=Dx,a.W=Pa,a.X=Wo,a.Y=gf,a.Z=_f,a._=Zu,a.a=function(c){return Ss.API_CDN_URL_REGEX.test(c)},a.a$=Oe,a.a0=ze,a.a1=Bf,a.a2=aa,a.a3=si,a.a4=function(c){const i=c.value;let s=[];if(!i)return s;const f=ac(i);return f!=="string"?(s=s.concat([new Dx(c.key,i,`string expected, "${f}" found`)]),s):(gB(i,!0)||(s=s.concat([new Dx(c.key,i,`invalid url "${i}"`)])),s)},a.a5=Bt,a.a6=is,a.a7=_a,a.a8=ur,a.a9=class{constructor(c){this.specification=c}possiblyEvaluate(c,i){return Vn(c.expression.evaluate(i))}interpolate(c,i,s){return{x:tr(c.x,i.x,s),y:tr(c.y,i.y,s),z:tr(c.z,i.z,s),azimuthal:tr(c.azimuthal,i.azimuthal,s),polar:tr(c.polar,i.polar,s)}}},a.aA=yn,a.aB=Vl,a.aC=Kl,a.aD=le,a.aE=gt,a.aF=function(c,i){const s={};for(let f=0;f<i.length;f++){const A=i[f];A in c&&(s[A]=c[A])}return s},a.aG=Z,a.aH=Ae,a.aI=class{constructor(c){this.entries={},this.scheduler=c}request(c,i,s,f){const A=this.entries[c]=this.entries[c]||{callbacks:[]};if(A.result){const[g,_]=A.result;return this.scheduler?this.scheduler.add(()=>{f(g,_)},i):f(g,_),()=>{}}return A.callbacks.push(f),A.cancel||(A.cancel=s((g,_)=>{A.result=[g,_];for(const C of A.callbacks)this.scheduler?this.scheduler.add(()=>{C(g,_)},i):C(g,_);setTimeout(()=>delete this.entries[c],3e3)})),()=>{A.result||(A.callbacks=A.callbacks.filter(g=>g!==f),A.callbacks.length||(A.cancel(),delete this.entries[c]))}}},a.aJ=function(c,i,s){const f=JSON.stringify(c.request);return c.data&&(this.deduped.entries[f]={result:[null,c.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},A=>{const g=Xc(c.request,(_,C,T,P)=>{_?A(_):C&&A(null,{vectorTile:s?void 0:new ln(new gx(C)),rawData:C,cacheControl:T,expires:P})});return()=>{g.cancel(),A()}},i)},a.aK=function(c){hf++,hf>ma&&(c.getActor().send("enforceCacheSizeLimit",Nl),hf=0)},a.aL=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},a.aM=Yo,a.aN=oL,a.aO=fL,a.aP=aL,a.aQ=function(c,i){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){i(null,s)};for(let f=0;f<c.length;f++){const A=document.createElement("source");Kd(c[f])||(s.crossOrigin="Anonymous"),A.src=c[f],s.appendChild(A)}return{cancel:()=>{}}},a.aR=qv,a.aS=function(c){return fetch(c).then(i=>i.arrayBuffer()).then(i=>k4(i,0,c))},a.aT=G4,a.aU=class{constructor(c,i,s,f){this.id=c,this.position=i!=null?new V(i[0],i[1]):new V(0,0),this.orientation=s??[0,0,0],this.nodes=f,this.uploaded=!1,this.aabb=new In([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,i){if(q(c.matrix,i,c.matrix),c.meshes)for(const s of c.meshes){const f=In.applyTransformFast(s.aabb,c.matrix);this.aabb.encapsulate(f)}if(c.children)for(const s of c.children)this._applyTransformations(s,c.matrix)}computeBoundsAndApplyParent(){const c=R([]);for(const i of this.nodes)this._applyTransformations(i,c)}computeModelMatrix(c,i,s,f,A,g,_=!1){H4(this.matrix,this,c.transform,this.position,i,s,f,A,g,_)}upload(c){if(!this.uploaded){for(const i of this.nodes)WE(i,c);for(const i of this.nodes)mx(i);this.uploaded=!0}}destroy(){for(const c of this.nodes)qE(c)}},a.aV=Ht,a.aW=ny,a.aX=Ce,a.aY=ke,a.aZ=vd,a.a_=Ua,a.aa=oa,a.ab=ro,a.ac=tt,a.ad=Ct,a.ae=Ze,a.af=oe,a.ag=Ju,a.ah=nr,a.ai=tr,a.aj=Lr,a.ak=ri,a.al=_n,a.am=ft,a.an=class{constructor(c){this.specification=c}possiblyEvaluate(c,i){return function([s,f]){const A=Vn([1,s,f]);return{x:A.x,y:A.y,z:A.z}}(c.expression.evaluate(i))}interpolate(c,i,s){return{x:tr(c.x,i.x,s),y:tr(c.y,i.y,s),z:tr(c.z,i.z,s)}}},a.ao=function(c,i,s=0,f=!0){const A=new hr(s,s),g=c.sub(A),_=i.add(A),C=[g,new hr(_.x,g.y),_,new hr(g.x,_.y)];return f&&C.push(g.clone()),C},a.ap=function(c,i){const s=[];for(let f=0;f<c.length;f++){const A=Ee(f-1,-1,c.length-1),g=Ee(f+1,-1,c.length-1),_=c[f],C=c[g],T=c[A].sub(_).unit(),P=C.sub(_).unit(),k=P.angleWithSep(T.x,T.y),N=T.add(P).unit().mult(-1*i/Math.sin(k/2));s.push(_.add(N))}return s},a.aq=GP,a.ar=mo,a.as=function(c,i,s=0){return st(((i.x-s)*c.scale-c.x)*Lr,(i.y*c.scale-c.y)*Lr,He(i.z,i.y))},a.at=mt,a.au=et,a.av=Wi,a.aw=rP,a.ax=function(c){let i=1/0,s=1/0,f=-1/0,A=-1/0;for(const g of c)i=Math.min(i,g.x),s=Math.min(s,g.y),f=Math.max(f,g.x),A=Math.max(A,g.y);return{min:new hr(i,s),max:new hr(f,A)}},a.ay=je,a.az=q,a.b=function(c){return Ss.API_FONTS_REGEX.test(c)},a.b$=lB,a.b0=Ng,a.b1=Px,a.b2=function(){au.isLoading()||au.isLoaded()||gd()!=="deferred"||np()},a.b3=ou,a.b4=zt,a.b5=p_,a.b6=Sn,a.b7=ZE,a.b8=IE,a.b9=ht,a.bA=function(c,i){const{x:s,y:f}=c.point,A=_r(s,f,c.worldSize/c._pixelsPerMercatorPixel,0,0);return q(A,A,fi(re(i)))},a.bB=b,a.bC=sn,a.bD=function(c,i){return Math.hypot(i[0]-c[0],i[1]-c[1],i[2]-c[2])},a.bE=ie,a.bF=Dt,a.bG=xt,a.bH=Jv,a.bI=nf,a.bJ=iB,a.bK=function(c,i,s,f,A){const g=5*i+2;c.float32[g+0]=s,c.float32[g+1]=f,c.float32[g+2]=A},a.bL=Fx,a.bM=ua,a.bN=Li,a.bO=ca,a.bP=wa,a.bQ=Ee,a.bR=function(c,i,s,f){var A=new x(4);return A[0]=c,A[1]=i,A[2]=s,A[3]=f,A},a.bS=cx,a.bT=ga,a.bU=Wl,a.bV=r4,a.bW=AL,a.bX=o4,a.bY=LE,a.bZ=nB,a.b_=UP,a.ba=Dc,a.bb=Nm,a.bc=J1,a.bd=no,a.be=J0,a.bf=pB,a.bg=function(c,i){const s=nr(i.zoom);if(s===0)return re(c);const f=qt(c),A=Or(f),g=le(f.getWest())*i.worldSize,_=le(f.getEast())*i.worldSize,C=Ae(f.getNorth())*i.worldSize,T=Ae(f.getSouth())*i.worldSize,P=[g,C,0],k=[_,C,0],N=[g,T,0],j=[_,T,0],X=H([],i.globeMatrix);return Ct(P,P,X),Ct(k,k,X),Ct(N,N,X),Ct(j,j,X),A[0]=de(A[0],N,s),A[1]=de(A[1],j,s),A[2]=de(A[2],k,s),A[3]=de(A[3],P,s),In.fromPoints(A)},a.bh=qn,a.bi=H,a.bj=pn,a.bk=de,a.bl=sp,a.bm=Wg,a.bn=Be,a.bo=te,a.bp=Hx,a.bq=gx,a.br=Xc,a.bs=function(c,i){const s=[];for(const f in c)f in i||s.push(f);return s},a.bt=me,a.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.bv=Bo,a.bw=function(c){var i=new x(16);return i[0]=c[0],i[1]=c[1],i[2]=c[2],i[3]=c[3],i[4]=c[4],i[5]=c[5],i[6]=c[6],i[7]=c[7],i[8]=c[8],i[9]=c[9],i[10]=c[10],i[11]=c[11],i[12]=c[12],i[13]=c[13],i[14]=c[14],i[15]=c[15],i},a.bx=R,a.by=Se,a.bz=U,a.c=Rf,a.c$=45,a.c0=TB,a.c1=lt,a.c2=$r,a.c3=Zn,a.c4=function(c,i,s){s*=.5;var f=i[0],A=i[1],g=i[2],_=i[3],C=Math.sin(s),T=Math.cos(s);return c[0]=f*T+A*C,c[1]=A*T-f*C,c[2]=g*T+_*C,c[3]=_*T-g*C,c},a.c5=Vi,a.c6=ha,a.c7=function(c,i){return c[0]=-i[0],c[1]=-i[1],c[2]=-i[2],c[3]=i[3],c},a.c8=we,a.c9=function(c,i,s,f,A){var g,_=1/Math.tan(i/2);return c[0]=_/s,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=_,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,A!=null&&A!==1/0?(c[10]=(A+f)*(g=1/(f-A)),c[14]=2*A*f*g):(c[10]=-1,c[14]=-2*f),c},a.cA=kc,a.cB=Lt,a.cC=function(c,i,s,f,A,g,_,C,T){if(T.name==="globe")return Lt(c,i,new kc(s,f,A),!1);const P=ny({z:s,x:f,y:A},T);return new In([(g+P.x/P.scale)*i,i*(P.y/P.scale),_],[(g+P.x2/P.scale)*i,i*(P.y2/P.scale),C])},a.cD=function(c,i,s){return c[0]=Math.min(i[0],s[0]),c[1]=Math.min(i[1],s[1]),c[2]=Math.min(i[2],s[2]),c[3]=Math.min(i[3],s[3]),c},a.cE=function(c,i,s){return c[0]=Math.max(i[0],s[0]),c[1]=Math.max(i[1],s[1]),c[2]=Math.max(i[2],s[2]),c[3]=Math.max(i[3],s[3]),c},a.cF=function(c){const i=Math.round((c+45+360)%360/90)%4;return pe[i]},a.cG=$e,a.cH=an,a.cI=p,a.cJ=function(c){const i=R(new Float64Array(16));q(i,c.pixelMatrix,c.globeMatrix);const s=[0,w,0],f=[0,E,0];return Ct(s,s,i),Ct(f,f,i),[s[0]>0&&s[0]<=c.width&&s[1]>0&&s[1]<=c.height&&!Bn(c,new V(c.center.lat,90)),f[0]>0&&f[0]<=c.width&&f[1]>0&&f[1]<=c.height&&!Bn(c,new V(c.center.lat,-90))]},a.cK=function(c,i){const{scale:s}=c.tileTransform,f=s*Lr/(c.tileSize*Math.pow(2,i.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return function(A,g,_){var C=g[1],T=g[2],P=g[3],k=_[0],N=_[1];return A[0]=g[0]*k,A[1]=C*k,A[2]=T*N,A[3]=P*N,A}(new Float32Array(4),i.inverseAdjustmentMatrix,[f,f])},a.cL=dx,a.cM=nt,a.cN=U4,a.cO=function(c){const i=U4(c,!0);return b([],[i[0],i[1],i[4],i[5]])},a.cP=J,a.cQ=Ji,a.cR=se,a.cS=function(c){const{x:i,y:s}=c.point,{lng:f,lat:A}=c._center;return _r(i,s,c.worldSize,f,A)},a.cT=bt,a.cU=Tt,a.cV=Ou,a.cW=go,a.cX=Kg,a.cY=function(c,i,s){let f=0;for(let A=0;A<2;++A)c[A]>0&&(f+=(c[A]-0)*(c[A]-0)),i[A]<0&&(f+=(0-i[A])*(0-i[A]));return f},a.cZ=function(c){return c*c*c*c*c},a.c_=he,a.ca=function(c,i,s,f,A,g,_){var C=1/(i-s),T=1/(f-A),P=1/(g-_);return c[0]=-2*C,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*T,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*P,c[11]=0,c[12]=(i+s)*C,c[13]=(A+f)*T,c[14]=(_+g)*P,c[15]=1,c},a.cb=fe,a.cc=function(c,i,s){c[4*i+0]=s[0],c[4*i+1]=s[1],c[4*i+2]=s[2],c[4*i+3]=s[3]},a.cd=Dl,a.ce=Jh,a.cf=Xo,a.cg=jn,a.ch=rA,a.ci=V,a.cj=XP,a.ck=function(){var c=new x(4);return x!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},a.cl=function(c,i,s){var f=i[0],A=i[1],g=i[2],_=i[3],C=Math.sin(s),T=Math.cos(s);return c[0]=f*T+g*C,c[1]=A*T+_*C,c[2]=f*-C+g*T,c[3]=A*-C+_*T,c},a.cm=function(c,i){return c[0]===i[0]&&c[1]===i[1]&&c[2]===i[2]&&c[3]===i[3]},a.cn=er,a.co=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},a.cp=ti,a.cq=Zt,a.cr=Ch,a.cs=3,a.ct=2,a.cu=7,a.cv=6,a.cw=pt,a.cx=_e,a.cy=na,a.cz=N4,a.d=function(c){return Ss.API_TILEJSON_REGEX.test(c)},a.d$=(c,i,s,f,A,g,_,C,T,P)=>{const k=c.transform,N=k.calculatePixelsToTileUnitsMatrix(i),j=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none",X=k.pitch<15?nP(.07,.7,je((14-k.zoom)/5,0,1)):.07;return{u_matrix:aP(c,i,s,f),u_pixels_to_tile_units:N,u_device_pixel_ratio:g,u_width_scale:_,u_floor_width_scale:C,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:A,u_texsize:sP(s)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:iP(i,c.transform),u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toPremultipliedRenderColor(j?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:X,u_tile_to_meter:Ye(i.tileID.canonical,0),u_ground_shadow_factor:P}},a.d0=wd,a.d1=function(c,i,s){const f=Math.sqrt(c*c+i*i+s*s),A=f>0?Math.acos(s/f)*sl:0;let g=c!==0||i!==0?Math.atan2(-i,-c)*sl+90:0;return g<0&&(g+=360),[f,g,A]},a.d2=st,a.d3=Vn,a.d4=Ye,a.d5=Ut,a.d6=In,a.d7=jt,a.d8=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},a.d9=gB,a.dA=qt,a.dB=function(c){const i=$e-5;c=je(c,-i,i)/i*90;const s=Math.pow(Math.abs(Math.sin(_n(c))),3);return Math.round(s*(m.length-1))},a.dC=function(c,i,s,f){const A=i.getNorth(),g=i.getSouth(),_=i.getWest(),C=i.getEast(),T=1<<c.z,P=C-_,k=A-g,N=P/h,j=-k/m[s],X=[0,N,0,j,0,0,A,_,0];if(c.z>0){const Y=180/f;L(X,X,[Y/P+1,0,0,0,Y/k+1,0,-.5*Y/N,.5*Y/j,1])}return X[2]=T,X[5]=c.x,X[8]=c.y,X},a.dD=re,a.dE=function(c,i,s){const f=R(new Float64Array(16)),A=(i/(1<<c)-.5)*Math.PI*2;return ye(f,s.globeMatrix,A),Float32Array.from(f)},a.dF=class{isDataAvailableAtPoint(c){const i=this._source();if(this.isUsingMockSource()||!i||c.y<0||c.y>1)return!1;const s=i.getSource().maxzoom,f=1<<s,A=Math.floor(c.x),g=Math.floor((c.x-A)*f),_=Math.floor(c.y*f),C=this.findDEMTileFor(new Yo(s,A,s,g,_));return!(!C||!C.dem)}getAtPointOrZero(c,i=0){return this.getAtPoint(c,i)||0}getAtPoint(c,i,s=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const f=this._source();if(!f||c.y<0||c.y>1)return i;const A=f.getSource().maxzoom,g=1<<A,_=Math.floor(c.x),C=c.x-_,T=new Yo(A,_,A,Math.floor(C*g),Math.floor(c.y*g)),P=this.findDEMTileFor(T);if(!P||!P.dem)return i;const k=P.dem,N=1<<P.tileID.canonical.z,j=(C*N-P.tileID.canonical.x)*k.dim,X=(c.y*N-P.tileID.canonical.y)*k.dim,Y=Math.floor(j),ae=Math.floor(X);return(s?this.exaggeration():1)*tr(tr(k.get(Y,ae),k.get(Y,ae+1),X-ae),tr(k.get(Y+1,ae),k.get(Y+1,ae+1),X-ae),j-Y)}getAtTileOffset(c,i,s){const f=1<<c.canonical.z;return this.getAtPointOrZero(new tt(c.wrap+(c.canonical.x+i/Lr)/f,(c.canonical.y+s/Lr)/f))}getAtTileOffsetFunc(c,i,s,f){return A=>{const g=this.getAtTileOffset(c,A.x,A.y),_=f.upVector(c.canonical,A.x,A.y);return lt(_,_,g*f.upVectorScale(c.canonical,i,s).metersToTile),_}}getForTilePoints(c,i,s,f){if(this.isUsingMockSource())return!1;const A=h_.create(this,c,f);return!!A&&(i.forEach(g=>{g[2]=this.exaggeration()*A.getElevationAt(g[0],g[1],s)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(c);if(!i||!i.dem)return null;const s=i.dem.tree,f=i.tileID,A=1<<c.canonical.z-f.canonical.z;let g=c.canonical.x/A-f.canonical.x,_=c.canonical.y/A-f.canonical.y,C=0;for(let T=0;T<c.canonical.z-f.canonical.z&&!s.leaves[C];T++){g*=2,_*=2;const P=2*Math.floor(_)+Math.floor(g);C=s.childOffsets[C]+P,g%=1,_%=1}return{min:this.exaggeration()*s.minimums[C],max:this.exaggeration()*s.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,i,s){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let i=!1,s=Number.MAX_VALUE,f=Number.MIN_VALUE;for(const A of c){const g=this.getMinMaxForTile(A.tileID);g&&(s=Math.min(s,g.min),f=Math.max(f,g.max),i=!0)}return i?{min:s,max:f}:null}},a.dG=UF,a.dH=Wp,a.dI=function(c,i){return[Math.pow(c[0],2.2)*i,Math.pow(c[1],2.2)*i,Math.pow(c[2],2.2)*i]},a.dJ=I,a.dK=function(c,i){var s=Math.sin(i),f=Math.cos(i);return c[0]=f,c[1]=s,c[2]=0,c[3]=-s,c[4]=f,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},a.dL=mr,a.dM=_l,a.dN=Ra,a.dO=es,a.dP=256,a.dQ=function(c,i){const s=[0,0,0];return Ct(s,s,qn(re(i.canonical))),Ct(s,s,c),s},a.dR=c=>({u_matrix:new rA(c),u_texsize:new jn(c),u_pixels_to_tile_units:new Xm(c),u_device_pixel_ratio:new Xo(c),u_width_scale:new Xo(c),u_floor_width_scale:new Xo(c),u_image:new Dl(c),u_units_to_pixels:new jn(c),u_tile_units_to_pixels:new Xo(c),u_alpha_discard_threshold:new Xo(c),u_trim_offset:new jn(c),u_trim_fade_range:new jn(c),u_trim_color:new wd(c),u_emissive_strength:new Xo(c),u_zbias_factor:new Xo(c),u_tile_to_meter:new Xo(c),u_ground_shadow_factor:new Jh(c),u_pattern_transition:new Xo(c)}),a.dS=c=>({u_matrix:new rA(c),u_pixels_to_tile_units:new Xm(c),u_device_pixel_ratio:new Xo(c),u_width_scale:new Xo(c),u_floor_width_scale:new Xo(c),u_units_to_pixels:new jn(c),u_dash_image:new Dl(c),u_gradient_image:new Dl(c),u_image_height:new Xo(c),u_texsize:new jn(c),u_tile_units_to_pixels:new Xo(c),u_alpha_discard_threshold:new Xo(c),u_trim_offset:new jn(c),u_trim_fade_range:new jn(c),u_trim_color:new wd(c),u_emissive_strength:new Xo(c),u_zbias_factor:new Xo(c),u_tile_to_meter:new Xo(c),u_ground_shadow_factor:new Jh(c)}),a.dT=c=>({u_camera_to_center_distance:new Xo(c),u_extrude_scale:new Xm(c),u_device_pixel_ratio:new Xo(c),u_matrix:new rA(c),u_inv_rot_matrix:new rA(c),u_merc_center:new jn(c),u_tile_id:new Jh(c),u_zoom_transition:new Xo(c),u_up_dir:new Jh(c),u_emissive_strength:new Xo(c)}),a.dU=Yh,a.dV=BK,a.dW=hc,a.dX=(c,i,s,f,A,g)=>{const _=c.transform,C=_.projection.name==="globe";let T;if(g.paint.get("circle-pitch-alignment")==="map")if(C){const k=_l(_.zoom,i.canonical)*_._pixelsPerMercatorPixel;T=Float32Array.from([k,0,0,k])}else T=_.calculatePixelsToTileUnitsMatrix(s);else T=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);const P={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(_.projection),u_matrix:c.translatePosMatrix(i.projMatrix,s,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_device_pixel_ratio:bc.devicePixelRatio,u_extrude_scale:T,u_inv_rot_matrix:la,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:g.paint.get("circle-emissive-strength")};if(C){P.u_inv_rot_matrix=f,P.u_merc_center=A,P.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],P.u_zoom_transition=nr(_.zoom);const k=A[0]*Lr,N=A[1]*Lr;P.u_up_dir=_.projection.upVector(new kc(0,0,0),k,N)}return P},a.dY=oP,a.dZ=fl,a.d_=(c,i,s,f,A,g,_,C,T,P)=>{const k=c.transform,N=k.pitch<15?nP(.07,.7,je((14-k.zoom)/5,0,1)):.07,j=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:aP(c,i,s,f),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:k.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:A,u_width_scale:g,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:iP(i,k),u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:C,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toPremultipliedRenderColor(j?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:N,u_tile_to_meter:Ye(i.tileID.canonical,0),u_ground_shadow_factor:T,u_pattern_transition:P}},a.da=function(c,i){return c.readFields(yW,{icons:[]},i)},a.db=ux,a.dc=l_,a.dd=oB,a.de=kf,a.df=rp,a.dg=ll,a.dh=vu,a.di=Gt,a.dj=function(c){const i=c.indexOf(eh);return i>=0?c.slice(0,i):c},a.dk=function(c){return c.indexOf(eh)>=0},a.dl=function(c){const i=c.lastIndexOf(eh);return i>=0?c.slice(i+1):""},a.dm=function(c){const i=[],s=c.id;return s===void 0&&i.push({message:`layers.${s}: missing required property "id"`}),c.render===void 0&&i.push({message:`layers.${s}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&i.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),i},a.dn=function(c,i,s,f){return c.type==="custom"?new dW(c,i):new _W[c.type](c,i,s,f)},a.dp=Vt,a.dq=function(c){const i=c.indexOf(eh);return i>=0?c.slice(i+1):""},a.dr=class extends p_{constructor(c,i){super(c._vectorTileFeature,c._z,c._x,c._y,c.id),c.state&&(this.state=Object.assign({},c.state)),this.target=i.target,this.namespace=i.namespace,i.properties&&(this.properties=i.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=c.source,this.sourceLayer=c.sourceLayer,this.layer=c.layer)}toJSON(){const c=super.toJSON();return c.target=this.target,c.namespace=this.namespace,c}},a.ds=iu,a.dt=hl,a.du=function(c){return c({pluginStatus:$o,pluginURL:Wh}),iu.on("pluginStateChange",c),c},a.dv=Wm,a.dw=class extends su{constructor(c){super(c),this.current=qm}set(c,i,s){if(this.fetchUniformLocation(c,i)){for(let f=0;f<9;f++)if(s[f]!==this.current[f]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},a.dx=be,a.dy=function(c,i,s){const f=nr(s.zoom),A=c.style.map._antialias,g=c.terrain&&c.terrain.exaggeration()>0;return f===0&&!A&&!g},a.dz=function(c){const i=c.pixelsPerMeter,s=i/fe(1,c.center.lat),f=R(new Float64Array(16));return te(f,f,[c.point.x,c.point.y,0]),J(f,f,[s,s,i]),Float32Array.from(f)},a.e=Ss,a.e$=gd,a.e0=St,a.e1=Mv,a.e2=He,a.e3=Ed,a.e4=lx,a.e5=_4,a.e6=Jm,a.e7=450,a.e8=7,a.e9=ct,a.eA=function(c,i,s,f,A,g,_,C,T,P,k,N,j,X,Y,ae){var ue=new x(16);return ue[0]=c,ue[1]=i,ue[2]=s,ue[3]=f,ue[4]=A,ue[5]=g,ue[6]=_,ue[7]=C,ue[8]=T,ue[9]=P,ue[10]=k,ue[11]=N,ue[12]=j,ue[13]=X,ue[14]=Y,ue[15]=ae,ue},a.eB=D,a.eC=Ug,a.eD=hp,a.eE=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new hr(1/0,1/0),max:new hr(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,i=!1){const s=i4(new hr(0,0),new hr(Lr,Lr),c),f=[];if(i&&!FE(s,this._globalClipBounds))return f;for(const A of this._activeRegions){if(A.hiddenByOverlap||!FE(s,A))continue;const g=bG(A.min,A.max,c);f.push({min:g.min,max:g.max,sourceId:this._sourceIds[A.priority],footprint:A.footprint,footprintTileId:A.tileId,order:A.order,clipMask:A.clipMask,clipScope:A.clipScope})}return f}setSources(c){this._setSources(c.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const s=[];for(const f of i.cache.getVisibleCoordinates()){const A=i.cache.getTile(f).buckets[i.layer];A&&A.updateFootprints(f.toUnwrapped(),s)}return s},getOrder:()=>i.order,getClipMask:()=>i.clipMask,getClipScope:()=>i.clipScope})))}_addSource(c){const i=c.getFootprints();if(i.length===0)return;const s=c.getOrder(),f=c.getClipMask(),A=c.getClipScope();for(const g of i){if(!g.footprint)continue;const _=i4(g.footprint.min,g.footprint.max,g.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:g.id,footprint:g.footprint,order:s,clipMask:f,clipScope:A})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((i,s)=>i.priority-s.priority||ax(i.min,s.min)||ax(i.max,s.max)||i.order-s.order||i.clipMask-s.clipMask||function(f,A){const g=(_,C)=>_+C;return f.length-A.length||f.reduce(g,"").localeCompare(A.reduce(g,""))}(i.clipScope,s.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let i=0;for(;!c&&i!==this._activeRegions.length;){const s=this._activeRegions[i],f=this._prevRegions[i];c=s.priority!==f.priority||!n4(s,f)||s.order!==f.order||s.clipMask!==f.clipMask||!Bo(s.clipScope,f.clipScope),++i}}if(c){++this._updateTime;for(const s of this._activeRegions)s.order!==Nv&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const i=s=>{const f=this._activeRegions;if(s>=f.length)return s;const A=f[s].priority;for(;s<f.length&&f[s].priority===A;)++s;return s};if(this._sourceIds.length>1){let s=0,f=i(s);for(;s!==f;){let A=s;const g=s;for(;A!==f;){const _=this._activeRegions[A];_.hiddenByOverlap=!1;for(let C=0;C<g;C++){const T=this._activeRegions[C];if(!T.hiddenByOverlap&&_.order===Nv&&FE(_,T)&&(_.hiddenByOverlap=a4(_.footprint,_.tileId,T.footprint,T.tileId),_.hiddenByOverlap))break}++A}s=f,f=i(s)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=c.length-1;i>=0;i--)this._addSource(c[i]);this._computeReplacement()}},a.eF=Nv,a.eG=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,i){const s=new Dc,f=new Ua,A=[],g=c+1+2,_=i[0]+1,C=i[0]+1+(1+i.length),T=(P,k,N)=>{let j=P===g-1?P-2:P===0?P:P-1;return j+=N?24575:0,[j,k]};for(let P=0;P<g;++P)s.emplaceBack(...T(P,0,!0));for(let P=0;P<_;++P)for(let k=0;k<g;++k)s.emplaceBack(...T(k,P,(k===0||k===g-1)&&!0));for(let P=0;P<i.length;++P){const k=i[P];for(let N=0;N<g;++N)s.emplaceBack(...T(N,k,!0))}for(let P=0;P<i.length;++P){const k=f.length,N=i[P]+1+2,j=new Ua;for(let ae=0;ae<N-1;ae++){const ue=ae===N-2,ge=ue?g*(C-i.length+P-ae):g;for(let Pe=0;Pe<g-1;Pe++){const Te=ae*g+Pe;ae===0||ue||Pe===0||Pe===g-2?(j.emplaceBack(Te+1,Te,Te+ge),j.emplaceBack(Te+ge,Te+ge+1,Te+1)):(f.emplaceBack(Te+1,Te,Te+ge),f.emplaceBack(Te+ge,Te+ge+1,Te+1))}}const X=no.simpleSegment(0,k,s.length,f.length-k);for(let ae=0;ae<j.uint16.length;ae+=3)f.emplaceBack(j.uint16[ae],j.uint16[ae+1],j.uint16[ae+2]);const Y=no.simpleSegment(0,k,s.length,f.length-k);A.push({withoutSkirts:X,withSkirts:Y})}return{vertices:s,indices:f,segments:A}}_createGrid(c){const i=this._fillGridMeshWithLods(h,m);this._gridSegments=i.segments,this._gridBuffer=c.createVertexBuffer(i.vertices,J1.members),this._gridIndexBuffer=c.createIndexBuffer(i.indices,!0)}_createPoles(c){const i=new Ua;for(let _=0;_<=h;_++)i.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=c.createIndexBuffer(i,!0);const s=new zA,f=new zA,A=new zA,g=new zA;this._poleSegments=[];for(let _=0,C=0;_<Kg;_++){const T=360/(1<<_);s.emplaceBack(0,-Vl,0,.5,0),f.emplaceBack(0,-Vl,0,.5,1),A.emplaceBack(0,-Vl,0,.5,.5),g.emplaceBack(0,-Vl,0,.5,.5);for(let P=0;P<=h;P++){let k=P/h,N=0;const j=tr(0,T,k),[X,Y,ae]=S($i,Xi,j,Vl);s.emplaceBack(X,Y,ae,k,N),f.emplaceBack(X,Y,ae,k,1-N);const ue=_n(j);k=.5+.5*Math.sin(ue),N=.5+.5*Math.cos(ue),A.emplaceBack(X,Y,ae,k,N),g.emplaceBack(X,Y,ae,k,1-N)}this._poleSegments.push(no.simpleSegment(C,0,66,64)),C+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(s,Y0,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(f,Y0,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(A,Y0,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(g,Y0,!1)}getGridBuffers(c,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},a.eH=t4,a.eI=Ve,a.eJ=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.eK=rt,a.eL=Xe,a.eM=function(c,i,s){return c[0]=i[0]/s[0],c[1]=i[1]/s[1],c[2]=i[2]/s[2],c},a.eN=En,a.eO=F,a.eP=Fe,a.eQ=Et,a.eR=function([c,i,s]){const f=Math.hypot(c,i,s),A=Math.atan2(c,s),g=.5*Math.PI-Math.acos(-i/f);return new V(Tt(A),Tt(g))},a.eS=Pn,a.eT=GE,a.eU=function(c){const i=c.navigator?c.navigator.userAgent:null;return!!function(s){if(Ii==null){const f=s.navigator?s.navigator.userAgent:null;Ii=!!s.safari||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||f.match("Safari")&&!f.match("Chrome")))}return Ii}(c)&&!(!i||!(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},a.eV=function(c,i){Nl=c,ma=i},a.eW=Bn,a.eX=Sr,a.eY=function(c){const i=[0,0,0],s=R(new Float64Array(16));return q(s,c.pixelMatrix,c.globeMatrix),Ct(i,i,s),new hr(i[0],i[1])},a.eZ=function(){const c=Gv;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(kE),Gv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.e_=function(){ux().acquire(kE)},a.ea=function(c,i){if(c===i){var s=i[1],f=i[2],A=i[3],g=i[6],_=i[7],C=i[11];c[1]=i[4],c[2]=i[8],c[3]=i[12],c[4]=s,c[6]=i[9],c[7]=i[13],c[8]=f,c[9]=g,c[11]=i[14],c[12]=A,c[13]=_,c[14]=C}else c[0]=i[0],c[1]=i[4],c[2]=i[8],c[3]=i[12],c[4]=i[1],c[5]=i[5],c[6]=i[9],c[7]=i[13],c[8]=i[2],c[9]=i[6],c[10]=i[10],c[11]=i[14],c[12]=i[3],c[13]=i[7],c[14]=i[11],c[15]=i[15];return c},a.eb=AW,a.ec=Di,a.ed=zm,a.ee=256,a.ef=fi,a.eg=Rc,a.eh=ye,a.ei=function(c,i){return c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[4],c[4]=i[5],c[5]=i[6],c[6]=i[8],c[7]=i[9],c[8]=i[10],c},a.ej=zA,a.ek=Um,a.el=rr,a.em=function(c,i,s,f,A){return je((c-i)/(s-i)*(A-f)+f,f,A)},a.en=Ti,a.eo=function(c,i){var s=i[0],f=i[1],A=i[2],g=i[3],_=i[4],C=i[5],T=i[6],P=i[7],k=i[8],N=k*_-C*P,j=-k*g+C*T,X=P*g-_*T,Y=s*N+f*j+A*X;return Y?(c[0]=N*(Y=1/Y),c[1]=(-k*f+A*P)*Y,c[2]=(C*f-A*_)*Y,c[3]=j*Y,c[4]=(k*s-A*T)*Y,c[5]=(-C*s+A*g)*Y,c[6]=X*Y,c[7]=(-P*s+f*T)*Y,c[8]=(_*s-f*g)*Y,c):null},a.ep=2,a.eq=Re,a.er=KE,a.es=[1,1,1],a.et=class{constructor(c,i,s,f){this.context=c,this.format=f,this.size=s,this.texture=c.gl.createTexture();const[A,g,_]=this.size,{gl:C}=c;C.bindTexture(C.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),C.texImage3D(C.TEXTURE_3D,0,this.format,A,g,_,0,jE(this.format),HE(this.format),i.data)}bind(c,i){const{context:s}=this,{gl:f}=s;f.bindTexture(f.TEXTURE_3D,this.texture),c!==this.minFilter&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MAG_FILTER,c),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MIN_FILTER,c),this.minFilter=c),i!==this.wrapS&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_S,i),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_T,i),this.wrapS=i)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},a.eu=h_,a.ev=zn,a.ew=function(c,i,s,f){var A=i[0],g=i[1],_=i[2],C=i[3];return c[0]=A+f*(s[0]-A),c[1]=g+f*(s[1]-g),c[2]=_+f*(s[2]-_),c[3]=C+f*(s[3]-C),c},a.ex=a_,a.ey=Zh,a.ez=tl,a.f=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(i,s)=>String.fromCharCode(+("0x"+s))))},a.f0=function(c,i,s=!1){if($o===xs.deferred||$o===xs.loading||$o===xs.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Wh=bc.resolveURL(c),$o=xs.deferred,Ef=i,Fo(),s||np()},a.f1=function(c){r_=bc.resolveURL(c),n_||(n_=new t_(ux(),new yu)),n_.broadcast("setMeshoptUrl",r_)},a.f2=P4,a.f3=function(c){NE=bc.resolveURL(c),n_||(n_=new t_(ux(),new yu)),n_.broadcast("setDracoUrl",NE)},a.f4=F4,a.f5=Vv,a.f6=function(c){const i=Ah();if(!i)return;const s=i.delete(cl);c&&s.then(()=>c()).catch(c)},a.f7=Zg,a.f8=Mr,a.f9=Ym,a.fa=Cd,a.fb=eM,a.fc=tM,a.fd=J4,a.fe=Wr,a.ff="hd_road_elevation",a.fg=io,a.fh=Rt,a.fi=$g,a.fj=aB,a.fk=e0,a.fl=function(c,i,s,f,A,g,_,C=1,T,P,k){c.createArrays(),c.tilePixelRatio=Lr/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const N=c.layers[0].layout,j=c.layers[0]._unevaluatedLayout._values,X={};X.scaleFactor=C,X.textSizeScaleRange=N.get("text-size-scale-range"),X.iconSizeScaleRange=N.get("icon-size-scale-range");const[Y,ae]=X.textSizeScaleRange,[ue,ge]=X.iconSizeScaleRange;X.textScaleFactor=je(X.scaleFactor,Y,ae),X.iconScaleFactor=je(X.scaleFactor,ue,ge);const Pe=j["text-size"],Te=j["icon-size"];if(c.textSizeData.kind==="composite"){const{minZoom:wt,maxZoom:Yt}=c.textSizeData;X.compositeTextSizes=[Pe.possiblyEvaluate(new oa(wt,{worldview:k}),g),Pe.possiblyEvaluate(new oa(Yt,{worldview:k}),g)]}if(c.iconSizeData.kind==="composite"){const{minZoom:wt,maxZoom:Yt}=c.iconSizeData;X.compositeIconSizes=[Te.possiblyEvaluate(new oa(wt,{worldview:k}),g),Te.possiblyEvaluate(new oa(Yt,{worldview:k}),g)]}X.layoutTextSize=Pe.possiblyEvaluate(new oa(_+1,{worldview:k}),g),X.layoutIconSize=Te.possiblyEvaluate(new oa(_+1,{worldview:k}),g),X.textMaxSize=Pe.possiblyEvaluate(new oa(18,{worldview:k}),g);const Ue=N.get("symbol-placement"),At=N.get("text-rotation-alignment")==="map"&&Ue!=="point",at=N.get("text-size");let ot=!1;const _t=[];for(const wt of c.features){const Yt=N.get("text-font").evaluate(wt,{},g).join(","),Ft=at.evaluate(wt,{},g)*X.textScaleFactor,ir=X.layoutTextSize.evaluate(wt,{},g)*X.textScaleFactor,Ir=X.layoutIconSize.evaluate(wt,{},g)*X.iconScaleFactor,cr={horizontal:{},vertical:void 0},xr=wt.text;let Tr,$t=[0,0];if(xr){const nn=xr.toString(),Cn=N.get("text-letter-spacing").evaluate(wt,{},g)*Wl,kn=N.get("text-line-height").evaluate(wt,{},g)*Wl,li=jl(nn)?Cn:0,$n=N.get("text-anchor").evaluate(wt,{},g),zi=N.get("text-variable-anchor");if(!zi){const Kt=N.get("text-radial-offset").evaluate(wt,{},g);if(Kt)$t=UP($n,[Kt*Wl,sB]);else{const Pr=N.get("text-offset").evaluate(wt,{},g);$t=[Pr[0]*Wl,Pr[1]*Wl]}}let xi=At?"center":N.get("text-justify").evaluate(wt,{},g);const $a=Ue==="point",Ge=$a?N.get("text-max-width").evaluate(wt,{},g)*Wl:1/0,Ke=Kt=>{c.allowVerticalPlacement&&us(nn)&&(cr.vertical=rB(xr,i,s,A,Yt,Ge,kn,$n,Kt,li,$t,nf.vertical,!0,ir,Ft,T))};if(!At&&zi){const Kt=xi==="auto"?zi.map(Vr=>lB(Vr)):[xi];let Pr=!1;for(let Vr=0;Vr<Kt.length;Vr++){const jr=Kt[Vr];if(!cr.horizontal[jr])if(Pr)cr.horizontal[jr]=cr.horizontal[0];else{const un=rB(xr,i,s,A,Yt,Ge,kn,"center",jr,li,$t,nf.horizontal,!1,ir,Ft,T);un&&(cr.horizontal[jr]=un,Pr=un.positionedLines.length===1)}}Ke("left")}else{if(xi==="auto"&&(xi=lB($n)),$a||N.get("text-writing-mode").indexOf("horizontal")>=0||!us(nn)){const Kt=rB(xr,i,s,A,Yt,Ge,kn,$n,xi,li,$t,nf.horizontal,!1,ir,Ft,T);Kt&&(cr.horizontal[xi]=Kt)}Ke($a?"left":xi)}}let wr,Mt,Xt,Fr,Er,mn,on=!1;const vr=N.get("icon-text-fit").evaluate(wt,{},g);if(wt.icon&&wt.icon.hasPrimary()){const nn=zP(wt.icon,c.iconSizeData,j["icon-size"],g,c.zoom,wt,T,X.iconScaleFactor,k);wr=nn.iconPrimary,Xt=nn.iconSecondary;const Cn=wr.toString();if(Mt=f.get(Cn),Mt&&(Er=N.get("icon-offset").evaluate(wt,{},g),mn=N.get("icon-anchor").evaluate(wt,{},g),Tr=HK(A.get(Cn),Xt?A.get(Xt.toString()):void 0,Er,mn),on=Mt.sdf,c.sdfIcons===void 0?c.sdfIcons=Mt.sdf:c.sdfIcons!==Mt.sdf&&Hr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Mt.pixelRatio!==c.pixelRatio||N.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0)),Xt){const kn=Xt.toString();Fr=f.get(kn)}}ot=ot||!(!wt.icon||!wt.icon.hasSecondary());const Cr=cB(cr.horizontal)||cr.vertical;c.iconsInText||(c.iconsInText=!!Cr&&Cr.iconsInText);const fn=ir*X.textScaleFactor/Wl,{defaultShapedIcon:tn,verticallyShapedIcon:Dr}=JK(c,Tr,N,wt,g,cr,fn,Er,vr);vr!=="none"&&Tr&&(wP(Tr)||bP(Tr))&&(wx(0,Mt,wr,Tr,tn,vr,P,f,A),wx(0,Fr,Xt,Tr,tn,vr,P,f,A),Dr&&(wx(0,Mt,wr,Tr,Dr,vr,P,f,A),wx(0,Fr,Xt,Tr,Dr,vr,P,f,A))),Tr=tn,_t.push({feature:wt,shapedTextOrientations:cr,shapedText:Cr,shapedIcon:Tr,iconPrimary:wr,iconSecondary:Xt,iconOffset:Er,iconAnchor:mn,verticallyShapedIcon:Dr,layoutTextSize:ir,layoutIconSize:Ir,textOffset:$t,isSDFIcon:on,iconTextFit:vr})}return{featureData:_t,sizes:X,hasAnySecondaryIcon:ot,textAlongLine:At,symbolPlacement:Ue}},a.fm=LP,a.fn=function(c,i,s,f,A,g,_,C,T,P){const{featureData:k,hasAnySecondaryIcon:N,sizes:j,textAlongLine:X,symbolPlacement:Y}=i;for(const ae of k){const{shapedIcon:ue,verticallyShapedIcon:ge,feature:Pe,shapedTextOrientations:Te,shapedText:Ue,layoutTextSize:At,textOffset:at,isSDFIcon:ot,iconPrimary:_t,iconSecondary:wt,iconTextFit:Yt,iconOffset:Ft}=ae;QP(ue,P.iconPositions,_t,wt),QP(ge,P.iconPositions,_t,wt),YK(Te,P.iconPositions),ZK(_t,wt,P.iconPositions),(Ue||ue)&&eW(c,Pe,Te,ue,ge,T,j,At,0,at,ot,f,A,_,C,N,Yt,Ft,X,Y)}s&&c.generateCollisionDebugBuffers(g,c.collisionBoxArray,j.textScaleFactor)},a.fo=ln,a.fp=jx,a.fq=Ot,a.fr=function(c){let i=0;if(new Uint32Array(c,0,1)[0]!==M4){const s=new Uint32Array(c,0,7),[,,f,A,g,_]=s;i=s.byteLength+A+g+_+g,(f!==c.byteLength||i>=c.byteLength)&&Hr("Invalid b3dm header information.")}return k4(c,i)},a.fs=function(c,i){const s=G4(c);for(const f of s){for(const A of f.meshes)eK(A);f.lights&&(f.lightMeshIndex=f.meshes.length,f.meshes.push(tK(f.lights,i)))}return s},a.ft=Rx,a.fu=Kn,a.fv=T4,a.fw=au,a.fx=xs,a.fy=function(c){zh(),ec?.then(i=>{i.keys().then(s=>{for(let f=0;f<s.length-c;f++)i.delete(s[f]).catch(A=>Hr(A.message))}).catch(s=>Hr(s.message))}).catch(i=>Hr(i.message))},a.g=function(c,i){return hl(xe(c,{method:"GET"}),i)},a.h=xe,a.i=function(c){return Ss.API_STYLE_REGEX.test(c)&&!Rf(c)},a.j=function(c){return c.indexOf("mapbox:")===0},a.k=Co,a.l=Vu,a.m=function(c){return decodeURIComponent(atob(c).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""))},a.n=function(c,i){return hl(xe(c,{type:"json"}),i)},a.o=tc,a.p=function(c,i){return hl(xe(c,{method:"POST"}),i)},a.q=bc,a.r=Uc,a.s=function(c){try{const i=self[c];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}},a.t=fh,a.u=function(){return function c(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},a.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},a.w=Hr,a.x=function(){return UE||(UE=new Zg),UE},a.y=EB,a.z=ts}),u(["./shared"],function(a){function v(Tt){const pe=Tt?Tt.url.toString():void 0;return pe?performance.getEntriesByName(pe):[]}function x(Tt){if(typeof Tt=="number"||typeof Tt=="boolean"||typeof Tt=="string"||Tt==null)return JSON.stringify(Tt);if(Array.isArray(Tt)){let be="[";for(const Ve of Tt)be+=`${x(Ve)},`;return`${be}]`}let pe="{";for(const be of Object.keys(Tt).sort())pe+=`${be}:${x(Tt[be])},`;return`${pe}}`}function b(Tt){let pe="";for(const be of a.bu)pe+=`/${x(Tt[be])}`;return pe}class I{constructor(pe){this.keyCache={},this._layers={},this._layerConfigs={},pe&&this.replace(pe)}replace(pe,be){this._layerConfigs={},this._layers={},this.update(pe,[],be)}update(pe,be,Ve){this._options=Ve;for(const je of pe)this._layerConfigs[je.id]=je,(this._layers[je.id]=a.dn(je,this.scope,null,this._options)).compileFilter(Ve),this.keyCache[je.id]&&delete this.keyCache[je.id];for(const je of be)delete this.keyCache[je],delete this._layerConfigs[je],delete this._layers[je];this.familiesBySource={};const rt=function(je,oe){const Ee={};for(let xe=0;xe<je.length;xe++){const Ne=je[xe];let Oe=oe&&oe[Ne.id];Oe||(Ne.type==="symbol"?Oe=Ne.id:(Oe=b(Ne),Ne.type==="line"&&Ne.paint&&function Ht(Rt){return typeof Rt=="string"&&Rt==="line-progress"||(Array.isArray(Rt)?Rt.some(Ht):!(!Rt||typeof Rt!="object")&&Object.values(Rt).some(Ht))}(Ne.paint["line-width"])&&(Oe+=`/${x(Ne.paint["line-width"])}`))),oe&&(oe[Ne.id]=Oe);let St=Ee[Oe];St||(St=Ee[Oe]=[]),St.push(Ne)}const me=[];for(const xe in Ee)me.push(Ee[xe]);return me}(Object.values(this._layerConfigs),this.keyCache);for(const je of rt){const oe=je.map(St=>this._layers[St.id]),Ee=oe[0];if(Ee.visibility==="none")continue;const me=Ee.source||"";let xe=this.familiesBySource[me];xe||(xe=this.familiesBySource[me]={});const Ne=Ee.sourceLayer||"_geojsonTileLayer";let Oe=xe[Ne];Oe||(Oe=xe[Ne]=[]),Oe.push(oe)}}}const M=1*a.fa;class L{constructor(pe){const be={},Ve=[];for(const Ee in pe){const me=pe[Ee],xe=be[Ee]={};for(const Ne in me.glyphs){const Oe=me.glyphs[+Ne];if(!Oe||Oe.bitmap.width===0||Oe.bitmap.height===0)continue;const St=Oe.metrics.localGlyph?M:1,Ht={x:0,y:0,w:Oe.bitmap.width+2*St,h:Oe.bitmap.height+2*St};Ve.push(Ht),xe[Ne]=Ht}}const{w:rt,h:je}=a.H(Ve),oe=new a.f9({width:rt||1,height:je||1});for(const Ee in pe){const me=pe[Ee];for(const xe in me.glyphs){const Ne=me.glyphs[+xe];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const Oe=be[Ee][xe],St=Ne.metrics.localGlyph?M:1;a.f9.copy(Ne.bitmap,oe,{x:0,y:0},{x:Oe.x+St,y:Oe.y+St},Ne.bitmap)}}this.image=oe,this.positions=be}}a.f8(L,"GlyphAtlas");class U{constructor(pe){this.tileID=new a.aM(pe.tileID.overscaledZ,pe.tileID.wrap,pe.tileID.canonical.z,pe.tileID.canonical.x,pe.tileID.canonical.y),this.tileZoom=pe.tileZoom,this.uid=pe.uid,this.zoom=pe.zoom,this.lut=pe.lut,this.canonical=pe.tileID.canonical,this.pixelRatio=pe.pixelRatio,this.tileSize=pe.tileSize,this.source=pe.source,this.scope=pe.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=pe.showCollisionBoxes,this.collectResourceTiming=!!pe.request&&pe.request.collectResourceTiming,this.promoteId=pe.promoteId,this.isSymbolTile=pe.isSymbolTile,this.tileTransform=a.aW(pe.tileID.canonical,pe.projection),this.projection=pe.projection,this.worldview=pe.worldview,this.localizableLayerIds=pe.localizableLayerIds,this.brightness=pe.brightness,this.extraShadowCaster=!!pe.extraShadowCaster,this.tessellationStep=pe.tessellationStep,this.scaleFactor=pe.scaleFactor,this.worldview=pe.worldview}parse(pe,be,Ve,rt,je,oe){this.status="parsing",this.data=pe,this.collisionBoxArray=new a.b0;const Ee=new a.fb(Object.keys(pe.layers).sort()),me=new a.fc(this.tileID,this.promoteId);me.bucketLayerIDs=[];const xe={},Ne=new a.fd(256,256),Oe={featureIndex:me,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Ne,availableImages:Ve,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},St=[],Ht=be.familiesBySource[this.source];for(const Vt in Ht){const Gt=pe.layers[Vt];if(!Gt)continue;let br=!1,qr=!1,Hr=!1;for(const Kn of Ht[Vt])Kn[0].type==="symbol"?br=!0:qr=!0,Kn[0].is3D()&&Kn[0].type!=="model"&&(Hr=!0);if(this.extraShadowCaster&&!Hr||this.isSymbolTile===!0&&!br||this.isSymbolTile===!1&&!qr)continue;Gt.version===1&&a.w(`Vector tile source "${this.source}" layer "${Vt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Jr=Ee.encode(Vt),en=[];let Vn=!1;for(let Kn=0,Sn=0;Kn<Gt.length;Kn++){const Ii=Gt.feature(Kn),ha=me.getId(Ii,Vt);if(this.localizableLayerIds&&this.localizableLayerIds.has(Vt)){const sa=Ii.properties?Ii.properties.worldview:null;if(this.worldview&&typeof sa=="string")if(sa==="all")Ii.properties.$localized=!0;else{if(!sa.split(",").includes(this.worldview))continue;Ii.properties.$localized=!0,Ii.properties.worldview=this.worldview}}!Vn&&Ii.properties&&Ii.properties.hasOwnProperty(a.fe)&&(Vn=!0),en.push({feature:Ii,id:ha,index:Sn,sourceLayerIndex:Jr}),Sn++}Vn&&!Oe.elevationFeatures&&pe.layers.hasOwnProperty(a.ff)&&(Oe.elevationFeatures=a.fg.parseFrom(pe.layers[a.ff],this.canonical));for(const Kn of Ht[Vt]){const Sn=Kn[0];if(this.extraShadowCaster&&(!Sn.is3D()||Sn.type==="model")||this.isSymbolTile!==void 0&&Sn.type==="symbol"!==this.isSymbolTile||Sn.minzoom&&this.zoom<Math.floor(Sn.minzoom)||Sn.maxzoom&&this.zoom>=Sn.maxzoom||Sn.visibility==="none")continue;R(Kn,this.zoom,Oe.brightness,Ve,this.worldview);const Ii=xe[Sn.id]=Sn.createBucket({index:me.bucketLayerIDs.length,layers:Kn,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Jr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:rt,worldview:this.worldview});me.bucketLayerIDs.push(Kn.map(sa=>a.C(sa.id,sa.scope)));let ha=Ii.prepare?Ii.prepare():null;ha!=null?(ha=ha.then(()=>Ii.populate(en,Oe,this.tileID.canonical,this.tileTransform)),St.push(ha)):Ii.populate(en,Oe,this.tileID.canonical,this.tileTransform)}}const Rt=()=>{let Vt,Gt,br,qr,Hr,Jr;Ne.trim();const en={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Vn=()=>{if(Vt)return this.status="done",oe(Vt);if(this.extraShadowCaster)this.status="done",oe(null,{buckets:Object.values(xe).filter(Sn=>!Sn.isEmpty()),featureIndex:me,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Oe.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Gt&&br&&qr){const Sn=new L(Gt),Ii=new Map;for(const[Ya,Ra]of br.entries()){const{imagePosition:es}=a.fj(Ya,Ra,a.fk);Ii.set(Ya,es)}const ha={};for(const Ya in xe){const Ra=xe[Ya];Ra instanceof a.b1&&(R(Ra.layers,this.zoom,Oe.brightness,Ve,this.worldview),ha[Ya]=a.fl(Ra,Gt,Sn.positions,br,Ii,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,Hr,this.worldview))}const sa={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(je,br,Hr,()=>{sa.iconsPending=!1,Kn(ha,Sn,sa)}),this.rasterizeIfNeeded(je,qr,Jr,()=>{sa.patternsPending=!1,Kn(ha,Sn,sa)})}},Kn=(Sn,Ii,ha,sa)=>{if(ha.iconsPending||ha.patternsPending)return;const Ya=new a.fm(br,qr,this.lut);for(const Ra in xe){const es=xe[Ra];if(Ra in Sn)a.fn(es,Sn[Ra],this.showCollisionBoxes,Ve,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,br,Ya);else if(es.hasPattern&&(es instanceof a.b7||es instanceof a.b8||es instanceof a.e4)){R(es.layers,this.zoom,Oe.brightness,Ve,this.worldview);const so=Object.fromEntries(Ya.patternPositions);es.addFeatures(Oe,this.tileID.canonical,so,Ve,this.tileTransform,this.brightness)}}this.status="done",oe(null,{buckets:Object.values(xe).filter(Ra=>!Ra.isEmpty()),featureIndex:me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ii.image,lineAtlas:Ne,imageAtlas:Ya,brightness:Oe.brightness})};if(!this.extraShadowCaster){const Sn=a.fh(Oe.glyphDependencies,sa=>Object.keys(sa).map(Number));Object.keys(Sn).length?je.send("getGlyphs",{uid:this.uid,stacks:Sn},(sa,Ya)=>{Vt||(Vt=sa,Gt=Ya,Vn())},void 0,!1,en):Gt={};const Ii=Array.from(Oe.iconDependencies.keys()).map(sa=>a.I.parse(sa));Ii.length?je.send("getImages",{images:Ii,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(sa,Ya)=>{Vt||(Vt=sa,br=new Map,Hr=this.updateImageMapAndGetImageTaskQueue(br,Ya,Oe.iconDependencies),Vn())},void 0,!1,en):(br=new Map,Hr=new Map);const ha=Array.from(Oe.patternDependencies.keys()).map(sa=>a.I.parse(sa));ha.length?je.send("getImages",{images:ha,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(sa,Ya)=>{Vt||(Vt=sa,qr=new Map,Jr=this.updateImageMapAndGetImageTaskQueue(qr,Ya,Oe.patternDependencies),Vn())},void 0,!1,en):(qr=new Map,Jr=new Map)}if(Oe.elevationFeatures&&Oe.elevationFeatures.length>0){const Sn=[];for(const ha of Object.values(xe))if(ha instanceof a.b8){const sa=ha.getUnevaluatedPortalGraph();sa&&Sn.push(sa)}const Ii=a.fi.evaluate(Sn);for(const ha of Object.values(xe))if(ha instanceof a.b8){const sa=pe.layers[Ee.decode(ha.sourceLayerIndex)];ha.setEvaluatedPortalGraph(Ii,sa,this.tileID.canonical,Oe.availableImages,Oe.brightness)}}Vn()};St.length>0?Promise.allSettled(St).then(Rt).catch(oe):Rt()}rasterizeIfNeeded(pe,be,Ve,rt){Array.from(be.values()).some(je=>je.usvg)?this.rasterize(pe,be,Ve,rt):rt()}updateImageMapAndGetImageTaskQueue(pe,be,Ve){const rt=new Map;for(const je of be.keys()){const oe=Ve.get(je)||[];for(const Ee of oe){const me=Ee.toString(),xe=be.get(Ee.id.toString());xe.usvg?rt.has(me)||(rt.set(me,Ee),pe.set(me,Object.assign({},xe))):pe.set(me,xe)}}return rt}rasterize(pe,be,Ve,rt){this.rasterizeTask=pe.send("rasterizeImages",{scope:this.scope,tasks:Ve},(je,oe)=>{if(!je)for(const[Ee,me]of oe.entries()){const xe=Object.assign(be.get(Ee),{data:me});be.set(Ee,xe)}rt()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function R(Tt,pe,be,Ve,rt){const je=new a.aa(pe,{brightness:be,worldview:rt});for(const oe of Tt)oe.recalculate(je,Ve)}class H extends a.E{constructor(pe,be,Ve,rt,je,oe,Ee){super(),this.actor=pe,this.layerIndex=be,this.availableImages=Ve,this.availableModels=rt,this.loadVectorData=oe||a.aJ,this.loading={},this.loaded={},this.deduped=new a.aI(pe.scheduler),this.isSpriteLoaded=je,this.scheduler=pe.scheduler,this.brightness=Ee}loadTile(pe,be){const Ve=pe.uid,rt=pe&&pe.request,je=rt&&rt.collectResourceTiming,oe=this.loading[Ve]=new U(pe);oe.abort=this.loadVectorData(pe,(Ee,me)=>{const xe=!this.loading[Ve];if(delete this.loading[Ve],oe.cancelRasterize(),xe||Ee||!me)return oe.status="done",xe||(this.loaded[Ve]=oe),be(Ee);const Ne=me.rawData,Oe={};me.expires&&(Oe.expires=me.expires),me.cacheControl&&(Oe.cacheControl=me.cacheControl),oe.vectorTile=me.vectorTile||new a.fo(new a.bq(Ne));const St=()=>{oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(Ht,Rt)=>{if(Ht||!Rt)return be(Ht);const Vt={};if(je){const Gt=v(rt);Gt.length>0&&(Vt.resourceTiming=JSON.parse(JSON.stringify(Gt)))}be(null,a.h({rawTileData:Ne.slice(0)},Rt,Oe,Vt))})};this.isSpriteLoaded?St():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(St,{type:"parseTile",isSymbolTile:pe.isSymbolTile,zoom:pe.tileZoom}):St()}),this.loaded=this.loaded||{},this.loaded[Ve]=oe})}reloadTile(pe,be){const Ve=this.loaded,rt=pe.uid;if(Ve&&Ve[rt]){const je=Ve[rt];je.scaleFactor=pe.scaleFactor,je.showCollisionBoxes=pe.showCollisionBoxes,je.projection=pe.projection,je.brightness=pe.brightness,je.tileTransform=a.aW(pe.tileID.canonical,pe.projection),je.extraShadowCaster=pe.extraShadowCaster,je.lut=pe.lut,je.worldview=pe.worldview;const oe=(Ee,me)=>{const xe=je.reloadCallback;xe&&(delete je.reloadCallback,je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,xe)),be(Ee,me)};je.status==="parsing"?je.reloadCallback=oe:je.status==="done"&&(je.vectorTile?je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,oe):oe())}else be(null,void 0)}abortTile(pe,be){const Ve=pe.uid,rt=this.loading[Ve];rt&&(rt.abort&&rt.abort(),delete this.loading[Ve]),be()}removeTile(pe,be){const Ve=this.loaded,rt=pe.uid;Ve&&Ve[rt]&&delete Ve[rt],be()}}class q{loadTile(pe,be){const{uid:Ve,encoding:rt,rawImageData:je,padding:oe}=pe,Ee=ImageBitmap&&je instanceof ImageBitmap?this.getImageData(je,oe):je;be(null,new a.fp(Ve,Ee,rt,oe<1))}reloadTile(pe,be){be(null,null)}abortTile(pe,be){be()}removeTile(pe,be){be()}getImageData(pe,be){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(pe.width,pe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=pe.width,this.offscreenCanvas.height=pe.height,this.offscreenCanvasContext.drawImage(pe,0,0,pe.width,pe.height);const Ve=this.offscreenCanvasContext.getImageData(-be,-be,pe.width+2*be,pe.height+2*be);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ve}}a.bp.setPbf(a.bq);class te{constructor(pe){this._mrt=new a.bp(pe.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=pe.uid,this.tileID=pe.tileID,this.source=pe.source}parse(pe,be){const Ve=this._mrt;this.status="parsing",this._entireBuffer=pe;try{Ve.parseHeader(pe),this._isHeaderLoaded=!0;const rt=[];for(const je in Ve.layers){const oe=Ve.getLayer(je),Ee=oe.getDataRange(oe.getBandList()),me=Ve.createDecodingTask(Ee),xe=pe.slice(Ee.firstByte,Ee.lastByte+1),Ne=a.bp.performDecoding(xe,me).then(Oe=>me.complete(null,Oe)).catch(Oe=>me.complete(Oe,null));rt.push(Ne)}Promise.allSettled(rt).then(()=>be(null,Ve)).catch(je=>be(je))}catch(rt){be(rt)}}}class J{constructor(pe){this.actor=pe,this.loading={},this.loaded={}}loadTile(pe,be){const Ve=pe.uid,rt=pe.request,je=this.loading[Ve]=new te(pe),{cancel:oe}=a.br(rt,(Ee,me,xe,Ne)=>{const Oe=!this.loading[Ve];if(delete this.loading[Ve],Oe||Ee||!me)return je.status="done",Oe||(this.loaded[Ve]=je),be(Ee);je.parse(me,(St,Ht)=>{if(St||!Ht)return be(St);be(null,Ht,xe,Ne)}),this.loaded[Ve]=je});je.abort=oe}reloadTile(pe,be){be(null,void 0)}abortTile(pe,be){const Ve=pe.uid,rt=this.loading[Ve];rt&&(rt.abort&&rt.abort(),delete this.loading[Ve]),be()}removeTile(pe,be){const Ve=pe.uid;this.loaded[Ve]&&delete this.loaded[Ve],be()}decodeRasterArray(pe,be){a.bp.performDecoding(pe.buffer,pe.task).then(Ve=>be(null,Ve)).catch(Ve=>be(Ve))}}const se=a.fq.prototype.toGeoJSON;class ye{constructor(pe){this._feature=pe,this.extent=a.aj,this.type=pe.type,this.properties=pe.tags,"id"in pe&&!isNaN(pe.id)&&(this.id=parseInt(pe.id,10))}loadGeometry(){if(this._feature.type===1){const pe=[];for(const be of this._feature.geometry)pe.push([new a.P(be[0],be[1])]);return pe}{const pe=[];for(const be of this._feature.geometry){const Ve=[];for(const rt of be)Ve.push(new a.P(rt[0],rt[1]));pe.push(Ve)}return pe}}toGeoJSON(pe,be,Ve){return se.call(this,pe,be,Ve)}}class Se{constructor(pe,be){this.name=pe,this.extent=a.aj,this.length=be.length,this._jsonFeatures=be}feature(pe){return new ye(this._jsonFeatures[pe])}}class Be{constructor(pe){this.layers={},this.extent=a.aj;for(const be of Object.keys(pe))this.layers[be]=new Se(be,pe[be])}}const De=64/4096,we=128;class nt{constructor(){this.features=new Map}clear(){this.features.clear()}load(pe=[],be){for(const Ve of pe){const rt=Ve.id;if(rt==null)continue;let je=this.features.get(rt);je&&this.updateCache(je,be),Ve.geometry?(je=Ie(Ve),this.updateCache(je,be),this.features.set(rt,je)):this.features.delete(rt),this.updateCache(je,be)}}updateCache(pe,be){for(const{canonical:Ve,uid:rt}of Object.values(be)){const{z:je,x:oe,y:Ee}=Ve;_e(pe,Math.pow(2,je),oe,Ee)&&delete be[rt]}}getTile(pe,be,Ve){const rt=Math.pow(2,pe),je=[];for(const oe of this.features.values())_e(oe,rt,be,Ve)&&je.push(Ut(oe,rt,be,Ve));return{features:je}}getFeatures(){return[...this.features.values()]}}function _e({minX:Tt,minY:pe,maxX:be,maxY:Ve},rt,je,oe){return Tt<(je+1+De)/rt&&pe<(oe+1+De)/rt&&be>(je-De)/rt&&Ve>(oe-De)/rt}function Ie(Tt){const{id:pe,geometry:be,properties:Ve}=Tt;if(!be)return;if(be.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:rt,coordinates:je}=be,oe={id:pe,type:1,geometry:[],tags:Ve,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Ee=oe.geometry;if(rt==="Point")Ze(je,Ee,oe);else if(rt==="MultiPoint")for(const me of je)Ze(me,Ee,oe);else if(rt==="LineString")oe.type=2,st(je,Ee,oe);else if(rt==="MultiLineString")oe.type=2,Et(je,Ee,oe);else if(rt==="Polygon")oe.type=3,Et(je,Ee,oe,!0);else{if(rt!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");oe.type=3;for(const me of je)Et(me,Ee,oe,!0)}return oe}function Ze([Tt,pe],be,Ve){const rt=a.aD(Tt);let je=a.aH(pe);je=je<0?0:je>1?1:je,be.push(rt,je),Ve.minX=Math.min(Ve.minX,rt),Ve.minY=Math.min(Ve.minY,je),Ve.maxX=Math.max(Ve.maxX,rt),Ve.maxY=Math.max(Ve.maxY,je)}function st(Tt,pe,be,Ve=!1,rt=!1){const je=[];for(const oe of Tt)Ze(oe,je,be);pe.push(je),Ve&&function(oe,Ee){let me=0;for(let xe=0,Ne=oe.length,Oe=Ne-2;xe<Ne;Oe=xe,xe+=2)me+=(oe[xe]-oe[Oe])*(oe[xe+1]+oe[Oe+1]);if(me>0===Ee)for(let xe=0,Ne=oe.length;xe<Ne/2;xe+=2){const Oe=oe[xe],St=oe[xe+1];oe[xe]=oe[Ne-2-xe],oe[xe+1]=oe[Ne-1-xe],oe[Ne-2-xe]=Oe,oe[Ne-1-xe]=St}}(je,rt)}function Et(Tt,pe,be,Ve=!1){for(let rt=0;rt<Tt.length;rt++)st(Tt[rt],pe,be,Ve,rt===0)}function Ut(Tt,pe,be,Ve){const{id:rt,type:je,geometry:oe,tags:Ee}=Tt,me=[];if(je===1)(function(xe,Ne,Oe,St,Ht){for(let Rt=0;Rt<xe.length;Rt+=2){const Vt=Math.round(a.aj*(xe[Rt+0]*Ne-Oe)),Gt=Math.round(a.aj*(xe[Rt+1]*Ne-St));Ht.push([Vt,Gt])}})(oe,pe,be,Ve,me);else for(const xe of oe)jt(xe,pe,be,Ve,me);return{id:rt,type:je,geometry:me,tags:Ee}}function jt(Tt,pe,be,Ve,rt){const je=-we,oe=a.aj+we;let Ee;for(let me=0;me<Tt.length-2;me+=2){let xe=Math.round(a.aj*(Tt[me+0]*pe-be)),Ne=Math.round(a.aj*(Tt[me+1]*pe-Ve)),Oe=Math.round(a.aj*(Tt[me+2]*pe-be)),St=Math.round(a.aj*(Tt[me+3]*pe-Ve));const Ht=Oe-xe,Rt=St-Ne;xe<je&&Oe<je||(xe<je?(Ne+=Math.round(Rt*((je-xe)/Ht)),xe=je):Oe<je&&(St=Ne+Math.round(Rt*((je-xe)/Ht)),Oe=je),Ne<je&&St<je||(Ne<je?(xe+=Math.round(Ht*((je-Ne)/Rt)),Ne=je):St<je&&(Oe=xe+Math.round(Ht*((je-Ne)/Rt)),St=je),xe>=oe&&Oe>=oe||(xe>=oe?(Ne+=Math.round(Rt*((oe-xe)/Ht)),xe=oe):Oe>=oe&&(St=Ne+Math.round(Rt*((oe-xe)/Ht)),Oe=oe),Ne>=oe&&St>=oe||(Ne>=oe?(xe+=Math.round(Ht*((oe-Ne)/Rt)),Ne=oe):St>=oe&&(Oe=xe+Math.round(Ht*((oe-Ne)/Rt)),St=oe),Ee&&xe===Ee[Ee.length-1][0]&&Ne===Ee[Ee.length-1][1]||(Ee=[[xe,Ne]],rt.push(Ee)),Ee.push([Oe,St])))))}}function bt({name:Tt,features:pe},be){be.writeStringField(1,Tt),be.writeVarintField(5,a.aj);const Ve=new Map,rt=new Map,je={keys:Ve,values:rt,feature:null};for(const oe of pe)je.feature=oe,be.writeMessage(2,Nt,je);for(const oe of Ve.keys())be.writeStringField(3,oe);for(const oe of rt.keys())be.writeMessage(4,Fe,oe)}function Nt(Tt,pe){const be=Tt.feature;be.id===void 0||isNaN(+be.id)||pe.writeVarintField(1,+be.id),be.tags&&pe.writeMessage(2,ar,Tt),pe.writeVarintField(3,be.type),pe.writeMessage(4,Le,be)}function ar({keys:Tt,values:pe,feature:be},Ve){for(const rt of Object.keys(be.tags)){let je=be.tags[rt];if(je===null)continue;let oe=Tt.get(rt);oe===void 0&&(oe=Tt.size,Tt.set(rt,oe)),Ve.writeVarint(oe);const Ee=typeof je;Ee!=="string"&&Ee!=="boolean"&&Ee!=="number"&&(je=JSON.stringify(je));let me=pe.get(je);me===void 0&&(me=pe.size,pe.set(je,me)),Ve.writeVarint(me)}}function lt(Tt,pe){return(pe<<3)+(7&Tt)}function ie(Tt){return Tt<<1^Tt>>31}function Le(Tt,pe){const{geometry:be,type:Ve}=Tt;let rt=0,je=0;if(Ve===1){pe.writeVarint(lt(1,be.length));for(const oe of be){const Ee=oe[0]-rt,me=oe[1]-je;pe.writeVarint(ie(Ee)),pe.writeVarint(ie(me)),rt+=Ee,je+=me}}else for(const oe of be){pe.writeVarint(lt(1,1));const Ee=oe.length-(Ve===3?1:0);for(let me=0;me<Ee;me++){me===1&&pe.writeVarint(lt(2,Ee-1));const xe=oe[me][0]-rt,Ne=oe[me][1]-je;pe.writeVarint(ie(xe)),pe.writeVarint(ie(Ne)),rt+=xe,je+=Ne}Ve===3&&pe.writeVarint(lt(7,1))}}function Fe(Tt,pe){const be=typeof Tt;be==="string"?pe.writeStringField(1,Tt):be==="boolean"?pe.writeBooleanField(7,Tt):be==="number"&&(Tt%1!=0?pe.writeDoubleField(3,Tt):Tt<0?pe.writeSVarintField(6,Tt):pe.writeVarintField(5,Tt))}const Re={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Tt=>Tt},et=Math.fround||(xt=new Float32Array(1),Tt=>(xt[0]=+Tt,xt[0]));var xt;const Dt=3,pt=5,Ct=6;class mr{constructor(pe){this.options=Object.assign(Object.create(Re),pe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(pe){const{log:be,minZoom:Ve,maxZoom:rt}=this.options;be&&console.time("total time");const je=`prepare ${pe.length} points`;be&&console.time(je),this.points=pe;const oe=[];for(let me=0;me<pe.length;me++){const xe=pe[me];if(!xe.geometry)continue;const[Ne,Oe]=xe.geometry.coordinates,St=et(er(Ne)),Ht=et(mt(Oe));oe.push(St,Ht,1/0,me,-1,1),this.options.reduce&&oe.push(0)}let Ee=this.trees[rt+1]=this._createTree(oe);be&&console.timeEnd(je);for(let me=rt;me>=Ve;me--){const xe=+Date.now();Ee=this.trees[me]=this._createTree(this._cluster(Ee,me)),be&&console.log("z%d: %d clusters in %dms",me,Ee.numItems,+Date.now()-xe)}return be&&console.timeEnd("total time"),this}getClusters(pe,be){let Ve=((pe[0]+180)%360+360)%360-180;const rt=Math.max(-90,Math.min(90,pe[1]));let je=pe[2]===180?180:((pe[2]+180)%360+360)%360-180;const oe=Math.max(-90,Math.min(90,pe[3]));if(pe[2]-pe[0]>=360)Ve=-180,je=180;else if(Ve>je){const Oe=this.getClusters([Ve,rt,180,oe],be),St=this.getClusters([-180,rt,je,oe],be);return Oe.concat(St)}const Ee=this.trees[this._limitZoom(be)],me=Ee.range(er(Ve),mt(oe),er(je),mt(rt)),xe=Ee.data,Ne=[];for(const Oe of me){const St=this.stride*Oe;Ne.push(xe[St+pt]>1?Zt(xe,St,this.clusterProps):this.points[xe[St+Dt]])}return Ne}getChildren(pe){const be=this._getOriginId(pe),Ve=this._getOriginZoom(pe),rt="No cluster with the specified id.",je=this.trees[Ve];if(!je)throw new Error(rt);const oe=je.data;if(be*this.stride>=oe.length)throw new Error(rt);const Ee=this.options.radius/(this.options.extent*Math.pow(2,Ve-1)),me=je.within(oe[be*this.stride],oe[be*this.stride+1],Ee),xe=[];for(const Ne of me){const Oe=Ne*this.stride;oe[Oe+4]===pe&&xe.push(oe[Oe+pt]>1?Zt(oe,Oe,this.clusterProps):this.points[oe[Oe+Dt]])}if(xe.length===0)throw new Error(rt);return xe}getLeaves(pe,be,Ve){const rt=[];return this._appendLeaves(rt,pe,be=be||10,Ve=Ve||0,0),rt}getTile(pe,be,Ve){const rt=this.trees[this._limitZoom(pe)],je=Math.pow(2,pe),{extent:oe,radius:Ee}=this.options,me=Ee/oe,xe=(Ve-me)/je,Ne=(Ve+1+me)/je,Oe={features:[]};return this._addTileFeatures(rt.range((be-me)/je,xe,(be+1+me)/je,Ne),rt.data,be,Ve,je,Oe),be===0&&this._addTileFeatures(rt.range(1-me/je,xe,1,Ne),rt.data,je,Ve,je,Oe),be===je-1&&this._addTileFeatures(rt.range(0,xe,me/je,Ne),rt.data,-1,Ve,je,Oe),Oe.features.length?Oe:null}getClusterExpansionZoom(pe){let be=this._getOriginZoom(pe)-1;for(;be<=this.options.maxZoom;){const Ve=this.getChildren(pe);if(be++,Ve.length!==1)break;pe=Ve[0].properties.cluster_id}return be}_appendLeaves(pe,be,Ve,rt,je){const oe=this.getChildren(be);for(const Ee of oe){const me=Ee.properties;if(me&&me.cluster?je+me.point_count<=rt?je+=me.point_count:je=this._appendLeaves(pe,me.cluster_id,Ve,rt,je):je<rt?je++:pe.push(Ee),pe.length===Ve)break}return je}_createTree(pe){const be=new a.c0(pe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ve=0;Ve<pe.length;Ve+=this.stride)be.add(pe[Ve],pe[Ve+1]);return be.finish(),be.data=pe,be}_addTileFeatures(pe,be,Ve,rt,je,oe){for(const Ee of pe){const me=Ee*this.stride,xe=be[me+pt]>1;let Ne,Oe,St;if(xe)Ne=sn(be,me,this.clusterProps),Oe=be[me],St=be[me+1];else{const Vt=this.points[be[me+Dt]];Ne=Vt.properties;const[Gt,br]=Vt.geometry.coordinates;Oe=er(Gt),St=mt(br)}const Ht={type:1,geometry:[[Math.round(this.options.extent*(Oe*je-Ve)),Math.round(this.options.extent*(St*je-rt))]],tags:Ne};let Rt;Rt=xe||this.options.generateId?be[me+Dt]:this.points[be[me+Dt]].id,Rt!==void 0&&(Ht.id=Rt),oe.features.push(Ht)}}_limitZoom(pe){return Math.max(this.options.minZoom,Math.min(Math.floor(+pe),this.options.maxZoom+1))}_cluster(pe,be){const{radius:Ve,extent:rt,reduce:je,minPoints:oe}=this.options,Ee=Ve/(rt*Math.pow(2,be)),me=pe.data,xe=[],Ne=this.stride;for(let Oe=0;Oe<me.length;Oe+=Ne){if(me[Oe+2]<=be)continue;me[Oe+2]=be;const St=me[Oe],Ht=me[Oe+1],Rt=pe.within(me[Oe],me[Oe+1],Ee),Vt=me[Oe+pt];let Gt=Vt;for(const br of Rt){const qr=br*Ne;me[qr+2]>be&&(Gt+=me[qr+pt])}if(Gt>Vt&&Gt>=oe){let br,qr=St*Vt,Hr=Ht*Vt,Jr=-1;const en=(Oe/Ne<<5)+(be+1)+this.points.length;for(const Vn of Rt){const Kn=Vn*Ne;if(me[Kn+2]<=be)continue;me[Kn+2]=be;const Sn=me[Kn+pt];qr+=me[Kn]*Sn,Hr+=me[Kn+1]*Sn,me[Kn+4]=en,je&&(br||(br=this._map(me,Oe,!0),Jr=this.clusterProps.length,this.clusterProps.push(br)),je(br,this._map(me,Kn)))}me[Oe+4]=en,xe.push(qr/Gt,Hr/Gt,1/0,en,-1,Gt),je&&xe.push(Jr)}else{for(let br=0;br<Ne;br++)xe.push(me[Oe+br]);if(Gt>1)for(const br of Rt){const qr=br*Ne;if(!(me[qr+2]<=be)){me[qr+2]=be;for(let Hr=0;Hr<Ne;Hr++)xe.push(me[qr+Hr])}}}}return xe}_getOriginId(pe){return pe-this.points.length>>5}_getOriginZoom(pe){return(pe-this.points.length)%32}_map(pe,be,Ve){if(pe[be+pt]>1){const oe=this.clusterProps[pe[be+Ct]];return Ve?Object.assign({},oe):oe}const rt=this.points[pe[be+Dt]].properties,je=this.options.map(rt);return Ve&&je===rt?Object.assign({},je):je}}function Zt(Tt,pe,be){return{type:"Feature",id:Tt[pe+Dt],properties:sn(Tt,pe,be),geometry:{type:"Point",coordinates:[(Ve=Tt[pe],360*(Ve-.5)),En(Tt[pe+1])]}};var Ve}function sn(Tt,pe,be){const Ve=Tt[pe+pt],rt=Ve>=1e4?`${Math.round(Ve/1e3)}k`:Ve>=1e3?Math.round(Ve/100)/10+"k":Ve,je=Tt[pe+Ct],oe=je===-1?{}:Object.assign({},be[je]);return Object.assign(oe,{cluster:!0,cluster_id:Tt[pe+Dt],point_count:Ve,point_count_abbreviated:rt})}function er(Tt){return Tt/360+.5}function mt(Tt){const pe=Math.sin(Tt*Math.PI/180),be=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return be<0?0:be>1?1:be}function En(Tt){const pe=(180-360*Tt)*Math.PI/180;return 360*Math.atan(Math.exp(pe))/Math.PI-90}function $r(Tt,pe,be,Ve){let rt=Ve;const je=pe+(be-pe>>1);let oe,Ee=be-pe;const me=Tt[pe],xe=Tt[pe+1],Ne=Tt[be],Oe=Tt[be+1];for(let St=pe+3;St<be;St+=3){const Ht=zn(Tt[St],Tt[St+1],me,xe,Ne,Oe);if(Ht>rt)oe=St,rt=Ht;else if(Ht===rt){const Rt=Math.abs(St-je);Rt<Ee&&(oe=St,Ee=Rt)}}rt>Ve&&(oe-pe>3&&$r(Tt,pe,oe,Ve),Tt[oe+2]=rt,be-oe>3&&$r(Tt,oe,be,Ve))}function zn(Tt,pe,be,Ve,rt,je){let oe=rt-be,Ee=je-Ve;if(oe!==0||Ee!==0){const me=((Tt-be)*oe+(pe-Ve)*Ee)/(oe*oe+Ee*Ee);me>1?(be=rt,Ve=je):me>0&&(be+=oe*me,Ve+=Ee*me)}return oe=Tt-be,Ee=pe-Ve,oe*oe+Ee*Ee}function an(Tt,pe,be,Ve){const rt={id:Tt??null,type:pe,geometry:be,tags:Ve,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")Pn(rt,be);else if(pe==="Polygon")Pn(rt,be[0]);else if(pe==="MultiLineString")for(const je of be)Pn(rt,je);else if(pe==="MultiPolygon")for(const je of be)Pn(rt,je[0]);return rt}function Pn(Tt,pe){for(let be=0;be<pe.length;be+=3)Tt.minX=Math.min(Tt.minX,pe[be]),Tt.minY=Math.min(Tt.minY,pe[be+1]),Tt.maxX=Math.max(Tt.maxX,pe[be]),Tt.maxY=Math.max(Tt.maxY,pe[be+1])}function yn(Tt,pe,be,Ve){if(!pe.geometry)return;const rt=pe.geometry.coordinates;if(rt&&rt.length===0)return;const je=pe.geometry.type,oe=Math.pow(be.tolerance/((1<<be.maxZoom)*be.extent),2);let Ee=[],me=pe.id;if(be.promoteId?me=pe.properties[be.promoteId]:be.generateId&&(me=Ve||0),je==="Point")Ci(rt,Ee);else if(je==="MultiPoint")for(const xe of rt)Ci(xe,Ee);else if(je==="LineString")Zn(rt,Ee,oe,!1);else if(je==="MultiLineString"){if(be.lineMetrics){for(const xe of rt)Ee=[],Zn(xe,Ee,oe,!1),Tt.push(an(me,"LineString",Ee,pe.properties));return}Vi(rt,Ee,oe,!1)}else if(je==="Polygon")Vi(rt,Ee,oe,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(const xe of pe.geometry.geometries)yn(Tt,{id:me,geometry:xe,properties:pe.properties},be,Ve);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const xe of rt){const Ne=[];Vi(xe,Ne,oe,!0),Ee.push(Ne)}}Tt.push(an(me,je,Ee,pe.properties))}function Ci(Tt,pe){pe.push(Ti(Tt[0]),ui(Tt[1]),0)}function Zn(Tt,pe,be,Ve){let rt,je,oe=0;for(let me=0;me<Tt.length;me++){const xe=Ti(Tt[me][0]),Ne=ui(Tt[me][1]);pe.push(xe,Ne,0),me>0&&(oe+=Ve?(rt*Ne-xe*je)/2:Math.sqrt(Math.pow(xe-rt,2)+Math.pow(Ne-je,2))),rt=xe,je=Ne}const Ee=pe.length-3;pe[2]=1,$r(pe,0,Ee,be),pe[Ee+2]=1,pe.size=Math.abs(oe),pe.start=0,pe.end=pe.size}function Vi(Tt,pe,be,Ve){for(let rt=0;rt<Tt.length;rt++){const je=[];Zn(Tt[rt],je,be,Ve),pe.push(je)}}function Ti(Tt){return Tt/360+.5}function ui(Tt){const pe=Math.sin(Tt*Math.PI/180),be=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return be<0?0:be>1?1:be}function ta(Tt,pe,be,Ve,rt,je,oe,Ee){if(Ve/=pe,je>=(be/=pe)&&oe<Ve)return Tt;if(oe<be||je>=Ve)return null;const me=[];for(const xe of Tt){const Ne=xe.geometry;let Oe=xe.type;const St=rt===0?xe.minX:xe.minY,Ht=rt===0?xe.maxX:xe.maxY;if(St>=be&&Ht<Ve){me.push(xe);continue}if(Ht<be||St>=Ve)continue;let Rt=[];if(Oe==="Point"||Oe==="MultiPoint")bi(Ne,Rt,be,Ve,rt);else if(Oe==="LineString")ti(Ne,Rt,be,Ve,rt,!1,Ee.lineMetrics);else if(Oe==="MultiLineString")Dn(Ne,Rt,be,Ve,rt,!1);else if(Oe==="Polygon")Dn(Ne,Rt,be,Ve,rt,!0);else if(Oe==="MultiPolygon")for(const Vt of Ne){const Gt=[];Dn(Vt,Gt,be,Ve,rt,!0),Gt.length&&Rt.push(Gt)}if(Rt.length){if(Ee.lineMetrics&&Oe==="LineString"){for(const Vt of Rt)me.push(an(xe.id,Oe,Vt,xe.tags));continue}Oe!=="LineString"&&Oe!=="MultiLineString"||(Rt.length===1?(Oe="LineString",Rt=Rt[0]):Oe="MultiLineString"),Oe!=="Point"&&Oe!=="MultiPoint"||(Oe=Rt.length===3?"Point":"MultiPoint"),me.push(an(xe.id,Oe,Rt,xe.tags))}}return me.length?me:null}function bi(Tt,pe,be,Ve,rt){for(let je=0;je<Tt.length;je+=3){const oe=Tt[je+rt];oe>=be&&oe<=Ve&&ua(pe,Tt[je],Tt[je+1],Tt[je+2])}}function ti(Tt,pe,be,Ve,rt,je,oe){let Ee=vi(Tt);const me=rt===0?ca:Gn;let xe,Ne,Oe=Tt.start;for(let Gt=0;Gt<Tt.length-3;Gt+=3){const br=Tt[Gt],qr=Tt[Gt+1],Hr=Tt[Gt+2],Jr=Tt[Gt+3],en=Tt[Gt+4],Vn=rt===0?br:qr,Kn=rt===0?Jr:en;let Sn=!1;oe&&(xe=Math.sqrt(Math.pow(br-Jr,2)+Math.pow(qr-en,2))),Vn<be?Kn>be&&(Ne=me(Ee,br,qr,Jr,en,be),oe&&(Ee.start=Oe+xe*Ne)):Vn>Ve?Kn<Ve&&(Ne=me(Ee,br,qr,Jr,en,Ve),oe&&(Ee.start=Oe+xe*Ne)):ua(Ee,br,qr,Hr),Kn<be&&Vn>=be&&(Ne=me(Ee,br,qr,Jr,en,be),Sn=!0),Kn>Ve&&Vn<=Ve&&(Ne=me(Ee,br,qr,Jr,en,Ve),Sn=!0),!je&&Sn&&(oe&&(Ee.end=Oe+xe*Ne),pe.push(Ee),Ee=vi(Tt)),oe&&(Oe+=xe)}let St=Tt.length-3;const Ht=Tt[St],Rt=Tt[St+1],Vt=rt===0?Ht:Rt;Vt>=be&&Vt<=Ve&&ua(Ee,Ht,Rt,Tt[St+2]),St=Ee.length-3,je&&St>=3&&(Ee[St]!==Ee[0]||Ee[St+1]!==Ee[1])&&ua(Ee,Ee[0],Ee[1],Ee[2]),Ee.length&&pe.push(Ee)}function vi(Tt){const pe=[];return pe.size=Tt.size,pe.start=Tt.start,pe.end=Tt.end,pe}function Dn(Tt,pe,be,Ve,rt,je){for(const oe of Tt)ti(oe,pe,be,Ve,rt,je,!1)}function ua(Tt,pe,be,Ve){Tt.push(pe,be,Ve)}function ca(Tt,pe,be,Ve,rt,je){const oe=(je-pe)/(Ve-pe);return ua(Tt,je,be+(rt-be)*oe,1),oe}function Gn(Tt,pe,be,Ve,rt,je){const oe=(je-be)/(rt-be);return ua(Tt,pe+(Ve-pe)*oe,je,1),oe}function Li(Tt,pe){const be=[];for(let Ve=0;Ve<Tt.length;Ve++){const rt=Tt[Ve],je=rt.type;let oe;if(je==="Point"||je==="MultiPoint"||je==="LineString")oe=xa(rt.geometry,pe);else if(je==="MultiLineString"||je==="Polygon"){oe=[];for(const Ee of rt.geometry)oe.push(xa(Ee,pe))}else if(je==="MultiPolygon"){oe=[];for(const Ee of rt.geometry){const me=[];for(const xe of Ee)me.push(xa(xe,pe));oe.push(me)}}be.push(an(rt.id,je,oe,rt.tags))}return be}function xa(Tt,pe){const be=[];be.size=Tt.size,Tt.start!==void 0&&(be.start=Tt.start,be.end=Tt.end);for(let Ve=0;Ve<Tt.length;Ve+=3)be.push(Tt[Ve]+pe,Tt[Ve+1],Tt[Ve+2]);return be}function yi(Tt,pe){if(Tt.transformed)return Tt;const be=1<<Tt.z,Ve=Tt.x,rt=Tt.y;for(const je of Tt.features){const oe=je.geometry,Ee=je.type;if(je.geometry=[],Ee===1)for(let me=0;me<oe.length;me+=2)je.geometry.push(Nn(oe[me],oe[me+1],pe,be,Ve,rt));else for(let me=0;me<oe.length;me++){const xe=[];for(let Ne=0;Ne<oe[me].length;Ne+=2)xe.push(Nn(oe[me][Ne],oe[me][Ne+1],pe,be,Ve,rt));je.geometry.push(xe)}}return Tt.transformed=!0,Tt}function Nn(Tt,pe,be,Ve,rt,je){return[Math.round(be*(Tt*Ve-rt)),Math.round(be*(pe*Ve-je))]}function ki(Tt,pe,be,Ve,rt){const je=pe===rt.maxZoom?0:rt.tolerance/((1<<pe)*rt.extent),oe={features:[],numPoints:0,numSimplified:0,numFeatures:Tt.length,source:null,x:be,y:Ve,z:pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ee of Tt)oo(oe,Ee,je,rt);return oe}function oo(Tt,pe,be,Ve){const rt=pe.geometry,je=pe.type,oe=[];if(Tt.minX=Math.min(Tt.minX,pe.minX),Tt.minY=Math.min(Tt.minY,pe.minY),Tt.maxX=Math.max(Tt.maxX,pe.maxX),Tt.maxY=Math.max(Tt.maxY,pe.maxY),je==="Point"||je==="MultiPoint")for(let Ee=0;Ee<rt.length;Ee+=3)oe.push(rt[Ee],rt[Ee+1]),Tt.numPoints++,Tt.numSimplified++;else if(je==="LineString")wa(oe,rt,Tt,be,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(let Ee=0;Ee<rt.length;Ee++)wa(oe,rt[Ee],Tt,be,je==="Polygon",Ee===0);else if(je==="MultiPolygon")for(let Ee=0;Ee<rt.length;Ee++){const me=rt[Ee];for(let xe=0;xe<me.length;xe++)wa(oe,me[xe],Tt,be,!0,xe===0)}if(oe.length){let Ee=pe.tags||null;if(je==="LineString"&&Ve.lineMetrics){Ee={};for(const xe in pe.tags)Ee[xe]=pe.tags[xe];Ee.mapbox_clip_start=rt.start/rt.size,Ee.mapbox_clip_end=rt.end/rt.size}const me={geometry:oe,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:Ee};pe.id!==null&&(me.id=pe.id),Tt.features.push(me)}}function wa(Tt,pe,be,Ve,rt,je){const oe=Ve*Ve;if(Ve>0&&pe.size<(rt?oe:Ve))return void(be.numPoints+=pe.length/3);const Ee=[];for(let me=0;me<pe.length;me+=3)(Ve===0||pe[me+2]>oe)&&(be.numSimplified++,Ee.push(pe[me],pe[me+1])),be.numPoints++;rt&&function(me,xe){let Ne=0;for(let Oe=0,St=me.length,Ht=St-2;Oe<St;Ht=Oe,Oe+=2)Ne+=(me[Oe]-me[Ht])*(me[Oe+1]+me[Ht+1]);if(Ne>0===xe)for(let Oe=0,St=me.length;Oe<St/2;Oe+=2){const Ht=me[Oe],Rt=me[Oe+1];me[Oe]=me[St-2-Oe],me[Oe+1]=me[St-1-Oe],me[St-2-Oe]=Ht,me[St-1-Oe]=Rt}}(Ee,je),Tt.push(Ee)}const ba={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Mi{constructor(pe,be){const Ve=(be=this.options=function(je,oe){for(const Ee in oe)je[Ee]=oe[Ee];return je}(Object.create(ba),be)).debug;if(Ve&&console.time("preprocess data"),be.maxZoom<0||be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(be.promoteId&&be.generateId)throw new Error("promoteId and generateId cannot be used together.");let rt=function(je,oe){const Ee=[];if(je.type==="FeatureCollection")for(let me=0;me<je.features.length;me++)yn(Ee,je.features[me],oe,me);else yn(Ee,je.type==="Feature"?je:{geometry:je},oe);return Ee}(pe,be);this.tiles={},this.tileCoords=[],Ve&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",be.indexMaxZoom,be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),rt=function(je,oe){const Ee=oe.buffer/oe.extent;let me=je;const xe=ta(je,1,-1-Ee,Ee,0,-1,2,oe),Ne=ta(je,1,1-Ee,2+Ee,0,-1,2,oe);return(xe||Ne)&&(me=ta(je,1,-Ee,1+Ee,0,-1,2,oe)||[],xe&&(me=Li(xe,1).concat(me)),Ne&&(me=me.concat(Li(Ne,-1)))),me}(rt,be),rt.length&&this.splitTile(rt,0,0,0),Ve&&(rt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(pe,be,Ve,rt,je,oe,Ee){const me=[pe,be,Ve,rt],xe=this.options,Ne=xe.debug;for(;me.length;){rt=me.pop(),Ve=me.pop(),be=me.pop(),pe=me.pop();const Oe=1<<be,St=Ea(be,Ve,rt);let Ht=this.tiles[St];if(!Ht&&(Ne>1&&console.time("creation"),Ht=this.tiles[St]=ki(pe,be,Ve,rt,xe),this.tileCoords.push({z:be,x:Ve,y:rt}),Ne)){Ne>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",be,Ve,rt,Ht.numFeatures,Ht.numPoints,Ht.numSimplified),console.timeEnd("creation"));const Sn=`z${be}`;this.stats[Sn]=(this.stats[Sn]||0)+1,this.total++}if(Ht.source=pe,je==null){if(be===xe.indexMaxZoom||Ht.numPoints<=xe.indexMaxPoints)continue}else{if(be===xe.maxZoom||be===je)continue;if(je!=null){const Sn=je-be;if(Ve!==oe>>Sn||rt!==Ee>>Sn)continue}}if(Ht.source=null,pe.length===0)continue;Ne>1&&console.time("clipping");const Rt=.5*xe.buffer/xe.extent,Vt=.5-Rt,Gt=.5+Rt,br=1+Rt;let qr=null,Hr=null,Jr=null,en=null,Vn=ta(pe,Oe,Ve-Rt,Ve+Gt,0,Ht.minX,Ht.maxX,xe),Kn=ta(pe,Oe,Ve+Vt,Ve+br,0,Ht.minX,Ht.maxX,xe);pe=null,Vn&&(qr=ta(Vn,Oe,rt-Rt,rt+Gt,1,Ht.minY,Ht.maxY,xe),Hr=ta(Vn,Oe,rt+Vt,rt+br,1,Ht.minY,Ht.maxY,xe),Vn=null),Kn&&(Jr=ta(Kn,Oe,rt-Rt,rt+Gt,1,Ht.minY,Ht.maxY,xe),en=ta(Kn,Oe,rt+Vt,rt+br,1,Ht.minY,Ht.maxY,xe),Kn=null),Ne>1&&console.timeEnd("clipping"),me.push(qr||[],be+1,2*Ve,2*rt),me.push(Hr||[],be+1,2*Ve,2*rt+1),me.push(Jr||[],be+1,2*Ve+1,2*rt),me.push(en||[],be+1,2*Ve+1,2*rt+1)}}getTile(pe,be,Ve){pe=+pe,be=+be,Ve=+Ve;const rt=this.options,{extent:je,debug:oe}=rt;if(pe<0||pe>24)return null;const Ee=1<<pe,me=Ea(pe,be=be+Ee&Ee-1,Ve);if(this.tiles[me])return yi(this.tiles[me],je);oe>1&&console.log("drilling down to z%d-%d-%d",pe,be,Ve);let xe,Ne=pe,Oe=be,St=Ve;for(;!xe&&Ne>0;)Ne--,Oe>>=1,St>>=1,xe=this.tiles[Ea(Ne,Oe,St)];return xe&&xe.source?(oe>1&&(console.log("found parent tile z%d-%d-%d",Ne,Oe,St),console.time("drilling down")),this.splitTile(xe.source,Ne,Oe,St,pe,be,Ve),oe>1&&console.timeEnd("drilling down"),this.tiles[me]?yi(this.tiles[me],je):null):null}}function Ea(Tt,pe,be){return 32*((1<<Tt)*be+pe)+Tt}function hr(Tt,pe){const be=Tt.tileID.canonical;if(!this._geoJSONIndex)return void pe(null,null);const Ve=this._geoJSONIndex.getTile(be.z,be.x,be.y);if(!Ve)return void pe(null,null);const rt=xe=>xe.tags&&"3d_elevation_id"in xe.tags&&"source"in xe.tags&&xe.tags.source==="elevation",je=Ve.features.filter(xe=>rt(xe));let oe={_geojsonTileLayer:Ve.features};je.length>0&&(oe={_geojsonTileLayer:Ve.features.filter(xe=>!rt(xe)),hd_road_elevation:je});const Ee=new Be(oe),me=function(xe){const Ne=new a.bq;for(const Oe of Object.keys(xe))Ne.writeMessage(3,bt,{name:Oe,features:xe[Oe]});return Ne.finish()}(oe).buffer;pe(null,{vectorTile:Ee,rawData:me})}class Bo extends H{constructor(pe,be,Ve,rt,je,oe,Ee){super(pe,be,Ve,rt,je,hr,Ee),oe&&(this.loadGeoJSON=oe),this._dynamicIndex=new nt}loadData(pe,be){const Ve=pe&&pe.request,rt=Ve&&Ve.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(pe,(je,oe)=>{if(je||!oe)return be(je);if(typeof oe!="object")return be(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));{try{if(pe.filter){const me=a.X(pe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(me.result==="error")throw new Error(me.value.map(xe=>`${xe.key}: ${xe.message}`).join(", "));oe.features=oe.features.filter(xe=>me.value.evaluate({zoom:0},xe))}pe.dynamic?(oe.type==="Feature"&&(oe={type:"FeatureCollection",features:[oe]}),pe.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(oe.features,this.loaded),pe.cluster&&(oe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=pe.cluster?new mr(function({superclusterOptions:me,clusterProperties:xe}){if(!xe||!me)return me;const Ne={},Oe={},St={accumulated:null,zoom:0},Ht={properties:null},Rt=Object.keys(xe);for(const Vt of Rt){const[Gt,br]=xe[Vt],qr=a.X(br),Hr=a.X(typeof Gt=="string"?[Gt,["accumulated"],["get",Vt]]:Gt);Ne[Vt]=qr.value,Oe[Vt]=Hr.value}return me.map=Vt=>{Ht.properties=Vt;const Gt={};for(const br of Rt)Gt[br]=Ne[br].evaluate(St,Ht);return Gt},me.reduce=(Vt,Gt)=>{Ht.properties=Gt;for(const br of Rt)St.accumulated=Vt[br],Vt[br]=Oe[br].evaluate(St,Ht)},me}(pe)).load(oe.features):pe.dynamic?this._dynamicIndex:function(me,xe){return new Mi(me,xe)}(oe,pe.geojsonVtOptions)}catch(me){return be(me)}const Ee={};if(rt){const me=v(Ve);me&&(Ee.resourceTiming={},Ee.resourceTiming[pe.source]=JSON.parse(JSON.stringify(me)))}be(null,Ee)}})}reloadTile(pe,be){const Ve=this.loaded;return Ve&&Ve[pe.uid]?pe.partial?be(null,void 0):super.reloadTile(pe,be):this.loadTile(pe,be)}loadGeoJSON(pe,be){if(pe.request)a.n(pe.request,be);else{if(typeof pe.data!="string")return be(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));setTimeout(()=>{try{return be(null,JSON.parse(pe.data))}catch{return be(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`))}},0)}}getClusterExpansionZoom(pe,be){try{be(null,this._geoJSONIndex.getClusterExpansionZoom(pe.clusterId))}catch(Ve){be(Ve)}}getClusterChildren(pe,be){try{be(null,this._geoJSONIndex.getChildren(pe.clusterId))}catch(Ve){be(Ve)}}getClusterLeaves(pe,be){try{be(null,this._geoJSONIndex.getLeaves(pe.clusterId,pe.limit,pe.offset))}catch(Ve){be(Ve)}}}class xc{constructor(pe,be,Ve){this.tileID=new a.aM(pe.tileID.overscaledZ,pe.tileID.wrap,pe.tileID.canonical.z,pe.tileID.canonical.x,pe.tileID.canonical.y),this.tileZoom=pe.tileZoom,this.uid=pe.uid,this.zoom=pe.zoom,this.canonical=pe.tileID.canonical,this.pixelRatio=pe.pixelRatio,this.tileSize=pe.tileSize,this.source=pe.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=pe.projection,this.brightness=be,this.worldview=Ve}parse(pe,be,Ve,rt){this.status="parsing";const je=new a.aM(Ve.tileID.overscaledZ,Ve.tileID.wrap,Ve.tileID.canonical.z,Ve.tileID.canonical.x,Ve.tileID.canonical.y),oe=[],Ee=be.familiesBySource[Ve.source],me=new a.fc(je,Ve.promoteId);me.bucketLayerIDs=[],me.is3DTile=!0,a.fr(pe).then(xe=>{if(!xe)return rt(new Error("Could not parse tile"));const Ne=xe.json.extensionsUsed&&xe.json.extensionsUsed.includes("MAPBOX_mesh_features")||xe.json.asset.extras&&xe.json.asset.extras.MAPBOX_mesh_features,Oe=xe.json.extensionsUsed&&xe.json.extensionsUsed.includes("EXT_meshopt_compression"),St=new a.aa(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const Ht in Ee)for(const Rt of Ee[Ht]){const Vt=Rt[0];me.bucketLayerIDs.push(Rt.map(qr=>a.C(qr.id,qr.scope))),Vt.recalculate(St,[]);const Gt=a.fs(xe,1/a.d4(Ve.tileID.canonical)),br=new a.ft(Rt,Gt,je,Ne,Oe,this.brightness,me,this.worldview);Ne||(br.needsUpload=!0),oe.push(br),br.evaluate(Vt)}this.status="done",rt(null,{buckets:oe,featureIndex:me,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(xe=>rt(new Error(xe.message)))}}class sl{constructor(pe,be,Ve,rt,je,oe,Ee,me){this.actor=pe,this.layerIndex=be,this.availableImages=Ve,this.availableModels=rt,this.brightness=Ee,this.loading={},this.loaded={},this.worldview=me}loadTile(pe,be){const Ve=pe.uid,rt=this.loading[Ve]=new xc(pe,this.brightness,this.worldview);a.br(pe.request,(je,oe)=>{const Ee=!this.loading[Ve];return delete this.loading[Ve],Ee||je?(rt.status="done",Ee||(this.loaded[Ve]=rt),be(je)):oe&&oe.byteLength!==0?void rt.parse(oe,this.layerIndex,pe,(me,xe)=>{rt.status="done",this.loaded=this.loaded||{},this.loaded[Ve]=rt,me||!xe?be(me):be(null,xe)}):(rt.status="done",this.loaded[Ve]=rt,be())})}reloadTile(pe,be){const Ve=this.loaded,rt=pe.uid;if(Ve&&Ve[rt]){const je=Ve[rt];je.projection=pe.projection,je.brightness=pe.brightness;const oe=(Ee,me)=>{je.reloadCallback&&(delete je.reloadCallback,this.loadTile(pe,be)),be(Ee,me)};je.status==="parsing"?je.reloadCallback=oe:je.status==="done"&&this.loadTile(pe,be)}}abortTile(pe,be){const Ve=pe.uid;this.loading[Ve]&&delete this.loading[Ve],be()}removeTile(pe,be){const Ve=this.loaded,rt=pe.uid;Ve&&Ve[rt]&&delete Ve[rt],be()}}class _n{constructor(pe){this.self=pe,this.actor=new a.fv(pe,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new a.y,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=a.cj({name:"mercator"}),this.workerSourceTypes={vector:H,geojson:Bo,"raster-dem":q,"raster-array":J,"batched-model":sl},this.workerSources={},this.self.registerWorkerSource=(be,Ve)=>{if(this.workerSourceTypes[be])throw new Error(`Worker source with name "${be}" already registered.`);this.workerSourceTypes[be]=Ve},this.self.registerRTLTextPlugin=be=>{if(a.fw.isParsed())throw new Error("RTL text plugin already registered.");a.fw.setState({pluginStatus:a.fx.parsed,pluginURL:a.fw.getPluginURL()}),a.fw.applyArabicShaping=be.applyArabicShaping,a.fw.processBidirectionalText=be.processBidirectionalText,a.fw.processStyledBidirectionalText=be.processStyledBidirectionalText;for(const Ve of this.rtlPluginParsingListeners)Ve(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(pe,be,Ve){delete this.layerIndexes[pe],delete this.availableImages[pe],delete this.availableModels[pe],delete this.workerSources[pe],Ve()}checkIfReady(pe,be,Ve){Ve()}setReferrer(pe,be){this.referrer=be}spriteLoaded(pe,be){this.isSpriteLoaded[pe]||(this.isSpriteLoaded[pe]={});const{scope:Ve,isLoaded:rt}=be;if(this.isSpriteLoaded[pe][Ve]=rt,this.workerSources[pe]&&this.workerSources[pe][Ve])for(const je in this.workerSources[pe][Ve]){const oe=this.workerSources[pe][Ve][je];for(const Ee in oe){const me=oe[Ee];me instanceof H&&(me.isSpriteLoaded=rt,me.fire(new a.A("isSpriteLoaded")))}}}setImages(pe,be,Ve){this.availableImages[pe]||(this.availableImages[pe]={});const{scope:rt,images:je}=be;if(this.availableImages[pe][rt]=je,this.workerSources[pe]&&this.workerSources[pe][rt]){for(const oe in this.workerSources[pe][rt]){const Ee=this.workerSources[pe][rt][oe];for(const me in Ee)Ee[me].availableImages=je}Ve()}else Ve()}setModels(pe,{scope:be,models:Ve},rt){if(this.availableModels[pe]||(this.availableModels[pe]={}),this.availableModels[pe][be]=Ve,this.workerSources[pe]&&this.workerSources[pe][be]){for(const je in this.workerSources[pe][be]){const oe=this.workerSources[pe][be][je];for(const Ee in oe)oe[Ee].availableModels=Ve}rt()}else rt()}setProjection(pe,be){this.projections[pe]=a.cj(be)}setBrightness(pe,be,Ve){this.brightness=be,Ve()}setWorldview(pe,be,Ve){this.worldview=be,Ve()}setLayers(pe,be,Ve){this.getLayerIndex(pe,be.scope).replace(be.layers,be.options),Ve()}updateLayers(pe,be,Ve){this.getLayerIndex(pe,be.scope).update(be.layers,be.removedIds,be.options),Ve()}loadTile(pe,be,Ve){be.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,be.type,be.source,be.scope).loadTile(be,Ve)}decodeRasterArray(pe,be,Ve){this.getWorkerSource(pe,be.type,be.source,be.scope).decodeRasterArray(be,Ve)}reloadTile(pe,be,Ve){be.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,be.type,be.source,be.scope).reloadTile(be,Ve)}abortTile(pe,be,Ve){this.getWorkerSource(pe,be.type,be.source,be.scope).abortTile(be,Ve)}removeTile(pe,be,Ve){this.getWorkerSource(pe,be.type,be.source,be.scope).removeTile(be,Ve)}removeSource(pe,be,Ve){if(!(this.workerSources[pe]&&this.workerSources[pe][be.scope]&&this.workerSources[pe][be.scope][be.type]&&this.workerSources[pe][be.scope][be.type][be.source]))return;const rt=this.workerSources[pe][be.scope][be.type][be.source];delete this.workerSources[pe][be.scope][be.type][be.source],rt.removeSource!==void 0?rt.removeSource(be,Ve):Ve()}loadWorkerSource(pe,be,Ve){try{this.self.importScripts(be.url),Ve()}catch(rt){Ve(rt.toString())}}syncRTLPluginState(pe,be,Ve){if(a.fw.isParsed())Ve(null,!0);else if(a.fw.isParsing())this.rtlPluginParsingListeners.push(Ve);else try{a.fw.setState(be);const rt=a.fw.getPluginURL();!a.fw.isLoaded()||a.fw.isParsed()||a.fw.isParsing()||rt==null||(a.fw.setState({pluginStatus:a.fx.parsing,pluginURL:a.fw.getPluginURL()}),this.self.importScripts(rt),a.fw.isParsed()?Ve(null,!0):this.rtlPluginParsingListeners.push(Ve))}catch(rt){Ve(rt.toString())}}setDracoUrl(pe,be){this.dracoUrl=be}getAvailableImages(pe,be){this.availableImages[pe]||(this.availableImages[pe]={});let Ve=this.availableImages[pe][be];return Ve||(Ve=[]),Ve}getAvailableModels(pe,be){this.availableModels[pe]||(this.availableModels[pe]={});let Ve=this.availableModels[pe][be];return Ve||(Ve={}),Ve}getLayerIndex(pe,be){this.layerIndexes[pe]||(this.layerIndexes[pe]={});let Ve=this.layerIndexes[pe][be];return Ve||(Ve=this.layerIndexes[pe][be]=new I,Ve.scope=be),Ve}getWorkerSource(pe,be,Ve,rt){const je=this.workerSources;return je[pe]||(je[pe]={}),je[pe][rt]||(je[pe][rt]={}),je[pe][rt][be]||(je[pe][rt][be]={}),this.isSpriteLoaded[pe]||(this.isSpriteLoaded[pe]={}),je[pe][rt][be][Ve]||(je[pe][rt][be][Ve]=new this.workerSourceTypes[be]({send:(oe,Ee,me,xe,Ne,Oe)=>this.actor.send(oe,Ee,me,pe,Ne,Oe),scheduler:this.actor.scheduler},this.getLayerIndex(pe,rt),this.getAvailableImages(pe,rt),this.getAvailableModels(pe,rt),this.isSpriteLoaded[pe][rt],void 0,this.brightness,this.worldview)),je[pe][rt][be][Ve]}rasterizeImagesWorker(pe,be,Ve){const rt=new Map;for(const[je,{image:oe,imageVariant:Ee}]of be.tasks.entries()){const me=this.imageRasterizer.rasterize(Ee,oe,be.scope,pe);rt.set(je,me)}Ve(void 0,rt)}removeRasterizedImages(pe,be,Ve){this.imageRasterizer.removeImagesFromCacheByIds(be.imageIds,be.scope,pe),Ve()}enforceCacheSizeLimit(pe,be){a.fy(be)}getWorkerPerformanceMetrics(pe,be,Ve){Ve(void 0,void 0)}}return a.fu(self)&&(self.worker=new _n(self)),_n}),u(["./shared"],function(a){var v="3.14.0";const x={create:"create",load:"load",fullLoad:"fullLoad"},b={mark(p){performance.mark(p)},measure(p,o,h){performance.measure(p,o,h)}};function I(p){const o=p.name.split("?")[0];return a.a(o)&&o.includes("mapbox-gl.js")?"javascript":a.a(o)&&o.includes("mapbox-gl.css")?"css":a.b(o)?"fontRange":a.c(o)?"sprite":a.i(o)?"style":a.d(o)?"tilejson":"other"}var M,L={},U=function(){if(M)return L;function p(m){return!o(m)}function o(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var E,S,F=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(F);try{S=new Worker(D),E=!0}catch{E=!1}return S&&S.terminate(),URL.revokeObjectURL(D),E}()?function(){var E=document.createElement("canvas");E.width=E.height=1;var S=E.getContext("2d");if(!S)return!1;var F=S.getImageData(0,0,1,1);return F&&F.width===E.width}()?(h[w=m&&m.failIfMajorPerformanceCaveat]===void 0&&(h[w]=function(E){var S,F=function(D){var Q=document.createElement("canvas"),V=Object.create(p.webGLContextAttributes);return V.failIfMajorPerformanceCaveat=D,Q.getContext("webgl2",V)}(E);if(!F)return!1;try{S=F.createShader(F.VERTEX_SHADER)}catch{return!1}return!(!S||F.isContextLost())&&(F.shaderSource(S,"void main() {}"),F.compileShader(S),F.getShaderParameter(S,F.COMPILE_STATUS)===!0)}(w)),h[w]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var w}M=1,L.supported=p,L.notSupportedReason=o;var h={};return p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},L}();function R(p,o,h){const m=document.createElement(p);return o!=null&&(m.className=o),h&&h.appendChild(m),m}function H(p,o,h){const m=document.createElementNS("http://www.w3.org/2000/svg",p);for(const w of Object.keys(o))m.setAttributeNS(null,w,String(o[w]));return h&&h.appendChild(m),m}const q=typeof document<"u"?document.documentElement&&document.documentElement.style:null,te=q&&q.userSelect!==void 0?"userSelect":"WebkitUserSelect";let J;function se(){q&&te&&(J=q[te],q[te]="none")}function ye(){q&&te&&(q[te]=J)}function Se(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",Se,!0)}function Be(){window.addEventListener("click",Se,!0),window.setTimeout(()=>{window.removeEventListener("click",Se,!0)},0)}function De(p,o){const h=p.getBoundingClientRect();return _e(p,h,o)}function we(p,o){const h=p.getBoundingClientRect(),m=[];for(let w=0;w<o.length;w++)m.push(_e(p,h,o[w]));return m}function nt(p){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&p.button===2&&p.ctrlKey?0:p.button}function _e(p,o,h){const m=p.offsetWidth===o.width?1:p.offsetWidth/o.width;return new a.P((h.clientX-o.left)*m,(h.clientY-o.top)*m)}const Ie="01",Ze="NO_ACCESS_TOKEN";class st{constructor(o,h,m){this._transformRequestFn=o,this._customAccessToken=h,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const o=function(){let h="";for(let m=0;m<10;m++)h+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ie,h].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,h){return this._transformRequestFn&&this._transformRequestFn(o,h)||{url:o}}normalizeStyleURL(o,h){if(!a.j(o))return o;const m=Ut(o);return m.params.push(`sdk=js-${v}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||h)}normalizeGlyphsURL(o,h){if(!a.j(o))return o;const m=Ut(o);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||h)}normalizeModelURL(o,h){if(!a.j(o))return o;const m=Ut(o);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||h)}normalizeSourceURL(o,h,m,w){if(!a.j(o))return o;const E=Ut(o);return E.path=`/v4/${E.authority}.json`,E.params.push("secure"),m&&E.params.push(`language=${m}`),w&&E.params.push(`worldview=${w}`),this._makeAPIURL(E,this._customAccessToken||h)}normalizeIconsetURL(o,h){const m=Ut(o);return a.j(o)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||h)):jt(m)}normalizeSpriteURL(o,h,m,w){const E=Ut(o);return a.j(o)?(E.path=`/styles/v1${E.path}/sprite${h}${m}`,this._makeAPIURL(E,this._customAccessToken||w)):(E.path+=`${h}${m}`,jt(E))}normalizeTileURL(o,h,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!a.j(o))return o;const w=Ut(o);w.path=w.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${h||m&&w.authority!=="raster"&&m===512?"@2x":""}${a.l.supported?".webp":"$1"}`),w.authority==="raster"?w.path=`/${a.e.RASTER_URL_PREFIX}${w.path}`:w.authority==="rasterarrays"?w.path=`/${a.e.RASTERARRAYS_URL_PREFIX}${w.path}`:w.authority==="3dtiles"?w.path=`/${a.e.TILES3D_URL_PREFIX}${w.path}`:(w.path=w.path.replace(/^.+\/v4\//,"/"),w.path=`/${a.e.TILE_URL_VERSION}${w.path}`);const E=this._customAccessToken||function(S){for(const F of S){const D=F.match(/^access_token=(.*)$/);if(D)return D[1]}return null}(w.params)||a.e.ACCESS_TOKEN;return a.e.REQUIRE_ACCESS_TOKEN&&E&&this._skuToken&&w.params.push(`sku=${this._skuToken}`),this._makeAPIURL(w,E)}canonicalizeTileURL(o,h){const m=Ut(o);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return o;let w="mapbox://";m.path.match(/^\/raster\/v1\//)?w+=`raster/${m.path.replace(`/${a.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?w+=`rasterarrays/${m.path.replace(`/${a.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:w+=`tiles/${m.path.replace(`/${a.e.TILE_URL_VERSION}/`,"")}`;let E=m.params;return h&&(E=E.filter(S=>!S.match(/^access_token=/))),E.length&&(w+=`?${E.join("&")}`),w}canonicalizeTileset(o,h){const m=!!h&&a.j(h),w=[];for(const E of o.tiles||[])a.k(E)?w.push(this.canonicalizeTileURL(E,m)):w.push(E);return w}_makeAPIURL(o,h){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",w=Ut(a.e.API_URL);if(o.protocol=w.protocol,o.authority=w.authority,o.protocol==="http"){const E=o.params.indexOf("secure");E>=0&&o.params.splice(E,1)}if(w.path!=="/"&&(o.path=`${w.path}${o.path}`),!a.e.REQUIRE_ACCESS_TOKEN)return jt(o);if(h=h||a.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!h)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(h[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return o.params=o.params.filter(E=>E.indexOf("access_token")===-1),o.params.push(`access_token=${h||""}`),jt(o)}}const Et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ut(p){const o=p.match(Et);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function jt(p){const o=p.params.length?`?${p.params.join("&")}`:"";return`${p.protocol}://${p.authority}${p.path}${o}`}const bt="mapbox.eventData";function Nt(p){if(!p)return null;const o=p.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(a.m(o[1]))}catch{return null}}class ar{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const h=Nt(a.e.ACCESS_TOKEN);let m="";return m=h&&h.u?a.f(h.u):a.e.ACCESS_TOKEN||"",o?`${bt}.${o}:${m}`:`${bt}:${m}`}fetchEventData(){const o=a.s("localStorage"),h=this.getStorageKey(),m=this.getStorageKey("uuid");if(o)try{const w=localStorage.getItem(h);w&&(this.eventData=JSON.parse(w));const E=localStorage.getItem(m);E&&(this.anonId=E)}catch{a.w("Unable to read from LocalStorage")}}saveEventData(){const o=a.s("localStorage"),h=this.getStorageKey(),m=this.getStorageKey("uuid"),w=this.anonId;if(o&&w)try{localStorage.setItem(m,w),Object.keys(this.eventData).length>=1&&localStorage.setItem(h,JSON.stringify(this.eventData))}catch{a.w("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,h,m,w){if(!a.e.EVENTS_URL)return;const E=Ut(a.e.EVENTS_URL);E.params.push(`access_token=${w||a.e.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(o).toISOString()},F=h?a.h(S,h):S,D={url:jt(E),headers:{"Content-Type":"text/plain"},body:JSON.stringify([F])};this.pendingRequest=a.p(D,Q=>{this.pendingRequest=null,m(Q),this.saveEventData(),this.processRequests(w)})}queueRequest(o,h){this.queue.push(o),this.processRequests(h)}}const lt=new class extends ar{constructor(p){super("appUserTurnstile"),this._customAccessToken=p}postTurnstileEvent(p,o){a.e.EVENTS_URL&&a.e.ACCESS_TOKEN&&Array.isArray(p)&&p.some(h=>a.j(h)||a.k(h))&&this.queueRequest(Date.now(),o)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=Nt(a.e.ACCESS_TOKEN),h=o?o.u:a.e.ACCESS_TOKEN;let m=h!==this.eventData.tokenU;a.v(this.anonId)||(this.anonId=a.u(),m=!0);const w=this.queue.shift();if(this.eventData.lastSuccess){const E=new Date(this.eventData.lastSuccess),S=new Date(w),F=(w-this.eventData.lastSuccess)/864e5;m=m||F>=1||F<-1||E.getDate()!==S.getDate()}else m=!0;m?this.postEvent(w,{sdkIdentifier:"mapbox-gl-js",sdkVersion:v,skuId:Ie,"enabled.telemetry":!1,userId:this.anonId},E=>{E||(this.eventData.lastSuccess=w,this.eventData.tokenU=h)},p):this.processRequests()}},ie=lt.postTurnstileEvent.bind(lt),Le=new class extends ar{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(p,o,h,m){this.skuToken=o,this.errorCb=m,a.e.EVENTS_URL&&(h||a.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},h):this.errorCb(new Error(Ze)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:h}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),a.v(this.anonId)||(this.anonId=a.u()),this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:v,skuId:Ie,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):o&&(this.success[o]=!0)},p))}remove(){this.errorCb=null}},Fe=Le.postMapLoadEvent.bind(Le),Re=new class extends ar{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(p){let o=this.mapInstanceIdMap.get(p);return o||(o=a.u(),this.mapInstanceIdMap.set(p,o)),o}getEventId(p){const o=this.eventIdPerMapInstanceMap.get(p)||0;return this.eventIdPerMapInstanceMap.set(p,o+1),o}postStyleLoadEvent(p,o){const{map:h,style:m,importedStyles:w}=o;if(!a.e.EVENTS_URL||!p&&!a.e.ACCESS_TOKEN)return;const E=this.getMapInstanceId(h),S={mapInstanceId:E,eventId:this.getEventId(E),style:m};w.length&&(S.importedStyles=w),this.queueRequest({timestamp:Date.now(),payload:S},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,payload:h}=this.queue.shift();this.postEvent(o,h,()=>{},p)}},et=Re.postStyleLoadEvent.bind(Re),xt=new class extends ar{constructor(){super("gljs.performance")}postPerformanceEvent(p,o){a.e.EVENTS_URL&&(p||a.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:h}=this.queue.shift(),m=function(w){const E=performance.getEntriesByType("resource"),S=performance.getEntriesByType("mark"),F=function(ee){const he={};if(ee){for(const le in ee)if(le!=="other")for(const Ae of ee[le]){const fe=`${le}ResolveRangeMin`,Ce=`${le}ResolveRangeMax`,ke=`${le}RequestCount`,He=`${le}RequestCachedCount`;he[fe]=Math.min(he[fe]||1/0,Ae.startTime),he[Ce]=Math.max(he[Ce]||-1/0,Ae.responseEnd);const $e=it=>{he[it]===void 0&&(he[it]=0),++he[it]};Ae.transferSize!==void 0&&Ae.transferSize===0&&$e(He),$e(ke)}}return he}(function(ee,he){const le={};if(ee)for(const Ae of ee){const fe=he(Ae);le[fe]===void 0&&(le[fe]=[]),le[fe].push(Ae)}return le}(E,I)),D=window.devicePixelRatio,Q=navigator.connection||navigator.mozConnection||navigator.webkitConnection,V=Q?Q.effectiveType:void 0,Z={counters:[],metadata:[],attributes:[]},K=(ee,he,le)=>{le!=null&&ee.push({name:he,value:le.toString()})};for(const ee in F)K(Z.counters,ee,F[ee]);if(w.interactionRange[0]!==1/0&&w.interactionRange[1]!==-1/0&&(K(Z.counters,"interactionRangeMin",w.interactionRange[0]),K(Z.counters,"interactionRangeMax",w.interactionRange[1])),S)for(const ee of Object.keys(x)){const he=x[ee],le=S.find(Ae=>Ae.name===he);le&&K(Z.counters,he,le.startTime)}return K(Z.counters,"visibilityHidden",w.visibilityHidden),K(Z.attributes,"style",function(ee){if(ee)for(const he of ee){const le=he.name.split("?")[0];if(a.i(le)){const Ae=le.split("/").slice(-2);if(Ae.length===2)return`mapbox://styles/${Ae[0]}/${Ae[1]}`}}}(E)),K(Z.attributes,"terrainEnabled",w.terrainEnabled?"true":"false"),K(Z.attributes,"fogEnabled",w.fogEnabled?"true":"false"),K(Z.attributes,"projection",w.projection),K(Z.attributes,"zoom",w.zoom),K(Z.metadata,"devicePixelRatio",D),K(Z.metadata,"connectionEffectiveType",V),K(Z.metadata,"navigatorUserAgent",navigator.userAgent),K(Z.metadata,"screenWidth",window.screen.width),K(Z.metadata,"screenHeight",window.screen.height),K(Z.metadata,"windowWidth",window.innerWidth),K(Z.metadata,"windowHeight",window.innerHeight),K(Z.metadata,"mapWidth",w.width/D),K(Z.metadata,"mapHeight",w.height/D),K(Z.metadata,"webglRenderer",w.renderer),K(Z.metadata,"webglVendor",w.vendor),K(Z.metadata,"sdkVersion",v),K(Z.metadata,"sdkIdentifier","mapbox-gl-js"),Z}(h);for(const w of m.metadata);for(const w of m.counters);for(const w of m.attributes);this.postEvent(o,m,()=>{},p)}},Dt=xt.postPerformanceEvent.bind(xt),pt=new class extends ar{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(p,o,h,m){if(!a.e.API_URL||!a.e.SESSION_PATH)return;const w=Ut(a.e.API_URL+a.e.SESSION_PATH);w.params.push(`sku=${o||""}`),w.params.push(`access_token=${m||a.e.ACCESS_TOKEN||""}`);const E={url:jt(w),headers:{"Content-Type":"text/plain"}};this.pendingRequest=a.g(E,S=>{this.pendingRequest=null,h(S),this.saveEventData(),this.processRequests(m)})}getSessionAPI(p,o,h,m){this.skuToken=o,this.errorCb=m,a.e.SESSION_PATH&&a.e.API_URL&&(h||a.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},h):this.errorCb(new Error(Ze)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:h}=this.queue.shift();o&&this.success[o]||this.getSession(h,this.skuToken,m=>{m?this.errorCb(m):o&&(this.success[o]=!0)},p)}remove(){this.errorCb=null}},Ct=pt.getSessionAPI.bind(pt),mr=new Set;function Zt(p,o){o?mr.add(p):mr.delete(p)}class sn{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,h){this._updatedSourceCaches[o]=h,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){const h=o.scope;this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._updatedLayers[h].add(o.id),this.setDirty()}removeLayer(o){const h=o.scope;this._removedLayers[h]=this._removedLayers[h]||{},this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._removedLayers[h][o.id]=o,this._updatedLayers[h].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){const o={};for(const h in this._updatedLayers)o[h]=o[h]||{},o[h].updatedIds=Array.from(this._updatedLayers[h].values());for(const h in this._removedLayers)o[h]=o[h]||{},o[h].removedIds=Object.keys(this._removedLayers[h]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(o){return this._updatedImages[o]?Array.from(this._updatedImages[o].values()):[]}updateImage(o,h){this._updatedImages[h]=this._updatedImages[h]||new Set,this._updatedImages[h].add(a.I.toString(o)),this.setDirty()}resetUpdatedImages(o){this._updatedImages[o]&&this._updatedImages[o].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function er(p){const{userImage:o}=p;return!!(o&&o.render&&o.render())&&(p.data.replace(new Uint8Array(o.data.buffer)),!0)}class mt extends a.E{constructor(o){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=o,o!=="raster"&&a.t()&&(this.imageRasterizerDispatcher=new a.D(a.x(),this,"Image Rasterizer Worker",1))}addScope(o){this.loaded.set(o,!1),this.imageProviders.set(o,new Map),this.images.set(o,new Map),this.updatedImages.set(o,new Set),this.callbackDispatchedThisFrame.set(o,new Set),this.patterns.set(o,new Map),this.atlasImage.set(o,new a.r({width:1,height:1}))}removeScope(o){this.loaded.delete(o),this.imageProviders.delete(o),this.images.delete(o),this.updatedImages.delete(o),this.callbackDispatchedThisFrame.delete(o),this.patterns.delete(o),this.atlasImage.delete(o);const h=this.atlasTexture.get(o);h&&(h.destroy(),this.atlasTexture.delete(o))}addImageProvider(o,h){this.imageProviders.has(h)||this.imageProviders.set(h,new Map),this.imageProviders.get(h).set(o.id,o)}removeImageProvider(o,h){this.imageProviders.has(h)&&this.imageProviders.get(h).delete(o)}getPendingImageProviders(){const o=[];for(const h of this.imageProviders.values())for(const m of h.values())m.hasPendingRequests()&&o.push(m);return o}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new a.y),this._imageRasterizer}isLoaded(){for(const o of this.loaded.keys())if(!this.loaded.get(o))return!1;return!0}setLoaded(o,h){if(this.loaded.get(h)!==o&&(this.loaded.set(h,o),o)){for(const{ids:m,callback:w}of this.requestors)this._notify(m,h,w);this.requestors=[]}}hasImage(o,h){return!!this.getImage(o,h)}getImage(o,h){return this.images.get(h).get(o.toString())}addImage(o,h,m){this._validate(o,m)&&this.images.get(h).set(o.toString(),m)}_validate(o,h){let m=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new a.z(new Error(`Image "${o.name}" has invalid "stretchX" value`))),m=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new a.z(new Error(`Image "${o.name}" has invalid "stretchY" value`))),m=!1),this._validateContent(h.content,h)||(this.fire(new a.z(new Error(`Image "${o.name}" has invalid "content" value`))),m=!1),m}_validateStretch(o,h){if(!o)return!0;let m=0;for(const w of o){if(w[0]<m||w[1]<w[0]||h<w[1])return!1;m=w[1]}return!0}_validateContent(o,h){return o?o.length!==4||!h.usvg&&(o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3])?!1:!(o[2]<o[0]||o[3]<o[1]):!0}updateImage(o,h,m){const w=this.images.get(h).get(o.toString());m.version=w.version+1,this.images.get(h).set(o.toString(),m),this.updatedImages.get(h).add(o),this.removeFromImageRasterizerCache(o,h)}clearUpdatedImages(o){this.updatedImages.get(o).clear()}removeFromImageRasterizerCache(o,h){this.spriteFormat!=="raster"&&(a.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[o],scope:h}):this.imageRasterizer.removeImagesFromCacheByIds([o],h))}removeImage(o,h){const m=this.images.get(h),w=m.get(o.toString());m.delete(o.toString()),this.patterns.get(h).delete(o.toString()),this.removeFromImageRasterizerCache(o,h),w.userImage&&w.userImage.onRemove&&w.userImage.onRemove()}listImages(o){return Array.from(this.images.get(o).keys()).map(h=>a.I.from(h))}getImages(o,h,m){const w=[],E=[],S=this.imageProviders.get(h);for(const V of o){if(!V.iconsetId){w.push(V);continue}const Z=S.get(V.iconsetId);Z&&(this.getImage(V,h)?E.push(V):Z.addPendingRequest(V))}if(w.length===0)return void this._notify(E,h,m);let F=!0;const D=!!this.loaded.get(h),Q=this.images.get(h);if(!D)for(const V of w)Q.has(V.toString())||(F=!1);D||F?this._notify(w,h,m):this.requestors.push({ids:w,scope:h,callback:m})}rasterizeImages(o,h){const m=new Map,{tasks:w,scope:E}=o;for(const[S,F]of w.entries()){const D=this.getImage(F.id,E);D&&m.set(S,{image:D,imageVariant:F})}this._rasterizeImages(E,m,h)}_rasterizeImages(o,h,m){if(a.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:h,scope:o},m);else{const w=new Map;for(const[E,{image:S,imageVariant:F}]of h.entries())w.set(E,this.imageRasterizer.rasterize(F,S,o,0));m(void 0,w)}}getUpdatedImages(o){return this.updatedImages.get(o)||new Set}_notify(o,h,m){const w=this.images.get(h),E=new Map;for(const S of o){if(!w.get(S.toString())){if(S.iconsetId)continue;this.fire(new a.A("styleimagemissing",{id:S.name}))}const F=w.get(S.toString());if(!F){a.w(`Image "${S.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const D={data:F.usvg?null:F.data.clone(),pixelRatio:F.pixelRatio,sdf:F.sdf,usvg:F.usvg,version:F.version,stretchX:F.stretchX,stretchY:F.stretchY,content:F.content,hasRenderCallback:!!(F.userImage&&F.userImage.render)};F.usvg&&Object.assign(D,{width:F.icon.usvg_tree.width,height:F.icon.usvg_tree.height}),E.set(a.I.toString(S),D)}m(null,E)}getPixelSize(o){const{width:h,height:m}=this.atlasImage.get(o);return{width:h,height:m}}getPattern(o,h,m){const w=o.toString(),E=this.patterns.get(h),S=E.get(w),F=this.getImage(o,h);if(!F)return null;if(S){if(S.position.version===F.version)return S.position;S.position.version=F.version}else{if(F.usvg&&!F.data){const D=this.getPatternInFlightId(w,h);if(this.patternsInFlight.has(D))return null;this.patternsInFlight.add(D);const Q=new a.B(o).scaleSelf(a.q.devicePixelRatio),V=new Map([[Q.toString(),{image:F,imageVariant:Q}]]);return this._rasterizeImages(h,V,(Z,K)=>this.storePatternImage(Q,h,F,m,K)),null}this.storePattern(o,h,F)}return this._updatePatternAtlas(h,m),E.get(w).position}getPatternInFlightId(o,h){return a.C(o,h)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(o,h,m,w,E){const S=o.toString(),F=E?E.get(S):void 0;F&&(m.data=F,this.storePattern(o.id,h,m),this._updatePatternAtlas(h,w),this.patternsInFlight.delete(this.getPatternInFlightId(o.id.toString(),h)))}storePattern(o,h,m){const w={w:m.data.width+2*a.F,h:m.data.height+2*a.F,x:0,y:0},E=new a.G(w,m,a.F);this.patterns.get(h).set(o.toString(),{bin:w,position:E})}destroyAtlasTextures(){for(const o of this.atlasTexture.values())o&&o.destroy();this.atlasTexture.clear()}bind(o,h){const m=o.gl;let w=this.atlasTexture.get(h);w?this.dirty&&(w.update(this.atlasImage.get(h)),this.dirty=!1):(w=new a.T(o,this.atlasImage.get(h),m.RGBA8),this.atlasTexture.set(h,w)),w.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(o,h){const m=this.patterns.get(o),w=Array.from(m.values()).map(({bin:Q})=>Q),{w:E,h:S}=a.H(w),F=this.atlasImage.get(o);F.resize({width:E||1,height:S||1});const D=this.images.get(o);for(const[Q,{bin:V,position:Z}]of m.entries()){let K=Z.padding;const ee=V.x+K,he=V.y+K,le=D.get(Q).data,Ae=le.width,fe=le.height;K=K>1?K-1:K,a.r.copy(le,F,{x:0,y:0},{x:ee,y:he},{width:Ae,height:fe},h),a.r.copy(le,F,{x:0,y:fe-K},{x:ee,y:he-K},{width:Ae,height:K},h),a.r.copy(le,F,{x:0,y:0},{x:ee,y:he+fe},{width:Ae,height:K},h),a.r.copy(le,F,{x:Ae-K,y:0},{x:ee-K,y:he},{width:K,height:fe},h),a.r.copy(le,F,{x:0,y:0},{x:ee+Ae,y:he},{width:K,height:fe},h),a.r.copy(le,F,{x:Ae-K,y:fe-K},{x:ee-K,y:he-K},{width:K,height:K},h),a.r.copy(le,F,{x:0,y:fe-K},{x:ee+Ae,y:he-K},{width:K,height:K},h),a.r.copy(le,F,{x:0,y:0},{x:ee+Ae,y:he+fe},{width:K,height:K},h),a.r.copy(le,F,{x:Ae-K,y:0},{x:ee-K,y:he+fe},{width:K,height:K},h)}this.dirty=!0}beginFrame(){for(const o of this.images.keys())this.callbackDispatchedThisFrame.set(o,new Set)}dispatchRenderCallbacks(o,h){const m=this.images.get(h);for(const w of o){if(this.callbackDispatchedThisFrame.get(h).has(w.toString()))continue;this.callbackDispatchedThisFrame.get(h).add(w.toString());const E=m.get(w.toString());er(E)&&this.updateImage(w,h,E)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function En(p){const o=p.key,h=p.value,m=p.valueSpec||{},w=p.objectElementValidators||{},E=p.style,S=p.styleSpec;let F=[];const D=a.J(h);if(D!=="object")return[new a.V(o,h,`object expected, ${D} found`)];for(const Q in h){const V=Q.split(".")[0];let Z;w[V]?Z=w[V]:m[V]?Z=Nn:w["*"]?Z=w["*"]:m["*"]&&(Z=Nn),Z?F=F.concat(Z({key:(o&&`${o}.`)+Q,value:h[Q],valueSpec:m[V]||m["*"],style:E,styleSpec:S,object:h,objectKey:Q},h)):F.push(new a.K(o,h[Q],`unknown property "${Q}"`))}for(const Q in m)w[Q]||m[Q].required&&m[Q].default===void 0&&h[Q]===void 0&&F.push(new a.V(o,h,`missing required property "${Q}"`));return F}function $r(p){const o=p.value,h=p.valueSpec,m=p.style,w=p.styleSpec,E=p.key,S=p.arrayElementValidator||Nn;if(a.J(o)!=="array")return[new a.V(E,o,`array expected, ${a.J(o)} found`)];if(h.length&&o.length!==h.length)return[new a.V(E,o,`array length ${h.length} expected, length ${o.length} found`)];if(h["min-length"]&&o.length<h["min-length"])return[new a.V(E,o,`array length at least ${h["min-length"]} expected, length ${o.length} found`)];let F={type:h.value,values:h.values,minimum:h.minimum,maximum:h.maximum,function:void 0};w.$version<7&&(F.function=h.function),a.J(h.value)==="object"&&(F=h.value);let D=[];for(let Q=0;Q<o.length;Q++)D=D.concat(S({array:o,arrayIndex:Q,value:o[Q],valueSpec:F,style:m,styleSpec:w,key:`${E}[${Q}]`},!0));return D}function zn(p){const o=p.key,h=p.value,m=p.valueSpec;let w=a.J(h);if(w==="number"&&h!=h&&(w="NaN"),w!=="number")return[new a.V(o,h,`number expected, ${w} found`)];if("minimum"in m){let E=m.minimum;if(a.J(m.minimum)==="array"&&(E=m.minimum[p.arrayIndex]),h<E)return[new a.V(o,h,`${h} is less than the minimum value ${E}`)]}if("maximum"in m){let E=m.maximum;if(a.J(m.maximum)==="array"&&(E=m.maximum[p.arrayIndex]),h>E)return[new a.V(o,h,`${h} is greater than the maximum value ${E}`)]}return[]}function an(p){const o=p.valueSpec,h=a.M(p.value.type);let m,w,E,S={};const F=h!=="categorical"&&p.value.property===void 0,D=!F,Q=a.J(p.value.stops)==="array"&&a.J(p.value.stops[0])==="array"&&a.J(p.value.stops[0][0])==="object",V=En({key:p.key,value:p.value,valueSpec:p.styleSpec.function,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(ee){if(h==="identity")return[new a.V(ee.key,ee.value,'identity function may not have a "stops" property')];let he=[];const le=ee.value;return he=he.concat($r({key:ee.key,value:le,valueSpec:ee.valueSpec,style:ee.style,styleSpec:ee.styleSpec,arrayElementValidator:Z})),a.J(le)==="array"&&le.length===0&&he.push(new a.V(ee.key,le,"array must have at least one stop")),he},default:function(ee){return Nn({key:ee.key,value:ee.value,valueSpec:o,style:ee.style,styleSpec:ee.styleSpec})}}});return h==="identity"&&F&&V.push(new a.V(p.key,p.value,'missing required property "property"')),h==="identity"||p.value.stops||V.push(new a.V(p.key,p.value,'missing required property "stops"')),h==="exponential"&&p.valueSpec.expression&&!a.N(p.valueSpec)&&V.push(new a.V(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(D&&!a.O(p.valueSpec)?V.push(new a.V(p.key,p.value,"property functions not supported")):F&&!a.Q(p.valueSpec)&&V.push(new a.V(p.key,p.value,"zoom functions not supported"))),h!=="categorical"&&!Q||p.value.property!==void 0||V.push(new a.V(p.key,p.value,'"property" property is required')),V;function Z(ee){let he=[];const le=ee.value,Ae=ee.key;if(a.J(le)!=="array")return[new a.V(Ae,le,`array expected, ${a.J(le)} found`)];if(le.length!==2)return[new a.V(Ae,le,`array length 2 expected, length ${le.length} found`)];if(Q){if(a.J(le[0])!=="object")return[new a.V(Ae,le,`object expected, ${a.J(le[0])} found`)];if(le[0].zoom===void 0)return[new a.V(Ae,le,"object stop key must have zoom")];if(le[0].value===void 0)return[new a.V(Ae,le,"object stop key must have value")];const fe=a.M(le[0].zoom);if(typeof fe!="number")return[new a.V(Ae,le[0].zoom,"stop zoom values must be numbers")];if(E&&E>fe)return[new a.V(Ae,le[0].zoom,"stop zoom values must appear in ascending order")];fe!==E&&(E=fe,w=void 0,S={}),he=he.concat(En({key:`${Ae}[0]`,value:le[0],valueSpec:{zoom:{}},style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{zoom:zn,value:K}}))}else he=he.concat(K({key:`${Ae}[0]`,value:le[0],style:ee.style,styleSpec:ee.styleSpec},le));return a.S(a.U(le[1]))?he.concat([new a.V(`${Ae}[1]`,le[1],"expressions are not allowed in function stops.")]):he.concat(Nn({key:`${Ae}[1]`,value:le[1],valueSpec:o,style:ee.style,styleSpec:ee.styleSpec}))}function K(ee,he){const le=a.J(ee.value),Ae=a.M(ee.value),fe=ee.value!==null?ee.value:he;if(m){if(le!==m)return[new a.V(ee.key,fe,`${le} stop domain type must match previous stop domain type ${m}`)]}else m=le;if(le!=="number"&&le!=="string"&&le!=="boolean"&&typeof Ae!="number"&&typeof Ae!="string"&&typeof Ae!="boolean")return[new a.V(ee.key,fe,"stop domain value must be a number, string, or boolean")];if(le!=="number"&&h!=="categorical"){let Ce=`number expected, ${le} found`;return a.O(o)&&h===void 0&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(ee.key,fe,Ce)]}return h!=="categorical"||le!=="number"||typeof Ae=="number"&&isFinite(Ae)&&Math.floor(Ae)===Ae?h!=="categorical"&&le==="number"&&typeof Ae=="number"&&typeof w=="number"&&w!==void 0&&Ae<w?[new a.V(ee.key,fe,"stop domain values must appear in ascending order")]:(w=Ae,h==="categorical"&&Ae in S?[new a.V(ee.key,fe,"stop domain values must be unique")]:(S[Ae]=!0,[])):[new a.V(ee.key,fe,`integer expected, found ${String(Ae)}`)]}}function Pn(p){const o=(p.expressionContext==="property"?a.W:a.X)(a.U(p.value),p.valueSpec);if(o.result==="error")return o.value.map(m=>new a.V(`${p.key}${m.key}`,p.value,m.message));const h=o.value.expression||o.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!h.outputDefined())return[new a.V(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!a.Y(h))return[new a.V(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter")return yn(h,p);if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!a.Z(h,["zoom","feature-state"]))return[new a.V(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!a._(h))return[new a.V(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function yn(p,o){const h=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const w of o.valueSpec.expression.parameters)h.delete(w);if(h.size===0)return[];const m=[];return p instanceof a.$&&h.has(p.name)?[new a.V(o.key,o.value,`["${p.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(p.eachChild(w=>{m.push(...yn(w,o))}),m)}function Ci(p){const o=p.key,h=p.value,m=p.valueSpec,w=[];return Array.isArray(m.values)?m.values.indexOf(a.M(h))===-1&&w.push(new a.V(o,h,`expected one of [${m.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(m.values).indexOf(a.M(h))===-1&&w.push(new a.V(o,h,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(h)} found`)),w}function Zn(p){return a.a1(a.U(p.value))?Pn(a.L({},p,{expressionContext:"filter",valueSpec:p.styleSpec[`filter_${p.layerType||"fill"}`]})):Vi(p)}function Vi(p){const o=p.value,h=p.key;if(a.J(o)!=="array")return[new a.V(h,o,`array expected, ${a.J(o)} found`)];const m=p.styleSpec;let w,E=[];if(o.length<1)return[new a.V(h,o,"filter array must have at least 1 element")];switch(E=E.concat(Ci({key:`${h}[0]`,value:o[0],valueSpec:m.filter_operator,style:p.style,styleSpec:p.styleSpec})),a.M(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&a.M(o[1])==="$type"&&E.push(new a.V(h,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&E.push(new a.V(h,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(w=a.J(o[1]),w!=="string"&&E.push(new a.V(`${h}[1]`,o[1],`string expected, ${w} found`)));for(let S=2;S<o.length;S++)w=a.J(o[S]),a.M(o[1])==="$type"?E=E.concat(Ci({key:`${h}[${S}]`,value:o[S],valueSpec:m.geometry_type,style:p.style,styleSpec:p.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&E.push(new a.V(`${h}[${S}]`,o[S],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let S=1;S<o.length;S++)E=E.concat(Vi({key:`${h}[${S}]`,value:o[S],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":w=a.J(o[1]),o.length!==2?E.push(new a.V(h,o,`filter array for "${o[0]}" operator must have 2 elements`)):w!=="string"&&E.push(new a.V(`${h}[1]`,o[1],`string expected, ${w} found`))}return E}function Ti(p,o){const h=p.key,m=p.style,w=p.layer,E=p.styleSpec,S=p.value,F=p.objectKey,D=E[`${o}_${p.layerType}`];if(!D)return[];const Q=F.match(/^(.*)-use-theme$/);if(o==="paint"&&Q&&D[Q[1]])return a.S(S)?[].concat(Nn({key:p.key,value:S,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:m,styleSpec:E,expressionContext:"property",propertyType:o,propertyKey:F})):Nn({key:h,value:S,valueSpec:{type:"string"},style:m,styleSpec:E});const V=F.match(/^(.*)-transition$/);if(o==="paint"&&V&&D[V[1]]&&D[V[1]].transition)return Nn({key:h,value:S,valueSpec:E.transition,style:m,styleSpec:E});const Z=p.valueSpec||D[F];if(!Z)return[new a.K(h,S,`unknown property "${F}"`)];let K;if(a.J(S)==="string"&&a.O(Z)&&!Z.tokens&&(K=/^{([^}]+)}$/.exec(S))){const he=`\`{ "type": "identity", "property": ${K?JSON.stringify(K[1]):'"_"'} }\``;return[new a.V(h,S,`"${F}" does not support interpolation syntax
Use an identity property function instead: ${he}.`)]}const ee=[];if(p.layerType==="symbol")F!=="text-field"||!m||m.glyphs||m.imports||ee.push(new a.V(h,S,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&a.a2(a.U(S))&&a.M(S.type)==="identity"&&ee.push(new a.V(h,S,'"text-font" does not support identity functions'));else if(p.layerType==="model"&&o==="paint"&&w&&w.layout&&w.layout.hasOwnProperty("model-id")&&a.O(Z)&&(a.a3(Z)||a.Q(Z))){const he=a.W(a.U(S),Z),le=he.value.expression||he.value._styleExpression.expression;le&&!a.Z(le,["measure-light"])&&(F==="model-emissive-strength"&&a._(le)&&a.Y(le)||ee.push(new a.V(h,S,`${F} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ee.concat(Nn({key:p.key,value:S,valueSpec:Z,style:m,styleSpec:E,expressionContext:"property",propertyType:o,propertyKey:F}))}function ui(p){return Ti(p,"paint")}function ta(p){return Ti(p,"layout")}function bi(p){let o=[];const h=p.value,m=p.key,w=p.style,E=p.styleSpec;h.type||h.ref||o.push(new a.V(m,h,'either "type" or "ref" is required'));let S=a.M(h.type);const F=a.M(h.ref);if(h.id){const D=a.M(h.id);for(let Q=0;Q<p.arrayIndex;Q++){const V=w.layers[Q];a.M(V.id)===D&&o.push(new a.V(m,h.id,`duplicate layer id "${h.id}", previously used at line ${V.id.__line__}`))}}if("ref"in h){let D;["type","source","source-layer","filter","layout"].forEach(Q=>{Q in h&&o.push(new a.V(m,h[Q],`"${Q}" is prohibited for ref layers`))}),w.layers.forEach(Q=>{a.M(Q.id)===F&&(D=Q)}),D?D.ref?o.push(new a.V(m,h.ref,"ref cannot reference another ref layer")):S=a.M(D.type):typeof F=="string"&&o.push(new a.V(m,h.ref,`ref layer "${F}" not found`))}else if(S!=="background"&&S!=="sky"&&S!=="slot")if(h.source){const D=w.sources&&w.sources[h.source],Q=D&&a.M(D.type);D?Q==="vector"&&S==="raster"?o.push(new a.V(m,h.source,`layer "${h.id}" requires a raster source`)):Q==="raster"&&S!=="raster"?o.push(new a.V(m,h.source,`layer "${h.id}" requires a vector source`)):Q!=="vector"||h["source-layer"]?Q==="raster-dem"&&S!=="hillshade"?o.push(new a.V(m,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):Q!=="raster-array"||["raster","raster-particle"].includes(S)?S==="line"&&h.paint&&(h.paint["line-gradient"]||h.paint["line-trim-offset"])&&Q==="geojson"&&!D.lineMetrics?o.push(new a.V(m,h,`layer "${h.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):S==="raster-particle"&&Q!=="raster-array"&&o.push(new a.V(m,h.source,`layer "${h.id}" requires a 'raster-array' source.`)):o.push(new a.V(m,h.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new a.V(m,h,`layer "${h.id}" must specify a "source-layer"`)):o.push(new a.V(m,h.source,`source "${h.source}" not found`))}else o.push(new a.V(m,h,'missing required property "source"'));return o=o.concat(En({key:m,value:h,valueSpec:E.layer,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Nn({key:`${m}.type`,value:h.type,valueSpec:E.layer.type,style:p.style,styleSpec:p.styleSpec,object:h,objectKey:"type"}),filter:D=>Zn(a.L({layerType:S},D)),layout:D=>En({layer:h,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":Q=>ta(a.L({layerType:S},Q))}}),paint:D=>En({layer:h,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":Q=>ui(a.L({layerType:S,layer:h},Q))}})}})),o}function ti(p){const o=p.value,h=p.key,m=a.J(o);return m!=="string"?[new a.V(h,o,`string expected, ${m} found`)]:[]}const vi={promoteId:function p({key:o,value:h}){if(a.J(h)==="string")return ti({key:o,value:h});if(Array.isArray(h)){const m=[],w=a.U(h),E=a.X(w);return E.result==="error"&&E.value.forEach(S=>{m.push(new a.V(`${o}${S.key}`,null,`${S.message}`))}),a.Z(E.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||m.push(new a.V(`${o}`,null,"promoteId expression should be only feature dependent")),m}{const m=[];for(const w in h)m.push(...p({key:`${o}.${w}`,value:h[w]}));return m}}};function Dn(p){const o=p.value,h=p.key,m=p.styleSpec,w=p.style;if(!o.type)return[new a.V(h,o,'"type" is required')];const E=a.M(o.type);let S=[];switch(["vector","raster","raster-dem","raster-array"].includes(E)&&(o.url||o.tiles||S.push(new a.K(h,o,'Either "url" or "tiles" is required.'))),E){case"vector":case"raster":case"raster-dem":case"raster-array":return S=S.concat(En({key:h,value:o,valueSpec:m[`source_${E.replace("-","_")}`],style:p.style,styleSpec:m,objectElementValidators:vi})),S;case"geojson":if(S=En({key:h,value:o,valueSpec:m.source_geojson,style:w,styleSpec:m,objectElementValidators:vi}),o.cluster)for(const F in o.clusterProperties){const[D,Q]=o.clusterProperties[F],V=typeof D=="string"?[D,["accumulated"],["get",F]]:D;S.push(...Pn({key:`${h}.${F}.map`,value:Q,expressionContext:"cluster-map"})),S.push(...Pn({key:`${h}.${F}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return S;case"video":return En({key:h,value:o,valueSpec:m.source_video,style:w,styleSpec:m});case"image":return En({key:h,value:o,valueSpec:m.source_image,style:w,styleSpec:m});case"canvas":return[new a.V(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ci({key:`${h}.type`,value:o.type,valueSpec:{values:ua(m)}})}}function ua(p){return p.source.reduce((o,h)=>{const m=p[h];return m.type.type==="enum"&&(o=o.concat(Object.keys(m.type.values))),o},[])}function ca(p){const o=p.value,h=p.styleSpec,m=h.light,w=p.style;let E=[];const S=a.J(o);if(o===void 0)return E;if(S!=="object")return E=E.concat([new a.V("light",o,`object expected, ${S} found`)]),E;for(const F in o){const D=F.match(/^(.*)-transition$/),Q=F.match(/^(.*)-use-theme$/);E=E.concat(Q&&m[Q[1]]?Nn({key:F,value:o[F],valueSpec:{type:"string"},style:w,styleSpec:h}):D&&m[D[1]]&&m[D[1]].transition?Nn({key:F,value:o[F],valueSpec:h.transition,style:w,styleSpec:h}):m[F]?Nn({key:F,value:o[F],valueSpec:m[F],style:w,styleSpec:h}):[new a.V(F,o[F],`unknown property "${F}"`)])}return E}function Gn(p){const o=p.value;let h=[];if(!o)return h;const m=a.J(o);if(m!=="object")return h=h.concat([new a.V("light-3d",o,`object expected, ${m} found`)]),h;const w=p.styleSpec,E=w["light-3d"],S=p.key,F=p.style,D=p.style.lights;for(const Z of["type","id"])if(!(Z in o))return h=h.concat([new a.V("light-3d",o,`missing property ${Z} on light`)]),h;if(o.type&&D)for(let Z=0;Z<p.arrayIndex;Z++){const K=a.M(o.type),ee=D[Z];a.M(ee.type)===K&&h.push(new a.V(S,o.id,`duplicate light type "${o.type}", previously defined at line ${ee.id.__line__}`))}const Q=`properties_light_${o.type}`;if(!(Q in w))return h=h.concat([new a.V("light-3d",o,`Invalid light type ${o.type}`)]),h;const V=w[Q];for(const Z in o)if(Z==="properties"){const K=o[Z],ee=a.J(K);if(ee!=="object")return h=h.concat([new a.V("properties",K,`object expected, ${ee} found`)]),h;for(const he in K){const le=he.match(/^(.*)-transition$/),Ae=he.match(/^(.*)-use-theme$/);h=h.concat(Ae&&V[Ae[1]]?Nn({key:Z,value:K[he],valueSpec:{type:"string"},style:F,styleSpec:w}):le&&V[le[1]]&&V[le[1]].transition?Nn({key:Z,value:o[Z],valueSpec:w.transition,style:F,styleSpec:w}):V[he]?Nn({key:he,value:K[he],valueSpec:V[he],style:F,styleSpec:w}):[new a.K(p.key,K[he],`unknown property "${he}"`)])}}else h=h.concat(E[Z]?Nn({key:Z,value:o[Z],valueSpec:E[Z],style:F,styleSpec:w}):[new a.K(Z,o[Z],`unknown property "${Z}"`)]);return h}function Li(p){const o=p.value,h=p.key,m=p.style,w=p.styleSpec,E=w.terrain;let S=[];const F=a.J(o);if(o===void 0||F==="null")return S;if(F!=="object")return S=S.concat([new a.V("terrain",o,`object expected, ${F} found`)]),S;for(const D in o){const Q=D.match(/^(.*)-transition$/),V=D.match(/^(.*)-use-theme$/);S=S.concat(V&&E[V[1]]?Nn({key:D,value:o[D],valueSpec:{type:"string"},style:m,styleSpec:w}):Q&&E[Q[1]]&&E[Q[1]].transition?Nn({key:D,value:o[D],valueSpec:w.transition,style:m,styleSpec:w}):E[D]?Nn({key:D,value:o[D],valueSpec:E[D],style:m,styleSpec:w}):[new a.K(D,o[D],`unknown property "${D}"`)])}if(o.source){const D=m.sources&&m.sources[o.source],Q=D&&a.M(D.type);D?Q!=="raster-dem"&&S.push(new a.V(h,o.source,`terrain cannot be used with a source of type ${String(Q)}, it only be used with a "raster-dem" source type`)):S.push(new a.V(h,o.source,`source "${o.source}" not found`))}else S.push(new a.V(h,o,'terrain is missing required property "source"'));return S}function xa(p){const o=p.value,h=p.style,m=p.styleSpec,w=m.fog;let E=[];const S=a.J(o);if(o===void 0)return E;if(S!=="object")return E=E.concat([new a.V("fog",o,`object expected, ${S} found`)]),E;for(const F in o){const D=F.match(/^(.*)-transition$/),Q=F.match(/^(.*)-use-theme$/);E=E.concat(Q&&w[Q[1]]?Nn({key:F,value:o[F],valueSpec:{type:"string"},style:h,styleSpec:m}):D&&w[D[1]]&&w[D[1]].transition?Nn({key:F,value:o[F],valueSpec:m.transition,style:h,styleSpec:m}):w[F]?Nn({key:F,value:o[F],valueSpec:w[F],style:h,styleSpec:m}):[new a.K(F,o[F],`unknown property "${F}"`)])}return E}const yi={"*":()=>[],array:$r,boolean:function(p){const o=p.value,h=p.key,m=a.J(o);return m!=="boolean"?[new a.V(h,o,`boolean expected, ${m} found`)]:[]},number:zn,color:function(p){const o=p.key,h=p.value,m=a.J(h);return m!=="string"?[new a.V(o,h,`color expected, ${m} found`)]:a.a0.parseCSSColor(h)===null?[new a.V(o,h,`color expected, "${h}" found`)]:[]},enum:Ci,filter:Zn,function:an,layer:bi,object:En,source:Dn,model:a.a4,light:ca,"light-3d":Gn,terrain:Li,fog:xa,string:ti,formatted:function(p){return ti(p).length===0?[]:Pn(p)},resolvedImage:function(p){return ti(p).length===0?[]:Pn(p)},projection:function(p){const o=p.value,h=p.styleSpec,m=h.projection,w=p.style;let E=[];const S=a.J(o);if(S==="object")for(const F in o)E=E.concat(Nn({key:F,value:o[F],valueSpec:m[F],style:w,styleSpec:h}));else S!=="string"&&(E=E.concat([new a.V("projection",o,`object or string expected, ${S} found`)]));return E},import:function(p){const{value:o,styleSpec:h}=p,{data:m,...w}=o;Object.defineProperty(w,"__line__",{value:o.__line__,enumerable:!1});let E=En(a.L({},p,{value:w,valueSpec:h.import}));return a.M(w.id)===""&&E.push(new a.V(`${p.key}.id`,w,"import id can't be an empty string")),m&&(E=E.concat(oo(m,h,{key:`${p.key}.data`}))),E},iconset:function(p){const o=p.value,h=p.key,m=p.styleSpec,w=p.style;if(!o.type)return[new a.V(h,o,'"type" is required')];const E=a.M(o.type);let S=[];if(S=S.concat(En({key:h,value:o,valueSpec:m[`iconset_${E}`],style:w,styleSpec:m})),E==="source"&&o.source){const F=w.sources&&w.sources[o.source],D=F&&a.M(F.type);F?D!=="raster-array"&&S.push(new a.V(h,o.source,`iconset cannot be used with a source of type ${String(D)}, it only be used with a "raster-array" source type`)):S.push(new a.V(h,o.source,`source "${o.source}" not found`))}return S}};function Nn(p,o=!1){const h=p.value,m=p.valueSpec,w=p.styleSpec;if(m.expression&&a.a2(a.M(h)))return an(p);if(m.expression&&a.S(a.U(h)))return Pn(p);if(m.type&&yi[m.type]){const E=yi[m.type](p);return o===!0&&E.length>0&&a.J(p.value)==="array"?Pn(p):E}return En(a.L({},p,{valueSpec:m.type?w[m.type]:m}))}function ki(p){const o=p.value,h=p.key,m=ti(p);return m.length||(o.indexOf("{fontstack}")===-1&&m.push(new a.V(h,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&m.push(new a.V(h,o,'"glyphs" url must include a "{range}" token'))),m}function oo(p,o=a.a5,h={}){return Nn({key:h.key||"",value:p,valueSpec:o.$root,styleSpec:o,style:p,objectElementValidators:{glyphs:ki,"*":()=>[]}})}function wa(p,o=a.a5){return rt(oo(p,o))}const ba=p=>rt(Dn(p)),Mi=p=>rt(ca(p)),Ea=p=>rt(Gn(p)),hr=p=>rt(Li(p)),Bo=p=>rt(xa(p)),xc=p=>rt(function(o){const h=o.value,m=o.style,w=o.styleSpec,E=w.snow;let S=[];const F=a.J(h);if(h===void 0)return S;if(F!=="object")return S=S.concat([new a.V("snow",h,`object expected, ${F} found`)]),S;for(const D in h){const Q=D.match(/^(.*)-transition$/);S=S.concat(Q&&E[Q[1]]&&E[Q[1]].transition?Nn({key:D,value:h[D],valueSpec:w.transition,style:m,styleSpec:w}):E[D]?Nn({key:D,value:h[D],valueSpec:E[D],style:m,styleSpec:w}):[new a.K(D,h[D],`unknown property "${D}"`)])}return S}(p)),sl=p=>rt(function(o){const h=o.value,m=o.style,w=o.styleSpec,E=w.rain;let S=[];const F=a.J(h);if(h===void 0)return S;if(F!=="object")return S=S.concat([new a.V("rain",h,`object expected, ${F} found`)]),S;for(const D in h){const Q=D.match(/^(.*)-transition$/);S=S.concat(Q&&E[Q[1]]&&E[Q[1]].transition?Nn({key:D,value:h[D],valueSpec:w.transition,style:m,styleSpec:w}):E[D]?Nn({key:D,value:h[D],valueSpec:E[D],style:m,styleSpec:w}):[new a.K(D,h[D],`unknown property "${D}"`)])}return S}(p)),_n=p=>rt(bi(p)),Tt=p=>rt(Zn(p)),pe=p=>rt(ui(p)),be=p=>rt(ta(p)),Ve=p=>rt(a.a4(p));function rt(p){return p.slice().sort((o,h)=>o.line&&h.line?o.line-h.line:0)}function je(p,o){let h=!1;if(o&&o.length)for(const m of o)m instanceof a.K?a.w(m.message):(p.fire(new a.z(new Error(m.message))),h=!0);return h}let oe;class Ee extends a.E{constructor(o,h="flat"){super(),this._transitionable=new a.a6(oe||(oe=new a.a7({anchor:new a.a8(a.a5.light.anchor),position:new a.a9(a.a5.light.position),color:new a.a8(a.a5.light.color),intensity:new a.a8(a.a5.light.intensity)}))),this.setLight(o,h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h,m={}){this._validate(Mi,o,m)||(this._transitionable.setTransitionOrValue(o),this.id=h)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,m){return(!m||m.validate!==!1)&&je(this,o.call(wa,a.h({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}}let me=class extends a.E{constructor(p,o,h,m,w){super(),this.scope=h,this._transitionable=new a.a6(new a.a7({source:new a.a8(a.a5.terrain.source),exaggeration:new a.a8(a.a5.terrain.exaggeration)}),h,m),this._transitionable.setTransitionOrValue(p,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o,this.worldview=w}get(){return this._transitionable.serialize()}set(p,o){this._transitionable.setTransitionOrValue(p,o)}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}getExaggeration(p){return this._transitioning.possiblyEvaluate(new a.aa(p,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const p=this._transitionable._values.exaggeration;if(!p)return null;const o=p.value.expression;if(!o)return null;let h=-1,m=-1,w=1;for(const E of o.zoomStops)w=o.evaluate(new a.aa(E,{worldview:this.worldview})),w>.01?(h=E,m=-1):m=E;return w<.01&&h>0&&m>h?[h,m]:null}isZoomDependent(){const p=this._transitionable._values.exaggeration;return p!=null&&p.value!=null&&p.value.expression!=null&&p.value.expression instanceof a.ab}};const xe=45,Ne=65,Oe=.05;function St(p,o,h,m){const w=a.af(xe,Ne,h),[E,S]=Ht(p,m);let F=1-Math.min(1,Math.exp((o-E)/(S-E)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*w*p.alpha}function Ht(p,o){const h=.5/Math.tan(.5*o);return[p.range[0]+h,p.range[1]+h]}function Rt(p,o,h,m,w){const E=a.ad([],[o,h,m],w.mercatorFogMatrix);return St(p,a.ae(E),w.pitch,w._fov)}function Vt(p,o,h,m,w,E,S){const F=[[h,m,0],[w,m,0],[w,E,0],[h,E,0]];let D=Number.MAX_VALUE,Q=-Number.MAX_VALUE;for(const V of F){const Z=a.ad([],V,o),K=a.ae(Z);D=Math.min(D,K),Q=Math.max(Q,K)}return[St(p,D,S.pitch,S._fov),St(p,Q,S.pitch,S._fov)]}class Gt extends a.E{constructor(o,h,m,w){super();const E=new a.a7({range:new a.a8(a.a5.fog.range),color:new a.a8(a.a5.fog.color),"color-use-theme":new a.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new a.a8(a.a5.fog["high-color"]),"high-color-use-theme":new a.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new a.a8(a.a5.fog["space-color"]),"space-color-use-theme":new a.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new a.a8(a.a5.fog["horizon-blend"]),"star-intensity":new a.a8(a.a5.fog["star-intensity"]),"vertical-range":new a.a8(a.a5.fog["vertical-range"])});this._transitionable=new a.a6(E,m,new Map(w)),this.set(o,w),this._transitioning=this._transitionable.untransitioned(),this._transform=h,this.properties=new a.ag(E),this.scope=m}get state(){const o=this._transform,h=o.projection.name==="globe",m=a.ah(o.zoom),w=this.properties.get("range"),E=[.5,3];return{range:h?[a.ai(E[0],w[0],m),a.ai(E[1],w[1],m)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,h,m={}){if(this._validate(Bo,o,m))return;const w=a.h({},o);for(const E of Object.keys(a.a5.fog))w[E]===void 0&&(w[E]=a.a5.fog[E].default);this._options=w,this._transitionable.setTransitionOrValue(this._options,h)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.af(xe,Ne,o))*h.a}getOpacityAtLatLng(o,h){return this._transform.projection.supportsFog?function(m,w,E){const S=a.ac.fromLngLat(w),F=E.elevation?E.elevation.getAtPointOrZero(S):0;return Rt(m,S.x,S.y,F,E)}(this.state,o,h):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];const h=this._transform.calculateFogTileMatrix(o.toUnwrapped());return Vt(this.state,h,0,0,a.aj,a.aj,this._transform)}getOpacityForBounds(o,h,m,w,E){return this._transform.projection.supportsFog?Vt(this.state,o,h,m,w,E,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?Ht(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;const h=[4,5,6,7];for(const m of h){const w=o.points[m];let E;if(w[2]>=0)E=w;else{const S=o.points[m-4];E=a.ak(S,w,S[2]/(S[2]-w[2]))}if(Rt(this.state,E[0],E[1],0,this._transform)>=Oe)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,m){return(!m||m.validate!==!1)&&je(this,o.call(wa,a.h({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}}let br,qr,Hr,Jr,en=class extends a.E{constructor(p,o,h,m){super();const w=br||(br=new a.a7({density:new a.a8(a.a5.snow.density),intensity:new a.a8(a.a5.snow.intensity),color:new a.a8(a.a5.snow.color),opacity:new a.a8(a.a5.snow.opacity),vignette:new a.a8(a.a5.snow.vignette),"vignette-color":new a.a8(a.a5.snow["vignette-color"]),"center-thinning":new a.a8(a.a5.snow["center-thinning"]),direction:new a.a8(a.a5.snow.direction),"flake-size":new a.a8(a.a5.snow["flake-size"])}));this._transitionable=new a.a6(w,h,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new a.ag(w),this.scope=h}get state(){const p=this.properties.get("opacity"),o=this.properties.get("color"),h=this.properties.get("direction"),m=a.al(h[0]),w=-Math.max(a.al(h[1]),.01),E=[Math.cos(m)*Math.cos(w),Math.sin(m)*Math.cos(w),Math.sin(w)],S=this.properties.get("vignette"),F=this.properties.get("vignette-color");return F.a=S,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new a.am(o.r,o.g,o.b,o.a*p),direction:E,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:F}}get(){return this._transitionable.serialize()}set(p,o,h={}){if(this._validate(xc,p,h))return;const m=a.h({},p);for(const w of Object.keys(a.a5.snow))m[w]===void 0&&(m[w]=a.a5.snow[w].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,o,h){return(!h||h.validate!==!1)&&je(this,p.call(wa,a.h({value:o,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}},Vn=class extends a.E{constructor(p,o,h,m){super();const w=qr||(qr=new a.a7({density:new a.a8(a.a5.rain.density),intensity:new a.a8(a.a5.rain.intensity),color:new a.a8(a.a5.rain.color),opacity:new a.a8(a.a5.rain.opacity),vignette:new a.a8(a.a5.rain.vignette),"vignette-color":new a.a8(a.a5.rain["vignette-color"]),"center-thinning":new a.a8(a.a5.rain["center-thinning"]),direction:new a.a8(a.a5.rain.direction),"droplet-size":new a.a8(a.a5.rain["droplet-size"]),"distortion-strength":new a.a8(a.a5.rain["distortion-strength"])}));this._transitionable=new a.a6(w,h,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new a.ag(w),this.scope=h}get state(){const p=this.properties.get("opacity"),o=this.properties.get("color"),h=this.properties.get("direction"),m=a.al(h[0]),w=-Math.max(a.al(h[1]),.01),E=[Math.cos(m)*Math.cos(w),Math.sin(m)*Math.cos(w),Math.sin(w)],S=this.properties.get("vignette-color");return S.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new a.am(o.r,o.g,o.b,o.a*p),direction:E,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:S}}get(){return this._transitionable.serialize()}set(p,o,h={}){if(this._validate(sl,p,h))return;const m=a.h({},p);for(const w of Object.keys(a.a5.rain))m[w]===void 0&&(m[w]=a.a5.rain[w].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,o,h){return(!h||h.validate!==!1)&&je(this,p.call(wa,a.h({value:o,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}};class Kn extends a.E{constructor(o,h,m,w){super(),this.scope=m,this._options=o,this.properties=new a.ag(h),this._transitionable=new a.a6(h,m,new Map(w)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,h){this._options=o,this._transitionable.setTransitionOrValue(o.properties,h)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Sn{constructor(o,h,m){this.screenBounds=o,this.cameraPoint=m.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=h,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,m)}static createFromScreenPoints(o,h){let m,w;if(o instanceof a.P||typeof o[0]=="number"){const E=a.P.convert(o);m=[E],w=h.isPointAboveHorizon(E)}else{const E=a.P.convert(o[0]),S=a.P.convert(o[1]),F=E.add(S)._div(2);m=[E,S],w=a.ao(E,S).every(D=>h.isPointAboveHorizon(D))&&h.isPointAboveHorizon(F)}return new Sn(m,w,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return a.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const h=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],w=a.ao(h,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<m.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?w[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(w[3]=this.cameraPoint)),a.ap(w,o)}bufferedCameraGeometryGlobe(o){const h=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],w=a.ao(h,m,o),E=this.cameraPoint.clone();switch(3*((E.y>h.y)+(E.y>m.y))+((E.x>h.x)+(E.x>m.x))){case 0:w[0]=E,w[4]=E.clone();break;case 1:w.splice(1,0,E);break;case 2:w[1]=E;break;case 3:w.splice(4,0,E);break;case 5:w.splice(2,0,E);break;case 6:w[3]=E;break;case 7:w.splice(3,0,E);break;case 8:w[2]=E}return w}containsTile(o,h,m,w=0){const E=o.queryPadding/h._pixelsPerMercatorPixel+1,S=m?this._bufferedCameraMercator(E,h):this._bufferedScreenMercator(E,h);let F=o.tileID.wrap+(S.unwrapped?w:0);const D=S.polygon.map(Ae=>a.aq(o.tileTransform,Ae,F));if(!a.ar(D,0,0,a.aj,a.aj))return;F=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const Q=this.screenGeometryMercator.polygon.map(Ae=>a.as(o.tileTransform,Ae,F)),V=Q.map(Ae=>new a.P(Ae[0],Ae[1])),Z=h.getFreeCameraOptions().position||new a.ac(0,0,0),K=a.as(o.tileTransform,Z,F),ee=Q.map(Ae=>{const fe=a.at(Ae,Ae,K);return a.au(fe,fe),new a.av(K,fe)}),he=a.aw(o,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:V,tilespaceRays:ee,bufferedTilespaceGeometry:D,bufferedTilespaceBounds:(le=a.ax(D),le.min.x=a.ay(le.min.x,0,a.aj),le.min.y=a.ay(le.min.y,0,a.aj),le.max.x=a.ay(le.max.x,0,a.aj),le.max.y=a.ay(le.max.y,0,a.aj),le),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:he};var le}_bufferedScreenMercator(o,h){const m=sa(o);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let w;return w=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),h):{polygon:this.bufferedScreenGeometry(o).map(E=>h.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[m]=w,w}}_bufferedCameraMercator(o,h){const m=sa(o);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let w;return w=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),h):{polygon:this.bufferedCameraGeometry(o).map(E=>h.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[m]=w,w}}_projectAndResample(o,h){const m=function(E,S){const F=a.az([],S.pixelMatrix,S.globeMatrix),D=[0,-a.aB,0,1],Q=[0,a.aB,0,1],V=[0,0,0,1];a.aA(D,D,F),a.aA(Q,Q,F),a.aA(V,V,F);const Z=new a.P(D[0]/D[3],D[1]/D[3]),K=new a.P(Q[0]/Q[3],Q[1]/Q[3]),ee=a.aC(E,Z)&&D[3]<V[3],he=a.aC(E,K)&&Q[3]<V[3];if(!ee&&!he)return null;const le=function(ct,Xe,Ye){for(let tt=1;tt<ct.length;tt++){const Pt=ha(Xe.pointCoordinate3D(ct[tt-1]).x),gt=ha(Xe.pointCoordinate3D(ct[tt]).x);if(Ye<0){if(Pt<gt)return{idx:tt,t:-Pt/(gt-1-Pt)}}else if(gt<Pt)return{idx:tt,t:(1-Pt)/(gt+1-Pt)}}return null}(E,S,ee?-1:1);if(!le)return null;const{idx:Ae,t:fe}=le;let Ce=Ae>1?Ii(E.slice(0,Ae),S):[],ke=Ae<E.length?Ii(E.slice(Ae),S):[];Ce=Ce.map(ct=>new a.P(ha(ct.x),ct.y)),ke=ke.map(ct=>new a.P(ha(ct.x),ct.y));const He=[...Ce];He.length===0&&He.push(ke[ke.length-1]);const $e=a.ai(He[He.length-1].y,(ke.length===0?Ce[0]:ke[0]).y,fe);let it;return it=ee?[new a.P(0,$e),new a.P(0,0),new a.P(1,0),new a.P(1,$e)]:[new a.P(1,$e),new a.P(1,1),new a.P(0,1),new a.P(0,$e)],He.push(...it),ke.length===0?He.push(Ce[0]):He.push(...ke),{polygon:He.map(ct=>new a.ac(ct.x,ct.y)),unwrapped:!1}}(o,h);if(m)return m;const w=function(E,S){let F=!1,D=-1/0,Q=0;for(let Z=0;Z<E.length-1;Z++)E[Z].x>D&&(D=E[Z].x,Q=Z);for(let Z=0;Z<E.length-1;Z++){const K=(Q+Z)%(E.length-1),ee=E[K],he=E[K+1];Math.abs(ee.x-he.x)>.5&&(ee.x<he.x?(ee.x+=1,K===0&&(E[E.length-1].x+=1)):(he.x+=1,K+1===E.length-1&&(E[0].x+=1)),F=!0)}const V=a.aD(S.center.lng);return F&&V<Math.abs(V-1)&&E.forEach(Z=>{Z.x-=1}),{polygon:E,unwrapped:F}}(Ii(o,h).map(E=>new a.P(ha(E.x),E.y)),h);return{polygon:w.polygon.map(E=>new a.ac(E.x,E.y)),unwrapped:w.unwrapped}}}function Ii(p,o){return a.aE(p,h=>{const m=o.pointCoordinate3D(h);h.x=m.x,h.y=m.y},1/256)}function ha(p){return p<0?1+p%1:p%1}function sa(p){return 100*p|0}function Ya(p,o,h,m,w){const E=function(F,D){if(F)return w(F);if(D){if(p.url&&D.tiles&&p.tiles&&delete p.tiles,D.variants){if(!Array.isArray(D.variants))return w(new Error("variants must be an array"));for(const V of D.variants){if(V==null||typeof V!="object"||V.constructor!==Object)return w(new Error("variant must be an object"));if(!Array.isArray(V.capabilities))return w(new Error("capabilities must be an array"));if(V.capabilities.length===1&&V.capabilities[0]==="meshopt"){D=a.h(D,V);break}}}const Q=a.aF(a.h({},D,p),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);Q.tiles=o.canonicalizeTileset(Q,p.url),w(null,Q)}},S=function(F,D,Q){if(!F)return null;if(!D&&!Q)return F;Q=Q||F.worldview_default;const V=Object.values(F.language||{});if(V.length===0)return null;const Z=Object.values(F.worldview||{});if(Z.length===0)return null;const K=V.every(he=>he===D),ee=Z.every(he=>he===Q);return K&&ee?F:D in(F.language_options||{})||Q in(F.worldview_options||{})?null:F.language_options&&F.worldview_options?F:null}(p.data,h,m);return S?a.q.frame(()=>E(null,S)):p.url?a.n(o.transformRequest(o.normalizeSourceURL(p.url,null,h,m),a.R.Source),E):a.q.frame(()=>{const{data:F,...D}=p;E(null,D)})}function Ra(p,o){const h=Math.pow(2,o.z),m=Math.floor(a.aD(p.getWest())*h),w=Math.floor(a.aH(p.getNorth())*h),E=Math.ceil(a.aD(p.getEast())*h),S=Math.ceil(a.aH(p.getSouth())*h);return o.x>=m&&o.x<E&&o.y>=w&&o.y<S}class es{constructor(o,h,m){this.bounds=o?a.aG.convert(this.validateBounds(o)):null,this.minzoom=h||0,this.maxzoom=m||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}addExtraBounds(o){if(o){this.extraBounds||(this.extraBounds=[]);for(const h of o)this.extraBounds.push(a.aG.convert(this.validateBounds(h)))}}contains(o){if(o.z>this.maxzoom||o.z<this.minzoom||this.bounds&&!Ra(this.bounds,o))return!1;if(!this.extraBounds)return!0;for(const h of this.extraBounds)if(Ra(h,o))return!0;return!1}static fromTileJSON(o){if(!o.bounds&&!o.extra_bounds)return null;const h=new es(o.bounds,o.minzoom,o.maxzoom);return h.addExtraBounds(o.extra_bounds),h}}class so extends a.E{constructor(o,h,m,w){if(super(),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.h(this,a.aF(h,["url","scheme","tileSize","promoteId"])),this._options=a.h({type:"vector"},h),this._collectResourceTiming=!!h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new a.aI}load(o){this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=Ya(this._options,this.map._requestManager,h,m,(w,E)=>{if(this._tileJSONRequest=null,this._loaded=!0,w)h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new a.z(w));else if(E){if(a.h(this,E),this.hasWorldviews=!!E.worldview_options,E.worldview_default&&(this.worldviewDefault=E.worldview_default),E.vector_layers){this.vectorLayers=E.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const S of E.vector_layers)this.vectorLayerIds.push(S.id),E.worldview&&E.worldview[S.source]&&this.localizableLayerIds.add(S.id)}this.tileBounds=es.fromTileJSON(E),ie(E.tiles,this.map._requestManager._customAccessToken),this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))}o&&o(w)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=a.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return a.h({},this._options)}loadTile(o,h){const m=o.tileID.canonical.url(this.tiles,this.scheme),w=this.map._requestManager.normalizeTileURL(m),E=this.map._requestManager.transformRequest(w,a.R.Tile),S=this.map.style?this.map.style.getLut(this.scope):null,F=S?{image:S.image.clone()}:null,D={request:E,data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,lut:F,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&a.j(m)&&(D.localizableLayerIds=this.localizableLayerIds),D.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",D,Q.bind(this));else if(o.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",D,Q.bind(this),void 0,!0);else{const V=a.aJ.call({deduped:this._deduped},D,(Z,K)=>{Z||!K?Q.call(this,Z):(D.data={cacheControl:K.cacheControl,expires:K.expires,rawData:K.rawData.slice(0)},o.actor&&o.actor.send("loadTile",D,Q.bind(this),void 0,!0))},!0);o.request={cancel:V}}function Q(V,Z){return delete o.request,o.aborted?h(null):V&&V.status!==404?h(V):(Z&&Z.resourceTiming&&(o.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&o.setExpiryData(Z),o.loadVectorData(Z,this.map.painter),a.aK(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,h){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ss extends a.E{constructor(o,h,m,w){super(),this.id=o,this.dispatcher=m,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.h({type:"raster"},h),a.h(this,a.aF(h,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"}));const h=this.map.getWorldview();this._tileJSONRequest=Ya(this._options,this.map._requestManager,null,h,(m,w)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new a.z(m)):w&&(a.h(this,w),w.raster_layers&&(this.rasterLayers=w.raster_layers,this.rasterLayerIds=this.rasterLayers.map(E=>E.id)),this.tileBounds=es.fromTileJSON(w),ie(w.tiles),this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))),o&&o(m)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=a.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return a.h({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){const m=a.q.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);o.request=a.o(this.map._requestManager.transformRequest(w,a.R.Tile),(E,S,F,D)=>(delete o.request,o.aborted?(o.state="unloaded",h(null)):E?(o.state="errored",h(E)):S?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:F,expires:D}),o.setTexture(S,this.map.painter),o.state="loaded",a.aK(this.dispatcher),void h(null)):h(null)))}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h&&h()}unloadTile(o,h){o.texture&&o.texture instanceof a.T?(o.destroy(!0),o.texture&&o.texture instanceof a.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),h&&h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Co extends Ss{constructor(o,h,m,w){super(o,h,m,w),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=a.h({type:"raster-array"},h)}triggerRepaint(o){const h=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);h&&h.enabled&&m&&h._clearRenderCacheForTile(m.id,o.tileID),this.map.triggerRepaint()}loadTile(o,h){const m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),w=this.map._requestManager.transformRequest(m,a.R.Tile),E={request:w,uid:o.uid,tileID:o.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};o.source=this.id,o.scope=this.scope,o.requestParams=w,o.actor||(o.actor=this.dispatcher.getActor());const S=(F,D,Q,V)=>{if(delete o.request,o.aborted)return o.state="unloaded",h(null);if(F)return F.name==="AbortError"?void 0:(o.state="errored",h(F));if(this.map._refreshExpiredTiles&&D&&o.setExpiryData({cacheControl:Q,expires:V}),this.partial)o.state="empty";else{if(!D)return h(null);o.state="loaded",o._isHeaderLoaded=!0,o._mrt=D}h(null)};o.request=this.partial?o.fetchHeader(void 0,S.bind(this)):o.actor.send("loadTile",E,S.bind(this),void 0,!0)}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,h){const m=o.texturePerLayer;if(o.flushAllQueues(),m.size){o.destroy(!0);for(const w of m.values())this.map.painter.saveTileTexture(w)}else o.destroy()}prepareTile(o,h,m,w){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBand(h,m,w,(E,S)=>{if(E)return o.state="errored",this.fire(new a.z(E)),void this.triggerRepaint(o);S&&(o._isHeaderLoaded=!0,o.setTexturePerLayer(m,S,this.map.painter),o.state="loaded",this.triggerRepaint(o))}))}getInitialBand(o){if(!this.rasterLayers)return 0;const h=this.rasterLayers.find(({id:E})=>E===o),m=h&&h.fields,w=m&&m.bands&&m.bands;return w?w[0]:0}getTextureDescriptor(o,h,m){if(!o)return;const w=h.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!w)return;let E=null;h instanceof a.aN?E=h.paint.get("raster-array-band"):h instanceof a.aO&&(E=h.paint.get("raster-particle-array-band"));const S=E||this.getInitialBand(w);if(S==null)return;if(!o.textureDescriptorPerLayer.get(h.id))return void this.prepareTile(o,w,h.id,S);if(o.updateNeeded(h.id,S)&&!m)return;const F=o.textureDescriptorPerLayer.get(h.id);return Object.assign({},F,{texture:o.texturePerLayer.get(h.id)})}getImages(o,h){const m=new Map;for(const w of o)for(const E of h){const[S,F]=E.split("/"),D=w.getLayer(S);if(!D||!D.hasBand(F)||!D.hasDataForBand(F))continue;const{bytes:Q,tileSize:V,buffer:Z}=D.getBandView(F),K=V+2*Z,ee={data:new a.r({width:K,height:K},Q),pixelRatio:2,sdf:!1,usvg:!1,version:0};m.set(E,ee)}return m}}const Rf={vector:so,raster:Ss,"raster-dem":class extends Ss{constructor(p,o,h,m){super(p,o,h,m),this.type="raster-dem",this.maxzoom=22,this._options=a.h({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(p,o){const h=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(w,E){w&&(p.state="errored",o(w)),E&&(p.dem=E,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",o(null))}p.request=a.o(this.map._requestManager.transformRequest(h,a.R.Tile),(function(w,E,S,F){if(delete p.request,p.aborted)p.state="unloaded",o(null);else if(w)p.state="errored",o(w);else if(E){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:S,expires:F});const D=ImageBitmap&&E instanceof ImageBitmap&&a.t(),Q=1-(E.width-a.aL(E.width))/2;Q<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const V=D?E:a.q.getImageData(E,Q),Z={uid:p.uid,tileID:p.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:V,encoding:this.encoding,padding:Q};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadTile",Z,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(p){const o=p.canonical,h=Math.pow(2,o.z),m=(o.x-1+h)%h,w=o.x===0?p.wrap-1:p.wrap,E=(o.x+1+h)%h,S=o.x+1===h?p.wrap+1:p.wrap,F={};return F[new a.aM(p.overscaledZ,w,o.z,m,o.y).key]={backfilled:!1},F[new a.aM(p.overscaledZ,S,o.z,E,o.y).key]={backfilled:!1},o.y>0&&(F[new a.aM(p.overscaledZ,w,o.z,m,o.y-1).key]={backfilled:!1},F[new a.aM(p.overscaledZ,p.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},F[new a.aM(p.overscaledZ,S,o.z,E,o.y-1).key]={backfilled:!1}),o.y+1<h&&(F[new a.aM(p.overscaledZ,w,o.z,m,o.y+1).key]={backfilled:!1},F[new a.aM(p.overscaledZ,p.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},F[new a.aM(p.overscaledZ,S,o.z,E,o.y+1).key]={backfilled:!1}),F}},"raster-array":Co,geojson:class extends a.E{constructor(p,o,h,m){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(m),this._data=o.data,this._options=a.h({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.minzoom!==void 0&&(this.minzoom=o.minzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const w=a.aj/this.tileSize;this.workerOptions=a.h({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*w,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*w,extent:a.aj,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:a.aj,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*w,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter,dynamic:o.dynamic},o.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}updateData(p){if(!this._options.dynamic)return this.fire(new a.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof p!="string"&&(p.type==="Feature"&&(p={type:"FeatureCollection",features:[p]}),p.type!=="FeatureCollection"))return this.fire(new a.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof p!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const o=new Map;for(const h of this._data.features)o.set(h.id,h);for(const h of p.features)o.set(h.id,h);this._data.features=[...o.values()]}else this._data=p;return this._updateWorkerData(!0),this}getClusterExpansionZoom(p,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id,scope:this.scope},o),this}getClusterChildren(p,o){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id,scope:this.scope},o),this}getClusterLeaves(p,o,h,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:p,limit:o,offset:h},m),this}_updateWorkerData(p=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.A("dataloading",{dataType:"source"})),this._loaded=!1;const o=a.h({append:p},this.workerOptions);o.scope=this.scope;const h=this._data;typeof h=="string"?(o.request=this.map._requestManager.transformRequest(a.q.resolveURL(h),a.R.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,(m,w)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new a.z(m));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(E.resourceTiming=w.resourceTiming[this.id]),p&&(this._partialReload=!0),this.fire(new a.A("data",E)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(p),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const p=a.C(this.id,this.scope);this.map.style.clearSource(p),this._updateWorkerData()}loadTile(p,o){const h=p.actor?"reloadTile":"loadTile";p.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,w=m?{image:m.image.clone()}:null,E=this._partialReload,S={type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:w,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:p.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:E,worldview:this.map.getWorldview()};p.request=this.actor.send(h,S,(F,D)=>E&&!D?(p.state="loaded",o(null)):(delete p.request,p.destroy(),p.aborted?o(null):F?o(F):(p.loadVectorData(D,this.map.painter,h==="reloadTile"),o(null))),void 0,h==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p,o){this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id,scope:this.scope}),p.destroy()}onRemove(p){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.h({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.aP{constructor(p,o,h,m){super(p,o,h,m),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const o of p.urls)this.urls.push(this.map._requestManager.transformRequest(o,a.R.Source).url);a.aQ(this.urls,(o,h)=>{this._loaded=!0,o?this.fire(new a.z(o)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const o=this.video.seekable;p<o.start(0)||p>o.end(0)?this.fire(new a.z(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,o=p.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(p,this.video,o.RGBA8),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.aP,model:class extends a.E{constructor(p,o,h,m){super(),this.id=p,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){const p=[];for(const o in this._options.models){const h=this._options.models[o],m=a.aS(this.map._requestManager.transformRequest(h.uri,a.R.Model).url).then(w=>{if(!w)return;const E=a.aT(w),S=new a.aU(o,h.position,h.orientation,E);S.computeBoundsAndApplyParent(),this.models.push(S)}).catch(w=>{this.fire(new a.z(new Error(`Could not load model ${o} from ${h.uri}: ${w.message}`)))});p.push(m)}Promise.allSettled(p).then(()=>{this._loaded=!0,this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(o=>{this._loaded=!0,this.fire(new a.z(new Error(`Could not load models: ${o.message}`)))})}onAdd(p){this.map=p,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(p,o){}serialize(){return this._options}},"batched-model":class extends a.E{constructor(p,o,h,m){super(),this.type="batched-model",this.id=p,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=h,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(p){this.map=p,this.load()}reload(){this.cancelTileJSONRequest();const p=a.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(p))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(p){this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map.getWorldview();this._tileJSONRequest=Ya(this._options,this.map._requestManager,o,h,(m,w)=>{this._tileJSONRequest=null,this._loaded=!0,m?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new a.z(m))):w&&(a.h(this,w),w.bounds&&(this.tileBounds=new es(w.bounds,this.minzoom,this.maxzoom)),ie(w.tiles,this.map._requestManager._customAccessToken),this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))),p&&p(m)})}hasTransition(){return!1}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}loaded(){return this._loaded}loadTile(p,o){const h=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(h,a.R.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:p.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:a.q.devicePixelRatio,promoteId:this.promoteId};if(p.actor&&p.state!=="expired")if(p.state==="loading")p.reloadCallback=o;else{if(p.buckets){const E=Object.values(p.buckets);for(const S of E)S.dirty=!0;return void(p.state="loaded")}p.request=p.actor.send("reloadTile",m,w.bind(this))}else p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",m,w.bind(this),void 0,!0);function w(E,S){return p.aborted?o(null):E&&E.status!==404?o(E):(this.map._refreshExpiredTiles&&S&&p.setExpiryData(S),p.loadModelData(S,this.map.painter),p.state="loaded",void o(null))}}serialize(){return a.h({},this._options)}},canvas:class extends a.aP{constructor(p,o,h,m){super(p,o,h,m),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(E=>typeof E!="number"))||this.fire(new a.z(new a.V(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.z(new a.V(`sources.${p}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new a.z(new a.V(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new a.z(new a.V(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.z(new a.V(`sources.${p}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(p){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?!p&&!this._playing||this.texture instanceof a.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(o,this.canvas,o.gl.RGBA8,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends a.E{constructor(p,o,h,m){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=o,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new es(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),a.h(this,a.aF(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this.map=p,this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:o,y:h,z:m}=p.canonical;return this._implementation.hasTile({x:o,y:h,z:m})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,o){const{x:h,y:m,z:w}=p.tileID.canonical,E=new AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:h,y:m,z:w},{signal:E.signal})).then((function(S){return delete p.request,p.aborted?(p.state="unloaded",o(null)):S===void 0?(p.state="errored",o(null)):S===null?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",o(null)):function(F){return F instanceof ImageData||F instanceof HTMLCanvasElement||F instanceof ImageBitmap||F instanceof HTMLImageElement}(S)?(this.loadTileData(p,S),p.state="loaded",void o(null)):(p.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(S=>{S.name!=="AbortError"&&(p.state="errored",o(S))}),p.request.cancel=()=>E.abort()}loadTileData(p,o){p.setTexture(o,this.map.painter)}unloadTile(p,o){if(p.texture&&p.texture instanceof a.T?(p.destroy(!0),p.texture&&p.texture instanceof a.T&&this.map.painter.saveTileTexture(p.texture)):p.destroy(),this._implementation.unloadTile){const{x:h,y:m,z:w}=p.tileID.canonical;this._implementation.unloadTile({x:h,y:m,z:w})}o&&o()}abortTile(p,o){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),o&&o()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){const p=a.C(this.id,this.scope);this.map.style.clearSource(p)}_update(){this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))}}},Hu=function(p,o,h,m){const w=new Rf[o.type](p,o,h,m);if(w.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${w.id}`);return a.aV(["load","abort","unload","serialize","prepare"],w),w};function Ul(p,o,h=""){return`${h}:${o.id||""}:${o.layer.id}:${function(m){if("layerId"in m)return`layer:${m.layerId}`;{const{featuresetId:w,importId:E}=m;return`featureset:${w}${E?`:import:${E}`:""}`}}(p.target)}`}function wc(p,o,h,m=""){if(p.uniqueFeatureID){const w=Ul(p,o,m);if(h.has(w))return!0;h.add(w)}return!1}function Cl(p,o,h,m,w=!1){const E=o.sourceCache.transform,S=o.sourceCache.tilesIn(p,o.has3DLayers,w);S.sort(fh);const F=[];for(const D of S){const Q=D.tile.queryRenderedFeatures(o,D,h,m,E,w);Object.keys(Q).length&&F.push({wrappedTileID:D.tile.tileID.wrapped().key,queryResults:Q})}return F.length===0?{}:function(D){const Q={},V={};for(const Z of D){const K=Z.queryResults,ee=Z.wrappedTileID,he=V[ee]=V[ee]||{};for(const le in K){const Ae=K[le],fe=he[le]=he[le]||{},Ce=Q[le]=Q[le]||[];for(const ke of Ae)fe[ke.featureIndex]||(fe[ke.featureIndex]=!0,Ce.push(ke))}}return Q}(F)}function qc(p,o,h,m,w,E){const S={},F=m.queryRenderedSymbols(p),D=[];for(const Q of Object.keys(F).map(Number))D.push(w[Q]);D.sort(fh);for(const Q of D){const V=Q.featureIndex.lookupSymbolFeatures(F[Q.bucketInstanceId],Q.bucketIndex,Q.sourceLayerIndex,o,h,E);for(const Z in V){const K=S[Z]=S[Z]||[],ee=V[Z];ee.sort((he,le)=>{const Ae=Q.featureSortOrder;if(Ae){const fe=Ae.indexOf(he.featureIndex);return Ae.indexOf(le.featureIndex)-fe}return le.featureIndex-he.featureIndex});for(const he of ee)K.push(he)}}return S}function No(p,o){const h=p.getRenderableIds().map(E=>p.getTileByID(E)),m=[],w={};for(let E=0;E<h.length;E++){const S=h[E],F=S.tileID.canonical.key;w[F]||(w[F]=!0,S.querySourceFeatures(m,o))}return m}function fh(p,o){const h=p.tileID,m=o.tileID;return h.overscaledZ-m.overscaledZ||h.canonical.y-m.canonical.y||h.wrap-m.wrap||h.canonical.x-m.canonical.x}function bc(p,o){const h={};if(!o)return h;for(const m of p){const w=m.layerIds.map(E=>o.getLayer(E)).filter(Boolean);if(w.length!==0){m.layers=w,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(E=>w.filter(S=>S.id===E)[0]));for(const E of w)h[E.fqid]=m}}return h}const Sl=32,ll=33,cl=new Uint16Array(8184);for(let p=0;p<2046;p++){let o=p+2,h=0,m=0,w=0,E=0,S=0,F=0;for(1&o?w=E=S=Sl:h=m=F=Sl;(o>>=1)>1;){const Q=h+w>>1,V=m+E>>1;1&o?(w=h,E=m,h=S,m=F):(h=w,m=E,w=S,E=F),S=Q,F=V}const D=4*p;cl[D+0]=h,cl[D+1]=m,cl[D+2]=w,cl[D+3]=E}const Nl=new Uint16Array(2178),ma=new Uint8Array(1089),$c=new Uint16Array(1089);function ec(p){return p===0?-.03125:p===32?.03125:0}const Nh={type:2,extent:a.aj,loadGeometry:()=>[[new a.P(0,0),new a.P(a.aj+1,0),new a.P(a.aj+1,a.aj+1),new a.P(0,a.aj+1),new a.P(0,0)]]};class Ah{constructor(o,h,m,w,E,S){this.tileID=o,this.uid=a.a$(),this.uses=0,this.tileSize=h,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=E,w&&w.style&&(this._lastUpdatedBrightness=w.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",w&&w.transform&&(this.projection=w.transform.projection),this.worldview=S}registerFadeDuration(o){const h=o+this.timeAdded;h<a.q.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=a.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,h,m){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=bc(o.buckets,h.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const E=this.buckets[w];if(E instanceof a.b1){if(this.hasSymbolBuckets=!0,!m)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const E=this.buckets[w];if(E instanceof a.b1&&E.hasRTLText){this.hasRTLText=!0,a.b2();break}}this.queryPadding=0;for(const w in this.buckets){const E=this.buckets[w],S=h.style.getOwnLayer(w);if(!S)continue;const F=S.queryRadius(E);this.queryPadding=Math.max(this.queryPadding,F)}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas),this._lastUpdatedBrightness=o.brightness}else this.collisionBoxArray=new a.b0}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(o,h,m){o&&(o.resourceTiming&&(this.resourceTiming=o.resourceTiming),this.buckets=Object.assign({},this.buckets,bc(o.buckets,h.style)),o.featureIndex&&(this.latestFeatureIndex=o.featureIndex))}getBucket(o){return this.buckets[o.fqid]}upload(o){for(const w in this.buckets){const E=this.buckets[w];E.uploadPending()&&E.upload(o)}const h=o.gl,m=this.imageAtlas;m&&!m.uploaded&&(this.imageAtlasTexture=new a.T(o,m.image,h.RGBA8,{useMipmap:!!m.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(o,this.glyphAtlasImage,h.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new a.T(o,this.lineAtlas.image,h.R8),this.lineAtlas.uploaded=!0)}prepare(o,h,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture,m),!h||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const w=h.style.getBrightness();(this._lastUpdatedBrightness||w)&&(this._lastUpdatedBrightness&&w&&Math.abs(this._lastUpdatedBrightness-w)<.001||(this.updateBuckets(h,this._lastUpdatedBrightness!==w),this._lastUpdatedBrightness=w))}queryRenderedFeatures(o,h,m,w,E,S){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const F=function(D,Q){const V=a.bn([],[.5*D.width,.5*-D.height,1]);return a.bo(V,V,[1,-1,0]),a.az(V,V,D.calculateProjMatrix(Q.toUnwrapped())),Float32Array.from(V)}(E,this.tileID);return this.latestFeatureIndex.query(o,{tilespaceGeometry:h,pixelPosMatrix:F,transform:w,availableImages:m,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(o,h){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const w=m.loadVTLayers(),E=h?h.sourceLayer:"",S=w._geojsonTileLayer||w[E];if(!S)return;const F=a.b3(h&&h.filter),{z:D,x:Q,y:V}=this.tileID.canonical,Z={z:D,x:Q,y:V};for(let K=0;K<S.length;K++){const ee=S.feature(K);if(F.needGeometry){const Ae=a.b4(ee,!0);if(!F.filter(new a.aa(this.tileID.overscaledZ,{worldview:this.worldview}),Ae,this.tileID.canonical))continue}else if(!F.filter(new a.aa(this.tileID.overscaledZ,{worldview:this.worldview}),ee))continue;const he=m.getId(ee,E),le=new a.b5(ee,D,Q,V,he);le.tile=Z,o.push(le)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(o){const h=this.expirationTime;if(o.cacheControl){const m=a.b6(o.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const m=Date.now();let w=!1;if(this.expirationTime>m)w=!1;else if(h)if(this.expirationTime<h)w=!0;else{const E=this.expirationTime-h;E?this.expirationTime=m+Math.max(E,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(o){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&o&&this.updateBuckets(o)}updateBuckets(o,h){if(!this.latestFeatureIndex||!o.style)return;const m=this.latestFeatureIndex.loadVTLayers(),w=o.style.listImages(),E=o.style.getBrightness();for(const S in this.buckets){if(!o.style.hasLayer(S))continue;const F=this.buckets[S],D=F.layers[0],Q=D.sourceLayer||"_geojsonTileLayer",V=m[Q],Z=o.style.getLayerSourceCache(D);let K={};Z&&(K=Z._state.getState(Q,void 0));const ee=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},he=Object.keys(K).length>0&&!h;he&&!F.stateDependentLayers.length&&!h||F.update(K,V,w,ee,he?F.stateDependentLayers:F.layers,h,E),(F instanceof a.b7||F instanceof a.b8)&&o._terrain&&o._terrain.enabled&&Z&&F.uploadPending()&&o._terrain._clearRenderCacheForTile(Z.id,this.tileID);const le=o&&o.style&&o.style.getOwnLayer(S);le&&(this.queryPadding=Math.max(this.queryPadding,le.queryRadius(F)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=a.q.now()+o}setTexture(o,h){const m=h.context,w=m.gl;this.texture=this.texture||h.getTileTexture(o.width),this.texture&&this.texture instanceof a.T?this.texture.update(o):(this.texture=new a.T(m,o,w.RGBA8,{useMipmap:!0}),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE))}setDependencies(o,h){const m={};for(const w of h)m[w]=!0;this.dependencies[o]=m}hasDependency(o,h){for(const m of o){const w=this.dependencies[m];if(w){for(const E of h)if(w[E])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,h){if(!h||h.name==="mercator"||this._tileDebugBuffer)return;const m=a.b9(Nh,this.tileID.canonical,this.tileTransform)[0],w=new a.ba,E=new a.bb;for(let S=0;S<m.length;S++){const{x:F,y:D}=m[S];w.emplaceBack(F,D),E.emplaceBack(S)}E.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(E),this._tileDebugBuffer=o.createVertexBuffer(w,a.bc.members),this._tileDebugSegments=a.bd.simpleSegment(0,0,w.length,E.length)}_makeTileBoundsBuffers(o,h){if(this._tileBoundsBuffer||!h||h.name==="mercator")return;const m=a.b9(Nh,this.tileID.canonical,this.tileTransform)[0];let w,E;if(this.isRaster){const S=function(F,D){const Q=a.aW(F,D),V=Math.pow(2,F.z);for(let Ae=0;Ae<ll;Ae++)for(let fe=0;fe<ll;fe++){const Ce=a.aX((F.x+(fe+ec(fe))/Sl)/V),ke=a.aY((F.y+(Ae+ec(Ae))/Sl)/V),He=D.project(Ce,ke),$e=Ae*ll+fe;Nl[2*$e+0]=Math.round((He.x*Q.scale-Q.x)*a.aj),Nl[2*$e+1]=Math.round((He.y*Q.scale-Q.y)*a.aj)}ma.fill(0),$c.fill(0);for(let Ae=2045;Ae>=0;Ae--){const fe=4*Ae,Ce=cl[fe+0],ke=cl[fe+1],He=cl[fe+2],$e=cl[fe+3],it=Ce+He>>1,ct=ke+$e>>1,Xe=it+ct-ke,Ye=ct+Ce-it,tt=ke*ll+Ce,Pt=$e*ll+He,gt=ct*ll+it,Jt=Math.hypot((Nl[2*tt+0]+Nl[2*Pt+0])/2-Nl[2*gt+0],(Nl[2*tt+1]+Nl[2*Pt+1])/2-Nl[2*gt+1])>=16;ma[gt]=ma[gt]||(Jt?1:0),Ae<1022&&(ma[gt]=ma[gt]||ma[(ke+Ye>>1)*ll+(Ce+Xe>>1)]||ma[($e+Ye>>1)*ll+(He+Xe>>1)])}const Z=new a.aZ,K=new a.a_;let ee=0;function he(Ae,fe){const Ce=fe*ll+Ae;return $c[Ce]===0&&(Z.emplaceBack(Nl[2*Ce+0],Nl[2*Ce+1],Ae*a.aj/Sl,fe*a.aj/Sl),$c[Ce]=++ee),$c[Ce]-1}function le(Ae,fe,Ce,ke,He,$e){const it=Ae+Ce>>1,ct=fe+ke>>1;if(Math.abs(Ae-He)+Math.abs(fe-$e)>1&&ma[ct*ll+it])le(He,$e,Ae,fe,it,ct),le(Ce,ke,He,$e,it,ct);else{const Xe=he(Ae,fe),Ye=he(Ce,ke),tt=he(He,$e);K.emplaceBack(Xe,Ye,tt)}}return le(0,0,Sl,Sl,Sl,0),le(Sl,Sl,0,0,0,Sl),{vertices:Z,indices:K}}(this.tileID.canonical,h);w=S.vertices,E=S.indices}else{w=new a.aZ,E=new a.a_;for(const{x:F,y:D}of m)w.emplaceBack(F,D,0,0);const S=a.be(w.int16.subarray(0,4*w.length),void 0,4);for(let F=0;F<S.length;F+=3)E.emplaceBack(S[F],S[F+1],S[F+2])}this._tileBoundsBuffer=o.createVertexBuffer(w,a.bf.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(E),this._tileBoundsSegments=a.bd.simpleSegment(0,0,w.length,E.length)}_makeGlobeTileDebugBuffers(o,h){const m=h.projection;if(!m||m.name!=="globe"||h.freezeTileCoverage)return;const w=this.tileID.canonical,E=a.bg(w,h),S=a.bh(E),F=a.ah(h.zoom);let D;F>0&&(D=a.bi(new Float64Array(16),h.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,w,h,S,D,F),this._makeGlobeTileDebugTextBuffer(o,w,h,S,D,F)}_globePoint(o,h,m,w,E,S,F){let D=a.bj(o,h,m);if(S){const Q=1<<m.z,V=a.aD(w.center.lng),Z=a.aH(w.center.lat),K=(m.x+.5)/Q-V;let ee=0;K>.5?ee=-1:K<-.5&&(ee=1);let he=(o/a.aj+m.x)/Q+ee,le=(h/a.aj+m.y)/Q;he=(he-V)*w._pixelsPerMercatorPixel+V,le=(le-Z)*w._pixelsPerMercatorPixel+Z;const Ae=[he*w.worldSize,le*w.worldSize,0];a.ad(Ae,Ae,S),D=a.bk(D,Ae,F)}return a.ad(D,D,E)}_makeGlobeTileDebugBorderBuffer(o,h,m,w,E,S){const F=new a.ba,D=new a.bb,Q=new a.bl,V=(K,ee,he,le,Ae)=>{const fe=(he-K)/(Ae-1),Ce=(le-ee)/(Ae-1),ke=F.length;for(let He=0;He<Ae;He++){const $e=K+He*fe,it=ee+He*Ce;F.emplaceBack($e,it);const ct=this._globePoint($e,it,h,m,w,E,S);Q.emplaceBack(ct[0],ct[1],ct[2]),D.emplaceBack(ke+He)}},Z=a.aj;V(0,0,Z,0,16),V(Z,0,Z,Z,16),V(Z,Z,0,Z,16),V(0,Z,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(D),this._tileDebugBuffer=o.createVertexBuffer(F,a.bc.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(Q,a.bm.members),this._tileDebugSegments=a.bd.simpleSegment(0,0,F.length,D.length)}_makeGlobeTileDebugTextBuffer(o,h,m,w,E,S){const F=a.aj/4,D=new a.ba,Q=new a.a_,V=new a.bl,Z=25;Q.reserve(32),D.reserve(Z),V.reserve(Z);const K=(ee,he)=>Z*ee+he;for(let ee=0;ee<Z;ee++){const he=ee*F;for(let le=0;le<Z;le++){const Ae=le*F;D.emplaceBack(Ae,he);const fe=this._globePoint(Ae,he,h,m,w,E,S);V.emplaceBack(fe[0],fe[1],fe[2])}}for(let ee=0;ee<4;ee++)for(let he=0;he<4;he++){const le=K(ee,he),Ae=K(ee,he+1),fe=K(ee+1,he),Ce=K(ee+1,he+1);Q.emplaceBack(le,Ae,fe),Q.emplaceBack(fe,Ae,Ce)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(Q),this._tileDebugTextBuffer=o.createVertexBuffer(D,a.bc.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(V,a.bm.members),this._tileDebugTextSegments=a.bd.simpleSegment(0,0,Z,32)}destroy(o=!1){for(const h in this.buckets)this.buckets[h].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!o&&this.texture&&this.texture instanceof a.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}a.bp.setPbf(a.bq);class zh extends Ah{constructor(o,h,m,w,E){super(o,h,m,w,E),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(o){return this._mrt&&this._mrt.getLayer(o)}setTexturePerLayer(o,h,m){const w=m.context,E=w.gl;let S=this.texturePerLayer.get(o)||m.getTileTexture(h.width);S&&S instanceof a.T?S.update(h,{premultiply:!1}):S=new a.T(w,h,E.RGBA8,{premultiply:!1}),this.texturePerLayer.has(o)||this.texturePerLayer.set(o,S)}flushQueues(o){const h=this._workQueuePerLayer.get(o)||[],m=this._fetchQueuePerLayer.get(o)||[];for(;h.length;)h.pop()();for(;m.length;)m.pop()()}flushAllQueues(){for(const o of this._workQueuePerLayer.keys()){const h=this._workQueuePerLayer.get(o)||[];for(;h.length;)h.pop()()}for(const o of this._fetchQueuePerLayer.keys()){const h=this._fetchQueuePerLayer.get(o)||[];for(;h.length;)h.pop()()}}fetchHeader(o=16384,h){const m=this._mrt=new a.bp(30),w=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(o-1)}});return this.entireBuffer=null,this.request=a.br(w,(E,S,F,D)=>{if(E)h(E);else try{const Q=m.getHeaderLength(S);if(Q>o)return void(this.request=this.fetchHeader(Q,h));m.parseHeader(S),this._isHeaderLoaded=!0;let V=0;for(const Z of Object.values(m.layers))V=Math.max(V,Z.dataIndex[Z.dataIndex.length-1].lastByte);S.byteLength>=V&&(this.entireBuffer=S),h(null,this.entireBuffer||S,F,D)}catch(Q){h(Q)}}),this.request}fetchBand(o,h,m,w){const E=this._mrt;if(!this._isHeaderLoaded||!E)return void w(new Error("Tile header is not ready"));const S=this.actor;if(!S)return void w(new Error("Can't fetch tile band without an actor"));let F;const D=(K,ee)=>{if(F.complete(K,ee),K)return void w(K);this.updateTextureDescriptor(o,h,m);const he=this.textureDescriptorPerLayer.get(h);w(null,he&&he.img)},Q=(K,ee)=>{if(K)return w(K);const he=S.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:ee,task:F},D,void 0,!0),le=this._workQueuePerLayer.get(h)||[];le.push(()=>{he&&he.cancel(),F.cancel()}),this._workQueuePerLayer.has(h)||this._workQueuePerLayer.set(h,le)},V=E.getLayer(o);if(!V)return void w(new Error(`Unknown sourceLayer "${o}"`));if(V.hasDataForBand(m)){this.updateTextureDescriptor(o,h,m);const K=this.textureDescriptorPerLayer.get(h);return void w(null,K?K.img:null)}const Z=V.getDataRange([m]);if(F=E.createDecodingTask(Z),!F||F.tasks.length)if(this.flushQueues(h),this.entireBuffer)Q(null,this.entireBuffer.slice(Z.firstByte,Z.lastByte+1));else{const K=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Z.firstByte}-${Z.lastByte}`}}),ee=a.br(K,Q),he=this._fetchQueuePerLayer.get(h)||[];he.push(()=>{ee.cancel(),F.cancel()}),this._fetchQueuePerLayer.has(h)||this._fetchQueuePerLayer.set(h,he)}else w(null)}updateNeeded(o,h){return(!this.textureDescriptorPerLayer.get(o)||this.textureDescriptorPerLayer.get(o).band!==h)&&this.state!=="errored"}updateTextureDescriptor(o,h,m){if(!this._mrt)return;const w=this._mrt.getLayer(o);if(!w||!w.hasBand(m)||!w.hasDataForBand(m))return;const{bytes:E,tileSize:S,buffer:F,offset:D,scale:Q}=w.getBandView(m),V=S+2*F,Z=new a.r({width:V,height:V},E),K=this.texturePerLayer.get(h);K&&K instanceof a.T&&K.update(Z,{premultiply:!1}),this.textureDescriptorPerLayer.set(h,{layer:o,band:m,img:Z,buffer:F,offset:D,tileSize:S,format:w.pixelFormat,mix:[Q,256*Q,65536*Q,16777216*Q]})}destroy(o=!1){if(super.destroy(o),delete this._mrt,!o)for(const h of this.texturePerLayer.values())h&&h instanceof a.T&&h.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class hf{constructor(o,h){this.max=o,this.onRemove=h,this.reset()}reset(){for(const o in this.data)for(const h of this.data[o])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(o,h,m){const w=o.wrapped().key;this.data[w]===void 0&&(this.data[w]=[]);const E={value:h,timeout:void 0};if(m!==void 0&&(E.timeout=setTimeout(()=>{this.remove(o,E)},m)),this.data[w].push(E),this.order.push(w),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const h=this.data[o].shift();return h.timeout&&clearTimeout(h.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),h.value}getByKey(o){const h=this.data[o];return h?h[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,h){if(!this.has(o))return this;const m=o.wrapped().key,w=h===void 0?0:this.data[m].indexOf(h),E=this.data[m][w];return this.data[m].splice(w,1),E.timeout&&clearTimeout(E.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(E.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(o){const h=[];for(const m in this.data)for(const w of this.data[m])o(w.value)||h.push(w);for(const m of h)this.remove(m.value.tileID,m)}}class Vu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,h,m){const w=String(h);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][w]=this.stateChanges[o][w]||{},a.h(this.stateChanges[o][w],m),this.deletedStates[o]===null){this.deletedStates[o]={};for(const E in this.state[o])E!==w&&(this.deletedStates[o][E]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][w]===null){this.deletedStates[o][w]={};for(const E in this.state[o][w])m[E]||(this.deletedStates[o][w][E]=null)}else for(const E in m)this.deletedStates[o]&&this.deletedStates[o][w]&&this.deletedStates[o][w][E]===null&&delete this.deletedStates[o][w][E]}removeFeatureState(o,h,m){if(this.deletedStates[o]===null)return;const w=String(h);if(this.deletedStates[o]=this.deletedStates[o]||{},m&&h!==void 0)this.deletedStates[o][w]!==null&&(this.deletedStates[o][w]=this.deletedStates[o][w]||{},this.deletedStates[o][w][m]=null);else if(h!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][w])for(m in this.deletedStates[o][w]={},this.stateChanges[o][w])this.deletedStates[o][w][m]=null;else this.deletedStates[o][w]=null;else this.deletedStates[o]=null}getState(o,h){const m=this.state[o]||{},w=this.stateChanges[o]||{},E=this.deletedStates[o];if(E===null)return{};if(h!==void 0){const F=String(h),D=a.h({},m[F],w[F]);if(E){const Q=E[h];if(Q===null)return{};for(const V in Q)delete D[V]}return D}const S=a.h({},m,w);if(E)for(const F in E)delete S[F];return S}initializeTileState(o,h){o.refreshFeatureState(h)}coalesceChanges(o,h){const m={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const E={};for(const S in this.stateChanges[w])this.state[w][S]||(this.state[w][S]={}),a.h(this.state[w][S],this.stateChanges[w][S]),E[S]=this.state[w][S];m[w]=E}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const E={};if(this.deletedStates[w]===null)for(const S in this.state[w])E[S]={},this.state[w][S]={};else for(const S in this.deletedStates[w]){if(this.deletedStates[w][S]===null)this.state[w][S]={};else if(this.state[w][S])for(const F of Object.keys(this.deletedStates[w][S]))delete this.state[w][S][F];E[S]=this.state[w][S]}m[w]=m[w]||{},a.h(m[w],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const w in o)o[w].refreshFeatureState(h)}}class zo extends a.E{constructor(o,h,m){super(),this.id=o,this._onlySymbols=m,h.on("data",w=>{w.dataType==="source"&&w.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&w.dataType==="source"&&w.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),h.on("error",()=>{this._sourceErrored=!0}),this._source=h,this._tiles={},this._cache=new hf(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Vu,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles)if(!this._tiles[o].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,h){return o.isSymbolTile=this._onlySymbols,o.isExtraShadowCaster=this._shadowCasterTiles[o.tileID.key],this._source.loadTile(o,h)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o)}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o)}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const m=this._tiles[h];m.upload(o),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(zl).map(o=>o.key)}getRenderableIds(o,h){const m=[];for(const w in this._tiles)this._isIdRenderable(+w,o,h)&&m.push(this._tiles[w]);return o?m.sort((w,E)=>{const S=w.tileID,F=E.tileID,D=new a.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle),Q=new a.P(F.canonical.x,F.canonical.y)._rotate(this.transform.angle);return S.overscaledZ-F.overscaledZ||Q.y-D.y||Q.x-D.x}).map(w=>w.tileID.key):m.map(w=>w.tileID).sort(zl).map(w=>w.key)}hasRenderableParent(o){const h=this.findLoadedParent(o,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(o,h,m){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(h||!this._tiles[o].holdingForFade())&&(m||!this._shadowCasterTiles[o])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,h){const m=this._tiles[o];m&&(m.state!=="loading"&&(m.state=h),this._loadTile(m,this._tileLoaded.bind(this,m,o,h)))}_tileLoaded(o,h,m,w){if(w)if(o.state="errored",w.status!==404)this._source.fire(new a.z(w,{tile:o}));else{if(this._source.fire(new a.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:o})),!(o.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const E=this.map.painter.terrain;this.update(this.transform,E.getScaledDemTileSize(),!0),E.resetTileLookupCache(this.id)}else this.update(this.transform)}else o.timeAdded=a.q.now(),m==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(h,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.A("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const h=this.getRenderableIds();for(let w=0;w<h.length;w++){const E=h[w];if(o.neighboringTiles&&o.neighboringTiles[E]){const S=this.getTileByID(E);m(o,S),m(S,o)}}function m(w,E){if(!w.dem||w.dem.borderReady)return;w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0;let S=E.tileID.canonical.x-w.tileID.canonical.x;const F=E.tileID.canonical.y-w.tileID.canonical.y,D=Math.pow(2,w.tileID.canonical.z),Q=E.tileID.key;S===0&&F===0||Math.abs(F)>1||(Math.abs(S)>1&&(Math.abs(S+D)===1?S+=D:Math.abs(S-D)===1&&(S-=D)),E.dem&&w.dem&&(w.dem.backfillBorder(E.dem,S,F),w.neighboringTiles&&w.neighboringTiles[Q]&&(w.neighboringTiles[Q].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,h,m,w){for(const E in this._tiles){let S=this._tiles[E];if(w[E]||!S.hasData()||S.tileID.overscaledZ<=h||S.tileID.overscaledZ>m)continue;let F=S.tileID;for(;S&&S.tileID.overscaledZ>h+1;){const Q=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[Q.key],S&&S.hasData()&&(F=Q)}let D=F;for(;D.overscaledZ>h;)if(D=D.scaledTo(D.overscaledZ-1),o[D.key]){w[F.key]=F;break}}}findLoadedParent(o,h){if(o.key in this._loadedParentTiles){const m=this._loadedParentTiles[o.key];return m&&m.tileID.overscaledZ>=h?m:null}for(let m=o.overscaledZ-1;m>=h;m--){const w=o.scaledTo(m),E=this._getLoadedTile(w);if(E)return E}}_getLoadedTile(o){const h=this._tiles[o.key];return h&&h.hasData()?h:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,h){h=h||this._source.tileSize;const m=Math.ceil(o.width/h)+1,w=Math.ceil(o.height/h)+1,E=Math.floor(m*w*5),S=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,E):E,F=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(F)}handleWrapJump(o){const h=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,h){const m={};for(const w in this._tiles){const E=this._tiles[w];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+h),m[E.tileID.key]=E}this._tiles=m;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(+w,this._tiles[w])}}update(o,h,m,w,E){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(o,h),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const S=this._source.type==="batched-model";let F,D=this._source.maxzoom;const Q=this.map&&this.map.painter?this.map.painter._terrain:null;if(Q&&Q.sourceCache===this&&Q.attenuationRange()){const K=Q.attenuationRange()[0],ee=Math.floor(K)-Math.log2(Q.getDemUpscale());D>ee&&(D=ee)}if(this.used||this.usedForTerrain){if(this._source.tileID)F=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(K=>new a.aM(K.canonical.z,K.wrap,K.canonical.z,K.canonical.x,K.canonical.y));else if(this.tileCoverLift!==0){const K=o.clone();K.tileCoverLift=this.tileCoverLift,F=K.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.minzoom<=1&&o.projection.name==="globe"&&(F.push(new a.aM(1,0,1,0,0)),F.push(new a.aM(1,0,1,1,0)),F.push(new a.aM(1,0,1,0,1)),F.push(new a.aM(1,0,1,1,1)))}else if(F=o.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.hasTile){const K=this._source.hasTile.bind(this._source);F=F.filter(ee=>K(ee))}}else F=[];if(F.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!ul(this._source.type)){const K=o.coveringZoomLevel({tileSize:h||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),ee=Math.min(K,this._source.maxzoom);if(S){const he=o.extendTileCover(F,ee);for(const le of he)F.push(le)}else if(E){const he=o.extendTileCoverToNearPlane(F,this.transform.getFrustum(ee),ee);for(const le of he)F.push(le)}else if(this.castsShadows&&w){const he=o.extendTileCover(F,ee,w);for(const le of he)this._shadowCasterTiles[le.key]=!0,F.push(le)}}const V=this._updateRetainedTiles(F);if(ul(this._source.type)&&F.length!==0){const K={},ee={},he=Object.keys(V);for(const Ae of he){const fe=V[Ae],Ce=this._tiles[Ae];if(!Ce||Ce.fadeEndTime&&Ce.fadeEndTime<=a.q.now())continue;const ke=this.findLoadedParent(fe,Math.max(fe.overscaledZ-zo.maxOverzooming,this._source.minzoom));ke&&(this._addTile(ke.tileID),K[ke.tileID.key]=ke.tileID),ee[Ae]=fe}const le=F[F.length-1].overscaledZ;for(const Ae in this._tiles){const fe=this._tiles[Ae];if(V[Ae]||!fe.hasData())continue;let Ce=fe.tileID;for(;Ce.overscaledZ>le;){Ce=Ce.scaledTo(Ce.overscaledZ-1);const ke=this._tiles[Ce.key];if(ke&&ke.hasData()&&ee[Ce.key]){V[Ae]=fe.tileID;break}}}for(const Ae in K)V[Ae]||(this._coveredTiles[Ae]=!0,V[Ae]=K[Ae])}for(const K in V)this._tiles[K].clearFadeHold();const Z=a.bs(this._tiles,V);for(const K of Z){const ee=this._tiles[K];ee.hasSymbolBuckets&&!ee.holdingForFade()?ee.setHoldDuration(this.map._fadeDuration):ee.hasSymbolBuckets&&!ee.symbolFadeFinished()||this._removeTile(+K)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const h={};if(o.length===0)return h;const m={},w=o.reduce((Q,V)=>Math.min(Q,V.overscaledZ),1/0),E=o[0].overscaledZ,S=Math.max(E-zo.maxOverzooming,this._source.minzoom),F=Math.max(E+zo.maxUnderzooming,this._source.minzoom),D={};for(const Q of o){const V=this._addTile(Q);h[Q.key]=Q,V.hasData()||w<this._source.maxzoom&&(D[Q.key]=Q)}this._retainLoadedChildren(D,w,F,h);for(const Q of o){let V=this._tiles[Q.key];if(V.hasData())continue;if(Q.canonical.z>=this._source.maxzoom){const K=Q.children(this._source.maxzoom)[0],ee=this.getTile(K);if(ee&&ee.hasData()){h[K.key]=K;continue}}else{const K=Q.children(this._source.maxzoom);if(h[K[0].key]&&h[K[1].key]&&h[K[2].key]&&h[K[3].key])continue}let Z=V.wasRequested();for(let K=Q.overscaledZ-1;K>=S;--K){const ee=Q.scaledTo(K);if(m[ee.key]||(m[ee.key]=!0,V=this.getTile(ee),!V&&Z&&(V=this._addTile(ee)),V&&(h[ee.key]=ee,Z=V.wasRequested(),V.hasData())))break}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const h=[];let m,w=this._tiles[o].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){m=this._loadedParentTiles[w.key];break}h.push(w.key);const E=w.scaledTo(w.overscaledZ-1);if(m=this._getLoadedTile(E),m)break;w=E}for(const E of h)this._loadedParentTiles[E]=m}}_addTile(o){let h=this._tiles[o.key];if(h)return h.isExtraShadowCaster!==!0||this._shadowCasterTiles[o.key]||this._reloadTile(o.key,"reloading"),h;h=this._cache.getAndRemove(o),h&&(this._setTileReloadTimer(o.key,h),h.tileID=o,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,h)));const m=!!h;if(!m){const w=this.map?this.map.painter:null,E=this._source.tileSize*o.overscaleFactor();h=this._source.type==="raster-array"?new zh(o,E,this.transform.tileZoom,w,this._isRaster):new Ah(o,E,this.transform.tileZoom,w,this._isRaster,this._source.worldview),this._loadTile(h,this._tileLoaded.bind(this,h,o.key,h.state))}return h.uses++,this._tiles[o.key]=h,m||this._source.fire(new a.A("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(o,h){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const m=h.getExpiryTimeout();m&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},m))}_removeTile(o){const h=this._tiles[o];h&&(h.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),h.uses>0||(h.hasData()&&h.state!=="reloading"||h.state==="empty"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,h,m){const w=[],E=this.transform;if(!E)return w;const S=E.projection.name==="globe",F=a.aD(E.center.lng);for(const D in this._tiles){const Q=this._tiles[D];if(m&&Q.clearQueryDebugViz(),Q.holdingForFade())continue;let V;if(S){const Z=Q.tileID.canonical;if(Z.z===0){const K=[Math.abs(a.ay(F,...Tl(Z,-1))-F),Math.abs(a.ay(F,...Tl(Z,1))-F)];V=[0,2*K.indexOf(Math.min(...K))-1]}else{const K=[Math.abs(a.ay(F,...Tl(Z,-1))-F),Math.abs(a.ay(F,...Tl(Z,0))-F),Math.abs(a.ay(F,...Tl(Z,1))-F)];V=[K.indexOf(Math.min(...K))-1]}}else V=[0];for(const Z of V){const K=o.containsTile(Q,E,h,Z);K&&w.push(K)}}return w}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(o){return this._getRenderableCoordinates(o)}_getRenderableCoordinates(o,h){const m=this.getRenderableIds(o,h).map(E=>this._tiles[E].tileID),w=this.transform.projection.name==="globe";for(const E of m)E.projMatrix=this.transform.calculateProjMatrix(E.toUnwrapped()),E.expandedProjMatrix=w?this.transform.calculateProjMatrix(E.toUnwrapped(),!1,!0):E.projMatrix;return m}sortCoordinatesByDistance(o){const h=o.slice(),m=this.transform._camera.position,w=this.transform._camera.forward(),E={};for(const S of h){const F=1/(1<<S.canonical.z);E[S.key]=((S.canonical.x+.5)*F+S.wrap-m[0])*w[0]+((S.canonical.y+.5)*F-m[1])*w[1]-m[2]*w[2]}return h.sort((S,F)=>E[S.key]-E[F.key]),h}hasTransition(){if(this._source.hasTransition())return!0;if(ul(this._source.type))for(const o in this._tiles){const h=this._tiles[o];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=a.q.now())return!0}return!1}setFeatureState(o,h,m){this._state.updateState(o=o||"_geojsonTileLayer",h,m)}removeFeatureState(o,h,m){this._state.removeFeatureState(o=o||"_geojsonTileLayer",h,m)}getFeatureState(o,h){return this._state.getState(o=o||"_geojsonTileLayer",h)}setDependencies(o,h,m){const w=this._tiles[o];w&&w.setDependencies(h,m)}reloadTilesForDependencies(o,h){for(const m in this._tiles)this._tiles[m].hasDependency(o,h)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(o,h))}_preloadTiles(o,h){if(!this._sourceLoaded){const D=()=>{this._sourceLoaded&&(this._source.off("data",D),this._preloadTiles(o,h))};return void this._source.on("data",D)}const m=new Map,w=Array.isArray(o)?o:[o],E=this.map.painter.terrain,S=this.usedForTerrain&&E?E.getScaledDemTileSize():this._source.tileSize;for(const D of w){const Q=D.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const V of Q)m.set(V.key,V);this.usedForTerrain&&D.updateElevation(!1)}const F=Array.from(m.values());a.bt(F,(D,Q)=>{const V=new Ah(D,this._source.tileSize*D.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(V,Z=>{this._source.type==="raster-dem"&&V.dem&&this._backfillDEM(V),Q(Z,V)})},h)}}function zl(p,o){const h=Math.abs(2*p.wrap)-+(p.wrap<0),m=Math.abs(2*o.wrap)-+(o.wrap<0);return p.overscaledZ-o.overscaledZ||m-h||o.canonical.y-p.canonical.y||o.canonical.x-p.canonical.x}function ul(p){return p==="raster"||p==="image"||p==="video"||p==="custom"}function Tl(p,o){const h=1<<p.z;return[p.x/h+o,(p.x+1)/h+o]}zo.maxOverzooming=10,zo.maxUnderzooming=3;class Hi{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const o=!1,h=!1;for(const m in this.style._mergedLayers){const w=this.style._mergedLayers[m];if(w.type==="fill-extrusion"||w.type==="building")this.layers.push({layer:w,visible:o,visibilityChanged:h});else if(w.type==="model"){const E=this.style.getLayerSource(w);E&&E.type==="batched-model"&&this.layers.push({layer:w,visible:o,visibilityChanged:h})}}}onNewFrame(o){this.layersGotHidden=!1;for(const h of this.layers){const m=h.layer;let w=!1;m.type==="fill-extrusion"?w=!m.isHidden(o)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="building"?w=!m.isHidden(o)&&m.paint.get("building-opacity")>0:m.type==="model"&&(w=!m.isHidden(o)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!w&&h.visible,h.visible=w}}updateZOffset(o,h){this.currentBuildingBuckets=[];for(const w of this.layers){const E=w.layer,S=this.style.getLayerSourceCache(E);let F=1;E.type==="fill-extrusion"?F=w.visible?E.paint.get("fill-extrusion-vertical-scale"):0:E.type==="building"&&(F=w.visible?E.paint.get("building-vertical-scale"):0);let D=S?S.getTile(h):null;if(!D&&S)for(const Q in S._tiles){const V=S._tiles[Q];if(h.canonical.isChildOf(V.tileID.canonical)){D=V;break}}this.currentBuildingBuckets.push({bucket:D?D.getBucket(E):null,tileID:D?D.tileID:h,verticalScale:F})}o.hasAnyZOffset=!1;let m=!1;for(let w=0;w<o.symbolInstances.length;w++){const E=o.symbolInstances.get(w),S=E.zOffset,F=this._getHeightAtTileOffset(h,E.tileAnchorX,E.tileAnchorY);E.zOffset=F!==Number.NEGATIVE_INFINITY?F:S,m||S===E.zOffset||(m=!0),o.hasAnyZOffset||E.zOffset===0||(o.hasAnyZOffset=!0)}m&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,h,m,w){let E=h,S=m;if(o.canonical.z!==w.canonical.z){const F=w.canonical,D=1/(1<<o.canonical.z-F.z);E=(h+o.canonical.x*a.aj)*D-F.x*a.aj|0,S=(m+o.canonical.y*a.aj)*D-F.y*a.aj|0}return{tileX:E,tileY:S}}_getHeightAtTileOffset(o,h,m){let w,E;for(let S=0;S<this.layers.length;++S){const F=this.layers[S].layer;if(F.type!=="fill-extrusion"&&F.type!=="building")continue;const{bucket:D,tileID:Q,verticalScale:V}=this.currentBuildingBuckets[S];if(!D)continue;const{tileX:Z,tileY:K}=this._mapCoordToOverlappingTile(o,h,m,Q),ee=D.getHeightAtTileCoord(Z,K);ee&&ee.height!==void 0&&(ee.hidden?w=ee.height:E=Math.max(ee.height*V,E||0))}if(E!==void 0)return E;for(let S=0;S<this.layers.length;++S){const F=this.layers[S];if(F.layer.type!=="model"||!F.visible)continue;const{bucket:D,tileID:Q}=this.currentBuildingBuckets[S];if(!D)continue;const{tileX:V,tileY:Z}=this._mapCoordToOverlappingTile(o,h,m,Q),K=D.getHeightAtTileCoord(V,Z);if(K&&!K.hidden)return K.height===void 0&&w!==void 0?Math.min(K.maxHeight,w)*K.verticalScale:K.height?K.height*K.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function ff(p,o){const h={};for(const m in p)m!=="ref"&&(h[m]=p[m]);return a.bu.forEach(m=>{m in o&&(h[m]=o[m])}),h}function Ec(p){p=p.slice();const o=Object.create(null);for(let h=0;h<p.length;h++)o[p[h].id]=p[h];for(let h=0;h<p.length;h++)"ref"in p[h]&&(p[h]=ff(p[h],o[p[h].ref]));return p}const Ui={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function kf(p,o,h){h.push({command:Ui.addSource,args:[p,o[p]]})}function hl(p,o,h){o.push({command:Ui.removeSource,args:[p]}),h[p]=!0}function Xc(p,o,h,m){hl(p,h,m),kf(p,o,h)}function Kd(p,o,h){let m;for(m in p[h])if(p[h].hasOwnProperty(m)&&m!=="data"&&!a.bv(p[h][m],o[h][m]))return!1;for(m in o[h])if(o[h].hasOwnProperty(m)&&m!=="data"&&!a.bv(p[h][m],o[h][m]))return!1;return!0}function dh(p,o,h,m,w,E){let S;for(S in o=o||{},p=p||{})p.hasOwnProperty(S)&&(a.bv(p[S],o[S])||h.push({command:E,args:[m,S,o[S],w]}));for(S in o)o.hasOwnProperty(S)&&!p.hasOwnProperty(S)&&(a.bv(p[S],o[S])||h.push({command:E,args:[m,S,o[S],w]}))}function Zc(p){return p.id}function _u(p,o){return p[o.id]=o,p}function tc(p,o,h){const m=o.createTileMatrix(p,p.worldSize,h.toUnwrapped());return a.az(new Float32Array(16),p.projMatrix,m)}function Gu(p,o,h){if(o.projection.name===h.projection.name)return p.projMatrix;const m=h.clone();return m.setProjection(o.projection),tc(m,o.getProjection(),p)}function Bc(p,o,h){return o.name===h.projection.name?p.projMatrix:tc(h,o,p)}class Uf{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=a.ay(o,0,1);let h=1,m=this._distances[h];const w=o*this.paddedLength+this.padding;for(;m<w&&h<this._distances.length;)m=this._distances[++h];const E=h-1,S=this._distances[E],F=m-S,D=F>0?(w-S)/F:0;return this.points[E].mult(1-D).add(this.points[h].mult(D))}}class ph{constructor(o,h,m){const w=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(o/m),this.yCellCount=Math.ceil(h/m);for(let S=0;S<this.xCellCount*this.yCellCount;S++)w.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,m,w,E){this._forEachCell(h,m,w,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(w),this.bboxes.push(E)}insertCircle(o,h,m,w){this._forEachCell(h-w,m-w,h+w,m+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(m),this.circles.push(w)}_insertBoxCell(o,h,m,w,E,S){this.boxCells[E].push(S)}_insertCircleCell(o,h,m,w,E,S){this.circleCells[E].push(S)}_query(o,h,m,w,E,S){if(m<0||o>this.width||w<0||h>this.height)return!E&&[];const F=[];if(o<=0&&h<=0&&this.width<=m&&this.height<=w){if(E)return!0;for(let D=0;D<this.boxKeys.length;D++)F.push({key:this.boxKeys[D],x1:this.bboxes[4*D],y1:this.bboxes[4*D+1],x2:this.bboxes[4*D+2],y2:this.bboxes[4*D+3]});for(let D=0;D<this.circleKeys.length;D++){const Q=this.circles[3*D],V=this.circles[3*D+1],Z=this.circles[3*D+2];F.push({key:this.circleKeys[D],x1:Q-Z,y1:V-Z,x2:Q+Z,y2:V+Z})}return S?F.filter(S):F}return this._forEachCell(o,h,m,w,this._queryCell,F,{hitTest:E,seenUids:{box:{},circle:{}}},S),E?F.length>0:F}_queryCircle(o,h,m,w,E){const S=o-m,F=o+m,D=h-m,Q=h+m;if(F<0||S>this.width||Q<0||D>this.height)return!w&&[];const V=[];return this._forEachCell(S,D,F,Q,this._queryCellCircle,V,{hitTest:w,circle:{x:o,y:h,radius:m},seenUids:{box:{},circle:{}}},E),w?V.length>0:V}query(o,h,m,w,E){return this._query(o,h,m,w,!1,E)}hitTest(o,h,m,w,E){return this._query(o,h,m,w,!0,E)}hitTestCircle(o,h,m,w){return this._queryCircle(o,h,m,!0,w)}_queryCell(o,h,m,w,E,S,F,D){const Q=F.seenUids,V=this.boxCells[E];if(V!==null){const K=this.bboxes;for(const ee of V)if(!Q.box[ee]){Q.box[ee]=!0;const he=4*ee;if(o<=K[he+2]&&h<=K[he+3]&&m>=K[he+0]&&w>=K[he+1]&&(!D||D(this.boxKeys[ee]))){if(F.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[ee],x1:K[he],y1:K[he+1],x2:K[he+2],y2:K[he+3]})}}}const Z=this.circleCells[E];if(Z!==null){const K=this.circles;for(const ee of Z)if(!Q.circle[ee]){Q.circle[ee]=!0;const he=3*ee;if(this._circleAndRectCollide(K[he],K[he+1],K[he+2],o,h,m,w)&&(!D||D(this.circleKeys[ee]))){if(F.hitTest)return S.push(!0),!0;{const le=K[he],Ae=K[he+1],fe=K[he+2];S.push({key:this.circleKeys[ee],x1:le-fe,y1:Ae-fe,x2:le+fe,y2:Ae+fe})}}}}}_queryCellCircle(o,h,m,w,E,S,F,D){const Q=F.circle,V=F.seenUids,Z=this.boxCells[E];if(Z!==null){const ee=this.bboxes;for(const he of Z)if(!V.box[he]){V.box[he]=!0;const le=4*he;if(this._circleAndRectCollide(Q.x,Q.y,Q.radius,ee[le+0],ee[le+1],ee[le+2],ee[le+3])&&(!D||D(this.boxKeys[he])))return S.push(!0),!0}}const K=this.circleCells[E];if(K!==null){const ee=this.circles;for(const he of K)if(!V.circle[he]){V.circle[he]=!0;const le=3*he;if(this._circlesCollide(ee[le],ee[le+1],ee[le+2],Q.x,Q.y,Q.radius)&&(!D||D(this.circleKeys[he])))return S.push(!0),!0}}}_forEachCell(o,h,m,w,E,S,F,D){const Q=this._convertToXCellCoord(o),V=this._convertToYCellCoord(h),Z=this._convertToXCellCoord(m),K=this._convertToYCellCoord(w);for(let ee=Q;ee<=Z;ee++)for(let he=V;he<=K;he++)if(E.call(this,o,h,m,w,this.xCellCount*he+ee,S,F,D))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,m,w,E,S){const F=w-o,D=E-h,Q=m+S;return Q*Q>F*F+D*D}_circleAndRectCollide(o,h,m,w,E,S,F){const D=(S-w)/2,Q=Math.abs(o-(w+D));if(Q>D+m)return!1;const V=(F-E)/2,Z=Math.abs(h-(E+V));if(Z>V+m)return!1;if(Q<=D||Z<=V)return!0;const K=Q-D,ee=Z-V;return K*K+ee*ee<=m*m}}const Ku={unknown:0,flipRequired:1,flipNotRequired:2},mh=Math.tan(85*Math.PI/180);function Cc(p,o,h,m,w,E,S){const F=a.bz();if(h)if(E.name==="globe"){const D=a.bA(w,o);a.az(F,F,D)}else{const D=a.bB([],S);F[0]=D[0],F[1]=D[1],F[4]=D[2],F[5]=D[3],m||a.by(F,F,w.angle)}else a.az(F,w.labelPlaneMatrix,p);return F}function vu(p,o,h,m,w,E,S){const F=Cc(p,o,h,m,w,E,S);return E.name==="globe"&&h||(F[2]=F[6]=F[10]=F[14]=0),F}function rc(p,o,h,m,w,E,S){if(h){if(E.name==="globe"){const F=Cc(p,o,h,m,w,E,S);return a.bi(F,F),a.az(F,p,F),F}{const F=a.bw(p),D=a.bx([]);return D[0]=S[0],D[1]=S[1],D[4]=S[2],D[5]=S[3],a.az(F,F,D),m||a.by(F,F,-w.angle),F}}return w.glCoordMatrix}function ts(p,o,h,m){const w=[p,o,h,1];h?a.aA(w,w,m):Xr(w,w,m);const E=w[3];return w[0]/=E,w[1]/=E,w[2]/=E,w}function Wu(p,o){return Math.min(.5+p/o*.5,1.5)}function gh(p,o){const h=p[0]/p[3],m=p[1]/p[3];return h>=-o[0]&&h<=o[0]&&m>=-o[1]&&m<=o[1]}function yu(p,o,h,m,w,E,S,F,D,Q){const V=h.transform,Z=m?p.textSizeData:p.iconSizeData,K=a.bH(Z,h.transform.zoom),ee=V.projection.name==="globe",he=[256/h.width*2+1,256/h.height*2+1],le=m?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;le.clear();let Ae=null;ee&&(Ae=m?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const fe=p.lineVertexArray,Ce=m?p.text.placedSymbolArray:p.icon.placedSymbolArray,ke=h.transform.width/h.transform.height;let He,$e=!1;for(let it=0;it<Ce.length;it++){const ct=Ce.get(it),{numGlyphs:Xe,writingMode:Ye}=ct;if(Ye!==a.bI.vertical||$e||He===a.bI.horizontal||($e=!0),He=Ye,(ct.hidden||Ye===a.bI.vertical)&&!$e){sr(Xe,le);continue}$e=!1;const tt=new a.P(ct.tileAnchorX,ct.tileAnchorY);let{x:Pt,y:gt,z:Jt}=V.projection.projectTilePoint(tt.x,tt.y,Q.canonical);if(D){const[ln,dn,Wr]=D(tt);Pt+=ln,gt+=dn,Jt+=Wr}const kt=[Pt,gt,Jt,1];if(a.aA(kt,kt,o),!gh(kt,he)){sr(Xe,le);continue}const or=kt[3],pr=Wu(h.transform.getCameraToCenterDistance(V.projection),or),It=a.bJ(Z,K,ct),ht=S?It/pr:It*pr,zt=ts(Pt,gt,Jt,w);if(zt[3]<=0){sr(Xe,le);continue}let Ot={};const fr=a.al(p.layers[0].layout.get("text-max-angle")),Ar=Math.cos(fr),yr=S?null:D,Br=ne(ct,ht,!1,F,o,w,E,p.glyphOffsetArray,fe,le,Ae,zt,tt,Ot,ke,yr,V.projection,Q,S,Ar);$e=Br.useVertical,yr&&Br.needsFlipping&&(Ot={}),(Br.notEnoughRoom||$e||Br.needsFlipping&&ne(ct,ht,!0,F,o,w,E,p.glyphOffsetArray,fe,le,Ae,zt,tt,Ot,ke,yr,V.projection,Q,S,Ar).notEnoughRoom)&&sr(Xe,le)}m?(p.text.dynamicLayoutVertexBuffer.updateData(le),Ae&&p.text.globeExtVertexBuffer&&p.text.globeExtVertexBuffer.updateData(Ae)):(p.icon.dynamicLayoutVertexBuffer.updateData(le),Ae&&p.icon.globeExtVertexBuffer&&p.icon.globeExtVertexBuffer.updateData(Ae))}function fo(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae){const{lineStartIndex:fe,glyphStartIndex:Ce,segment:ke}=F,He=Ce+F.numGlyphs,$e=fe+F.lineLength,it=o.getoffsetX(Ce),ct=o.getoffsetX(He-1),Xe=Qt(p*it,h,m,w,E,S,ke,fe,$e,D,Q,V,Z,K,!0,ee,he,le,Ae);if(!Xe)return null;const Ye=Qt(p*ct,h,m,w,E,S,ke,fe,$e,D,Q,V,Z,K,!0,ee,he,le,Ae);return Ye?{first:Xe,last:Ye}:null}function nc(p,o,h,m){return p===a.bI.horizontal&&Math.abs(m)>Math.abs(h)?{useVertical:!0}:p===a.bI.vertical?m>0?{needsFlipping:!0}:null:o!==Ku.unknown&&function(w,E){return w===0||Math.abs(E/w)>mh}(h,m)?o===Ku.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function ne(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae,fe,Ce,ke){const He=o/24,$e=p.lineOffsetX*He,it=p.lineOffsetY*He,{lineStartIndex:ct,glyphStartIndex:Xe,numGlyphs:Ye,segment:tt,writingMode:Pt,flipState:gt}=p,Jt=ct+p.lineLength,kt=or=>{if(V){const[zt,Ot,fr]=or.up,Ar=Q.length;a.bK(V,Ar+0,zt,Ot,fr),a.bK(V,Ar+1,zt,Ot,fr),a.bK(V,Ar+2,zt,Ot,fr),a.bK(V,Ar+3,zt,Ot,fr)}const[pr,It,ht]=or.point;a.bL(Q,pr,It,ht,or.angle)};if(Ye>1){const or=fo(He,F,$e,it,h,Z,K,p,D,E,ee,le,!1,Ae,fe,Ce,ke);if(!or)return{notEnoughRoom:!0};if(m&&!h){let[pr,It,ht]=or.first.point,[zt,Ot,fr]=or.last.point;[pr,It]=ts(pr,It,ht,S),[zt,Ot]=ts(zt,Ot,fr,S);const Ar=nc(Pt,gt,(zt-pr)*he,Ot-It);if(p.flipState=Ar&&Ar.needsFlipping?Ku.flipRequired:Ku.flipNotRequired,Ar)return Ar}kt(or.first);for(let pr=Xe+1;pr<Xe+Ye-1;pr++){const It=Qt(He*F.getoffsetX(pr),$e,it,h,Z,K,tt,ct,Jt,D,E,ee,le,!1,!1,Ae,fe,Ce,ke);if(!It)return Q.length-=4*(pr-Xe),{notEnoughRoom:!0};kt(It)}kt(or.last)}else{if(m&&!h){const pr=ts(K.x,K.y,0,w),It=ct+tt+1,ht=new a.P(D.getx(It),D.gety(It)),zt=ts(ht.x,ht.y,0,w),Ot=zt[3]>0?zt:ft(K,ht,pr,1,w,void 0,Ae,fe.canonical),fr=nc(Pt,gt,(Ot[0]-pr[0])*he,Ot[1]-pr[1]);if(p.flipState=fr&&fr.needsFlipping?Ku.flipRequired:Ku.flipNotRequired,fr)return fr}const or=Qt(He*F.getoffsetX(Xe),$e,it,h,Z,K,tt,ct,Jt,D,E,ee,le,!1,!1,Ae,fe,Ce,ke);if(!or)return{notEnoughRoom:!0};kt(or)}return{}}function ze(p,o,h,m,w){const{x:E,y:S,z:F}=m.projectTilePoint(p.x,p.y,o);if(!w)return ts(E,S,F,h);const[D,Q,V]=w(p);return ts(E+D,S+Q,F+V,h)}function ft(p,o,h,m,w,E,S,F){const D=ze(p.sub(o)._unit()._add(p),F,w,S,E);return a.at(D,h,D),a.au(D,D),a.bE(D,h,D,m)}function Qt(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae,fe,Ce){const ke=m?p-o:p+o;let He=ke>0?1:-1,$e=0;m&&(He*=-1,$e=Math.PI),He<0&&($e+=Math.PI);let it=F+S+(He>0?0:1)|0,ct=w,Xe=w,Ye=0,tt=0;const Pt=Math.abs(ke),gt=[],Jt=[];let kt=E,or=kt,pr=a.bC([]);const It=()=>ft(or,kt,Xe,Pt-Ye+1,V,K,le,Ae.canonical);for(;Ye+tt<=Pt;){if(it+=He,it<F||it>=D)return null;if(Xe=ct,or=kt,gt.push(Xe),ee&&Jt.push(or),kt=new a.P(Q.getx(it),Q.gety(it)),ct=Z[it],!ct){const Wr=ze(kt,Ae.canonical,V,le,K);ct=Wr[3]>0?Z[it]=Wr:It()}Ye+=tt;const ln=a.at([],ct,Xe),dn=a.bD(Xe,ct);if(h&&dn>0&&tt>0&&a.bG(pr,ln)/(tt*dn)<Ce)return null;tt=dn,pr=ln}he&&K&&(Z[it]&&(ct=It(),tt=a.bD(Xe,ct),pr=a.at([],ct,Xe)),Z[it]=ct);const ht=(Pt-Ye)/tt,zt=kt.sub(or)._mult(ht)._add(or),Ot=a.bE([],Xe,pr,ht);let fr=[0,0,1],Ar=pr[0],yr=pr[1];if(fe&&(fr=le.upVector(Ae.canonical,zt.x,zt.y),fr[0]!==0||fr[1]!==0||fr[2]!==1)){const ln=[fr[2],0,-fr[0]],dn=a.bF([],fr,ln);a.au(ln,ln),a.au(dn,dn),Ar=a.bG(pr,ln),yr=a.bG(pr,dn)}if(h){const ln=a.bF([],fr,pr);a.au(ln,ln),a.bE(Ot,Ot,ln,h*He)}const Br=$e+Math.atan2(yr,Ar);return gt.push(Ot),ee&&Jt.push(zt),{point:Ot,angle:Br,path:gt,tilePath:Jt,up:fr}}function sr(p,o){const h=o.length,m=h+4*p;o.resize(m),o.float32.fill(-1/0,4*h,4*m)}function Xr(p,o,h){const m=o[0],w=o[1];return p[0]=h[0]*m+h[4]*w+h[12],p[1]=h[1]*m+h[5]*w+h[13],p[3]=h[3]*m+h[7]*w+h[15],p}const tr=100;class ri{constructor(o,h,m=new ph(o.width+200,o.height+200,25),w=new ph(o.width+200,o.height+200,25)){this.transform=o,this.grid=m,this.ignoredGrid=w,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+tr,this.screenBottomBoundary=o.height+tr,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=h}placeCollisionBox(o,h,m,w,E,S,F,D,Q,V,Z){let K=m.projectedAnchorX,ee=m.projectedAnchorY,he=m.projectedAnchorZ;const le=m.tileAnchorX,Ae=m.tileAnchorY,fe=m.elevation,Ce=m.tileID,ke=o.getProjection();if(fe&&Ce){const[Jt,kt,or]=ke.upVector(Ce.canonical,m.tileAnchorX,m.tileAnchorY),pr=ke.upVectorScale(Ce.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;K+=Jt*fe*pr,ee+=kt*fe*pr,he+=or*fe*pr}const He=o.projection.name==="globe",$e=o.projection.name==="globe"?a.ah(this.transform.zoom):0;if(Ce&&He&&$e<1&&!S){const Jt=1<<Ce.canonical.z,kt=a.bM(le,Ae);a.bN(kt,kt,1/a.aj),a.bO(kt,kt,a.bM(Ce.canonical.x,Ce.canonical.y)),a.bN(kt,kt,1/Jt),a.bP(kt,kt,a.bM(w[0],w[1])),kt[0]=a.bQ(kt[0],-.5,.5),a.bN(kt,kt,a.aj);const or=a.bR(kt[0],kt[1],a.aj/(2*Math.PI),1);a.aA(or,or,E),K=a.ai(K,or[0],$e),ee=a.ai(ee,or[1],$e),he=a.ai(he,or[2],$e)}const it=this.projectAndGetPerspectiveRatio(V,K,ee,he,m.tileID,ke.name==="globe"||!!fe||this.transform.pitch>0,ke),ct=Q*it.perspectiveRatio,Xe=(m.x1*h+F.x-m.padding)*ct+it.point.x,Ye=(m.y1*h+F.y-m.padding)*ct+it.point.y,tt=(m.x2*h+F.x+m.padding)*ct+it.point.x,Pt=(m.y2*h+F.y+m.padding)*ct+it.point.y,gt=it.perspectiveRatio<=.55||it.occluded;return!this.isInsideGrid(Xe,Ye,tt,Pt)||!D&&this.grid.hitTest(Xe,Ye,tt,Pt,Z)||gt?{box:[],offscreen:!1,occluded:it.occluded}:{box:[Xe,Ye,tt,Pt],offscreen:this.isOffscreen(Xe,Ye,tt,Pt),occluded:!1}}placeCollisionCircles(o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le){const Ae=[],fe=this.transform.elevation,Ce=o.getProjection(),ke=fe?fe.getAtTileOffsetFunc(le,this.transform.center.lat,this.transform.worldSize,Ce):null,He=new a.P(m.tileAnchorX,m.tileAnchorY);let{x:$e,y:it,z:ct}=Ce.projectTilePoint(He.x,He.y,le.canonical);if(ke){const[fr,Ar,yr]=ke(He);$e+=fr,it+=Ar,ct+=yr}const Xe=Ce.name==="globe",Ye=this.projectAndGetPerspectiveRatio(F,$e,it,ct,le,Xe||!!fe||this.transform.pitch>0,Ce),{perspectiveRatio:tt}=Ye,Pt=(Z?S/tt:S*tt)/a.bU,gt=ts($e,it,ct,D),Jt=m.lineOffsetX*Pt,kt=m.lineOffsetY*Pt,or=a.al(o.layers[0].layout.get("text-max-angle")),pr=Math.cos(or),It=Ye.signedDistanceFromCamera>0?fo(Pt,E,Jt,kt,!1,gt,He,m,w,D,{},fe&&!Z?ke:null,Z&&!!fe,Ce,le,Z,pr):null;let ht=!1,zt=!1,Ot=!0;if(It&&!Ye.occluded){const fr=.5*ee*tt+he,Ar=new a.P(-100,-100),yr=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Br=new Uf,{first:ln,last:dn}=It,Wr=ln.path.length;let An=[];for(let Wn=Wr-1;Wn>=1;Wn--)An.push(ln.path[Wn]);for(let Wn=1;Wn<dn.path.length;Wn++)An.push(dn.path[Wn]);const cn=2.5*fr;Q&&(An=An.map(([Wn,hi,ji],Hn)=>(ke&&!Xe&&(ji=ke(Hn<Wr-1?ln.tilePath[Wr-1-Hn]:dn.tilePath[Hn-Wr+2])[2]),ts(Wn,hi,ji,Q))),An.some(Wn=>Wn[3]<=0)&&(An=[]));let Ln=[];if(An.length>0){let Wn=1/0,hi=-1/0,ji=1/0,Hn=-1/0;for(const Wi of An)Wn=Math.min(Wn,Wi[0]),ji=Math.min(ji,Wi[1]),hi=Math.max(hi,Wi[0]),Hn=Math.max(Hn,Wi[1]);hi>=Ar.x&&Wn<=yr.x&&Hn>=Ar.y&&ji<=yr.y&&(Ln=[An.map(Wi=>new a.P(Wi[0],Wi[1]))],(Wn<Ar.x||hi>yr.x||ji<Ar.y||Hn>yr.y)&&(Ln=a.bS(Ln,Ar.x,Ar.y,yr.x,yr.y)))}for(const Wn of Ln){Br.reset(Wn,.25*fr);let hi=0;hi=Br.length<=.5*fr?1:Math.ceil(Br.paddedLength/cn)+1;for(let ji=0;ji<hi;ji++){const Hn=ji/Math.max(hi-1,1),Wi=Br.lerp(Hn),Ji=Wi.x+tr,va=Wi.y+tr;Ae.push(Ji,va,fr,0);const ei=Ji-fr,qi=va-fr,Ni=Ji+fr,na=va+fr;if(Ot=Ot&&this.isOffscreen(ei,qi,Ni,na),zt=zt||this.isInsideGrid(ei,qi,Ni,na),!h&&this.grid.hitTestCircle(Ji,va,fr,K)&&(ht=!0,!V))return{circles:[],offscreen:!1,collisionDetected:ht,occluded:!1}}}}return{circles:!V&&ht||!zt?[]:Ae,offscreen:Ot,collisionDetected:ht,occluded:Ye.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let m=1/0,w=1/0,E=-1/0,S=-1/0;for(const V of o){const Z=new a.P(V.x+tr,V.y+tr);m=Math.min(m,Z.x),w=Math.min(w,Z.y),E=Math.max(E,Z.x),S=Math.max(S,Z.y),h.push(Z)}const F=this.grid.query(m,w,E,S).concat(this.ignoredGrid.query(m,w,E,S)),D={},Q={};for(const V of F){const Z=V.key;if(D[Z.bucketInstanceId]===void 0&&(D[Z.bucketInstanceId]={}),D[Z.bucketInstanceId][Z.featureIndex])continue;const K=[new a.P(V.x1,V.y1),new a.P(V.x2,V.y1),new a.P(V.x2,V.y2),new a.P(V.x1,V.y2)];a.bT(h,K)&&(D[Z.bucketInstanceId][Z.featureIndex]=!0,Q[Z.bucketInstanceId]===void 0&&(Q[Z.bucketInstanceId]=[]),Q[Z.bucketInstanceId].push(Z.featureIndex))}return Q}insertCollisionBox(o,h,m,w,E){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:w,collisionGroupID:E},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,m,w,E){const S=h?this.ignoredGrid:this.grid,F={bucketInstanceId:m,featureIndex:w,collisionGroupID:E};for(let D=0;D<o.length;D+=4)S.insertCircle(F,o[D],o[D+1],o[D+2])}projectAndGetPerspectiveRatio(o,h,m,w,E,S,F){const D=[h,m,w,1];let Q=!1;w||this.transform.pitch>0?(a.aA(D,D,o),this.fogState&&E&&F.name!=="globe"&&(Q=function(K,ee,he,le,Ae,fe){const Ce=fe.calculateFogTileMatrix(Ae),ke=[ee,he,le];return a.ad(ke,ke,Ce),St(K,a.ae(ke),fe.pitch,fe._fov)}(this.fogState,h,m,w,E.toUnwrapped(),this.transform)>.9)):Xr(D,D,o);const V=D[3];return{point:new a.P((D[0]/V+1)/2*this.transform.width+tr,(-D[1]/V+1)/2*this.transform.height+tr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(F)/V*.5,1.5),signedDistanceFromCamera:V,occluded:S&&D[2]>V||Q}}isOffscreen(o,h,m,w){return m<tr||o>=this.screenRightBoundary||w<tr||h>this.screenBottomBoundary}isInsideGrid(o,h,m,w){return m>=0&&o<this.gridRightBoundary&&w>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const o=a.bx([]);return a.bo(o,o,[-100,-100,0]),o}}class Yn{constructor(o,h,m,w){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):w&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class Bi{constructor(o,h,m,w,E,S=!1){this.text=new Yn(o?o.text:null,h,m,E),this.icon=new Yn(o?o.icon:null,h,w,E),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Si{constructor(o,h,m,w=!1){this.text=o,this.icon=h,this.skipFade=m,this.clipped=w}}class Ga{constructor(){this.invProjMatrix=a.bz(),this.viewportMatrix=a.bz(),this.circles=[]}}class xo{constructor(o,h,m,w,E){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=m,this.bucketIndex=w,this.tileID=E}}class Yr{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:m=>m.collisionGroupID===h}}return this.collisionGroups[o]}}function Un(p,o,h,m,w){const{horizontalAlign:E,verticalAlign:S}=a.bZ(p),F=-(E-.5)*o,D=-(S-.5)*h,Q=a.b_(p,m);return new a.P(F+Q[0]*w,D+Q[1]*w)}function oi(p,o,h,m,w){const E=new a.P(p,o);return h&&E._rotate(m?w:-w),E}class Ka{constructor(o,h,m,w,E,S){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new ri(this.transform,E),this.buildingIndex=S,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Yr(m),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,m,w,E=1){const S=m.getBucket(h),F=m.latestFeatureIndex;if(!S||!F||h.fqid!==S.layerIds[0])return;const D=S.layers[0].layout,Q=S.layers[0].paint,V=m.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),K=m.tileSize/a.aj,ee=m.tileID.toUnwrapped();this.transform.setProjection(S.projection);const he=(le=m.tileID,Ae=S.getProjection(),fe=this.transform,Ae.name===this.projection?fe.calculateProjMatrix(le.toUnwrapped()):tc(fe,Ae,le));var le,Ae,fe;const Ce=D.get("text-pitch-alignment")==="map",ke=D.get("text-rotation-alignment")==="map";h.compileFilter(h.options);const He=h.dynamicFilter(),$e=h.dynamicFilterNeedsFeature(),it=this.transform.calculatePixelsToTileUnitsMatrix(m),ct=vu(he,m.tileID.canonical,Ce,ke,this.transform,S.getProjection(),it);let Xe=null;const Ye=S.getProjection().createInversionMatrix(this.transform,m.tileID.canonical);if(Ce){const ht=rc(he,m.tileID.canonical,Ce,ke,this.transform,S.getProjection(),it);Xe=a.az([],this.transform.labelPlaneMatrix,ht)}let tt=null;He&&m.latestFeatureIndex&&(tt={unwrappedTileID:ee,dynamicFilter:He,dynamicFilterNeedsFeature:$e}),this.retainedQueryData[S.bucketInstanceId]=new xo(S.bucketInstanceId,F,S.sourceLayerIndex,S.index,m.tileID);const[Pt,gt]=S.layers[0].layout.get("text-size-scale-range"),Jt=a.ay(E,Pt,gt),[kt,or]=D.get("icon-size-scale-range"),pr=a.ay(E,kt,or),It={bucket:S,layout:D,paint:Q,posMatrix:he,invMatrix:Ye,mercatorCenter:[a.aD(this.transform.center.lng),a.aH(this.transform.center.lat)],textLabelPlaneMatrix:ct,labelToScreenMatrix:Xe,clippingData:tt,scale:Z,textPixelRatio:K,holdingForFade:m.holdingForFade(),collisionBoxArray:V,partiallyEvaluatedTextSize:a.bH(S.textSizeData,this.transform.zoom,Jt),partiallyEvaluatedIconSize:a.bH(S.iconSizeData,this.transform.zoom,pr),collisionGroup:this.collisionGroups.get(S.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(w)for(const ht of S.sortKeyRanges){const{sortKey:zt,symbolInstanceStart:Ot,symbolInstanceEnd:fr}=ht;o.push({sortKey:zt,symbolInstanceStart:Ot,symbolInstanceEnd:fr,parameters:It})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:It})}attemptAnchorPlacement(o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae,fe,Ce,ke,He,$e){const{textOffset0:it,textOffset1:ct,crossTileID:Xe}=le,Ye=[it,ct],tt=Un(o,S,F,Ye,D),Pt=this.collisionIndex.placeCollisionBox(fe,D,h,m,w,E,oi(tt.x,tt.y,Q,V,this.transform.angle),he,Z,K,ee.predicate);if(ke){const gt=fe.getSymbolInstanceIconSize($e,this.transform.zoom,le.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(fe,gt,ke,m,w,E,oi(tt.x,tt.y,Q,V,this.transform.angle),he,Z,K,ee.predicate).box.length===0)return}if(Pt.box.length>0){let gt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Xe]&&this.prevPlacement.placements[Xe]&&this.prevPlacement.placements[Xe].text&&(gt=this.prevPlacement.variableOffsets[Xe].anchor),this.variableOffsets[Xe]={textOffset:Ye,width:S,height:F,anchor:o,textScale:D,prevAnchor:gt},this.markUsedJustification(fe,o,le,Ce),fe.allowVerticalPlacement&&(this.markUsedOrientation(fe,Ce,le),this.placedOrientations[Xe]=Ce),{shift:tt,placedGlyphBoxes:Pt}}}placeLayerBucketPart(o,h,m,w,E=1){const{bucket:S,layout:F,paint:D,posMatrix:Q,textLabelPlaneMatrix:V,labelToScreenMatrix:Z,clippingData:K,textPixelRatio:ee,mercatorCenter:he,invMatrix:le,holdingForFade:Ae,collisionBoxArray:fe,partiallyEvaluatedTextSize:Ce,partiallyEvaluatedIconSize:ke,collisionGroup:He,latestFeatureIndex:$e}=o.parameters,it=F.get("text-optional"),ct=F.get("icon-optional"),Xe=F.get("text-allow-overlap"),Ye=F.get("icon-allow-overlap"),tt=F.get("text-rotation-alignment")==="map",Pt=F.get("icon-rotation-alignment")==="map",gt=F.get("text-pitch-alignment")==="map",Jt=D.get("symbol-z-offset"),kt=F.get("symbol-elevation-reference")==="sea",or=F.get("symbol-placement"),[pr,It]=F.get("text-size-scale-range"),[ht,zt]=F.get("icon-size-scale-range"),Ot=a.ay(E,pr,It),fr=a.ay(E,ht,zt),Ar=F.get("text-variable-anchor"),yr=tt&&or!=="point",Br=Pt&&or!=="point",ln=Ar&&S.hasTextData(),dn=S.hasIconTextFit()&&ln&&S.hasIconData();this.transform.setProjection(S.projection);const Wr=ln||yr,An=Br||dn;let cn=Xe&&(Ye||!S.hasIconData()||ct),Ln=Ye&&(Xe||!S.hasTextData()||it);const Wn=!Jt.isConstant();!S.collisionArrays&&fe&&S.deserializeCollisionBoxes(fe),m&&w&&S.updateCollisionDebugBuffers(this.transform.zoom,fe,Ot,fr);const hi=(Hn,Wi,Ji)=>{const{crossTileID:va,numVerticalGlyphVertices:ei}=Hn;let qi=null;if(K&&K.dynamicFilterNeedsFeature||Wn){const mo=this.retainedQueryData[S.bucketInstanceId];qi=$e.loadFeature({featureIndex:Hn.featureIndex,bucketIndex:mo.bucketIndex,sourceLayerIndex:mo.sourceLayerIndex,layoutVertexArrayOffset:0})}if(K&&!(0,K.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},qi,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new a.P(Hn.tileAnchorX,Hn.tileAnchorY),this.transform.calculateDistanceTileData(K.unwrappedTileID)))return this.placements[va]=new Si(!1,!1,!1,!0),void h.add(va);const Ni=Jt.evaluate(qi,{});if(h.has(va))return;if(Ae)return void(this.placements[va]=new Si(!1,!1,!1));let na=!1,In=!1,Aa=!0,ea=!1,io=!1,Ki=null,ia={box:null,offscreen:null,occluded:null},ga={box:null},Zo=null,Ma=null,Do=null,ml=0,Gl=0,Rl=0;Ji.textFeatureIndex?ml=Ji.textFeatureIndex:Hn.useRuntimeCollisionCircles&&(ml=Hn.featureIndex),Ji.verticalTextFeatureIndex&&(Gl=Ji.verticalTextFeatureIndex);const gl=mo=>{mo.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const go=this.transform.elevation;mo.elevation=kt?Ni:Ni+(go?go.getAtTileOffset(mo.tileID,mo.tileAnchorX,mo.tileAnchorY):0),mo.elevation+=Hn.zOffset},rl=Ji.textBox;if(rl){gl(rl);const mo=Ca=>{let hs=a.bI.horizontal;if(S.allowVerticalPlacement&&!Ca&&this.prevPlacement){const Rs=this.prevPlacement.placedOrientations[va];Rs&&(this.placedOrientations[va]=Rs,hs=Rs,this.markUsedOrientation(S,hs,Hn))}return hs},go=(Ca,hs)=>{if(S.allowVerticalPlacement&&ei>0&&Ji.verticalTextBox){for(const Rs of S.writingModes)if(Rs===a.bI.vertical?(ia=hs(),ga=ia):ia=Ca(),ia&&ia.box&&ia.box.length)break}else ia=Ca()};if(Ar){let Ca=Ar;if(this.prevPlacement&&this.prevPlacement.variableOffsets[va]){const uo=this.prevPlacement.variableOffsets[va];Ca.indexOf(uo.anchor)>0&&(Ca=Ca.filter(Mu=>Mu!==uo.anchor),Ca.unshift(uo.anchor))}const hs=(uo,Mu,nA)=>{const jA=S.getSymbolInstanceTextSize(Ce,Hn,this.transform.zoom,Wi),bd=(uo.x2-uo.x1)*jA+2*uo.padding,HA=(uo.y2-uo.y1)*jA+2*uo.padding,kc=Hn.hasIconTextFit&&!Ye?Mu:null;kc&&gl(kc);let Ch={box:[],offscreen:!1,occluded:!1};const Yo=Xe?2*Ca.length:Ca.length;for(let Ou=0;Ou<Yo;++Ou){const Ed=this.attemptAnchorPlacement(Ca[Ou%Ca.length],uo,he,le,Wr,bd,HA,jA,tt,gt,ee,Q,He,Ou>=Ca.length,Hn,Wi,S,nA,kc,Ce,ke);if(Ed&&(Ch=Ed.placedGlyphBoxes,Ch&&Ch.box&&Ch.box.length)){na=!0,Ki=Ed.shift;break}}return Ch};go(()=>hs(rl,Ji.iconBox,a.bI.horizontal),()=>{const uo=Ji.verticalTextBox;return uo&&gl(uo),S.allowVerticalPlacement&&!(ia&&ia.box&&ia.box.length)&&ei>0&&uo?hs(uo,Ji.verticalIconBox,a.bI.vertical):{box:null,offscreen:null,occluded:null}}),ia&&(na=ia.box,Aa=ia.offscreen,ea=ia.occluded);const Rs=mo(!(!ia||!ia.box));if(!na&&this.prevPlacement){const uo=this.prevPlacement.variableOffsets[va];uo&&(this.variableOffsets[va]=uo,this.markUsedJustification(S,uo.anchor,Hn,Rs))}}else{const Ca=(hs,Rs)=>{const uo=S.getSymbolInstanceTextSize(Ce,Hn,this.transform.zoom,Wi,E),Mu=this.collisionIndex.placeCollisionBox(S,uo,hs,he,le,Wr,new a.P(0,0),Xe,ee,Q,He.predicate);return Mu&&Mu.box&&Mu.box.length&&(this.markUsedOrientation(S,Rs,Hn),this.placedOrientations[va]=Rs),Mu};go(()=>Ca(rl,a.bI.horizontal),()=>{const hs=Ji.verticalTextBox;return S.allowVerticalPlacement&&ei>0&&hs?(gl(hs),Ca(hs,a.bI.vertical)):{box:null,offscreen:null,occluded:null}}),mo(!!(ia&&ia.box&&ia.box.length))}}if(Zo=ia,na=Zo&&Zo.box&&Zo.box.length>0,Aa=Zo&&Zo.offscreen,ea=Zo&&Zo.occluded,Hn.useRuntimeCollisionCircles){const mo=S.text.placedSymbolArray.get(Hn.centerJustifiedTextSymbolIndex>=0?Hn.centerJustifiedTextSymbolIndex:Hn.verticalPlacedTextSymbolIndex),go=a.bJ(S.textSizeData,Ce,mo),Ca=F.get("text-padding");Ma=this.collisionIndex.placeCollisionCircles(S,Xe,mo,S.lineVertexArray,S.glyphOffsetArray,go,Q,V,Z,m,gt,He.predicate,Hn.collisionCircleDiameter*go/a.bU,Ca,this.retainedQueryData[S.bucketInstanceId].tileID),na=Xe||Ma.circles.length>0&&!Ma.collisionDetected,Aa=Aa&&Ma.offscreen,ea=Ma.occluded}if(Ji.iconFeatureIndex&&(Rl=Ji.iconFeatureIndex),Ji.iconBox){const mo=go=>{gl(go);const Ca=Hn.hasIconTextFit&&Ki?oi(Ki.x,Ki.y,tt,gt,this.transform.angle):new a.P(0,0),hs=S.getSymbolInstanceIconSize(ke,this.transform.zoom,Hn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,hs,go,he,le,An,Ca,Ye,ee,Q,He.predicate)};ga&&ga.box&&ga.box.length&&Ji.verticalIconBox?(Do=mo(Ji.verticalIconBox),In=Do.box.length>0):(Do=mo(Ji.iconBox),In=Do.box.length>0),Aa=Aa&&Do.offscreen,io=Do.occluded}const lu=it||Hn.numHorizontalGlyphVertices===0&&ei===0,Lu=ct||Hn.numIconVertices===0;if(lu||Lu?Lu?lu||(In=In&&na):na=In&&na:In=na=In&&na,na&&Zo&&Zo.box&&this.collisionIndex.insertCollisionBox(Zo.box,F.get("text-ignore-placement"),S.bucketInstanceId,ga&&ga.box&&Gl?Gl:ml,He.ID),In&&Do&&this.collisionIndex.insertCollisionBox(Do.box,F.get("icon-ignore-placement"),S.bucketInstanceId,Rl,He.ID),Ma&&(na&&this.collisionIndex.insertCollisionCircles(Ma.circles,F.get("text-ignore-placement"),S.bucketInstanceId,ml,He.ID),m)){const mo=S.bucketInstanceId;let go=this.collisionCircleArrays[mo];go===void 0&&(go=this.collisionCircleArrays[mo]=new Ga);for(let Ca=0;Ca<Ma.circles.length;Ca+=4)go.circles.push(Ma.circles[Ca+0]),go.circles.push(Ma.circles[Ca+1]),go.circles.push(Ma.circles[Ca+2]),go.circles.push(Ma.collisionDetected?1:0)}const Kl=S.projection.name!=="globe";cn=cn&&(Kl||!ea),Ln=Ln&&(Kl||!io),this.placements[va]=new Si(na||cn,In||Ln,Aa||S.justReloaded),h.add(va)},ji=this.retainedQueryData[S.bucketInstanceId].tileID;if(S.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(S,ji),S.elevationType==="road"&&S.updateRoadElevation(ji.canonical),S.updateZOffset(),S.sortFeaturesByY){const Hn=S.getSortedSymbolIndexes(this.transform.angle);for(let Wi=Hn.length-1;Wi>=0;--Wi){const Ji=Hn[Wi];hi(S.symbolInstances.get(Ji),Ji,S.collisionArrays[Ji])}S.hasAnyZOffset&&a.w(`${S.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(S.hasAnyZOffset){const Hn=S.getSortedIndexesByZOffset();for(let Wi=0;Wi<Hn.length;++Wi){const Ji=Hn[Wi];hi(S.symbolInstances.get(Ji),Ji,S.collisionArrays[Ji])}}else for(let Hn=o.symbolInstanceStart;Hn<o.symbolInstanceEnd;Hn++)hi(S.symbolInstances.get(Hn),Hn,S.collisionArrays[Hn]);if(m&&S.bucketInstanceId in this.collisionCircleArrays){const Hn=this.collisionCircleArrays[S.bucketInstanceId];a.bi(Hn.invProjMatrix,Q),Hn.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(o,h,m,w){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:D,crossTileID:Q}=m,V=a.b$(h),Z=w===a.bI.vertical?D:V==="left"?E:V==="center"?S:V==="right"?F:-1;E>=0&&(o.text.placedSymbolArray.get(E).crossTileID=Z>=0&&E!==Z?0:Q),S>=0&&(o.text.placedSymbolArray.get(S).crossTileID=Z>=0&&S!==Z?0:Q),F>=0&&(o.text.placedSymbolArray.get(F).crossTileID=Z>=0&&F!==Z?0:Q),D>=0&&(o.text.placedSymbolArray.get(D).crossTileID=Z>=0&&D!==Z?0:Q)}markUsedOrientation(o,h,m){const w=h===a.bI.horizontal||h===a.bI.horizontalOnly?h:0,E=h===a.bI.vertical?h:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:F,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:Q}=m,V=o.text.placedSymbolArray;S>=0&&(V.get(S).placedOrientation=w),F>=0&&(V.get(F).placedOrientation=w),D>=0&&(V.get(D).placedOrientation=w),Q>=0&&(V.get(Q).placedOrientation=E)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let m=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const w=h?h.symbolFadeChange(o):1,E=h?h.opacities:{},S=h?h.variableOffsets:{},F=h?h.placedOrientations:{};for(const D in this.placements){const Q=this.placements[D],V=E[D];V?(this.opacities[D]=new Bi(V,w,Q.text,Q.icon,null,Q.clipped),m=m||Q.text!==V.text.placed||Q.icon!==V.icon.placed):(this.opacities[D]=new Bi(null,w,Q.text,Q.icon,Q.skipFade,Q.clipped),m=m||Q.text||Q.icon)}for(const D in E){const Q=E[D];if(!this.opacities[D]){const V=new Bi(Q,w,!1,!1);V.isHidden()||(this.opacities[D]=V,m=m||Q.text.placed||Q.icon.placed)}}for(const D in S)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=S[D]);for(const D in F)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=F[D]);m?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h,m,w){const E=new Set;for(const S of h){const F=S.getBucket(o);F&&S.latestFeatureIndex&&o.fqid===F.layerIds[0]&&(this.updateBucketOpacities(F,E,S,S.collisionBoxArray,m,w,S.tileID,o.scope),F.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(F,S.tileID),F.elevationType==="road"&&F.updateRoadElevation(S.tileID.canonical),F.updateZOffset())}}updateBucketOpacities(o,h,m,w,E,S,F,D){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const Q=o.layers[0].layout,V=o.layers[0].paint,Z=!!o.layers[0].dynamicFilter(),K=new Bi(null,0,!1,!1,!0),ee=Q.get("text-allow-overlap"),he=Q.get("icon-allow-overlap"),le=Q.get("text-variable-anchor"),Ae=Q.get("text-rotation-alignment")==="map",fe=Q.get("text-pitch-alignment")==="map",Ce=V.get("symbol-z-offset"),ke=Q.get("symbol-elevation-reference")==="sea",He=!Ce.isConstant(),$e=new Bi(null,0,ee&&(he||!o.hasIconData()||Q.get("icon-optional")),he&&(ee||!o.hasTextData()||Q.get("text-optional")),!0);!o.collisionArrays&&w&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(w);const it=(Xe,Ye,tt)=>{for(let Pt=0;Pt<Ye/4;Pt++)Xe.opacityVertexArray.emplaceBack(tt)};let ct=0;S&&o.updateReplacement(F,S);for(let Xe=0;Xe<o.symbolInstances.length;Xe++){const Ye=o.symbolInstances.get(Xe),{numHorizontalGlyphVertices:tt,numVerticalGlyphVertices:Pt,crossTileID:gt,numIconVertices:Jt,tileAnchorX:kt,tileAnchorY:or}=Ye;let pr=null;const It=this.retainedQueryData[o.bucketInstanceId];He&&Ye&&It&&(pr=m.latestFeatureIndex.loadFeature({featureIndex:Ye.featureIndex,bucketIndex:It.bucketIndex,sourceLayerIndex:It.sourceLayerIndex,layoutVertexArrayOffset:0}));const ht=Ce.evaluate(pr,{}),zt=h.has(gt);let Ot=this.opacities[gt];zt?Ot=K:Ot||(Ot=$e,this.opacities[gt]=Ot),h.add(gt);const fr=tt>0||Pt>0,Ar=Jt>0,yr=this.placedOrientations[gt],Br=yr===a.bI.vertical,ln=yr===a.bI.horizontal||yr===a.bI.horizontalOnly;!fr&&!Ar||Ot.isHidden()||ct++;let dn=!1;if((fr||Ar)&&S)for(const Wr of o.activeReplacements){if(a.bV(Wr,E,a.bW.Symbol,D)||Wr.min.x>kt||kt>Wr.max.x||Wr.min.y>or||or>Wr.max.y)continue;const An=a.bX(kt,or,F.canonical,Wr.footprintTileId.canonical);if(dn=a.bY(An,Wr.footprint),dn)break}if(fr){const Wr=dn?ic:Yc(Ot.text);it(o.text,tt,Br?ic:Wr),it(o.text,Pt,ln?ic:Wr);const An=Ot.text.isHidden(),{leftJustifiedTextSymbolIndex:cn,centerJustifiedTextSymbolIndex:Ln,rightJustifiedTextSymbolIndex:Wn,verticalPlacedTextSymbolIndex:hi}=Ye,ji=o.text.placedSymbolArray,Hn=An||Br?1:0;cn>=0&&(ji.get(cn).hidden=Hn),Ln>=0&&(ji.get(Ln).hidden=Hn),Wn>=0&&(ji.get(Wn).hidden=Hn),hi>=0&&(ji.get(hi).hidden=An||ln?1:0);const Wi=this.variableOffsets[gt];Wi&&this.markUsedJustification(o,Wi.anchor,Ye,yr);const Ji=this.placedOrientations[gt];Ji&&(this.markUsedJustification(o,"left",Ye,Ji),this.markUsedOrientation(o,Ji,Ye))}if(Ar){const Wr=dn?ic:Yc(Ot.icon),{placedIconSymbolIndex:An,verticalPlacedIconSymbolIndex:cn}=Ye,Ln=o.icon.placedSymbolArray,Wn=Ot.icon.isHidden()?1:0;An>=0&&(it(o.icon,Jt,Br?ic:Wr),Ln.get(An).hidden=Wn),cn>=0&&(it(o.icon,Ye.numVerticalIconVertices,ln?ic:Wr),Ln.get(cn).hidden=Wn)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Wr=o.collisionArrays[Xe];if(Wr){let An=new a.P(0,0),cn=!0;if(Wr.textBox||Wr.verticalTextBox){if(le){const Wn=this.variableOffsets[gt];Wn?(An=Un(Wn.anchor,Wn.width,Wn.height,Wn.textOffset,Wn.textScale),Ae&&An._rotate(fe?this.transform.angle:-this.transform.angle)):cn=!1}Z&&(cn=!Ot.clipped),Wr.textBox&&Qo(o.textCollisionBox.collisionVertexArray,Ot.text.placed,!cn||Br,ht,ke,An.x,An.y),Wr.verticalTextBox&&Qo(o.textCollisionBox.collisionVertexArray,Ot.text.placed,!cn||ln,ht,ke,An.x,An.y)}const Ln=cn&&!!(!ln&&Wr.verticalIconBox);Wr.iconBox&&Qo(o.iconCollisionBox.collisionVertexArray,Ot.icon.placed,Ln,ht,ke,Ye.hasIconTextFit?An.x:0,Ye.hasIconTextFit?An.y:0),Wr.verticalIconBox&&Qo(o.iconCollisionBox.collisionVertexArray,Ot.icon.placed,!Ln,ht,ke,Ye.hasIconTextFit?An.x:0,Ye.hasIconTextFit?An.y:0)}}}if(o.fullyClipped=ct===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const Xe=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=Xe.invProjMatrix,o.placementViewportMatrix=Xe.viewportMatrix,o.collisionCircleArray=Xe.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){const m=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*m>o}setStale(){this.stale=!0}}function Qo(p,o,h,m,w,E,S){p.emplaceBack(o?1:0,h?1:0,E||0,S||0,m,w?1:0),p.emplaceBack(o?1:0,h?1:0,E||0,S||0,m,w?1:0),p.emplaceBack(o?1:0,h?1:0,E||0,S||0,m,w?1:0),p.emplaceBack(o?1:0,h?1:0,E||0,S||0,m,w?1:0)}const Oi=Math.pow(2,25),qu=Math.pow(2,24),Af=Math.pow(2,17),df=Math.pow(2,16),os=Math.pow(2,9),Qa=Math.pow(2,8),cd=Math.pow(2,1);function Yc(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const o=p.placed?1:0,h=Math.floor(127*p.opacity);return h*Oi+o*qu+h*Af+o*df+h*os+o*Qa+h*cd+o}const ic=0;class _s{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,h,m,w,E,S){const F=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(F,w,o[this._currentTileIndex],this._sortAcrossTiles,S),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((D,Q)=>D.sortKey-Q.sortKey));this._currentPartIndex<F.length;){const D=F[this._currentPartIndex];if(h.placeLayerBucketPart(D,this._seenCrossTileIDs,m,D.symbolInstanceStart===0,S),this._currentPartIndex++,E())return!0}return!1}}class xu{constructor(o,h,m,w,E,S,F,D,Q){this.placement=new Ka(o,E,S,F,D,Q),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(o,h,m,w,E){const S=a.q.now(),F=()=>{const D=a.q.now()-S;return!this._forceFullPlacement&&D>2};for(;this._currentPlacementIndex>=0;){const D=h[o[this._currentPlacementIndex]],Q=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&(!D.minzoom||D.minzoom<=Q)&&(!D.maxzoom||D.maxzoom>Q)){const V=D,Z=V.layout.get("symbol-z-elevate"),K=V.layout.get("symbol-sort-key").constantOr(1)!==void 0,ee=V.layout.get("symbol-z-order"),he=ee==="viewport-y"||ee==="auto"&&!(ee!=="viewport-y"&&K),le=V.layout.get("text-allow-overlap")||V.layout.get("icon-allow-overlap")||V.layout.get("text-ignore-placement")||V.layout.get("icon-ignore-placement"),Ae=he&&le,fe=this._inProgressLayer=this._inProgressLayer||new _s(V),Ce=a.C(D.source,D.scope);if(fe.continuePlacement(Z||Ae?w[Ce]:m[Ce],this.placement,this._showCollisionBoxes,D,F,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Sc=512/a.aj/2;class Qh{constructor(o,h,m){this.tileID=o,this.bucketInstanceId=m,this.index=new a.c0(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=o.canonical.x*a.aj,E=o.canonical.y*a.aj;for(let S=0;S<h.length;S++){const{key:F,crossTileID:D,tileAnchorX:Q,tileAnchorY:V}=h.get(S),Z=Math.floor((w+Q)*Sc),K=Math.floor((E+V)*Sc);this.index.add(Z,K),this.keys.push(F),this.crossTileIDs.push(D)}this.index.finish()}findMatches(o,h,m){const w=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),E=Sc/Math.pow(2,h.canonical.z-this.tileID.canonical.z),S=h.canonical.x*a.aj,F=h.canonical.y*a.aj;for(let D=0;D<o.length;D++){const Q=o.get(D);if(Q.crossTileID)continue;const{key:V,tileAnchorX:Z,tileAnchorY:K}=Q,ee=Math.floor((S+Z)*E),he=Math.floor((F+K)*E),le=this.index.range(ee-w,he-w,ee+w,he+w).sort((Ae,fe)=>Ae-fe);for(const Ae of le){const fe=this.crossTileIDs[Ae];if(this.keys[Ae]===V&&!m.has(fe)){m.add(fe),Q.crossTileID=fe;break}}}}}class zs{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ss{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const h=Math.round((o-this.lng)/360);if(h!==0)for(const m in this.indexes){const w=this.indexes[m],E={};for(const S in w){const F=w[S];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+h),E[F.tileID.key]=F}this.indexes[m]=E}this.lng=o}addBucket(o,h,m){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let E=0;E<h.symbolInstances.length;E++)h.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const w=this.usedCrossTileIDs[o.overscaledZ];for(const E in this.indexes){const S=this.indexes[E];if(Number(E)>o.overscaledZ)for(const F in S){const D=S[F];D.tileID.isChildOf(o)&&D.findMatches(h.symbolInstances,o,w)}else{const F=S[o.scaledTo(Number(E)).key];F&&F.findMatches(h.symbolInstances,o,w)}}for(let E=0;E<h.symbolInstances.length;E++){const S=h.symbolInstances.get(E);S.crossTileID||(S.crossTileID=m.generate(),w.add(S.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Qh(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(const m of h.crossTileIDs)this.usedCrossTileIDs[o].delete(m)}removeStaleBuckets(o){let h=!1;for(const m in this.indexes){const w=this.indexes[m];for(const E in w)o[w[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,w[E]),delete w[E],h=!0)}return h}}class fl{constructor(){this.layerIndexes={},this.crossTileIDs=new zs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,m,w){let E=this.layerIndexes[o.fqid];E===void 0&&(E=this.layerIndexes[o.fqid]=new ss);let S=!1;const F={};w.name!=="globe"&&E.handleWrapJump(m);for(const D of h){const Q=D.getBucket(o);Q&&o.fqid===Q.layerIds[0]&&(Q.bucketInstanceId||(Q.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(D.tileID,Q,this.crossTileIDs)&&(S=!0),F[Q.bucketInstanceId]=!0)}return E.removeStaleBuckets(F)&&(S=!0),S}pruneUnusedLayers(o){const h={};o.forEach(m=>{h[m]=!0});for(const m in this.layerIndexes)h[m]||delete this.layerIndexes[m]}}const wu=771;class Xn{constructor(o,h,m,w){this.blendFunction=o,this.blendColor=h.toNonPremultipliedRenderColor(null),this.mask=m,this.blendEquation=w}}Xn.Replace=[1,0,1,0],Xn.disabled=new Xn(Xn.Replace,a.am.transparent,[!1,!1,!1,!1]),Xn.unblended=new Xn(Xn.Replace,a.am.transparent,[!0,!0,!0,!0]),Xn.alphaBlended=new Xn([1,wu,1,wu],a.am.transparent,[!0,!0,!0,!0]),Xn.alphaBlendedNonPremultiplied=new Xn([770,wu,770,wu],a.am.transparent,[!0,!0,!0,!0]),Xn.multiply=new Xn([774,0,774,0],a.am.transparent,[!0,!0,!0,!0]);class Rr{constructor(o,h,m){this.func=o,this.mask=h,this.range=m}}Rr.ReadOnly=!1,Rr.ReadWrite=!0,Rr.disabled=new Rr(519,Rr.ReadOnly,[0,1]);const jo=7680;class bn{constructor(o,h,m,w,E,S){this.test=o,this.ref=h,this.mask=m,this.fail=w,this.depthFail=E,this.pass=S}}bn.disabled=new bn({func:519,mask:0},0,0,jo,jo,jo);const Ao=1029,Jc=2305;class xn{constructor(o,h,m){this.enable=o,this.mode=h,this.frontFace=m}}function Qs(p,o){const h=a.c6(p,3);a.c8(p,o),a.cc(p,3,h)}function js(p,o){const h=a.c3([]);return a.c4(h,h,-o),a.c5(h,h,-p),h}function ac(p,o){const h=[p[0],p[1],0],m=[o[0],o[1],0];if(a.ae(h)>=1e-15){const S=a.au([],h);a.c1(m,S,a.bG(m,S)),o[0]=m[0],o[1]=m[1]}const w=a.bF([],o,p);if(a.c2(w)<1e-15)return null;const E=Math.atan2(-w[1],w[0]);return js(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),E)}xn.disabled=new xn(!1,Ao,Jc),xn.backCCW=new xn(!0,Ao,Jc),xn.backCW=new xn(!0,Ao,2304),xn.frontCW=new xn(!0,1028,2304),xn.frontCCW=new xn(!0,1028,Jc);class Ql{constructor(o,h){this.position=o,this.orientation=h}get position(){return this._position}set position(o){if(o){const h=o instanceof a.ac?o:new a.ac(o[0],o[1],o[2]);this._renderWorldCopies&&(h.x=a.bQ(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(o,h){if(this.orientation=null,!this.position)return;const m=this.position,w=this._elevation?this._elevation.getAtPointOrZero(a.ac.fromLngLat(o)):0,E=a.ac.fromLngLat(o,w),S=[E.x-m.x,E.y-m.y,E.z-m.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=ac(S,h)}setPitchBearing(o,h){this.orientation=js(a.al(o),a.al(-h))}}class Zs{constructor(o,h){this._transform=a.bx([]),this.orientation=h,this.position=o}get mercatorPosition(){const o=this.position;return new a.ac(o[0],o[1],o[2])}get position(){const o=a.c6(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var h;o&&a.cc(this._transform,3,[(h=o)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||a.c3([]),o&&Qs(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,h){this._orientation=js(o,h),Qs(this._transform,this._orientation)}forward(){const o=a.c6(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=a.c6(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=a.c6(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,h){const m=new Float64Array(16);return a.bi(m,this.getWorldToCamera(o,h)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,h,m){const w=this.position;a.c1(w,w,-o);const E=new Float64Array(16);return a.bn(E,[m,m,m]),a.bo(E,E,w),E[10]*=h,E}getWorldToCamera(o,h){const m=new Float64Array(16),w=new Float64Array(4),E=this.position;return a.c7(w,this._orientation),a.c1(E,E,-o),a.c8(m,w),a.bo(m,m,E),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=h,m[9]*=h,m[10]*=h,m[11]*=h,m}getCameraToClipPerspective(o,h,m,w){const E=new Float64Array(16);return a.c9(E,o,h,m,w),E}getCameraToClipOrthographic(o,h,m,w,E,S){const F=new Float64Array(16);return a.ca(F,o,h,m,w,E,S),F}getDistanceToElevation(o,h=!1){const m=o===0?0:a.cb(o,h?a.aY(this.position[1]):this.position[1]),w=this.forward();return(m-this.position[2])/w[2]}clone(){return new Zs([...this.position],[...this.orientation])}}const Hs={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class bu{constructor(o=0,h=0,m=0,w=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(m)||m<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=m,this.right=w}interpolate(o,h,m){return h.top!=null&&o.top!=null&&(this.top=a.ai(o.top,h.top,m)),h.bottom!=null&&o.bottom!=null&&(this.bottom=a.ai(o.bottom,h.bottom,m)),h.left!=null&&o.left!=null&&(this.left=a.ai(o.left,h.left,m)),h.right!=null&&o.right!=null&&(this.right=a.ai(o.right,h.right,m)),this}getCenter(o,h){const m=a.ay((this.left+o-this.right)/2,0,o),w=a.ay((this.top+h-this.bottom)/2,0,h);return new a.P(m,w)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new bu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const fa=15;class EA{constructor(o,h,m,w,E,S,F){this.tileSize=512,this._renderWorldCopies=E===void 0||E,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=m??0,this._maxPitch=w??60,this.setProjection(S),this.setMaxBounds(F),this.width=0,this.height=0,this._center=new a.ci(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new bu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Zs,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const o=new EA(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o._allowWorldUnderZoom=this._allowWorldUnderZoom,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<fa}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,h=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(o||m)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return a.aF(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=a.cj(this.projectionOptions);const m=this.getProjection(),w=!a.bv(h,m);return w&&this._calcMatrices(),this.mercatorFromTransition=!1,w}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.cj({name:"mercator"});const h=o!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.cb(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.bQ(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const h=-o*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=a.ck(),a.cl(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const h=a.ay(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=a.al(o),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){const o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,h=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!h||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;h||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const o=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(o)}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let w=0,E=0;for(let S=0;S<h.length;S++){const F=new a.P(h[S][0]*this.width,m+h[S][1]*(this.height-m)),D=o.pointCoordinate(F);if(!D)continue;const Q=1/Math.hypot(D[0]-this._camera.position[0],D[1]-this._camera.position[1]);w+=D[3]*Q,E+=Q}return E===0?NaN:w/E}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*h,w=this._mercatorZfromZoom(o),E=this._mercatorZfromZoom(this._maxZoom),S=Math.max(w-m,E);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let m;m=o.z<this._camera.position[2]?[h.x,h.y,h.z]:[o.x,o.y,o.z];const w=a.ae(a.at([],this._camera.position,m));return a.ay(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let h=!1;if(o.orientation&&!a.cm(o.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(o.orientation)),o.position){const m=[o.position.x,o.position.y,o.position.z];a.cn(m,this._camera.position)||(this._setCameraPosition(m),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,h=new Ql;return h.position=new a.ac(o[0],o[1],o[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(o){if(!a.co(o))return!1;a.cp(o,o);const h=a.cq([],[0,0,-1],o),m=a.cq([],[0,-1,0],o);if(m[2]<0)return!1;const w=ac(h,m);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(o){const h=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;o[2]=a.ay(o[2],w/m,w/h),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,m){this._unmodified=!1,this._edgeInsets.interpolate(o,h,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){const h=[new a.cr(0,o)];if(this.renderWorldCopies){const m=this.pointCoordinate(new a.P(0,0)),w=this.pointCoordinate(new a.P(this.width,0)),E=this.pointCoordinate(new a.P(this.width,this.height)),S=this.pointCoordinate(new a.P(0,this.height)),F=Math.floor(Math.min(m.x,w.x,E.x,S.x)),D=Math.floor(Math.max(m.x,w.x,E.x,S.x)),Q=1;for(let V=F-Q;V<=D+Q;V++)V!==0&&h.push(new a.cr(V,o))}return h}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(o,h,m){let w=[];const E=m!=null,S=!E;if(S&&this.zoom<h||E&&m[0]===0&&m[1]===0)return w;const F=new Set,D=(V,Z,K,ee,he)=>{const le=a.cV(Z,V,K,ee,he);F.has(le)||(w.push(new a.aM(V,Z,K,ee,he)),F.add(le))};for(let V=0;V<o.length;V++){const Z=o[V];if(S&&Z.canonical.z!==h)continue;const K=Z.canonical,ee=Z.overscaledZ,he=Z.wrap,le=1<<K.z,Ae=K.x+1<le,fe=K.x>0,Ce=K.y+1<le,ke=K.y>0,He=Z.wrap-(fe?0:1),$e=Z.wrap+(Ae?0:1),it=fe?K.x-1:le-1,ct=Ae?K.x+1:0;if(E)m[0]<0?(D(ee,$e,K.z,ct,K.y),m[1]<0&&Ce&&(D(ee,he,K.z,K.x,K.y+1),D(ee,$e,K.z,ct,K.y+1)),m[1]>0&&ke&&(D(ee,he,K.z,K.x,K.y-1),D(ee,$e,K.z,ct,K.y-1))):m[0]>0?(D(ee,He,K.z,it,K.y),m[1]<0&&Ce&&(D(ee,he,K.z,K.x,K.y+1),D(ee,He,K.z,it,K.y+1)),m[1]>0&&ke&&(D(ee,he,K.z,K.x,K.y-1),D(ee,He,K.z,it,K.y-1))):m[1]<0&&Ce?D(ee,he,K.z,K.x,K.y+1):ke&&D(ee,he,K.z,K.x,K.y-1);else{const Xe=Z.visibleQuadrants;1&Xe&&(D(ee,He,K.z,it,K.y),ke&&(D(ee,he,K.z,K.x,K.y-1),D(ee,He,K.z,it,K.y-1))),2&Xe&&(D(ee,$e,K.z,ct,K.y),ke&&(D(ee,he,K.z,K.x,K.y-1),D(ee,$e,K.z,ct,K.y-1))),4&Xe&&(D(ee,He,K.z,it,K.y),Ce&&(D(ee,he,K.z,K.x,K.y+1),D(ee,He,K.z,it,K.y+1))),8&Xe&&(D(ee,$e,K.z,ct,K.y),Ce&&(D(ee,he,K.z,K.x,K.y+1),D(ee,$e,K.z,ct,K.y+1)))}}const Q=[];for(const V of w)w.some(Z=>V.isChildOf(Z))||Q.push(V);if(w=Q.filter(V=>!o.some(Z=>!!(V.overscaledZ<h&&Z.isChildOf(V))||V.equals(Z)||V.isChildOf(Z))),S){const V=1<<h,Z=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),K=[V*Z.x,V*Z.y],ee=4,he=ee*ee;w=w.filter(le=>{const Ae=le.canonical.x+.5-K[0],fe=le.canonical.y+.5-K[1];return Ae*Ae+fe*fe<he})}return w}extendTileCoverToNearPlane(o,h,m){const w=[],E=new Set;for(const Ce of o)E.add(Ce.key);const S=(Ce,ke,He,$e,it)=>{const ct=a.cV(ke,Ce,He,$e,it);E.has(ct)||(w.push(new a.aM(Ce,ke,He,$e,it)),E.add(ct))},F=o.reduce((Ce,ke)=>Math.max(Ce,ke.overscaledZ),m),D=1<<m,Q=[new a.P(0,0),new a.P(a.aj,0),new a.P(a.aj,a.aj),new a.P(0,a.aj)],V=new a.P(0,0),Z=new a.P(0,0),K=(Ce,ke)=>{const He=Math.floor(Ce[0]),$e=Math.floor(Ce[1]),it=(Ce[0]-He)*a.aj,ct=(Ce[1]-$e)*a.aj,Xe=Math.floor(ke[0]),Ye=Math.floor(ke[1]),tt=(ke[0]-Xe)*a.aj,Pt=(ke[1]-Ye)*a.aj;for(let gt=-1;gt<=1;gt++){const Jt=He+gt;if(!(Jt<0||Jt>=D)){V.x=it-gt*a.aj,Z.x=tt-(Jt-Xe)*a.aj;for(let kt=-1;kt<=1;kt++){const or=$e+kt;V.y=ct-kt*a.aj,Z.y=Pt-(or-Ye)*a.aj,a.cW(V,Z,Q)&&S(F,0,m,Jt,or)}}}},ee=h.points,he=ee[a.cs],le=ee[a.ct],Ae=this._projectToGround(he,ee[a.cu]),fe=this._projectToGround(le,ee[a.cv]);return K(he,Ae),K(le,fe),w}_projectToGround(o,h){return a.cw(a.cx(),o,h,o[2]/(o[2]-h[2]))}coveringTiles(o){let h=this.coveringZoomLevel(o);const m=h,w=this.elevation&&this.elevation.exaggeration(),E=w&&!o.isTerrainDEM,S=this.projection.name==="mercator";if(o.minzoom!==void 0&&h<o.minzoom)return[];o.maxzoom!==void 0&&h>o.maxzoom&&(h=o.maxzoom);const F=this.locationCoordinate(this.center),D=this.center.lat,Q=1<<h,V=[Q*F.x,Q*F.y,0],Z=this.projection.name==="globe",K=!Z,ee=a.cy.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,K),he=Z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),le=Q*a.cb(1,this.center.lat),Ae=this._camera.position[2]/a.cb(1,this.center.lat),fe=[Q*he.x,Q*he.y,Ae*(K?1:le)],Ce=Z||w,ke=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),He=this.isLODDisabled(!0)?h:0;let $e;if(this._elevation&&o.isTerrainDEM)$e=1e4*this._elevation.exaggeration();else if(this._elevation){const ht=this._elevation.getMinMaxForVisibleTiles();$e=ht?ht.max:this._centerAltitude}else $e=this._centerAltitude;const it=o.isTerrainDEM?-$e:this._elevation?this._elevation.getMinElevationBelowMSL():0,ct=this.projection.isReprojectedInTileSpace?a.cz(this):1,Xe=ht=>{const Ot=new a.ac(ht.x+25e-6,ht.y,ht.z),fr=new a.ac(ht.x,ht.y+25e-6,ht.z),Ar=ht.toLngLat(),yr=Ot.toLngLat(),Br=fr.toLngLat(),ln=this.locationCoordinate(Ar),dn=this.locationCoordinate(yr),Wr=this.locationCoordinate(Br),An=Math.hypot(dn.x-ln.x,dn.y-ln.y),cn=Math.hypot(Wr.x-ln.x,Wr.y-ln.y);return Math.sqrt(An*cn)*ct/25e-6},Ye=ht=>{const zt=$e,Ot=it;return{aabb:a.cC(this,Q,0,0,0,ht,Ot,zt,this.projection),zoom:0,x:0,y:0,minZ:Ot,maxZ:zt,wrap:ht,fullyVisible:!1}},tt=[];let Pt=[];const gt=h,Jt=o.reparseOverscaled?m:h,kt=(Ae-this._centerAltitude)*le,or=ht=>{if(!this._elevation||!ht.tileID||!S)return;const zt=this._elevation.getMinMaxForTile(ht.tileID),Ot=ht.aabb;zt?(Ot.min[2]=zt.min,Ot.max[2]=zt.max,Ot.center[2]=(Ot.min[2]+Ot.max[2])/2):(ht.shouldSplit=It(ht),ht.shouldSplit||(Ot.min[2]=Ot.max[2]=Ot.center[2]=this._centerAltitude))},pr=(ht,zt)=>{if(.707*zt<ht)return 1;const Ot=zt/ht;return Ot/(1.4144271570014144+(Math.pow(1.1,Ot-1.4144271570014144+1)-1)/(1.1-1)-1)},It=ht=>{if(ht.zoom<He)return!0;if(ht.zoom===gt)return!1;if(ht.shouldSplit!=null)return ht.shouldSplit;const zt=ht.aabb.distanceX(fe),Ot=ht.aabb.distanceY(fe);let fr=kt,Ar=1;if(Z){fr=ht.aabb.distanceZ(fe);const cn=Math.pow(2,ht.zoom),Ln=a.aY((ht.y+1)/cn),Wn=a.aY(ht.y/cn),hi=Math.min(Math.max(D,Ln),Wn),ji=a.c_(hi)/a.c_(D);if(Ar=hi===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ji/this._mercatorScaleRatio),this.zoom<=a.cX&&ht.zoom===gt-1&&ji>=.9)return!0}else if(E&&(fr=ht.aabb.distanceZ(fe)*le),this.projection.isReprojectedInTileSpace&&m<=5){const cn=Math.pow(2,ht.zoom),Ln=Xe(new a.ac((ht.x+.5)/cn,(ht.y+.5)/cn));Ar=Ln>.85?1:Ln}if(!S){const cn=Math.sqrt(zt*zt+Ot*Ot+fr*fr);let Ln=(1<<gt-ht.zoom)*ke*Ar;return Ln*=pr(Math.max(fr,kt),cn),cn<Ln}let yr=Number.MAX_VALUE,Br=0;const ln=ht.aabb.getCorners(),dn=[];for(const cn of ln){a.at(dn,cn,fe),Z||(E?dn[2]*=le:dn[2]=kt);const Ln=a.bG(dn,this._camera.forward());Ln<yr&&(yr=Ln,Br=Math.abs(dn[2]))}let Wr=(1<<gt-ht.zoom)*ke*Ar;if(Wr*=pr(Math.max(Br,kt),yr),yr<Wr)return!0;const An=ht.aabb.closestPoint(V);return An[0]===V[0]&&An[1]===V[1]};if(this.renderWorldCopies)for(let ht=1;ht<=3;ht++)tt.push(Ye(-ht)),tt.push(Ye(ht));for(tt.push(Ye(0));tt.length>0;){const ht=tt.pop(),zt=ht.x,Ot=ht.y;let fr=ht.fullyVisible;const Ar=()=>this.projection.name==="globe"&&(ht.y===0||ht.y===(1<<ht.zoom)-1);if(!fr){let yr=Ce?ht.aabb.intersects(ee):ht.aabb.intersectsFlat(ee);if(yr===0&&Ar()){const Br=new a.cA(ht.zoom,zt,Ot);yr=a.cB(this,Q,Br,!0).intersects(ee)}if(yr===0)continue;fr=yr===2}if(ht.zoom!==gt&&It(ht))for(let yr=0;yr<4;yr++){const Br=(zt<<1)+yr%2,ln=(Ot<<1)+(yr>>1),dn={aabb:S?ht.aabb.quadrant(yr):a.cC(this,Q,ht.zoom+1,Br,ln,ht.wrap,ht.minZ,ht.maxZ,this.projection),zoom:ht.zoom+1,x:Br,y:ln,wrap:ht.wrap,fullyVisible:fr,tileID:void 0,shouldSplit:void 0,minZ:ht.minZ,maxZ:ht.maxZ};E&&!Z&&(dn.tileID=new a.aM(ht.zoom+1===gt?Jt:ht.zoom+1,ht.wrap,ht.zoom+1,Br,ln),or(dn)),tt.push(dn)}else{const yr=ht.zoom===gt?Jt:ht.zoom;if(o.minzoom&&o.minzoom>yr)continue;let Br=0;if(!fr){let An=Ce?ht.aabb.intersectsPrecise(ee):ht.aabb.intersectsPreciseFlat(ee);if(An===0&&Ar()){const cn=new a.cA(ht.zoom,zt,Ot);An=a.cB(this,Q,cn,!0).intersectsPrecise(ee)}if(An===0)continue;if(o.calculateQuadrantVisibility)if(ee.containsPoint(ht.aabb.center))Br=15;else for(let cn=0;cn<4;cn++)ht.aabb.quadrant(cn).intersects(ee)!==0&&(Br|=1<<cn)}const ln=V[0]-(.5+zt+(ht.wrap<<ht.zoom))*(1<<h-ht.zoom),dn=V[1]-.5-Ot,Wr=ht.tileID?ht.tileID:new a.aM(yr,ht.wrap,ht.zoom,zt,Ot);o.calculateQuadrantVisibility&&(Wr.visibleQuadrants=Br),Pt.push({tileID:Wr,distanceSq:ln*ln+dn*dn})}}if(this.fogCullDistSq){const ht=this.fogCullDistSq,zt=this.horizonLineFromTop();Pt=Pt.filter(Ot=>{const fr=[0,0,0,1],Ar=[a.aj,a.aj,0,1],yr=this.calculateFogTileMatrix(Ot.tileID.toUnwrapped());a.aA(fr,fr,yr),a.aA(Ar,Ar,yr);const Br=a.cD([],fr,Ar),ln=a.cE([],fr,Ar),dn=a.cY(Br,ln);if(dn===0)return!0;let Wr=!1;const An=this._elevation;if(An&&dn>ht&&zt!==0){const cn=this.calculateProjMatrix(Ot.tileID.toUnwrapped());let Ln;o.isTerrainDEM||(Ln=An.getMinMaxForTile(Ot.tileID)),Ln||(Ln={min:it,max:$e});const Wn=a.cF(this.rotation),hi=[Wn[0]*a.aj,Wn[1]*a.aj,Ln.max];a.ad(hi,hi,cn),Wr=(1-hi[1])*this.height*.5<zt}return dn<ht||Wr})}return Pt.sort((ht,zt)=>ht.distanceSq-zt.distanceSq).map(ht=>ht.tileID)}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const h=a.ay(o.lat,-a.cG,a.cG),m=this.projection.project(o.lng,h);return new a.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.cb(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,h){let m,w;const E=this.centerPoint;if(this.projection.name==="globe"){const F=this.worldSize;m=(h.x-E.x)/F,w=(h.y-E.y)/F}else{const F=this.pointCoordinate(h),D=this.pointCoordinate(E);m=F.x-D.x,w=F.y-D.y}const S=this.locationCoordinate(o);this.setLocation(new a.ac(S.x-m,S.y-w))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o,h){return this.projection.locationPoint(this,o,h)}locationPoint3D(o,h){return this.projection.locationPoint(this,o,h,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o,h){return this.coordinateLocation(this.pointCoordinate3D(o,h))}locationCoordinate(o,h){const m=h?a.cb(h,o.lat):void 0,w=this.projection.project(o.lng,o.lat);return new a.ac(w.x,w.y,m)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,h){const m=h??this._centerAltitude,w=[o.x,o.y,0,1],E=[o.x,o.y,1,1];a.aA(w,w,this.pixelMatrixInverse),a.aA(E,E,this.pixelMatrixInverse);const S=E[3];a.cH(w,w,1/w[3]),a.cH(E,E,1/S);const F=w[2],D=E[2];return{p0:w,p1:E,t:F===D?0:(m-F)/(D-F)}}screenPointToMercatorRay(o){const h=[o.x,o.y,0,1],m=[o.x,o.y,1,1];return a.aA(h,h,this.pixelMatrixInverse),a.aA(m,m,this.pixelMatrixInverse),a.cH(h,h,1/h[3]),a.cH(m,m,1/m[3]),h[2]=a.cb(h[2],this._center.lat)*this.worldSize,m[2]=a.cb(m[2],this._center.lat)*this.worldSize,a.cH(h,h,1/this.worldSize),a.cH(m,m,1/this.worldSize),new a.av([h[0],h[1],h[2]],a.au([],a.at([],m,h)))}rayIntersectionCoordinate(o){const{p0:h,p1:m,t:w}=o,E=a.cb(h[2],this._center.lat),S=a.cb(m[2],this._center.lat);return new a.ac(a.ai(h[0],m[0],w)/this.worldSize,a.ai(h[1],m[1],w)/this.worldSize,a.ai(E,S,w))}pointCoordinate(o,h=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,h)}pointCoordinate3D(o,h){if(!this.elevation)return this.pointCoordinate(o,h);let m=this.projection.pointCoordinate3D(this,o.x,o.y);if(m)return new a.ac(m[0],m[1],m[2]);let w=0,E=this.horizonLineFromTop();if(o.y>E)return this.pointCoordinate(o,h);const S=.02*E,F=o.clone();for(let D=0;D<10&&E-w>S;D++){F.y=a.ai(w,E,.66);const Q=this.projection.pointCoordinate3D(this,F.x,F.y);Q?(E=F.y,m=Q):w=F.y}return m?new a.ac(m[0],m[1],m[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=a.cI)return!this.isPointAboveHorizon(o);const h=this.pointCoordinate(o);return h.y>=0&&h.y<=1}_coordinatePoint(o,h){const m=h&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,w=[o.x*this.worldSize,o.y*this.worldSize,m+o.toAltitude(),1];return a.aA(w,w,this.pixelMatrix),w[3]>0?new a.P(w[0]/w[3],w[1]/w[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:h}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,E=this.pointLocation3D(new a.P(h,o)),S=this.pointLocation3D(new a.P(w,o)),F=this.pointLocation3D(new a.P(w,m)),D=this.pointLocation3D(new a.P(h,m));let Q=Math.min(E.lng,S.lng,F.lng,D.lng),V=Math.max(E.lng,S.lng,F.lng,D.lng),Z=Math.min(E.lat,S.lat,F.lat,D.lat),K=Math.max(E.lat,S.lat,F.lat,D.lat);const ee=Math.pow(2,-this.zoom)/16*270,he=this.projection.name==="globe"?1:4,le=(Ae,fe,Ce,ke,He)=>{const $e=(Ae+Ce)/2,it=(fe+ke)/2,ct=new a.P($e,it),{lng:Xe,lat:Ye}=this.pointLocation3D(ct),tt=Math.max(0,Q-Xe,Z-Ye,Xe-V,Ye-K);Q=Math.min(Q,Xe),V=Math.max(V,Xe),Z=Math.min(Z,Ye),K=Math.max(K,Ye),(He<he||tt>ee)&&(le(Ae,fe,$e,it,He+1),le($e,it,Ce,ke,He+1))};if(le(h,o,w,o,1),le(w,o,w,m,1),le(w,m,h,m,1),le(h,m,h,o,1),this.projection.name==="globe"){const[Ae,fe]=a.cJ(this);Ae?(K=90,V=180,Q=-180):fe&&(Z=-90,V=180,Q=-180)}return new a.aG(new a.ci(Q,Z),new a.ci(V,K))}_getBoundsRectangular(o,h){const{top:m,left:w}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,F=new a.P(w,m),D=new a.P(S,m),Q=new a.P(S,E),V=new a.P(w,E);let Z=this.pointCoordinate(F,o),K=this.pointCoordinate(D,o);const ee=this.pointCoordinate(Q,h),he=this.pointCoordinate(V,h),le=(Ae,fe)=>(fe.y-Ae.y)/(fe.x-Ae.x);return Z.y>1&&K.y>=0?Z=new a.ac((1-he.y)/le(he,Z)+he.x,1):Z.y<0&&K.y<=1&&(Z=new a.ac(-he.y/le(he,Z)+he.x,0)),K.y>1&&Z.y>=0?K=new a.ac((1-ee.y)/le(ee,K)+ee.x,1):K.y<0&&Z.y<=1&&(K=new a.ac(-ee.y/le(ee,K)+ee.x,0)),new a.aG().extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(K)).extend(this.coordinateLocation(he)).extend(this.coordinateLocation(ee))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=o.visibleDemTiles.reduce((m,w)=>{if(w.dem){const E=w.dem.tree;m.min=Math.min(m.min,E.minimums[0]),m.max=Math.max(m.max,E.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*o.exaggeration(),h.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-h*(1-this._horizonShift);return o?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-a.cG,this.maxLat=a.cG,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.aD(this.minLng)*this.tileSize,this.worldMaxX=a.aD(this.maxLng)*this.tileSize,this.worldMinY=a.aH(this.maxLat)*this.tileSize,this.worldMaxY=a.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,h){return this.projection.createTileMatrix(this,h,o)}calculateDistanceTileData(o){const h=o.key,m=this._distanceTileDataCache;if(m[h])return m[h];const w=o.canonical,E=1/this.height,S=this.cameraWorldSize,F=S/this.zoomScale(w.z),D=(w.x+Math.pow(2,w.z)*o.wrap)*F,Q=w.y*F,V=this.point;V.x*=S/this.worldSize,V.y*=S/this.worldSize;const Z=this.angle,K=Math.sin(-Z),ee=-Math.cos(-Z);return m[h]={bearing:[K,ee],center:[(V.x-D)*E,(V.y-Q)*E],scale:F/a.aj*E},m[h]}calculateFogTileMatrix(o){const h=o.key,m=this._fogTileMatrixCache;if(m[h])return m[h];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return a.az(w,this.worldToFogMatrix,w),m[h]=new Float32Array(w),m[h]}calculateProjMatrix(o,h=!1,m=!1){const w=o.key;let E;if(E=m?this._expandedProjMatrixCache:h?this._alignedProjMatrixCache:this._projMatrixCache,E[w])return E[w];const S=this.calculatePosMatrix(o,this.worldSize);let F;return F=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:h?this.alignedProjMatrix:this.projMatrix,a.az(S,F,S),E[w]=new Float32Array(S),E[w]}calculatePixelsToTileUnitsMatrix(o){const h=o.tileID.key,m=this._pixelsToTileUnitsCache;if(m[h])return m[h];const w=a.cK(o,this);return m[h]=w,m[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,h=a.bn([],[o,o,o]);return a.az(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const h=a.cb(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(h),w=this._camera.forward(),E=a.cb(1,this._center.lat);m[2]/=E,w[2]/=E,a.au(w,w);const S=o.raycast(m,w,o.exaggeration());if(S){const F=a.bE([],m,w,S),D=new a.ac(F[0],F[1],a.cb(F[2],a.aY(F[1]))),Q=(D.z+a.ae([D.x-m[0],D.y-m[1],D.z-m[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Q),this._centerAltitude=D.toAltitude(),this._center=this.coordinateLocation(D),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const h=this._elevation,m=a.cb(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(m),E=h.getAtPointOrZero(new a.ac(...w)),S=this.pixelsPerMeter/this.worldSize*E,F=this._minimumHeightOverTerrain(),D=w[2]-S;if(D<=F)if(D<0||o){const Q=this.locationCoordinate(this._center,this._centerAltitude),V=[w[0],w[1],Q.z-w[2]],Z=a.ae(V);V[2]-=(F-D)/this._pixelsPerMercatorPixel;const K=a.ae(V);if(K===0)return;a.c1(V,V,Z/K*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],Q.z*this._pixelsPerMercatorPixel-V[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const K=this.center;return K.lat=a.ay(K.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(K.lng=a.ay(K.lng,this.minLng,this.maxLng)),this.center=K,void(this._constraining=!1)}const h=this._unmodified,{x:m,y:w}=this.point;let E=0,S=m,F=w;const D=this.width/2,Q=this.height/2,V=this.worldMinY*this.scale,Z=this.worldMaxY*this.scale;if(w-Q<V&&(F=V+Q),w+Q>Z&&(F=Z-Q),Z-V<this.height&&(E=Math.max(E,this.height/(Z-V)),F=(Z+V)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const K=this.worldMinX*this.scale,ee=this.worldMaxX*this.scale,he=this.worldSize/2-(K+ee)/2;S=(m+he+this.worldSize)%this.worldSize-he,S-D<K&&(S=K+D),S+D>ee&&(S=ee-D),ee-K<this.width&&(E=Math.max(E,this.width/(ee-K)),S=(ee+K)/2)}S===m&&F===w||this._allowWorldUnderZoom||(this.center=this.unproject(new a.P(S,F))),E&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,h=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.cb(1,this.center.lat)/a.cb(1,a.c$));const w=a.cL(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E=this.projection.zAxisUnit==="meters"?m:1,S=this._camera.getWorldToCamera(this.worldSize,E);let F;const D=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(D[8]=2*-o.x/this.width,D[9]=2*o.y/this.height,this.isOrthographic){let Ye=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),tt=Ye*this.aspect,Pt=-tt,gt=-Ye;tt-=o.x,Pt-=o.x,Ye+=o.y,gt+=o.y,F=this._camera.getCameraToClipOrthographic(Pt,tt,gt,Ye,this._nearZ,this._farZ),((Jt,kt,or,pr)=>{for(let It=0;It<16;It++)Jt[It]=a.ai(kt[It],or[It],pr)})(F,F,D,a.cZ(this.pitch>=fa?1:this.pitch/fa))}else F=D;const Q=a.cM([],D,S);let V=a.cM([],F,S);if(this.projection.isReprojectedInTileSpace){const Ye=this.locationCoordinate(this.center),tt=a.bx([]);a.bo(tt,tt,[Ye.x*this.worldSize,Ye.y*this.worldSize,0]),a.az(tt,tt,a.cN(this)),a.bo(tt,tt,[-Ye.x*this.worldSize,-Ye.y*this.worldSize,0]),a.az(V,V,tt),a.az(Q,Q,tt),this.inverseAdjustmentMatrix=a.cO(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.cP([],V,[this.worldSize,this.worldSize,this.worldSize/E,1]),this.projMatrix=V,this.invProjMatrix=a.bi(new Float64Array(16),this.projMatrix),h){const Ye=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ye[8]=2*-o.x/this.width,Ye[9]=2*o.y/this.height,this.expandedFarZProjMatrix=a.cM([],Ye,S)}else this.expandedFarZProjMatrix=this.projMatrix;const Z=a.bi([],F);this.frustumCorners=a.cQ.fromInvProjectionMatrix(Z,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.cy.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!h);const K=new Float32Array(16);a.bx(K),a.cP(K,K,[1,-1,1]),a.cR(K,K,this._pitch),a.by(K,K,this.angle);const ee=a.c9(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.bw(ee);const he=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ee[8]=2*-o.x/this.width,ee[9]=2*(o.y+he)/this.height,this.skyboxMatrix=a.az(K,ee,K);const le=this.point,Ae=le.x,fe=le.y,Ce=this.width%2/2,ke=this.height%2/2,He=Math.cos(this.angle),$e=Math.sin(this.angle),it=Ae-Math.round(Ae)+He*Ce+$e*ke,ct=fe-Math.round(fe)+He*ke+$e*Ce,Xe=new Float64Array(V);if(a.bo(Xe,Xe,[it>.5?it-1:it,ct>.5?ct-1:ct,0]),this.alignedProjMatrix=Xe,V=a.bz(),a.cP(V,V,[this.width/2,-this.height/2,1]),a.bo(V,V,[1,-1,0]),this.labelPlaneMatrix=V,V=a.bz(),a.cP(V,V,[1,-1,1]),a.bo(V,V,[-1,-1,0]),a.cP(V,V,[2/this.width,2/this.height,1]),this.glCoordMatrix=V,this.pixelMatrix=a.az(new Float64Array(16),this.labelPlaneMatrix,Q),this._calcFogMatrices(),this._distanceTileDataCache={},V=a.bi(new Float64Array(16),this.pixelMatrix),!V)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=V,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.cS(this);const Ye=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.ad(Ye,Ye,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=V;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,m=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,E=[o,o,h];a.c1(E,E,w),a.c1(m,m,-1),a.cT(m,m,E);const S=a.bz();a.bo(S,S,m),a.cP(S,S,E),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,h,w)}_computeCameraPosition(o){const h=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),w=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-o/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-m[0]*E,w.y/this.worldSize-m[1]*E,o/this.worldSize*this._centerAltitude-m[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],w=o[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(E=Math.min((h-m)/w,1)),this._camera.position=a.bE([],this._camera.position,o,E),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,h=this._camera.forward(),{pitch:m,bearing:w}=this._camera.getPitchBearing(),E=a.cb(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.al(this._maxPitch)),F=Math.max((o[2]-E)/Math.cos(m),S),D=this._zoomFromMercatorZ(F);a.bE(o,o,h,F),this._pitch=a.ay(m,a.al(this.minPitch),a.al(this.maxPitch)),this.angle=a.bQ(w,-Math.PI,Math.PI),this._setZoom(a.ay(D,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.ac(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,o)*this.tileSize))}zoomFromMercatorZAdjusted(o){let h=0,m=a.cI,w=0,E=1/0;for(;m-h>1e-6&&m>h;){const S=h+.5*(m-h),F=this.tileSize*Math.pow(2,S),D=this.getCameraToCenterDistance(this.projection,S,F),Q=this.scaleZoom(D/(Math.max(0,o)*this.tileSize)),V=Math.abs(S-Q);V<E&&(E=V,w=S),S<Q?h=S:m=S}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,h){const m=Math.min(o.x,h.x),w=Math.max(o.x,h.x),E=Math.min(o.y,h.y),S=Math.max(o.y,h.y);if(E<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const F=[new a.P(m,E),new a.P(w,S),new a.P(m,S),new a.P(w,E)],D=this.renderWorldCopies?-3:0,Q=this.renderWorldCopies?4:1;for(const V of F){const Z=this.pointRayIntersection(V);if(Z.t<0)return!0;const K=this.rayIntersectionCoordinate(Z);if(K.x<D||K.y<0||K.x>Q||K.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.cU(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(o,h){const m=a.ae(a.at([],this._camera.position,o)),w=this._zoomFromMercatorZ(m)+h;return m-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([h,m,w],E){const S=[h,m,w,1];a.aA(S,S,E);const F=S[3]=Math.max(S[3],1e-6);return S[0]/=F,S[1]/=F,S[2]/=F,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,o))}}getCameraToCenterDistance(o,h=this.zoom,m=this.worldSize){const w=a.cL(o,h,this.width,this.height,1024),E=o.pixelSpaceConversion(this.center.lat,m,w);let S=.5/Math.tan(.5*this._fov)*this.height*E;return this.isOrthographic&&(S=a.ai(1,S,a.cZ(this.pitch>=fa?1:this.pitch/fa))),S}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.az(o,o,this.globeMatrix),o}getFrustum(o){return a.cy.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}const ls=(p,o)=>{if(o>0&&p.terrain&&a.w("Cutoff is currently disabled on terrain"),o<=0||p.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const h=p.transform,m=Math.max(Math.abs(h._zoom-(p.minCutoffZoom-1)),1),w=h.isLODDisabled(!1)?a.af(60,45,h.pitch):a.af(30,15,h.pitch),E=h._farZ-h._nearZ,S=o*h.height,F=((1-(D=w))*h.cameraToCenterDistance+D*(h._farZ+S))*m;var D;return{shouldRenderCutoff:w<1,uniformValues:{u_cutoff_params:[h._nearZ,h._farZ,(F-h._nearZ)/E,(F-S-h._nearZ)/E]}}},lo={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class _h{constructor(o,h){this.aabb=o,this.lastCascade=h}}class pf{add(o,h){const m=this.receivers[o.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],h.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],h.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],h.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],h.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],h.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],h.max[2])):this.receivers[o.key]=new _h(h,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,h,m){const w=a.d6.fromPoints(o.points);let E=0;for(const S in this.receivers){const F=this.receivers[S];if(!F||!w.intersectsAabb(F.aabb))continue;F.aabb.min=w.closestPoint(F.aabb.min),F.aabb.max=w.closestPoint(F.aabb.max);const D=F.aabb.getCorners();for(let Q=0;Q<m.length;Q++){let V=!0;for(const Z of D){const K=[Z[0]*h,Z[1]*h,Z[2]];if(a.ad(K,K,m[Q].matrix),K[0]<-1||K[0]>1||K[1]<-1||K[1]>1){V=!1;break}}if(F.lastCascade=Q,E=Math.max(E,Q),V)break}}return E+1}}class BA{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new pf,this._depthMode=new Rr(o.context.gl.LEQUAL,Rr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,o.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),o.tp.registerParameter(lo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(lo,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),o.tp.registerParameter(lo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),o.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,h){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!h||!h.properties)return;const w=h.properties.get("shadow-intensity");if(!h.shadowsEnabled()||w<=0||(this._shadowLayerCount=m.style.order.reduce((he,le)=>{const Ae=m.style._mergedLayers[le];return he+(Ae.hasShadowPass()&&!Ae.isHidden(o.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const E=m.context,S=lo.shadowMapResolution,F=lo.shadowMapResolution;if(this._cascades.length===0||lo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let he=0;he<lo.cascadeCount;++he){const le=m._shadowMapDebug,Ae=E.gl,fe=E.createFramebuffer(S,F,le,"texture"),Ce=new a.T(E,{width:S,height:F,data:null},Ae.DEPTH_COMPONENT16);if(fe.depthAttachment.set(Ce.texture),le){const ke=new a.T(E,{width:S,height:F,data:null},Ae.RGBA8);fe.colorAttachment.set(ke.texture)}this._cascades.push({framebuffer:fe,texture:Ce,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.cy,scale:0})}}this.shadowDirection=Ic(h);let D=0;if(o.elevation){const he=o.elevation,le=[1e4,-1e4];he.visibleDemTiles.filter(Ae=>Ae.dem).forEach(Ae=>{const fe=Ae.dem.tree;le[0]=Math.min(le[0],fe.minimums[0]),le[1]=Math.max(le[1],fe.maximums[0])}),le[0]!==1e4&&(D=(le[1]-le[0])*he.exaggeration())}const Q=1.5*o.cameraToCenterDistance,V=3*Q,Z=new Float64Array(16);for(let he=0;he<this._cascades.length;++he){const le=this._cascades[he];let Ae=o.height/50,fe=1;lo.cascadeCount===1?fe=V:he===0?fe=Q:(Ae=Q,fe=V);const[Ce,ke]=sc(o,this.shadowDirection,Ae,fe,lo.shadowMapResolution,D);le.scale=o.scale,le.matrix=Ce,le.boundingSphereRadius=ke,a.bi(Z,le.matrix),le.frustum=a.cy.fromInvProjectionMatrix(Z,1,0,!0),le.far=fe}const K=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[K].far,this._cascades[K].far],this._uniformValues.u_shadow_intensity=w,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/lo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=lo.shadowMapResolution,this._uniformValues.u_shadowmap_0=Hs.ShadowMap0,this._uniformValues.u_shadowmap_1=Hs.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ee=m.transform.elevation;for(const he of this._groundShadowTiles){let le={min:0,max:0};if(ee){const Ae=ee.getMinMaxForTile(he);Ae&&(le=Ae)}this.addShadowReceiver(he.toUnwrapped(),le.min,le.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(o){this._enabled=o}drawShadowPass(o,h){if(!this.enabled)return;const m=this.painter,w=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),w.viewport.set([0,0,lo.shadowMapResolution,lo.shadowMapResolution]);for(let E=0;E<this._numCascadesToRender;++E){m.currentShadowCascade=E,w.bindFramebuffer.set(this._cascades[E].framebuffer.framebuffer),w.clear({color:a.am.white,depth:1});for(const S of o.order){const F=o._mergedLayers[S];if(!F.hasShadowPass()||F.isHidden(m.transform.zoom))continue;const D=o.getLayerSourceCache(F),Q=D?h[D.id]:void 0;(F.type==="model"||Q&&Q.length)&&m.renderLayer(m,D,F,Q)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const o=this.painter,h=o.style,m=o.context,w=m.gl,E=h.directionalLight,S=h.ambientLight;if(!E||!S)return;const F=[],D=ls(o,o.longestCutoffRange);D.shouldRenderCutoff&&F.push("RENDER_CUTOFF"),F.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&F.push("NORMAL_OFFSET");const Q=oc(h,E,S),V=new Rr(w.LEQUAL,Rr.ReadOnly,o.depthRangeFor3D),Z=new bn({func:w.EQUAL,mask:255},0,255,w.KEEP,w.KEEP,w.KEEP);for(const K of this._groundShadowTiles){const ee=K.toUnwrapped(),he=o.isTileAffectedByFog(K),le=o.getOrCreateProgram("groundShadow",{defines:F,overrideFog:he});this.setupShadows(ee,le),o.uploadCommonUniforms(m,le,ee,null,D);const Ae={u_matrix:o.transform.calculateProjMatrix(ee),u_ground_shadow_factor:Q};le.draw(o,w.TRIANGLES,V,Z,Xn.multiply,xn.disabled,Ae,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,null,o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Xn.unblended:Xn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){const h=this.painter.transform,m=h.calculatePosMatrix(o,h.worldSize);return a.az(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(o){return a.az(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,h,m){if(!this.enabled)return;const w=this.painter.transform,E=this.painter.context,S=E.gl,F=this._uniformValues,D=new Float64Array(16),Q=w.calculatePosMatrix(o,w.worldSize);for(let V=0;V<this._cascades.length;V++)a.az(D,this._cascades[V].matrix,Q),F[V===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(D),E.activeTexture.set(S.TEXTURE0+Hs.ShadowMap0+V),this._cascades[V].texture.bindExtraParam(S.LINEAR,S.LINEAR,S.CLAMP_TO_EDGE,S.CLAMP_TO_EDGE,S.GREATER);if(this.useNormalOffset=!!m,this.useNormalOffset){const V=a.d4(o.canonical),Z=2/w.tileSize*a.aj/lo.shadowMapResolution,K=Z*this._cascades[0].boundingSphereRadius,ee=Z*this._cascades[this._cascades.length-1].boundingSphereRadius,he=(m==="vector-tile"?1:3)*function(le,Ae,fe,Ce,ke){const He=a.ay((le-22)/-22,0,1);return .125*(1-He)+4*He}(w.zoom);F.u_shadow_normal_offset=[V,K*he,ee*he],F.u_shadow_bias=[1e-4,.0012,.012]}else F.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(E,F)}setupShadowsFromMatrix(o,h,m=!1){if(!this.enabled)return;const w=this.painter.context,E=w.gl,S=this._uniformValues,F=new Float64Array(16);for(let D=0;D<lo.cascadeCount;D++)a.az(F,this._cascades[D].matrix,o),S[D===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(F),w.activeTexture.set(E.TEXTURE0+Hs.ShadowMap0+D),this._cascades[D].texture.bindExtraParam(E.LINEAR,E.LINEAR,E.CLAMP_TO_EDGE,E.CLAMP_TO_EDGE,E.GREATER);if(this.useNormalOffset=m,m){const D=lo.normalOffset;S.u_shadow_normal_offset=[1,D,D],S.u_shadow_bias=[6e-5,.0012,.012]}else S.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(w,S)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,h,m,w){if(w[2]>=0)return{};const E=function(D,Q,V){const Z=V/(1<<D.canonical.z);return new a.d6([D.canonical.x*Z+D.wrap*V,D.canonical.y*Z+D.wrap*V,0],[(D.canonical.x+1)*Z+D.wrap*V,(D.canonical.y+1)*Z+D.wrap*V,Q])}(o,h,m).getCorners(),S=h/-w[2];w[0]<0?(a.d5(E[0],E[0],[w[0]*S,0,0]),a.d5(E[3],E[3],[w[0]*S,0,0])):w[0]>0&&(a.d5(E[1],E[1],[w[0]*S,0,0]),a.d5(E[2],E[2],[w[0]*S,0,0])),w[1]<0?(a.d5(E[0],E[0],[0,w[1]*S,0]),a.d5(E[1],E[1],[0,w[1]*S,0])):w[1]>0&&(a.d5(E[2],E[2],[0,w[1]*S,0]),a.d5(E[3],E[3],[0,w[1]*S,0]));const F={};return F.vertices=E,F.planes=[Tc(E[1],E[0],E[4]),Tc(E[2],E[1],E[5]),Tc(E[3],E[2],E[6]),Tc(E[0],E[3],E[7])],F}addShadowReceiver(o,h,m){this._receivers.add(o,a.d6.fromTileIdAndHeight(o,h,m))}getMaxCascadeForTile(o){const h=this._receivers.get(o);return h&&h.lastCascade?h.lastCascade:0}}function Tc(p,o,h){const m=a.at([],h,o),w=a.at([],p,o),E=a.bF([],m,w),S=a.ae(E);return S===0?[0,0,1,0]:(a.c1(E,E,1/S),[E[0],E[1],E[2],-a.bG(E,o)])}function Ic(p){const o=p.properties.get("direction"),h=a.d1(o.x,o.y,o.z);h[2]=a.ay(h[2],0,75);const m=a.d3([h[0],h[1],h[2]]);return a.d2(m.x,m.y,m.z)}function oc(p,o,h){const m=o.properties.get("color-use-theme")==="none",w=o.properties.get("color"),E=o.properties.get("intensity"),S=o.properties.get("direction"),F=[S.x,S.y,S.z],D=h.properties.get("color-use-theme")==="none",Q=h.properties.get("color"),V=h.properties.get("intensity"),Z=Math.max(a.bG([0,0,1],F),0),K=[0,0,0];a.c1(K,Q.toPremultipliedRenderColor(D?null:p.getLut(o.scope)).toArray01Linear().slice(0,3),V);const ee=[0,0,0];return a.c1(ee,w.toPremultipliedRenderColor(m?null:p.getLut(h.scope)).toArray01Linear().slice(0,3),Z*E),a.d8([K[0]>0?K[0]/(K[0]+ee[0]):0,K[1]>0?K[1]/(K[1]+ee[1]):0,K[2]>0?K[2]/(K[2]+ee[2]):0])}function sc(p,o,h,m,w,E){const S=p.zoom,F=p.scale,D=p.worldSize,Q=1/D,V=p.aspect,Z=Math.sqrt(1+V*V)*Math.tan(.5*p.fovX),K=Z*Z,ee=m-h,he=m+h;let le,Ae;K>ee/he?(le=m,Ae=m*Z):(le=.5*he*(1+K),Ae=.5*Math.sqrt(ee*ee+2*(m*m+h*h)*K+he*he*K*K));const fe=p.projection.pixelsPerMeter(p.center.lat,D),Ce=p._camera.getCameraToWorldMercator(),ke=[0,0,-le*Q];a.ad(ke,ke,Ce);let He=Ae*Q;const $e=p._edgeInsets;if(!($e.left===0&&$e.top===0&&$e.right===0&&$e.bottom===0||$e.left===$e.right&&$e.top===$e.bottom)){const fr=p._camera.getWorldToCamera(p.worldSize,p.projection.zAxisUnit==="meters"?fe:1),Ar=p._camera.getCameraToClipPerspective(p._fov,p.width/p.height,h,m);Ar[8]=2*-p.centerOffset.x/p.width,Ar[9]=2*p.centerOffset.y/p.height;const yr=new Float64Array(16);a.cM(yr,Ar,fr);const Br=new Float64Array(16);a.bi(Br,yr);const ln=a.cy.fromInvProjectionMatrix(Br,D,S,!0);for(const dn of ln.points){const Wr=((it=dn)[0]/=F,it[1]/=F,it[2]=a.cb(it[2],p._center.lat),it);He=Math.max(He,a.c2(a.d7([],ke,Wr)))}}var it;He*=w/(w-1);const ct=Math.acos(o[2]),Xe=Math.atan2(-o[0],-o[1]),Ye=new Zs;Ye.position=ke,Ye.setPitchBearing(ct,Xe);const tt=Ye.getWorldToCamera(D,fe),Pt=He*D,gt=Math.min(p._mercatorZfromZoom(17)*D*-2,-2*Pt),Jt=Ye.getCameraToClipOrthographic(-Pt,Pt,-Pt,Pt,gt,(Pt+E*fe)/o[2]),kt=new Float64Array(16);a.az(kt,Jt,tt);const or=a.d2(Math.floor(1e6*ke[0])/1e6*D,Math.floor(1e6*ke[1])/1e6*D,0),pr=.5*w,It=[0,0,0];a.ad(It,or,kt),a.c1(It,It,pr);const ht=[Math.floor(It[0]),Math.floor(It[1]),Math.floor(It[2])],zt=[0,0,0];a.at(zt,It,ht),a.c1(zt,zt,-1/pr);const Ot=new Float64Array(16);return a.bx(Ot),a.bo(Ot,Ot,zt),a.az(kt,Ot,kt),[kt,Pt]}class Nf extends a.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(o,h){return a.aS(this.requestManager.transformRequest(h,a.R.Model).url).then(m=>{if(!m)return;const w=a.aT(m),E=new a.aU(o,void 0,void 0,w);return E.computeBoundsAndApplyParent(),E}).catch(m=>{if(m&&m.status===404)return null;this.fire(new a.z(new Error(`Could not load model ${o} from ${h}: ${m.message}`)))})}load(o,h,m={forceReload:!1}){this.models[h]||(this.models[h]={});const w=Object.keys(o),E=[],S=[];for(const F of w){const D=o[F];this.hasURLBeenRequested(D)&&!m.forceReload||(this.modelByURL[D]={modelId:F,scope:h},E.push(this.loadModel(F,D)),S.push(F)),this.models[h][F]||(this.models[h][F]={model:null,numReferences:1})}this.numModelsLoading[h]=(this.numModelsLoading[h]||0)+S.length,Promise.allSettled(E).then(F=>{for(let D=0;D<F.length;D++){const{status:Q}=F[D];if(Q==="rejected")continue;const{value:V}=F[D];this.models[h][S[D]]||(this.models[h][S[D]]={model:null,numReferences:1}),this.models[h][S[D]].model=V}this.numModelsLoading[h]-=S.length,this.fire(new a.A("data",{dataType:"style"}))}).catch(F=>{this.fire(new a.z(new Error(`Could not load models: ${F.message}`)))})}isLoaded(){for(const o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,h,m={exactIdMatch:!1}){return!!(m.exactIdMatch?this.getModel(o,h):this.getModelByURL(this.modelUris[h][o]))}getModel(o,h){return this.models[h]||(this.models[h]={}),this.models[h][o]?this.models[h][o].model:void 0}getModelByURL(o){if(!o)return null;const h=this.modelByURL[o];return h?this.models[h.scope][h.modelId].model:null}hasModelBeenAdded(o,h){return this.models[h]&&this.models[h][o]!==void 0}getModelURIs(o){return this.modelUris[o]||{}}addModel(o,h,m){this.models[m]||(this.models[m]={}),this.modelUris[m]||(this.modelUris[m]={});const w=this.requestManager.normalizeModelURL(h);if((this.hasModel(o,m,{exactIdMatch:!0})||this.hasModelBeenAdded(o,m))&&this.modelUris[m][o]===w)this.models[m][o].numReferences++;else if(this.hasURLBeenRequested(w)){const{scope:E,modelId:S}=this.modelByURL[w];this.models[E][S].numReferences++}else this.modelUris[m][o]=w,this.load({[o]:this.modelUris[m][o]},m)}addModelURLs(o,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const m=this.modelUris[h];for(const w in o)m[w]=this.requestManager.normalizeModelURL(o[w])}reloadModels(o){this.load(this.modelUris[o],o,{forceReload:!0})}addModelsFromBucket(o,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const m={};for(const w of o)this.hasModel(w,h,{exactIdMatch:!0})||this.hasURLBeenRequested(w)?this.models[h][w].numReferences++:this.modelUris[h][w]&&!this.hasURLBeenRequested(w)?m[w]=this.modelUris[h][w]:!this.hasURLBeenRequested(w)&&a.d9(w,!1)&&(this.modelUris[h][w]=this.requestManager.normalizeModelURL(w),m[w]=this.modelUris[h][w]);this.load(m,h)}hasURLBeenRequested(o){return this.modelByURL[o]!==void 0}removeModel(o,h,m=!1,w=!1){if(this.models[h]&&this.models[h][o]&&(this.models[h][o].numReferences--,this.models[h][o].numReferences===0||w)){const E=this.modelUris[h][o];m||delete this.modelUris[h][o],delete this.modelByURL[E];const S=this.models[h][o].model;if(!S)return;delete this.models[h][o],S.destroy()}}destroy(){for(const o of Object.keys(this.models))for(const h of Object.keys(this.models[o])){const m=this.models[o][h].model;delete this.models[o][h],m&&m.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,h){this.models[h]||(this.models[h]={});for(const m in this.models[h])this.models[h][m].model&&this.models[h][m].model.upload(o.context)}}const Il=new a.a7({data:new a.a8(a.a5.colorTheme.data)});class Eu{constructor(o){this._scope=o,this._buildingQueryParams={target:{featuresetId:"building-outline",importId:this._scope}},this._floorQueryParams={target:{featuresetId:"floor-outline",importId:this._scope}}}execute(o){const h=this._makeBuildingsQueryArea(o),m=this._makeFloorsQueryArea(o),w=o.queryRenderedFeatures(h,this._buildingQueryParams).filter(F=>F.properties.shape_type==="building").reduce((F,D)=>{const Q=D.properties.id;return D.properties.shape_type!=="building"||F.some(V=>V.properties.id===Q)||F.push(D),F},[]),E=o.queryRenderedFeatures(m,this._floorQueryParams).filter(F=>F.properties.shape_type==="floor").reduce((F,D)=>{const Q=D.properties.id;return D.properties.shape_type!=="floor"||F.some(V=>V.properties.id===Q)||F.push(D),F},[]),S=[o.getCenter().lng,o.getCenter().lat];return{floors:E,building:this._findBuildingAtCenter(S,w)||(w.length>0?w[0]:null)}}_makeBuildingsQueryArea(o){const h=o.transform.width,m=o.transform.height,w=Math.min(h,m),E=w*(1/8),S=w*(1/8),F=.5*(h-E),D=.5*(m-S);return[new a.P(F,D),new a.P(F+E,D+S)]}_makeFloorsQueryArea(o){const h=o.transform.width,m=o.transform.height,w=h*(2/3),E=m*(2/3),S=.5*(h-w),F=.5*(m-E);return[new a.P(S,F),new a.P(S+w,F+E)]}_findBuildingAtCenter(o,h){for(const m of h)if(m.geometry.type==="Polygon"&&this._pointInPolygon(o,m.geometry.coordinates[0]))return m;return null}_pointInPolygon(o,h){let m=!1;for(let w=0,E=h.length-1;w<h.length;E=w++){const S=h[w][0],F=h[w][1],D=h[E][1];F>o[1]!=D>o[1]&&o[0]<(h[E][0]-S)*(o[1]-F)/(D-F)+S&&(m=!m)}return m}}class Wa{constructor(){this._selectedFloorId=null,this._selectedBuildingId=null,this._floors=[]}setBuildingId(o){this._selectedBuildingId=o}setFloors(o){if(this._floors=o.filter(h=>h.properties.building_id===this._selectedBuildingId),!this._selectedFloorId||!this._floors.map(h=>h.properties.id).includes(this._selectedFloorId)){const h=this._floors.map(m=>({id:m.properties.id,level:m.properties.floor_level})).reduce((m,w)=>{const E=Math.abs(m.level-1),S=Math.abs(w.level-1);return S<E||S===E&&w.level>m.level?w:m});this._selectedFloorId=h.id}}setFloorId(o){this._selectedFloorId=o}getSelectedFloorId(){return this._selectedFloorId}getCurrentBuildingFloors(){return this._floors}reset(){this._selectedFloorId=null,this._selectedBuildingId=null,this._floors=[]}}const Mo={"mbx-indoor-level-selected":{default:["literal",[]]}};function vs(p){return p=p||{},Object.assign(p,Mo)}class Ts extends a.E{constructor(o){super(),a.aV(["_onLoad","_onMove"],this),this._map=o,this._floorSelectionState=new Wa,this._queryIndoor(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=null,this._floorSelectionState=null}_onLoad(){this._map.style.forEachFragmentStyle(o=>{o.stylesheet.indoor&&(this._indoorDataQuery?this.fire(new a.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._scope=o.scope,this._indoorDataQuery=new Eu(this._scope)))}),this._map._addIndoorControl(),this._queryIndoor()}_onMove(){this._queryIndoor()}_queryIndoor(){if(!this._indoorDataQuery||!this._map.isStyleLoaded())return;if(this._map.transform.zoom<16)return void this._clearIndoorData();const o=this._indoorDataQuery.execute(this._map);o&&o.floors.length!==0?(this._floorSelectionState.getSelectedFloorId()||this._map._addIndoorControl(),this._selectFloors(o)):this._clearIndoorData()}_selectFloors(o){if(o.building)this._floorSelectionState.setBuildingId(o.building.properties.id),this._floorSelectionState.setFloors(o.floors),this._updateUI();else{const h=this._floorSelectionState.getSelectedFloorId();if(h&&o.floors.some(m=>m.properties.id===h))return;this._clearIndoorData()}}_clearIndoorData(){this._floorSelectionState.reset(),this._map._removeIndoorControl(),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",[]])}_updateUI(){const o=this._floorSelectionState.getCurrentBuildingFloors().map(m=>({id:m.properties.id,name:m.properties.name,shortName:m.properties.floor_level,levelOrder:m.properties.floor_level})),h=this._floorSelectionState.getSelectedFloorId();h?(this._updateIndoorConfig(),this.fire(new a.A("indoorupdate",{selectedFloorId:h,floors:o}))):console.warn("IndoorManager: Selected floor is not set")}_updateIndoorConfig(){const o=this._floorSelectionState.getSelectedFloorId();o?this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",[o]]):console.warn("IndoorManager: Selected floor is not set")}selectFloor(o){this._floorSelectionState.setFloorId(o),this._updateIndoorConfig()}}function Vs(p){if(!p.metadata||!p.metadata.content_area)return;const o=a.q.devicePixelRatio,{left:h,top:m,width:w,height:E}=p.metadata.content_area,S=h*o,F=m*o;return[S,F,S+w*o,F+E*o]}function $u(p){if(p)return p.map(([o,h])=>[o*a.q.devicePixelRatio,h*a.q.devicePixelRatio])}class eu{constructor(o,h,m){this.id=o,this.scope=h,this.sourceCache=m,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(o){this.missingRequests.has(o.name)||this.pendingRequests.has(o.name)||this.pendingRequests.add(o.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const o=new Map;if(!this.sourceCache.loaded())return o;const h=this.sourceCache.getVisibleCoordinates();if(h.length===0)return o;const m=this.sourceCache.getSource();if(!(m instanceof Co))return o;const w=h.map(S=>this.sourceCache.getTile(S)),E=m.getImages(w,Array.from(this.pendingRequests));for(const[S,F]of E)o.set(a.I.from({name:S,iconsetId:this.id}),F),this.pendingRequests.delete(S);for(const S of this.pendingRequests)this.missingRequests.add(S);return this.pendingRequests.clear(),o}}const tu=(p,o)=>je(p,o&&o.filter(h=>h.identifier!=="source.canvas")),Wd=a.aF(Ui,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),qd=a.aF(Ui,["setCenter","setZoom","setBearing","setPitch"]),zf=new Set(["background","sky","slot","custom"]),jh={version:8,layers:[],sources:{}},CA={duration:300,delay:0};class Al extends a.E{constructor(o,h={}){super(),this.map=o,this.scope=h.scope||"",this.globalId=null,this.fragments=[],this.importDepth=h.importDepth||0,this.importsCache=h.importsCache||new Map,this.resolvedImports=h.resolvedImports||new Set,this.transition=a.h({},CA),this._buildingIndex=new Hi(this),this.crossTileSymbolIndex=new fl,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=h.styleChanges||new sn,this.dispatcher=h.dispatcher?h.dispatcher:new a.D(a.db(),this),h.imageManager?this.imageManager=h.imageManager:(this.imageManager=new mt(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=h.glyphManager?h.glyphManager:new a.dc(o._requestManager,h.localFontFamily?a.dd.all:h.localIdeographFontFamily?a.dd.ideographs:a.dd.none,h.localFontFamily||h.localIdeographFontFamily),h.modelManager?this.modelManager=h.modelManager:(this.modelManager=new Nf(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=h.configOptions?h.configOptions:new Map,this._configDependentLayers=h.configDependentLayers?h.configDependentLayers:new Set,this._config=h.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:h.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=h.initialConfig,this.dispatcher.broadcast("setReferrer",a.de());const m=this;this._rtlTextPluginCallback=Al.registerForPluginStateChange(w=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(E,S)=>{if(a.df(E),S&&S.every(F=>F))for(const F in m._sourceCaches){const D=m._sourceCaches[F],Q=D.getSource().type;Q!=="vector"&&Q!=="geojson"||D.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const E=this.getOwnSource(w.sourceId);if(E&&E.vectorLayerIds)for(const S in this._layers){const F=this._layers[S];F.source===E.id&&this._validateLayer(F)}})}load(o){return o?(typeof o=="string"?this.loadURL(o):this.loadJSON(o),this):this}_getGlobalId(o){if(!o)return null;if(typeof o=="string"){if(a.j(o))return o;const h=a.dg(o);if(!h.startsWith("http"))try{return new URL(h,location.href).toString()}catch{return h}return h}return`json://${a.dh(JSON.stringify(o))}`}_diffStyle(o,h,m){this.globalId=this._getGlobalId(o);const w=(E,S)=>{try{S(null,this.setState(E,m))}catch(F){S(F,!1)}};if(typeof o=="string"){const E=this.map._requestManager.normalizeStyleURL(o),S=this.map._requestManager.transformRequest(E,a.R.Style);a.n(S,(F,D)=>{F?this.fire(new a.z(F)):D&&w(D,h)})}else typeof o=="object"&&w(o,h)}loadURL(o,h={}){this.fire(new a.A("dataloading",{dataType:"style"}));const m=typeof h.validate=="boolean"?h.validate:!a.j(o);this.globalId=this._getGlobalId(o),o=this.map._requestManager.normalizeStyleURL(o,h.accessToken),this.resolvedImports.add(o);const w=this.importsCache.get(o);if(w)return this._load(w,m);const E=this.map._requestManager.transformRequest(o,a.R.Style);this._request=a.n(E,(S,F)=>{if(this._request=null,S)this.fire(new a.z(S));else if(F)return this.importsCache.set(o,F),this._load(F,m)})}loadJSON(o,h={}){this.fire(new a.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(o),this._request=a.q.frame(()=>{this._request=null,this._load(o,h.validate!==!1)})}loadEmpty(){this.fire(new a.A("dataloading",{dataType:"style"})),this._load(jh,!1)}_loadImports(o,h,m){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const w=[];for(const E of o){const S=this._createFragmentStyle(E),F=new Promise(V=>{S.once("style.import.load",V),S.once("error",V)}).then(()=>this.mergeAll());if(w.push(F),this.resolvedImports.has(E.url)){S.loadEmpty();continue}const D=E.data||this.importsCache.get(E.url);D?(S.loadJSON(D,{validate:h}),this._isInternalStyle(D)&&(S.globalId=null)):E.url?S.loadURL(E.url,{validate:h}):S.loadEmpty();const Q={style:S,id:E.id,config:E.config};if(m){const V=this.fragments.findIndex(({id:Z})=>Z===m);this.fragments=this.fragments.slice(0,V).concat(Q).concat(this.fragments.slice(V))}else this.fragments.push(Q)}return Promise.allSettled(w)}getImportGlobalIds(o=this,h=new Set){for(const m of o.fragments)m.style.globalId&&h.add(m.style.globalId),this.getImportGlobalIds(m.style,h);return[...h.values()]}_createFragmentStyle(o){const h=this.scope?a.C(o.id,this.scope):o.id;let m;const w=this._initialConfig&&this._initialConfig[h];(o.config||w)&&(m=a.h({},o.config,w));const E=new Al(this.map,{scope:h,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:o["color-theme"],configDependentLayers:this._configDependentLayers});return E.setEventedParent(this.map,{style:E}),E}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(o){return this.isRootStyle()&&(o.fragment||!!o.schema&&o.fragment!==!1)}_load(o,h){const m=o.indoor?vs(o.schema):o.schema;if(this._isInternalStyle(o)){const S=a.h({},jh,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(S,h)}if(this.updateConfig(this._config,m),h&&tu(this,wa(o)))return;this._loaded=!0,this.stylesheet=a.di(o);const w=()=>{for(const Q in o.sources)this.addSource(Q,o.sources[Q],{validate:!1,isInitialLoad:!0});if(o.iconsets)for(const Q in o.iconsets)this.addIconset(Q,o.iconsets[Q]);o.sprite?this._loadIconset(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&o.glyphs&&this.glyphManager.setURL(o.glyphs);const S=Ec(this.stylesheet.layers);if(this._order=S.map(Q=>Q.id),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const Q=this.stylesheet.lights[0];this.light=new Ee(Q.properties,Q.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Ee(this.stylesheet.light)),this._layers={};for(const Q of S){const V=a.dn(Q,this.scope,this._styleColorTheme.lut,this.options);V.configDependencies.size!==0&&this._configDependentLayers.add(V.fqid),V.setEventedParent(this,{layer:{id:V.id}}),this._layers[V.id]=V;const Z=this.getOwnLayerSourceCache(V),K=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Z&&V.canCastShadows()&&K&&(Z.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const F=this.stylesheet.terrain;F&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(F,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.A("data",{dataType:"style"}));const D=this.isRootStyle();o.imports?this._loadImports(o.imports,h).then(()=>{this._reloadImports(),this.fire(new a.A(D?"style.load":"style.import.load"))}).catch(Q=>{this.fire(new a.z(new Error("Failed to load imports",Q))),this.fire(new a.A(D?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new a.A(D?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const E=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(E){const S=this._evaluateColorThemeData(E);this._loadColorTheme(S).then(()=>{w()}).catch(F=>{a.w(`Couldn't load color theme from the stylesheet: ${F}`),w()})}else this._styleColorTheme.lut=null,w()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,h,m,w,E,S,F,D,Q,V;const Z={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(K=>{if(K.stylesheet){if(K.light!=null&&(o=K.light),K.stylesheet.lights)for(const ee of K.stylesheet.lights)ee.type==="ambient"&&K.ambientLight!=null&&(h=K.ambientLight),ee.type==="directional"&&K.directionalLight!=null&&(m=K.directionalLight);w=this._prioritizeTerrain(w,K.terrain,K.stylesheet.terrain),K.stylesheet.fog&&K.fog!=null&&(E=K.fog),K.stylesheet.snow&&K.snow!=null&&(S=K.snow),K.stylesheet.rain&&K.rain!=null&&(F=K.rain),K.stylesheet.camera!=null&&(V=K.stylesheet.camera),K.stylesheet.projection!=null&&(D=K.stylesheet.projection),K.stylesheet.transition!=null&&(Q=K.stylesheet.transition),Z[K.scope]=K._styleColorTheme}}),this.light=o,this.ambientLight=h,this.directionalLight=m,this.fog=E,this.snow=S,this.rain=F,this._styleColorThemeForScope=Z,w===null?delete this.terrain:this.terrain=w,this.camera=V||{"camera-projection":"perspective"},this.projection=D||{name:"mercator"},this.transition=a.h({},CA,Q),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){const h=m=>{for(const w of m.fragments)h(w.style);o(m)};h(this)}_prioritizeTerrain(o,h,m){const w=o&&o.drapeRenderMode===0;return m===null?h&&h.drapeRenderMode===0?h:w?o:null:h!=null&&(!o||w||h&&h.drapeRenderMode===1)?h:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(h=>{o=this._prioritizeTerrain(o,h.terrain,h.stylesheet.terrain)}),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle(h=>{h.stylesheet.projection!=null&&(o=h.stylesheet.projection)}),this.projection=o||{name:"mercator"}}mergeSources(){const o={},h={},m={};this.forEachFragmentStyle(w=>{for(const E in w._sourceCaches){const S=a.C(E,w.scope);o[S]=w._sourceCaches[E]}for(const E in w._otherSourceCaches){const S=a.C(E,w.scope);h[S]=w._otherSourceCaches[E]}for(const E in w._symbolSourceCaches){const S=a.C(E,w.scope);m[S]=w._symbolSourceCaches[E]}}),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=h,this._mergedSymbolSourceCaches=m}mergeLayers(){const o={},h=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(E=>{for(const S of E._order){const F=E._layers[S];if(F.type==="slot"){const D=a.dj(S);if(o[D])continue;o[D]=[]}F.slot&&o[F.slot]?o[F.slot].push(F):h.push(F)}}),this._mergedOrder=[];const w=(E=[])=>{for(const S of E)if(S.type==="slot"){const F=a.dj(S.id);o[F]&&w(o[F]),this._mergedSlots.push(F)}else{const F=a.C(S.id,S.scope);this._mergedOrder.push(F),m[F]=S,S.is3D(!!this.terrain)&&(this._has3DLayers=!0),S.type==="circle"&&(this._hasCircleLayers=!0),S.type==="symbol"&&(this._hasSymbolLayers=!0),S.type==="clip"&&(this._clipLayerPresent=!0)}};w(h),this._mergedOrder.sort((E,S)=>{const F=m[E],D=m[S];return F.hasInitialOcclusionOpacityProperties?D.is3D(!!this.terrain)?1:0:F.is3D(!!this.terrain)&&D.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=a.h({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(o){return o.data?function(h,m,w,E){const S=a.h({},m);for(const D of Object.keys(a.a5.colorTheme))S[D]===void 0&&(S[D]=a.a5.colorTheme[D].default);const F=new a.a6(Il,h,new Map(w));return F.setTransitionOrValue(S,w),F.untransitioned().possiblyEvaluate(new a.aa(0,{worldview:void 0}))}(this.scope,o,this.options).get("data"):null}_loadColorTheme(o){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const h=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,w)=>{const E="data:image/png;base64,";if(!o||o.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let S=o;S.startsWith(E)||(S=E+S);const F=a.I.from("mapbox-reserved-lut"),D=new Image;D.src=S,D.onerror=()=>{this._styleColorTheme.lutLoading=!1,w(new Error("Failed to load image data"))},D.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==h)return void m();this._styleColorTheme.lutLoading=!1;const{width:Q,height:V,data:Z}=a.q.getImageData(D);if(V>32)return void w(new Error("The height of the image must be less than or equal to 32 pixels."));if(Q!==V*V)return void w(new Error("The width of the image must be equal to the height squared."));this.getImage(F)&&this.removeImage(F),this.addImage(F,{data:new a.r({width:Q,height:V},Z),pixelRatio:1,sdf:!1,usvg:!1,version:0});const K=this.imageManager.getImage(F,this.scope);K?(this._styleColorTheme.lut={image:K.data,data:o},m()):w(new Error("Missing LUT image."))}})}getLut(o){const h=this._styleColorThemeForScope[o];return h?h.lut:null}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=function(h,m,w){let E,S,F;const D=a.q.devicePixelRatio>1?"@2x":"";let Q=a.n(m.transformRequest(m.normalizeSpriteURL(h,D,".json"),a.R.SpriteJSON),(K,ee)=>{Q=null,F||(F=K,E=ee,Z())}),V=a.o(m.transformRequest(m.normalizeSpriteURL(h,D,".png"),a.R.SpriteImage),(K,ee)=>{V=null,F||(F=K,S=ee,Z())});function Z(){if(F)w(F);else if(E&&S){const K=a.q.getImageData(S),ee={};for(const he in E){const{width:le,height:Ae,x:fe,y:Ce,sdf:ke,pixelRatio:He,stretchX:$e,stretchY:it,content:ct}=E[he],Xe=new a.r({width:le,height:Ae});a.r.copy(K,Xe,{x:fe,y:Ce},{x:0,y:0},{width:le,height:Ae},null),ee[he]={data:Xe,pixelRatio:He,sdf:ke,stretchX:$e,stretchY:it,content:ct,usvg:!1}}w(null,ee)}}return{cancel(){Q&&(Q.cancel(),Q=null),V&&(V.cancel(),V=null)}}}(o,this.map._requestManager,(h,m)=>{if(this._spriteRequest=null,h)this.fire(new a.z(h));else if(m){const w=new Map;for(const E in m)w.set(a.I.from(E),m[E]);this.addImages(w)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.A("data",{dataType:"style"}))})}addIconset(o,h){if(h.type==="sprite")return void this._loadSprite(h.url);const m=this.getOwnSourceCache(h.source);if(!m)return void this.fire(new a.z(new Error(`Source "${h.source}" as specified by iconset "${o}" does not exist and cannot be used as an iconset source`)));const w=m.getSource();if(w.type!=="raster-array")return void this.fire(new a.z(new Error(`Source "${h.source}" as specified by iconset "${o}" is not a "raster-array" source and cannot be used as an iconset source`)));w.partial=!1;const E=new eu(o,this.scope,m);this.imageManager.addImageProvider(E,this.scope)}removeIconset(o){this.imageManager.removeImageProvider(o,this.scope)}_loadIconset(o){if(!a.j(o)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(o);const h=this.map._spriteFormat==="auto";var m,w;this._spriteRequest=(w=(E,S)=>{if(this._spriteRequest=null,E)h?this._loadSprite(o):this.fire(new a.z(E));else if(S){const F=new Map;for(const D in S)F.set(a.I.from(D),S[D]);this.addImages(F)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.A("data",{dataType:"style"}))},a.br((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(o),a.R.Iconset),(E,S)=>{if(E)return void w(E);const F={},D=a.da(new a.bq(S));for(const Q of D.icons){const V={version:1,pixelRatio:a.q.devicePixelRatio,content:Vs(Q),stretchX:Q.metadata?$u(Q.metadata.stretch_x_areas):void 0,stretchY:Q.metadata?$u(Q.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:Q};F[Q.name]=V}w(null,F)}))}_validateLayer(o){const h=this.getOwnSource(o.source);if(!h)return;const m=o.sourceLayer;m&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(m)===-1)&&this.fire(new a.z(new Error(`Source layer "${m}" does not exist on source "${h.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((o,h)=>{const m=this.fragments[h];return m&&m.style&&(o.data=m.style.serialize()),o})}_serializeSources(){const o={};for(const h in this._sourceCaches){const m=this._sourceCaches[h].getSource();o[m.id]||(o[m.id]=m.serialize())}return o}_serializeLayers(o){const h=[];for(const m of o){const w=this._layers[m];w&&w.type!=="custom"&&h.push(w.serialize())}return h}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(o){return o?this.order:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&o.isDraped(this.getLayerSourceCache(o))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){const h=this.getOwnLayer(o);if(h)return h;this.fire(new a.z(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){const h=this.getOwnSource(o);if(h)return h;this.fire(new a.z(new Error(`The source '${o}' does not exist in the map's style.`)))}precompilePrograms(o,h){const m=this.map.painter;if(m)for(let w=o.minzoom||0;w<(o.maxzoom||25.5);w++){const E=o.getProgramIds();if(E)for(const S of E){const F=o.getDefaultProgramParams(S,h.zoom,this._styleColorTheme.lut);F&&(m.style=this,this.fog&&(m._fogVisible=!0,F.overrideFog=!0,m.getOrCreateProgram(S,F)),m._fogVisible=!1,F.overrideFog=!1,m.getOrCreateProgram(S,F),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(F.overrideRtt=!0,m.getOrCreateProgram(S,F)))}}}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);const h=this.calculateLightsBrightness();o.brightness=h||0,h!==this._brightness&&(this._brightness=h,this.dispatcher.broadcast("setBrightness",h)),o.worldview!==this._worldview&&(this._worldview=o.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const m=this._changes.isDirty();let w=!1;if(this._changes.isDirty()){const F=this._changes.getLayerUpdatesByScope();for(const D in F){const{updatedIds:Q,removedIds:V}=F[D];(Q||V)&&(this._updateWorkerLayers(D,Q,V),w=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this.snow&&this.snow.updateTransitions(o),this.rain&&this.rain.updateTransitions(o),this._changes.reset()}const E={};for(const F in this._mergedSourceCaches){const D=this._mergedSourceCaches[F];E[F]=D.used,D.used=!1,D.tileCoverLift=0}for(const F of this._mergedOrder){const D=this._mergedLayers[F];if(D.recalculate(o,this._availableImages),!D.isHidden(o.zoom)){const Q=this.getLayerSourceCache(D);Q&&(Q.used=!0,Q.tileCoverLift=Math.max(Q.tileCoverLift,D.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(D,o)}):this.precompilePrograms(D,o))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&w&&this.mergeLayers();const S=this.imageManager.getPendingImageProviders();for(const F of S)F.sourceCache.used=!0;for(const F in E){const D=this._mergedSourceCaches[F];E[F]!==D.used&&D.getSource().fire(new a.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.snow&&this.snow.recalculate(o),this.rain&&this.rain.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),m&&this.fire(new a.A("data",{dataType:"style"}))}updateImageProviders(){const o=this.imageManager.getPendingImageProviders();for(const h of o){const m=h.resolvePendingRequests(),w=this.getFragmentStyle(h.scope);w&&w.addImages(m)}}_updateTilesForChangedImages(){const o={};for(const h in this._mergedSourceCaches){const m=this._mergedSourceCaches[h].getSource().scope;o[m]=o[m]||this._changes.getUpdatedImages(m),o[m].length!==0&&this._mergedSourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o[m])}for(const h in o)this._changes.resetUpdatedImages(h)}_updateWorkerLayers(o,h,m){const w=this.getFragmentStyle(o);w&&this.dispatcher.broadcast("updateLayers",{layers:h?w._serializeLayers(h):[],scope:o,removedIds:m||[],options:w.options})}setState(o,h){if(this._checkLoaded(),tu(this,wa(o)))return!1;(o=a.di(o)).layers=Ec(o.layers);const m=function(S,F){if(!S)return[{command:Ui.setStyle,args:[F]}];let D=[];try{if(!a.bv(S.version,F.version))return[{command:Ui.setStyle,args:[F]}];if(a.bv(S.center,F.center)||D.push({command:Ui.setCenter,args:[F.center]}),a.bv(S.zoom,F.zoom)||D.push({command:Ui.setZoom,args:[F.zoom]}),a.bv(S.bearing,F.bearing)||D.push({command:Ui.setBearing,args:[F.bearing]}),a.bv(S.pitch,F.pitch)||D.push({command:Ui.setPitch,args:[F.pitch]}),a.bv(S.sprite,F.sprite)||D.push({command:Ui.setSprite,args:[F.sprite]}),a.bv(S.glyphs,F.glyphs)||D.push({command:Ui.setGlyphs,args:[F.glyphs]}),a.bv(S.imports,F.imports)||function(ee=[],he=[],le){he=he||[];const Ae=(ee=ee||[]).map(Zc),fe=he.map(Zc),Ce=ee.reduce(_u,{}),ke=he.reduce(_u,{}),He=Ae.slice();let $e,it,ct,Xe;for($e=0,it=0;$e<Ae.length;$e++)ct=Ae[$e],ke.hasOwnProperty(ct)?it++:(le.push({command:Ui.removeImport,args:[ct]}),He.splice(He.indexOf(ct,it),1));for($e=0,it=0;$e<fe.length;$e++)ct=fe[fe.length-1-$e],He[He.length-1-$e]!==ct&&(Ce.hasOwnProperty(ct)?(le.push({command:Ui.removeImport,args:[ct]}),He.splice(He.lastIndexOf(ct,He.length-it),1)):it++,Xe=He[He.length-$e],le.push({command:Ui.addImport,args:[ke[ct],Xe]}),He.splice(He.length-$e,0,ct));for(const Ye of he){const tt=Ce[Ye.id];tt&&(delete tt.data,a.bv(tt,Ye)||le.push({command:Ui.updateImport,args:[Ye.id,Ye]}))}}(S.imports,F.imports,D),a.bv(S.transition,F.transition)||D.push({command:Ui.setTransition,args:[F.transition]}),a.bv(S.light,F.light)||D.push({command:Ui.setLight,args:[F.light]}),a.bv(S.fog,F.fog)||D.push({command:Ui.setFog,args:[F.fog]}),a.bv(S.snow,F.snow)||D.push({command:Ui.setSnow,args:[F.snow]}),a.bv(S.rain,F.rain)||D.push({command:Ui.setRain,args:[F.rain]}),a.bv(S.projection,F.projection)||D.push({command:Ui.setProjection,args:[F.projection]}),a.bv(S.lights,F.lights)||D.push({command:Ui.setLights,args:[F.lights]}),a.bv(S.camera,F.camera)||D.push({command:Ui.setCamera,args:[F.camera]}),a.bv(S.iconsets,F.iconsets)||function(ee,he,le){let Ae;for(Ae in he=he||{},ee=ee||{})ee.hasOwnProperty(Ae)&&(he.hasOwnProperty(Ae)||le.push({command:Ui.removeIconset,args:[Ae]}));for(Ae in he){if(!he.hasOwnProperty(Ae))continue;const fe=he[Ae];ee.hasOwnProperty(Ae)?a.bv(ee[Ae],fe)||(le.push({command:Ui.removeIconset,args:[Ae]}),le.push({command:Ui.addIconset,args:[Ae,fe]})):le.push({command:Ui.addIconset,args:[Ae,fe]})}}(S.iconsets,F.iconsets,D),!a.bv(S["color-theme"],F["color-theme"]))return[{command:Ui.setStyle,args:[F]}];const Q={},V=[];(function(ee,he,le,Ae){let fe;for(fe in he=he||{},ee=ee||{})ee.hasOwnProperty(fe)&&(he.hasOwnProperty(fe)||hl(fe,le,Ae));for(fe in he){if(!he.hasOwnProperty(fe))continue;const Ce=he[fe];ee.hasOwnProperty(fe)?a.bv(ee[fe],Ce)||(ee[fe].type==="geojson"&&Ce.type==="geojson"&&Kd(ee,he,fe)?le.push({command:Ui.setGeoJSONSourceData,args:[fe,Ce.data]}):Xc(fe,he,le,Ae)):kf(fe,he,le)}})(S.sources,F.sources,V,Q);const Z=[];S.layers&&S.layers.forEach(ee=>{ee.source&&Q[ee.source]?D.push({command:Ui.removeLayer,args:[ee.id]}):Z.push(ee)});let K=S.terrain;K&&Q[K.source]&&(D.push({command:Ui.setTerrain,args:[void 0]}),K=void 0),D=D.concat(V),a.bv(K,F.terrain)||D.push({command:Ui.setTerrain,args:[F.terrain]}),function(ee,he,le){he=he||[];const Ae=(ee=ee||[]).map(Zc),fe=he.map(Zc),Ce=ee.reduce(_u,{}),ke=he.reduce(_u,{}),He=Ae.slice(),$e=Object.create(null);let it,ct,Xe,Ye,tt,Pt,gt;for(it=0,ct=0;it<Ae.length;it++)Xe=Ae[it],ke.hasOwnProperty(Xe)?ct++:(le.push({command:Ui.removeLayer,args:[Xe]}),He.splice(He.indexOf(Xe,ct),1));for(it=0,ct=0;it<fe.length;it++)Xe=fe[fe.length-1-it],He[He.length-1-it]!==Xe&&(Ce.hasOwnProperty(Xe)?(le.push({command:Ui.removeLayer,args:[Xe]}),He.splice(He.lastIndexOf(Xe,He.length-ct),1)):ct++,Pt=He[He.length-it],le.push({command:Ui.addLayer,args:[ke[Xe],Pt]}),He.splice(He.length-it,0,Xe),$e[Xe]=!0);for(it=0;it<fe.length;it++)if(Xe=fe[it],Ye=Ce[Xe],tt=ke[Xe],!$e[Xe]&&!a.bv(Ye,tt))if(a.bv(Ye.source,tt.source)&&a.bv(Ye["source-layer"],tt["source-layer"])&&a.bv(Ye.type,tt.type)){for(gt in dh(Ye.layout,tt.layout,le,Xe,null,Ui.setLayoutProperty),dh(Ye.paint,tt.paint,le,Xe,null,Ui.setPaintProperty),a.bv(Ye.slot,tt.slot)||le.push({command:Ui.setSlot,args:[Xe,tt.slot]}),a.bv(Ye.filter,tt.filter)||le.push({command:Ui.setFilter,args:[Xe,tt.filter]}),a.bv(Ye.minzoom,tt.minzoom)&&a.bv(Ye.maxzoom,tt.maxzoom)||le.push({command:Ui.setLayerZoomRange,args:[Xe,tt.minzoom,tt.maxzoom]}),Ye)Ye.hasOwnProperty(gt)&&gt!=="layout"&&gt!=="paint"&&gt!=="filter"&&gt!=="metadata"&&gt!=="minzoom"&&gt!=="maxzoom"&&gt!=="slot"&&(gt.indexOf("paint.")===0?dh(Ye[gt],tt[gt],le,Xe,gt.slice(6),Ui.setPaintProperty):a.bv(Ye[gt],tt[gt])||le.push({command:Ui.setLayerProperty,args:[Xe,gt,tt[gt]]}));for(gt in tt)tt.hasOwnProperty(gt)&&!Ye.hasOwnProperty(gt)&&gt!=="layout"&&gt!=="paint"&&gt!=="filter"&&gt!=="metadata"&&gt!=="minzoom"&&gt!=="maxzoom"&&gt!=="slot"&&(gt.indexOf("paint.")===0?dh(Ye[gt],tt[gt],le,Xe,gt.slice(6),Ui.setPaintProperty):a.bv(Ye[gt],tt[gt])||le.push({command:Ui.setLayerProperty,args:[Xe,gt,tt[gt]]}))}else le.push({command:Ui.removeLayer,args:[Xe]}),Pt=He[He.lastIndexOf(Xe)+1],le.push({command:Ui.addLayer,args:[tt,Pt]})}(Z,F.layers,D)}catch(Q){console.warn("Unable to compute style diff:",Q),D=[{command:Ui.setStyle,args:[F]}]}return D}(this.serialize(),o).filter(S=>!(S.command in qd));if(m.length===0)return!1;const w=m.filter(S=>!(S.command in Wd));if(w.length>0)throw new Error(`Unimplemented: ${w.map(S=>S.command).join(", ")}.`);const E=[];return m.forEach(S=>{E.push(this[S.command](...S.args))}),h&&Promise.all(E).then(h).catch(h),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(o){if(o.size===0)return this;for(const[h,m]of o.entries()){if(this.getImage(h))return this.fire(new a.z(new Error(`An image with the name "${h.name}" already exists.`)));this.imageManager.addImage(h,this.scope,m),this._changes.updateImage(h,this.scope)}return this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})),this}addImage(o,h){return this.getImage(o)?this.fire(new a.z(new Error(`An image with the name "${o.name}" already exists.`))):(this.imageManager.addImage(o,this.scope,h),this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})),this)}updateImage(o,h,m=!1){this.imageManager.updateImage(o,this.scope,h),m&&(this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})))}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})),this):this.fire(new a.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(o){return this.modelManager.addModelURLs(o,this.scope),this._updateWorkerModels(),this.fire(new a.A("data",{dataType:"style"})),this}addModel(o,h,m={}){return this._checkLoaded(),this._validate(Ve,`models.${o}`,h,null,m)||(this.modelManager.addModel(o,h,this.scope),this.fire(new a.A("data",{dataType:"style"}))),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope,!1,!0),this.fire(new a.A("data",{dataType:"style"})),this):this.fire(new a.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,h,m={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(ba,`sources.${o}`,h,null,m))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const w=Hu(o,h,this.dispatcher,this);w.scope=this.scope,w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(w.id),source:w.serialize(),sourceId:w.id}));const E=S=>{const F=(S?"symbol:":"other:")+w.id,D=a.C(F,this.scope),Q=this._sourceCaches[F]=new zo(D,w,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[w.id]=Q,Q.onAdd(this.map)};E(!1),h.type!=="vector"&&h.type!=="geojson"||E(!0),w.onAdd&&w.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();const h=this.getOwnSource(o);if(!h)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===o)return this.fire(new a.z(new Error(`Source "${o}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new a.z(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const w=Object.entries(this.stylesheet.iconsets).find(([E,S])=>S.type==="source"&&S.source===o);if(w)return this.fire(new a.z(new Error(`Source "${o}" cannot be removed while iconset "${w[0]}" is using it.`)))}const m=this.getOwnSourceCaches(o);for(const w of m){const E=a.dj(w.id);delete this._sourceCaches[E],this._changes.discardSourceCacheUpdate(w.id),w.fire(new a.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,h){this._checkLoaded(),this.getOwnSource(o).setData(h),this._changes.setDirty()}getOwnSource(o){const h=this.getOwnSourceCache(o);return h&&h.getSource()}getOwnSources(){const o=[];for(const h in this._otherSourceCaches){const m=this.getOwnSourceCache(h);m&&o.push(m.getSource())}return o}areTilesLoaded(){const o=this._mergedSourceCaches;for(const h in o){const m=o[h]._tiles;for(const w in m){const E=m[w];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;const h=this._getTransitionParameters();for(const E of o){if(this._validate(Ea,"lights",E))return;switch(E.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(E),S.updateTransitions(h)}else this.ambientLight=new Kn(E,Hr||(Hr=new a.a7({color:new a.a8(a.a5.properties_light_ambient.color),"color-use-theme":new a.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new a.a8(a.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(E),S.updateTransitions(h)}else this.directionalLight=new Kn(E,Jr||(Jr=new a.a7({direction:new a.an(a.a5.properties_light_directional.direction),color:new a.a8(a.a5.properties_light_directional.color),"color-use-theme":new a.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new a.a8(a.a5.properties_light_directional.intensity),"cast-shadows":new a.a8(a.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new a.a8(a.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new a.a8(a.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=Object.assign(h,{worldview:this.map.getWorldview()}),w=new a.aa(this.z||0,m);this.ambientLight&&this.ambientLight.recalculate(w),this.directionalLight&&this.directionalLight.recalculate(w),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const o=this.directionalLight,h=this.ambientLight;if(!o||!h)return;const m=K=>.2126*(K[0]<=.03928?K[0]/12.92:Math.pow((K[0]+.055)/1.055,2.4))+.7152*(K[1]<=.03928?K[1]/12.92:Math.pow((K[1]+.055)/1.055,2.4))+.0722*(K[2]<=.03928?K[2]/12.92:Math.pow((K[2]+.055)/1.055,2.4)),w=o.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),E=o.properties.get("intensity"),S=o.properties.get("direction"),F=1-a.d1(S.x,S.y,S.z)[2]/90,D=m(w)*E*F,Q=h.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),V=h.properties.get("intensity"),Z=m(Q)*V;return Number(((D+Z)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(o==null||o===""&&this.isRootStyle())return this;if(a.dk(o)){const h=a.dl(o),m=this.fragments.find(({id:E})=>E===h);if(!m)return;const w=a.dj(o);return m.style.getFragmentStyle(w)}{const h=this.fragments.find(({id:m})=>m===o);return h?h.style:void 0}}setFeaturesetSelectors(o){if(!o)return;const h={},m=(w,E="")=>`${w}::${E}`;this._featuresetSelectors={};for(const w in o){const E=this._featuresetSelectors[w]=[];for(const S of o[w].selectors){if(S.featureNamespace){const D=this.getOwnLayer(S.layer);if(!D){a.w(`Layer is undefined for selector: ${S.layer}`);continue}const Q=m(D.source,D.sourceLayer);if(Q in h&&h[Q]!==S.featureNamespace){a.w(`"featureNamespace ${S.featureNamespace} of featureset ${w}'s selector is not associated to the same source, skip this selector`);continue}h[Q]=S.featureNamespace}let F;if(S.properties)for(const D in S.properties){const Q=a.X(S.properties[D]);Q.result==="success"&&(F=F||{},F[D]=Q.value)}E.push({layerId:S.layer,namespace:S.featureNamespace,properties:F,uniqueFeatureID:S._uniqueFeatureID})}}}getFeaturesetDescriptors(o){const h=this.getFragmentStyle(o);if(!h||!h.stylesheet.featuresets)return[];const m=[];for(const w in h.stylesheet.featuresets)m.push({featuresetId:w,importId:h.scope?h.scope:void 0});return m}getFeaturesetLayers(o,h){const m=this.getFragmentStyle(h),w=m.stylesheet.featuresets;if(!w||!w[o])return this.fire(new a.z(new Error(`The featureset '${o}' does not exist in the map's style and cannot be queried.`))),[];const E=[];for(const S of w[o].selectors){const F=m.getOwnLayer(S.layer);F&&E.push(F)}return E}getConfigProperty(o,h){const m=this.getFragmentStyle(o);if(!m)return null;const w=a.C(h,m.scope),E=m.options.get(w),S=E?E.value||E.default:null;return S?S.serialize():null}setConfigProperty(o,h,m){const w=this.getFragmentStyle(o);if(!w)return;const E=w.stylesheet.indoor?vs(w.stylesheet.schema):w.stylesheet.schema;if(!E||!E[h])return;const S=a.X(m);if(S.result!=="success")return void tu(this,S.value);const F=S.value.expression,D=a.C(h,w.scope),Q=w.options.get(D);if(!Q)return;let V;const{minValue:Z,maxValue:K,stepValue:ee,type:he,values:le}=E[h],Ae=a.X(E[h].default);Ae.result==="success"&&(V=Ae.value.expression),V?(this.options.set(D,Object.assign({},Q,{value:F,default:V,minValue:Z,maxValue:K,stepValue:ee,type:he,values:le})),this.updateConfigDependencies(h)):this.fire(new a.z(new Error(`No schema defined for the config option "${h}" in the "${o}" fragment.`)))}getConfig(o){const h=this.getFragmentStyle(o);if(!h)return null;const m=h.stylesheet.schema;if(!m)return null;const w={};for(const E in m){const S=a.C(E,h.scope),F=h.options.get(S),D=F?F.value||F.default:null;w[E]=D?D.serialize():null}return w}setConfig(o,h){const m=this.getFragmentStyle(o);m&&(m.updateConfig(h,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(o){const h=this.getFragmentStyle(o);return h?h.stylesheet.schema:null}setSchema(o,h){const m=this.getFragmentStyle(o);m&&(m.stylesheet.schema=h,m.updateConfig(m._config,h),this.updateConfigDependencies())}updateConfig(o,h){if(this._config=o,o||h)if(h)for(const m in h){let w,E;const S=a.X(h[m].default);if(S.result==="success"&&(w=S.value.expression),o&&o[m]!==void 0){const K=a.X(o[m]);K.result==="success"&&(E=K.value.expression)}const{minValue:F,maxValue:D,stepValue:Q,type:V,values:Z}=h[m];if(w){const K=a.C(m,this.scope);this.options.set(K,{default:w,value:E,minValue:F,maxValue:D,stepValue:Q,type:V,values:Z})}else this.fire(new a.z(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new a.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(o){for(const h of this._configDependentLayers){const m=this.getLayer(h);if(m){if(o&&!m.configDependencies.has(o))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(h=>{const m=h._styleColorTheme.colorThemeOverride?h._styleColorTheme.colorThemeOverride:h._styleColorTheme.colorTheme;if(m){const w=h._evaluateColorThemeData(m);(!h._styleColorTheme.lut&&w!==""||h._styleColorTheme.lut&&w!==h._styleColorTheme.lut.data)&&h.setColorTheme(m)}}),this._changes.setDirty()}addLayer(o,h,m={}){this._checkLoaded();const w=o.id;if(this._layers[w])return void this.fire(new a.z(new Error(`Layer with id "${w}" already exists on this map`)));let E;if(o.type==="custom"){if(tu(this,a.dm(o)))return;E=a.dn(o,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=a.di(o),o=a.h(o,{source:w})),this._validate(_n,`layers.${w}`,o,{arrayIndex:-1},m))return;E=a.dn(o,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(E),E.setEventedParent(this,{layer:{id:w}})}E.configDependencies.size!==0&&this._configDependentLayers.add(E.fqid);let S=this._order.length;if(h){const V=this._order.indexOf(h);if(V===-1)return void this.fire(new a.z(new Error(`Layer with id "${h}" does not exist on this map.`)));E.slot===this._layers[h].slot?S=V:a.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,w),this._layerOrderChanged=!0,this._layers[w]=E;const F=this.getOwnLayerSourceCache(E),D=!!this.directionalLight&&this.directionalLight.shadowsEnabled();F&&E.canCastShadows()&&D&&(F.castsShadows=!0);const Q=this._changes.getRemovedLayer(E);if(Q&&E.source&&F&&E.type!=="custom"){this._changes.discardLayerRemoval(E);const V=a.C(E.source,E.scope);Q.type!==E.type?this._changes.updateSourceCache(V,"clear"):(this._changes.updateSourceCache(V,"reload"),F.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),E.scope=this.scope,this.mergeLayers()}moveLayer(o,h){this._checkLoaded();const m=this._checkLayer(o);if(!m||o===h)return;const w=this._order.indexOf(o);this._order.splice(w,1);let E=this._order.length;if(h){const S=this._order.indexOf(h);if(S===-1)return void this.fire(new a.z(new Error(`Layer with id "${h}" does not exist on this map.`)));m.slot===this._layers[h].slot?E=S:a.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();const h=this._checkLayer(o);if(!h)return;h.setEventedParent(null);const m=this._order.indexOf(o);this._order.splice(m,1),delete this._layers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(h.fqid),this._changes.removeLayer(h);const w=this.getOwnLayerSourceCache(h);if(w&&w.castsShadows){let E=!1;for(const S in this._layers)if(this._layers[S].source===h.source&&this._layers[S].canCastShadows()){E=!0;break}w.castsShadows=E}h.onRemove&&h.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(const h in this._layers)if(this._layers[h].type===o)return!0;return!1}setLayerZoomRange(o,h,m){this._checkLoaded();const w=this._checkLayer(o);w&&(w.minzoom===h&&w.maxzoom===m||(h!=null&&(w.minzoom=h),m!=null&&(w.maxzoom=m),this._updateLayer(w)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(o,h){this._checkLoaded();const m=this._checkLayer(o);m&&m.slot!==h&&(m.slot=h,this._updateLayer(m))}setFilter(o,h,m={}){this._checkLoaded();const w=this._checkLayer(o);if(w&&!a.bv(w.filter,h))return h==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(Tt,`layers.${w.id}.filter`,h,{layerType:w.type},m)||(w.filter=a.di(h),this._updateLayer(w)))}getFilter(o){const h=this._checkLayer(o);if(h)return a.di(h.filter)}setLayoutProperty(o,h,m,w={}){this._checkLoaded();const E=this._checkLayer(o);if(E&&!a.bv(E.getLayoutProperty(h),m)){if(m!=null&&(!w||w.validate!==!1)&&tu(E,be.call(wa,{key:`layers.${o}.layout.${h}`,layerType:E.type,objectKey:h,value:m,styleSpec:a.a5,style:{glyphs:!0,sprite:!0}})))return;E.setLayoutProperty(h,m),E.configDependencies.size!==0&&this._configDependentLayers.add(E.fqid),this._updateLayer(E)}}getLayoutProperty(o,h){const m=this._checkLayer(o);if(m)return m.getLayoutProperty(h)}setPaintProperty(o,h,m,w={}){this._checkLoaded();const E=this._checkLayer(o);if(!E||a.bv(E.getPaintProperty(h),m)||m!=null&&(!w||w.validate!==!1)&&tu(E,pe.call(wa,{key:`layers.${o}.paint.${h}`,layerType:E.type,objectKey:h,value:m,styleSpec:a.a5})))return;const S=E.setPaintProperty(h,m);E.configDependencies.size!==0&&this._configDependentLayers.add(E.fqid),S&&this._updateLayer(E),this._changes.updatePaintProperties(E)}getPaintProperty(o,h){const m=this._checkLayer(o);if(m)return m.getPaintProperty(h)}setFeatureState(o,h){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:D,importId:Q}=o.target,V=this.getFragmentStyle(Q),Z=V.getFeaturesetLayers(D);for(const{source:K,sourceLayer:ee}of Z)V.setFeatureState({id:o.id,source:K,sourceLayer:ee},h)}else if("layerId"in o.target){const{layerId:D}=o.target,Q=this.getLayer(D);this.setFeatureState({id:o.id,source:Q.source,sourceLayer:Q.sourceLayer},h)}return}const m=o.source,w=o.sourceLayer,E=this._checkSource(m);if(!E)return;const S=E.type;if(S==="geojson"&&w)return void this.fire(new a.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!w)return void this.fire(new a.z(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new a.z(new Error("The feature id parameter must be provided.")));const F=this.getOwnSourceCaches(m);for(const D of F)D.setFeatureState(w,o.id,h)}removeFeatureState(o,h){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:D,importId:Q}=o.target,V=this.getFragmentStyle(Q),Z=V.getFeaturesetLayers(D);for(const{source:K,sourceLayer:ee}of Z)V.removeFeatureState({id:o.id,source:K,sourceLayer:ee},h)}else if("layerId"in o.target){const{layerId:D}=o.target,Q=this.getLayer(D);this.removeFeatureState({id:o.id,source:Q.source,sourceLayer:Q.sourceLayer},h)}return}const m=o.source,w=this._checkSource(m);if(!w)return;const E=w.type,S=E==="vector"?o.sourceLayer:void 0;if(E==="vector"&&!S)return void this.fire(new a.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new a.z(new Error("A feature id is required to remove its specific state property.")));const F=this.getOwnSourceCaches(m);for(const D of F)D.removeFeatureState(S,o.id,h)}getFeatureState(o){if(this._checkLoaded(),"target"in o){let E;if("featuresetId"in o.target){const{featuresetId:S,importId:F}=o.target,D=this.getFragmentStyle(F),Q=D.getFeaturesetLayers(S);for(const{source:V,sourceLayer:Z}of Q){const K=D.getFeatureState({id:o.id,source:V,sourceLayer:Z});if(K&&!E)E=K;else if(!a.bv(E,K))return void this.fire(new a.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in o.target){const{layerId:S}=o.target,F=this.getLayer(S);E=this.getFeatureState({id:o.id,source:F.source,sourceLayer:F.sourceLayer})}return E}const h=o.source,m=o.sourceLayer,w=this._checkSource(h);if(w){if(w.type!=="vector"||m)return o.id===void 0&&this.fire(new a.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(h)[0].getFeatureState(m,o.id);this.fire(new a.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=a.h({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return a.h({},this.stylesheet.transition)}serialize(){this._checkLoaded();const o=this.getTerrain(),h=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return a.dp({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:h,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(o){for(const h of Object.values(this._mergedLayers))o(h)&&this._updateLayer(h)}_updateLayer(o){this._changes.updateLayer(o);const h=this.getLayerSourceCache(o),m=a.C(o.source,o.scope),w=this._changes.getUpdatedSourceCaches();o.source&&!w[m]&&h&&h.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),h.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const h=F=>this._mergedLayers[F].is3D(!!this.terrain),m=this.order,w={},E=[];for(let F=m.length-1;F>=0;F--){const D=m[F];if(h(D)){w[D]=F;for(const Q of o){const V=Q[D];if(V)for(const Z of V)E.push(Z)}}}E.sort((F,D)=>D.intersectionZ-F.intersectionZ);const S=[];for(let F=m.length-1;F>=0;F--){const D=m[F];if(h(D))for(let Q=E.length-1;Q>=0;Q--){const V=E[Q].feature;if(V.layer&&w[V.layer.id]<F)break;S.push(V),E.pop()}else for(const Q of o){const V=Q[D];if(V)for(const Z of V)S.push(Z.feature)}}return S}queryRenderedFeatures(o,h,m){let w;h&&!Array.isArray(h)&&h.filter&&(this._validate(Tt,"queryRenderedFeatures.filter",h.filter,null,h),w=a.b3(h.filter));const E={},S=V=>{if(zf.has(V.type))return;const Z=this.getOwnLayerSourceCache(V),K=E[Z.id]=E[Z.id]||{sourceCache:Z,layers:{},has3DLayers:!1};V.is3D(!!this.terrain)&&(K.has3DLayers=!0),K.layers[V.fqid]=K.layers[V.fqid]||{styleLayer:V,targets:[]},K.layers[V.fqid].targets.push({filter:w})};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new a.z(new Error("parameters.layers must be an Array."))),[];for(const V of h.layers){const Z=this._layers[V];if(!Z)return this.fire(new a.z(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];S(Z)}}else for(const V in this._layers)S(this._layers[V]);const F=this._queryRenderedFeatures(o,E,m),D=this._flattenAndSortRenderedFeatures(F),Q=[];for(const V of D)a.dq(V.layer.id)===this.scope&&Q.push(V);return Q}queryRenderedFeatureset(o,h,m){let w;h&&!Array.isArray(h)&&h.filter&&(this._validate(Tt,"queryRenderedFeatures.filter",h.filter,null,h),w=a.b3(h.filter));const E="mock",S=[];if(h&&h.target)S.push(Object.assign({},h,{targetId:E,filter:w}));else{const V=this.getFeaturesetDescriptors();for(const Z of V)S.push({targetId:E,filter:w,target:Z});for(const{style:Z}of this.fragments){const K=Z.getFeaturesetDescriptors();for(const ee of K)S.push({targetId:E,filter:w,target:ee})}}const F=this.queryRenderedTargets(o,S,m),D=[],Q=new Set;for(const V of F)for(const Z of V.variants[E])wc(Z,V,Q)||D.push(new a.dr(V,Z));return D}queryRenderedTargets(o,h,m){const w={},E=(F,D,Q,V)=>{const Z=w[D.id]=w[D.id]||{sourceCache:D,layers:{},has3DLayers:!1};if(Z.layers[F.fqid]=Z.layers[F.fqid]||{styleLayer:F,targets:[]},F.is3D(!!this.terrain)&&(Z.has3DLayers=!0),!V)return Q.uniqueFeatureID=!1,void Z.layers[F.fqid].targets.push(Q);Z.layers[F.fqid].targets.push(Object.assign({},Q,{namespace:V.namespace,properties:V.properties,uniqueFeatureID:V.uniqueFeatureID}))};for(const F of h)if("featuresetId"in F.target){const{featuresetId:D,importId:Q}=F.target,V=this.getFragmentStyle(Q);if(!V||!V._featuresetSelectors)continue;const Z=V._featuresetSelectors[D];if(!Z){this.fire(new a.z(new Error(`The featureset '${D}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const K of Z){const ee=V.getOwnLayer(K.layerId);ee&&!zf.has(ee.type)&&E(ee,V.getOwnLayerSourceCache(ee),F,K)}}else if("layerId"in F.target){const{layerId:D}=F.target,Q=this.getLayer(D);if(!Q||zf.has(Q.type))continue;E(Q,this.getLayerSourceCache(Q),F)}const S=this._queryRenderedFeatures(o,w,m);return this._flattenAndSortRenderedFeatures(S)}_queryRenderedFeatures(o,h,m){const w=[],E=!!this.map._showQueryGeometry,S=Sn.createFromScreenPoints(o,m);for(const F in h){const D=Cl(S,h[F],this._availableImages,m,E);Object.keys(D).length&&w.push(D)}if(this.placement)for(const F in h){if(!h[F].sourceCache._onlySymbols)continue;const D=qc(S.screenGeometry,h[F],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(D).length&&w.push(D)}return w}querySourceFeatures(o,h){const m=h&&h.filter;m&&this._validate(Tt,"querySourceFeatures.filter",m,null,h);let w=[];const E=this.getOwnSourceCaches(o);for(const S of E)w=w.concat(No(S,h));return w}addSourceType(o,h,m){return Al.getSourceType(o)?m(new Error(`A source type called "${o}" already exists.`)):(Al.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,h,m={}){this._checkLoaded();const w=this.light.getLight();let E=!1;for(const F in o)if(!a.bv(o[F],w[F])){E=!0;break}if(!E)return;const S=this._getTransitionParameters();this.light.setLight(o,h,m),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(o,h=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),h===0&&delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=o;const w=o.source==null;if(h===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const F="terrain-dem-src";this.addSource(F,m.source),m=a.di(m),m=a.h(m,{source:F})}const E=a.h({},m),S={};if(this.terrain&&w){E.source=this.terrain.get().source;const F=this.terrain?this.getFragmentStyle(this.terrain.scope):null;F&&(S.style=F.serialize())}if(this._validate(hr,"terrain",E,S))return}if(!this.terrain||this.terrain.scope!==this.scope&&!w||this.terrain&&h!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,h),this.fire(new a.A("data",{dataType:"style"}))}else{const E=this.terrain,S=E.get();for(const F of Object.keys(a.a5.terrain))!m.hasOwnProperty(F)&&a.a5.terrain[F].default&&(m[F]=a.a5.terrain[F].default);for(const F in o)if(!a.bv(o[F],S[F])){E.set(o,this.options),this.stylesheet.terrain=o;const D=this._getTransitionParameters({duration:0});E.updateTransitions(D),this.fire(new a.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const h=this.fog=new Gt(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}_createSnow(o){const h=this.snow=new en(o,this.map.transform,this.scope,this.options);this.stylesheet.snow=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}_createRain(o){const h=this.rain=new Vn(o,this.map.transform,this.scope,this.options);this.stylesheet.rain=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog;if(!a.bv(h.get(),o)){h.set(o,this.options),this.stylesheet.fog=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}}else this._createFog(o);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(o){if(this._checkLoaded(),!o)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const h=this.snow;if(!a.bv(h.get(),o)){h.set(o,this.options),this.stylesheet.snow=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}}else this._createSnow(o);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(o){if(this._checkLoaded(),!o)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const h=this.rain;if(!a.bv(h.get(),o)){h.set(o,this.options),this.stylesheet.rain=h.get();const m=this._getTransitionParameters({duration:0});h.updateTransitions(m)}}else this._createRain(o);this._markersNeedUpdate=!0}_reloadColorTheme(){const o=()=>{for(const w in this._layers)this._layers[w].lut=this._styleColorTheme.lut;for(const w in this._sourceCaches)this._sourceCaches[w].clearTiles()},h=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!h)return this._styleColorTheme.lut=null,void o();const m=this._evaluateColorThemeData(h);this._loadColorTheme(m).then(()=>{this.fire(new a.A("colorthemeset")),o()}).catch(w=>{a.w(`Couldn't set color theme: ${w}`)})}setColorTheme(o){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&a.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=o,this._reloadColorTheme()}setImportColorTheme(o,h){const m=this.getFragmentStyle(o);m&&(m._styleColorTheme.colorThemeOverride=h,m._reloadColorTheme())}_getTransitionParameters(o){return{now:a.q.now(),transition:a.h(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;const o=[],h=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?o.push(m):h.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...h)}_createTerrain(o,h){const m=this.terrain=new me(o,h,this.scope,this.options,this.map.getWorldview());h===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const w=this._getTransitionParameters({duration:0});m.updateTransitions(w)}_force3DLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="symbol"&&this._updateLayer(h)}}_validate(o,h,m,w,E={}){if(E&&E.validate===!1)return!1;const S=a.h({},this.serialize());return tu(this,o.call(wa,a.h({key:h,style:S,value:m,styleSpec:a.a5},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.ds.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(o){const h=this.getSourceCaches(o);for(const m of h)m.clearTiles()}clearSources(){for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}clearLayers(){for(const o in this._mergedLayers){const h=this._mergedLayers[o];h._clear&&h._clear()}}reloadSource(o){const h=this.getSourceCaches(o);for(const m of h)m.resume(),m.reload()}reloadSources(){for(const o of this.getSources())o.reload&&o.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(o=>{o.modelManager.reloadModels(o.scope)})}updateSources(o){let h;this.directionalLight&&(h=Ic(this.directionalLight));const m=new Set;for(const w in this._mergedLayers){const E=this._mergedLayers[w];E.hasElevation()&&!m.has(E.source)&&m.add(E.source)}for(const w in this._mergedSourceCaches){const E=this._mergedSourceCaches[w],S=m.has(E._source.id);E.update(o,void 0,void 0,h,S)}}_generateCollisionBoxes(){for(const o in this._sourceCaches){const h=this._sourceCaches[o];h.resume(),h.reload()}}_updatePlacement(o,h,m,w,E,S,F=!1){let D=!1,Q=!1;const V={},Z={};for(const K of this._mergedOrder){const ee=this._mergedLayers[K];if(ee.type!=="symbol")continue;const he=a.C(ee.source,ee.scope);let le=V[he];if(!le){const fe=this.getLayerSourceCache(ee);if(!fe)continue;const Ce=fe.getRenderableIds(!0).map(ke=>fe.getTileByID(ke));Z[he]=Ce.slice(),le=V[he]=Ce.sort((ke,He)=>He.tileID.overscaledZ-ke.tileID.overscaledZ||(ke.tileID.isLessThan(He.tileID)?-1:1))}const Ae=this.crossTileSymbolIndex.addLayer(ee,le,h.center.lng,h.projection);D=D||Ae}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),F=F||this._layerOrderChanged||w===0,this._layerOrderChanged&&this.fire(new a.A("neworder")),(F||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.q.now(),h.zoom))&&(this.pauseablePlacement=new xu(h,this._mergedOrder,F,m,w,E,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,V,Z,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.q.now()),Q=!0),D&&this.pauseablePlacement.placement.setStale()),Q||D){this._buildingIndex.onNewFrame(h.zoom);for(let K=0;K<this._mergedOrder.length;K++){const ee=this._mergedLayers[this._mergedOrder[K]];if(ee.type!=="symbol")continue;const he=this.isLayerClipped(ee);this.placement.updateLayerOpacities(ee,V[a.C(ee.source,ee.scope)],K,he?S:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.q.now())}}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,h){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:E})=>E===o.id)!==-1)return void this.fire(new a.z(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!h)return m.push(o),this._loadImports([o],!0);const w=m.findIndex(({id:E})=>E===h);return w===-1&&this.fire(new a.z(new Error(`Import with id "${h}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,w).concat(o).concat(m.slice(w)),this._loadImports([o],!0,h)}updateImport(o,h){this._checkLoaded();const m=this.stylesheet.imports||[],w=this.getImportIndex(o);return w===-1?this:typeof h=="string"?(this.setImportUrl(o,h),this):(h.url&&h.url!==m[w].url&&this.setImportUrl(o,h.url),a.bv(h.config,m[w].config)||this.setImportConfig(o,h.config,h.data.schema),a.bv(h.data,m[w].data)||this.setImportData(o,h.data),this)}moveImport(o,h){this._checkLoaded();let m=this.stylesheet.imports||[];const w=this.getImportIndex(o);if(w===-1)return this;const E=this.getImportIndex(h);if(E===-1)return this;const S=m[w],F=this.fragments[w];return m=m.filter(({id:D})=>D!==o),this.fragments=this.fragments.filter(({id:D})=>D!==o),this.stylesheet.imports=m.slice(0,E).concat(S).concat(m.slice(E)),this.fragments=this.fragments.slice(0,E).concat(F).concat(this.fragments.slice(E)),this.mergeLayers(),this}setImportUrl(o,h){this._checkLoaded();const m=this.stylesheet.imports||[],w=this.getImportIndex(o);if(w===-1)return this;m[w].url=h;const E=this.fragments[w];return E.style=this._createFragmentStyle(m[w]),E.style.on("style.import.load",()=>this.mergeAll()),E.style.loadURL(h),this}setImportData(o,h){this._checkLoaded();const m=this.getImportIndex(o),w=this.stylesheet.imports||[];return m===-1?this:h?(this.fragments[m].style.setState(h),this._reloadImports(),this):(delete w[m].data,this.setImportUrl(o,w[m].url))}setImportConfig(o,h,m){this._checkLoaded();const w=this.getImportIndex(o),E=this.stylesheet.imports||[];if(w===-1)return this;h?E[w].config=h:delete E[w].config;const S=this.fragments[w];m&&S.style.stylesheet&&(S.style.stylesheet.schema=m);const F=S.style.stylesheet&&S.style.stylesheet.schema;return S.config=h,S.style.updateConfig(h,F),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();const h=this.stylesheet.imports||[],m=this.getImportIndex(o);m!==-1&&(h.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(o){const h=(this.stylesheet.imports||[]).findIndex(m=>m.id===o);return h===-1&&this.fire(new a.z(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),h}getLayer(o){return this._mergedLayers[o]}getSources(){const o=[];for(const h in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[h];m&&o.push(m.getSource())}return o}getSource(o,h){const m=this.getSourceCache(o,h);return m&&m.getSource()}getLayerSource(o){const h=this.getLayerSourceCache(o);return h&&h.getSource()}getSourceCache(o,h){const m=a.C(o,h);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(o){const h=a.C(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[h]:this._mergedOtherSourceCaches[h]}getSourceCaches(o){if(o==null)return Object.values(this._mergedSourceCaches);const h=[];return this._mergedOtherSourceCaches[o]&&h.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&h.push(this._mergedSymbolSourceCaches[o]),h}updateSourceCaches(){const o=this._changes.getUpdatedSourceCaches();for(const h in o){const m=o[h];m==="reload"?this.reloadSource(h):m==="clear"&&this.clearSource(h)}}updateLayers(o){const h=this._changes.getUpdatedPaintProperties();for(const m of h){const w=this.getLayer(m);w&&w.updateTransitions(o)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(o){this.stylesheet.glyphs=o,this.glyphManager.setURL(o)}getImages(o,h,m){this.imageManager.getImages(h.images,h.scope,m),this._updateTilesForChangedImages();const w=S=>{if(S){const F=h.images.map(D=>a.I.toString(D));S.setDependencies(h.tileID.key,h.type,F)}},E=a.C(h.source,h.scope);w(this._mergedOtherSourceCaches[E]),w(this._mergedSymbolSourceCaches[E]),h.images.some(S=>S.iconsetId)&&this.fire(new a.A("data",{dataType:"style"}))}rasterizeImages(o,h,m){this.imageManager.rasterizeImages(h,m)}getGlyphs(o,h,m){this.glyphManager.getGlyphs(h.stacks,m)}getResource(o,h,m){return a.dt(h,m)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){const h=[];return this._otherSourceCaches[o]&&h.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&h.push(this._symbolSourceCaches[o]),h}_isSourceCacheLoaded(o){const h=this.getOwnSourceCaches(o);return h.length===0?(this.fire(new a.z(new Error(`There is no source with ID '${o}'`))),!1):h.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(o,h){if(!this._clipLayerPresent&&o.type!=="fill-extrusion"&&o.type!=="building")return!1;const m=o.type==="fill-extrusion"&&(o.sourceLayer==="building"||o.sourceLayer==="procedural_buildings"),w=o.type==="building";if(o.is3D(!!this.terrain)){if(m||w||h&&h.type==="batched-model"||o.type==="model")return!0}else if(o.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(o=>{o.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Al.getSourceType=function(p){return Rf[p]},Al.setSourceType=function(p,o){Rf[p]=o},Al.registerForPluginStateChange=a.du;var SA=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Xu=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Hh=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,ud="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",mf=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Ys=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,vh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Lr=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Qf=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,TA=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,IA=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const jf=[];Ho(SA,jf),Ho(Hh,jf),Ho(Xu,jf);const Vh={"_prelude_fog.vertex.glsl":Ys,"_prelude_terrain.vertex.glsl":mf,"_prelude_shadow.vertex.glsl":TA,"_prelude_fog.fragment.glsl":vh,"_prelude_shadow.fragment.glsl":IA,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Lr,"_prelude_raster_particle.glsl":Qf},Fc={};ai("",mf),ai(vh,Ys),ai(IA,TA),ai(Lr,""),ai(Qf,"");const FA=ai(Xu,Hh),Fl=SA;var yh={background:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,base_color.rgb,emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:ai(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:ai(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:ai("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ai(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:ai(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ai("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:ai("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:ai("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:ai(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:ai(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:ai(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:ai(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:ai(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:ai(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:ai("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:ai("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:ai(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:ai(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:ai("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:ai(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ud),skyboxGradient:ai(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ud),skyboxCapture:ai(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:ai(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:ai(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:ai(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:ai(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:ai("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:ai("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:ai("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:ai("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ho(p,o){const h=p.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of h)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=m.split(" ");for(const E of w)o.includes(E)||o.push(E)}}function ai(p,o){const h=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let w=o.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);w&&(w=w.map(Q=>{const V=Q.split(" ");return V[V.length-1]}),w=[...new Set(w)]);const E={},S=[],F=[];if(p=p.replace(h,(Q,V)=>(F.push(V),"")),(o=o.replace(h,(Q,V)=>(S.push(V),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let D=[...jf];Ho(p,D),Ho(o,D);for(const Q of[...S,...F])Vh[Q]||console.error(`Undefined include: ${Q}`),Fc[Q]||(Fc[Q]=[],Ho(Vh[Q],Fc[Q])),D=[...D,...Fc[Q]];return{fragmentSource:p=p.replace(m,(Q,V,Z,K,ee)=>(E[ee]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
in ${Z} ${K} ${ee};
#else
uniform ${Z} ${K} u_${ee};
#endif
`:V==="initialize"?`
#ifdef HAS_UNIFORM_u_${ee}
    ${Z} ${K} ${ee} = u_${ee};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    in ${Z} ${K} ${ee};
#endif
`:V==="initialize-attribute"?"":void 0)),vertexSource:o=o.replace(m,(Q,V,Z,K,ee)=>{const he=K==="float"?"vec2":K,le=ee.match(/color/)?"color":he;return V==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
in ${Z} ${K} a_${ee};
#endif
`:E[ee]?V==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${Z} ${he} a_${ee};
out ${Z} ${K} ${ee};
#else
uniform ${Z} ${K} u_${ee};
#endif
`:V==="initialize"?le==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = a_${ee};
#else
    ${Z} ${K} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = unpack_mix_${le}(a_${ee}, u_${ee}_t);
#else
    ${Z} ${K} ${ee} = u_${ee};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    in ${Z} ${K} a_${ee};
    out ${Z} ${K} ${ee};
#endif
`:V==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    ${ee} = a_${ee};
#endif
`:void 0:V==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${Z} ${he} a_${ee};
#else
uniform ${Z} ${K} u_${ee};
#endif
`:V==="define-instanced"?le==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ee}0;
in vec4 a_${ee}1;
in vec4 a_${ee}2;
in vec4 a_${ee}3;
#else
uniform ${Z} ${K} u_${ee};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${Z} ${he} a_${ee};
#else
uniform ${Z} ${K} u_${ee};
#endif
`:V==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ee}
    ${Z} ${K} ${ee} = a_${ee};
#endif
`:le==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${Z} ${K} ${ee} = a_${ee};
#else
    ${Z} ${K} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${Z} ${K} ${ee} = unpack_mix_${le}(a_${ee}, u_${ee}_t);
#else
    ${Z} ${K} ${ee} = u_${ee};
#endif
`}),staticAttributes:w,usedDefines:D,vertexIncludes:S,fragmentIncludes:F}}class $d{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,h,m,w,E,S,F,D){this.context=o;let Q=this.boundPaintVertexBuffers.length!==w.length;for(let Z=0;!Q&&Z<w.length;Z++)this.boundPaintVertexBuffers[Z]!==w[Z]&&(Q=!0);let V=this.boundDynamicVertexBuffers.length!==F.length;for(let Z=0;!V&&Z<F.length;Z++)this.boundDynamicVertexBuffers[Z]!==F[Z]&&(V=!0);if(!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==m||Q||V||this.boundIndexBuffer!==E||this.boundVertexOffset!==S)this.freshBind(h,m,w,E,S,F,D);else{o.bindVertexArrayOES.set(this.vao);for(const Z of F)Z&&(Z.bind(),D&&Z.instanceCount&&Z.setVertexAttribDivisor(o.gl,h,D));E&&E.dynamicDraw&&E.bind()}}freshBind(o,h,m,w,E,S,F){const D=o.numAttributes,Q=this.context,V=Q.gl;this.vao&&this.destroy(),this.vao=Q.gl.createVertexArray(),Q.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=w,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=S,h.enableAttributes(V,o),h.bind(),h.setVertexAttribPointers(V,o,E);for(const Z of m)Z.enableAttributes(V,o),Z.bind(),Z.setVertexAttribPointers(V,o,E);for(const Z of S)Z&&(Z.enableAttributes(V,o),Z.bind(),Z.setVertexAttribPointers(V,o,E),F&&Z.instanceCount&&Z.setVertexAttribDivisor(V,o,F));w&&w.bind(),Q.currentNumAttributes=D}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function xh(p,o){const h=Math.pow(2,o.canonical.z),m=o.canonical.y;return[new a.ac(0,m/h).toLngLat().lat,new a.ac(0,(m+1)/h).toLngLat().lat]}function Sm(p,o,h,m,w,E,S){const F=p.context,D=F.gl,Q=h.hillshadeFBO;if(!Q)return;p.prepareDrawTile();const V=p.isTileAffectedByFog(o),Z=p.getOrCreateProgram("hillshade",{overrideFog:V});F.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,Q.colorAttachment.get());const K=((Ae,fe,Ce,ke)=>{const He=Ce.paint.get("hillshade-shadow-color"),$e=Ce.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",it=Ce.paint.get("hillshade-highlight-color"),ct=Ce.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Xe=Ce.paint.get("hillshade-accent-color"),Ye=Ce.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",tt=Ce.paint.get("hillshade-emissive-strength");let Pt=a.al(Ce.paint.get("hillshade-illumination-direction"));if(Ce.paint.get("hillshade-illumination-anchor")==="viewport")Pt-=Ae.transform.angle;else if(Ae.style&&Ae.style.enable3dLights()&&Ae.style.directionalLight){const Jt=Ae.style.directionalLight.properties.get("direction"),kt=a.d1(Jt.x,Jt.y,Jt.z);Pt=a.al(kt[1])}const gt=!Ae.options.moving;return{u_matrix:ke||Ae.transform.calculateProjMatrix(fe.tileID.toUnwrapped(),gt),u_image:0,u_latrange:xh(0,fe.tileID),u_light:[Ce.paint.get("hillshade-exaggeration"),Pt],u_shadow:He.toPremultipliedRenderColor($e?null:Ce.lut),u_highlight:it.toPremultipliedRenderColor(ct?null:Ce.lut),u_emissive_strength:tt,u_accent:Xe.toPremultipliedRenderColor(Ye?null:Ce.lut)}})(p,h,m,p.terrain?o.projMatrix:null);p.uploadCommonUniforms(F,Z,o.toUnwrapped());const{tileBoundsBuffer:ee,tileBoundsIndexBuffer:he,tileBoundsSegments:le}=p.getTileBoundsBuffers(h);Z.draw(p,D.TRIANGLES,w,E,S,xn.disabled,K,m.id,ee,he,le)}function Hf(p,o,h){if(!o.needsDEMTextureUpload)return;const m=p.context,w=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||p.getTileTexture(h.stride);const E=h.getPixels();o.demTexture?o.demTexture.update(E,{premultiply:!1}):o.demTexture=new a.T(m,E,w.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function PA(p,o,h){const m=p.context,w=m.gl;if(!o.dem)return;const E=o.dem;if(m.activeTexture.set(w.TEXTURE1),Hf(p,o,E),!o.demTexture)return;o.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);const S=E.dim;m.activeTexture.set(w.TEXTURE0);let F=o.hillshadeFBO;if(!F){const K=new a.T(m,{width:S,height:S,data:null},w.RGBA8);K.bind(w.LINEAR,w.CLAMP_TO_EDGE),F=o.hillshadeFBO=m.createFramebuffer(S,S,!0,"renderbuffer"),F.colorAttachment.set(K.texture)}m.bindFramebuffer.set(F.framebuffer),m.viewport.set([0,0,S,S]);const{tileBoundsBuffer:D,tileBoundsIndexBuffer:Q,tileBoundsSegments:V}=p.getMercatorTileBoundsBuffers(),Z=[];p.linearFloatFilteringSupported()&&Z.push("TERRAIN_DEM_FLOAT_FORMAT"),p.getOrCreateProgram("hillshadePrepare",{defines:Z}).draw(p,w.TRIANGLES,Rr.disabled,bn.disabled,Xn.unblended,xn.disabled,((K,ee)=>{const he=ee.stride,le=a.bz();return a.ca(le,0,a.aj,-a.aj,0,0,1),a.bo(le,le,[0,-a.aj,0]),{u_matrix:le,u_image:1,u_dimension:[he,he],u_zoom:K.overscaledZ}})(o.tileID,E),h.id,D,Q,V),o.needsHillshadePrepare=!1}class di{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Xd extends di{getDefault(){return a.am.transparent.toNonPremultipliedRenderColor(null)}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class LA extends di{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Vf extends di{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class hd extends di{getDefault(){return[!0,!0,!0,!0]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class MA extends di{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class fd extends di{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Gf extends di{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Kf extends di{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Rp extends di{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class kp extends di{getDefault(){return[0,1]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Zd extends di{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class Yd extends di{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class wh extends di{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class Zu extends di{getDefault(){const o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class gf extends di{getDefault(){return a.am.transparent.toNonPremultipliedRenderColor(null)}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class bh extends di{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class _f extends di{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class Jd extends di{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class ep extends di{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let Up=class extends di{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class OA extends di{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class tp extends di{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class DA extends di{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Pl extends di{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class lc extends di{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class dl extends di{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Yu extends di{getDefault(){return null}set(o){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Wf extends di{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class Ll extends di{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Js extends di{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Tm extends di{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Np extends di{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class vf extends Np{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class qf extends Np{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Gh extends Np{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,this.attachment(),h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class $f extends qf{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Ad=(p,o,h)=>({u_matrix:p,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:h}),Bu=(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:h,u_zoom_transition:w,u_merc_center:E,u_image0:0,u_frustum_tl:S,u_frustum_tr:F,u_frustum_br:D,u_frustum_bl:Q,u_globe_pos:V,u_globe_radius:Z,u_viewport:K,u_grid_matrix:le?Float32Array.from(le):new Float32Array(9),u_skirt_height:ee,u_far_z_cutoff:he});function ru(p,o){return p!=null&&o!=null&&!(!p.hasData()||!o.hasData())&&p.demTexture!=null&&o.demTexture!=null&&p.tileID.key!==o.tileID.key}const ka=new class{constructor(){this.operations={}}newMorphing(p,o,h,m,w){if(p in this.operations){const E=this.operations[p];E.to.tileID.key!==h.tileID.key&&(E.queued=h)}else this.operations[p]={startTime:m,phase:0,duration:w,from:o,to:h,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const o=this.operations[p];return{from:o.from,to:o.to,phase:o.phase}}update(p){for(const o in this.operations){const h=this.operations[o];for(h.phase=(p-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,p)){delete this.operations[o];break}}}_nextOp(p,o){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=o,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},po={0:null,1:"TERRAIN_VERTEX_MORPHING"};function nu(p,o,h){if(o===0)return 0;const m=o<1&&h===514?.25/o:1;return 6*Math.pow(1.5,22-p)*Math.max(o,1)*m}function Is(p,o){const h=1<<p.z;return!o&&(p.x===0||p.x===h-1)||p.y===0||p.y===h-1}const Ml=p=>({u_matrix:p});function Fs(p,o,h,m,w){if(w>0){const E=a.q.now(),S=(E-p.timeAdded)/w,F=o?(E-o.timeAdded)/w:-1,D=h.getSource(),Q=m.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),V=!o||Math.abs(o.tileID.overscaledZ-Q)>Math.abs(p.tileID.overscaledZ-Q),Z=V&&p.refreshedUponExpiration?1:a.ay(V?S:1-F,0,1);return p.refreshedUponExpiration&&S>=1&&(p.refreshedUponExpiration=!1),o?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}class yf extends zo{constructor(o){const h=Hu("mock-dem",{type:"raster-dem",maxzoom:o.transform.maxZoom},o.style.dispatcher,o.style);super("mock-dem",h,!1),h.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,h){o.state="loaded",h(null)}}class Ol extends zo{constructor(o){const h=Hu("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},o.style.dispatcher,o.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,h,m){if(o.freezeTileCoverage)return;this.transform=o;const w=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,S)=>{if(E[S.key]="",!this._tiles[S.key]){const F=new Ah(S,this._source.tileSize*S.overscaleFactor(),o.tileZoom,void 0,void 0,this._source.worldview);F.state="loaded",this._tiles[S.key]=F}return E},{});for(const E in this._tiles)E in w||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(o){const h=this.proxyCachedFBO[o];if(h!==void 0){const m=Object.values(h);this.renderCachePool.push(...m),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class xf extends a.aM{constructor(o,h,m){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=h,this.projMatrix=m}}class dd extends a.dF{constructor(o,h){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,w,E]=function(D){const Q=new a.ba,V=new a.a_,Z=131;Q.reserve(17161),V.reserve(33800);const K=a.aj/128,ee=a.aj+K/2,he=ee+K;for(let Ae=-K;Ae<he;Ae+=K)for(let fe=-K;fe<he;fe+=K){const Ce=fe<0||fe>ee||Ae<0||Ae>ee?24575:0,ke=a.ay(Math.round(fe),0,a.aj),He=a.ay(Math.round(Ae),0,a.aj);Q.emplaceBack(ke+Ce,He)}const le=(Ae,fe)=>{const Ce=fe*Z+Ae;V.emplaceBack(Ce+1,Ce,Ce+Z),V.emplaceBack(Ce+Z,Ce+Z+1,Ce+1)};for(let Ae=1;Ae<129;Ae++)for(let fe=1;fe<129;fe++)le(fe,Ae);return[0,129].forEach(Ae=>{for(let fe=0;fe<130;fe++)le(fe,Ae),le(Ae,fe)}),[Q,V,32768]}(),S=o.context;this.gridBuffer=S.createVertexBuffer(m,a.bc.members),this.gridIndexBuffer=S.createIndexBuffer(w),this.gridSegments=a.bd.simpleSegment(0,0,m.length,w.length),this.gridNoSkirtSegments=a.bd.simpleSegment(0,0,m.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ol(h.map),this.orthoMatrix=a.bz(),a.ca(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.aj,0,a.aj,0,1);const F=S.gl;this._overlapStencilMode=new bn({func:F.GEQUAL,mask:255},0,255,F.KEEP,F.KEEP,F.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new yf(h.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,h,m){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);const w=o.terrain.properties,E=o.terrain.drapeRenderMode===0,S=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.q.now();const F=o.terrain&&o.terrain.scope,D=w.get("source"),Q=E?this._mockSourceCache:o.getSourceCache(D,F);if(!Q)return void a.w(`Couldn't find terrain source "${D}".`);if(this.sourceCache=Q,this._attenuationRange=o.terrain.getAttenuationRange(),this._exaggeration=S?this.calculateExaggeration(h):w.get("exaggeration"),!h.projection.requiresDraping&&S&&this._exaggeration===0)return void this._disable();this.enabled=!0;const V=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Z=this.getScaledDemTileSize();this.sourceCache.update(h,Z,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,V(),this._initializing=!0),V(),h.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0,this._previousZoom=h.zoom}else this._disable()}calculateExaggeration(o){if(this._attenuationRange&&o.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(o.zoom);const h=this._previousCameraAltitude,m=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=m;const w=h!=null?m-h:Number.MAX_VALUE;if(Math.abs(w)<2)return this._exaggeration;const E=o.zoom,S=this._style.terrain;if(!this._previousUpdateTimestamp)return S.getExaggeration(E);let F=E-this._previousZoom;const D=this._previousUpdateTimestamp;let Q=E;this._evaluationZoom!=null&&(Q=this._evaluationZoom,Math.abs(E-Q)>.5&&(F=.5*(E-Q+F)),F*w<0&&(Q+=F)),this._evaluationZoom=Q;const V=S.getExaggeration(Q),Z=V===S.getExaggeration(Math.max(0,Q-.1));if(Z&&Math.abs(V-this._exaggeration)<.01)return V;let K=Math.min(.1,.00375*(this._updateTimestamp-D));return(Z||V<.1||Math.abs(F)<1e-4)&&(K=Math.min(.2,4*K)),a.ai(this._exaggeration,V,K)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(a.ac.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=h.getIds().map(D=>{const Q=h.getTileByID(D).tileID;return Q.projMatrix=m.calculateProjMatrix(Q.toUnwrapped()),Q});(function(D,Q){const V=Q.transform.pointCoordinate(Q.transform.getCameraPoint()),Z=new a.P(V.x,V.y);D.sort((K,ee)=>{if(ee.overscaledZ-K.overscaledZ)return ee.overscaledZ-K.overscaledZ;const he=new a.P(K.canonical.x+(1<<K.canonical.z)*K.wrap,K.canonical.y),le=new a.P(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),Ae=Z.mult(1<<K.canonical.z);return Ae.x-=.5,Ae.y-=.5,Ae.distSqr(he)-Ae.distSqr(le)})})(w,this.painter);const E=this.proxyToSource||{};this.proxyToSource={},w.forEach(D=>{this.proxyToSource[D.key]={}}),this.terrainTileForTile={};const S=this._style._mergedSourceCaches;for(const D in S){const Q=S[D];if(!Q.used||(Q!==this.sourceCache&&this.resetTileLookupCache(Q.id),this._setupProxiedCoordsForOrtho(Q,o[D],E),Q.usedForTerrain))continue;const V=o[D];Q.getSource().reparseOverscaled&&this._assignTerrainTiles(V)}this.proxiedCoords[h.id]=w.map(D=>new xf(D,D.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1;const F={};this._visibleDemTiles=[];for(const D of this.proxyCoords){const Q=this.terrainTileForTile[D.key];if(!Q)continue;const V=Q.tileID.key;V in F||(this._visibleDemTiles.push(Q),F[V]=V)}}_assignTerrainTiles(o){this._initializing||o.forEach(h=>{if(this.terrainTileForTile[h.key])return;const m=this._findTileCoveringTileID(h,this.sourceCache);m&&(this.terrainTileForTile[h.key]=m)})}_prepareDEMTextures(){const o=this.painter.context,h=o.gl;for(const m in this.terrainTileForTile){const w=this.terrainTileForTile[m],E=w.dem;!E||w.demTexture&&!w.needsDEMTextureUpload||(o.activeTexture.set(h.TEXTURE1),Hf(this.painter,w,E))}}_prepareDemTileUniforms(o,h,m,w){if(!h||h.demTexture==null)return!1;const E=o.tileID.canonical,S=Math.pow(2,h.tileID.canonical.z-E.z),F=w||"";return m[`u_dem_tl${F}`]=[E.x*S%1,E.y*S%1],m[`u_dem_scale${F}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let o=0;const h=this._visibleDemTiles.reduce((m,w)=>{if(!w.dem)return m;const E=w.dem.tree.minimums[0];return E>0&&o++,m+E},0);return o?h/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,h=o.gl;o.activeTexture.set(h.TEXTURE2);const m=this._getLoadedAreaMinimum(),w=new a.dG({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(w,{premultiply:!1}):E=this._emptyDEMTexture=new a.T(o,w,h.R32F,{premultiply:!1}),E}setupElevationDraw(o,h,m){const w=this.painter.context,E=w.gl,S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};S.u_exaggeration=this.exaggeration();let F=null,D=null,Q=1;if(m&&m.morphing&&this._useVertexMorphing){const ee=m.morphing.srcDemTile,he=m.morphing.dstDemTile;Q=m.morphing.phase,ee&&he&&(this._prepareDemTileUniforms(o,ee,S,"_prev")&&(D=ee),this._prepareDemTileUniforms(o,he,S)&&(F=he))}const V=ee=>ee&&ee.demTexture&&this.painter.linearFloatFilteringSupported()?E.LINEAR:E.NEAREST;let Z=null;var K;if(this.enabled?D&&F?(Z=F.demTexture,w.activeTexture.set(E.TEXTURE4),D.demTexture.bind(V(D),E.CLAMP_TO_EDGE),S.u_dem_lerp=Q):(F=this.terrainTileForTile[o.tileID.key],Z=this._prepareDemTileUniforms(o,F,S)?F.demTexture:this.emptyDEMTexture):Z=this.emptyDEMTexture,w.activeTexture.set(E.TEXTURE2),Z&&(S.u_dem_size=(K=Z).size[0]===1?1:K.size[0]-2,Z.bind(V(F),E.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,h,S),m&&m.useMeterToDem&&F){const ee=(1<<F.tileID.canonical.z)*a.cb(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=ee}if(m&&m.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),h.setTerrainUniformValues(w,S),this.painter.transform.projection.name==="globe"){const ee=this.globeUniformValues(this.painter.transform,o.tileID.canonical,m&&m.useDenormalizedUpVectorScale);h.setGlobeUniformValues(w,ee)}}globeUniformValues(o,h,m){const w=o.projection;return{u_tile_tl_up:w.upVector(h,0,0),u_tile_tr_up:w.upVector(h,a.aj,0),u_tile_br_up:w.upVector(h,a.aj,a.aj),u_tile_bl_up:w.upVector(h,0,a.aj),u_tile_up_scale:m?a.dH(1):w.upVectorScale(h,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const h=this.painter,m=this.painter.context;o.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,E,S,F,D){if(w.transform.projection.name==="globe")(function(Q,V,Z,K,ee){const he=Q.context,le=he.gl;let Ae,fe;const Ce=Q.transform,ke=a.dy(Q,he,Ce),He=(Jt,kt)=>{if(fe===kt)return;const or=[po[kt],"PROJECTION_GLOBE_VIEW"];ke&&or.push("CUSTOM_ANTIALIASING");const pr=Q.isTileAffectedByFog(Jt);Ae=Q.getOrCreateProgram("globeRaster",{defines:or,overrideFog:pr}),fe=kt},$e=Q.colorModeForRenderPass(),it=new Rr(le.LEQUAL,Rr.ReadWrite,Q.depthRangeFor3D);ka.update(ee);const ct=a.dz(Ce),Xe=[a.aD(Ce.center.lng),a.aH(Ce.center.lat)],Ye=Q.globeSharedBuffers,tt=[Ce.width*a.q.devicePixelRatio,Ce.height*a.q.devicePixelRatio],Pt=Float32Array.from(Ce.globeMatrix),gt={useDenormalizedUpVectorScale:!0};{const Jt=Q.transform,kt=nu(Jt.zoom,V.exaggeration(),V.sourceCache._source.tileSize);fe=-1;const or=le.TRIANGLES;for(const pr of K){const It=Z.getTile(pr),ht=bn.disabled,zt=V.prevTerrainTileForTile[pr.key],Ot=V.terrainTileForTile[pr.key];ru(zt,Ot)&&ka.newMorphing(pr.key,zt,Ot,ee,250),he.activeTexture.set(le.TEXTURE0),It.texture&&It.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);const fr=ka.getMorphValuesForProxy(pr.key),Ar=fr?1:0;fr&&a.L(gt,{morphing:{srcDemTile:fr.from,dstDemTile:fr.to,phase:a.dx(fr.phase)}});const yr=a.dA(pr.canonical),Br=a.dB(yr.getCenter().lat),ln=a.dC(pr.canonical,yr,Br,Jt.worldSize/Jt._pixelsPerMercatorPixel),dn=a.bh(a.dD(pr.canonical)),Wr=Bu(Jt.expandedFarZProjMatrix,Pt,ct,dn,a.ah(Jt.zoom),Xe,Jt.frustumCorners.TL,Jt.frustumCorners.TR,Jt.frustumCorners.BR,Jt.frustumCorners.BL,Jt.globeCenterInViewSpace,Jt.globeRadius,tt,kt,Jt._farZ,ln);if(He(pr,Ar),Ae&&(V.setupElevationDraw(It,Ae,gt),Q.uploadCommonUniforms(he,Ae,pr.toUnwrapped()),Ye)){const[An,cn,Ln]=Ye.getGridBuffers(Br,kt!==0);Ae.draw(Q,or,it,ht,$e,xn.backCCW,Wr,"globe_raster",An,cn,Ln)}}}if(Ye&&(Q.renderDefaultNorthPole||Q.renderDefaultSouthPole)){const Jt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ke&&Jt.push("CUSTOM_ANTIALIASING"),Ae=Q.getOrCreateProgram("globeRaster",{defines:Jt});for(const kt of K){const{x:or,y:pr,z:It}=kt.canonical,ht=pr===0,zt=pr===(1<<It)-1,[Ot,fr,Ar,yr]=Ye.getPoleBuffers(It,!1);if(yr&&(ht||zt)){const Br=Z.getTile(kt);he.activeTexture.set(le.TEXTURE0),Br.texture&&Br.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);let ln=a.dE(It,or,Ce);const dn=a.bh(a.dD(kt.canonical)),Wr=(An,cn)=>An.draw(Q,le.TRIANGLES,it,bn.disabled,$e,xn.disabled,Bu(Ce.expandedFarZProjMatrix,ln,ln,dn,0,Xe,Ce.frustumCorners.TL,Ce.frustumCorners.TR,Ce.frustumCorners.BR,Ce.frustumCorners.BL,Ce.globeCenterInViewSpace,Ce.globeRadius,tt,0,Ce._farZ),"globe_pole_raster",cn,Ar,yr);V.setupElevationDraw(Br,Ae,gt),Q.uploadCommonUniforms(he,Ae,kt.toUnwrapped()),ht&&Q.renderDefaultNorthPole&&Wr(Ae,Ot),zt&&Q.renderDefaultSouthPole&&(ln=a.cP(a.bz(),ln,[1,-1,1]),Wr(Ae,fr))}}}})(w,E,S,F,D);else{const Q=w.context,V=Q.gl;let Z,K;const ee=w.shadowRenderer,he=ls(w,w.longestCutoffRange),le=$e=>{if(K===$e)return;const it=[];it.push(po[$e]),he.shouldRenderCutoff&&it.push("RENDER_CUTOFF"),ee&&(it.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ee.useNormalOffset&&it.push("NORMAL_OFFSET")),Z=w.getOrCreateProgram("terrainRaster",{defines:it}),K=$e},Ae=w.colorModeForRenderPass(),fe=new Rr(V.LEQUAL,Rr.ReadWrite,w.depthRangeFor3D);ka.update(D);const Ce=w.transform,ke=nu(Ce.zoom,E.exaggeration(),E.sourceCache._source.tileSize);let He=[0,0,0];if(ee){const $e=w.style.directionalLight,it=w.style.ambientLight;$e&&it&&(He=oc(w.style,$e,it))}{K=-1;const $e=V.TRIANGLES,[it,ct]=[E.gridIndexBuffer,E.gridSegments];for(const Xe of F){const Ye=S.getTile(Xe),tt=bn.disabled,Pt=E.prevTerrainTileForTile[Xe.key],gt=E.terrainTileForTile[Xe.key];ru(Pt,gt)&&ka.newMorphing(Xe.key,Pt,gt,D,250),Q.activeTexture.set(V.TEXTURE0),Ye.texture&&Ye.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const Jt=ka.getMorphValuesForProxy(Xe.key),kt=Jt?1:0;let or;Jt&&(or={morphing:{srcDemTile:Jt.from,dstDemTile:Jt.to,phase:a.dx(Jt.phase)}});const pr=Ad(Xe.projMatrix,Is(Xe.canonical,Ce.renderWorldCopies)?ke/10:ke,He);if(le(kt),!Z)continue;E.setupElevationDraw(Ye,Z,or);const It=Xe.toUnwrapped();ee&&ee.setupShadows(It,Z),w.uploadCommonUniforms(Q,Z,It,null,he),Z.draw(w,$e,fe,tt,Ae,xn.backCCW,pr,"terrain_raster",E.gridBuffer,it,ct)}}}}(h,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const h=this.painter,m=this.painter.context,w=this.proxySourceCache,E=this.proxiedCoords[w.id],S=this._drapedRenderBatches.shift(),F=h.style.order,D=[];let Q=0;for(const V of E){const Z=w.getTileByID(V.proxyTileKey),K=w.proxyCachedFBO[V.key]?w.proxyCachedFBO[V.key][o]:void 0,ee=K!==void 0?w.renderCache[K]:this.pool[Q++],he=K!==void 0;if(Z.texture=ee.tex,he&&!ee.dirty){D.push(Z.tileID);continue}let le;m.bindFramebuffer.set(ee.fb.framebuffer),this.renderedToTile=!1,ee.dirty&&(m.clear({color:a.am.transparent,stencil:0}),ee.dirty=!1);for(let Ae=S.start;Ae<=S.end;++Ae){const fe=h.style._mergedLayers[F[Ae]];if(fe.isHidden(h.transform.zoom))continue;const Ce=h.style.getLayerSourceCache(fe),ke=Ce?this.proxyToSource[V.key][Ce.id]:[V];if(!ke)continue;const He=ke;m.viewport.set([0,0,ee.fb.width,ee.fb.height]),le!==(Ce?Ce.id:null)&&(this._setupStencil(ee,ke,fe,Ce),le=Ce?Ce.id:null),h.renderLayer(h,Ce,fe,He)}if(this._drapedRenderBatches.length===0)for(const Ae of this._pendingGroundEffectLayers){const fe=h.style._mergedLayers[F[Ae]];if(fe.isHidden(h.transform.zoom))continue;const Ce=h.style.getLayerSourceCache(fe),ke=Ce?this.proxyToSource[V.key][Ce.id]:[V];if(!ke)continue;const He=ke;m.viewport.set([0,0,ee.fb.width,ee.fb.height]),le!==(Ce?Ce.id:null)&&(this._setupStencil(ee,ke,fe,Ce),le=Ce?Ce.id:null),h.renderLayer(h,Ce,fe,He)}this.renderedToTile?(ee.dirty=!0,D.push(Z.tileID)):he||--Q,Q===5&&(Q=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,h.width,h.height]),S.end+1}postRender(){}isLayerOrderingCorrect(o){const h=o.order.length;let m=-1,w=h;for(let E=0;E<h;++E)this._style.isLayerDraped(o._mergedLayers[o.order[E]])?m=Math.max(m,E):w=Math.min(w,E);return w>m}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{o=Math.min(o,h.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,h,m){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const S=E.tileID,F=1<<S.overscaledZ,{x:D,y:Q}=S.canonical,V=D/F,Z=(D+1)/F,K=Q/F,ee=(Q+1)/F;return{minx:V,miny:K,maxx:Z,maxy:ee,t:E.dem.tree.raycastRoot(V,K,Z,ee,o,h,m),tile:E}});w.sort((E,S)=>(E.t!==null?E.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(const E of w){if(E.t==null)return null;const S=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,o,h,m);if(S!=null)return S}return null}_createFBO(){const o=this.painter.context,h=o.gl,m=this.drapeBufferSize;o.activeTexture.set(h.TEXTURE0);const w=new a.T(o,{width:m[0],height:m[1],data:null},h.RGBA8);w.bind(h.LINEAR,h.CLAMP_TO_EDGE);const E=o.createFramebuffer(m[0],m[1],!0,null);return E.colorAttachment.set(w.texture),E.depthAttachment=new $f(o,E.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:E,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const h=this._style._mergedLayers[o],m=h.isHidden(this.painter.transform.zoom);return h.type==="hillshade"||h.type==="custom"?!m&&h.shouldRedrape():!m&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const m of this._style.getSources())if(m instanceof so){o=!0;break}if(!o)return;const h={};for(let m=0;m<this._style.order.length;++m){const w=this._style._mergedLayers[this._style.order[m]],E=this._style.getLayerSourceCache(w);if(E&&!h[E.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof a.ab){h[E.id]=!0;for(const S of this.proxyCoords){const F=this.proxyToSource[S.key][E.id];if(F)for(const D of F)this._clearRenderCacheForTile(E.id,D)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof Ss){o=!0;break}if(!o)return;const h={};for(let m=0;m<this._style.order.length;++m){const w=this._style._mergedLayers[this._style.order[m]],E=this._style.getLayerSourceCache(w);if(!E||h[E.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const S=w.paint.get("raster-fade-duration");for(const F of this.proxyCoords){const D=this.proxyToSource[F.key][E.id];if(D)for(const Q of D){const V=Fs(E.getTile(Q),E.findLoadedParent(Q,0),E,this.painter.transform,S);(V.opacity!==1||V.mix!==0)&&this._clearRenderCacheForTile(E.id,Q)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const o=this._style.order,h=o.length;if(h===0)return;const m=[];this._pendingGroundEffectLayers=[];let w,E=0,S=this._style._mergedLayers[o[E]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++E<h;)S=this._style._mergedLayers[o[E]];for(;E<h;++E){const F=this._style._mergedLayers[o[E]];F.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(F)?w===void 0&&(w=E):(F.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(E),w!==void 0&&(m.push({start:w,end:E-1}),w=void 0)))}if(w!==void 0&&m.push({start:w,end:E-1}),m.length!==0){const F=m[m.length-1];this._pendingGroundEffectLayers.every(D=>D>F.end)||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(o){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const S=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let F=0;F<S.length;++F){const D=Object.values(S[F]);h.renderCachePool.push(...D)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,w=this._tilesDirty;for(let S=m.length-1;S>=0;S--){const F=m[S];if(h.getTileByID(F.key),h.proxyCachedFBO[F.key]!==void 0){const D=o[F.key],Q=this.proxyToSource[F.key];let V=0;for(const Z in Q){const K=Q[Z],ee=D[Z];if(!ee||ee.length!==K.length||K.some((he,le)=>he!==ee[le]||w[Z]&&w[Z].hasOwnProperty(he.key))){V=-1;break}++V}for(const Z in h.proxyCachedFBO[F.key])h.renderCache[h.proxyCachedFBO[F.key][Z]].dirty=V<0||V!==Object.values(D).length}}const E=[...this._drapedRenderBatches];E.sort((S,F)=>F.end-F.start-(S.end-S.start));for(const S of E)for(const F of m){if(h.proxyCachedFBO[F.key])continue;let D=h.renderCachePool.pop();D===void 0&&h.renderCache.length<50&&(D=h.renderCache.length,h.renderCache.push(this._createFBO())),D!==void 0&&(h.proxyCachedFBO[F.key]={},h.proxyCachedFBO[F.key][S.start]=D,h.renderCache[D].dirty=!0)}this._tilesDirty={}}_setupStencil(o,h,m,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,S=E.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let F;if(m.isTileClipped())F=h.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);F=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+F>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=F,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):bn.disabled}_renderTileClippingMasks(o,h){const m=this.painter,w=this.painter.context,E=w.gl;m._tileClippingMaskIDs={},w.setColorMode(Xn.disabled),w.setDepthMode(Rr.disabled);const S=m.getOrCreateProgram("clippingMask");for(const F of o){const D=m._tileClippingMaskIDs[F.key]=--h;S.draw(m,E.TRIANGLES,Rr.disabled,new bn({func:E.ALWAYS,mask:0},D,255,E.KEEP,E.KEEP,E.REPLACE),Xn.disabled,xn.disabled,Ml(F.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(o){const h=this.painter.transform;if(o.x<0||o.x>h.width||o.y<0||o.y>h.height)return null;const m=[o.x,o.y,1,1];a.aA(m,m,h.pixelMatrixInverse),a.cH(m,m,1/m[3]),m[0]/=h.worldSize,m[1]/=h.worldSize;const w=h._camera.position,E=a.cb(1,h.center.lat),S=[w[0],w[1],w[2]/E,0],F=a.d7([],m.slice(0,3),S);a.au(F,F);const D=this.raycast(S,F,this._exaggeration);return D!==null&&D?(a.bE(S,S,F,D),S[3]=S[2],S[2]*=E,S):null}_setupProxiedCoordsForOrtho(o,h,m){if(o.getSource()instanceof a.aP)return this._setupProxiedCoordsForImageSource(o,h,m);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const w=this.proxiedCoords[o.id]=[],E=this.proxyCoords;for(let D=0;D<E.length;D++){const Q=E[D],V=this._findTileCoveringTileID(Q,o);if(V){const Z=this._createProxiedId(Q,V,m[Q.key]&&m[Q.key][o.id]);w.push(Z),this.proxyToSource[Q.key][o.id]=[Z]}}let S=!1;const F=new Set;for(let D=0;D<h.length;D++){const Q=o.getTile(h[D]);if(!Q||!Q.hasData())continue;const V=this._findTileCoveringTileID(Q.tileID,this.proxySourceCache);if(V&&V.tileID.canonical.z!==Q.tileID.canonical.z){const Z=this.proxyToSource[V.tileID.key][o.id],K=this._createProxiedId(V.tileID,Q,m[V.tileID.key]&&m[V.tileID.key][o.id]);Z?Z.splice(Z.length-1,0,K):this.proxyToSource[V.tileID.key][o.id]=[K];const ee=this.proxyToSource[V.tileID.key][o.id];F.has(ee)||F.add(ee),w.push(K),S=!0}}if(this._sourceTilesOverlap[o.id]=S,S&&this._debugParams.sortTilesHiZFirst)for(const D of F)D.sort((Q,V)=>V.overscaledZ-Q.overscaledZ)}_setupProxiedCoordsForImageSource(o,h,m){if(!o.getSource().loaded())return;const w=this.proxiedCoords[o.id]=[],E=this.proxyCoords,S=o.getSource(),F=S.tileID;if(!F)return;const D=new a.P(F.x,F.y)._div(1<<F.z),Q=S.coordinates.map(a.ac.fromLngLat).reduce((Z,K)=>(Z.min.x=Math.min(Z.min.x,K.x-D.x),Z.min.y=Math.min(Z.min.y,K.y-D.y),Z.max.x=Math.max(Z.max.x,K.x-D.x),Z.max.y=Math.max(Z.max.y,K.y-D.y),Z),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),V=(Z,K)=>{const ee=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),he=Z.canonical.y/(1<<Z.canonical.z),le=a.aj/(1<<Z.canonical.z),Ae=K.wrap+K.canonical.x/(1<<K.canonical.z),fe=K.canonical.y/(1<<K.canonical.z);return ee+le<Ae+Q.min.x||ee>Ae+Q.max.x||he+le<fe+Q.min.y||he>fe+Q.max.y};for(let Z=0;Z<E.length;Z++){const K=E[Z];for(let ee=0;ee<h.length;ee++){const he=o.getTile(h[ee]);if(!he||!he.hasData()||V(K,he.tileID))continue;const le=this._createProxiedId(K,he,m[K.key]&&m[K.key][o.id]),Ae=this.proxyToSource[K.key][o.id];Ae?Ae.push(le):this.proxyToSource[K.key][o.id]=[le],w.push(le)}}}_createProxiedId(o,h,m){let w=this.orthoMatrix;if(m){const E=m.find(S=>S.key===h.tileID.key);if(E)return E}if(h.tileID.key!==o.key){const E=o.canonical.z-h.tileID.canonical.z;let S,F,D;w=a.bz();const Q=h.tileID.wrap-o.wrap<<o.overscaledZ;E>0?(S=a.aj>>E,F=S*((h.tileID.canonical.x<<E)-o.canonical.x+Q),D=S*((h.tileID.canonical.y<<E)-o.canonical.y)):(S=a.aj<<-E,F=a.aj*(h.tileID.canonical.x-(o.canonical.x+Q<<-E)),D=a.aj*(h.tileID.canonical.y-(o.canonical.y<<-E))),a.ca(w,0,S,0,S,0,1),a.bo(w,w,[F,D,0])}return new xf(h.tileID,o.key,w)}_findTileCoveringTileID(o,h){let m=h.getTile(o);if(m&&m.hasData())return m;const w=this._findCoveringTileCache[h.id],E=w[o.key];if(m=E?h.getTileByID(E):null,m&&m.hasData()||E===null)return m;let S=m?m.tileID:o,F=S.overscaledZ;const D=h.getSource().minzoom,Q=[];if(!E){const Z=h.getSource().maxzoom;if(o.canonical.z>=Z){const K=o.canonical.z-Z;h.getSource().reparseOverscaled?(F=Math.max(o.canonical.z+2,h.transform.tileZoom),S=new a.aM(F,o.wrap,Z,o.canonical.x>>K,o.canonical.y>>K)):K!==0&&(F=Z,S=new a.aM(F,o.wrap,Z,o.canonical.x>>K,o.canonical.y>>K))}S.key!==o.key&&(Q.push(S.key),m=h.getTile(S))}const V=Z=>{Q.forEach(K=>{w[K]=Z}),Q.length=0};for(F-=1;F>=D&&(!m||!m.hasData());F--){m&&V(m.tileID.key);const Z=S.calculateScaledKey(F);if(m=h.getTileByID(Z),m&&m.hasData())break;const K=w[Z];if(K===null)break;K===void 0?Q.push(Z):m=h.getTileByID(K)}return V(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,h){let m=this._tilesDirty[o];m||(m=this._tilesDirty[o]={}),m[h.key]=!0}}function pd(p,o,h){const m=function(F,D,Q){const V=a.bG(D,F),Z=a.bG(Q,[.2126,.7152,.0722]),K=(he,le,Ae)=>(1-Ae)*he+Ae*le,ee=K(1-.3*Math.min(Z,1),1,Math.min(V+1,1));return K(.92,1,Math.asin(a.ay(D[2],-1,1))/Math.PI+.5)*ee}(p,[0,0,1],o),w=[0,0,0];a.c1(w,h.slice(0,3),m);const E=[0,0,0];a.c1(E,o.slice(0,3),p[2]);const S=[0,0,0];return a.d5(S,w,E),a.d8(S)}const Kh=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],md=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class Cu{static cacheKey(o,h,m,w){let E=`${h}${w?w.cacheKey:""}`;for(const S of m)o.usedDefines.includes(S)&&(E+=`/${S}`);return E}constructor(o,h,m,w,E,S){const F=o.gl;this.program=F.createProgram(),this.configuration=w,this.name=h,this.fixedDefines=[...S];const D=w?w.getBinderAttributes():[],Q=(m.staticAttributes||[]).concat(D);let V=w?w.defines():[];V=V.concat(S.map(Ae=>`#define ${Ae}`));const Z=`#version 300 es
`;let K=Z+V.concat("precision mediump float;",Fl,FA.fragmentSource).join(`
`);for(const Ae of m.fragmentIncludes)K+=`
${Vh[Ae]}`;K+=`
${m.fragmentSource}`;let ee=Z+V.concat("precision highp float;",Fl,FA.vertexSource).join(`
`);for(const Ae of m.vertexIncludes)ee+=`
${Vh[Ae]}`;this.forceManualRenderingForInstanceIDShaders=o.forceManualRenderingForInstanceIDShaders&&m.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(ee+=`
uniform int u_instanceID;
`),ee+=`
${m.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(ee=ee.replaceAll("gl_InstanceID","u_instanceID"));const he=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);F.shaderSource(he,K),F.compileShader(he),F.attachShader(this.program,he);const le=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(le,ee),F.compileShader(le),F.attachShader(this.program,le),this.attributes={},this.numAttributes=Q.length;for(let Ae=0;Ae<this.numAttributes;Ae++)if(Q[Ae]){const fe=Q[Ae].startsWith("a_")?Q[Ae]:`a_${Q[Ae]}`;F.bindAttribLocation(this.program,Ae,fe),this.attributes[fe]=Ae}F.linkProgram(this.program),F.deleteShader(le),F.deleteShader(he),this.fixedUniforms=E(o),this.binderUniforms=w?w.getUniforms(o):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(Ae=>({u_instanceID:new a.cd(Ae)}))(o)),(S.includes("TERRAIN")||h.indexOf("symbol")!==-1||h.indexOf("circle")!==-1)&&(this.terrainUniforms=(Ae=>({u_dem:new a.cd(Ae),u_dem_prev:new a.cd(Ae),u_dem_tl:new a.cg(Ae),u_dem_scale:new a.cf(Ae),u_dem_tl_prev:new a.cg(Ae),u_dem_scale_prev:new a.cf(Ae),u_dem_size:new a.cf(Ae),u_dem_lerp:new a.cf(Ae),u_exaggeration:new a.cf(Ae),u_depth:new a.cd(Ae),u_depth_size_inv:new a.cg(Ae),u_depth_range_unpack:new a.cg(Ae),u_occluder_half_size:new a.cf(Ae),u_occlusion_depth_offset:new a.cf(Ae),u_meter_to_dem:new a.cf(Ae),u_label_plane_matrix_inv:new a.ch(Ae)}))(o)),S.includes("GLOBE")&&(this.globeUniforms=(Ae=>({u_tile_tl_up:new a.ce(Ae),u_tile_tr_up:new a.ce(Ae),u_tile_br_up:new a.ce(Ae),u_tile_bl_up:new a.ce(Ae),u_tile_up_scale:new a.cf(Ae)}))(o)),S.includes("FOG")&&(this.fogUniforms=(Ae=>({u_fog_matrix:new a.ch(Ae),u_fog_range:new a.cg(Ae),u_fog_color:new a.d0(Ae),u_fog_horizon_blend:new a.cf(Ae),u_fog_vertical_limit:new a.cg(Ae),u_fog_temporal_offset:new a.cf(Ae),u_frustum_tl:new a.ce(Ae),u_frustum_tr:new a.ce(Ae),u_frustum_br:new a.ce(Ae),u_frustum_bl:new a.ce(Ae),u_globe_pos:new a.ce(Ae),u_globe_radius:new a.cf(Ae),u_globe_transition:new a.cf(Ae),u_is_globe:new a.cd(Ae),u_viewport:new a.cg(Ae)}))(o)),S.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Ae=>({u_cutoff_params:new a.d0(Ae)}))(o)),S.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Ae=>({u_lighting_ambient_color:new a.ce(Ae),u_lighting_directional_dir:new a.ce(Ae),u_lighting_directional_color:new a.ce(Ae),u_ground_radiance:new a.ce(Ae)}))(o)),S.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Ae=>({u_light_matrix_0:new a.ch(Ae),u_light_matrix_1:new a.ch(Ae),u_fade_range:new a.cg(Ae),u_shadow_normal_offset:new a.ce(Ae),u_shadow_intensity:new a.cf(Ae),u_shadow_texel_size:new a.cf(Ae),u_shadow_map_resolution:new a.cf(Ae),u_shadow_direction:new a.ce(Ae),u_shadow_bias:new a.ce(Ae),u_shadowmap_0:new a.cd(Ae),u_shadowmap_1:new a.cd(Ae)}))(o))}}setTerrainUniformValues(o,h){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in h)m[w]&&m[w].set(this.program,w,h[w])}}setGlobeUniformValues(o,h){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in h)m[w]&&m[w].set(this.program,w,h[w])}}setFogUniformValues(o,h){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in h)m[w].set(this.program,w,h[w])}}setCutoffUniformValues(o,h){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in h)m[w].set(this.program,w,h[w])}}setLightsUniformValues(o,h){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in h)m[w].set(this.program,w,h[w])}}setShadowUniformValues(o,h){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;o.program.set(this.program);for(const w in h)m[w].set(this.program,w,h[w])}_drawDebugWireframe(o,h,m,w,E,S,F,D,Q,V){const Z=o.options.wireframe;if(Z.terrain===!1&&Z.layers2D===!1&&Z.layers3D===!1)return;const K=o.context;if(!(!(!Z.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Z.layers2D||o._terrain&&o._terrain.renderingToTexture||!Kh.includes(this.name))||!(!Z.layers3D||!md.includes(this.name))))return;const ee=K.gl,he=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,E,K);if(!he)return;const le=[...this.fixedDefines];le.push("DEBUG_WIREFRAME");const Ae=o.getOrCreateProgram(this.name,{config:this.configuration,defines:le});K.program.set(Ae.program);const fe=(He,$e,it)=>{if($e[He]&&it[He])for(const ct in $e[He])it[He][ct]&&it[He][ct].set(it.program,ct,$e[He][ct].current)};Q&&Q.setUniforms(Ae.program,K,Ae.binderUniforms,F,{zoom:D}),fe("fixedUniforms",this,Ae),fe("terrainUniforms",this,Ae),fe("globeUniforms",this,Ae),fe("fogUniforms",this,Ae),fe("lightsUniforms",this,Ae),fe("shadowUniforms",this,Ae),he.bind(),K.setColorMode(new Xn([ee.ONE,ee.ONE_MINUS_SRC_ALPHA,ee.ZERO,ee.ONE],a.am.transparent,[!0,!0,!0,!1])),K.setDepthMode(new Rr(h.func===ee.LESS?ee.LEQUAL:h.func,Rr.ReadOnly,h.range)),K.setStencilMode(bn.disabled);const Ce=3*S.primitiveLength*2,ke=3*S.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const He=V||1;for(let $e=0;$e<He;++$e)Ae.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",$e),ee.drawElements(ee.LINES,Ce,ee.UNSIGNED_SHORT,ke)}else V&&V>1?ee.drawElementsInstanced(ee.LINES,Ce,ee.UNSIGNED_SHORT,ke,V):ee.drawElements(ee.LINES,Ce,ee.UNSIGNED_SHORT,ke);E.bind(),K.program.set(this.program),K.setDepthMode(h),K.setStencilMode(m),K.setColorMode(w)}checkUniforms(o,h,m){if(this.fixedDefines.includes(h)){for(const w of Object.keys(m))if(!m[w].initialized)throw new Error(`Program '${this.name}', from draw '${o}': uniform ${w} not set but required by ${h} being defined`)}}draw(o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae){const fe=o.context,Ce=fe.gl;if(this.failedToCreate)return;fe.program.set(this.program),fe.setDepthMode(m),fe.setStencilMode(w),fe.setColorMode(E),fe.setCullFace(S);for(const $e of Object.keys(this.fixedUniforms))this.fixedUniforms[$e].set(this.program,$e,F[$e]);he&&he.setUniforms(this.program,fe,this.binderUniforms,K,{zoom:ee});const ke={[Ce.POINTS]:1,[Ce.LINES]:2,[Ce.TRIANGLES]:3,[Ce.LINE_STRIP]:1}[h];this.checkUniforms(D,"RENDER_SHADOWS",this.shadowUniforms);const He=Ae&&Ae>0?1:void 0;for(const $e of Z.get()){const it=$e.vaos||($e.vaos={});if((it[D]||(it[D]=new $d)).bind(fe,this,Q,he?he.getPaintVertexBuffers():[],V,$e.vertexOffset,le||[],He),this.forceManualRenderingForInstanceIDShaders){const ct=Ae||1;for(let Xe=0;Xe<ct;++Xe)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Xe),V?Ce.drawElements(h,$e.primitiveLength*ke,Ce.UNSIGNED_SHORT,$e.primitiveOffset*ke*2):Ce.drawArrays(h,$e.vertexOffset,$e.vertexLength)}else Ae&&Ae>1?Ce.drawElementsInstanced(h,$e.primitiveLength*ke,Ce.UNSIGNED_SHORT,$e.primitiveOffset*ke*2,Ae):V?Ce.drawElements(h,$e.primitiveLength*ke,Ce.UNSIGNED_SHORT,$e.primitiveOffset*ke*2):Ce.drawArrays(h,$e.vertexOffset,$e.vertexLength);h===Ce.TRIANGLES&&V&&this._drawDebugWireframe(o,m,w,E,V,$e,K,ee,he,Ae)}}}function wf(p,o,h=0){const m=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,p.transform.tileZoom)/m,E=w*(o.tileID.canonical.x+o.tileID.wrap*m),S=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.aw(o,1,p.transform.tileZoom),u_pixel_coord_upper:[E>>16,S>>16],u_pixel_coord_lower:[65535&E,65535&S],u_pattern_transition:h}}const z={terrain:0,flat:1},W=a.bz(),ce=(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae,fe)=>{const Ce=o.style.light,ke=Ce.properties.get("position"),He=[ke.x,ke.y,ke.z],$e=a.dJ();Ce.properties.get("anchor")==="viewport"&&(a.dK($e,-o.transform.angle),a.dL(He,He,$e));const it=Ce.properties.get("color").toPremultipliedRenderColor(null),ct=o.transform,Xe={u_matrix:p,u_lightpos:He,u_lightintensity:Ce.properties.get("intensity"),u_lightcolor:[it.r,it.g,it.b],u_vertical_gradient:+h,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:W,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:z[Q],u_base_type:z[V],u_ao:w,u_edge_radius:E,u_width_scale:S,u_flood_light_color:he,u_vertical_scale:le,u_flood_light_intensity:Ae,u_ground_shadow_factor:fe};return ct.projection.name==="globe"&&(Xe.u_tile_id=[F.canonical.x,F.canonical.y,1<<F.canonical.z],Xe.u_zoom_transition=Z,Xe.u_inv_rot_matrix=ee,Xe.u_merc_center=K,Xe.u_up_dir=ct.projection.upVector(new a.cA(0,0,0),K[0]*a.aj,K[1]*a.aj),Xe.u_height_lift=D),Xe},ve=(p,o,h,m,w,E)=>({u_matrix:p,u_edge_radius:o,u_width_scale:h,u_vertical_scale:m,u_height_type:z[w],u_base_type:z[E]}),Qe=(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae,fe)=>{const Ce=ce(p,o,h,m,w,E,S,F,Q,V,Z,K,ee,he,le,Ae,1,[0,0,0]),ke={u_height_factor:-Math.pow(2,F.overscaledZ)/D.tileSize/8};return a.h(Ce,wf(o,D,fe),ke)},qe=(p,o,h)=>({u_matrix:p,u_emissive_strength:o,u_ground_shadow_factor:h}),Je=(p,o,h,m,w,E=0)=>a.h(qe(p,o,w),wf(h,m,E)),ut=(p,o,h,m)=>({u_matrix:p,u_world:h,u_emissive_strength:o,u_ground_shadow_factor:m}),dt=(p,o,h,m,w,E,S=0)=>a.h(Je(p,o,h,m,E,S),{u_world:w}),vt=(p,o)=>({u_matrix:p,u_ground_shadow_factor:o}),Wt=(p,o,h,m,w)=>({u_matrix:p,u_camera_pos:[o[0],o[1],o[2]],u_depth_bias:h,u_height_scale:m,u_reset_depth:w}),dr=(p,o)=>({u_matrix:p,u_normal_matrix:o,u_opacity:1}),yt=p=>({u_matrix:p}),rr=p=>({u_matrix:p}),lr=(p,o,h,m,w,E,S,F)=>{const D=a.aj/E.tileSize;return{u_matrix:p,u_inv_rot_matrix:o,u_camera_to_center_distance:h.getCameraToCenterDistance(F),u_extrude_scale:[h.pixelsToGLUnits[0]/D,h.pixelsToGLUnits[1]/D],u_zoom_transition:m,u_tile_id:S,u_merc_center:w}},Qr=(p,o,h=1)=>({u_matrix:p,u_color:o,u_overlay:0,u_overlay_scale:h}),gr=a.bz(),Ur=(p,o,h,m,w,E,S)=>{const F=p.transform,D=F.projection.name==="globe",Q=D?a.dM(F.zoom,o.canonical)*F._pixelsPerMercatorPixel:a.aw(h,1,E),V={u_matrix:o.projMatrix,u_extrude_scale:Q,u_intensity:S,u_inv_rot_matrix:gr,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){V.u_inv_rot_matrix=m,V.u_merc_center=w,V.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],V.u_zoom_transition=a.ah(F.zoom);const Z=w[0]*a.aj,K=w[1]*a.aj;V.u_up_dir=F.projection.upVector(new a.cA(0,0,0),Z,K)}return V};function zr(p,[o,h,m,w],[E,S]){if(E===S)return[0,0,0,0];const F=255*(p-1)/(p*(S-E));return[o*F,h*F,m*F,w*F]}function Gr(p,o,[h,m]){return h===m?0:.5/p+(o-h)*(p-1)/(p*(m-h))}const rn=(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae,fe,Ce,ke,He)=>({u_matrix:p,u_normalize_matrix:o,u_globe_matrix:h,u_merc_matrix:m,u_grid_matrix:w,u_tl_parent:E,u_scale_parent:Q,u_fade_t:V.mix,u_opacity:V.opacity*Z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Z.paint.get("raster-brightness-min"),u_brightness_high:Z.paint.get("raster-brightness-max"),u_saturation_factor:a.dO(Z.paint.get("raster-saturation")),u_contrast_factor:a.dN(Z.paint.get("raster-contrast")),u_spin_weights:ni(Z.paint.get("raster-hue-rotate")),u_perspective_transform:K,u_raster_elevation:ee,u_zoom_transition:S,u_merc_center:F,u_cutoff_params:D,u_colorization_mix:zr(a.dP,le,fe),u_colorization_offset:Gr(a.dP,Ae,fe),u_color_ramp:he,u_texture_offset:[ke/(Ce+2*ke),Ce/(Ce+2*ke)],u_texture_res:[Ce+2*ke,Ce+2*ke],u_emissive_strength:He});function ni(p){p*=Math.PI/180;const o=Math.sin(p),h=Math.cos(p);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}const Qn=.05,ra=(p,o,h,m,w,E,S,F,D,Q,V,Z)=>({u_matrix:p,u_normalize_matrix:o,u_globe_matrix:h,u_merc_matrix:m,u_grid_matrix:w,u_tl_parent:E,u_scale_parent:Q,u_fade_t:V.mix,u_opacity:V.opacity,u_image0:0,u_image1:1,u_raster_elevation:Z,u_zoom_transition:S,u_merc_center:F,u_cutoff_params:D}),si=(p,o,h,m,w,E,S,F,D,Q)=>({u_particle_texture:p,u_particle_texture_side_len:o,u_tile_offset:h,u_velocity:m,u_color_ramp:E,u_velocity_res:w,u_max_speed:S,u_uv_offset:F,u_data_scale:[255*D[0],255*D[1]],u_data_offset:Q,u_particle_pos_scale:1.1,u_particle_pos_offset:[Qn,Qn]}),Fa=(p,o,h,m,w,E,S,F,D,Q)=>({u_particle_texture:p,u_particle_texture_side_len:o,u_velocity:h,u_velocity_res:m,u_max_speed:w,u_speed_factor:E,u_reset_rate:S,u_rand_seed:Math.random(),u_uv_offset:F,u_data_scale:[255*D[0],255*D[1]],u_data_offset:Q,u_particle_pos_scale:1.1,u_particle_pos_offset:[Qn,Qn]}),Vo=a.bz(),aa=(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae,fe,Ce,ke,He,$e,it,ct)=>{const Xe=w.transform,Ye={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:Xe.getCameraToCenterDistance(Ce),u_rotate_symbol:+h,u_aspect_ratio:Xe.width/Xe.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:S,u_coord_matrix:F,u_is_text:+Q,u_elevation_from_sea:D?1:0,u_pitch_with_map:+m,u_texsize:V,u_texsize_icon:Z,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Vo,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Vo,u_up_vector:[0,-1,0],u_color_adj_mat:$e,u_icon_transition:it||0,u_gamma_scale:m?w.transform.getCameraToCenterDistance(Ce)*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:a.q.devicePixelRatio,u_is_halo:1,u_scale_factor:ct||1,u_ground_shadow_factor:ke,u_inv_matrix:a.bi(a.bz(),S),u_normal_scale:He};return Ce.name==="globe"&&(Ye.u_tile_id=[ee.canonical.x,ee.canonical.y,1<<ee.canonical.z],Ye.u_zoom_transition=he,Ye.u_inv_rot_matrix=Ae,Ye.u_merc_center=le,Ye.u_camera_forward=Xe._camera.forward(),Ye.u_ecef_origin=a.dQ(Xe.globeMatrix,ee.toUnwrapped()),Ye.u_tile_matrix=Float32Array.from(Xe.globeMatrix),Ye.u_up_vector=fe),Ye},Jn=(p,o,h,m)=>({u_matrix:p,u_emissive_strength:o,u_opacity:h,u_color:m}),Tn=(p,o,h,m,w,E,S,F,D)=>a.h(function(Q,V,Z,K,ee,he){const{width:le,height:Ae}=K.imageManager.getPixelSize(V),fe=Math.pow(2,he.tileID.overscaledZ),Ce=he.tileSize*Math.pow(2,K.transform.tileZoom)/fe,ke=Ce*(he.tileID.canonical.x+he.tileID.wrap*fe),He=Ce*he.tileID.canonical.y;return{u_image:0,u_pattern_tl:Z.tl,u_pattern_br:Z.br,u_texsize:[le,Ae],u_pattern_size:Z.displaySize,u_pattern_units_to_pixels:ee?[K.transform.width,-1*K.transform.height]:[1/a.aw(he,1,K.transform.tileZoom),1/a.aw(he,1,K.transform.tileZoom)],u_pixel_coord_upper:[ke>>16,He>>16],u_pixel_coord_lower:[65535&ke,65535&He]}}(0,E,S,m,F,D),{u_matrix:p,u_emissive_strength:o,u_opacity:h}),So=new Float32Array(a.bx([])),Gi=(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee=[0,0,0],he)=>{const le=w.style.light,Ae=le.properties.get("position"),fe=[-Ae.x,-Ae.y,Ae.z],Ce=a.dJ();le.properties.get("anchor")==="viewport"&&(a.dK(Ce,-w.transform.angle),a.dL(fe,fe,Ce));const ke=V.alphaMode==="MASK",He=le.properties.get("color").toNonPremultipliedRenderColor(null),$e=K.paint.get("model-ambient-occlusion-intensity"),it=K.paint.get("model-color").constantOr(a.am.white).toNonPremultipliedRenderColor(null);return it.a=K.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:p,u_lighting_matrix:o,u_normal_matrix:h,u_node_matrix:m||So,u_lightpos:fe,u_lightintensity:le.properties.get("intensity"),u_lightcolor:[He.r,He.g,He.b],u_camera_pos:ee,u_opacity:E,u_baseTextureIsAlpha:0,u_alphaMask:+ke,u_alphaCutoff:V.alphaCutoff,u_baseColorFactor:S.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:F.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:D,u_roughnessFactor:Q,u_baseColorTexture:Hs.BaseColor,u_metallicRoughnessTexture:Hs.MetallicRoughness,u_normalTexture:Hs.Normal,u_occlusionTexture:Hs.Occlusion,u_emissionTexture:Hs.Emission,u_lutTexture:Hs.LUT,u_color_mix:it.toArray01(),u_aoIntensity:$e,u_emissive_strength:Z,u_occlusionTextureTransform:he||[0,0,0,0]}},Ba=(p,o=So,h=So)=>({u_matrix:p,u_instance:o,u_node_matrix:h}),To={fillExtrusion:p=>({u_matrix:new a.ch(p),u_lightpos:new a.ce(p),u_lightintensity:new a.cf(p),u_lightcolor:new a.ce(p),u_vertical_gradient:new a.cf(p),u_opacity:new a.cf(p),u_edge_radius:new a.cf(p),u_width_scale:new a.cf(p),u_ao:new a.cg(p),u_height_type:new a.cd(p),u_base_type:new a.cd(p),u_tile_id:new a.ce(p),u_zoom_transition:new a.cf(p),u_inv_rot_matrix:new a.ch(p),u_merc_center:new a.cg(p),u_up_dir:new a.ce(p),u_height_lift:new a.cf(p),u_flood_light_color:new a.ce(p),u_vertical_scale:new a.cf(p),u_flood_light_intensity:new a.cf(p),u_ground_shadow_factor:new a.ce(p)}),fillExtrusionDepth:p=>({u_matrix:new a.ch(p),u_edge_radius:new a.cf(p),u_width_scale:new a.cf(p),u_vertical_scale:new a.cf(p),u_height_type:new a.cd(p),u_base_type:new a.cd(p)}),fillExtrusionPattern:p=>({u_matrix:new a.ch(p),u_lightpos:new a.ce(p),u_lightintensity:new a.cf(p),u_lightcolor:new a.ce(p),u_vertical_gradient:new a.cf(p),u_height_factor:new a.cf(p),u_edge_radius:new a.cf(p),u_width_scale:new a.cf(p),u_ao:new a.cg(p),u_height_type:new a.cd(p),u_base_type:new a.cd(p),u_tile_id:new a.ce(p),u_zoom_transition:new a.cf(p),u_inv_rot_matrix:new a.ch(p),u_merc_center:new a.cg(p),u_up_dir:new a.ce(p),u_height_lift:new a.cf(p),u_image:new a.cd(p),u_texsize:new a.cg(p),u_pixel_coord_upper:new a.cg(p),u_pixel_coord_lower:new a.cg(p),u_tile_units_to_pixels:new a.cf(p),u_opacity:new a.cf(p),u_pattern_transition:new a.cf(p)}),fillExtrusionGroundEffect:p=>({u_matrix:new a.ch(p),u_opacity:new a.cf(p),u_ao_pass:new a.cf(p),u_meter_to_tile:new a.cf(p),u_ao:new a.cg(p),u_flood_light_intensity:new a.cf(p),u_flood_light_color:new a.ce(p),u_attenuation:new a.cf(p),u_edge_radius:new a.cf(p),u_fb:new a.cd(p),u_fb_size:new a.cf(p),u_dynamic_offset:new a.cf(p)}),fill:p=>({u_matrix:new a.ch(p),u_emissive_strength:new a.cf(p),u_ground_shadow_factor:new a.ce(p)}),fillPattern:p=>({u_matrix:new a.ch(p),u_emissive_strength:new a.cf(p),u_image:new a.cd(p),u_texsize:new a.cg(p),u_pixel_coord_upper:new a.cg(p),u_pixel_coord_lower:new a.cg(p),u_tile_units_to_pixels:new a.cf(p),u_ground_shadow_factor:new a.ce(p),u_pattern_transition:new a.cf(p)}),fillOutline:p=>({u_matrix:new a.ch(p),u_emissive_strength:new a.cf(p),u_world:new a.cg(p),u_ground_shadow_factor:new a.ce(p)}),fillOutlinePattern:p=>({u_matrix:new a.ch(p),u_emissive_strength:new a.cf(p),u_world:new a.cg(p),u_image:new a.cd(p),u_texsize:new a.cg(p),u_pixel_coord_upper:new a.cg(p),u_pixel_coord_lower:new a.cg(p),u_tile_units_to_pixels:new a.cf(p),u_ground_shadow_factor:new a.ce(p),u_pattern_transition:new a.cf(p)}),building:p=>({u_matrix:new a.ch(p),u_normal_matrix:new a.ch(p),u_opacity:new a.cf(p)}),buildingBloom:p=>({u_matrix:new a.ch(p)}),buildingDepth:p=>({u_matrix:new a.ch(p)}),elevatedStructuresDepth:p=>({u_matrix:new a.ch(p),u_depth_bias:new a.cf(p)}),elevatedStructures:p=>({u_matrix:new a.ch(p),u_ground_shadow_factor:new a.ce(p)}),elevatedStructuresDepthReconstruct:p=>({u_matrix:new a.ch(p),u_camera_pos:new a.ce(p),u_depth_bias:new a.cf(p),u_height_scale:new a.cf(p),u_reset_depth:new a.cf(p)}),circle:a.dT,collisionBox:p=>({u_matrix:new a.ch(p),u_inv_rot_matrix:new a.ch(p),u_camera_to_center_distance:new a.cf(p),u_extrude_scale:new a.cg(p),u_zoom_transition:new a.cf(p),u_merc_center:new a.cg(p),u_tile_id:new a.ce(p)}),collisionCircle:p=>({u_matrix:new a.ch(p),u_inv_matrix:new a.ch(p),u_camera_to_center_distance:new a.cf(p),u_viewport_size:new a.cg(p)}),debug:p=>({u_color:new a.dv(p),u_matrix:new a.ch(p),u_overlay:new a.cd(p),u_overlay_scale:new a.cf(p)}),clippingMask:p=>({u_matrix:new a.ch(p)}),heatmap:p=>({u_extrude_scale:new a.cf(p),u_intensity:new a.cf(p),u_matrix:new a.ch(p),u_inv_rot_matrix:new a.ch(p),u_merc_center:new a.cg(p),u_tile_id:new a.ce(p),u_zoom_transition:new a.cf(p),u_up_dir:new a.ce(p)}),heatmapTexture:p=>({u_image:new a.cd(p),u_color_ramp:new a.cd(p),u_opacity:new a.cf(p)}),hillshade:p=>({u_matrix:new a.ch(p),u_image:new a.cd(p),u_latrange:new a.cg(p),u_light:new a.cg(p),u_shadow:new a.dv(p),u_highlight:new a.dv(p),u_emissive_strength:new a.cf(p),u_accent:new a.dv(p)}),hillshadePrepare:p=>({u_matrix:new a.ch(p),u_image:new a.cd(p),u_dimension:new a.cg(p),u_zoom:new a.cf(p)}),line:a.dS,linePattern:a.dR,raster:p=>({u_matrix:new a.ch(p),u_normalize_matrix:new a.ch(p),u_globe_matrix:new a.ch(p),u_merc_matrix:new a.ch(p),u_grid_matrix:new a.dw(p),u_tl_parent:new a.cg(p),u_scale_parent:new a.cf(p),u_fade_t:new a.cf(p),u_opacity:new a.cf(p),u_image0:new a.cd(p),u_image1:new a.cd(p),u_brightness_low:new a.cf(p),u_brightness_high:new a.cf(p),u_saturation_factor:new a.cf(p),u_contrast_factor:new a.cf(p),u_spin_weights:new a.ce(p),u_perspective_transform:new a.cg(p),u_raster_elevation:new a.cf(p),u_zoom_transition:new a.cf(p),u_merc_center:new a.cg(p),u_cutoff_params:new a.d0(p),u_colorization_mix:new a.d0(p),u_colorization_offset:new a.cf(p),u_color_ramp:new a.cd(p),u_texture_offset:new a.cg(p),u_texture_res:new a.cg(p),u_emissive_strength:new a.cf(p)}),rasterParticle:p=>({u_matrix:new a.ch(p),u_normalize_matrix:new a.ch(p),u_globe_matrix:new a.ch(p),u_merc_matrix:new a.ch(p),u_grid_matrix:new a.dw(p),u_tl_parent:new a.cg(p),u_scale_parent:new a.cf(p),u_fade_t:new a.cf(p),u_opacity:new a.cf(p),u_image0:new a.cd(p),u_image1:new a.cd(p),u_raster_elevation:new a.cf(p),u_zoom_transition:new a.cf(p),u_merc_center:new a.cg(p),u_cutoff_params:new a.d0(p)}),rasterParticleTexture:p=>({u_texture:new a.cd(p),u_opacity:new a.cf(p)}),rasterParticleDraw:p=>({u_particle_texture:new a.cd(p),u_particle_texture_side_len:new a.cf(p),u_tile_offset:new a.cg(p),u_velocity:new a.cd(p),u_color_ramp:new a.cd(p),u_velocity_res:new a.cg(p),u_max_speed:new a.cf(p),u_uv_offset:new a.cg(p),u_data_scale:new a.cg(p),u_data_offset:new a.cf(p),u_particle_pos_scale:new a.cf(p),u_particle_pos_offset:new a.cg(p)}),rasterParticleUpdate:p=>({u_particle_texture:new a.cd(p),u_particle_texture_side_len:new a.cf(p),u_velocity:new a.cd(p),u_velocity_res:new a.cg(p),u_max_speed:new a.cf(p),u_speed_factor:new a.cf(p),u_reset_rate:new a.cf(p),u_rand_seed:new a.cf(p),u_uv_offset:new a.cg(p),u_data_scale:new a.cg(p),u_data_offset:new a.cf(p),u_particle_pos_scale:new a.cf(p),u_particle_pos_offset:new a.cg(p)}),symbol:p=>({u_is_size_zoom_constant:new a.cd(p),u_is_size_feature_constant:new a.cd(p),u_size_t:new a.cf(p),u_size:new a.cf(p),u_camera_to_center_distance:new a.cf(p),u_rotate_symbol:new a.cd(p),u_aspect_ratio:new a.cf(p),u_fade_change:new a.cf(p),u_matrix:new a.ch(p),u_label_plane_matrix:new a.ch(p),u_coord_matrix:new a.ch(p),u_is_text:new a.cd(p),u_elevation_from_sea:new a.cd(p),u_pitch_with_map:new a.cd(p),u_texsize:new a.cg(p),u_texsize_icon:new a.cg(p),u_texture:new a.cd(p),u_texture_icon:new a.cd(p),u_gamma_scale:new a.cf(p),u_device_pixel_ratio:new a.cf(p),u_tile_id:new a.ce(p),u_zoom_transition:new a.cf(p),u_inv_rot_matrix:new a.ch(p),u_merc_center:new a.cg(p),u_camera_forward:new a.ce(p),u_tile_matrix:new a.ch(p),u_up_vector:new a.ce(p),u_ecef_origin:new a.ce(p),u_is_halo:new a.cd(p),u_icon_transition:new a.cf(p),u_color_adj_mat:new a.ch(p),u_scale_factor:new a.cf(p),u_ground_shadow_factor:new a.ce(p),u_inv_matrix:new a.ch(p),u_normal_scale:new a.cf(p)}),background:p=>({u_matrix:new a.ch(p),u_emissive_strength:new a.cf(p),u_opacity:new a.cf(p),u_color:new a.dv(p)}),backgroundPattern:p=>({u_matrix:new a.ch(p),u_emissive_strength:new a.cf(p),u_opacity:new a.cf(p),u_image:new a.cd(p),u_pattern_tl:new a.cg(p),u_pattern_br:new a.cg(p),u_texsize:new a.cg(p),u_pattern_size:new a.cg(p),u_pixel_coord_upper:new a.cg(p),u_pixel_coord_lower:new a.cg(p),u_pattern_units_to_pixels:new a.cg(p)}),terrainRaster:p=>({u_matrix:new a.ch(p),u_image0:new a.cd(p),u_skirt_height:new a.cf(p),u_ground_shadow_factor:new a.ce(p)}),skybox:p=>({u_matrix:new a.ch(p),u_sun_direction:new a.ce(p),u_cubemap:new a.cd(p),u_opacity:new a.cf(p),u_temporal_offset:new a.cf(p)}),skyboxGradient:p=>({u_matrix:new a.ch(p),u_color_ramp:new a.cd(p),u_center_direction:new a.ce(p),u_radius:new a.cf(p),u_opacity:new a.cf(p),u_temporal_offset:new a.cf(p)}),skyboxCapture:p=>({u_matrix_3f:new a.dw(p),u_sun_direction:new a.ce(p),u_sun_intensity:new a.cf(p),u_color_tint_r:new a.d0(p),u_color_tint_m:new a.d0(p),u_luminance:new a.cf(p)}),globeRaster:p=>({u_proj_matrix:new a.ch(p),u_globe_matrix:new a.ch(p),u_normalize_matrix:new a.ch(p),u_merc_matrix:new a.ch(p),u_zoom_transition:new a.cf(p),u_merc_center:new a.cg(p),u_image0:new a.cd(p),u_grid_matrix:new a.dw(p),u_skirt_height:new a.cf(p),u_far_z_cutoff:new a.cf(p),u_frustum_tl:new a.ce(p),u_frustum_tr:new a.ce(p),u_frustum_br:new a.ce(p),u_frustum_bl:new a.ce(p),u_globe_pos:new a.ce(p),u_globe_radius:new a.cf(p),u_viewport:new a.cg(p)}),globeAtmosphere:p=>({u_frustum_tl:new a.ce(p),u_frustum_tr:new a.ce(p),u_frustum_br:new a.ce(p),u_frustum_bl:new a.ce(p),u_horizon:new a.cf(p),u_transition:new a.cf(p),u_fadeout_range:new a.cf(p),u_color:new a.d0(p),u_high_color:new a.d0(p),u_space_color:new a.d0(p),u_temporal_offset:new a.cf(p),u_horizon_angle:new a.cf(p)}),model:p=>({u_matrix:new a.ch(p),u_lighting_matrix:new a.ch(p),u_normal_matrix:new a.ch(p),u_node_matrix:new a.ch(p),u_lightpos:new a.ce(p),u_lightintensity:new a.cf(p),u_lightcolor:new a.ce(p),u_camera_pos:new a.ce(p),u_opacity:new a.cf(p),u_baseColorFactor:new a.d0(p),u_emissiveFactor:new a.d0(p),u_metallicFactor:new a.cf(p),u_roughnessFactor:new a.cf(p),u_baseTextureIsAlpha:new a.cd(p),u_alphaMask:new a.cd(p),u_alphaCutoff:new a.cf(p),u_baseColorTexture:new a.cd(p),u_metallicRoughnessTexture:new a.cd(p),u_normalTexture:new a.cd(p),u_occlusionTexture:new a.cd(p),u_emissionTexture:new a.cd(p),u_lutTexture:new a.cd(p),u_color_mix:new a.d0(p),u_aoIntensity:new a.cf(p),u_emissive_strength:new a.cf(p),u_occlusionTextureTransform:new a.d0(p)}),modelDepth:p=>({u_matrix:new a.ch(p),u_instance:new a.ch(p),u_node_matrix:new a.ch(p)}),groundShadow:p=>({u_matrix:new a.ch(p),u_ground_shadow_factor:new a.ce(p)}),stars:p=>({u_matrix:new a.ch(p),u_up:new a.ce(p),u_right:new a.ce(p),u_intensity_multiplier:new a.cf(p)}),snowParticle:p=>({u_modelview:new a.ch(p),u_projection:new a.ch(p),u_time:new a.cf(p),u_cam_pos:new a.ce(p),u_velocityConeAperture:new a.cf(p),u_velocity:new a.cf(p),u_horizontalOscillationRadius:new a.cf(p),u_horizontalOscillationRate:new a.cf(p),u_boxSize:new a.cf(p),u_billboardSize:new a.cf(p),u_simpleShapeParameters:new a.cg(p),u_screenSize:new a.cg(p),u_thinningCenterPos:new a.cg(p),u_thinningShape:new a.ce(p),u_thinningAffectedRatio:new a.cf(p),u_thinningParticleOffset:new a.cf(p),u_particleColor:new a.d0(p),u_direction:new a.ce(p)}),rainParticle:p=>({u_modelview:new a.ch(p),u_projection:new a.ch(p),u_time:new a.cf(p),u_cam_pos:new a.ce(p),u_texScreen:new a.cd(p),u_velocityConeAperture:new a.cf(p),u_velocity:new a.cf(p),u_boxSize:new a.cf(p),u_rainDropletSize:new a.cg(p),u_distortionStrength:new a.cf(p),u_rainDirection:new a.ce(p),u_color:new a.d0(p),u_screenSize:new a.cg(p),u_thinningCenterPos:new a.cg(p),u_thinningShape:new a.ce(p),u_thinningAffectedRatio:new a.cf(p),u_thinningParticleOffset:new a.cf(p),u_shapeDirectionalPower:new a.cf(p),u_shapeNormalPower:new a.cf(p),u_mode:new a.cf(p)}),vignette:p=>({u_vignetteShape:new a.ce(p),u_vignetteColor:new a.d0(p)}),occlusion:p=>({u_matrix:new a.ch(p),u_anchorPos:new a.ce(p),u_screenSizePx:new a.cg(p),u_occluderSizePx:new a.cg(p),u_color:new a.d0(p)})};class Go{constructor(o,h,m,w){this.id=Go.uniqueIdxCounter,Go.uniqueIdxCounter++,this.context=o;const E=o.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||w||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){this.id=Go.uniqueIdxCounter,Go.uniqueIdxCounter++;const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Go.uniqueIdxCounter=0;const ys={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ko{constructor(o,h,m,w,E,S){this.length=h.length,this.attributes=m,this.itemSize=h.bytesPerElement,this.dynamicDraw=w,this.instanceCount=S,this.context=o;const F=o.gl;this.buffer=F.createBuffer(),o.bindVertexBuffer.set(this.buffer),F.bufferData(F.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?F.DYNAMIC_DRAW:F.STATIC_DRAW),this.dynamicDraw||E||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let m=0;m<this.attributes.length;m++){const w=h.attributes[this.attributes[m].name];w!==void 0&&o.enableVertexAttribArray(w)}}setVertexAttribPointers(o,h,m){for(let w=0;w<this.attributes.length;w++){const E=this.attributes[w],S=h.attributes[E.name];S!==void 0&&o.vertexAttribPointer(S,E.components,o[ys[E.type]],!1,this.itemSize,E.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(o,h,m){for(let w=0;w<this.attributes.length;w++){const E=h.attributes[this.attributes[w].name];E!==void 0&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(E,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Wo{constructor(o,h,m,w,E){this.context=o,this.width=h,this.height=m;const S=this.framebuffer=o.gl.createFramebuffer();w&&(this.colorAttachment=new vf(o,S)),E&&(this.depthAttachmentType=E,this.depthAttachment=E==="renderbuffer"?new qf(o,S):new Gh(o,S))}destroy(){const o=this.context.gl;if(this.colorAttachment){const h=this.colorAttachment.get();h&&o.deleteTexture(h)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const h=this.depthAttachment.get();h&&o.deleteRenderbuffer(h)}else{const h=this.depthAttachment.get();h&&o.deleteTexture(h)}o.deleteFramebuffer(this.framebuffer)}}class Ps{constructor(o,h){this.gl=o,this.clearColor=new Xd(this),this.clearDepth=new LA(this),this.clearStencil=new Vf(this),this.colorMask=new hd(this),this.depthMask=new MA(this),this.stencilMask=new fd(this),this.stencilFunc=new Gf(this),this.stencilOp=new Kf(this),this.stencilTest=new Rp(this),this.depthRange=new kp(this),this.depthTest=new Zd(this),this.depthFunc=new Yd(this),this.blend=new wh(this),this.blendFunc=new Zu(this),this.blendColor=new gf(this),this.blendEquation=new bh(this),this.cullFace=new _f(this),this.cullFaceSide=new Jd(this),this.frontFace=new ep(this),this.program=new Up(this),this.activeTexture=new OA(this),this.viewport=new tp(this),this.bindFramebuffer=new DA(this),this.bindRenderbuffer=new Pl(this),this.bindTexture=new lc(this),this.bindVertexBuffer=new dl(this),this.bindElementBuffer=new Yu(this),this.bindVertexArrayOES=new Wf(this),this.pixelStoreUnpack=new Ll(this),this.pixelStoreUnpackPremultiplyAlpha=new Js(this),this.pixelStoreUnpackFlipY=new Tm(this),this.options=h?Object.assign({},h):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=h&&!!h.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h,m){return new Go(this,o,h,m)}createVertexBuffer(o,h,m,w,E){return new Ko(this,o,h,m,w,E)}createRenderbuffer(o,h,m){const w=this.gl,E=w.createRenderbuffer();return this.bindRenderbuffer.set(E),w.renderbufferStorage(w.RENDERBUFFER,o,h,m),this.bindRenderbuffer.set(null),E}createFramebuffer(o,h,m,w){return new Wo(this,o,h,m,w)}clear({color:o,depth:h,stencil:m,colorMask:w}){const E=this.gl;let S=0;o&&(S|=E.COLOR_BUFFER_BIT,this.clearColor.set(o.toNonPremultipliedRenderColor(null)),this.colorMask.set(w||[!0,!0,!0,!0])),h!==void 0&&(S|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),m!==void 0&&(S|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),E.clear(S)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){a.bv(o.blendFunction,Xn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let ro;function Pa(p,o,h,m,w,E,S){const F=p.context,D=F.gl,Q=p.transform,V=[a.aD(Q.center.lng),a.aH(Q.center.lat)],Z=h.layout.get("symbol-placement"),K=h.layout.get("text-variable-anchor"),ee=h.layout.get("icon-rotation-alignment")==="map",he=h.layout.get("text-rotation-alignment")==="map",le=Z!=="point",Ae=[];let fe=0,Ce=0;for(let Ye=0;Ye<m.length;Ye++){const tt=m[Ye],Pt=o.getTile(tt),gt=Pt.getBucket(h);if(!gt)continue;const Jt=gt.getProjection().createInversionMatrix(Q,tt.canonical),kt=[],or=Gu(tt,gt,Q),pr=!S&&ee&&le,It=S&&he&&le,ht=K&&gt.hasTextData(),zt=gt.hasIconTextFit()&&ht&&gt.hasIconData(),Ot=pr||It||S&&ht||zt,fr=gt.projection.name==="globe",Ar=fr?a.ah(Q.zoom):0;fr&&(kt.push("PROJECTION_GLOBE_VIEW"),Ot&&kt.push("PROJECTED_POS_ON_VIEWPORT"));const yr=p.getOrCreateProgram("collisionBox",{defines:kt});let Br=or;w[0]===0&&w[1]===0||(Br=p.translatePosMatrix(or,Pt,w,E));const ln=S?gt.textCollisionBox:gt.iconCollisionBox,dn=gt.collisionCircleArray;if(dn.length>0){const An=a.bz(),cn=Br;a.cM(An,gt.placementInvProjMatrix,Q.glCoordMatrix),a.cM(An,An,gt.placementViewportMatrix),Ae.push({circleArray:dn,circleOffset:Ce,transform:cn,invTransform:An,projection:gt.getProjection()}),fe+=dn.length/4,Ce=fe}if(!ln)continue;p.terrain&&p.terrain.setupElevationDraw(Pt,yr);const Wr=fr?[tt.canonical.x,tt.canonical.y,1<<tt.canonical.z]:[0,0,0];yr.draw(p,D.LINES,Rr.disabled,bn.disabled,p.colorModeForRenderPass(),xn.disabled,lr(Br,Jt,Q,Ar,V,Pt,Wr,gt.getProjection()),h.id,ln.layoutVertexBuffer,ln.indexBuffer,ln.segments,null,Q.zoom,null,[ln.collisionVertexBuffer,ln.collisionVertexBufferExt])}if(!S||!Ae.length)return;const ke=p.getOrCreateProgram("collisionCircle"),He=new a.dU;He.resize(4*fe),He._trim();let $e=0;for(const Ye of Ae)for(let tt=0;tt<Ye.circleArray.length/4;tt++){const Pt=4*tt,gt=Ye.circleArray[Pt+0],Jt=Ye.circleArray[Pt+1],kt=Ye.circleArray[Pt+2],or=Ye.circleArray[Pt+3];He.emplace($e++,gt,Jt,kt,or,0),He.emplace($e++,gt,Jt,kt,or,1),He.emplace($e++,gt,Jt,kt,or,2),He.emplace($e++,gt,Jt,kt,or,3)}(!ro||ro.length<2*fe)&&(ro=function(Ye){const tt=2*Ye,Pt=new a.a_;Pt.resize(tt),Pt._trim();for(let gt=0;gt<tt;gt++){const Jt=6*gt;Pt.uint16[Jt+0]=4*gt+0,Pt.uint16[Jt+1]=4*gt+1,Pt.uint16[Jt+2]=4*gt+2,Pt.uint16[Jt+3]=4*gt+2,Pt.uint16[Jt+4]=4*gt+3,Pt.uint16[Jt+5]=4*gt+0}return Pt}(fe));const it=F.createIndexBuffer(ro,!0),ct=F.createVertexBuffer(He,a.dV.members,!0);for(const Ye of Ae){const tt={u_matrix:Ye.transform,u_inv_matrix:Ye.invTransform,u_camera_to_center_distance:(Xe=Q).getCameraToCenterDistance(Ye.projection),u_viewport_size:[Xe.width,Xe.height]};ke.draw(p,D.TRIANGLES,Rr.disabled,bn.disabled,p.colorModeForRenderPass(),xn.disabled,tt,h.id,ct,it,a.bd.simpleSegment(0,2*Ye.circleOffset,Ye.circleArray.length,Ye.circleArray.length/2),null,Q.zoom)}var Xe;ct.destroy(),it.destroy()}const La=a.bz();function wo(p){const o=p._camera.getWorldToCamera(p.worldSize,1),h=a.az([],o,p.globeMatrix);a.bi(h,h);const m=[0,0,0],w=[0,1,0,0];return a.aA(w,w,h),m[0]=w[0],m[1]=w[1],m[2]=w[2],a.au(m,m),m}function qa({width:p,height:o,anchor:h,textOffset:m,textScale:w},E){const{horizontalAlign:S,verticalAlign:F}=a.bZ(h),D=-(S-.5)*p,Q=-(F-.5)*o,V=a.b_(h,m);return new a.P((D/w+V[0])*E,(Q/w+V[1])*E)}function cs(p,o,h,m,w,E,S,F,D,Q){const V=p.text.placedSymbolArray,Z=p.text.dynamicLayoutVertexArray,K=p.icon.dynamicLayoutVertexArray,ee={},he=p.getProjection(),le=Bc(S,he,w),Ae=w.elevation,fe=he.upVectorScale(S.canonical,w.center.lat,w.worldSize).metersToTile;Z.clear();for(let Ce=0;Ce<V.length;Ce++){const ke=V.get(Ce),{tileAnchorX:He,tileAnchorY:$e,numGlyphs:it}=ke,ct=ke.hidden||!ke.crossTileID||p.allowVerticalPlacement&&!ke.placedOrientation?null:m[ke.crossTileID];if(ct){let Xe=0,Ye=0,tt=0;if(Ae){const zt=Ae?Ae.getAtTileOffset(S,He,$e):0,[Ot,fr,Ar]=he.upVector(S.canonical,He,$e);Xe=zt*Ot*fe,Ye=zt*fr*fe,tt=zt*Ar*fe}let[Pt,gt,Jt,kt]=ts(ke.projectedAnchorX+Xe,ke.projectedAnchorY+Ye,ke.projectedAnchorZ+tt,h?le:E);const or=Wu(w.getCameraToCenterDistance(he),kt);let pr=a.bJ(p.textSizeData,D,ke)*or/a.bU;h&&(pr*=p.tilePixelRatio/F);const It=qa(ct,pr);h?({x:Pt,y:gt,z:Jt}=he.projectTilePoint(He+It.x,$e+It.y,S.canonical),[Pt,gt,Jt]=ts(Pt+Xe,gt+Ye,Jt+tt,E)):(o&&It._rotate(-w.angle),Pt+=It.x,gt+=It.y,Jt=0);const ht=p.allowVerticalPlacement&&ke.placedOrientation===a.bI.vertical?Math.PI/2:0;for(let zt=0;zt<it;zt++)a.bL(Z,Pt,gt,Jt,ht);Q&&ke.associatedIconIndex>=0&&(ee[ke.associatedIconIndex]={x:Pt,y:gt,z:Jt,angle:ht})}else sr(it,Z)}if(Q){K.clear();const Ce=p.icon.placedSymbolArray;for(let ke=0;ke<Ce.length;ke++){const He=Ce.get(ke),{numGlyphs:$e}=He,it=ee[ke];if(He.hidden||!it)sr($e,K);else{const{x:ct,y:Xe,z:Ye,angle:tt}=it;for(let Pt=0;Pt<$e;Pt++)a.bL(K,ct,Xe,Ye,tt)}}p.icon.dynamicLayoutVertexBuffer.updateData(K)}p.text.dynamicLayoutVertexBuffer.updateData(Z)}function rs(p,o,h,m,w,E,S={}){const F=h.paint.get("icon-translate"),D=h.paint.get("text-translate"),Q=h.paint.get("icon-translate-anchor"),V=h.paint.get("text-translate-anchor"),Z=h.layout.get("icon-rotation-alignment"),K=h.layout.get("text-rotation-alignment"),ee=h.layout.get("icon-pitch-alignment"),he=h.layout.get("text-pitch-alignment"),le=h.layout.get("icon-keep-upright"),Ae=h.layout.get("text-keep-upright"),fe=h.paint.get("icon-color-saturation"),Ce=h.paint.get("icon-color-contrast"),ke=h.paint.get("icon-color-brightness-min"),He=h.paint.get("icon-color-brightness-max"),$e=h.layout.get("symbol-elevation-reference")==="sea",it=p.context,ct=it.gl,Xe=p.transform,Ye=Z==="map",tt=K==="map",Pt=ee==="map",gt=he==="map",Jt=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let kt=!1;const or=p.depthModeForSublayer(0,Rr.ReadOnly),pr=new Rr(p.context.gl.LEQUAL,Rr.ReadOnly,p.depthRangeFor3D),It=[a.aD(Xe.center.lng),a.aH(Xe.center.lat)],ht=h.layout.get("text-variable-anchor"),zt=Xe.projection.name==="globe",Ot=[],fr=[0,-1,0];for(const Ar of m){const yr=o.getTile(Ar),Br=yr.getBucket(h);if(!Br||Br.projection.name==="mercator"&&zt||Br.fullyClipped)continue;const ln=Br.projection.name==="globe",dn=ln?a.ah(Xe.zoom):0,Wr=Bc(Ar,Br.getProjection(),Xe),An=Xe.calculatePixelsToTileUnitsMatrix(yr),cn=ht&&Br.hasTextData(),Ln=Br.hasIconTextFit()&&cn&&Br.hasIconData(),Wn=Br.getProjection().createInversionMatrix(Xe,Ar.canonical),hi=(1<<yr.tileID.canonical.z)*a.aj/p.transform.worldSize,ji=Aa=>{let ea=[0,0,0];if(Aa){const io=p.style.directionalLight,Ki=p.style.ambientLight;io&&Ki&&(ea=oc(p.style,io,Ki))}return ea},Hn=Aa=>{Xe.depthOcclusionForSymbolsAndCircles&&(h.hasInitialOcclusionOpacityProperties||p.terrain)&&(Aa.push("DEPTH_D24"),Aa.push("DEPTH_OCCLUSION"))},Wi=()=>{const Aa=Ye&&h.layout.get("symbol-placement")!=="point",ea=[];Hn(ea);const io=Aa||Ln,Ki=Br.elevationType==="road",ia=p.shadowRenderer,ga=Ki&&Pt&&!!ia&&ia.enabled,Zo=ji(ga),Ma=Ki&&Pt&&!p.terrain?pr:or,Do=h.paint.get("icon-image-cross-fade");p.terrainRenderModeElevated()&&Pt&&ea.push("PITCH_WITH_MAP_TERRAIN"),ln&&(ea.push("PROJECTION_GLOBE_VIEW"),io&&ea.push("PROJECTED_POS_ON_VIEWPORT")),Do>0&&Br.hasAnySecondaryIcon&&ea.push("ICON_TRANSITION"),!Br.icon.zOffsetVertexBuffer||Ki&&p.terrain||ea.push("Z_OFFSET"),fe===0&&Ce===0&&ke===0&&He===1||ea.push("COLOR_ADJUSTMENT"),Br.sdfIcons&&ea.push("RENDER_SDF"),ga&&ea.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ki&&Pt&&!p.terrain&&Br.icon.orientationVertexBuffer&&ea.push("ELEVATED_ROADS");const ml=Br.icon.programConfigurations.get(h.id),Gl=p.getOrCreateProgram("symbol",{config:ml,defines:ea}),Rl=yr.imageAtlasTexture?yr.imageAtlasTexture.size:[0,0],gl=Br.iconSizeData,rl=a.bH(gl,Xe.zoom),lu=Pt||!Xe.isOrthographic,Lu=Cc(Wr,yr.tileID.canonical,Pt,Ye,Xe,Br.getProjection(),An),Kl=rc(Wr,yr.tileID.canonical,Pt,Ye,Xe,Br.getProjection(),An),mo=p.translatePosMatrix(Kl,yr,F,Q,!0),go=p.translatePosMatrix(Wr,yr,F,Q),Ca=io?La:Lu,hs=Ye&&!Pt&&!Aa;let Rs=fr;!zt&&!Xe.mercatorFromTransition||Ye||(Rs=wo(Xe));const uo=ln?Rs:fr,Mu=h.getColorAdjustmentMatrix(fe,Ce,ke,He),nA=aa(gl.kind,rl,hs,Pt,p,go,Ca,mo,$e,!1,Rl,[0,0],0,Ar,dn,It,Wn,uo,Br.getProjection(),Zo,hi,Mu,Do,null),jA=yr.imageAtlasTexture?yr.imageAtlasTexture:null,bd=h.layout.get("icon-size").constantOr(0)!==1||Br.iconsNeedLinear,HA=Br.sdfIcons||p.options.rotating||p.options.zooming||bd||lu?ct.LINEAR:ct.NEAREST,kc=Br.sdfIcons&&h.paint.get("icon-halo-width").constantOr(1)!==0,Ch=p.terrain&&Pt&&Aa?a.bi(a.bz(),Lu):La;if(Aa&&Br.icon){const Yo=Xe.elevation,Ou=Yo?Yo.getAtTileOffsetFunc(Ar,Xe.center.lat,Xe.worldSize,Br.getProjection()):null,Ed=vu(Wr,yr.tileID.canonical,Pt,Ye,Xe,Br.getProjection(),An);yu(Br,Wr,p,!1,Ed,Kl,Pt,le,Ou,Ar)}return{program:Gl,buffers:Br.icon,uniformValues:nA,atlasTexture:jA,atlasTextureIcon:null,atlasInterpolation:HA,atlasInterpolationIcon:null,isSDF:Br.sdfIcons,hasHalo:kc,depthMode:Ma,tile:yr,renderWithShadows:ga,labelPlaneMatrixInv:Ch}},Ji=()=>{const Aa=tt&&h.layout.get("symbol-placement")!=="point",ea=[],io=Aa||ht||Ln,Ki=Br.elevationType==="road",ia=p.shadowRenderer,ga=Ki&&gt&&!!ia&&ia.enabled,Zo=ji(ga),Ma=Ki&&gt&&!p.terrain?pr:or;p.terrainRenderModeElevated()&&gt&&ea.push("PITCH_WITH_MAP_TERRAIN"),ln&&(ea.push("PROJECTION_GLOBE_VIEW"),io&&ea.push("PROJECTED_POS_ON_VIEWPORT")),!Br.text.zOffsetVertexBuffer||Ki&&p.terrain||ea.push("Z_OFFSET"),Br.iconsInText&&ea.push("RENDER_TEXT_AND_SYMBOL"),ea.push("RENDER_SDF"),ga&&ea.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ki&&gt&&!p.terrain&&Br.text.orientationVertexBuffer&&ea.push("ELEVATED_ROADS"),Hn(ea);const Do=Br.text.programConfigurations.get(h.id),ml=p.getOrCreateProgram("symbol",{config:Do,defines:ea});let Gl,Rl=[0,0],gl=null;const rl=Br.textSizeData;Br.iconsInText&&(Rl=yr.imageAtlasTexture?yr.imageAtlasTexture.size:[0,0],gl=yr.imageAtlasTexture?yr.imageAtlasTexture:null,Gl=gt||!Xe.isOrthographic||p.options.rotating||p.options.zooming||rl.kind==="composite"||rl.kind==="camera"?ct.LINEAR:ct.NEAREST);const lu=yr.glyphAtlasTexture?yr.glyphAtlasTexture.size:[0,0],Lu=h.layout.get("text-size-scale-range"),Kl=a.ay(p.scaleFactor,Lu[0],Lu[1]),mo=a.bH(rl,Xe.zoom,Kl),go=Cc(Wr,yr.tileID.canonical,gt,tt,Xe,Br.getProjection(),An),Ca=rc(Wr,yr.tileID.canonical,gt,tt,Xe,Br.getProjection(),An),hs=p.translatePosMatrix(Ca,yr,D,V,!0),Rs=p.translatePosMatrix(Wr,yr,D,V),uo=io?La:go,Mu=tt&&!gt&&!Aa;let nA=fr;!zt&&!Xe.mercatorFromTransition||tt||(nA=wo(Xe));const jA=aa(rl.kind,mo,Mu,gt,p,Rs,uo,hs,$e,!0,lu,Rl,0,Ar,dn,It,Wn,ln?nA:fr,Br.getProjection(),Zo,hi,null,null,Kl),bd=yr.glyphAtlasTexture?yr.glyphAtlasTexture:null,HA=ct.LINEAR,kc=h.paint.get("text-halo-width").constantOr(1)!==0,Ch=p.terrain&&gt&&Aa?a.bi(a.bz(),go):La;if(Aa&&Br.text){const Yo=Xe.elevation,Ou=Yo?Yo.getAtTileOffsetFunc(Ar,Xe.center.lat,Xe.worldSize,Br.getProjection()):null,Ed=vu(Wr,yr.tileID.canonical,gt,tt,Xe,Br.getProjection(),An);yu(Br,Wr,p,!0,Ed,Ca,gt,Ae,Ou,Ar)}return{program:ml,buffers:Br.text,uniformValues:jA,atlasTexture:bd,atlasTextureIcon:gl,atlasInterpolation:HA,atlasInterpolationIcon:Gl,isSDF:!0,hasHalo:kc,depthMode:Ma,tile:yr,renderWithShadows:ga,labelPlaneMatrixInv:Ch}},va=Br.icon.segments.get().length,ei=Br.text.segments.get().length,qi=va&&!S.onlyText?Wi():null,Ni=ei&&!S.onlyIcons?Ji():null,na=h.paint.get("icon-opacity").constantOr(1),In=h.paint.get("text-opacity").constantOr(1);if(Jt&&Br.canOverlap){kt=!0;const Aa=na&&!S.onlyText?Br.icon.segments.get():[],ea=In&&!S.onlyIcons?Br.text.segments.get():[];for(const io of Aa)Ot.push({segments:new a.bd([io]),sortKey:io.sortKey,state:qi});for(const io of ea)Ot.push({segments:new a.bd([io]),sortKey:io.sortKey,state:Ni})}else S.onlyText||Ot.push({segments:na?Br.icon.segments:new a.bd([]),sortKey:0,state:qi}),S.onlyIcons||Ot.push({segments:In?Br.text.segments:new a.bd([]),sortKey:0,state:Ni})}kt&&Ot.sort((Ar,yr)=>Ar.sortKey-yr.sortKey);for(const Ar of Ot){const yr=Ar.state;if(yr)if(p.terrain?p.terrain.setupElevationDraw(yr.tile,yr.program,{useDepthForOcclusion:Xe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:yr.labelPlaneMatrixInv}):p.setupDepthForOcclusion(Xe.depthOcclusionForSymbolsAndCircles,yr.program),it.activeTexture.set(ct.TEXTURE0),yr.atlasTexture&&yr.atlasTexture.bind(yr.atlasInterpolation,ct.CLAMP_TO_EDGE,!0),yr.atlasTextureIcon&&(it.activeTexture.set(ct.TEXTURE1),yr.atlasTextureIcon&&yr.atlasTextureIcon.bind(yr.atlasInterpolationIcon,ct.CLAMP_TO_EDGE,!0)),yr.renderWithShadows&&p.shadowRenderer.setupShadows(yr.tile.tileID.toUnwrapped(),yr.program,"vector-tile"),p.uploadCommonLightUniforms(p.context,yr.program),yr.hasHalo){const Br=yr.uniformValues;Br.u_is_halo=1,ja(yr.buffers,Ar.segments,h,p,yr.program,yr.depthMode,w,E,Br,2),Br.u_is_halo=0}else{if(yr.isSDF){const Br=yr.uniformValues;yr.hasHalo&&(Br.u_is_halo=1,ja(yr.buffers,Ar.segments,h,p,yr.program,yr.depthMode,w,E,Br,1)),Br.u_is_halo=0}ja(yr.buffers,Ar.segments,h,p,yr.program,yr.depthMode,w,E,yr.uniformValues,1)}}}function ja(p,o,h,m,w,E,S,F,D,Q){const V=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.iconTransitioningVertexBuffer,p.globeExtVertexBuffer,p.zOffsetVertexBuffer,p.orientationVertexBuffer];w.draw(m,m.context.gl.TRIANGLES,E,S,F,xn.disabled,D,h.id,p.layoutVertexBuffer,p.indexBuffer,o,h.paint,m.transform.zoom,p.programConfigurations.get(h.id),V,Q)}function Gs(p,o){const h=1<<p.canonical.z,m=(o.x*h-p.canonical.x-p.wrap*h)*a.aj,w=(o.y*h-p.canonical.y)*a.aj,E=a.e2(o.z,o.y);return a.d2(m,w,E)}function Mr(p,o,h,m,w){if(!h.layout||h.layout.get("fill-elevation-reference")==="none")return;const E=p.context.gl,S=new Rr(p.context.gl.LEQUAL,Rr.ReadWrite,p.depthRangeFor3D),F=new Rr(p.context.gl.GREATER,Rr.ReadWrite,p.depthRangeFor3D),D=function(ee){const he=a.cU(ee.pitch);let le=.01;return ee.isOrthographic&&(le=a.ai(1e-4,le,a.cZ(he>=fa?1:he/fa))),2*le}(p.transform),Q=p.transform.getFreeCameraOptions().position,V="elevatedStructuresDepthReconstruct",Z=p.getOrCreateProgram(V,{defines:["DEPTH_RECONSTRUCTION"]}),K=p.getOrCreateProgram(V);for(const ee of m){const he=o.getTile(ee),le=he.getBucket(h);if(!le)continue;const Ae=le.elevatedStructures;if(!Ae)continue;const fe=le.elevationBufferData.heightRange,Ce=Gs(ee.toUnwrapped(),Q),ke=p.translatePosMatrix(ee.projMatrix,he,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));let He,$e,it,ct;if(w==="initialize"){if(!fe||fe.min>=1||Ae.depthSegments.segments[0].primitiveLength===0)continue;He=Wt(ke,Ce,D,1,0),$e=S,it=Ae.depthSegments,ct=Z}else if(w==="reset"){if(!fe||fe.min>=0||Ae.maskSegments.segments[0].primitiveLength===0)continue;He=Wt(ke,Ce,0,0,1),$e=F,it=Ae.maskSegments,ct=Z}else if(w==="geometry"){if(Ae.depthSegments.segments[0].primitiveLength===0)continue;He=Wt(ke,Ce,D,1,0),$e=S,it=Ae.depthSegments,ct=K}ct.draw(p,E.TRIANGLES,$e,bn.disabled,Xn.disabled,xn.disabled,He,h.id,Ae.vertexBuffer,Ae.indexBuffer,it,h.paint,p.transform.zoom)}}function co(p,o,h){const{painter:m,sourceCache:w,layer:E,coords:S,colorMode:F,elevationType:D,terrainEnabled:Q,pass:V}=p,Z=m.context.gl,K=E.paint.get("fill-pattern"),ee=E.paint.get("fill-pattern-cross-fade"),he=K.constantOr(null);let le=D;D!=="road"||o&&!Q||(le="none");const Ae=le==="road",fe=p.painter.shadowRenderer,Ce=Ae&&!!fe&&fe.enabled,ke=new Rr(m.context.gl.LEQUAL,Rr.ReadOnly,m.depthRangeFor3D);let He=[0,0,0];if(Ce){const ct=m.style.directionalLight,Xe=m.style.ambientLight;ct&&Xe&&(He=oc(m.style,ct,Xe))}const $e=K&&K.constantOr(1),it=(ct,Xe)=>{let Ye,tt,Pt,gt,Jt;Xe?(Ye=$e&&!E.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Pt=Z.LINES):(Ye=$e?"fillPattern":"fill",Pt=Z.TRIANGLES);for(const kt of S){const or=w.getTile(kt);if($e&&!or.patternsLoaded())continue;const pr=or.getBucket(E);if(!pr)continue;const It=o?pr.elevationBufferData:pr.bufferData;if(It.isEmpty())continue;m.prepareDrawTile();const ht=It.programConfigurations.get(E.id),zt=m.isTileAffectedByFog(kt),Ot=[],fr=[];Ae&&(Ot.push("ELEVATED_ROADS"),fr.push(It.elevatedLayoutVertexBuffer)),Ce&&Ot.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),$e&&(m.context.activeTexture.set(Z.TEXTURE0),or.imageAtlasTexture&&or.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ht.updatePaintBuffers());let Ar=!1;if(he&&or.imageAtlas){const Wr=or.imageAtlas,An=a.dZ.from(he),cn=An.getPrimary().scaleSelf(a.q.devicePixelRatio).toString(),Ln=An.getSecondary(),Wn=Wr.patternPositions.get(cn),hi=Ln?Wr.patternPositions.get(Ln.scaleSelf(a.q.devicePixelRatio).toString()):null;Ar=!!Wn&&!!hi,Wn&&ht.setConstantPatternPositions(Wn,hi)}ee>0&&(Ar||ht.getPatternTransitionVertexBuffer("fill-pattern"))&&Ot.push("FILL_PATTERN_TRANSITION");const yr=m.getOrCreateProgram(Ye,{config:ht,overrideFog:zt,defines:Ot}),Br=m.translatePosMatrix(kt.projMatrix,or,E.paint.get("fill-translate"),E.paint.get("fill-translate-anchor"));Ce&&fe.setupShadows(or.tileID.toUnwrapped(),yr,"vector-tile");const ln=E.paint.get("fill-emissive-strength");if(Xe){gt=It.lineIndexBuffer,Jt=It.lineSegments;const Wr=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[Z.drawingBufferWidth,Z.drawingBufferHeight];tt=Ye==="fillOutlinePattern"&&$e?dt(Br,ln,m,or,Wr,He,ee):ut(Br,ln,Wr,He)}else gt=It.indexBuffer,Jt=It.triangleSegments,tt=$e?Je(Br,ln,m,or,He,ee):qe(Br,ln,He);m.uploadCommonUniforms(m.context,yr,kt.toUnwrapped());let dn=ct;(D==="road"&&!Q||D==="offset")&&(dn=ke),yr.draw(m,Pt,dn,h||m.stencilModeForClipping(kt),F,xn.disabled,tt,E.id,It.layoutVertexBuffer,gt,Jt,E.paint,m.transform.zoom,ht,fr)}};m.renderPass===V&&it(m.depthModeForSublayer(1,m.renderPass==="opaque"?Rr.ReadWrite:Rr.ReadOnly),!1),le==="none"&&m.renderPass==="translucent"&&E.paint.get("fill-antialias")&&it(m.depthModeForSublayer(E.getPaintProperty("fill-outline-color")?2:0,Rr.ReadOnly),!0)}function ns(p,o,h,m,w,E,S,F){h.resetLayerRenderingStats(p);const D=p.context,Q=D.gl,V=p.transform,Z=h.paint.get("fill-extrusion-pattern"),K=h.paint.get("fill-extrusion-pattern-cross-fade"),ee=Z.constantOr(null),he=Z.constantOr(1),le=h.paint.get("fill-extrusion-opacity"),Ae=p.style.enable3dLights(),fe=h.paint.get(Ae&&!he?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Ce=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),fe],ke=h.layout.get("fill-extrusion-edge-radius"),He=ke>0&&!h.paint.get("fill-extrusion-rounded-roof"),$e=He?0:ke,it=V.projection.name==="globe"?a.e5():0,ct=V.projection.name==="globe",Xe=ct?a.ah(V.zoom):0,Ye=[a.aD(V.center.lng),a.aH(V.center.lat)],tt=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Pt=h.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(tt?null:h.lut).toArray01().slice(0,3),gt=h.paint.get("fill-extrusion-flood-light-intensity"),Jt=h.paint.get("fill-extrusion-vertical-scale"),kt=h.paint.get("fill-extrusion-line-width").constantOr(1)!==0,or=h.paint.get("fill-extrusion-height-alignment"),pr=h.paint.get("fill-extrusion-base-alignment"),It=ls(p,h.paint.get("fill-extrusion-cutoff-fade-range")),ht=[];let zt;ct&&ht.push("PROJECTION_GLOBE_VIEW"),Ce[0]>0&&ht.push("FAUX_AO"),He&&ht.push("ZERO_ROOF_RADIUS"),F&&ht.push("HAS_CENTROID"),gt>0&&ht.push("FLOOD_LIGHT"),It.shouldRenderCutoff&&ht.push("RENDER_CUTOFF"),kt&&ht.push("RENDER_WALL_MODE");const Ot=p.renderPass==="shadow",fr=p.shadowRenderer,Ar=Ot&&!!fr,yr=Ot?xn.disabled:xn.backCCW;p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0);let Br=[0,0,0];if(fr){const Wr=p.style.directionalLight,An=p.style.ambientLight;Wr&&An&&(Br=oc(p.style,Wr,An)),Ot||(ht.push("RENDER_SHADOWS","DEPTH_TEXTURE"),fr.useNormalOffset&&ht.push("NORMAL_OFFSET")),zt=ht.concat(["SHADOWS_SINGLE_CASCADE"])}const ln=Ar?"fillExtrusionDepth":he?"fillExtrusionPattern":"fillExtrusion",dn=h.getLayerRenderingStats();for(const Wr of m){const An=o.getTile(Wr),cn=An.getBucket(h);if(!cn||cn.projection.name!==V.projection.name)continue;let Ln=!1;fr&&(Ln=fr.getMaxCascadeForTile(Wr.toUnwrapped())===0);const Wn=p.isTileAffectedByFog(Wr),hi=cn.programConfigurations.get(h.id);let ji=!1;if(ee&&An.imageAtlas){const Ni=An.imageAtlas,na=a.dZ.from(ee),In=na.getPrimary().scaleSelf(a.q.devicePixelRatio).toString(),Aa=na.getSecondary(),ea=Ni.patternPositions.get(In),io=Aa?Ni.patternPositions.get(Aa.scaleSelf(a.q.devicePixelRatio).toString()):null;ji=!!ea&&!!io,ea&&hi.setConstantPatternPositions(ea,io)}K>0&&(ji||hi.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&ht.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Hn=p.getOrCreateProgram(ln,{config:hi,defines:Ln?zt:ht,overrideFog:Wn});if(p.terrain&&p.terrain.setupElevationDraw(An,Hn,{useMeterToDem:!0}),!cn.centroidVertexBuffer){const Ni=Hn.attributes.a_centroid_pos;Ni!==void 0&&Q.vertexAttrib2f(Ni,0,0)}!Ot&&fr&&fr.setupShadows(An.tileID.toUnwrapped(),Hn,"vector-tile"),he&&(p.context.activeTexture.set(Q.TEXTURE0),An.imageAtlasTexture&&An.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),hi.updatePaintBuffers());const Wi=h.paint.get("fill-extrusion-vertical-gradient"),Ji=1/cn.tileToMeter;let va;if(Ot&&fr){if(el(An.tileID,cn.maxHeight,p))continue;const Ni=fr.calculateShadowPassMatrixFromTile(An.tileID.toUnwrapped());va=ve(Ni,$e,Ji,Jt,or,pr)}else{const Ni=p.translatePosMatrix(Wr.expandedProjMatrix,An,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),na=V.projection.createInversionMatrix(V,Wr.canonical);va=he?Qe(Ni,p,Wi,le,Ce,$e,Ji,Wr,An,it,or,pr,Xe,Ye,na,Pt,Jt,K):ce(Ni,p,Wi,le,Ce,$e,Ji,Wr,it,or,pr,Xe,Ye,na,Pt,Jt,gt,Br)}p.uploadCommonUniforms(D,Hn,Wr.toUnwrapped(),null,It);let ei=cn.segments;if(V.projection.name==="mercator"&&!Ot&&(ei=cn.getVisibleSegments(An.tileID,p.terrain,p.transform.getFrustum(0)),!ei.get().length))continue;if(dn)if(Ot)for(const Ni of ei.get())dn.numRenderedVerticesInShadowPass+=Ni.primitiveLength;else for(const Ni of ei.get())dn.numRenderedVerticesInTransparentPass+=Ni.primitiveLength;const qi=[];(p.terrain||F)&&qi.push(cn.centroidVertexBuffer),ct&&qi.push(cn.layoutVertexExtBuffer),kt&&qi.push(cn.wallVertexBuffer),Hn.draw(p,D.gl.TRIANGLES,w,E,S,yr,va,h.id,cn.layoutVertexBuffer,cn.indexBuffer,ei,h.paint,p.transform.zoom,hi,qi)}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1)}class qo{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function bo(p,o,h,m,w,E,S,F,D,Q,V,Z,K,ee,he,le,Ae,fe,Ce,ke){const He=o.context,$e=He.gl,it=o.transform,ct=o.transform.zoom,Xe=[],Ye=p.translate,tt=p.translateAnchor,Pt=p.edgeRadius,gt=ls(o,p.cutoffFadeRange);V==="clear"?(Xe.push("CLEAR_SUBPASS"),ke&&(Xe.push("CLEAR_FROM_TEXTURE"),He.activeTexture.set($e.TEXTURE0),ke.bind($e.LINEAR,$e.CLAMP_TO_EDGE))):V==="sdf"&&Xe.push("SDF_SUBPASS"),fe&&Xe.push("HAS_CENTROID"),gt.shouldRenderCutoff&&Xe.push("RENDER_CUTOFF");const Jt=(kt,or,pr,It,ht)=>{const zt=or.programConfigurations.get(m.id),Ot=o.isTileAffectedByFog(kt),fr=o.getOrCreateProgram("fillExtrusionGroundEffect",{config:zt,defines:Xe,overrideFog:Ot}),Ar=((Br,ln,dn,Wr,An,cn,Ln,Wn,hi,ji,Hn)=>({u_matrix:ln,u_opacity:dn,u_ao_pass:Wr?1:0,u_meter_to_tile:An,u_ao:cn,u_flood_light_intensity:Ln,u_flood_light_color:Wn,u_attenuation:hi,u_edge_radius:ji,u_fb:0,u_fb_size:Hn,u_dynamic_offset:1}))(0,It,Z,Q,ht,[K,ee*ht],he,le,Ae,ct>=17?0:Pt*ht,ke?ke.size[0]:0),yr=[];fe&&yr.push(or.hiddenByLandmarkVertexBuffer),o.uploadCommonUniforms(He,fr,kt.toUnwrapped(),null,gt),fr.draw(o,He.gl.TRIANGLES,E,S,F,D,Ar,m.id,or.vertexBuffer,or.indexBuffer,pr,m.paint,ct,zt,yr)};for(const kt of w){const or=h.getTile(kt),pr=or.getBucket(m);if(!pr||pr.projection.name!==it.projection.name||!pr.groundEffect||pr.groundEffect&&!pr.groundEffect.hasData())continue;const It=pr.groundEffect,ht=1/pr.tileToMeter;{const zt=o.translatePosMatrix(kt.projMatrix,or,Ye,tt),Ot=It.getDefaultSegment();Jt(kt,It,Ot,zt,ht)}if(Ce)for(let zt=0;zt<4;zt++){const Ot=a.e3[zt](kt),fr=h.getTile(Ot);if(!fr)continue;const Ar=fr.getBucket(m);if(!Ar||Ar.projection.name!==it.projection.name||!Ar.groundEffect||Ar.groundEffect&&!Ar.groundEffect.hasData())continue;const yr=Ar.groundEffect;let Br,ln;zt===0?(Br=[-a.aj,0,0],ln=1):zt===1?(Br=[a.aj,0,0],ln=0):zt===2?(Br=[0,-a.aj,0],ln=3):(Br=[0,a.aj,0],ln=2);const dn=yr.regionSegments[ln];if(!dn)continue;const Wr=new Float32Array(16);a.bo(Wr,kt.projMatrix,Br),Jt(kt,yr,dn,o.translatePosMatrix(Wr,or,Ye,tt),ht)}}}function hn(p,o,h,m,w,E,S){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const F=E?E.findDEMTileFor(h):null;if(!(F&&F.dem||S))return;E&&F&&F.dem&&m.selfDEMTileTimestamp!==F.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=F.dem._timestamp);const D=fe=>new a.P(Math.ceil((fe+a.e7)*a.e8),0),Q=fe=>{const Ce=o.getSource().minzoom,ke=$e=>{const it=o.getTileByID($e);if(it&&it.hasData())return it.getBucket(w)},He=[0,-1,1];for(const $e of He){if(fe.overscaledZ+$e<Ce)continue;const it=ke(fe.calculateScaledKey(fe.overscaledZ+$e));if(it)return it}},V=[0,0,0],Z=(fe,Ce)=>(V[0]=Math.min(fe.min.y,Ce.min.y),V[1]=Math.max(fe.max.y,Ce.max.y),V[2]=a.aj-Ce.min.x>fe.max.x?Ce.min.x-a.aj:fe.max.x,V),K=(fe,Ce)=>(V[0]=Math.min(fe.min.x,Ce.min.x),V[1]=Math.max(fe.max.x,Ce.max.x),V[2]=a.aj-Ce.min.y>fe.max.y?Ce.min.y-a.aj:fe.max.y,V),ee=[(fe,Ce)=>Z(fe,Ce),(fe,Ce)=>Z(Ce,fe),(fe,Ce)=>K(fe,Ce),(fe,Ce)=>K(Ce,fe)],he=(fe,Ce,ke,He,$e,it,ct)=>{if(!E)return 0;const Xe=[[it?ke:fe,it?fe:ke,0],[it?ke:Ce,it?Ce:ke,0]],Ye=ct<0?a.aj+ct:ct,tt=[it?Ye:(fe+Ce)/2,it?(fe+Ce)/2:Ye,0];return ke===0&&ct<0||ke!==0&&ct>0?E.getForTilePoints($e,[tt],!0,He):Xe.push(tt),E.getForTilePoints(h,Xe,!0,F),Math.max(Xe[0][2],Xe[1][2],tt[2])/E.exaggeration()};for(let fe=0;fe<4;fe++){const Ce=m.borderFeatureIndices[fe];if(Ce.length===0)continue;const ke=a.e3[fe](h),He=Q(ke);if(!(He&&He instanceof a.e4))continue;const $e=E?E.findDEMTileFor(ke):null;if(!($e&&$e.dem||S)||(E&&$e&&$e.dem&&m.borderDEMTileTimestamp[fe]!==$e.dem._timestamp&&(m.borderDoneWithNeighborZ[fe]=-1,m.borderDEMTileTimestamp[fe]=$e.dem._timestamp),m.borderDoneWithNeighborZ[fe]===He.canonical.z))continue;He.centroidVertexArray.length===0&&He.createCentroidsBuffer();const it=(fe<2?1:5)-fe,ct=He.borderDoneWithNeighborZ[it]!==m.canonical.z,Xe=He.borderFeatureIndices[it];let Ye=0;if(m.canonical.z!==He.canonical.z){for(const tt of Ce)m.showCentroid(m.featuresOnBorder[tt]);if(ct)for(const tt of Xe)He.showCentroid(He.featuresOnBorder[tt]);m.borderDoneWithNeighborZ[fe]=He.canonical.z,He.borderDoneWithNeighborZ[it]=m.canonical.z}for(const tt of Ce){const Pt=m.featuresOnBorder[tt],gt=m.centroidData[Pt.centroidDataIndex],Jt=Pt.borders[fe];let kt;for(;Ye<Xe.length;){kt=He.featuresOnBorder[Xe[Ye]];const or=kt.borders[it];if(or[1]>Jt[0]+3||or[0]>Jt[0]-3)break;He.showCentroid(kt),Ye++}if(kt&&Ye<Xe.length){const or=Ye;let pr=0;for(;!(kt.borders[it][0]>Jt[1]-3)&&(pr++,++Ye!==Xe.length);)kt=He.featuresOnBorder[Xe[Ye]];kt=He.featuresOnBorder[Xe[or]];let It=!1;if(pr>=1){const Ot=kt.borders[it];Math.abs(Jt[0]-Ot[0])<3&&Math.abs(Jt[1]-Ot[1])<3&&(pr=1,It=!0,Ye=or+1)}else if(pr===0){m.showCentroid(Pt);continue}const ht=He.centroidData[kt.centroidDataIndex];S&&It&&(((le=gt).flags|(Ae=ht).flags)&a.e6?(le.flags|=a.e6,Ae.flags|=a.e6):(le.flags&=~a.e6,Ae.flags&=~a.e6));const zt=Pt.intersectsCount()>1||kt.intersectsCount()>1;if(pr>1)Ye=or,gt.centroidXY=ht.centroidXY=new a.P(0,0);else if($e&&$e.dem&&!zt){const Ot=ee[fe](gt,ht),fr=fe%2?a.aj-1:0,Ar=he(Ot[0],Math.min(a.aj-1,Ot[1]),fr,$e,ke,fe<2,Ot[2]);gt.centroidXY=ht.centroidXY=D(Ar)}else zt?gt.centroidXY=ht.centroidXY=new a.P(0,0):(gt.centroidXY=m.encodeBorderCentroid(Pt),ht.centroidXY=He.encodeBorderCentroid(kt));m.writeCentroidToBuffer(gt),He.writeCentroidToBuffer(ht)}else m.showCentroid(Pt)}m.borderDoneWithNeighborZ[fe]=He.canonical.z,He.borderDoneWithNeighborZ[it]=m.canonical.z}var le,Ae;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(p)}const us=[1,0,0],jl=[0,1,0],Io=[0,0,1];function el(p,o,h){const m=h.transform,w=h.shadowRenderer;if(!w)return!0;const E=p.toUnwrapped(),S=m.tileSize*w._cascades[h.currentShadowCascade].scale;let F=o;if(m.elevation){const le=m.elevation.getMinMaxForTile(p);le&&(F+=le.max)}const D=[...w.shadowDirection];D[2]=-D[2];const Q=w.computeSimplifiedTileShadowVolume(E,F,S,D);if(!Q)return!1;const V=[us,jl,Io,D,[D[0],0,D[2]],[0,D[1],D[2]]],Z=m.projection.name==="globe",K=m.scaleZoom(S),ee=a.cy.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,K,!Z),he=w.getCurrentCascadeFrustum();return ee.intersectsPrecise(Q.vertices,Q.planes,V)===0||he.intersectsPrecise(Q.vertices,Q.planes,V)===0}function cc(p){const{painter:o,source:h,layer:m,coords:w}=p,E=p.defines,S=o.context,F=o.renderPass==="shadow",D=o.renderPass==="light-beam",Q=o.shadowRenderer;let V;Q&&(V=E.concat(["SHADOWS_SINGLE_CASCADE"]));const Z=a.e9(o.transform.center.lat,o.transform.zoom);for(const K of w){const ee=h.getTile(K),he=ee.getBucket(m);if(!he)continue;let le=!1;Q&&(le=Q.getMaxCascadeForTile(K.toUnwrapped())===0);const Ae=he.programConfigurations.get(m.id);let fe,Ce,ke=o.translatePosMatrix(K.expandedProjMatrix,ee,[0,0],"map");if(ke=a.cP(a.bz(),ke,[1,1,p.verticalScale]),F&&Q){if(el(ee.tileID,he.maxHeight*Z,o))continue;let He=Q.calculateShadowPassMatrixFromTile(ee.tileID.toUnwrapped());He=a.cP(a.bz(),He,[1,1,p.verticalScale]),Ce=rr(He),fe=o.getOrCreateProgram("buildingDepth",{config:Ae,defines:le?V:E,overrideFog:!1})}else if(D)fe=o.getOrCreateProgram("buildingBloom",{config:Ae,defines:le?V:E,overrideFog:!1}),Ce=yt(ke);else{const He=o.transform.calculatePosMatrix(K.toUnwrapped(),o.transform.worldSize);a.cP(He,He,[1,1,p.verticalScale]);const $e=a.bz();a.cP($e,He,[1,-1,1/Z]),a.bi($e,$e),a.ea($e,$e),Ce=dr(ke,$e),fe=o.getOrCreateProgram("building",{config:Ae,defines:le?V:E,overrideFog:!1}),Q&&Q.setupShadowsFromMatrix(He,fe,!0)}if(o.uploadCommonUniforms(S,fe,K.toUnwrapped(),null,null),D){const He=he.bloomGeometry;fe.draw(o,S.gl.TRIANGLES,p.depthMode,bn.disabled,p.blendMode,xn.disabled,Ce,m.id,He.layoutVertexBuffer,He.indexBuffer,He.segmentsBucket,m.paint,o.transform.zoom,Ae,[He.layoutAttenuationBuffer,He.layoutColorBuffer])}else fe.draw(o,S.gl.TRIANGLES,p.depthMode,bn.disabled,p.blendMode,F?xn.disabled:xn.backCW,Ce,m.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,m.paint,o.transform.zoom,Ae,[he.layoutNormalBuffer,he.layoutColorBuffer])}}function Su(p){return[p[0]*a.eb,p[1]*a.eb,p[2]*a.eb,0]}function Ls(p,o,h,m,w,E,S,F,D){const Q=m.getSource(),V=h.globeSharedBuffers;if(!V)return;let Z,K,ee;if(o&&(Z=m.getTile(o)),Q instanceof a.aP?(K=Q.texture,ee=a.dE(0,0,h.transform)):Z&&o&&(K=Z.texture,ee=a.dE(o.canonical.z,o.canonical.x,h.transform)),!K||!ee)return;p||(ee=a.cP(a.bz(),ee,[1,-1,1]));const he=h.context,le=he.gl,Ae=w.paint.get("raster-resampling")==="nearest"?le.NEAREST:le.LINEAR,fe=h.colorModeForDrapableLayerRenderPass(E),Ce=S.defines;Ce.push("GLOBE_POLES");const ke=new Rr(le.LEQUAL,Rr.ReadWrite,h.depthRangeFor3D),He=Float32Array.from(h.transform.expandedFarZProjMatrix),$e=Float32Array.from(a.bh(a.dD(new a.cA(0,0,0))));h.terrain&&h.terrain.prepareDrawTile(),he.activeTexture.set(le.TEXTURE0),K.bind(Ae,le.CLAMP_TO_EDGE),he.activeTexture.set(le.TEXTURE1),K.bind(Ae,le.CLAMP_TO_EDGE),"useMipmap"in K&&he.extTextureFilterAnisotropic&&h.transform.pitch>20&&le.texParameterf(le.TEXTURE_2D,he.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,he.extTextureFilterAnisotropicMax);const[it,ct,Xe,Ye]=o?V.getPoleBuffers(o.canonical.z,!1):V.getPoleBuffers(0,!0),tt=w.paint.get("raster-elevation");let Pt;p?(Pt=it,h.renderDefaultNorthPole=tt!==0):(Pt=ct,h.renderDefaultSouthPole=tt!==0);const gt=Su(S.mix),Jt=((or,pr,It,ht,zt,Ot,fr,Ar,yr,Br,ln,dn,Wr)=>rn(or,pr,It,new Float32Array(16),new Float32Array(9),[0,0],ht,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Ot,[0,0],Ar,2,Br,ln,dn,1,0,Wr))(He,$e,ee,a.ah(h.transform.zoom),0,w,0,tt,0,gt,S.offset,S.range,E),kt=h.getOrCreateProgram("raster",{defines:Ce});h.uploadCommonUniforms(he,kt,null),kt.draw(h,le.TRIANGLES,ke,D,fe,F,Jt,w.id,Pt,Xe,Ye)}function Ms(p){const o=p._nearZ,h=p.projection.farthestPixelDistance(p),m=h-o,w=.2*p.height,E=o+w;return[o,h,(E-w-o)/m,(E-o)/m]}function bf(p,o,h,m){if(p)return o instanceof Co&&p instanceof zh?o.getTextureDescriptor(p,h,!0):{texture:p.texture,mix:Su(m.mix),offset:m.offset,buffer:0,tileSize:1}}var xs=a.ec([{name:"a_index",type:"Int16",components:1}]);class Ef{constructor(o,h,m,w){const E={width:m[0],height:m[1],data:null},S=o.gl;this.targetColorTexture=new a.T(o,E,S.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new a.T(o,E,S.RGBA8,{useMipmap:!1}),this.context=o,this.updateParticleTexture(h,w),this.lastInvalidatedAt=0}updateParticleTexture(o,h){if(this.particleTextureDimension===h.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,w=h.width*h.height;this.particleTexture0=new a.T(this.context,h,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,h,m.RGBA8,{premultiply:!1,useMipmap:!1});const E=new a.ed;E.reserve(w);for(let S=0;S<w;S++)E.emplaceBack(S);this.particleIndexBuffer=this.context.createVertexBuffer(E,xs.members,!0),this.particleSegment=a.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=h.width}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=a.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function $o(p,o,h){if(!p)return null;const m=o.getTextureDescriptor(p,h,!0);if(!m)return null;let{texture:w,mix:E,offset:S,tileSize:F,buffer:D,format:Q}=m;if(!w||!Q)return null;let V=!1;return Q==="uint32"&&(V=!0,E[3]=0,E=zr(a.ee,E,[0,h.paint.get("raster-particle-max-speed")]),S=Gr(a.ee,S,[0,h.paint.get("raster-particle-max-speed")])),{texture:w,textureOffset:[D/(F+2*D),F/(F+2*D)],tileSize:F,scalarData:V,scale:E,offset:S,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[Q]]}}function Wh(p){const o=p._nearZ,h=p.projection.farthestPixelDistance(p),m=h-o,w=.2*p.height,E=o+w;return[o,h,(E-w-o)/m,(E-o)/m]}const rp=new a.am(1,0,0,1),Fo=new a.am(0,1,0,1),iu=new a.am(0,0,1,1),gd=new a.am(1,0,1,1),np=new a.am(0,1,1,1);function au(p,o,h,m,w,E){for(let S=0;S<h.length;S++)if(w){const Q=new a.am(m.r*.8,m.g*.8,m.b*.8,1);oa(p,o,h[S],m,-1,-1,E),oa(p,o,h[S],m,-1,1,E),oa(p,o,h[S],m,1,1,E),oa(p,o,h[S],m,1,-1,E),oa(p,o,h[S],Q,0,0,E)}else oa(p,o,h[S],m,0,0,E)}function oa(p,o,h,m,w,E,S){const F=p.context,D=p.transform,Q=F.gl,V=D.projection.name==="globe",Z=V?["PROJECTION_GLOBE_VIEW"]:[];let K=a.bw(h.projMatrix);if(V&&a.ah(D.zoom)>0){const gt=a.bg(h.canonical,D),Jt=a.ef(gt);K=a.az(new Float32Array(16),D.globeMatrix,Jt),a.az(K,D.projMatrix,K)}const ee=a.bz();ee[12]+=2*w/(a.q.devicePixelRatio*D.width),ee[13]+=2*E/(a.q.devicePixelRatio*D.height),a.az(K,ee,K);const he=p.getOrCreateProgram("debug",{defines:Z}),le=o.getTileByID(h.key);p.terrain&&p.terrain.setupElevationDraw(le,he);const Ae=Rr.disabled,fe=bn.disabled,Ce=p.colorModeForRenderPass(),ke="$debug";F.activeTexture.set(Q.TEXTURE0),p.emptyTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),V?le._makeGlobeTileDebugBuffers(p.context,D):le._makeDebugTileBoundsBuffers(p.context,D.projection);const He=le._tileDebugBuffer||p.debugBuffer,$e=le._tileDebugIndexBuffer||p.debugIndexBuffer,it=le._tileDebugSegments||p.debugSegments;if(he.draw(p,Q.LINE_STRIP,Ae,fe,Ce,xn.disabled,Qr(K,m.toPremultipliedRenderColor(null)),ke,He,$e,it,null,null,null,[le._globeTileDebugBorderBuffer]),S){const gt=le.latestRawTileData,Jt=Math.floor((gt&&gt.byteLength||0)/1024);let kt=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(kt+=` => ${h.overscaledZ}`),kt+=` ${le.state}`,kt+=` ${Jt}kb`,function(or,pr){or.initDebugOverlayCanvas();const It=or.debugOverlayCanvas,ht=or.context.gl,zt=or.debugOverlayCanvas.getContext("2d");zt.clearRect(0,0,It.width,It.height),zt.shadowColor="white",zt.shadowBlur=2,zt.lineWidth=1.5,zt.strokeStyle="white",zt.textBaseline="top",zt.font="bold 36px Open Sans, sans-serif",zt.fillText(pr,5,5),zt.strokeText(pr,5,5),or.debugOverlayTexture.update(It),or.debugOverlayTexture.bind(ht.LINEAR,ht.CLAMP_TO_EDGE)}(p,kt)}const ct=o.getTile(h).tileSize,Xe=512/Math.min(ct,512)*(h.overscaledZ/D.zoom)*.5,Ye=le._tileDebugTextBuffer||p.debugBuffer,tt=le._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,Pt=le._tileDebugTextSegments||p.debugSegments;he.draw(p,Q.TRIANGLES,Ae,fe,Xn.alphaBlended,xn.disabled,Qr(K,a.am.transparent.toPremultipliedRenderColor(null),Xe),ke,Ye,tt,Pt,null,null,null,[le._globeTileDebugTextBuffer])}function Pc(p,o,h,m){is(p,0,o+h/2,p.transform.width,h,m)}function Po(p,o,h,m){is(p,o-h/2,0,h,p.transform.height,m)}function is(p,o,h,m,w,E){const S=p.context,F=S.gl;F.enable(F.SCISSOR_TEST),F.scissor(o*a.q.devicePixelRatio,h*a.q.devicePixelRatio,m*a.q.devicePixelRatio,w*a.q.devicePixelRatio),S.clear({color:E}),F.disable(F.SCISSOR_TEST)}const ws=a.ec([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Xf}=ws;function Hl(p,o,h,m){p.emplaceBack(o,h,m)}class Tu{constructor(o){this.vertexArray=new a.eg,this.indices=new a.a_,Hl(this.vertexArray,-1,-1,1),Hl(this.vertexArray,1,-1,1),Hl(this.vertexArray,-1,1,1),Hl(this.vertexArray,1,1,1),Hl(this.vertexArray,-1,-1,-1),Hl(this.vertexArray,1,-1,-1),Hl(this.vertexArray,-1,1,-1),Hl(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Xf),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=a.bd.simpleSegment(0,0,36,12)}}function Ju(p,o,h,m,w,E){const S=p.context.gl,F=o.paint.get("sky-atmosphere-color"),D=o.paint.get("sky-atmosphere-halo-color"),Q=o.paint.get("sky-atmosphere-sun-intensity"),V=((Z,K,ee,he,le)=>({u_matrix_3f:Z,u_sun_direction:K,u_sun_intensity:ee,u_color_tint_r:[he.r,he.g,he.b,he.a],u_color_tint_m:[le.r,le.g,le.b,le.a],u_luminance:5e-5}))(a.ei(a.dJ(),m),w,Q,F.toPremultipliedRenderColor(null),D.toPremultipliedRenderColor(null));S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+E,o.skyboxTexture,0),h.draw(p,S.TRIANGLES,Rr.disabled,bn.disabled,Xn.unblended,xn.frontCW,V,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const ur=a.ec([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Kr{constructor(o){const h=new a.ej;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const m=new a.a_;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(h,ur.members),this.indexBuffer=o.createIndexBuffer(m),this.segments=a.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Eh=a.ec([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class _a{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Bt{constructor(o){this.colorModeAlphaBlendedWriteRGB=new Xn([1,wu,1,wu],a.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Xn([1,0,1,0],a.am.transparent,[!1,!1,!1,!0]),this.params=new _a,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(o){const h=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Kr(h);const m=this.params.sizeRange,w=this.params.intensityRange,E=function(V){const Z=a.el(30),K=[];for(let ee=0;ee<V;++ee){const he=2*Math.PI*Z(),le=Math.acos(1-2*Z())-.5*Math.PI;K.push(a.d2(Math.cos(le)*Math.cos(he),Math.cos(le)*Math.sin(he),Math.sin(le)))}return K}(this.params.starsCount),S=a.el(300),F=new a.ek,D=new a.a_;let Q=0;for(let V=0;V<E.length;++V){const Z=a.c1([],E[V],200),K=Math.max(0,1+.01*m*(1*S()-.5)),ee=Math.max(0,1+.01*w*(1*S()-.5));F.emplaceBack(Z[0],Z[1],Z[2],-1,-1,K,ee),F.emplaceBack(Z[0],Z[1],Z[2],1,-1,K,ee),F.emplaceBack(Z[0],Z[1],Z[2],1,1,K,ee),F.emplaceBack(Z[0],Z[1],Z[2],-1,1,K,ee),D.emplaceBack(Q+0,Q+1,Q+2),D.emplaceBack(Q+0,Q+2,Q+3),Q+=4}this.starsVx=h.createVertexBuffer(F,Eh.members),this.starsIdx=h.createIndexBuffer(D),this.starsSegments=a.bd.simpleSegment(0,0,F.length,D.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,h){const m=o.context,w=m.gl,E=o.transform,S=new Rr(w.LEQUAL,Rr.ReadOnly,[0,1]),F=a.ah(E.zoom),D=o.style.getLut(h.scope),Q=h.properties.get("color-use-theme")==="none",V=h.properties.get("color").toNonPremultipliedRenderColor(Q?null:D).toArray01(),Z=h.properties.get("high-color-use-theme")==="none",K=h.properties.get("high-color").toNonPremultipliedRenderColor(Z?null:D).toArray01(),ee=h.properties.get("space-color-use-theme")==="none",he=h.properties.get("space-color").toNonPremultipliedRenderColor(ee?null:D).toArray01(),le=5e-4,Ae=a.em(h.properties.get("horizon-blend"),0,1,le,.25),fe=a.dy(o,m,E)&&Ae===le?E.worldSize/(2*Math.PI*1.025)-1:E.globeRadius,Ce=o.frameCounter/1e3%1,ke=a.ae(E.globeCenterInViewSpace),He=Math.sqrt(Math.pow(ke,2)-Math.pow(fe,2)),$e=Math.acos(He/ke),it=ct=>{const Xe=E.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];ct&&Xe.push("ALPHA_PASS");const Ye=o.getOrCreateProgram("globeAtmosphere",{defines:Xe}),tt=((gt,Jt,kt,or,pr,It,ht,zt,Ot,fr,Ar,yr)=>({u_frustum_tl:gt,u_frustum_tr:Jt,u_frustum_br:kt,u_frustum_bl:or,u_horizon:pr,u_transition:It,u_fadeout_range:ht,u_color:zt,u_high_color:Ot,u_space_color:fr,u_temporal_offset:Ar,u_horizon_angle:yr}))(E.frustumCorners.TL,E.frustumCorners.TR,E.frustumCorners.BR,E.frustumCorners.BL,E.frustumCorners.horizon,F,Ae,V,K,he,Ce,$e);o.uploadCommonUniforms(m,Ye);const Pt=this.atmosphereBuffer;Pt&&Ye.draw(o,w.TRIANGLES,S,bn.disabled,ct?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,xn.backCW,tt,ct?"atmosphere_glow_alpha":"atmosphere_glow",Pt.vertexBuffer,Pt.indexBuffer,Pt.segments)};it(!1),it(!0)}drawStars(o,h){const m=a.ay(h.properties.get("star-intensity"),0,1);if(m===0)return;const w=o.context,E=w.gl,S=o.transform,F=o.getOrCreateProgram("stars"),D=a.c3([]);a.c5(D,D,-S._pitch),a.c4(D,D,-S.angle),a.c5(D,D,a.al(S._center.lat)),a.en(D,D,-a.al(S._center.lng));const Q=a.c8(new Float32Array(16),D),V=a.az([],S.starsProjMatrix,Q),Z=a.ei([],Q),K=a.eo([],Z),ee=[0,1,0];a.dL(ee,ee,K),a.c1(ee,ee,this.params.sizeMultiplier);const he=[1,0,0];a.dL(he,he,K),a.c1(he,he,this.params.sizeMultiplier);const le=(Ae=ee,fe=he,Ce=m,{u_matrix:Float32Array.from(V),u_up:Ae,u_right:fe,u_intensity_multiplier:Ce});var Ae,fe,Ce;o.uploadCommonUniforms(w,F),this.starsVx&&this.starsIdx&&F.draw(o,E.TRIANGLES,Rr.disabled,bn.disabled,this.colorModeAlphaBlendedWriteRGB,xn.disabled,le,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class Lc{constructor(){this.visibleTiles=[]}updateBorders(o,h){const m=[],w=[],E=o._getRenderableCoordinates(!1,!0);for(const D of E){const Q=o.getTile(D);if(!Q.hasData())continue;const V=Q.getBucket(h);V&&(V.isEmpty()||(m.push(D.key),w.push({bucket:V,tileID:D.canonical})))}let S=m.length!==this.visibleTiles.length;if(!S){m.sort();for(let D=0;D<m.length;D++)if(m[D]!==this.visibleTiles[D]){S=!0;break}}if(!S)return;const F=new Set;this.visibleTiles=m,w.sort((D,Q)=>D.tileID.z-Q.tileID.z||D.tileID.x-Q.tileID.x||D.tileID.y-Q.tileID.y);for(const D of w){const Q=new Array,V=new Array,Z=D.bucket;for(const K of Z.featuresOnBorder)F.has(K.featureId)?V.push(K.footprintIndex):(F.add(K.featureId),Q.push(K.footprintIndex));Z.updateFootprintHiddenFlags(Q,a.ep,!1),Z.updateFootprintHiddenFlags(V,a.ep,!0)}}}function qh(p,o){const h=[...p],m=o.cameraWorldSizeForFog/o.worldSize,w=a.bx([]);return a.cP(w,w,[m,m,1]),a.az(h,w,h),a.az(h,o.worldToFogMatrix,h),h}function Bf(p,o,h,m,w){const E=h.material,S=m.context,{baseColorTexture:F,metallicRoughnessTexture:D}=E.pbrMetallicRoughness,{normalTexture:Q,occlusionTexture:V,emissionTexture:Z}=E;function K(he,le,Ae){if(he&&(p.push(le),S.activeTexture.set(S.gl.TEXTURE0+Ae),he.gfxTexture)){const{minFilter:fe,magFilter:Ce,wrapS:ke,wrapT:He}=he.sampler;he.gfxTexture.bindExtraParam(fe,Ce,ke,He)}}K(F,"HAS_TEXTURE_u_baseColorTexture",Hs.BaseColor),K(D,"HAS_TEXTURE_u_metallicRoughnessTexture",Hs.MetallicRoughness),K(Q,"HAS_TEXTURE_u_normalTexture",Hs.Normal),K(V,"HAS_TEXTURE_u_occlusionTexture",Hs.Occlusion),K(Z,"HAS_TEXTURE_u_emissionTexture",Hs.Emission),w&&(w.texture||(w.texture=new a.et(m.context,w.image,[w.image.height,w.image.height,w.image.height],S.gl.RGBA8)),S.activeTexture.set(S.gl.TEXTURE0+Hs.LUT),w.texture&&w.texture.bind(S.gl.LINEAR,S.gl.CLAMP_TO_EDGE),p.push("APPLY_LUT_ON_GPU")),h.texcoordBuffer&&(p.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(h.texcoordBuffer)),h.colorBuffer&&(p.push(h.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(h.colorBuffer)),h.normalBuffer&&(p.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(h.normalBuffer)),h.pbrBuffer&&(p.push("HAS_ATTRIBUTE_a_pbr"),p.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(h.pbrBuffer)),E.alphaMode!=="OPAQUE"&&E.alphaMode!=="MASK"||p.push("UNPREMULT_TEXTURE_IN_SHADER"),E.defined||p.push("DIFFUSE_SHADED");const ee=m.shadowRenderer;ee&&(p.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ee.useNormalOffset&&p.push("NORMAL_OFFSET"))}function ou(p,o,h,m,w,E){const S=h.paint.get("model-opacity").constantOr(1),F=o.context,D=new Rr(o.context.gl.LEQUAL,Rr.ReadWrite,o.depthRangeFor3D),Q=o.transform,V=p.mesh,Z=V.material,K=Z.pbrMetallicRoughness,ee=o.style.fog;let he;he=o.transform.projection.zAxisUnit==="pixels"?[...p.nodeModelMatrix]:a.az([],m.zScaleMatrix,p.nodeModelMatrix),a.az(he,m.negCameraPosMatrix,he);const le=a.bi([],he);a.ea(le,le);const Ae=h.paint.get("model-color-use-theme").constantOr("default")==="none",fe=h.paint.get("model-emissive-strength").constantOr(0),Ce=Gi(new Float32Array(p.worldViewProjection),new Float32Array(he),new Float32Array(le),null,o,S,K.baseColorFactor,Z.emissiveFactor,K.metallicFactor,K.roughnessFactor,Z,fe,h),ke={defines:[]},He=[],$e=o.shadowRenderer;$e&&($e.useNormalOffset=!1),Bf(ke.defines,He,V,o,Ae?null:h.lut);let it=null;if(ee){const Ye=qh(p.nodeModelMatrix,o.transform);if(it=new Float32Array(Ye),Q.projection.name!=="globe"){const tt=V.aabb.min,Pt=V.aabb.max,[gt,Jt]=ee.getOpacityForBounds(Ye,tt[0],tt[1],Pt[0],Pt[1]);ke.overrideFog=gt>=Oe||Jt>=Oe}}const ct=ls(o,h.paint.get("model-cutoff-fade-range"));ct.shouldRenderCutoff&&ke.defines.push("RENDER_CUTOFF");const Xe=o.getOrCreateProgram("model",ke);o.uploadCommonUniforms(F,Xe,null,it,ct),o.renderPass!=="shadow"&&$e&&$e.setupShadowsFromMatrix(p.nodeModelMatrix,Xe),Xe.draw(o,F.gl.TRIANGLES,D,w,E,V.material.doubleSided?xn.disabled:xn.backCCW,Ce,h.id,V.vertexBuffer,V.indexBuffer,V.segments,h.paint,o.transform.zoom,void 0,He)}function ip(p,o,h,m,w,E,S){let F;F=p.projection.name==="globe"?a.er(h,p):[...h],a.az(F,F,o.matrix);const D=a.az([],m,F);if(o.meshes)for(const Q of o.meshes){if(Q.material.alphaMode!=="BLEND"){S.push({mesh:Q,depth:0,modelIndex:w,worldViewProjection:D,nodeModelMatrix:F});continue}const V=a.ad([],Q.centroid,D);!p.isOrthographic&&V[2]<=0||E.push({mesh:Q,depth:V[2],modelIndex:w,worldViewProjection:D,nodeModelMatrix:F})}if(o.children)for(const Q of o.children)ip(p,Q,h,m,w,E,S)}function RA(p,o,h,m){const w=h.shadowRenderer;if(!w)return;const E=w.getShadowPassDepthMode(),S=w.getShadowPassColorMode(),F=w.calculateShadowPassMatrixFromMatrix(o),D=Ba(F);h.getOrCreateProgram("modelDepth",{defines:h._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(h,h.context.gl.TRIANGLES,E,bn.disabled,S,xn.backCCW,D,m.id,p.vertexBuffer,p.indexBuffer,p.segments,m.paint,h.transform.zoom,void 0,void 0)}function Zf(p,o,h){const m=o.updateZoomBasedPaintProperties(),w=function(E,S,F){let D,Q,V,Z=E.terrain?E.terrain.exaggeration():0;if(E.terrain&&Z>0){const K=E.terrain,ee=K.findDEMTileFor(F);ee&&ee.dem?D=a.eu.create(K,F,ee):Z=0}if(Z===0&&(S.terrainElevationMin=0,S.terrainElevationMax=0),Z===S.validForExaggeration&&(Z===0||D&&D._demTile&&D._demTile.tileID===S.validForDEMTile.id&&D._dem._timestamp===S.validForDEMTile.timestamp))return!1;for(const K in S.instancesPerModel){const ee=S.instancesPerModel[K];for(let he=0;he<ee.instancedDataArray.length;++he){const le=(D?Z*D.getElevationAt(0|ee.instancedDataArray.float32[16*he],0|ee.instancedDataArray.float32[16*he+1],!0,!0):0)+ee.instancesEvaluatedElevation[he];ee.instancedDataArray.float32[16*he+6]=le,Q=Q?Math.min(S.terrainElevationMin,le):le,V=V?Math.max(S.terrainElevationMax,le):le}}return S.terrainElevationMin=Q||0,S.terrainElevationMax=V||0,S.validForExaggeration=Z,S.validForDEMTile=D&&D._demTile?{id:D._demTile.tileID,timestamp:D._dem._timestamp}:{id:void 0,timestamp:0},!0}(p,o,h);(m||w)&&(o.uploaded=!1,o.upload(p.context))}const Iu={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.d6([0,0,0],[a.aj,a.aj,0])};function Im(p,o){const h=1<<p.canonical.z,m=o.getFreeCameraOptions().position,w=o.elevation,E=p.canonical.x/h,S=(p.canonical.x+1)/h,F=p.canonical.y/h,D=(p.canonical.y+1)/h;let Q=o._centerAltitude;if(w){const ee=w.getMinMaxForTile(p);ee&&ee.max>Q&&(Q=ee.max)}const V=a.ay(m.x,E,S)-m.x,Z=a.ay(m.y,F,D)-m.y,K=a.cb(Q,o.center.lat)-m.z;return o._zoomFromMercatorZ(Math.sqrt(V*V+Z*Z+K*K))}function Cf(p,o,h,m,w,E,S){const F=p.context,D=p.renderPass==="shadow",Q=p.shadowRenderer,V=D&&Q?Q.getShadowPassDepthMode():new Rr(F.gl.LEQUAL,Rr.ReadWrite,p.depthRangeFor3D),Z=p.isTileAffectedByFog(E);if(h.meshes)for(const K of h.meshes){const ee=["MODEL_POSITION_ON_GPU"],he=[];let le,Ae,fe;m.instancedDataArray.length>20&&ee.push("INSTANCED_ARRAYS");const Ce=ls(p,o.paint.get("model-cutoff-fade-range"));if(Ce.shouldRenderCutoff&&ee.push("RENDER_CUTOFF"),D&&Q)le=p.getOrCreateProgram("modelDepth",{defines:ee}),Ae=Ba(S.shadowTileMatrix,S.shadowTileMatrix,Float32Array.from(h.matrix)),fe=Q.getShadowPassColorMode();else{Bf(ee,he,K,p,o.paint.get("model-color-use-theme").constantOr("default")==="none"?null:o.lut),le=p.getOrCreateProgram("model",{defines:ee,overrideFog:Z});const He=K.material,$e=He.pbrMetallicRoughness,it=o.paint.get("model-opacity").constantOr(1),ct=o.paint.get("model-emissive-strength").constantOr(0);Ae=Gi(E.expandedProjMatrix,Float32Array.from(h.matrix),new Float32Array(16),null,p,it,$e.baseColorFactor,He.emissiveFactor,$e.metallicFactor,$e.roughnessFactor,He,ct,o,w),Q&&(S.shadowUniformsInitialized?le.setShadowUniformValues(F,Q.getShadowUniformValues()):(Q.setupShadows(E.toUnwrapped(),le,"model-tile"),S.shadowUniformsInitialized=!0)),fe=Ce.shouldRenderCutoff||it<1||He.alphaMode!=="OPAQUE"?Xn.alphaBlended:Xn.unblended}p.uploadCommonUniforms(F,le,E.toUnwrapped(),null,Ce);const ke=K.material.doubleSided?xn.disabled:xn.backCCW;if(m.instancedDataArray.length>20)he.push(m.instancedDataBuffer),le.draw(p,F.gl.TRIANGLES,V,bn.disabled,fe,ke,Ae,o.id,K.vertexBuffer,K.indexBuffer,K.segments,o.paint,p.transform.zoom,void 0,he,m.instancedDataArray.length);else{const He=D?"u_instance":"u_normal_matrix";for(let $e=0;$e<m.instancedDataArray.length;++$e)Ae[He]=new Float32Array(m.instancedDataArray.arrayBuffer,64*$e,16),le.draw(p,F.gl.TRIANGLES,V,bn.disabled,fe,ke,Ae,o.id,K.vertexBuffer,K.indexBuffer,K.segments,o.paint,p.transform.zoom,void 0,he)}}if(h.children)for(const K of h.children)Cf(p,o,K,m,w,E,S)}const Yf=[1,-1,1];function Jf(p,o,h,m){if(!h.modelManager)return!0;const w=h.modelManager;if(!h.shadowRenderer)return!0;const E=h.shadowRenderer,S=o.aabb;let F=!0,D=p.maxHeight;if(D===0){let V=0;for(const Z in p.instancesPerModel){const K=w.getModel(Z,m);K?V=Math.max(V,Math.max(Math.max(K.aabb.max[0],K.aabb.max[1]),K.aabb.max[2])):F=!1}D=p.maxScale*V*1.41+p.maxVerticalOffset,F&&(p.maxHeight=D)}S.max[2]=D,S.min[2]+=p.terrainElevationMin,S.max[2]+=p.terrainElevationMax,a.ad(S.min,S.min,o.tileMatrix),a.ad(S.max,S.max,o.tileMatrix);const Q=S.intersects(E.getCurrentCascadeFrustum());return h.currentShadowCascade===0&&(p.isInsideFirstShadowMapFrustum=Q===2),Q===0}function Mc(p,o){const h=p.uniformValues.u_cutoff_params[0],m=p.uniformValues.u_cutoff_params[1],w=p.uniformValues.u_cutoff_params[2],E=p.uniformValues.u_cutoff_params[3];return m===h||E===w?1:a.ay(((o-h)/(m-h)-w)/(E-w),0,1)}function Bh(p,o,h,m){if(o.pitch<20)return 1;const w=o.getWorldToCameraMatrix();a.az(w,w,p);const E=a.bR(h.min[0],h.min[1],h.min[2],1);let S=a.aA(a.ev(),E,w),F=S,D=S;E[1]=h.max[1],S=a.aA(a.ev(),E,w),F=S[1]<F[1]?S:F,D=S[1]>D[1]?S:D,E[0]=h.max[0],S=a.aA(a.ev(),E,w),F=S[1]<F[1]?S:F,D=S[1]>D[1]?S:D,E[1]=h.min[1],S=a.aA(a.ev(),E,w),F=S[1]<F[1]?S:F,D=S[1]>D[1]?S:D;const Q=a.ay(m[0],0,1),V=100*o.pixelsPerMeter*a.ay(m[1],0,1),Z=a.ay(m[2],0,1),K=a.ew(a.ev(),F,D,Q),ee=Math.tan(.5*o.fovX),he=-K[2]*ee;if(V===0)return K[1]<-Math.abs(he)?Z:1;const le=(-Math.abs(he)-K[1])/V,Ae=(Ce,ke,He)=>(1-He)*Ce+He*ke,fe=a.ay(Ae(1,Z,le),Z,1);return Ae(1,fe,a.ay((o.pitch-20)/20,0,1))}class Oc{}class eh{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,h,m){{const Z=this._storage.get(h.id);if(Z)return Z.lastUsedFrameIdx=o,Z.buf}const w=m.gl,E=w.getBufferParameter(w.ELEMENT_ARRAY_BUFFER,w.BUFFER_SIZE),S=new ArrayBuffer(E),F=new Int16Array(S);w.getBufferSubData(w.ELEMENT_ARRAY_BUFFER,0,new Int16Array(S));const D=new a.ey;for(let Z=0;Z<E/2;Z+=3){const K=F[Z],ee=F[Z+1],he=F[Z+2];D.emplaceBack(K,ee),D.emplaceBack(ee,he),D.emplaceBack(he,K)}const Q=m.bindVertexArrayOES.current,V=new Oc;return V.buf=new Go(m,D),V.lastUsedFrameIdx=o,this._storage.set(h.id,V),m.bindVertexArrayOES.set(Q),V.buf}update(o){for(const[h,m]of this._storage)o-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(h))}destroy(){for(const[o,h]of this._storage)h.buf.destroy(),this._storage.delete(o)}}class $h{constructor(o){this.occluderSize=30,this.depthOffset=-1e-4,o.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),o.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const _d=a.ec([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Fm{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Ks{constructor(o,h){this.revealStart=11,this.revealRange=2,o.registerParameter(this,[...h,"Reveal"],"revealStart",{min:0,max:17,step:.05}),o.registerParameter(this,[...h,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const ap=a.ec([{type:"Float32",name:"a_pos_2f",components:2}]);class op{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(o,h){const m=o.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const S=new a.ez,F=new a.a_;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(1,1),S.emplaceBack(-1,1),F.emplaceBack(0,1,2),F.emplaceBack(0,2,3),this.vignetteVx=o.context.createVertexBuffer(S,ap.members),this.vignetteIdx=o.context.createIndexBuffer(F)}const w=a.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){o.uploadCommonUniforms(o.context,m);const S={u_vignetteShape:(E={vignetteShape:[h.start,h.range,Math.pow(10,h.fadePower)],vignetteColor:[h.color.r,h.color.g,h.color.b,h.color.a*h.strength]}).vignetteShape,u_vignetteColor:E.vignetteColor};m.draw(o,o.context.gl.TRIANGLES,Rr.disabled,bn.disabled,Xn.alphaBlended,xn.disabled,S,"vignette",this.vignetteVx,this.vignetteIdx,w)}var E}}class Da{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(o,h){const m=o.getFreeCameraOptions().position,w=m.toAltitude(),E=m.toLngLat(),S=a.al(E.lng),F=a.al(E.lat),D=o.pixelsPerMeter/h,Q=S*a.eB,V=a.eB*Math.log(Math.tan(Math.PI/4+F/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const Z=-this._offsetYPrev+V,K=-this._elevationPrev+w;this._accumulatedOffsetX+=(-this._offsetXPrev+Q)*D,this._accumulatedOffsetY+=Z*D,this._accumulatedElevation+=K*D,this._offsetXPrev=Q,this._offsetYPrev=V,this._elevationPrev=w}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Di(p,o){return[-(p[0]-Math.floor(p[0]/o)*o),-(p[1]-Math.floor(p[1]/o)*o),-(p[2]-Math.floor(p[2]/o)*o)]}function Pm(p){const o=a.el(1323123451230),h=[];for(let m=0;m<p;++m){const w=2*o()-1,E=2*o()-1,S=2*o()-1;h.push(a.d2(w,E,S))}return h}function Dc(p,o,h,m,w){const E=a.ay((w-h)/(m-h),0,1);return(1-E)*p+E*o}class sp{constructor(o){this._movement=new Da,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new op,this._ppmScaleFactor=o}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(o,h){const m=o.transform;this._movement.update(m,this._ppmScaleFactor);const w=m.starsProjMatrix,E=a.c3([]);a.c5(E,E,a.al(90)-m._pitch),a.c4(E,E,-m.angle);const S=a.c8(new Float32Array(16),E),F=a.eA(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),D=a.ea([],F),Q=a.az([],D,S),V=Date.now()/1e3;return this._accumulatedTimeFromStart+=(V-this._prevTime)*h,this._prevTime=V,{projectionMatrix:w,modelviewMatrix:Q}}}class vd extends sp{constructor(o){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Ks(o.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(o){const h=o.context;if(!this.particlesVx){const m=Pm(this.particlesCount),w=new a.eC,E=new a.a_;let S=0;const F=a.el(1323123451230);for(let D=0;D<m.length;++D){const Q=m[D],V=[2*F()-1,F(),F(),F()];w.emplaceBack(Q[0],Q[1],Q[2],-1,-1,...V),w.emplaceBack(Q[0],Q[1],Q[2],1,-1,...V),w.emplaceBack(Q[0],Q[1],Q[2],1,1,...V),w.emplaceBack(Q[0],Q[1],Q[2],-1,1,...V),E.emplaceBack(S+0,S+1,S+2),E.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=h.createVertexBuffer(w,_d.members),this.particlesIdx=h.createIndexBuffer(E)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.rain)return;const h=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=o.transform.zoom;if(h.revealStart>m)return;const w=Dc(0,1,h.revealStart,h.revealStart+h.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const E=structuredClone(this._params);let S=[-E.direction.x,E.direction.y,-100];a.au(S,S);const F=structuredClone(this._vignetteParams);F.strength*=w,E.overrideStyleParameters||(E.intensity=o.style.rain.state.density,E.timeFactor=o.style.rain.state.intensity,E.color=structuredClone(o.style.rain.state.color),S=structuredClone(o.style.rain.state.direction),E.screenThinning.intensity=o.style.rain.state.centerThinning,E.dropletSizeX=o.style.rain.state.dropletSize[0],E.dropletSizeYScale=o.style.rain.state.dropletSize[1]/o.style.rain.state.dropletSize[0],E.distortionStrength=100*o.style.rain.state.distortionStrength,F.strength=1,F.color=structuredClone(o.style.rain.state.vignetteColor));const D=this.updateOnRender(o,E.timeFactor),Q=o.context,V=Q.gl,Z=o.transform;this.screenTexture&&this.screenTexture.size[0]===o.width&&this.screenTexture.size[1]===o.height||(this.screenTexture=new a.T(Q,{width:o.width,height:o.height,data:null},V.RGBA8)),E.distortionStrength>0&&(Q.activeTexture.set(V.TEXTURE0),this.screenTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),V.copyTexSubImage2D(V.TEXTURE_2D,0,0,0,0,0,o.width,o.height));const K=o.getOrCreateProgram("rainParticle");o.uploadCommonUniforms(Q,K),Q.activeTexture.set(V.TEXTURE0),this.screenTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const ee=[E.color.r,E.color.g,E.color.b,E.color.a],he=(le,Ae)=>{const fe=Di(this._movement.getPosition(),le),Ce=E.dropletSizeX,ke=E.dropletSizeX*E.dropletSizeYScale,He=o.width/2,$e=o.height/2,it=Dc(0,E.screenThinning.start,0,1,E.screenThinning.intensity),ct=Dc(.001,E.screenThinning.range,0,1,E.screenThinning.intensity),Xe=Dc(0,E.screenThinning.particleOffset,0,1,E.screenThinning.intensity),Ye=(tt={modelview:D.modelviewMatrix,projection:D.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:fe,velocityConeAperture:E.velocityConeAperture,velocity:E.velocity,boxSize:le,rainDropletSize:[Ce,ke],distortionStrength:E.distortionStrength,rainDirection:S,color:ee,screenSize:[Z.width,Z.height],thinningCenterPos:[He,$e],thinningShape:[it,ct,Math.pow(10,E.screenThinning.fadePower)],thinningAffectedRatio:E.screenThinning.affectedRatio,thinningParticleOffset:Xe,shapeDirectionalPower:E.shapeDirPower,shapeNormalPower:E.shapeNormalPower,mode:Ae?0:1},{u_modelview:Float32Array.from(tt.modelview),u_projection:Float32Array.from(tt.projection),u_time:tt.time,u_cam_pos:tt.camPos,u_texScreen:0,u_velocityConeAperture:tt.velocityConeAperture,u_velocity:tt.velocity,u_boxSize:tt.boxSize,u_rainDropletSize:tt.rainDropletSize,u_distortionStrength:tt.distortionStrength,u_rainDirection:tt.rainDirection,u_color:tt.color,u_screenSize:tt.screenSize,u_thinningCenterPos:tt.thinningCenterPos,u_thinningShape:tt.thinningShape,u_thinningAffectedRatio:tt.thinningAffectedRatio,u_thinningParticleOffset:tt.thinningParticleOffset,u_shapeDirectionalPower:tt.shapeDirectionalPower,u_shapeNormalPower:tt.shapeNormalPower,u_mode:tt.mode});var tt;const Pt=Math.round(E.intensity*this.particlesCount),gt=a.bd.simpleSegment(0,0,4*Pt,2*Pt);K.draw(o,V.TRIANGLES,Rr.disabled,bn.disabled,Xn.alphaBlended,xn.disabled,Ye,"rain_particles",this.particlesVx,this.particlesIdx,gt)};E.distortionStrength>0&&he(E.boxSize,!0),he(E.boxSize,!1),this._vignette.draw(o,F)}}const yd=a.ec([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class kg extends sp{constructor(o){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Ks(o.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(o){const h=o.context;if(!this.particlesVx){const m=Pm(this.particlesCount),w=new a.eD,E=new a.a_;let S=0;const F=a.el(1323123451230);for(let D=0;D<m.length;++D){const Q=m[D],V=F(),Z=F(),K=F(),ee=[D/m.length,V,Z,K],he=[F(),F()];w.emplaceBack(Q[0],Q[1],Q[2],-1,-1,...ee,...he),w.emplaceBack(Q[0],Q[1],Q[2],1,-1,...ee,...he),w.emplaceBack(Q[0],Q[1],Q[2],1,1,...ee,...he),w.emplaceBack(Q[0],Q[1],Q[2],-1,1,...ee,...he),E.emplaceBack(S+0,S+1,S+2),E.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=h.createVertexBuffer(w,yd.members),this.particlesIdx=h.createIndexBuffer(E)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.snow)return;const h=structuredClone(this._params);let m=[-h.direction.x,h.direction.y,-100];a.au(m,m);const w=structuredClone(this._vignetteParams),E=h.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},S=o.transform.zoom;if(E.revealStart>S)return;const F=Dc(0,1,E.revealStart,E.revealStart+E.revealRange,S);w.strength*=F,h.overrideStyleParameters||(h.intensity=o.style.snow.state.density,h.timeFactor=o.style.snow.state.intensity,h.color=structuredClone(o.style.snow.state.color),m=structuredClone(o.style.snow.state.direction),h.screenThinning.intensity=o.style.snow.state.centerThinning,h.billboardSize=2.79*o.style.snow.state.flakeSize,w.strength=1,w.color=structuredClone(o.style.snow.state.vignetteColor));const D=this.updateOnRender(o,h.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const Q=o.context,V=Q.gl,Z=o.transform,K=o.getOrCreateProgram("snowParticle");o.uploadCommonUniforms(Q,K),((ee,he,le)=>{const Ae=Di(this._movement.getPosition(),ee),fe=Z.width/2,Ce=Z.height/2,ke=Dc(0,le.screenThinning.start,0,1,le.screenThinning.intensity),He=Dc(.001,le.screenThinning.range,0,1,le.screenThinning.intensity),$e=Dc(0,le.screenThinning.particleOffset,0,1,le.screenThinning.intensity),it=(ct={modelview:D.modelviewMatrix,projection:D.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Ae,velocityConeAperture:le.velocityConeAperture,velocity:le.velocity,horizontalOscillationRadius:le.horizontalOscillationRadius,horizontalOscillationRate:le.horizontalOscillationRate,boxSize:ee,billboardSize:1*le.billboardSize,simpleShapeParameters:[le.shapeFadeStart,le.shapeFadePower],screenSize:[Z.width,Z.height],thinningCenterPos:[fe,Ce],thinningShape:[ke,He,Math.pow(10,le.screenThinning.fadePower)],thinningAffectedRatio:le.screenThinning.affectedRatio,thinningParticleOffset:$e,color:[le.color.r,le.color.g,le.color.b,le.color.a],direction:m},{u_modelview:Float32Array.from(ct.modelview),u_projection:Float32Array.from(ct.projection),u_time:ct.time,u_cam_pos:ct.camPos,u_velocityConeAperture:ct.velocityConeAperture,u_velocity:ct.velocity,u_horizontalOscillationRadius:ct.horizontalOscillationRadius,u_horizontalOscillationRate:ct.horizontalOscillationRate,u_boxSize:ct.boxSize,u_billboardSize:ct.billboardSize,u_simpleShapeParameters:ct.simpleShapeParameters,u_screenSize:ct.screenSize,u_thinningCenterPos:ct.thinningCenterPos,u_thinningShape:ct.thinningShape,u_thinningAffectedRatio:ct.thinningAffectedRatio,u_thinningParticleOffset:ct.thinningParticleOffset,u_particleColor:ct.color,u_direction:ct.direction});var ct;const Xe=Math.round(le.intensity*this.particlesCount),Ye=a.bd.simpleSegment(0,0,4*Xe,2*Xe);this.particlesVx&&this.particlesIdx&&K.draw(o,V.TRIANGLES,Rr.disabled,bn.disabled,Xn.alphaBlended,xn.disabled,it,"snow_particles",this.particlesVx,this.particlesIdx,Ye)})(h.boxSize,0,h),this._vignette.draw(o,w)}}const Lm={symbol:function(p,o,h,m,w){if(p.renderPass!=="translucent")return;const E=bn.disabled,S=p.colorModeForRenderPass(),F=h.layout.get("text-variable-anchor"),D=h.layout.get("text-size-scale-range"),Q=a.ay(p.scaleFactor,D[0],D[1]);F&&function(K,ee,he,le,Ae,fe,Ce,ke){const He=ee.transform,$e=Ae==="map",it=fe==="map";for(const ct of K){const Xe=le.getTile(ct),Ye=Xe.getBucket(he);if(!Ye||!Ye.text||!Ye.text.segments.get().length)continue;const tt=a.bH(Ye.textSizeData,He.zoom,ke),Pt=Bc(ct,Ye.getProjection(),He),gt=He.calculatePixelsToTileUnitsMatrix(Xe),Jt=Cc(Pt,Xe.tileID.canonical,it,$e,He,Ye.getProjection(),gt),kt=Ye.hasIconTextFit()&&Ye.hasIconData();tt&&cs(Ye,$e,it,Ce,He,Jt,ct,Math.pow(2,He.zoom-Xe.tileID.overscaledZ),tt,kt)}}(m,p,h,o,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),w,Q);const V=h.paint.get("icon-opacity").constantOr(1)!==0,Z=h.paint.get("text-opacity").constantOr(1)!==0;h.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(V||Z)?rs(p,o,h,m,E,S):(V&&rs(p,o,h,m,E,S,{onlyIcons:!0}),Z&&rs(p,o,h,m,E,S,{onlyText:!0})),o.map.showCollisionBoxes&&(Pa(p,o,h,m,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Pa(p,o,h,m,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(p,o,h,m){if(p.renderPass!=="translucent")return;const w=h.paint.get("circle-opacity"),E=h.paint.get("circle-stroke-width"),S=h.paint.get("circle-stroke-opacity"),F=h.layout.get("circle-sort-key").constantOr(1)!==void 0,D=h.paint.get("circle-emissive-strength");if(w.constantOr(1)===0&&(E.constantOr(1)===0||S.constantOr(1)===0))return;const Q=p.context,V=Q.gl,Z=p.transform,K=!(!p.terrain||!p.terrain.enabled),ee=h.layout.get("circle-elevation-reference"),he=p.depthModeForSublayer(0,Rr.ReadOnly),le=new Rr(p.context.gl.LEQUAL,Rr.ReadOnly,p.depthRangeFor3D),Ae=ee==="none"||K?he:le,fe=bn.disabled,Ce=p.colorModeForDrapableLayerRenderPass(D),ke=Z.projection.name==="globe",He=[a.aD(Z.center.lng),a.aH(Z.center.lat)],$e=[];for(let ct=0;ct<m.length;ct++){const Xe=m[ct],Ye=o.getTile(Xe),tt=Ye.getBucket(h);if(!tt||tt.projection.name!==Z.projection.name)continue;const Pt=tt.programConfigurations.get(h.id),gt=tt.layoutVertexBuffer,Jt=tt.globeExtVertexBuffer,kt=tt.indexBuffer,or=a.dW(h),pr=[Jt],It=p.isTileAffectedByFog(Xe);ke&&or.push("PROJECTION_GLOBE_VIEW"),or.push("DEPTH_D24"),p.terrain&&Z.depthOcclusionForSymbolsAndCircles&&or.push("DEPTH_OCCLUSION"),tt.hasElevation&&!p.terrain&&(or.push("ELEVATED_ROADS"),pr.push(tt.elevatedLayoutVertexBuffer));const ht=p.getOrCreateProgram("circle",{config:Pt,defines:or,overrideFog:It}),zt=Z.projection.createInversionMatrix(Z,Xe.canonical),Ot={programConfiguration:Pt,program:ht,layoutVertexBuffer:gt,dynamicBuffers:pr,indexBuffer:kt,uniformValues:a.dX(p,Xe,Ye,zt,He,h),tile:Ye};if(F){const fr=tt.segments.get();for(const Ar of fr)$e.push({segments:new a.bd([Ar]),sortKey:Ar.sortKey,state:Ot})}else $e.push({segments:tt.segments,sortKey:0,state:Ot})}F&&$e.sort((ct,Xe)=>ct.sortKey-Xe.sortKey);const it={useDepthForOcclusion:Z.depthOcclusionForSymbolsAndCircles};for(const ct of $e){const{programConfiguration:Xe,program:Ye,layoutVertexBuffer:tt,dynamicBuffers:Pt,indexBuffer:gt,uniformValues:Jt,tile:kt}=ct.state,or=ct.segments;p.terrain&&p.terrain.setupElevationDraw(kt,Ye,it),p.uploadCommonUniforms(Q,Ye,kt.tileID.toUnwrapped()),Ye.draw(p,V.TRIANGLES,Ae,fe,Ce,xn.disabled,Jt,h.id,tt,gt,or,h.paint,Z.zoom,Xe,Pt)}},heatmap:function(p,o,h,m){if(h.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const w=p.context,E=w.gl,S=bn.disabled,F=new Xn([E.ONE,E.ONE,E.ONE,E.ONE],a.am.transparent,[!0,!0,!0,!0]);(function(ee,he,le,Ae){const fe=ee.gl,Ce=he.width*Ae,ke=he.height*Ae;ee.activeTexture.set(fe.TEXTURE1),ee.viewport.set([0,0,Ce,ke]);let He=le.heatmapFbo;if(!He||He&&(He.width!==Ce||He.height!==ke)){He&&He.destroy();const $e=fe.createTexture();fe.bindTexture(fe.TEXTURE_2D,$e),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_WRAP_S,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_WRAP_T,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_MIN_FILTER,fe.LINEAR),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_MAG_FILTER,fe.LINEAR),He=le.heatmapFbo=ee.createFramebuffer(Ce,ke,!0,null),function(it,ct,Xe,Ye,tt,Pt){const gt=it.gl;gt.texImage2D(gt.TEXTURE_2D,0,it.extRenderToTextureHalfFloat?gt.RGBA16F:gt.RGBA,tt,Pt,0,gt.RGBA,it.extRenderToTextureHalfFloat?gt.HALF_FLOAT:gt.UNSIGNED_BYTE,null),Ye.colorAttachment.set(Xe)}(ee,0,$e,He,Ce,ke)}else fe.bindTexture(fe.TEXTURE_2D,He.colorAttachment.get()),ee.bindFramebuffer.set(He.framebuffer)})(w,p,h,p.transform.projection.name==="globe"?.5:.25),w.clear({color:a.am.transparent});const D=p.transform,Q=D.projection.name==="globe",V=Q?["PROJECTION_GLOBE_VIEW"]:[],Z=Q?xn.frontCCW:xn.disabled,K=[a.aD(D.center.lng),a.aH(D.center.lat)];for(let ee=0;ee<m.length;ee++){const he=m[ee];if(o.hasRenderableParent(he))continue;const le=o.getTile(he),Ae=le.getBucket(h);if(!Ae||Ae.projection.name!==D.projection.name)continue;const fe=p.isTileAffectedByFog(he),Ce=Ae.programConfigurations.get(h.id),ke=p.getOrCreateProgram("heatmap",{config:Ce,defines:V,overrideFog:fe}),{zoom:He}=p.transform;p.terrain&&p.terrain.setupElevationDraw(le,ke),p.uploadCommonUniforms(w,ke,he.toUnwrapped());const $e=D.projection.createInversionMatrix(D,he.canonical);ke.draw(p,E.TRIANGLES,Rr.disabled,S,F,Z,Ur(p,he,le,$e,K,He,h.paint.get("heatmap-intensity")),h.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,h.paint,p.transform.zoom,Ce,Q?[Ae.globeExtVertexBuffer]:null)}w.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),function(w,E){const S=w.context,F=S.gl,D=E.heatmapFbo;if(!D)return;S.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,D.colorAttachment.get()),S.activeTexture.set(F.TEXTURE1);let Q=E.colorRampTexture;Q||(Q=E.colorRampTexture=new a.T(S,E.colorRamp,F.RGBA8)),Q.bind(F.LINEAR,F.CLAMP_TO_EDGE),w.getOrCreateProgram("heatmapTexture").draw(w,F.TRIANGLES,Rr.disabled,bn.disabled,w.colorModeForRenderPass(),xn.disabled,((V,Z,K,ee)=>({u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}))(0,E),E.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,E.paint,w.transform.zoom)}(p,h))},line:function(p,o,h,m){if(p.renderPass!=="translucent")return;const w=h.paint.get("line-opacity"),E=h.paint.get("line-width");if(w.constantOr(1)===0||E.constantOr(1)===0)return;const S=h.paint.get("line-emissive-strength"),F=h.paint.get("line-occlusion-opacity"),D=h.layout.get("line-elevation-reference"),Q=h.layout.get("line-width-unit")==="meters",V=D==="sea",Z=!(!p.terrain||!p.terrain.enabled),K=p.context,ee=K.gl;if(h.hasElevatedBuckets&&p.transform.projection.name==="globe")return;const he=h.layout.get("line-cross-slope"),le=he!==void 0,Ae=he<1,fe=p.colorModeForDrapableLayerRenderPass(S),Ce=p.terrain&&p.terrain.renderingToTexture,ke=Ce?1:a.q.devicePixelRatio,He=h.paint.get("line-dasharray"),$e=He.constantOr(1),it=h.layout.get("line-cap"),ct=He.constantOr(null),Xe=it.constantOr(null),Ye=h.paint.get("line-pattern"),tt=Ye.constantOr(1),Pt=h.paint.get("line-pattern-cross-fade"),gt=Ye.constantOr(null),Jt=h.paint.get("line-opacity").constantOr(1);let kt=!tt&&Jt!==1||p.depthOcclusion&&F>0&&F<1;const or=h.paint.get("line-gradient"),pr=tt?"linePattern":"line",It=a.dY(h);let ht;if(Ce&&p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(kt=!1),F!==0&&p.depthOcclusion){const Ar=h.paint._values["line-opacity"];Ar&&Ar.value&&Ar.value.kind==="constant"?ht=Ar.value:a.w(`Occlusion opacity for layer ${h.id} is supported only when line-opacity isn't data-driven.`)}E.value.kind!=="constant"&&E.value.isLineProgressConstant===!1&&It.push("VARIABLE_LINE_WIDTH");const zt=(Ar,yr,Br,ln,dn,Wr)=>{for(const An of Ar){const cn=o.getTile(An);if(tt&&!cn.patternsLoaded())continue;const Ln=cn.getBucket(h);if(!Ln||Ln.elevationType!=="none"&&!dn||Ln.elevationType==="none"&&dn)continue;p.prepareDrawTile();const Wn=[...yr],hi=p.shadowRenderer,ji=Ln.elevationType==="road"&&!!hi&&hi.enabled;let Hn=[0,0,0];if(ji){const Ki=p.style.directionalLight,ia=p.style.ambientLight;Ki&&ia&&(Hn=oc(p.style,Ki,ia)),Wn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const Wi=Ln.programConfigurations.get(h.id);let Ji=!1;if(gt&&cn.imageAtlas){const Ki=a.dZ.from(gt),ia=Ki.getPrimary().scaleSelf(ke).toString(),ga=cn.imageAtlas.patternPositions.get(ia),Zo=Ki.getSecondary(),Ma=Zo?cn.imageAtlas.patternPositions.get(Zo.scaleSelf(ke).toString()):null;Ji=!!ga&&!!Ma,ga&&Wi.setConstantPatternPositions(ga,Ma)}Pt>0&&(Ji||Wi.getPatternTransitionVertexBuffer("line-pattern"))&&Wn.push("LINE_PATTERN_TRANSITION");const va=p.isTileAffectedByFog(An),ei=p.getOrCreateProgram(pr,{config:Wi,defines:Wn,overrideFog:va});if(!tt&&ct&&Xe&&cn.lineAtlas){const Ki=cn.lineAtlas.getDash(ct,Xe);Ki&&Wi.setConstantPatternPositions(Ki)}ji&&hi.setupShadows(cn.tileID.toUnwrapped(),ei,"vector-tile");let[qi,Ni]=h.paint.get("line-trim-offset");(Xe==="round"||Xe==="square")&&qi!==Ni&&(qi===0&&(qi-=1),Ni===1&&(Ni+=1));const na=Ce?An.projMatrix:null,In=Q?1/Ln.tileToMeter/a.aw(cn,1,p.transform.zoom):1,Aa=Q?1/Ln.tileToMeter/a.aw(cn,1,Math.floor(p.transform.zoom)):1,ea=tt?a.d_(p,cn,h,na,ke,In,Aa,[qi,Ni],Hn,Pt):a.d$(p,cn,h,na,Ln.lineClipsArray.length,ke,In,Aa,[qi,Ni],Hn);if(or){const Ki=Ln.gradients[h.id];let ia=Ki.texture;if(h.gradientVersion!==Ki.version){let ga=256;if(h.stepInterpolant){const Zo=o.getSource().maxzoom,Ma=An.canonical.z===Zo?Math.ceil(1<<p.transform.maxZoom-An.canonical.z):1;ga=a.ay(a.e0(Ln.maxLineLength/a.aj*1024*Ma),256,K.maxTextureSize)}Ki.gradient=a.e1({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:ga,image:Ki.gradient||void 0,clips:Ln.lineClipsArray}),Ki.texture?Ki.texture.update(Ki.gradient):Ki.texture=new a.T(K,Ki.gradient,ee.RGBA8),Ki.version=h.gradientVersion,ia=Ki.texture}K.activeTexture.set(ee.TEXTURE1),ia.bind(h.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}$e&&(K.activeTexture.set(ee.TEXTURE0),cn.lineAtlasTexture&&cn.lineAtlasTexture.bind(ee.LINEAR,ee.REPEAT),Wi.updatePaintBuffers()),tt&&(K.activeTexture.set(ee.TEXTURE0),cn.imageAtlasTexture&&cn.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),Wi.updatePaintBuffers()),dn&&!V&&p.terrain.setupElevationDraw(cn,ei),p.uploadCommonUniforms(K,ei,An.toUnwrapped());const io=Ki=>{ht!=null&&(ht.value=Jt*F),ei.draw(p,ee.TRIANGLES,Br,Ki,fe,xn.disabled,ea,h.id,Ln.layoutVertexBuffer,Ln.indexBuffer,Ln.segments,h.paint,p.transform.zoom,Wi,[Ln.layoutVertexBuffer2,Ln.patternVertexBuffer,Ln.zOffsetVertexBuffer]),ht!=null&&(ht.value=Jt)};if(kt&&!dn){const Ki=p.stencilModeForClipping(An).ref;Ki===0&&Ce&&K.clear({stencil:0});const ia={func:ee.EQUAL,mask:255};ea.u_alpha_discard_threshold=.8,io(new bn(ia,Ki,255,ee.KEEP,ee.KEEP,ee.INVERT)),ea.u_alpha_discard_threshold=0,io(new bn(ia,Ki,255,ee.KEEP,ee.KEEP,ee.KEEP))}else ea.u_alpha_discard_threshold=kt&&dn&&Wr?.8:0,io(dn?ln:p.stencilModeForClipping(An))}};let Ot=p.depthModeForSublayer(0,Rr.ReadOnly);const fr=new Rr(p.depthOcclusion?ee.GREATER:ee.LEQUAL,Rr.ReadOnly,p.depthRangeFor3D);if(h.hasNonElevatedBuckets){const Ar=!Ce&&p.terrain;F!==0&&Ar?a.w(`Occlusion opacity for layer ${h.id} is supported on terrain only if the layer has line-z-offset enabled.`):Ar?a.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${h.id}.`):zt(m,It,Ot,bn.disabled,!1,!0)}if(h.hasElevatedBuckets){D==="hd-road-markup"?Z||(Ot=fr,It.push("ELEVATED_ROADS")):(It.push("ELEVATED"),Ot=fr,le&&It.push(Ae?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),V&&It.push("ELEVATION_REFERENCE_SEA"));const Ar=kt?p.stencilModeFor3D():bn.disabled;p.forceTerrainMode=!0,zt(m,It,Ot,Ar,!0,!0),kt&&zt(m,It,Ot,Ar,!0,!1),p.forceTerrainMode=!1}kt&&(p.resetStencilClippingMasks(),Ce&&K.clear({stencil:0})),F===0||p.depthOcclusion||Ce||p.layersWithOcclusionOpacity.push(p.currentLayer)},fill:function(p,o,h,m){const w=h.paint.get("fill-color"),E=h.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const S=h.paint.get("fill-emissive-strength"),F=p.colorModeForDrapableLayerRenderPass(S),D=h.paint.get("fill-pattern"),Q=p.opaquePassEnabledForLayer()&&!D.constantOr(1)&&w.constantOr(a.am.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";let V="none";h.layout.get("fill-elevation-reference")!=="none"?V="road":h.paint.get("fill-z-offset").constantOr(1)!==0&&(V="offset");const Z=!(!p.terrain||!p.terrain.enabled),K={painter:p,sourceCache:o,layer:h,coords:m,colorMode:F,elevationType:V,terrainEnabled:Z,pass:Q};if(p.renderPass!=="shadow")if(V!=="offset"){if(co(K,!1),V==="road"){const ee=!Z&&p.renderPass==="translucent";ee&&Mr(p,o,h,m,"geometry"),co(K,!0,bn.disabled),ee&&function(he){const{painter:le,sourceCache:Ae,layer:fe,coords:Ce,colorMode:ke}=he,He=le.context.gl,$e=he.painter.shadowRenderer,it=!!$e&&$e.enabled,ct=new Rr(le.context.gl.LEQUAL,Rr.ReadOnly,le.depthRangeFor3D);let Xe=[0,0,0];if(it){const tt=le.style.directionalLight,Pt=le.style.ambientLight;tt&&Pt&&(Xe=oc(le.style,tt,Pt))}const Ye=tt=>{for(const Pt of Ce){const gt=Ae.getTile(Pt),Jt=gt.getBucket(fe);if(!Jt)continue;const kt=Jt.elevatedStructures;if(!kt)continue;let or,pr;if(tt?(or=kt.renderableBridgeSegments,pr=kt.bridgeProgramConfigurations.get(fe.id)):(or=kt.renderableTunnelSegments,pr=kt.tunnelProgramConfigurations.get(fe.id)),!or||or.segments[0].primitiveLength===0)continue;pr.updatePaintBuffers(),le.prepareDrawTile();const It=le.isTileAffectedByFog(Pt),ht=[];it&&ht.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const zt=le.getOrCreateProgram("elevatedStructures",{config:pr,overrideFog:It,defines:ht}),Ot=le.translatePosMatrix(Pt.projMatrix,gt,fe.paint.get("fill-translate"),fe.paint.get("fill-translate-anchor"));it&&$e.setupShadows(gt.tileID.toUnwrapped(),zt,"vector-tile");const fr=vt(Ot,Xe);le.uploadCommonUniforms(le.context,zt,Pt.toUnwrapped()),zt.draw(le,He.TRIANGLES,ct,bn.disabled,ke,xn.backCCW,fr,fe.id,kt.vertexBuffer,kt.indexBuffer,or,fe.paint,le.transform.zoom,pr,[kt.vertexBufferNormal])}};Ye(!0),Ye(!1)}(K)}}else co(K,!1,p.stencilModeFor3D());else p.shadowRenderer&&V==="road"&&!Z&&function(ee){const{painter:he,sourceCache:le,layer:Ae,coords:fe}=ee,Ce=he.context.gl,ke=ee.painter.shadowRenderer;for(const He of fe){const $e=le.getTile(He),it=$e.getBucket(Ae);if(!it)continue;const ct=it.elevatedStructures;if(!ct||!ct.shadowCasterSegments||ct.shadowCasterSegments.segments[0].primitiveLength===0)continue;he.prepareDrawTile();const Xe=it.bufferData.programConfigurations.get(Ae.id),Ye=he.isTileAffectedByFog(He),tt=he.getOrCreateProgram("elevatedStructuresDepth",{config:Xe,overrideFog:Ye}),Pt=ke.calculateShadowPassMatrixFromTile($e.tileID.toUnwrapped());he.uploadCommonUniforms(he.context,tt,He.toUnwrapped());const gt={u_matrix:Pt,u_depth_bias:0};tt.draw(he,Ce.TRIANGLES,ke.getShadowPassDepthMode(),bn.disabled,ke.getShadowPassColorMode(),xn.disabled,gt,Ae.id,ct.vertexBuffer,ct.indexBuffer,ct.shadowCasterSegments,Ae.paint,he.transform.zoom,Xe)}}(K)},"fill-extrusion":function(p,o,h,m){const w=h.paint.get("fill-extrusion-opacity"),E=p.context,S=E.gl,F=p.terrain,D=F&&F.renderingToTexture;if(w===0)return;const Q=p.conflationActive&&p.style.isLayerClipped(h,o.getSource()),V=p.style.order.indexOf(h.fqid);if(Q&&function(Z,K,ee,he,le){for(const Ae of he){const fe=K.getTile(Ae).getBucket(ee);fe&&(fe.updateReplacement(Ae,Z.replacementSource,le),fe.uploadCentroid(Z.context))}}(p,o,h,m,V),F||Q)for(const Z of m){const K=o.getTile(Z).getBucket(h);K&&hn(p.context,o,Z,K,h,F,Q)}if(p.renderPass==="shadow"&&p.shadowRenderer){const Z=p.shadowRenderer;if(F&&w<.65&&h._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.ab)return;const K=Z.getShadowPassDepthMode(),ee=Z.getShadowPassColorMode();ns(p,o,h,m,K,bn.disabled,ee,Q)}else if(p.renderPass==="translucent"){const Z=!h.paint.get("fill-extrusion-pattern").constantOr(1),K=h.paint.get("fill-extrusion-color").constantOr(a.am.white);if(!D&&K.a!==0){const ee=new Rr(p.context.gl.LEQUAL,Rr.ReadWrite,p.depthRangeFor3D);w===1&&Z?ns(p,o,h,m,ee,bn.disabled,Xn.unblended,Q):(ns(p,o,h,m,ee,bn.disabled,Xn.disabled,Q),ns(p,o,h,m,ee,p.stencilModeFor3D(),p.colorModeForRenderPass(),Q),p.resetStencilClippingMasks())}if(p.style.enable3dLights()&&Z&&(!F&&p.transform.projection.name!=="globe"||D)){const ee=h.paint.get("fill-extrusion-opacity"),he=h.paint.get("fill-extrusion-ambient-occlusion-intensity"),le=h.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Ae=h.paint.get("fill-extrusion-flood-light-intensity"),fe=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ce=h.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(fe?null:h.lut).toArray01().slice(0,3),ke=he>0&&le>0,He=Ae>0,$e=(Xe,Ye,tt)=>(1-tt)*Xe+tt*Ye,it=new qo;it.translate=h.paint.get("fill-extrusion-translate"),it.translateAnchor=h.paint.get("fill-extrusion-translate-anchor"),it.edgeRadius=h.layout.get("fill-extrusion-edge-radius"),it.cutoffFadeRange=h.paint.get("fill-extrusion-cutoff-fade-range");const ct=Xe=>{const Ye=p.depthModeForSublayer(1,Rr.ReadOnly,S.LEQUAL,!0),tt=h.paint.get(Xe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Pt=$e(.1,3,tt),gt=p._showOverdrawInspector;if(!gt){const Jt=new bn({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),kt=new Xn([S.ONE,S.ONE,S.ONE,S.ONE],a.am.transparent,[!1,!1,!1,!0],S.MIN);bo(it,p,o,h,m,Ye,Jt,kt,xn.disabled,Xe,"sdf",ee,he,le,Ae,Ce,Pt,Q,!1)}{const Jt=gt?bn.disabled:new bn({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),kt=gt?p.colorModeForRenderPass():new Xn([S.ONE_MINUS_DST_ALPHA,S.DST_ALPHA,S.ONE,S.ONE],a.am.transparent,[!0,!0,!0,!0]);bo(it,p,o,h,m,Ye,Jt,kt,xn.disabled,Xe,"color",ee,he,le,Ae,Ce,Pt,Q,!1)}};if(D){const Xe=(Ye,tt,Pt)=>{const gt=p.depthModeForSublayer(1,Rr.ReadOnly,S.LEQUAL,!1),Jt=h.paint.get(Ye?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),kt=$e(.1,3,Jt);{const or=new Xn([S.ONE,S.ONE,S.ONE,S.ONE],a.am.transparent,[!1,!1,!1,!0]);bo(it,p,o,h,m,gt,bn.disabled,or,xn.disabled,Ye,"clear",ee,he,le,Ae,Ce,kt,Q,tt)}{const or=new bn({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),pr=new Xn([S.ONE,S.ONE,S.ONE,S.ONE],a.am.transparent,[!1,!1,!1,!0],S.MIN);bo(it,p,o,h,m,gt,or,pr,xn.disabled,Ye,"sdf",ee,he,le,Ae,Ce,kt,Q,tt)}{const or=Ye?S.ZERO:S.ONE_MINUS_DST_ALPHA,pr=new bn({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),It=new Xn([or,S.DST_ALPHA,S.ONE_MINUS_DST_ALPHA,S.ZERO],a.am.transparent,[!0,!0,!0,!0]);bo(it,p,o,h,m,gt,pr,It,xn.disabled,Ye,"color",ee,he,le,Ae,Ce,kt,Q,tt)}{const or=new Xn([S.ONE,S.ONE,S.ONE,Ye?S.ZERO:S.ONE],a.am.transparent,[!1,!1,!1,!0],Ye?S.FUNC_ADD:S.MAX);bo(it,p,o,h,m,gt,bn.disabled,or,xn.disabled,Ye,"clear",ee,he,le,Ae,Ce,kt,Q,tt,Pt)}};if(ke||He){let Ye;if(p.prepareDrawTile(),F){const tt=F.drapeBufferSize[0],Pt=F.drapeBufferSize[1];Ye=F.framebufferCopyTexture,Ye&&(!Ye||Ye.size[0]===tt&&Ye.size[1]===Pt)||(Ye&&Ye.destroy(),Ye=F.framebufferCopyTexture=new a.T(E,new a.r({width:tt,height:Pt}),S.RGBA8)),Ye.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.copyTexSubImage2D(S.TEXTURE_2D,0,0,0,0,0,tt,Pt)}ke&&Xe(!0,!1,Ye),He&&Xe(!1,!0,Ye)}}else ke&&ct(!0),He&&ct(!1),(ke||He)&&p.resetStencilClippingMasks()}}},building:function(p,o,h,m){p.currentLayer<p.firstLightBeamLayer&&(p.firstLightBeamLayer=p.currentLayer);const w=h.paint.get("building-ambient-occlusion-ground-intensity"),E=h.paint.get("building-ambient-occlusion-ground-radius"),S=h.paint.get("building-ambient-occlusion-ground-attenuation");let F=w>0&&E>0,D=!0;const Q=h.paint.get("building-vertical-scale");Q<1&&(D=!1);const V=p.conflationActive&&p.style.isLayerClipped(h,o.getSource()),Z=p.style.order.indexOf(h.fqid);if(function(K,ee,he,le,Ae,fe){for(const Ce of fe){const ke=ee.getTile(Ce).getBucket(he);ke&&(Ae&&ke.updateReplacement(Ce,K.replacementSource,le),ke.uploadUpdatedIndexBuffer(K.context))}}(p,o,h,Z,V,m),function(K,ee,he,le){for(const Ae of le){const fe=ee.getTile(Ae).getBucket(he);fe&&fe.needsEvaluation(K,he)&&(fe.evaluate(he),fe.uploadUpdatedColorBuffer(K.context))}}(p,o,h,m),h.resetLayerRenderingStats(p),p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0),p.renderPass==="shadow"&&p.shadowRenderer){const K=p.shadowRenderer,ee=[],he=K.getShadowPassDepthMode();cc({painter:p,source:o,layer:h,coords:m,defines:ee,blendMode:K.getShadowPassColorMode(),depthMode:he,verticalScale:Q})}else if(p.renderPass==="translucent"){F&&function(le,Ae,fe,Ce,ke,He,$e,it,ct,Xe,Ye,tt,Pt){const gt=le.context.gl,Jt=le.depthModeForSublayer(1,Rr.ReadOnly,gt.LEQUAL,!0),kt=.1*(1-(or=Ye))+3*or;var or;const pr=le._showOverdrawInspector,It=tt,ht=new qo;pr||bo(ht,le,Ae,fe,Ce,Jt,new bn({func:gt.ALWAYS,mask:255},255,255,gt.KEEP,gt.KEEP,gt.REPLACE),new Xn([gt.ONE,gt.ONE,gt.ONE,gt.ONE],a.am.transparent,[!1,!1,!1,!0],gt.MIN),xn.disabled,ke,"sdf",1,$e,it,0,Xe,kt,It,!1);{const zt=pr?bn.disabled:new bn({func:gt.EQUAL,mask:255},255,255,gt.KEEP,gt.DECR,gt.DECR),Ot=pr?le.colorModeForRenderPass():new Xn([gt.ONE_MINUS_DST_ALPHA,gt.DST_ALPHA,gt.ONE,gt.ONE],a.am.transparent,[!0,!0,!0,!0]);bo(ht,le,Ae,fe,Ce,Jt,zt,Ot,xn.disabled,ke,"color",1,$e,it,0,Xe,kt,It,!1)}}(p,o,h,m,!0,0,w,E,0,[0,0,0],S,V);let K=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];D&&(K=K.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),p.shadowRenderer.useNormalOffset&&(K=K.concat("NORMAL_OFFSET"));const ee=new Rr(p.context.gl.LEQUAL,Rr.ReadWrite,p.depthRangeFor3D),he=p.colorModeForRenderPass();cc({painter:p,source:o,layer:h,coords:m,defines:K,blendMode:he,depthMode:ee,verticalScale:Q})}else if(p.renderPass==="light-beam"){const K=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],ee=new Rr(p.context.gl.LEQUAL,Rr.ReadOnly,p.depthRangeFor3D);cc({painter:p,source:o,layer:h,coords:m,defines:K,blendMode:Xn.alphaBlended,depthMode:ee,verticalScale:Q})}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1),p.resetStencilClippingMasks()},hillshade:function(p,o,h,m){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent"||p.style.disableElevatedTerrain)return;const w=p.context,E=p.terrain&&p.terrain.renderingToTexture,[S,F]=p.renderPass!=="translucent"||E?[{},m]:p.stencilConfigForOverlap(m);for(const D of F){const Q=o.getTile(D);if(Q.needsHillshadePrepare&&p.renderPass==="offscreen")PA(p,Q,h);else if(p.renderPass==="translucent"){const V=p.depthModeForSublayer(0,Rr.ReadOnly),Z=h.paint.get("hillshade-emissive-strength"),K=p.colorModeForDrapableLayerRenderPass(Z),ee=E&&p.terrain?p.terrain.stencilModeForRTTOverlap(D):S[D.overscaledZ];Sm(p,D,Q,h,V,ee,K)}}w.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,o,h,m,w,E){if(p.renderPass!=="translucent"||h.paint.get("raster-opacity")===0)return;const S=p.transform.projection.name==="globe",F=h.paint.get("raster-elevation")!==0,D=F&&S;if(p.renderElevatedRasterBackface&&!D)return;const Q=p.context,V=Q.gl,Z=o.getSource(),K=function(it,ct,Xe,Ye){const tt=ct.paint.get("raster-color"),Pt=it.type==="raster-array",gt=[],Jt=ct.paint.get("raster-resampling"),kt=ct.paint.get("raster-color-mix");let or=ct.paint.get("raster-color-range");const pr=[kt[0],kt[1],kt[2],0],It=kt[3];let ht=Jt==="nearest"?Ye.NEAREST:Ye.LINEAR;if(Pt&&(gt.push("RASTER_ARRAY"),tt||gt.push("RASTER_COLOR"),Jt==="linear"&&gt.push("RASTER_ARRAY_LINEAR"),ht=Ye.NEAREST,!or&&it.rasterLayers)){const zt=it.rasterLayers.find(({id:Ot})=>Ot===ct.sourceLayer);zt&&zt.fields&&zt.fields.range&&(or=zt.fields.range)}if(or=or||[0,1],tt){gt.push("RASTER_COLOR"),Xe.activeTexture.set(Ye.TEXTURE2),ct.updateColorRamp(or);let zt=ct.colorRampTexture;zt||(zt=ct.colorRampTexture=new a.T(Xe,ct.colorRamp,Ye.RGBA8)),zt.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE)}return{mix:pr,range:or,offset:It,defines:gt,resampling:ht}}(Z,h,Q,V);if(Z instanceof a.aP&&!m.length&&!S)return;const ee=h.paint.get("raster-emissive-strength"),he=p.colorModeForDrapableLayerRenderPass(ee),le=p.terrain&&p.terrain.renderingToTexture,Ae=!p.options.moving,fe=h.paint.get("raster-resampling")==="nearest"?V.NEAREST:V.LINEAR;if(Z instanceof a.aP&&!m.length&&(Z.onNorthPole||Z.onSouthPole)){const it=F?p.stencilModeFor3D():bn.disabled;return void Ls(!!Z.onNorthPole,null,p,o,h,ee,K,xn.disabled,it)}if(!m.length)return;const[Ce,ke]=Z instanceof a.aP||le?[{},m]:p.stencilConfigForOverlap(m),He=ke[ke.length-1].overscaledZ;D&&K.defines.push("PROJECTION_GLOBE_VIEW"),F&&K.defines.push("RENDER_CUTOFF");const $e=(it,ct,Xe)=>{for(const Ye of it){const tt=Ye.toUnwrapped(),Pt=o.getTile(Ye);if(le&&(!Pt||!Pt.hasData()))continue;Q.activeTexture.set(V.TEXTURE0);const gt=bf(Pt,Z,h,K);if(!gt||!gt.texture)continue;const{texture:Jt,mix:kt,offset:or,tileSize:pr,buffer:It}=gt;let ht,zt;le?(ht=Rr.disabled,zt=Ye.projMatrix):F?(ht=new Rr(V.LEQUAL,Rr.ReadWrite,p.depthRangeFor3D),zt=S?Float32Array.from(p.transform.expandedFarZProjMatrix):p.transform.calculateProjMatrix(tt,Ae)):(ht=p.depthModeForSublayer(Ye.overscaledZ-He,h.paint.get("raster-opacity")===1?Rr.ReadWrite:Rr.ReadOnly,V.LESS),zt=p.transform.calculateProjMatrix(tt,Ae));const Ot=p.terrain&&le?p.terrain.stencilModeForRTTOverlap(Ye):Ce[Ye.overscaledZ],fr=E?0:h.paint.get("raster-fade-duration");Pt.registerFadeDuration(fr);const Ar=o.findLoadedParent(Ye,0),yr=Fs(Pt,Ar,o,p.transform,fr);let Br,ln;p.terrain&&p.terrain.prepareDrawTile(),Q.activeTexture.set(V.TEXTURE0),Jt.bind(fe,V.CLAMP_TO_EDGE),Q.activeTexture.set(V.TEXTURE1),Ar?(Ar.texture&&Ar.texture.bind(fe,V.CLAMP_TO_EDGE),Br=Math.pow(2,Ar.tileID.overscaledZ-Pt.tileID.overscaledZ),ln=[Pt.tileID.canonical.x*Br%1,Pt.tileID.canonical.y*Br%1]):Jt.bind(fe,V.CLAMP_TO_EDGE),"useMipmap"in Jt&&Q.extTextureFilterAnisotropic&&p.transform.pitch>20&&V.texParameterf(V.TEXTURE_2D,Q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Q.extTextureFilterAnisotropicMax);const dn=p.transform;let Wr;const An=F?Ms(dn):[0,0,0,0];let cn,Ln,Wn,hi,ji,Hn=0;if(D&&Z instanceof a.aP&&Z.coordinates.length>3)cn=Float32Array.from(a.bh(a.dD(new a.cA(0,0,0)))),Ln=Float32Array.from(dn.globeMatrix),Wn=Float32Array.from(a.dz(dn)),hi=[a.aD(dn.center.lng),a.aH(dn.center.lat)],Wr=Z.elevatedGlobePerspectiveTransform,ji=Z.elevatedGlobeGridMatrix||new Float32Array(9);else if(D){const ei=a.dA(Ye.canonical);Hn=a.dB(ei.getCenter().lat),cn=Float32Array.from(a.bh(a.dD(Ye.canonical))),Ln=Float32Array.from(dn.globeMatrix),Wn=Float32Array.from(a.dz(dn)),hi=[a.aD(dn.center.lng),a.aH(dn.center.lat)],Wr=[0,0],ji=Float32Array.from(a.dC(Ye.canonical,ei,Hn,dn.worldSize/dn._pixelsPerMercatorPixel))}else Wr=Z instanceof a.aP?Z.perspectiveTransform:[0,0],cn=new Float32Array(16),Ln=new Float32Array(9),Wn=new Float32Array(16),hi=[0,0],ji=new Float32Array(9);const Wi=rn(zt,cn,Ln,Wn,ji,ln||[0,0],a.ah(p.transform.zoom),hi,An,Br||1,yr,h,Wr,F?h.paint.get("raster-elevation"):0,2,kt,or,K.range,pr,It,ee),Ji=p.isTileAffectedByFog(Ye),va=p.getOrCreateProgram("raster",{defines:K.defines,overrideFog:Ji});if(p.uploadCommonUniforms(Q,va,tt),Z instanceof a.aP){const ei=Z.elevatedGlobeVertexBuffer,qi=Z.elevatedGlobeIndexBuffer;if(le||!S)Z.boundsBuffer&&Z.boundsSegments&&va.draw(p,V.TRIANGLES,ht,bn.disabled,he,xn.disabled,Wi,h.id,Z.boundsBuffer,p.quadTriangleIndexBuffer,Z.boundsSegments);else if(ei&&qi){const Ni=dn.zoom<=a.cX?Z.elevatedGlobeSegments:Z.getSegmentsForLongitude(dn.center.lng);Ni&&va.draw(p,V.TRIANGLES,ht,bn.disabled,he,ct,Wi,h.id,ei,qi,Ni)}}else if(D){ht=new Rr(V.LEQUAL,Rr.ReadOnly,p.depthRangeFor3D);const ei=p.globeSharedBuffers;if(ei){const[qi,Ni,na]=ei.getGridBuffers(Hn,!1);va.draw(p,V.TRIANGLES,ht,Xe||Ot,p.colorModeForRenderPass(),ct,Wi,h.id,qi,Ni,na)}}else{const{tileBoundsBuffer:ei,tileBoundsIndexBuffer:qi,tileBoundsSegments:Ni}=p.getTileBoundsBuffers(Pt);va.draw(p,V.TRIANGLES,ht,Ot,he,xn.disabled,Wi,h.id,ei,qi,Ni)}}if(!(Z instanceof a.aP)&&D)for(const Ye of it){const tt=Ye.canonical.y===(1<<Ye.canonical.z)-1;Ye.canonical.y===0&&Ls(!0,Ye,p,o,h,ee,K,ct,Xe||bn.disabled),tt&&Ls(!1,Ye,p,o,h,ee,K,ct===xn.frontCW?xn.backCW:xn.frontCW,Xe||bn.disabled)}};D?$e(ke,p.renderElevatedRasterBackface?xn.backCW:xn.frontCW,p.stencilModeFor3D()):$e(ke,xn.disabled,void 0),p.resetStencilClippingMasks()},"raster-particle":function(p,o,h,m,w,E){p.renderPass==="offscreen"&&function(S,F,D,Q){if(!Q.length)return;const V=S.context,Z=V.gl,K=F.getSource();if(!(K instanceof Co))return;const ee=Math.ceil(Math.sqrt(D.paint.get("raster-particle-count")));let he=D.particlePositionRGBAImage;if(!he||he.width!==ee){const ke=function(He){const $e=He*He,it=new Uint8Array(4*$e),ct=function(Ye){return Ye|=0,Ye=Math.imul(2747636419^Ye,2654435769),Ye=Math.imul(Ye^Ye>>>16,2654435769),((Ye=Math.imul(Ye^Ye>>>16,2654435769))>>>0)/4294967296},Xe=1/1.1;for(let Ye=0;Ye<$e;Ye++){const tt=Xe*(ct(2*Ye+0)+Qn),Pt=Xe*(ct(2*Ye+1)+Qn),gt=255*tt%1,Jt=255*Pt%1,kt=gt,or=Pt-Jt/255,pr=Jt;it[4*Ye+0]=255*(tt-gt/255),it[4*Ye+1]=255*kt,it[4*Ye+2]=255*or,it[4*Ye+3]=255*pr}return it}(ee);he=D.particlePositionRGBAImage=new a.r({width:ee,height:ee},ke)}let le=D.particleFramebuffer;le?le.width!==ee&&(le.destroy(),le=D.particleFramebuffer=V.createFramebuffer(ee,ee,!0,null)):le=D.particleFramebuffer=V.createFramebuffer(ee,ee,!0,null);const Ae=[];for(const ke of Q){const He=F.getTile(ke);if(!(He instanceof zh))continue;const $e=$o(He,K,D);if(!$e)continue;const it=[He.tileSize,He.tileSize];let ct=D.tileFramebuffer;ct||(ct=D.tileFramebuffer=V.createFramebuffer(it[0],it[1],!0,null));let Xe=He.rasterParticleState;Xe||(Xe=He.rasterParticleState=new Ef(V,ke,it,he));const Ye=Xe.update(D.lastInvalidatedAt);Xe.particleTextureDimension!==ee&&Xe.updateParticleTexture(ke,he);const tt=Xe.targetColorTexture;Xe.targetColorTexture=Xe.backgroundColorTexture,Xe.backgroundColorTexture=tt;const Pt=Xe.particleTexture0;Xe.particleTexture0=Xe.particleTexture1,Xe.particleTexture1=Pt,Ae.push([ke,$e,Xe,Ye])}if(Ae.length===0)return;const fe=a.q.now(),Ce=D.previousDrawTimestamp?.001*(fe-D.previousDrawTimestamp):.0167;if(D.previousDrawTimestamp=fe,D.hasColorMap()){V.activeTexture.set(Z.TEXTURE0+2);let ke=D.colorRampTexture;ke||(ke=D.colorRampTexture=new a.T(V,D.colorRamp,Z.RGBA8)),ke.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}V.bindFramebuffer.set(D.tileFramebuffer.framebuffer),function(ke,He,$e){const it=ke.context,ct=it.gl,Xe=He.tileFramebuffer;it.activeTexture.set(ct.TEXTURE0);const Ye={u_texture:0,u_opacity:1.05*(Pt=He.paint.get("raster-particle-fade-opacity-factor"))/(Pt+.05)},tt=ke.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Pt;for(const gt of $e){const[,,Jt,kt]=gt;Xe.colorAttachment.set(Jt.targetColorTexture.texture),it.viewport.set([0,0,Xe.width,Xe.height]),it.clear({color:a.am.transparent}),kt&&(Jt.backgroundColorTexture.bind(ct.NEAREST,ct.CLAMP_TO_EDGE),tt.draw(ke,ct.TRIANGLES,Rr.disabled,bn.disabled,Xn.alphaBlended,xn.disabled,Ye,He.id,ke.viewportBuffer,ke.quadTriangleIndexBuffer,ke.viewportSegments))}}(S,D,Ae),function(ke,He,$e,it){const ct=ke.context,Xe=ct.gl,Ye=$e.tileFramebuffer,tt=ke.transform.projection.name==="globe",Pt=$e.paint.get("raster-particle-max-speed");for(const gt of it){const[Jt,kt,or]=gt;ct.activeTexture.set(Xe.TEXTURE0+0),kt.texture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE),Ye.colorAttachment.set(or.targetColorTexture.texture);const pr=ke.getOrCreateProgram("rasterParticleDraw",{defines:kt.defines,overrideFog:!1});ct.activeTexture.set(Xe.TEXTURE0+1);const It=kt.scalarData?[]:[0,1,2,3].map(Ot=>a.e3[Ot](Jt));It.push(Jt);const ht=Jt.canonical.x,zt=Jt.canonical.y;for(const Ot of It){const fr=He.getTile(tt?Ot.wrapped():Ot);if(!fr)continue;const Ar=fr.rasterParticleState;if(!Ar)continue;const yr=Ot.canonical.x+(1<<Ot.canonical.z)*(Ot.wrap-Jt.wrap),Br=Ot.canonical.y;Ar.particleTexture0.bind(Xe.NEAREST,Xe.CLAMP_TO_EDGE);const ln=si(1,Ar.particleTexture0.size[0],[yr-ht,Br-zt],0,kt.texture.size,2,Pt,kt.textureOffset,kt.scale,kt.offset);pr.draw(ke,Xe.POINTS,Rr.disabled,bn.disabled,Xn.alphaBlended,xn.disabled,ln,$e.id,Ar.particleIndexBuffer,void 0,Ar.particleSegment)}}}(S,F,D,Ae),V.bindFramebuffer.set(D.particleFramebuffer.framebuffer),function(ke,He,$e,it){const ct=ke.context,Xe=ct.gl,Ye=He.paint.get("raster-particle-max-speed"),tt=it*He.paint.get("raster-particle-speed-factor")*.15,Pt=function(Jt){return Math.pow(Jt,6)}(.01+1*He.paint.get("raster-particle-reset-rate-factor")),gt=He.particleFramebuffer;ct.viewport.set([0,0,gt.width,gt.height]);for(const Jt of $e){const[,kt,or]=Jt;ct.activeTexture.set(Xe.TEXTURE0+0),kt.texture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE),ct.activeTexture.set(Xe.TEXTURE0+1);const pr=or.particleTexture0;pr.bind(Xe.NEAREST,Xe.CLAMP_TO_EDGE);const It=Fa(1,pr.size[0],0,kt.texture.size,Ye,tt,Pt,kt.textureOffset,kt.scale,kt.offset);gt.colorAttachment.set(or.particleTexture1.texture),ct.clear({color:a.am.transparent}),ke.getOrCreateProgram("rasterParticleUpdate",{defines:kt.defines}).draw(ke,Xe.TRIANGLES,Rr.disabled,bn.disabled,Xn.unblended,xn.disabled,It,He.id,ke.viewportBuffer,ke.quadTriangleIndexBuffer,ke.viewportSegments)}}(S,D,Ae,Ce)}(p,o,h,m),p.renderPass==="translucent"&&(function(S,F,D,Q,V){const Z=S.context,K=Z.gl,ee=F.getSource().tileSize,he=5*(1-a.af(a.cI,a.cI+1,S.transform.zoom))*ee+D.paint.get("raster-particle-elevation"),le=!S.options.moving,Ae=S.transform.projection.name==="globe";if(!Q.length)return;const[fe,Ce]=S.stencilConfigForOverlap(Q),ke=[];Ae&&ke.push("PROJECTION_GLOBE_VIEW");const He=S.stencilModeFor3D();for(const $e of Ce){const it=$e.toUnwrapped(),ct=F.getTile($e);if(!ct.rasterParticleState)continue;const Xe=ct.rasterParticleState,Ye=100;ct.registerFadeDuration(Ye);const tt=F.findLoadedParent($e,0),Pt=Fs(ct,tt,F,S.transform,Ye);let gt,Jt;S.terrain&&S.terrain.prepareDrawTile(),Z.activeTexture.set(K.TEXTURE0),Xe.targetColorTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Z.activeTexture.set(K.TEXTURE1),tt&&tt.rasterParticleState?(tt.rasterParticleState.targetColorTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),gt=Math.pow(2,tt.tileID.overscaledZ-ct.tileID.overscaledZ),Jt=[ct.tileID.canonical.x*gt%1,ct.tileID.canonical.y*gt%1]):Xe.targetColorTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE);const kt=Ae?Float32Array.from(S.transform.expandedFarZProjMatrix):S.transform.calculateProjMatrix(it,le),or=S.transform,pr=Wh(or),It=a.dA($e.canonical),ht=a.dB(It.getCenter().lat);let zt,Ot,fr,Ar,yr;Ae?(zt=Float32Array.from(a.bh(a.dD($e.canonical))),Ot=Float32Array.from(or.globeMatrix),fr=Float32Array.from(a.dz(or)),Ar=[a.aD(or.center.lng),a.aH(or.center.lat)],yr=Float32Array.from(a.dC($e.canonical,It,ht,or.worldSize/or._pixelsPerMercatorPixel))):(zt=new Float32Array(16),Ot=new Float32Array(9),fr=new Float32Array(16),Ar=[0,0],yr=new Float32Array(9));const Br=ra(kt,zt,Ot,fr,yr,Jt||[0,0],a.ah(S.transform.zoom),Ar,pr,gt||1,Pt,he),ln=S.isTileAffectedByFog($e),dn=S.getOrCreateProgram("rasterParticle",{defines:ke,overrideFog:ln});if(S.uploadCommonUniforms(Z,dn,it),Ae){const Wr=new Rr(K.LEQUAL,Rr.ReadOnly,S.depthRangeFor3D),An=0,cn=S.globeSharedBuffers;if(cn){const[Ln,Wn,hi]=cn.getGridBuffers(ht,An!==0);dn.draw(S,K.TRIANGLES,Wr,He,Xn.alphaBlended,S.renderElevatedRasterBackface?xn.frontCCW:xn.backCCW,Br,D.id,Ln,Wn,hi)}}else{const Wr=S.depthModeForSublayer(0,Rr.ReadOnly),An=fe[$e.overscaledZ],{tileBoundsBuffer:cn,tileBoundsIndexBuffer:Ln,tileBoundsSegments:Wn}=S.getTileBoundsBuffers(ct);dn.draw(S,K.TRIANGLES,Wr,An,Xn.alphaBlended,xn.disabled,Br,D.id,cn,Ln,Wn)}}S.resetStencilClippingMasks()}(p,o,h,m),p.style.map.triggerRepaint())},background:function(p,o,h,m){const w=h.paint.get("background-color"),E=h.paint.get("background-color-use-theme").constantOr("default")==="none",S=h.paint.get("background-opacity"),F=h.paint.get("background-emissive-strength"),D=h.paint.get("background-pitch-alignment")==="viewport";if(S===0)return;const Q=p.context,V=Q.gl,Z=p.transform,K=Z.tileSize,ee=h.paint.get("background-pattern");let he;if(ee!==void 0&&(ee===null||(he=p.imageManager.getPattern(a.I.from(ee.toString()),h.scope,p.style.getLut(h.scope)),!he)))return;const le=!ee&&w.a===1&&S===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==le)return;const Ae=bn.disabled,fe=p.depthModeForSublayer(0,le==="opaque"?Rr.ReadWrite:Rr.ReadOnly),Ce=p.colorModeForDrapableLayerRenderPass(F),ke=ee?"backgroundPattern":"background";let He,$e=m;if($e||(He=p.getBackgroundTiles(),$e=Object.values(He).map(it=>it.tileID)),ee&&(Q.activeTexture.set(V.TEXTURE0),p.imageManager.bind(p.context,h.scope)),D){const it=p.getOrCreateProgram(ke,{overrideFog:!1,overrideRtt:!0}),ct=new Float32Array(a.bx([])),Xe=new a.aM(0,0,0,0,0),Ye=ee?Tn(ct,F,S,p,0,h.scope,he,D,{tileID:Xe,tileSize:K}):Jn(ct,F,S,w.toPremultipliedRenderColor(E?null:h.lut));it.draw(p,V.TRIANGLES,fe,Ae,Ce,xn.disabled,Ye,h.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments)}else for(const it of $e){const ct=p.isTileAffectedByFog(it),Xe=p.getOrCreateProgram(ke,{overrideFog:ct}),Ye=it.toUnwrapped(),tt=m?it.projMatrix:p.transform.calculateProjMatrix(Ye);p.prepareDrawTile();const Pt=o?o.getTile(it):He?He[it.key]:new Ah(it,K,Z.zoom,p),gt=ee?Tn(tt,F,S,p,0,h.scope,he,D,{tileID:it,tileSize:K}):Jn(tt,F,S,w.toPremultipliedRenderColor(E?null:h.lut));p.uploadCommonUniforms(Q,Xe,Ye);const{tileBoundsBuffer:Jt,tileBoundsIndexBuffer:kt,tileBoundsSegments:or}=p.getTileBoundsBuffers(Pt);Xe.draw(p,V.TRIANGLES,fe,Ae,Ce,xn.disabled,gt,h.id,Jt,kt,or)}},sky:function(p,o,h){const m=p._atmosphere?a.ah(p.transform.zoom):1,w=h.paint.get("sky-opacity")*m;if(w===0)return;const E=p.context,S=h.paint.get("sky-type"),F=new Rr(E.gl.LEQUAL,Rr.ReadOnly,[0,1]),D=p.frameCounter/1e3%1;S==="atmosphere"?p.renderPass==="offscreen"?h.needsSkyboxCapture(p)&&(function(Q,V,Z,K){const ee=Q.context,he=ee.gl;let le=V.skyboxFbo;if(!le){le=V.skyboxFbo=ee.createFramebuffer(32,32,!0,null),V.skyboxGeometry=new Tu(ee),V.skyboxTexture=ee.gl.createTexture(),he.bindTexture(he.TEXTURE_CUBE_MAP,V.skyboxTexture),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MAG_FILTER,he.LINEAR);for(let ke=0;ke<6;++ke)he.texImage2D(he.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,he.RGBA,32,32,0,he.RGBA,he.UNSIGNED_BYTE,null)}ee.bindFramebuffer.set(le.framebuffer),ee.viewport.set([0,0,32,32]);const Ae=V.getCenter(Q,!0),fe=Q.getOrCreateProgram("skyboxCapture"),Ce=new Float64Array(16);a.bx(Ce),a.eh(Ce,Ce,.5*-Math.PI),Ju(Q,V,fe,Ce,Ae,0),a.bx(Ce),a.eh(Ce,Ce,.5*Math.PI),Ju(Q,V,fe,Ce,Ae,1),a.bx(Ce),a.cR(Ce,Ce,.5*-Math.PI),Ju(Q,V,fe,Ce,Ae,2),a.bx(Ce),a.cR(Ce,Ce,.5*Math.PI),Ju(Q,V,fe,Ce,Ae,3),a.bx(Ce),Ju(Q,V,fe,Ce,Ae,4),a.bx(Ce),a.eh(Ce,Ce,Math.PI),Ju(Q,V,fe,Ce,Ae,5),ee.viewport.set([0,0,Q.width,Q.height])}(p,h),h.markSkyboxValid(p)):p.renderPass==="sky"&&function(Q,V,Z,K,ee){const he=Q.context,le=he.gl,Ae=Q.transform,fe=Q.getOrCreateProgram("skybox");he.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_CUBE_MAP,V.skyboxTexture);const Ce=((ke,He,$e,it,ct)=>({u_matrix:ke,u_sun_direction:He,u_cubemap:0,u_opacity:it,u_temporal_offset:ct}))(Ae.skyboxMatrix,V.getCenter(Q,!1),0,K,ee);Q.uploadCommonUniforms(he,fe),fe.draw(Q,le.TRIANGLES,Z,bn.disabled,Q.colorModeForRenderPass(),xn.backCW,Ce,"skybox",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(p,h,F,w,D):S==="gradient"&&p.renderPass==="sky"&&function(Q,V,Z,K,ee){const he=Q.context,le=he.gl,Ae=Q.transform,fe=Q.getOrCreateProgram("skyboxGradient");V.skyboxGeometry||(V.skyboxGeometry=new Tu(he)),he.activeTexture.set(le.TEXTURE0);let Ce=V.colorRampTexture;Ce||(Ce=V.colorRampTexture=new a.T(he,V.colorRamp,le.RGBA8)),Ce.bind(le.LINEAR,le.CLAMP_TO_EDGE);const ke=((He,$e,it,ct,Xe)=>({u_matrix:He,u_color_ramp:0,u_center_direction:$e,u_radius:a.al(it),u_opacity:ct,u_temporal_offset:Xe}))(Ae.skyboxMatrix,V.getCenter(Q,!1),V.paint.get("sky-gradient-radius"),K,ee);Q.uploadCommonUniforms(he,fe),fe.draw(Q,le.TRIANGLES,Z,bn.disabled,Q.colorModeForRenderPass(),xn.backCW,ke,"skyboxGradient",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(p,h,F,w,D)},custom:function(p,o,h,m){const w=p.context,E=h.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||p.renderPass==="offscreen")&&h.isDraped(o)){if(p.renderPass==="offscreen"){const S=E.prerender;if(S){if(p.setCustomLayerDefaults(),w.setColorMode(p.colorModeForRenderPass()),p.transform.projection.name==="globe"){const F=p.transform.pointMerc;S.call(E,w.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),a.ah(p.transform.zoom),[F.x,F.y],p.transform.pixelsPerMeterRatio)}else S.call(E,w.gl,p.transform.customLayerMatrix());w.setDirty(),p.setBaseState()}}else if(p.renderPass==="translucent"){if(p.terrain&&p.terrain.renderingToTexture){const F=E.renderToTile;if(F){const D=m[0].canonical,Q={x:D.x+m[0].wrap*(E.wrapTileId?0:1<<D.z),y:D.y,z:D.z};w.setDepthMode(Rr.disabled),w.setStencilMode(bn.disabled),w.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),F.call(E,w.gl,Q),w.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),w.setColorMode(p.colorModeForRenderPass()),w.setStencilMode(bn.disabled);const S=E.renderingMode==="3d"?new Rr(p.context.gl.LEQUAL,Rr.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,Rr.ReadOnly);if(w.setDepthMode(S),p.transform.projection.name==="globe"){const F=p.transform.pointMerc;E.render(w.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),a.ah(p.transform.zoom),[F.x,F.y],p.transform.pixelsPerMeterRatio)}else E.render(w.gl,p.transform.customLayerMatrix());w.setDirty(),p.setBaseState(),w.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(p,o,h,m){if(p.renderPass==="opaque")return;const w=h.paint.get("model-opacity").constantOr(1);if(w===0)return;const E=h.paint.get("model-cast-shadows");if(p.renderPass==="shadow"&&(!E||p.terrain&&w<.65&&h._transitionablePaint._values["model-opacity"].value.expression instanceof a.ab))return;const S=p.shadowRenderer,F=h.paint.get("model-receive-shadows");S&&(S.useNormalOffset=!0,F||(S.enabled=!1));const D=()=>{S&&(S.useNormalOffset=!0,F||(S.enabled=!0))},Q=o.getSource();if(p.renderPass==="light-beam"&&Q.type!=="batched-model")return;if(Q.type==="vector"||Q.type==="geojson")return function(fe,Ce,ke,He,$e){const it=fe.transform;if(it.projection.name!=="mercator")return void a.w(`Drawing 3D models for ${it.projection.name} projection is not yet implemented`);const ct=it.getFreeCameraOptions().position;if(!fe.modelManager)return;const Xe=fe.modelManager;ke.modelManager=Xe;const Ye=fe.shadowRenderer;if(!ke._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const tt=ke._unevaluatedLayout._values["model-id"],Pt=Object.assign({},ke.layout.get("model-id").parameters),gt=fe.style.order.indexOf(ke.fqid);for(const Jt of He){const kt=Ce.getTile(Jt).getBucket(ke);if(!kt||kt.projection.name!==it.projection.name)continue;const or=kt.getModelUris();or&&!kt.modelsRequested&&(Xe.addModelsFromBucket(or,$e),kt.modelsRequested=!0);const pr=Im(Jt,it);Pt.zoom=pr;const It=tt.possiblyEvaluate(Pt);if(Zf(fe,kt,Jt),Iu.shadowUniformsInitialized=!1,Iu.useSingleShadowCascade=!!Ye&&Ye.getMaxCascadeForTile(Jt.toUnwrapped())===0,fe.renderPass==="shadow"&&Ye){if(fe.currentShadowCascade===1&&kt.isInsideFirstShadowMapFrustum)continue;const Ot=it.calculatePosMatrix(Jt.toUnwrapped(),it.worldSize);if(Iu.tileMatrix.set(Ot),Iu.shadowTileMatrix=Float32Array.from(Ye.calculateShadowPassMatrixFromMatrix(Ot)),Iu.aabb.min.fill(0),Iu.aabb.max[0]=Iu.aabb.max[1]=a.aj,Iu.aabb.max[2]=0,Jf(kt,Iu,fe,ke.scope))continue}const ht=1<<Jt.canonical.z,zt=[((ct.x-Jt.wrap)*ht-Jt.canonical.x)*a.aj,(ct.y*ht-Jt.canonical.y)*a.aj,ct.z*ht*a.aj];fe.conflationActive&&Object.keys(kt.instancesPerModel).length>0&&fe.style.isLayerClipped(ke,Ce.getSource())&&kt.updateReplacement(Jt,fe.replacementSource,gt,$e)&&(kt.uploaded=!1,kt.upload(fe.context));for(let Ot in kt.instancesPerModel){const fr=kt.instancesPerModel[Ot];fr.features.length>0&&(Ot=It.evaluate(fr.features[0].feature,{}));const Ar=Xe.getModel(Ot,$e);if(Ar||Xe.hasURLBeenRequested(Ot)||kt.modelUris.includes(Ot)||(kt.modelUris.push(Ot),kt.modelsRequested=!1),Ar&&Ar.uploaded)for(const yr of Ar.nodes)Cf(fe,ke,yr,fr,zt,Jt,Iu)}}}(p,o,h,m,Q.type==="vector"?h.scope:""),void D();if(!Q.loaded())return;if(Q.type==="batched-model")return function(fe,Ce,ke,He){ke.resetLayerRenderingStats(fe);const $e=fe.context,it=fe.transform,ct=fe.style.fog,Xe=fe.shadowRenderer;if(it.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${it.projection.name} projection is not yet implemented`);const Ye=fe.transform.getFreeCameraOptions().position,tt=a.c1([],[Ye.x,Ye.y,Ye.z],fe.transform.worldSize),Pt=a.eq([],tt),gt=a.bx([]),Jt=a.e9(it.center.lat,it.zoom),kt=a.bn([],[1,1,1/Jt]);a.bo(gt,gt,Pt);const or=ke.paint.get("model-opacity").constantOr(1),pr=new Rr($e.gl.LEQUAL,Rr.ReadWrite,fe.depthRangeFor3D),It=new Rr($e.gl.LEQUAL,Rr.ReadOnly,fe.depthRangeFor3D),ht=new a.d6([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),zt=fe.renderPass==="shadow",Ot=zt&&Xe?Xe.getCurrentCascadeFrustum():it.getFrustum(it.scaleZoom(it.worldSize)),fr=ke.paint.get("model-front-cutoff"),Ar=fr[2]<1,yr=ls(fe,ke.paint.get("model-cutoff-fade-range")),Br=ke.getLayerRenderingStats();(function(ln,dn,Wr,An){const cn=ln.terrain?ln.terrain.exaggeration():0,Ln=ln.transform.zoom;for(const Wn of An){const hi=dn.getTile(Wn).getBucket(Wr);hi&&(hi.setFilter(Wr.filter),ln.conflationActive&&hi.updateReplacement(Wn,ln.replacementSource),hi.evaluateTransform(ln,Wr),ln.terrain&&cn>0&&hi.elevationUpdate(ln.terrain,cn,Wn,Wr.source),hi.needsReEvaluation(ln,Ln,Wr)&&hi.evaluate(Wr))}})(fe,Ce,ke,He),function(){let ln,dn,Wr;Ar?(ln=He.length-1,dn=-1,Wr=-1):(ln=0,dn=He.length,Wr=1);const An=new Float64Array(16),cn=a.cx(),Ln=new a.P(0,0);for(let Wn=ln;Wn!==dn;Wn+=Wr){const hi=He[Wn],ji=Ce.getTile(hi).getBucket(ke);if(!ji||!ji.uploaded)continue;let Hn=!1;Xe&&(Hn=Xe.getMaxCascadeForTile(hi.toUnwrapped())===0);const Wi=it.calculatePosMatrix(hi.toUnwrapped(),it.worldSize),Ji=ji.modelTraits;!zt&&Ar&&(a.bi(An,Wi),a.ad(cn,tt,An),Ln.x=cn[0],Ln.y=cn[1]);const va=[];ji.setFilter(ke.filter);for(const ei of ji.getNodesInfo()){if(ei.hiddenByReplacement||!ei.node.meshes)continue;const qi=ei.node;let Ni=0;fe.terrain&&qi.elevation&&(Ni=qi.elevation*fe.terrain.exaggeration());const na=(()=>{const ml=ei.aabb;return ht.min=[...ml.min],ht.max=[...ml.max],ht.min[2]+=Ni,ht.max[2]+=Ni,a.ad(ht.min,ht.min,Wi),a.ad(ht.max,ht.max,Wi),ht})(),In=ei.evaluatedScale;if(In[0]<=1&&In[1]<=1&&In[2]<=1&&na.intersects(Ot)===0)continue;if(!zt&&Ar){const ml=.16666666666666666;ei.cameraCollisionOpacity=tt[0]>na.min[0]&&tt[0]<na.max[0]&&tt[1]>na.min[1]&&tt[1]<na.max[1]&&tt[2]*Jt<na.max[2]&&qi.footprint&&a.bY(Ln,qi.footprint)?Math.max(ei.cameraCollisionOpacity-ml,0):Math.min(1,ei.cameraCollisionOpacity+ml)}const Aa=[...Wi],ea=1/a.d4(hi.canonical),io=qi.anchor?qi.anchor[0]:0,Ki=qi.anchor?qi.anchor[1]:0;a.bo(Aa,Aa,[io*(In[0]-1)+ei.evaluatedTranslation[0]*ea,Ki*(In[1]-1)+ei.evaluatedTranslation[1]*ea,Ni+ei.evaluatedTranslation[2]]),a.cn(In,a.es)||a.cP(Aa,Aa,In);const ia=a.az([],Aa,qi.matrix),ga=a.az([],it.expandedFarZProjMatrix,ia),Zo=a.az([],it.expandedFarZProjMatrix,Aa),Ma=a.aA([],[io,Ki,Ni,1],ga)[2];qi.hidden=!1;let Do=or;zt||(Ar&&(Do*=ei.cameraCollisionOpacity,Do*=Bh(Aa,it,ei.aabb,fr)),Do*=Mc(yr,Ma)),Do!==0?va.push({nodeInfo:ei,depth:Ma,opacity:Do,wvpForNode:ga,wvpForTile:Zo,nodeModelMatrix:ia,tileModelMatrix:Aa}):qi.hidden=!0}zt||va.sort((ei,qi)=>!Ar||ei.opacity===1&&qi.opacity===1?ei.depth<qi.depth?-1:1:ei.opacity===1?-1:qi.opacity===1?1:ei.depth>qi.depth?-1:1);for(const ei of va){const qi=ei.nodeInfo,Ni=qi.node;let na=a.az([],kt,ei.tileModelMatrix);a.az(na,gt,na);const In=a.bi([],na);a.ea(In,In),a.cP(In,In,Yf),na=a.az(na,na,Ni.matrix);const Aa=fe.renderPass==="light-beam",ea=ke.paint.get("model-color-use-theme").constantOr("default")==="none",io=Ji&a.ex.HasMapboxMeshFeatures,Ki=io?0:qi.evaluatedRMEA[0][2];for(let ia=0;ia<Ni.meshes.length;++ia){const ga=Ni.meshes[ia],Zo=ia===Ni.lightMeshIndex;let Ma=ei.wvpForNode;if(Zo){if(!Aa&&!fe.terrain&&fe.shadowRenderer){fe.currentLayer<fe.firstLightBeamLayer&&(fe.firstLightBeamLayer=fe.currentLayer);continue}Ma=ei.wvpForTile}else if(Aa)continue;const Do={defines:[]},ml=[];if(!zt&&Xe&&(Xe.useNormalOffset=!!ga.normalBuffer),Bf(Do.defines,ml,ga,fe,ea?null:ke.lut),io||Do.defines.push("DIFFUSE_SHADED"),Hn&&Do.defines.push("SHADOWS_SINGLE_CASCADE"),Br&&(zt?Br.numRenderedVerticesInShadowPass+=ga.vertexArray.length:Br.numRenderedVerticesInTransparentPass+=ga.vertexArray.length),zt){RA(ga,ei.nodeModelMatrix,fe,ke);continue}let Gl=null;if(ct){const Kl=qh(ei.nodeModelMatrix,fe.transform);if(Gl=new Float32Array(Kl),it.projection.name!=="globe"){const mo=ga.aabb.min,go=ga.aabb.max,[Ca,hs]=ct.getOpacityForBounds(Kl,mo[0],mo[1],go[0],go[1]);Do.overrideFog=Ca>=Oe||hs>=Oe}}const Rl=ga.material;let gl;Rl.occlusionTexture&&Rl.occlusionTexture.offsetScale&&(gl=Rl.occlusionTexture.offsetScale,Do.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const rl=fe.getOrCreateProgram("model",Do);!zt&&Xe&&Xe.setupShadowsFromMatrix(ei.tileModelMatrix,rl,Xe.useNormalOffset),fe.uploadCommonUniforms($e,rl,null,Gl);const lu=Rl.pbrMetallicRoughness;lu.metallicFactor=.9,lu.roughnessFactor=.5;const Lu=Gi(new Float32Array(Ma),new Float32Array(na),new Float32Array(In),new Float32Array(Ni.matrix),fe,ei.opacity,lu.baseColorFactor,Rl.emissiveFactor,lu.metallicFactor,lu.roughnessFactor,Rl,Ki,ke,[0,0,0],gl);!Zo&&(qi.hasTranslucentParts||ei.opacity<1)&&rl.draw(fe,$e.gl.TRIANGLES,pr,bn.disabled,Xn.disabled,xn.backCCW,Lu,ke.id,ga.vertexBuffer,ga.indexBuffer,ga.segments,ke.paint,fe.transform.zoom,void 0,ml),rl.draw(fe,$e.gl.TRIANGLES,Zo?It:pr,bn.disabled,Zo||ei.opacity<1||qi.hasTranslucentParts?Xn.alphaBlended:Xn.unblended,xn.backCCW,Lu,ke.id,ga.vertexBuffer,ga.indexBuffer,ga.segments,ke.paint,fe.transform.zoom,void 0,ml)}}}}()}(p,o,h,m),void D();if(Q.type!=="model")return;const V=Q.getModels(),Z=[],K=p.transform.getFreeCameraOptions().position,ee=a.c1([],[K.x,K.y,K.z],p.transform.worldSize);a.eq(ee,ee);const he=[],le=[];let Ae=0;for(const fe of V){const Ce=h.paint.get("model-rotation").constantOr(null),ke=h.paint.get("model-scale").constantOr(null),He=h.paint.get("model-translation").constantOr(null);fe.computeModelMatrix(p,Ce,ke,He,!0,!0,!1);const $e=a.bx([]),it=a.e9(fe.position.lat,p.transform.zoom),ct=a.bn([],[1,1,1/it]);a.bo($e,$e,ee),Z.push({zScaleMatrix:ct,negCameraPosMatrix:$e});for(const Xe of fe.nodes)ip(p.transform,Xe,fe.matrix,p.transform.expandedFarZProjMatrix,Ae,he,le);Ae++}if(he.sort((fe,Ce)=>Ce.depth-fe.depth),p.renderPass!=="shadow"){if(w===1)for(const fe of le)ou(fe,p,h,Z[fe.modelIndex],bn.disabled,p.colorModeForRenderPass());else{for(const fe of le)ou(fe,p,h,Z[fe.modelIndex],bn.disabled,Xn.disabled);for(const fe of le)ou(fe,p,h,Z[fe.modelIndex],p.stencilModeFor3D(),p.colorModeForRenderPass());p.resetStencilClippingMasks()}for(const fe of he)ou(fe,p,h,Z[fe.modelIndex],bn.disabled,p.colorModeForRenderPass());D()}else{for(const fe of le)RA(fe.mesh,fe.nodeModelMatrix,p,h);for(const fe of he)RA(fe.mesh,fe.nodeModelMatrix,p,h);D()}}},zp={line:function(p,o,h){if(p.hasElevatedBuckets=!1,p.hasNonElevatedBuckets=!1,p._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||p._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(o){const m=o.getVisibleCoordinates();for(const w of m){const E=o.getTile(w).getBucket(p);if(E&&(E.elevationType!=="none"?p.hasElevatedBuckets=!0:p.hasNonElevatedBuckets=!0,p.hasElevatedBuckets&&p.hasNonElevatedBuckets))break}}}else p.hasNonElevatedBuckets=!0},model:function(p,o,h){const m=o.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(h.modelManager&&h.modelManager.upload(h,m.type==="vector"?p.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const w=m.getModels();for(const E of w)E.upload(h.context)},raster:function(p,o,h){const m=o.getSource();if(!(m instanceof Co&&m.loaded()))return;const w=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!w)return;const E=p.paint.get("raster-array-band")||m.getInitialBand(w);if(E==null)return;const S=o.getIds().map(F=>o.getTileByID(F));for(const F of S)F.updateNeeded(p.id,E)&&m.prepareTile(F,w,p.id,E)},"raster-particle":function(p,o,h){const m=o.getSource();if(!(m instanceof Co&&m.loaded()))return;const w=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!w)return;const E=p.paint.get("raster-particle-array-band")||m.getInitialBand(w);if(E==null)return;const S=o.getIds().map(F=>o.getTileByID(F));for(const F of S)F.updateNeeded(p.id,E)&&m.prepareTile(F,w,p.id,E)}},Qp={fill:Mr},Rc={fill:function(p,o,h,m){if(!h.layout||h.layout.get("fill-elevation-reference")==="none")return;const w=p.context.gl,E=new Rr(w.LEQUAL,Rr.ReadOnly,p.depthRangeFor3D),S=new bn({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),F=p.transform.getFreeCameraOptions().position,D=p.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const Q of m){const V=o.getTile(Q),Z=V.getBucket(h);if(!Z)continue;const K=Z.elevatedStructures;if(!K||K.depthSegments.segments[0].primitiveLength===0)continue;const ee=Gs(Q.toUnwrapped(),F),he=p.translatePosMatrix(Q.projMatrix,V,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor")),le=Wt(he,ee,0,1,0);D.draw(p,w.TRIANGLES,E,S,Xn.disabled,xn.disabled,le,h.id,K.vertexBuffer,K.indexBuffer,K.depthSegments,h.paint,p.transform.zoom)}}};class kA{constructor(o,h,m,w,E,S){this.context=new Ps(o,h),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=E,this._timeStamp=a.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const F=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const Q of F)this._debugParams.enabledLayers[Q]=!0;E.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),E.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),E.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),E.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),E.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),E.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const Q of F)E.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],Q);this.occlusionParams=new $h(E),this.setup(),this.numSublayers=zo.maxUnderzooming+zo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.eE,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new BA(this),this._wireframeDebugCache=new eh,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const D=new a.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new a.T(this.context,D,o.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=w,this.worldview=S}updateTerrain(o,h){const m=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new dd(this,o));const w=this._terrain;this.transform.elevation=m?w:null,w.update(o,this.transform,h),this.transform.elevation&&!w.enabled&&(this.transform.elevation=null)}_updateFog(o){const h=o.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,w]=h.getFovAdjustedRange(this.transform._fov);if(m>w)return void(this.transform.fogCullDistSq=null);const E=m+.78*(w-m);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(o){o&&!this._terrain&&(this._terrain=new dd(this,this.style)),this._forceTerrainMode=o}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,h){if(this.width=o*a.q.devicePixelRatio,this.height=h*a.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const o=this.context,h=new a.ba;h.emplaceBack(0,0),h.emplaceBack(a.aj,0),h.emplaceBack(0,a.aj),h.emplaceBack(a.aj,a.aj),this.tileExtentBuffer=o.createVertexBuffer(h,a.bc.members),this.tileExtentSegments=a.bd.simpleSegment(0,0,4,2);const m=new a.ba;m.emplaceBack(0,0),m.emplaceBack(a.aj,0),m.emplaceBack(0,a.aj),m.emplaceBack(a.aj,a.aj),this.debugBuffer=o.createVertexBuffer(m,a.bc.members),this.debugSegments=a.bd.simpleSegment(0,0,4,5);const w=new a.ba;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(w,a.bc.members),this.viewportSegments=a.bd.simpleSegment(0,0,4,2);const E=new a.aZ;E.emplaceBack(0,0,0,0),E.emplaceBack(a.aj,0,a.aj,0),E.emplaceBack(0,a.aj,0,a.aj),E.emplaceBack(a.aj,a.aj,a.aj,a.aj),this.mercatorBoundsBuffer=o.createVertexBuffer(E,a.bf.members),this.mercatorBoundsSegments=a.bd.simpleSegment(0,0,4,2);const S=new a.a_;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(S);const F=new a.bb;for(const Q of[0,1,3,2,0])F.emplaceBack(Q);this.debugIndexBuffer=o.createIndexBuffer(F),this.emptyTexture=new a.T(o,new a.r({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA8),this.identityMat=a.bz();const D=this.context.gl;this.stencilClearMode=new bn({func:D.ALWAYS,mask:0},0,255,D.ZERO,D.ZERO,D.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,Rr.disabled,this.stencilClearMode,Xn.disabled,xn.disabled,Ml(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,h,m){if(!h||this.currentStencilSource===h.id||!o.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let F=!1;for(const D of m)if(this._tileClippingMaskIDs[D.key]===void 0){F=!0;break}if(!F)return}this.currentStencilSource=h.id;const w=this.context,E=w.gl;this.nextStencilID+m.length>256&&this.clearStencil(),w.setColorMode(Xn.disabled),w.setDepthMode(Rr.disabled);const S=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const F of m){const D=h.getTile(F),Q=this._tileClippingMaskIDs[F.key]=this.nextStencilID++,{tileBoundsBuffer:V,tileBoundsIndexBuffer:Z,tileBoundsSegments:K}=this.getTileBoundsBuffers(D);S.draw(this,E.TRIANGLES,Rr.disabled,new bn({func:E.ALWAYS,mask:0},Q,255,E.KEEP,E.KEEP,E.REPLACE),Xn.disabled,xn.disabled,Ml(F.projMatrix),"$clipping",V,Z,K)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,h=this.context.gl;return new bn({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const h=this.context.gl;return new bn({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){const h=this.context.gl,m=o.sort((S,F)=>F.overscaledZ-S.overscaledZ),w=m[m.length-1].overscaledZ,E=m[0].overscaledZ-w+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const S={};for(let F=0;F<E;F++)S[F+w]=new bn({func:h.GEQUAL,mask:255},F+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=E,[S,m]}return[{[w]:bn.disabled},m]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Xn([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new a.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Xn.unblended:Xn.alphaBlended}colorModeForDrapableLayerRenderPass(o){const h=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Xn([h.ONE,h.ONE_MINUS_SRC_ALPHA,h.CONSTANT_ALPHA,h.ONE_MINUS_SRC_ALPHA],new a.am(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,h,m,w=!1){if(this.depthOcclusion)return new Rr(this.context.gl.GREATER,Rr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!w)return Rr.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Rr(m||this.context.gl.LEQUAL,h,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const o=this.context.gl,h=Math.ceil(this.width),m=Math.ceil(this.height),w=this.context.bindFramebuffer.get(),E=o.getParameter(o.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===h&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),h!==0&&m!==0&&(this.depthFBO=new Wo(this.context,h,m,!1,"texture"),this.depthTexture=new a.T(this.context,{width:h,height:m,data:null},o.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(w),o.bindTexture(o.TEXTURE_2D,E),this.depthFBO&&(o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),o.blitFramebuffer(0,0,h,m,0,0,h,m,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(o.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((o,h)=>o+h/this._fpsHistory.length,0))}render(o,h){const m=a.q.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=o.map.repaint,this.style=o,this.options=h;const w=this.style._mergedLayers,E=!(!this.terrain||!this.terrain.enabled),S=()=>this.style._getOrder(E).filter(It=>{const ht=w[It];return!(ht.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[ht.type]});let F=S(),D=!1,Q=!1,V=null;for(const It of F){const ht=w[It];ht.type==="circle"?D=!0:ht.type==="building"?V=ht:ht.type==="symbol"&&(ht.hasInitialOcclusionOpacityProperties?Q=!0:D=!0)}let Z=F.map(It=>w[It]);const K=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(a.q.now()),this.imageManager.beginFrame();let ee=0,he=!1;for(const It in K){const ht=K[It];ht.used&&(ht.prepare(this.context),ht.getSource().usedInConflation&&++ee)}let le=!1;for(const It of Z)It.isHidden(this.transform.zoom)||(It.type==="clip"&&(le=!0),this.prepareLayer(It));const Ae={},fe={},Ce={},ke={},He={};for(const It in K){const ht=K[It];Ae[It]=ht.getVisibleCoordinates(),fe[It]=Ae[It].slice().reverse(),Ce[It]=ht.getVisibleCoordinates(!0).reverse(),ke[It]=ht.getShadowCasterCoordinates(),He[It]=ht.sortCoordinatesByDistance(Ae[It])}const $e=It=>{const ht=this.style.getLayerSourceCache(It);return ht&&ht.used?ht.getSource():null};if(ee||le||this._clippingActiveLastFrame){const It=[],ht=[];let zt=0;for(const Ot of Z)this.isSourceForClippingOrConflation(Ot,$e(Ot))&&(It.push(Ot),ht.push(zt)),zt++;if(It&&(le||It.length>1)||this._clippingActiveLastFrame){le=!1;const Ot=[];for(let fr=0;fr<It.length;fr++){const Ar=It[fr],yr=ht[fr],Br=this.style.getLayerSourceCache(Ar);if(!Br||!Br.used||!Br.getSource().usedInConflation&&Ar.type!=="clip"&&Ar.type!=="building")continue;let ln=a.eF,dn=a.bW.None;const Wr=[];let An=!0;if(Ar.type==="building")ln=a.eH;else if(Ar.type==="clip"){ln=yr;for(const cn of Ar.layout.get("clip-layer-types"))dn|=cn==="model"?a.bW.Model:cn==="symbol"?a.bW.Symbol:a.bW.FillExtrusion;for(const cn of Ar.layout.get("clip-layer-scope"))Wr.push(cn);Ar.isHidden(this.transform.zoom)?An=!1:le=!0}An&&Ot.push({layer:Ar.fqid,cache:Br,order:ln,clipMask:dn,clipScope:Wr})}this.replacementSource.setSources(Ot),he=!0}}this._clippingActiveLastFrame=le,he||this.replacementSource.clear(),this.conflationActive=he,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let It=0;It<Z.length;It++){const ht=Z[It],zt=ht.cutoffRange();if(this.longestCutoffRange=Math.max(zt,this.longestCutoffRange),zt>0){const Ot=$e(ht);Ot&&(this.minCutoffZoom=Math.max(Ot.minzoom,this.minCutoffZoom)),ht.minzoom&&(this.minCutoffZoom=Math.max(ht.minzoom,this.minCutoffZoom))}ht.is3D(E)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=It),this._lastOcclusionLayer=It)}const it=this.style&&this.style.fog;it?(this._fogVisible=it.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=it.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(Ce),this.opaquePassCutoff=0,F=S(),Z=F.map(It=>w[It]));const ct=this._shadowRenderer;if(ct){ct.updateShadowParameters(this.transform,this.style.directionalLight);for(const It in K)for(const ht of Ae[It]){let zt={min:0,max:0};this.terrain&&(zt=this.terrain.getMinMaxForTile(ht)||zt),ct.addShadowReceiver(ht.toUnwrapped(),zt.min,zt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.eG(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Bt(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Xe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ye=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Xe&&!this._snow&&(this._snow=new kg(this)),!Xe&&this._snow&&(this._snow.destroy(),delete this._snow),Ye&&!this._rain&&(this._rain=new vd(this)),!Ye&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),V){this.buildingTileBorderManager||(this.buildingTileBorderManager=new Lc);const It=this.style.getLayerSourceCache(V);this.buildingTileBorderManager.updateBorders(It,V)}if(!mr.has(this.context.gl))return;this.renderPass="offscreen";for(const It of Z){const ht=o.getLayerSourceCache(It);if(!It.hasOffscreenPass()||It.isHidden(this.transform.zoom))continue;const zt=ht?fe[ht.id]:void 0;(It.type==="custom"||It.type==="raster"||It.type==="raster-particle"||It.isSky()||zt&&zt.length)&&this.renderLayer(this,ht,It,zt)}this.depthRangeFor3D=[0,1-(Z.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ke)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const tt=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Pt=(()=>{if(h.showOverdrawInspector)return a.am.black;const It=this.style.fog;if(It&&this.transform.projection.supportsFog){const ht=this.style.getLut(It.scope);if(!tt){const zt=It.properties.get("color-use-theme")==="none",Ot=It.properties.get("color").toNonPremultipliedRenderColor(zt?null:ht).toArray01();return new a.am(...Ot)}if(tt){const zt=It.properties.get("space-color-use-theme")==="none",Ot=It.properties.get("space-color").toNonPremultipliedRenderColor(zt?null:ht).toArray01();return new a.am(...Ot)}}return a.am.transparent})();if(this.context.clear({color:Pt,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&tt&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=F.length-1;this.currentLayer>=0;this.currentLayer--){const It=Z[this.currentLayer],ht=o.getLayerSourceCache(It);if(It.isSky())continue;const zt=ht?(It.is3D(E)?He:fe)[ht.id]:void 0;this._renderTileClippingMasks(It,ht,zt),this.renderLayer(this,ht,It,zt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&tt&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){const It=Z[this.currentLayer],ht=o.getLayerSourceCache(It);It.isSky()&&this.renderLayer(this,ht,It,ht?fe[ht.id]:void 0)}function gt(It,ht){let zt;return ht&&(zt=(It.type==="symbol"?Ce:It.is3D(E)?He:fe)[ht.id]),zt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<F.length;){const It=Z[this.currentLayer];if(It.type==="raster"||It.type==="raster-particle"){const ht=o.getLayerSourceCache(It);this.renderLayer(this,ht,It,gt(It,ht))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Jt=0;ct&&(Jt=ct.getShadowCastingLayerCount());let kt=!1,or=-1;for(let It=0;It<F.length;++It){const ht=Z[It];ht.isHidden(this.transform.zoom)||ht.is3D(E)&&(or=It)}Q&&or===-1&&(D=!0);let pr=!1;for(;this.currentLayer<F.length;){const It=Z[this.currentLayer],ht=o.getLayerSourceCache(It);if(It.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(It)){if(It.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!pr&&It.is3D(E)&&!E){const zt=this.currentLayer,Ot=fr=>{for(this.currentLayer=0;this.currentLayer<Z.length;this.currentLayer++){const Ar=Z[this.currentLayer];if(Qp[Ar.type]){const yr=this.style.getLayerSourceCache(Ar);Qp[Ar.type](this,yr,Ar,gt(Ar,yr),fr)}}};Ot("initialize"),Ot("reset"),this.currentLayer=zt,pr=!0}if(D&&!kt&&this.terrain&&!this.transform.isOrthographic&&(kt=!0,this.blitDepth()),Q&&or!==-1&&this.currentLayer===or+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(It,ht,ht?Ae[ht.id]:void 0),this.renderLayer(this,ht,It,gt(It,ht)),!this.terrain&&ct&&Jt>0&&It.hasShadowPass()&&--Jt==0){{this.clearStencil(),this.resetStencilClippingMasks();const zt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<Z.length;this.currentLayer++){const Ot=Z[this.currentLayer];if(Rc[Ot.type]){const fr=this.style.getLayerSourceCache(Ot);Rc[Ot.type](this,fr,Ot,gt(Ot,fr))}}this.currentLayer=zt}if(ct.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const zt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=zt;this.currentLayer++){const Ot=Z[this.currentLayer];if(!Ot.hasLightBeamPass())continue;const fr=o.getLayerSourceCache(Ot);this.renderLayer(this,fr,Ot,fr?fe[fr.id]:void 0)}this.currentLayer=zt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const zt=this.currentLayer;this.depthOcclusion=!0;for(const Ot of this.layersWithOcclusionOpacity){this.currentLayer=Ot;const fr=Z[this.currentLayer],Ar=o.getLayerSourceCache(fr),yr=Ar?fe[Ar.id]:void 0;this.terrain||this._renderTileClippingMasks(fr,Ar,Ar?Ae[Ar.id]:void 0),this.renderLayer(this,Ar,fr,yr)}this.depthOcclusion=!1,this.currentLayer=zt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let It=null;Z.forEach(ht=>{const zt=o.getLayerSourceCache(ht);zt&&!ht.isHidden(this.transform.zoom)&&zt.getVisibleCoordinates().length&&(!It||It.getSource().maxzoom<zt.getSource().maxzoom)&&(It=zt)}),It&&this.options.showTileBoundaries&&au(this,It,It.getVisibleCoordinates(),a.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&au(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(It){const ht=It.transform.padding;Pc(It,It.transform.height-(ht.top||0),3,rp),Pc(It,ht.bottom||0,3,Fo),Po(It,ht.left||0,3,iu),Po(It,It.transform.width-(ht.right||0),3,gd);const zt=It.transform.centerPoint;(function(Ot,fr,Ar,yr){is(Ot,fr-1,Ar-10,2,20,yr),is(Ot,fr-10,Ar-1,20,2,yr)})(It,zt.x,It.transform.height-zt.y,np)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),he||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);const{unsupportedLayers:h}=this.transform.projection,m=!h||!h.includes(o.type);if(zp[o.type]&&(m||this.terrain&&o.type==="custom")){const w=this.style.getLayerSourceCache(o);zp[o.type](o,w,this)}this.gpuTimingEnd()}renderLayer(o,h,m,w){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||w&&w.length)&&(this.id=m.id,this.gpuTimingStart(m),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(m.type)&&(!o.terrain||m.type!=="custom")||m.type==="clip"||Lm[m.type](o,h,m,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery,m=this.context.gl;let w=this.gpuTimers[o.id];w||(w=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:m.createQuery()}),w.calls++,m.beginQuery(h.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,h=this.context.gl,m=h.createQuery();this.deferredRenderGpuTimeQueries.push(m),h.beginQuery(o.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const h={};for(const m in o){const w=o[m],E=this.context.extTimerQuery,S=E.getQueryParameter(w.query,this.context.gl.QUERY_RESULT)/1e6;E.deleteQueryEXT(w.query),h[m]=S}return h}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.gl;let m=0;for(const w of o)m+=h.getQueryParameter(w,h.QUERY_RESULT)/1e6,h.deleteQuery(w);return m}translatePosMatrix(o,h,m,w,E){if(!m[0]&&!m[1])return o;const S=E?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(S){const Q=Math.sin(S),V=Math.cos(S);m=[m[0]*V-m[1]*Q,m[0]*Q+m[1]*V]}const F=[E?m[0]:a.aw(h,m[0],this.transform.zoom),E?m[1]:a.aw(h,m[1],this.transform.zoom),0],D=new Float32Array(16);return a.bo(D,o,F),D}saveTileTexture(o){if(o.context!==this.context)return;const h=o.size[0],m=this._tileTextures[h];m?m.push(o):this._tileTextures[h]=[o]}getTileTexture(o){const h=this._tileTextures[o];return h&&h.length>0?h.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,h,m){const w=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,E=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(E.push("LIGHTING_3D_MODE"),E.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):w||E.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||E.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(E.push("TERRAIN"),this.linearFloatFilteringSupported()&&E.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&E.push("GLOBE"),!this._fogVisible||w||h!==void 0&&!h||E.push("FOG","FOG_DITHERING"),w&&E.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&E.push("OVERDRAW_INSPECTOR"),E}getOrCreateProgram(o,h){this.cache=this.cache||{};const m=h&&h.defines||[],w=h&&h.config,E=this.currentGlobalDefines(o,h&&h.overrideFog,h&&h.overrideRtt).concat(m),S=Cu.cacheKey(yh[o],o,E,w);return this.cache[S]||(this.cache[S]=new Cu(this.context,o,yh[o],w,To[o],E)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,h){if(this.style.enable3dLights()){const m=this.style.directionalLight,w=this.style.ambientLight;if(m&&w){const E=((S,F,D)=>{const Q=S.properties.get("direction"),V=S.properties.get("color-use-theme")==="none",Z=S.properties.get("color").toNonPremultipliedRenderColor(V?null:D.getLut(S.scope)).toArray01(),K=S.properties.get("intensity"),ee=F.properties.get("color-use-theme")==="none",he=F.properties.get("color").toNonPremultipliedRenderColor(ee?null:D.getLut(F.scope)).toArray01(),le=F.properties.get("intensity"),Ae=[Q.x,Q.y,Q.z],fe=a.dI(he,le),Ce=a.dI(Z,K);return{u_lighting_ambient_color:fe,u_lighting_directional_dir:Ae,u_lighting_directional_color:Ce,u_ground_radiance:pd(Ae,Ce,fe)}})(m,w,this.style);h.setLightsUniformValues(o,E)}}}uploadCommonUniforms(o,h,m,w,E){if(this.uploadCommonLightUniforms(o,h),this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const F=S.getOpacity(this.transform.pitch),D=((Q,V,Z,K,ee,he,le,Ae,fe,Ce,ke,He)=>{const $e=Q.transform,it=V.properties.get("color-use-theme")==="none",ct=V.properties.get("color").toNonPremultipliedRenderColor(it?null:Q.style.getLut(V.scope)).toArray01();ct[3]=K;const Xe=Q.frameCounter/1e3%1,[Ye,tt]=V.properties.get("vertical-range");return{u_fog_matrix:Z?$e.calculateFogTileMatrix(Z):He||Q.identityMat,u_fog_range:V.getFovAdjustedRange($e._fov),u_fog_color:ct,u_fog_horizon_blend:V.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ye,tt),tt],u_fog_temporal_offset:Xe,u_frustum_tl:ee,u_frustum_tr:he,u_frustum_br:le,u_frustum_bl:Ae,u_globe_pos:fe,u_globe_radius:Ce,u_viewport:ke,u_globe_transition:a.ah($e.zoom),u_is_globe:+($e.projection.name==="globe")}})(this,S,m,F,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.q.devicePixelRatio,this.transform.height*a.q.devicePixelRatio],w);h.setFogUniformValues(o,D)}E&&h.setCutoffUniformValues(o,E.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,h=o.createTexture();return o.bindTexture(o.TEXTURE_2D,h),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,h=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const w of m)h[w.key]=o[w.key]||new Ah(w,512,this.transform.tileZoom,this,void 0,this.worldview);return h}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(o,h){return!(!o.is3D(!(!this.terrain||!this.terrain.enabled))||o.type!=="clip"&&o.type!=="building"&&(o.minzoom&&o.minzoom>this.transform.zoom||(this.style._clipLayerPresent||o.sourceLayer!=="building"&&o.sourceLayer!=="procedural_buildings")&&(!h||h.type!=="batched-model")))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let h=this._cachedTileFogOpacities[o.key];return h||(this._cachedTileFogOpacities[o.key]=h=this.style.fog.getOpacityForTile(o)),h[0]>=Oe||h[1]>=Oe}setupDepthForOcclusion(o,h,m){const w=this.context,E=w.gl,S=!!m;var F;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),w.activeTexture.set(E.TEXTURE3),o&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((F=this.depthRangeFor3D)[1]-F[0]),-1-2*F[0]/(F[1]-F[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),w.activeTexture.set(E.TEXTURE0),S||h.setTerrainUniformValues(w,m)}}function lp(p,o){let h=!1,m=null;const w=()=>{m=null,h&&(p(),m=setTimeout(w,o),h=!1)};return()=>(h=!0,m||w(),m)}class Mm{constructor(o){this._hashName=o&&encodeURIComponent(o),a.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=lp(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const h=Fu(o);if(this._hashName){const m=this._hashName;let w=!1;const E=location.hash.slice(1).split("&").map(S=>{const F=S.split("=")[0];return F===m?(w=!0,`${F}=${h}`):S}).filter(S=>S);return w||E.push(`${m}=${h}`),`#${E.join("&")}`}return`#${h}`}_getCurrentHash(){const o=location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(h=m)}),(h&&h[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(m=>isNaN(Number(m)))){const m=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(h[3]||0):o.getBearing();return o.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:m,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Fu(p,o){const h=p.getCenter(),m=Math.round(100*p.getZoom())/100,w=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,w),S=Math.round(h.lng*E)/E,F=Math.round(h.lat*E)/E,D=p.getBearing(),Q=p.getPitch();let V=o?`/${S}/${F}/${m}`:`${m}/${F}/${S}`;return(D||Q)&&(V+="/"+Math.round(10*D)/10),Q&&(V+=`/${Math.round(Q)}`),V}const UA={linearity:.3,easing:a.eI(0,0,.3,1)},Xh=a.h({deceleration:2500,maxSpeed:1400},UA),Om=a.h({deceleration:20,maxSpeed:1400},UA),Zh=a.h({deceleration:1e3,maxSpeed:360},UA),Dm=a.h({deceleration:1e3,maxSpeed:90},UA);class cp{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.q.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,h=a.q.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)h.zoom+=E.zoomDelta||0,h.bearing+=E.bearingDelta||0,h.pitch+=E.pitchDelta||0,E.panDelta&&h.pan._add(E.panDelta),E.around&&(h.around=E.around),E.pinchAround&&(h.pinchAround=E.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(h.pan.mag()){const E=NA(h.pan.mag(),m,a.h({},Xh,o||{}));w.offset=h.pan.mult(E.amount/h.pan.mag()),w.center=this._map.transform.center,Yh(w,E)}if(h.zoom){const E=NA(h.zoom,m,Om);w.zoom=this._map.transform.zoom+E.amount,Yh(w,E)}if(h.bearing){const E=NA(h.bearing,m,Zh);w.bearing=this._map.transform.bearing+a.ay(E.amount,-179,179),Yh(w,E)}if(h.pitch){const E=NA(h.pitch,m,Dm);w.pitch=this._map.transform.pitch+E.amount,Yh(w,E)}if(w.zoom||w.bearing){const E=h.pinchAround===void 0?h.around:h.pinchAround;w.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function Yh(p,o){(!p.duration||p.duration<o.duration)&&(p.duration=o.duration,p.easing=o.easing)}function NA(p,o,h){const{maxSpeed:m,linearity:w,deceleration:E}=h,S=a.ay(p*w/(o/1e3),-m,m),F=Math.abs(S)/(E*w);return{easing:h.easing,duration:1e3*F,amount:S*(F/2)}}class Ua extends a.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,m,w={}){const E=De(h.getCanvasContainer(),m),S=h.unproject(E);super(o,a.h({point:E,lngLat:S,originalEvent:m},w)),this._defaultPrevented=!1,this.target=h}}class up extends a.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,m){const w=o==="touchend"?m.changedTouches:m.touches,E=we(h.getCanvasContainer(),w),S=E.map(D=>h.unproject(D)),F=E.reduce((D,Q,V,Z)=>D.add(Q.div(Z.length)),new a.P(0,0));super(o,{points:E,point:F,lngLats:S,lngLat:h.unproject(F),originalEvent:m}),this._defaultPrevented=!1}}class Rm extends a.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h){super("wheel",{originalEvent:h}),this._defaultPrevented=!1}}class km{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Rm(this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new Ua(o.type,this._map,o))}mouseup(o){this._map.fire(new Ua(o.type,this._map,o))}preclick(o){const h=a.h({},o);h.type="preclick",this._map.fire(new Ua(h.type,this._map,h))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Ua(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Ua(o.type,this._map,o))}mouseover(o){this._map.fire(new Ua(o.type,this._map,o))}mouseout(o){this._map.fire(new Ua(o.type,this._map,o))}touchstart(o){return this._firePreventable(new up(o.type,this._map,o))}touchmove(o){this._map.fire(new up(o.type,this._map,o))}touchend(o){this._map.fire(new up(o.type,this._map,o))}touchcancel(o){this._map.fire(new up(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zA{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Ua(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ua("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Ua(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Um{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(se(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;const m=h,w=this._startPos,E=this._lastPos;if(!w||!E||E.equals(m)||!this._box&&m.dist(w)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=R("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const S=Math.min(w.x,m.x),F=Math.max(w.x,m.x),D=Math.min(w.y,m.y),Q=Math.max(w.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${D}px)`,this._box.style.width=F-S+"px",this._box.style.height=Q-D+"px")})}mouseupWindow(o,h){if(!this._active)return;const m=this._startPos,w=h;if(m&&o.button===0){if(this.reset(),Be(),m.x!==w.x||m.y!==w.y)return this._map.fire(new a.A("boxzoomend",{originalEvent:o})),{cameraAnimation:E=>E.fitScreenCoordinates(m,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ye(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new a.A(o,{originalEvent:h}))}}function hp(p,o){const h={};for(let m=0;m<p.length;m++)h[p[m].identifier]=o[m];return h}class Ug{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,h,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),m.length===this.numTouches&&(this.centroid=function(w){const E=new a.P(0,0);for(const S of w)E._add(S);return E.div(w.length)}(h),this.touches=hp(m,h)))}touchmove(o,h,m){if(this.aborted||!this.centroid)return;const w=hp(m,h);for(const E in this.touches){const S=w[E];(!S||S.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(o,h,m){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class tl{constructor(o){this.singleTap=new Ug(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,h,m){this.singleTap.touchstart(o,h,m)}touchmove(o,h,m){this.singleTap.touchmove(o,h,m)}touchend(o,h,m){const w=this.singleTap.touchend(o,h,m);if(w){const E=o.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(w)<30;if(E&&S||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class uc{constructor(){this._zoomIn=new tl({numTouches:1,numTaps:2}),this._zoomOut=new tl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,m){this._zoomIn.touchstart(o,h,m),this._zoomOut.touchstart(o,h,m)}touchmove(o,h,m){this._zoomIn.touchmove(o,h,m),this._zoomOut.touchmove(o,h,m)}touchend(o,h,m){const w=this._zoomIn.touchend(o,h,m),E=this._zoomOut.touchend(o,h,m);return w?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(w)},{originalEvent:o})}):E?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(E)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Nm={0:1,2:2},jp={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class xd{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,h){return!1}_move(o,h){return{}}mousedown(o,h){if(this._lastPoint)return;const m=nt(o);this._correctButton(o,m)&&(this._lastPoint=h,this._eventButton=m)}mousemoveWindow(o,h){const m=this._lastPoint;if(m){if(o.preventDefault(),this._eventButton!=null&&function(w,E){const S=Nm[E];return w.buttons===void 0||(w.buttons&S)!==S}(o,this._eventButton))this.reset();else if(this._moved||!(h.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(m,h)}}mouseupWindow(o){this._lastPoint&&nt(o)===this._eventButton&&(this._moved&&Be(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zm extends xd{mousedown(o,h){super.mousedown(o,h),this._lastPoint&&(this._active=!0)}_correctButton(o,h){return h===0&&!o.ctrlKey}_move(o,h){return{around:h,panDelta:h.sub(o)}}}class Hp extends xd{constructor(o){super(o),this._pitchRotateKey=o.pitchRotateKey?jp[o.pitchRotateKey]:void 0}_correctButton(o,h){return this._pitchRotateKey?h===0&&o[this._pitchRotateKey]:h===0&&o.ctrlKey||h===2}_move(o,h){const m=.8*(h.x-o.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(o){this._pitchRotateKey||o.preventDefault()}}class Vp extends xd{constructor(o){super(o),this._pitchRotateKey=o.pitchRotateKey?jp[o.pitchRotateKey]:void 0}_correctButton(o,h){return this._pitchRotateKey?h===0&&o[this._pitchRotateKey]:h===0&&o.ctrlKey||h===2}_move(o,h){const m=-.5*(h.y-o.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(o){this._pitchRotateKey||o.preventDefault()}}class Ng{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),a.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(o,h,m){return this._calculateTransform(o,h,m)}touchmove(o,h,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!a.eJ())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,h,m)}}touchend(o,h,m){this._calculateTransform(o,h,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,m){m.length>0&&(this._active=!0);const w=hp(m,h),E=new a.P(0,0),S=new a.P(0,0);let F=0;for(const Q in w){const V=w[Q],Z=this._touches[Q];Z&&(E._add(V),S._add(V.sub(Z)),F++,w[Q]=V)}if(this._touches=w,F<this._minTouches||!S.mag())return;const D=S.div(F);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(F),panDelta:D}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=R("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class fp{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,h,m){return{}}touchstart(o,h,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,m){const w=this._firstTwoTouches;if(!w)return;o.preventDefault();const[E,S]=w,F=Ap(m,h,E),D=Ap(m,h,S);if(!F||!D)return;const Q=this._aroundCenter?null:F.add(D).div(2);return this._move([F,D],Q,o)}touchend(o,h,m){if(!this._firstTwoTouches)return;const[w,E]=this._firstTwoTouches,S=Ap(m,h,w),F=Ap(m,h,E);S&&F||(this._active&&Be(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ap(p,o,h){for(let m=0;m<p.length;m++)if(p[m].identifier===h)return o[m]}function Qm(p,o){return Math.log(p/o)/Math.LN2}class jm extends fp{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){const m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Qm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qm(this._distance,m),pinchAround:h}}}function Gp(p,o){return 180*p.angleWith(o)/Math.PI}class zg extends fp{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){const m=this._vector;if(this._vector=o[0].sub(o[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Gp(this._vector,m),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const h=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const w=Gp(o,m);return Math.abs(w)<h}}function dp(p){return Math.abs(p.y)>Math.abs(p.x)}class Kp extends fp{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,dp(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,m){const w=this._lastPoints;if(!w)return;const E=o[0].sub(w[0]),S=o[1].sub(w[1]);return this._map._cooperativeGestures&&!a.eJ()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(E,S,m.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(E.y+S.y)/2*-.5})}gestureBeginsVertically(o,h,m){if(this._valid!==void 0)return this._valid;const w=o.mag()>=2,E=h.mag()>=2;if(!w&&!E)return;if(!w||!E)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const S=o.y>0==h.y>0;return dp(o)&&dp(h)&&S}}const G0={panStep:100,bearingStep:15,pitchStep:10};class Qg{constructor(){const o=G0;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,m=0,w=0,E=0,S=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?m=-1:(o.preventDefault(),E=-1);break;case 39:o.shiftKey?m=1:(o.preventDefault(),E=1);break;case 38:o.shiftKey?w=1:(o.preventDefault(),S=-1);break;case 40:o.shiftKey?w=-1:(o.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(m=0,w=0),{cameraAnimation:F=>{const D=F.getZoom();F.easeTo({duration:300,easeId:"keyboardHandler",easing:Hm,zoom:h?Math.round(D)+h*(o.shiftKey?2:1):D,bearing:F.getBearing()+m*this._bearingStep,pitch:F.getPitch()+w*this._pitchStep,offset:[-E*this._panStep,-S*this._panStep],center:F.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Hm(p){return p*(2-p)}const jg=4.000244140625,Vm=1/450;class eA{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._handler=h,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Vm,a.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||a.eJ()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const m=a.q.now(),w=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,h!==0&&h%jg==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=h,this._timeout=window.setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(w*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=De(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const Q=this._type==="wheel"&&Math.abs(this._delta)>jg?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*Q)));this._delta<0&&V!==0&&(V=1/V);const Z=h(),K=Math.pow(2,Z),ee=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):K;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(ee*V))),this._type==="wheel"&&(this._startZoom=Z,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:h(),w=this._startZoom,E=this._easing;let S,F=!1;if(this._type==="wheel"&&w&&E){const Q=Math.min((a.q.now()-this._lastWheelEventTime)/200,1),V=E(Q);S=a.ai(w,m,V),Q<1?this._frameId||(this._frameId=!0):F=!0}else S=m,F=!0;this._active=!0,F&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let D=S-h();return D*this._lastDelta<0&&(D=0),{noInertia:!0,needsRenderFrame:!F,zoomDelta:D,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=a.eK;if(this._prevEase){const m=this._prevEase,w=(a.q.now()-m.start)/m.duration,E=m.easing(w+.01)-m.easing(w),S=.27/Math.sqrt(E*E+1e-4)*.01,F=Math.sqrt(.0729-S*S);h=a.eI(S,F,.25,1)}return this._prevEase={start:a.q.now(),duration:o,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=R("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class no{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Hg{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,h){return o.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(o.shiftKey?-1:1),around:m.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vg{constructor(){this._tap=new tl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,h,m){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=h[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(o,h,m))}touchmove(o,h,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const w=h[0],E=w.y-this._swipePoint.y;return this._swipePoint=w,o.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(o,h,m)}touchend(o,h,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(o,h,m)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gm{constructor(o,h,m){this._el=o,this._mousePan=h,this._touchPan=m}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class K0{constructor(o,h,m){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class tA{constructor(o,h,m,w){this._el=o,this._touchZoom=h,this._touchRotate=m,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const pl=p=>p.zoom||p.drag||p.pitch||p.rotate;class Gg extends a.A{}class Km{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,h){const m=a.at([],h,o);this.radius=a.ae(m[2]<0?a.eM([],m,this.constants):[m[0],m[1],0])}projectRay(o){a.eM(o,o,this.constants),a.au(o,o),a.eN(o,o,this.constants);const h=a.c1([],o,this.radius);if(h[2]>0){const m=a.c1([],[0,0,1],a.bG(h,[0,0,1])),w=a.c1([],a.au([],[h[0],h[1],0]),this.radius),E=a.d5([],h,a.c1([],a.at([],a.d5([],w,m),h),2));h[0]=E[0],h[1]=E[1]}return h}}function su(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class Dl{constructor(o,h){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new cp(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Km,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),a.aV(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,E,S]of this._listeners){const F=w===document?this.handleWindowEvent:this.handleEvent;w.addEventListener(E,F,S)}}destroy(){for(const[o,h,m]of this._listeners){const w=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(h,w,m)}}_addDefaultHandlers(o){const h=this._map,m=h.getCanvasContainer();this._add("mapEvent",new km(h,o));const w=h.boxZoom=new Um(h,o);this._add("boxZoom",w);const E=new uc,S=new Hg;h.doubleClickZoom=new no(S,E),this._add("tapZoom",E),this._add("clickZoom",S);const F=new Vg;this._add("tapDragZoom",F);const D=h.touchPitch=new Kp(h);this._add("touchPitch",D);const Q=new Hp(o),V=new Vp(o);h.dragRotate=new K0(o,Q,V),this._add("mouseRotate",Q,["mousePitch"]),this._add("mousePitch",V,["mouseRotate"]);const Z=new zm(o),K=new Ng(h,o);h.dragPan=new Gm(m,Z,K),this._add("mousePan",Z),this._add("touchPan",K,["touchZoom","touchRotate"]);const ee=new zg,he=new jm;h.touchZoomRotate=new tA(m,he,ee,F),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",he,["touchPan","touchRotate"]),this._add("blockableMapEvent",new zA(h));const le=h.scrollZoom=new eA(h,this);this._add("scrollZoom",le,["mousePan"]);const Ae=h.keyboard=new Qg;this._add("keyboard",Ae);for(const fe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[fe]&&h[fe].enable(o[fe])}_add(o,h,m){this._handlers.push({handlerName:o,handler:h,allowed:m}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!pl(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,h,m){for(const w in o)if(w!==m&&(!h||h.indexOf(w)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const h=[];for(const m of o)this._el.contains(m.target)&&h.push(m);return h}handleEvent(o,h){this._updatingCamera=!0;const m=o.type==="renderFrame",w=m?void 0:o,E={needsRenderFrame:!1},S={},F={},D=o.touches?this._getMapTouches(o.touches):void 0,Q=D?we(this._el,D):m?void 0:De(this._el,o);for(const{handlerName:K,handler:ee,allowed:he}of this._handlers){if(!ee.isEnabled())continue;let le;this._blockedByActive(F,he,K)?ee.reset():ee[h||o.type]&&(le=ee[h||o.type](o,Q,D),this.mergeHandlerResult(E,S,le,K,w),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||ee.isActive())&&(F[K]=ee)}const V={};for(const K in this._previousActiveHandlers)F[K]||(V[K]=w);this._previousActiveHandlers=F,(Object.keys(V).length||su(E))&&(this._changes.push([E,S,V]),this._triggerRenderFrame()),(Object.keys(F).length||su(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=E;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(o,h,m,w,E){if(!m)return;a.h(o,m);const S={handlerName:w,originalEvent:m.originalEvent||E};m.zoomDelta!==void 0&&(h.zoom=S),m.panDelta!==void 0&&(h.drag=S),m.pitchDelta!==void 0&&(h.pitch=S),m.bearingDelta!==void 0&&(h.rotate=S)}_applyChanges(){const o={},h={},m={};for(const[w,E,S]of this._changes)w.panDelta&&(o.panDelta=(o.panDelta||new a.P(0,0))._add(w.panDelta)),w.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(o.around=w.around),w.aroundCoord!==void 0&&(o.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(o.pinchAround=w.pinchAround),w.noInertia&&(o.noInertia=w.noInertia),a.h(h,E),a.h(m,S);this._updateMapTransform(o,h,m),this._changes=[]}_updateMapTransform(o,h,m){const w=this._map,E=w.transform,S=Ce=>[Ce.x,Ce.y,Ce.z];if((Ce=>{const ke=this._eventsInProgress.drag;return ke&&!this._handlersById[ke.handlerName].isActive()})()&&!su(o)){const Ce=E.zoom;E.cameraElevationReference="sea",this._originalZoom!=null&&E._orthographicProjectionAtLowPitch&&E.projection.name!=="globe"&&E.pitch===0?(E.cameraElevationReference="ground",E.zoom=this._originalZoom):(E.recenterOnTerrain(),E.cameraElevationReference="ground"),Ce!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&w._stop(!0),!su(o))return void this._fireEvents(h,m,!0);let{panDelta:F,zoomDelta:D,bearingDelta:Q,pitchDelta:V,around:Z,aroundCoord:K,pinchAround:ee}=o;E._isCameraConstrained&&(D>0&&(D=0),E._isCameraConstrained=!1),ee!==void 0&&(Z=ee),(D||(Ce=>h[Ce]&&!this._eventsInProgress[Ce])("drag"))&&Z&&(this._dragOrigin=S(E.pointCoordinate3D(Z)),this._originalZoom=E.zoom,this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",w._stop(!0),Z=Z||w.transform.centerPoint,Q&&(E.bearing+=Q),V&&(E.pitch+=V),E._updateCameraState();const he=[0,0,0];if(F)if(E.projection.name==="mercator"){const Ce=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(Z).dir),ke=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(Z.sub(F)).dir);he[0]=ke[0]-Ce[0],he[1]=ke[1]-Ce[1]}else{const Ce=E.pointCoordinate(Z);if(E.projection.name==="globe"){F=F.rotate(-E.angle);const ke=E._pixelsPerMercatorPixel/E.worldSize;he[0]=-F.x*a.eL(a.aY(Ce.y))*ke,he[1]=-F.y*a.eL(E.center.lat)*ke}else{const ke=E.pointCoordinate(Z.sub(F));Ce&&ke&&(he[0]=ke.x-Ce.x,he[1]=ke.y-Ce.y)}}const le=E.zoom,Ae=[0,0,0];if(D){const Ce=S(K||E.pointCoordinate3D(Z)),ke={dir:a.au([],a.at([],Ce,E._camera.position))};if(ke.dir[2]<0){const He=E.zoomDeltaToMovement(Ce,D);a.c1(Ae,ke.dir,He)}}const fe=a.d5(he,he,Ae);E._translateCameraConstrained(fe),D&&Math.abs(E.zoom-le)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,m,!0)}_fireEvents(o,h,m){const w=pl(this._eventsInProgress),E=pl(o),S={};for(const V in o){const{originalEvent:Z}=o[V];this._eventsInProgress[V]||(S[`${V}start`]=Z),this._eventsInProgress[V]=o[V]}!w&&E&&this._fireEvent("movestart",E.originalEvent);for(const V in S)this._fireEvent(V,S[V]);E&&this._fireEvent("move",E.originalEvent);for(const V in o){const{originalEvent:Z}=o[V];this._fireEvent(V,Z)}const F={};let D;for(const V in this._eventsInProgress){const{handlerName:Z,originalEvent:K}=this._eventsInProgress[V];this._handlersById[Z].isActive()||(delete this._eventsInProgress[V],D=h[Z]||K,F[`${V}end`]=D)}for(const V in F)this._fireEvent(V,F[V]);const Q=pl(this._eventsInProgress);if(m&&(w||E)&&!Q){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=K=>K!==0&&-this._bearingSnap<K&&K<this._bearingSnap;V?(Z(V.bearing||this._map.getBearing())&&(V.bearing=0),this._map.easeTo(V,{originalEvent:D})):(this._map.fire(new a.A("moveend",{originalEvent:D})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new a.A(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new Gg("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Xo="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class jn extends a.E{constructor(o,h){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,a.aV(["_renderFrameCallback"],this)}getCenter(){return new a.ci(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,m){return o=a.P.convert(o).mult(-1),this.panTo(this.transform.center,a.h({offset:o},h),m)}panTo(o,h,m){return this.easeTo(a.h({center:o},h),m)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,m){return this.easeTo(a.h({zoom:o},h),m)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,m){return this.easeTo(a.h({bearing:o},h),m)}resetNorth(o,h){return this.rotateTo(0,a.h({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(a.h({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=a.aG.convert(o);const m=h&&h.bearing||0,w=h&&h.pitch||0,E=o.getNorthWest(),S=o.getSouthEast();return this._cameraForBounds(this.transform,E,S,m,w,h)}_extendPadding(o){const h={top:0,right:0,bottom:0,left:0};return o==null?a.h({},h,this.transform.padding):typeof o=="number"?{top:o,bottom:o,right:o,left:o}:a.h({},h,o)}_extendCameraOptions(o){return(o=a.h({offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=this._extendPadding(o.padding),o}_minimumAABBFrustumDistance(o,h){const m=h.max[0]-h.min[0],w=h.max[1]-h.min[1];return m/w>o.aspect?m/(2*Math.tan(.5*o.fovX)*o.aspect):w/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,h,m,w,E,S){const F=o.clone(),D=this._extendCameraOptions(S);F.bearing=w,F.pitch=E;const Q=a.ci.convert(h),V=a.ci.convert(m),Z=.5*(Q.lat+V.lat),K=.5*(Q.lng+V.lng),ee=a.eO(Z,K),he=a.au([],ee),le=a.au([],a.bF([],he,[0,1,0])),Ae=a.bF([],le,he),fe=[le[0],le[1],le[2],0,Ae[0],Ae[1],Ae[2],0,he[0],he[1],he[2],0,0,0,0,1],Ce=[ee,a.eO(Q.lat,Q.lng),a.eO(V.lat,Q.lng),a.eO(V.lat,V.lng),a.eO(Q.lat,V.lng),a.eO(Z,Q.lng),a.eO(Z,V.lng),a.eO(Q.lat,K),a.eO(V.lat,K)];let ke=a.d6.fromPoints(Ce.map(Ot=>[a.bG(le,Ot),a.bG(Ae,Ot),a.bG(he,Ot)]));const He=a.ad([],ke.center,fe);a.eP(He)===0&&a.eQ(He,0,0,1),a.au(He,He),a.c1(He,He,a.aB),F.center=a.eR(He);const $e=F.getWorldToCameraMatrix(),it=a.bi(new Float64Array(16),$e);ke=a.d6.applyTransform(ke,a.az([],$e,fe));const ct=this._extendAABB(ke,F,D,w);if(!ct)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ke=ct,a.ad(He,He,$e);const Xe=.5*(ke.max[2]-ke.min[2]),Ye=this._minimumAABBFrustumDistance(F,ke),tt=a.c1([],[0,0,1],Xe),Pt=a.d5(tt,He,tt),gt=Ye+(F.pitch===0?0:a.bD(He,Pt)),Jt=F.globeCenterInViewSpace,kt=a.at([],He,[Jt[0],Jt[1],Jt[2]]);a.au(kt,kt),a.c1(kt,kt,gt);const or=a.d5([],He,kt);a.ad(or,or,it);const pr=a.eB/a.aB,It=a.ae(or),ht=a.cb(Math.max(It*pr-a.eB,Number.EPSILON),0),zt=Math.min(F.zoomFromMercatorZAdjusted(ht),D.maxZoom);return zt>.5*(a.cX+a.cI)?(F.setProjection({name:"mercator"}),F.zoom=zt,this._cameraForBounds(F,h,m,w,E,S)):{center:F.center,zoom:zt,bearing:w,pitch:E}}_extendAABB(o,h,m,w){const E=.5*((m.padding.left||0)+(m.padding.right||0)),S=.5*((m.padding.top||0)+(m.padding.bottom||0)),F=S,D=E,Q=E,V=S,Z=h.width-(D+Q),K=h.height-(F+V),ee=a.at([],o.max,o.min),he=Math.min(Z/ee[0],K/ee[1]),le=Math.min(h.scaleZoom(h.scale*he),m.maxZoom);if(isNaN(le))return null;const Ae=h.scale/h.zoomScale(le),fe=new a.d6([o.min[0]-D*Ae,o.min[1]-V*Ae,o.min[2]],[o.max[0]+Q*Ae,o.max[1]+F*Ae,o.max[2]]),Ce=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new a.P(m.offset.x,m.offset.y):a.P.convert(m.offset)).rotate(-a.al(w));return fe.center[0]-=Ce.x*Ae,fe.center[1]+=Ce.y*Ae,fe}queryTerrainElevation(o,h){const m=this.transform.elevation;return m?(h=a.h({},{exaggerated:!0},h),m.getAtPoint(a.ac.fromLngLat(o),null,h.exaggerated)):null}_cameraForBounds(o,h,m,w,E,S){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,h,m,w,E,S);const F=o.clone(),D=this._extendCameraOptions(S);F.bearing=w,F.pitch=E;const Q=a.ci.convert(h),V=a.ci.convert(m),Z=new a.ci(Q.lng,V.lat),K=new a.ci(V.lng,Q.lat),ee=F.project(Q),he=F.project(V),le=this.queryTerrainElevation(Q),Ae=this.queryTerrainElevation(V),fe=this.queryTerrainElevation(Z),Ce=this.queryTerrainElevation(K),ke=[[ee.x,ee.y,Math.min(le||0,Ae||0,fe||0,Ce||0)],[he.x,he.y,Math.max(le||0,Ae||0,fe||0,Ce||0)]];let He=a.d6.fromPoints(ke);const $e=F.getWorldToCameraMatrix(),it=a.bi(new Float64Array(16),$e);He=a.d6.applyTransform(He,$e);const ct=this._extendAABB(He,F,D,w);if(!ct)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");He=ct;const Xe=.5*a.at([],He.max,He.min)[2],Ye=this._minimumAABBFrustumDistance(F,He),tt=[0,0,1,0];a.aA(tt,tt,$e),a.eS(tt,tt);const Pt=a.c1([],tt,Ye+Xe),gt=a.d5([],He.center,Pt);a.ad(He.center,He.center,it),a.ad(gt,gt,it);const Jt=F.unproject(new a.P(He.center[0],He.center[1])),kt=a.eT(F.projection,Jt),or=Math.pow(2,kt),pr=Math.min(F._zoomFromMercatorZ(gt[2]*F.pixelsPerMeter*or/F.worldSize),D.maxZoom);return F.mercatorFromTransition&&pr<.5*(a.cX+a.cI)?(F.setProjection({name:"globe"}),F.zoom=pr,this._cameraForBounds(F,h,m,w,E,S)):{center:Jt,zoom:pr,bearing:w,pitch:E}}fitBounds(o,h,m){const w=this.cameraForBounds(o,h);return this._fitInternal(w,h,m)}fitScreenCoordinates(o,h,m,w,E){const S=a.P.convert(o),F=a.P.convert(h),D=new a.P(Math.min(S.x,F.x),Math.min(S.y,F.y)),Q=new a.P(Math.max(S.x,F.x),Math.max(S.y,F.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,F))return this;const V=this.transform.pointLocation3D(D),Z=this.transform.pointLocation3D(Q),K=this.transform.pointLocation3D(new a.P(D.x,Q.y)),ee=this.transform.pointLocation3D(new a.P(Q.x,D.y)),he=[Math.min(V.lng,Z.lng,K.lng,ee.lng),Math.min(V.lat,Z.lat,K.lat,ee.lat)],le=[Math.max(V.lng,Z.lng,K.lng,ee.lng),Math.max(V.lat,Z.lat,K.lat,ee.lat)],Ae=w&&w.pitch?w.pitch:this.getPitch(),fe=this._cameraForBounds(this.transform,he,le,m,Ae,w);return this._fitInternal(fe,w,E)}_fitInternal(o,h,m){return o?(h=a.h(o,h)).linear?this.easeTo(h,m):this.flyTo(h,m):this}jumpTo(o,h){this.stop();const m=o.preloadOnly?this.transform.clone():this.transform;let w=!1,E=!1,S=!1;"zoom"in o&&m.zoom!==+o.zoom&&(w=!0,m.zoom=+o.zoom),o.center!==void 0&&(m.center=a.ci.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(E=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(S=!0,m.pitch=+o.pitch);const F=typeof o.padding=="number"?this._extendPadding(o.padding):o.padding;if(o.padding!=null&&!m.isPaddingEqual(F))if(o.retainPadding===!1){const D=m.clone();D.padding=F,m.setLocationAtPoint(m.center,D.centerPoint)}else m.padding=F;return o.preloadOnly?(this._preloadTiles(m),this):(this.fire(new a.A("movestart",h)).fire(new a.A("move",h)),w&&this.fire(new a.A("zoomstart",h)).fire(new a.A("zoom",h)).fire(new a.A("zoomend",h)),E&&this.fire(new a.A("rotatestart",h)).fire(new a.A("rotate",h)).fire(new a.A("rotateend",h)),S&&this.fire(new a.A("pitchstart",h)).fire(new a.A("pitch",h)).fire(new a.A("pitchend",h)),this.fire(new a.A("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(Xo),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,h){const m=this.transform;if(!m.projection.supportsFreeCamera)return a.w(Xo),this;this.stop();const w=m.zoom,E=m.pitch,S=m.bearing;m.setFreeCameraOptions(o);const F=w!==m.zoom,D=E!==m.pitch,Q=S!==m.bearing;return this.fire(new a.A("movestart",h)).fire(new a.A("move",h)),F&&this.fire(new a.A("zoomstart",h)).fire(new a.A("zoom",h)).fire(new a.A("zoomend",h)),Q&&this.fire(new a.A("rotatestart",h)).fire(new a.A("rotate",h)).fire(new a.A("rotateend",h)),D&&this.fire(new a.A("pitchstart",h)).fire(new a.A("pitch",h)).fire(new a.A("pitchend",h)),this.fire(new a.A("moveend",h)),this}easeTo(o,h){this._stop(!1,o.easeId),((o=a.h({offset:[0,0],duration:500,easing:a.eK},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const m=this.transform,w=this.getZoom(),E=this.getBearing(),S=this.getPitch(),F=this.getPadding(),D="zoom"in o?+o.zoom:w,Q="bearing"in o?this._normalizeBearing(o.bearing,E):E,V="pitch"in o?+o.pitch:S,Z=this._extendPadding(o.padding),K=a.P.convert(o.offset);let ee,he,le;if(m.projection.name==="globe"){const tt=a.ac.fromLngLat(m.center),Pt=K.rotate(-m.angle);tt.x+=Pt.x/m.worldSize,tt.y+=Pt.y/m.worldSize;const gt=tt.toLngLat(),Jt=a.ci.convert(o.center||gt);this._normalizeCenter(Jt),ee=m.centerPoint.add(Pt),he=new a.P(tt.x,tt.y).mult(m.worldSize),le=new a.P(a.aD(Jt.lng),a.aH(Jt.lat)).mult(m.worldSize).sub(he)}else{ee=m.centerPoint.add(K);const tt=m.pointLocation(ee),Pt=a.ci.convert(o.center||tt);this._normalizeCenter(Pt),he=m.project(tt),le=m.project(Pt).sub(he)}const Ae=m.zoomScale(D-w);let fe,Ce;o.around&&(fe=a.ci.convert(o.around),Ce=m.locationPoint(fe));const ke=this._zooming||D!==w,He=this._rotating||E!==Q,$e=this._pitching||V!==S,it=!m.isPaddingEqual(Z),ct=o.retainPadding===!1?m.clone():m,Xe=tt=>Pt=>{if(ke&&(tt.zoom=a.ai(w,D,Pt)),He&&(tt.bearing=a.ai(E,Q,Pt)),$e&&(tt.pitch=a.ai(S,V,Pt)),it&&(ct.interpolatePadding(F,Z,Pt),ee=ct.centerPoint.add(K)),fe)tt.setLocationAtPoint(fe,Ce);else{const gt=tt.zoomScale(tt.zoom-w),Jt=D>w?Math.min(2,Ae):Math.max(.5,Ae),kt=Math.pow(Jt,1-Pt),or=tt.unproject(he.add(le.mult(Pt*kt)).mult(gt));tt.setLocationAtPoint(tt.renderWorldCopies?or.wrap():or,ee)}return o.preloadOnly||this._fireMoveEvents(h),tt};if(o.preloadOnly){const tt=this._emulate(Xe,o.duration,m);return this._preloadTiles(tt),this}const Ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ke,this._rotating=He,this._pitching=$e,this._padding=it,this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,Ye),this._ease(Xe(m),tt=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(h,tt)},o),this}_prepareEase(o,h,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),h||m.moving||this.fire(new a.A("movestart",o)),this._zooming&&!m.zooming&&this.fire(new a.A("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new a.A("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new a.A("pitchstart",o))}_fireMoveEvents(o){this.fire(new a.A("move",o)),this._zooming&&this.fire(new a.A("zoom",o)),this._rotating&&this.fire(new a.A("rotate",o)),this._pitching&&this.fire(new a.A("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,w=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new a.A("zoomend",o)),w&&this.fire(new a.A("rotateend",o)),E&&this.fire(new a.A("pitchend",o)),this.fire(new a.A("moveend",o))}flyTo(o,h){if(this._prefersReducedMotion(o)){const Ot=a.aF(o,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Ot,h)}this.stop(),o=a.h({offset:[0,0],speed:1.2,curve:1.42,easing:a.eK},o);const m=this.transform,w=this.getZoom(),E=this.getBearing(),S=this.getPitch(),F=this.getPadding(),D="zoom"in o?a.ay(+o.zoom,m.minZoom,m.maxZoom):w,Q="bearing"in o?this._normalizeBearing(o.bearing,E):E,V="pitch"in o?+o.pitch:S,Z=this._extendPadding(o.padding),K=m.zoomScale(D-w),ee=a.P.convert(o.offset);let he=m.centerPoint.add(ee);const le=m.pointLocation(he),Ae=a.ci.convert(o.center||le);this._normalizeCenter(Ae);const fe=m.project(le),Ce=m.project(Ae).sub(fe);let ke=o.curve;const He=Math.max(m.width,m.height),$e=He/K,it=Ce.mag();if("minZoom"in o){const Ot=a.ay(Math.min(o.minZoom,w,D),m.minZoom,m.maxZoom),fr=He/m.zoomScale(Ot-w);ke=Math.sqrt(fr/it*2)}const ct=ke*ke;function Xe(Ot){const fr=($e*$e-He*He+(Ot?-1:1)*ct*ct*it*it)/(2*(Ot?$e:He)*ct*it);return Math.log(Math.sqrt(fr*fr+1)-fr)}function Ye(Ot){return(Math.exp(Ot)-Math.exp(-Ot))/2}function tt(Ot){return(Math.exp(Ot)+Math.exp(-Ot))/2}const Pt=Xe(0);let gt=function(Ot){return tt(Pt)/tt(Pt+ke*Ot)},Jt=function(Ot){return He*((tt(Pt)*(Ye(fr=Pt+ke*Ot)/tt(fr))-Ye(Pt))/ct)/it;var fr},kt=(Xe(1)-Pt)/ke;if(Math.abs(it)<1e-6||!isFinite(kt)){if(Math.abs(He-$e)<1e-6)return this.easeTo(o,h);const Ot=$e<He?-1:1;kt=Math.abs(Math.log($e/He))/ke,Jt=function(){return 0},gt=function(fr){return Math.exp(Ot*ke*fr)}}o.duration="duration"in o?+o.duration:1e3*kt/("screenSpeed"in o?+o.screenSpeed/ke:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const or=E!==Q,pr=V!==S,It=!m.isPaddingEqual(Z),ht=o.retainPadding===!1?m.clone():m,zt=Ot=>fr=>{const Ar=fr*kt,yr=1/gt(Ar);Ot.zoom=fr===1?D:w+Ot.scaleZoom(yr),or&&(Ot.bearing=a.ai(E,Q,fr)),pr&&(Ot.pitch=a.ai(S,V,fr)),It&&(ht.interpolatePadding(F,Z,fr),he=ht.centerPoint.add(ee));const Br=fr===1?Ae:Ot.unproject(fe.add(Ce.mult(Jt(Ar))).mult(yr));return Ot.setLocationAtPoint(Ot.renderWorldCopies?Br.wrap():Br,he),Ot._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(h),Ot};if(o.preloadOnly){const Ot=this._emulate(zt,o.duration,m);return this._preloadTiles(Ot),this}return this._zooming=!0,this._rotating=or,this._pitching=pr,this._padding=It,this._prepareEase(h,!1),this._ease(zt(m),()=>this._afterEase(h),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(o){}_cancelRenderFrame(o){}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,h)}if(!o){const m=this.handlers;m&&m.stop(!1)}return this}_ease(o,h,m){m.animate===!1||m.duration===0?(o(1),h()):(this._easeStart=a.q.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((a.q.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,h){o=a.bQ(o,-180,180);const m=Math.abs(o-h);return Math.abs(o-360-h)<m&&(o-=360),Math.abs(o+360-h)<m&&(o+=360),o}_normalizeCenter(o){const h=this.transform;if(h.maxBounds||h.projection.name!=="globe"&&!h.renderWorldCopies)return;const m=o.lng-h.center.lng;o.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&a.q.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,h,m){const w=Math.ceil(15*h/1e3),E=[],S=o(m.clone());for(let F=0;F<=w;F++){const D=S(F/w);E.push(D.clone())}return E}_preloadTiles(o,h){}}class Jh{constructor(o={}){this.options=o,a.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const h=this.options&&this.options.compact,m=o._getUIString("AttributionControl.ToggleAttribution");this._map=o,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=R("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const w=R("span","mapboxgl-ctrl-icon",this._compactButton);return w.setAttribute("aria-hidden","true"),w.setAttribute("title",m),this._innerContainer=R("div","mapboxgl-ctrl-attrib-inner",this._container),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.e.ACCESS_TOKEN}];if(o){const m=h.reduce((w,E,S)=>(E.value&&(w+=`${E.key}=${E.value}${S<h.length-1?"&":""}`),w),"?");o.href=`${a.e.FEEDBACK_URL}/${m}#${Fu(this._map,!0)}`,o.rel="noopener nofollow"}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const h=this._map.style._mergedSourceCaches;for(const w in h){const E=h[w];if(E.used){const S=E.getSource();S.attribution&&o.indexOf(S.attribution)<0&&o.push(S.attribution)}}o.sort((w,E)=>w.length-E.length),o=o.filter((w,E)=>{for(let S=E+1;S<o.length;S++)if(o[S].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const m=o.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,o.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class wd{constructor(){a.aV(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=R("div","mapboxgl-ctrl");const h=R("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const h in o){const m=o[h].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const h=o[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Wm{constructor(){a.aV(["_onIndoorUpdate"],this)}onAdd(o){return this._map=o,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("indoorupdate",h=>this._onIndoorUpdate({selectedFloorId:h.selectedFloorId,floors:h.floors})),this._container}_createButton(o,h){const m=R("button",o,this._container);return m.type="button",m.addEventListener("click",h),m}_setButtonTitle(o,h){this._map&&(o.setAttribute("aria-label",h),o.innerHTML=`<strong>${h}</strong>`,o.firstElementChild&&o.firstElementChild.setAttribute("title",h))}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("indoorupdate",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(o){if(!o||!o.floors)return void(this._container.style.display="none");const h=this._model;this._model=o,this._container.style.display="inline-block";const m=o.floors.sort((w,E)=>w.levelOrder-E.levelOrder);h?(Array.from(this._container.children).forEach(w=>w.remove()),this.addCurrentFloors(m)):this.addCurrentFloors(m)}addCurrentFloors(o){for(const h of o){const m=this._createButton("mapboxgl-ctrl-level-button",()=>{this._map._selectIndoorFloor(h.id),Array.from(this._container.children).forEach(w=>{w.classList.remove("mapboxgl-ctrl-level-button-selected")}),m.classList.add("mapboxgl-ctrl-level-button-selected")});this._setButtonTitle(m,h.shortName),this._model&&h.id===this._model.selectedFloorId&&(this._map._selectIndoorFloor(h.id),m.classList.add("mapboxgl-ctrl-level-button-selected")),this._container.append(m)}}}class W0{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){const h=this._currentlyRunning,m=h?this._queue.concat(h):this._queue;for(const w of m)if(w.id===o)return void(w.cancelled=!0)}run(o=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const m of h)if(!m.cancelled&&(m.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class rA{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const h=a.dx((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,h,m){this._start=this.getValue(h),this._end=o,this._startTime=h,this._endTime=h+m}}const qm={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class $m extends a.A{constructor(o,h,m,w){const{point:E,lngLat:S,originalEvent:F,target:D}=o;super(o.type,{point:E,lngLat:S,originalEvent:F,target:D}),this.preventDefault=()=>{o.preventDefault()},this.id=h,this.interaction=m,this.feature=w}}class Xm{constructor(o){this.map=o,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(o,h){if(this.typeById.has(o))throw new Error(`Interaction id "${o}" already exists.`);const m=h.filter;let w=h.type;m&&this.filters.set(o,a.b3(m)),w==="mouseover"&&(w="mouseenter"),w==="mouseout"&&(w="mouseleave");const E=this.interactionsByType.get(w)||new Map;w==="mouseenter"||w==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(o,h)):E.size===0&&this.map.on(w,this.handleType),E.size===0&&this.interactionsByType.set(w,E),E.set(o,h),this.typeById.set(o,w)}get(o){const h=this.typeById.get(o);if(!h)return;const m=this.interactionsByType.get(h);return m?m.get(o):void 0}remove(o){const h=this.typeById.get(o);if(!h)return;this.typeById.delete(o),this.filters.delete(o);const m=this.interactionsByType.get(h);m&&(m.delete(o),h==="mouseenter"||h==="mouseleave"?(this.delegatedInteractions.delete(o),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):m.size===0&&this.map.off(h,this.handleType))}queryTargets(o,h){const m=[];for(const[w,E]of h)E.target&&m.push({targetId:w,target:E.target,filter:this.filters.get(w)});return this.map.style.queryRenderedTargets(o,m,this.map.transform)}handleMove(o){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const h=this.queryTargets(o.point,Array.from(this.delegatedInteractions).reverse());h.length&&(o.type="mouseenter",this.handleType(o,h));const m=new Map;for(const[w,{feature:E}]of this.prevHoveredFeatures)this.hoveredFeatures.has(w)||m.set(E.id,E);m.size&&(o.type="mouseleave",this.handleType(o,Array.from(m.values())))}handleOut(o){const h=Array.from(this.hoveredFeatures.values()).map(({feature:m})=>m);h.length&&(o.type="mouseleave",this.handleType(o,h)),this.hoveredFeatures.clear()}handleType(o,h){const m=o.type==="mouseenter";if(m&&!this.interactionsByType.has(o.type))return void a.w("mouseenter interaction required for mouseleave to work.");const w=Array.from(this.interactionsByType.get(o.type)).reverse(),E=!!h;h=h||this.queryTargets(o.point,w);let S=!1;const F=new Set;for(const D of h){for(const[Q,V]of w){if(!V.target)continue;const Z=D.variants?D.variants[Q]:null;if(Z){for(const K of Z){if(wc(K,D,F,Q))continue;const ee=new a.dr(D,K),he=Ul(K,D,Q);E&&(ee.state=this.map.getFeatureState(ee));const le=m?this.prevHoveredFeatures.get(he):null,Ae=new $m(o,Q,V,ee),fe=le?le.stop:V.handler(Ae);if(m&&this.hoveredFeatures.set(he,{feature:D,stop:fe}),fe!==!1){S=!0;break}}if(S)break}}if(S)break}if(!S)for(const[D,Q]of w){const{handler:V,target:Z}=Q;if(!Z&&V(new $m(o,D,Q,null))!==!1)break}}}function Zm(p,o){if(Array.isArray(p)&&Array.isArray(o)){const h=new Set(p),m=new Set(o);return h.size===m.size&&p.every(w=>m.has(w))}return a.bv(p,o)}const pp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},QA={showCompass:!0,showZoom:!0,visualizePitch:!1};class ef{constructor(o,h,m=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Hp({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,m&&(this.mousePitch=new Vp({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),a.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(o,h){this.mouseRotate.mousedown(o,h),this.mousePitch&&this.mousePitch.mousedown(o,h),se()}move(o,h){const m=this.map,w=this.mouseRotate.mousemoveWindow(o,h),E=w&&w.bearingDelta;if(E&&m.setBearing(m.getBearing()+E),this.mousePitch){const S=this.mousePitch.mousemoveWindow(o,h),F=S&&S.pitchDelta;F&&m.setPitch(m.getPitch()+F)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ye(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(a.h({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),De(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,De(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=we(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=we(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Oo(p,o,h){if(p=new a.ci(p.lng,p.lat),o){const m=new a.ci(p.lng-360,p.lat),w=new a.ci(p.lng+360,p.lat),E=360*Math.ceil(Math.abs(p.lng-h.center.lng)/360),S=h.locationPoint3D(p).distSqr(o),F=o.x<0||o.y<0||o.x>h.width||o.y>h.height;h.locationPoint3D(m).distSqr(o)<S&&(F||Math.abs(m.lng-h.center.lng)<E)?p=m:h.locationPoint3D(w).distSqr(o)<S&&(F||Math.abs(w.lng-h.center.lng)<E)&&(p=w)}for(;Math.abs(p.lng-h.center.lng)>180;){const m=h.locationPoint3D(p);if(m.x>=0&&m.y>=0&&m.x<=h.width&&m.y<=h.height)break;p.lng>h.center.lng?p.lng-=360:p.lng+=360}return p}const Os={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Ds={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Pu extends a.E{constructor(o,h){super(),(o instanceof HTMLElement||h)&&(o=a.h({element:o},h)),a.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:m="center",color:w="#3FB1CE",scale:E=1,draggable:S=!1,clickTolerance:F=0,rotation:D=Ds.rotation,rotationAlignment:Q=Ds.rotationAlignment,pitchAlignment:V=Ds.pitchAlignment,occludedOpacity:Z=Ds.occludedOpacity,altitude:K=Ds.altitude}=o||{};this._anchor=m,this._color=w,this._scale=E,this._draggable=S,this._clickTolerance=F,this._rotation=D,this._rotationAlignment=Q,this._pitchAlignment=V,this._occludedOpacity=Z,this._altitude=K,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),o&&o.element?(this._element=o.element,this._offset=a.P.convert(o&&o.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=a.P.convert(o&&o.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",le=>{le.preventDefault()}),this._element.addEventListener("mousedown",le=>{le.preventDefault()});const ee=this._element.classList;for(const le in Os)ee.remove(`mapboxgl-marker-anchor-${le}`);ee.add(`mapboxgl-marker-anchor-${this._anchor}`);const he=o&&o.className?o.className.trim().split(/\s+/):[];ee.add(...he),this._popup=null}_createDefaultMarker(){const o=R("div"),h=H("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},o);if(this._altitude===0){const m=H("radialGradient",{id:"shadowGradient"},H("defs",{},h));H("stop",{offset:"10%","stop-opacity":.4},m),H("stop",{offset:"100%","stop-opacity":.05},m),H("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},h)}return H("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},h),H("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},h),H("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},h),o}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=a.ci.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(o){return o===this._altitude||(this._defaultMarker&&(this._altitude===0&&o!==0||this._altitude!==0&&o===0)&&(this._element=this._createDefaultMarker()),this._altitude=o||Ds.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,o._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const h=o.code,m=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(o){const h=o.originalEvent.target,m=this._element;this._popup&&(h===m||m.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,h=this._pos;if(!o||!h)return!1;const m=o.unproject(h,this._altitude),w=o.getFreeCameraOptions();if(!w.position)return!1;const E=w.position.toLngLat();return E.distanceTo(m)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const h=this._pos;if(!h||h.x<0||h.x>o.transform.width||h.y<0||h.y>o.transform.height)return void this._clearFadeTimer();const m=o.unproject(h,this._altitude);let w;o._showingGlobe()&&a.eW(o.transform,this._lngLat)?w=0:(w=1-o._queryFogOpacity(m),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${Os[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const o=this._pos,h=this._map,m=this.getPitchAlignment();if(!h||!o||m!=="map")return"";if(!h._showingGlobe()){const D=h.getPitch();return D?`rotateX(${D}deg)`:""}const w=a.cU(a.eX(h.transform,this._lngLat)),E=o.sub(a.eY(h.transform)),S=Math.abs(E.x)+Math.abs(E.y);if(S===0)return"";const F=w/S;return`rotateX(${-E.y*F}deg) rotateY(${E.x*F}deg)`}_calculateZTransform(){const o=this._pos,h=this._map;if(!h||!o)return"";let m=0;const w=this.getRotationAlignment();if(w==="map")if(h._showingGlobe()){const E=h.project(new a.ci(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),S=h.project(new a.ci(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(E);m=a.cU(Math.atan2(S.y,S.x))-90}else m=-h.getBearing();else if(w==="horizon"){const E=a.af(4,6,h.getZoom()),S=a.eY(h.transform);S.y+=E*h.transform.height;const F=o.sub(S),D=a.cU(Math.atan2(F.y,F.x));m=(D>90?D-270:D+90)*(1-E)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=Oo(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat,this._altitude),o===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=a.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){const h=this._map;if(!h)return;const m=this._pointerdownPos,w=this._positionDelta;if(m&&w){if(!this._isDragging){const E=this._clickTolerance||h._clickTolerance;if(o.point.dist(m)<E)return;this._isDragging=!0}this._pos=o.point.sub(w),this._lngLat=h.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.A("dragstart"))),this.fire(new a.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.A("dragend")),this._state="inactive"}_addDragHandler(o){const h=this._map,m=this._pos;h&&m&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(m),this._pointerdownPos=o.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const h=this._map;return h&&(o?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||Ds.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||Ds.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||Ds.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||Ds.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const q0={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},tf={maxWidth:100,unit:"metric"},$0={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Sf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},X0=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Vl(p=new a.P(0,0),o="bottom"){if(typeof p=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(o){case"top":return new a.P(0,p);case"top-left":return new a.P(h,h);case"top-right":return new a.P(-h,h);case"bottom":return new a.P(0,-p);case"bottom-left":return new a.P(h,-h);case"bottom-right":return new a.P(-h,-h);case"left":return new a.P(p,0);case"right":return new a.P(-p,0)}return new a.P(0,0)}return p instanceof a.P||Array.isArray(p)?a.P.convert(p):a.P.convert(p[o]||[0,0])}return{version:v,supported:U.supported,setRTLTextPlugin:a.f0,getRTLTextPluginStatus:a.e$,Map:class extends jn{constructor(p){b.mark(x.create);const o=p;if((p=a.h({},pp,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&a.eU(window)&&(p.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new EA(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies,null,null),p),this._repaint=!!p.repaint,this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new W0,this._domRenderTaskQueue=new W0,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.a$(),this._locale=a.h({},qm,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._tessellationStep=p.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=p.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new rA(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=p.scaleFactor,this._requestManager=new st(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,this._contextCreateOptions=p.contextCreateOptions?Object.assign({},p.contextCreateOptions):{},typeof p.container=="string"){const h=document.getElementById(p.container);if(!h)throw new Error(`Container '${p.container.toString()}' not found.`);this._container=h}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),this._spriteFormat=p.spriteFormat,a.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Fm),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Dl(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,(p.style||!p.testMode)&&this.setStyle(p.style||a.e.DEFAULT_STYLE,{config:p.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this.indoor=new Ts(this),p.hash&&(this._hash=new Mm(typeof p.hash=="string"&&p.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch});const h=p.bounds;h&&(this.resize(),this.fitBounds(h,a.h({},p.fitBoundsOptions,{duration:0})))}this.resize(),p.attributionControl&&this.addControl(new Jh({customAttribution:p.customAttribution})),this._logoControl=new wd,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new a.A(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new a.A(`${h.dataType}dataloading`,h))}),this._interactions=new Xm(this)}_getMapId(){return this._mapId}addControl(p,o){if(o===void 0&&(o=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new a.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=p.onAdd(this);this._controls.push(p);const m=this._controlPositions[o];return o.indexOf("bottom")!==-1?m.insertBefore(h,m.firstChild):m.appendChild(h),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new a.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(p);return o>-1&&this._controls.splice(o,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new a.A("movestart",p)).fire(new a.A("move",p)),this.fire(new a.A("resize",p)),o&&this.fire(new a.A("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(a.aG.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new a.A("zoomstart")).fire(new a.A("zoom")).fire(new a.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new a.A("zoomstart")).fire(new a.A("zoom")).fire(new a.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new a.A("pitchstart")).fire(new a.A("pitch")).fire(new a.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new a.A("pitchstart")).fire(new a.A("pitch")).fire(new a.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(p){return this._scaleFactor=p,this.painter.scaleFactor=p,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(o=>o.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return p==="auto"?navigator.language:Array.isArray(p)?p.length===0?void 0:p.map(o=>o==="auto"?navigator.language:o):p}setLanguage(p){const o=this._parseLanguage(p);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,o=p.projection.name;let h;o==="globe"&&p.zoom>=a.cI?(p.setMercatorFromTransition(),h=!0):o==="mercator"&&p.zoom<a.cI&&(p.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(p,o){return this._updateProjection(p||o||{name:"mercator"})}_updateProjection(p){let o;return o=p.name==="globe"&&this.transform.zoom>=a.cI?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(p,o){return this.transform.locationPoint3D(a.ci.convert(p),o)}unproject(p,o){return this.transform.pointLocation3D(a.P.convert(p),o)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,o,h){const m=w=>{let E=[];if(Array.isArray(o)){const S=o.filter(F=>this.getLayer(F));E=S.length?this.queryRenderedFeatures(w,{layers:S}):[]}else E=this.queryRenderedFeatures(w,{target:o});return E};if(p==="mouseenter"||p==="mouseover"){let w=!1;return{listener:h,targets:o,delegates:{mousemove:S=>{const F=m(S.point);F.length?w||(w=!0,h.call(this,new Ua(p,this,S.originalEvent,{features:F}))):w=!1},mouseout:()=>{w=!1}}}}if(p==="mouseleave"||p==="mouseout"){let w=!1;return{listener:h,targets:o,delegates:{mousemove:F=>{m(F.point).length?w=!0:w&&(w=!1,h.call(this,new Ua(p,this,F.originalEvent)))},mouseout:F=>{w&&(w=!1,h.call(this,new Ua(p,this,F.originalEvent)))}}}}{const w=E=>{const S=m(E.point);S.length&&(E.features=S,h.call(this,E),delete E.features)};return{listener:h,targets:o,delegates:{[p]:w}}}}on(p,o,h){if(typeof o=="function"||h===void 0)return super.on(p,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const m=this._createDelegatedListener(p,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(m);for(const w in m.delegates)this.on(w,m.delegates[w]);return this}once(p,o,h){if(typeof o=="function"||h===void 0)return super.once(p,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const m=this._createDelegatedListener(p,o,h);for(const w in m.delegates)this.once(w,m.delegates[w]);return this}off(p,o,h){if(typeof o=="function"||h===void 0)return super.off(p,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const m=this._delegatedListeners?this._delegatedListeners[p]:void 0;return m&&(w=>{for(let E=0;E<w.length;E++){const S=w[E];if(S.listener===h&&Zm(S.targets,o)){for(const F in S.delegates)this.off(F,S.delegates[F]);return w.splice(E,1),this}}})(m),this}queryRenderedFeatures(p,o){if(!this.style)return[];if(p===void 0||p instanceof a.P||Array.isArray(p)||o!==void 0||(o=p,p=void 0),p=p||[[0,0],[this.transform.width,this.transform.height]],!o){const E=this.style.queryRenderedFeatures(p,void 0,this.transform),S=this.style.queryRenderedFeatureset(p,void 0,this.transform);return E.concat(S)}let h=!0;if(o.target&&(h=this._isTargetValid(o.target),h&&!o.layers))return this.style.queryRenderedFeatureset(p,o,this.transform);let m=!0;if(o.layers&&Array.isArray(o.layers)){for(const E of o.layers)if(!this._isValidId(E)){m=!1;break}if(m&&!o.target)return this.style.queryRenderedFeatures(p,o,this.transform)}let w=[];return m&&(w=w.concat(this.style.queryRenderedFeatures(p,o,this.transform))),h&&(w=w.concat(this.style.queryRenderedFeatureset(p,o,this.transform))),w}querySourceFeatures(p,o){return!p||typeof p=="string"&&!this._isValidId(p)?[]:this.style.querySourceFeatures(p,o)}isPointOnSurface(p){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&a.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(p))}addInteraction(p,o){return this._interactions.add(p,o),this}removeInteraction(p){return this._interactions.remove(p),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(p){return this._cooperativeGestures=p,this}setStyle(p,o){return o=a.h({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o),this.style&&p&&o.diff!==!1&&o.localFontFamily===this._localFontFamily&&o.localIdeographFontFamily===this._localIdeographFontFamily&&!o.config?(this.style._diffStyle(p,(h,m)=>{if(h){const w=typeof h=="string"?h:h instanceof Error?h.message:h.error;a.w(`Unable to perform style diff: ${w}. Rebuilding the style from scratch.`),this._updateStyle(p,o)}else m&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(p,o))}_getUIString(p){const o=this._locale[p];if(o==null)throw new Error(`Missing UI string '${p}'`);return o}_updateStyle(p,o){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p){const h=a.h({},o);o&&o.config&&(h.initialConfig=o.config,delete h.config),this.style=new Al(this,h).load(p),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Al(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(p){return p==null?(this.fire(new a.z(new Error("IDs can't be empty."))),!1):!a.dk(p)||(this.fire(new a.z(new Error(`IDs can't contain special symbols: "${p}".`))),!1)}_isTargetValid(p){return"featuresetId"in p?this._isValidId("importId"in p?p.importId:p.featuresetId):"layerId"in p&&this._isValidId(p.layerId)}_areTargetsValid(p){if(Array.isArray(p)){for(const o of p)if(!this._isValidId(o))return!1;return!0}return this._isTargetValid(p)}addSource(p,o){return this._isValidId(p)?(this._lazyInitEmptyStyle(),this.style.addSource(p,o),this._update(!0)):this}isSourceLoaded(p){return!!this._isValidId(p)&&!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(p,o,h){this._lazyInitEmptyStyle(),this.style.addSourceType(p,o,h)}removeSource(p){return this._isValidId(p)?(this.style.removeSource(p),this._updateTerrain(),this._update(!0)):this}getSource(p){return this._isValidId(p)?this.style.getOwnSource(p):null}addImage(p,o,{pixelRatio:h=1,sdf:m=!1,stretchX:w,stretchY:E,content:S}={}){this._lazyInitEmptyStyle();const F=a.I.from(p);if(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){const{width:D,height:Q,data:V}=a.q.getImageData(o);this.style.addImage(F,{data:new a.r({width:D,height:Q},V),pixelRatio:h,stretchX:w,stretchY:E,content:S,sdf:m,version:0,usvg:!1})}else if(o.width===void 0||o.height===void 0)this.fire(new a.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:Q}=o,V=o;this.style.addImage(F,{data:new a.r({width:D,height:Q},new Uint8Array(V.data)),pixelRatio:h,stretchX:w,stretchY:E,content:S,sdf:m,usvg:!1,version:0,userImage:V}),V.onAdd&&V.onAdd(this,p)}}updateImage(p,o){this._lazyInitEmptyStyle();const h=a.I.from(p),m=this.style.getImage(h);if(!m)return void this.fire(new a.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?a.q.getImageData(o):o,{width:E,height:S,data:F}=w;if(E===void 0||S===void 0)return void this.fire(new a.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(E!==(m.usvg?m.icon.usvg_tree.width:m.data.width)||S!==(m.usvg?m.icon.usvg_tree.height:m.data.height))return void this.fire(new a.z(new Error(`The width and height of the updated image (${E}, ${S})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`)));const D=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);let Q=!1;m.usvg?(m.data=new a.r({width:E,height:S},new Uint8Array(F)),m.usvg=!1,m.icon=void 0,Q=!0):m.data.replace(F,D),this.style.updateImage(h,m,Q)}hasImage(p){return p?!!this.style&&!!this.style.getImage(a.I.from(p)):(this.fire(new a.z(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(a.I.from(p))}loadImage(p,o){a.o(this._requestManager.transformRequest(p,a.R.Image),(h,m)=>{o(h,m instanceof HTMLImageElement?a.q.getImageData(m):m)})}listImages(){return this.style.listImages().map(p=>p.name)}addModel(p,o){this._lazyInitEmptyStyle(),this.style.addModel(p,o)}hasModel(p){return p?this.style.hasModel(p):(this.fire(new a.z(new Error("Missing required model id"))),!1)}removeModel(p){this.style.removeModel(p)}listModels(){return this.style.listModels()}addLayer(p,o){return this._isValidId(p.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(p,o),this._update(!0)):this}getSlot(p){const o=this.getLayer(p);return o&&o.slot||null}setSlot(p,o){return this.style.setSlot(p,o),this.style.mergeLayers(),this._update(!0)}addImport(p,o){return this.style.addImport(p,o).catch(h=>this.fire(new a.z(new Error("Failed to add import",h)))),this}updateImport(p,o){return typeof o!="string"&&o.id!==p?(this.removeImport(p),this.addImport(o)):(this.style.updateImport(p,o),this._update(!0))}removeImport(p){return this.style.removeImport(p),this}moveImport(p,o){return this.style.moveImport(p,o),this._update(!0)}moveLayer(p,o){return this._isValidId(p)?(this.style.moveLayer(p,o),this._update(!0)):this}removeLayer(p){return this._isValidId(p)?(this.style.removeLayer(p),this._update(!0)):this}getLayer(p){if(!this._isValidId(p))return null;const o=this.style.getOwnLayer(p);return o?o.type==="custom"?o.implementation:o.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(p,o,h){return this._isValidId(p)?(this.style.setLayerZoomRange(p,o,h),this._update(!0)):this}setFilter(p,o,h={}){return this._isValidId(p)?(this.style.setFilter(p,o,h),this._update(!0)):this}getFilter(p){return this._isValidId(p)?this.style.getFilter(p):null}setPaintProperty(p,o,h,m={}){return this._isValidId(p)?(this.style.setPaintProperty(p,o,h,m),this._update(!0)):this}getPaintProperty(p,o){return this._isValidId(p)?this.style.getPaintProperty(p,o):null}setLayoutProperty(p,o,h,m={}){return this._isValidId(p)?(this.style.setLayoutProperty(p,o,h,m),this._update(!0)):this}getLayoutProperty(p,o){return this._isValidId(p)?this.style.getLayoutProperty(p,o):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(p){return this.style.setGlyphsUrl(p),this._update(!0)}getSchema(p){return this.style.getSchema(p)}setSchema(p,o){return this.style.setSchema(p,o),this._update(!0)}getConfig(p){return this.style.getConfig(p)}setConfig(p,o){return this.style.setConfig(p,o),this._update(!0)}getConfigProperty(p,o){return this.style.getConfigProperty(p,o)}setConfigProperty(p,o,h){return this.style.setConfigProperty(p,o,h),this._update(!0)}getFeaturesetDescriptors(p){return this.style.getFeaturesetDescriptors(p)}setLights(p){if(this._lazyInitEmptyStyle(),p&&p.length===1&&p[0].type==="flat"){const o=p[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(p),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const p=this.style.getLights()||[];return p.length===0&&p.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),p}setLight(p,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:p}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(p){return this._lazyInitEmptyStyle(),this.style.setSnow(p),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(p){return this._lazyInitEmptyStyle(),this.style.setRain(p),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(p){return this._lazyInitEmptyStyle(),this.style.setColorTheme(p),this._update(!0)}setImportColorTheme(p,o){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(p,o),this._update(!0)}setCamera(p){return this.style.setCamera(p),this._triggerCameraUpdate(p)}_triggerCameraUpdate(p){return this._update(this.transform.setOrthographicProjectionAtLowPitch(p["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.ci.convert(p),this.transform):0}setFeatureState(p,o){return p.source&&!this._isValidId(p.source)?this:(this.style.setFeatureState(p,o),this._update())}removeFeatureState(p,o){return p.source&&!this._isValidId(p.source)?this:(this.style.removeFeatureState(p,o),this._update())}getFeatureState(p){return p.source&&!this._isValidId(p.source)?null:this.style.getFeatureState(p)}_selectIndoorFloor(p){this.indoor.selectFloor(p)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new Wm),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let h,m,w,E=this._container;for(;E&&(!m||!w);){const S=window.getComputedStyle(E).transform;S&&S!=="none"&&(h=S.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(m=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(w=h[3])),E=E.parentElement}this._containerWidth=m?Math.abs(p/m):p,this._containerHeight=w?Math.abs(o/w):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=R("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=R("div","mapboxgl-canvas-container",p);this._canvas=R("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=R("div","mapboxgl-control-container",p),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(w=>{m[w]=R("div",`mapboxgl-ctrl-${w}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,o){const h=a.q.devicePixelRatio||1;this._canvas.width=h*Math.ceil(p),this._canvas.height=h*Math.ceil(o),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${o}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const o=this._markers.indexOf(p);o!==-1&&this._markers.splice(o,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const o=this._popups.indexOf(p);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const p=a.h({},U.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",p);o?(Zt(o,!0),this.painter=new kA(o,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",h=>{h.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.l.testSupport(o)):this.fire(new a.z(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.A("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new a.A("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let o;this.fire(new a.A("renderstart")),++this._frameId;const h=this.painter.context.extTimerQuery,m=a.q.now(),w=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=w.createQuery(),w.beginQuery(h.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const Q=this.transform.zoom,V=this.transform.pitch,Z=a.q.now(),K=new a.aa(Q,{now:Z,fadeDuration:E,pitch:V,transition:this.style.transition,worldview:this._worldview});this.style.update(K)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(m),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(m);const F=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),F&&(this._placementDirty=F.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,b.mark(x.load),this.fire(new a.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const Q=a.q.now()-m;w.endQuery(h.TIME_ELAPSED_EXT),setTimeout(()=>{const V=w.getQueryParameter(o,w.QUERY_RESULT)/1e6;w.deleteQuery(o),this.fire(new a.A("gpu-timing-frame",{cpuTime:Q,gpuTime:V}))},50)}if(this.listens("gpu-timing-layer")){const Q=this.painter.collectGpuTimers();setTimeout(()=>{const V=this.painter.queryGpuTimers(Q);this.fire(new a.A("gpu-timing-layer",{layerTimes:V}))},50)}if(this.listens("gpu-timing-deferred-render")){const Q=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const V=this.painter.queryGpuTimeDeferredRender(Q);this.fire(new a.A("gpu-timing-deferred-render",{gpuTime:V}))},50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(D||this._repaint)this.triggerRepaint();else{const Q=this.idle();if(Q&&(S=this._updateAverageElevation(m,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),Q&&(this.fire(new a.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const V=this._calculateSpeedIndex();this.fire(new a.A("speedindexcompleted",{speedIndex:V})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,b.mark(x.fullLoad),this._performanceMetricsCollection&&Dt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const o of this._markers)p&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!p||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(p,o=!1){const h=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(o||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const w=this.transform.averageElevation;let E=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=p;const S=Math.abs(w-E);if(S>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(E),h(E);this._averageElevation.easeTo(E,p,300)}else if(S>1e-4)return this._averageElevation.jumpTo(E),h(E)}return!!this._averageElevation.isEasing(p)&&h(this._averageElevation.getValue(p))}_authenticate(){Ct(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===Ze||p.status===401)){const o=this.painter.context.gl;Zt(o,!1),this._logoControl instanceof wd&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Fe(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&et(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const h=this.painter.context.gl,m=h.createFramebuffer();function w(E){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,E,0);const S=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,S),S}return h.bindFramebuffer(h.FRAMEBUFFER,m),this._canvasPixelComparison(w(p),o.canvasCopies.map(w),o.timeStamps)}_canvasPixelComparison(p,o,h){let m=h[1]-h[0];const w=p.length/4;for(let E=0;E<o.length;E++){const S=o[E];let F=0;for(let D=0;D<S.length;D+=4)S[D]===p[D]&&S[D+1]===p[D+1]&&S[D+2]===p[D+2]&&S[D+3]===p[D+3]&&(F+=1);m+=(h[E+2]-h[E+1])*(1-F/w)}return m}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),mr.delete(this.painter.context.gl),pt.remove(),Le.remove(),this._removed=!0,this.fire(new a.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=a.q.frame(o=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(o)}))}_preloadTiles(p){const o=this.style?this.style.getSourceCaches():[];return a.bt(o,(h,m)=>h._preloadTiles(p,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(p){this._showParseStatus!==p&&(this._showParseStatus=p,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(p){this._showLayers2DWireframe!==p&&(this._showLayers2DWireframe=p,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(p){this._showLayers3DWireframe!==p&&(this._showLayers3DWireframe=p,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,this._tp.refreshUI(),p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,this._tp.refreshUI(),p&&this._update())}_setCacheLimits(p,o){a.eV(p,o)}get version(){return v}},NavigationControl:class{constructor(p={}){this.options=a.h({},QA,p),this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(a.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),R("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),R("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:o}):h.resetNorth({},{originalEvent:o}))}),this._compassIcon=R("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const o=p.getZoom(),h=o===p.getMaxZoom(),m=o===p.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ef(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,o){const h=R("button",p,this._container);return h.type="button",h.addEventListener("click",o),h}_setButtonTitle(p,o){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${o}`);p.setAttribute("aria-label",h),p.firstElementChild&&p.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends a.E{constructor(p={}){super();const o=navigator.geolocation;this.options=a.h({geolocation:o},q0,p),a.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=lp(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const o=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,p(h)};this._supportsGeolocation!==void 0?p(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(h=>o(h.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(p){const o=this._map.getMaxBounds(),h=p.coords;return!!o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new a.A("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.A("geolocate",p)),this._finish()}}_updateCamera(p){const o=new a.ci(p.coords.longitude,p.coords.latitude),h=p.coords.accuracy,m=this._map.getBearing(),w=a.h({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(h),w,{geolocateSource:!0})}_updateMarker(p){if(p){const o=new a.ci(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,o=a.cb(1,p._center.lat)*p.worldSize,h=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.A("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=R("button","mapboxgl-ctrl-geolocate",this._container),R("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=R("div","mapboxgl-user-location"),this._dotElement.appendChild(R("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(R("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Pu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=R("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Pu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.A("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Jh,ScaleControl:class{constructor(p={}){this.options=a.h({},tf,p),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,o=this._map,h=o._containerHeight/2,m=o._containerWidth/2-p/2,w=o.unproject([m,h]),E=o.unproject([m+p,h]),S=w.distanceTo(E);if(this.options.unit==="imperial"){const F=3.2808*S;F>5280?this._setScale(p,F/5280,"mile"):this._setScale(p,F,"foot")}else this.options.unit==="nautical"?this._setScale(p,S/1852,"nautical-mile"):S>=1e3?this._setScale(p,S/1e3,"kilometer"):this._setScale(p,S,"meter")}_setScale(p,o,h){this._map._requestDomTask(()=>{const m=function(E){const S=Math.pow(10,`${Math.floor(E)}`.length-1);let F=E/S;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(D){const Q=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*Q)/Q}(F),S*F}(o),w=m/o;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(m):`${m}&nbsp;${$0[h]}`,this._container.style.width=p*w+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p={}){this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:a.w("Full screen control 'container' must be a DOM element.")),a.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=R("button","mapboxgl-ctrl-fullscreen",this._controlContainer);R("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:Wm,Popup:class extends a.E{constructor(p){super(),this.options=a.h(Object.create(Sf),p),this._altitude=this.options.altitude,a.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new a.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new a.A("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=a.ci.convert(p),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(p){return this._altitude=p,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const o=document.createDocumentFragment(),h=document.createElement("body");let m;for(h.innerHTML=p;m=h.firstChild,m;)o.appendChild(m);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=R("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(p),this.options.closeButton){const h=this._closeButton=R("button","mapboxgl-popup-close-button",o);h.type="button",h.setAttribute("aria-label","Close popup"),h.innerHTML='<span aria-hidden="true">&#215;</span>',h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let o;return this._classList.delete(p)?o=!1:(this._classList.add(p),o=!0),this._updateClassList(),o}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const o=this._map,h=this._container,m=this._pos;if(!o||!h||!m)return"bottom";const w=h.offsetWidth,E=h.offsetHeight,S=m.x<w/2,F=m.x>o.transform.width-w/2;if(m.y+p<E)return S?"top-left":F?"top-right":"top";if(m.y>o.transform.height-E){if(S)return"bottom-left";if(F)return"bottom-right"}return S?"left":F?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),p.className=o.join(" ")}_update(p){const o=this._map,h=this._content;if(!o||!this._lngLat&&!this._trackPointer||!h)return;let m=this._container;if(m||(m=this._container=R("div","mapboxgl-popup",o.getContainer()),this._tip=R("div","mapboxgl-popup-tip",m),m.appendChild(h)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Oo(this._lngLat,this._pos,o.transform)),!this._trackPointer||p){const w=this._pos=this._trackPointer&&p instanceof a.P?p:o.project(this._lngLat,this._altitude),E=Vl(this.options.offset),S=this._anchor=this._getAnchor(E.y),F=Vl(this.options.offset,S),D=w.add(F).round();o._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${Os[S]} translate(${D.x}px,${D.y}px)`)})}if(!this._marker&&o._showingGlobe()){const w=a.eW(o.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(X0);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:Pu,Style:Al,LngLat:a.ci,LngLatBounds:a.aG,Point:a.P,MercatorCoordinate:a.ac,FreeCameraOptions:Ql,Evented:a.E,config:a.e,prewarm:a.e_,clearPrewarmedResources:a.eZ,get accessToken(){return a.e.ACCESS_TOKEN},set accessToken(p){a.e.ACCESS_TOKEN=p},get baseApiUrl(){return a.e.API_URL},set baseApiUrl(p){a.e.API_URL=p},get workerCount(){return a.f7.workerCount},set workerCount(p){a.f7.workerCount=p},get maxParallelImageRequests(){return a.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){a.e.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){a.f6(p)},get workerUrl(){return a.f5.workerUrl},set workerUrl(p){a.f5.workerUrl=p},get workerClass(){return a.f5.workerClass},set workerClass(p){a.f5.workerClass=p},get workerParams(){return a.f5.workerParams},set workerParams(p){a.f5.workerParams=p},get dracoUrl(){return a.f4()},set dracoUrl(p){a.f3(p)},get meshoptUrl(){return a.f2()},set meshoptUrl(p){a.f1(p)},setNow:a.q.setNow,restoreNow:a.q.restoreNow}});var d=l;return d})}(Xw)),Xw.exports}var eX=J$();const Jp=od(eX);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var u2={};u2.version="0.18.5";var N6=1252,tX=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],z6=function(e){tX.indexOf(e)!=-1&&(N6=e)};function rX(){z6(1252)}var a1=function(e){z6(e)};function nX(){a1(1200),rX()}var qx=function(t){return String.fromCharCode(t)},bM=function(t){return String.fromCharCode(t)},h2,mg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o1(e){for(var t="",r=0,n=0,l=0,u=0,d=0,a=0,v=0,x=0;x<e.length;)r=e.charCodeAt(x++),u=r>>2,n=e.charCodeAt(x++),d=(r&3)<<4|n>>4,l=e.charCodeAt(x++),a=(n&15)<<2|l>>6,v=l&63,isNaN(n)?a=v=64:isNaN(l)&&(v=64),t+=mg.charAt(u)+mg.charAt(d)+mg.charAt(a)+mg.charAt(v);return t}function Am(e){var t="",r=0,n=0,l=0,u=0,d=0,a=0,v=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)u=mg.indexOf(e.charAt(x++)),d=mg.indexOf(e.charAt(x++)),r=u<<2|d>>4,t+=String.fromCharCode(r),a=mg.indexOf(e.charAt(x++)),n=(d&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(n)),v=mg.indexOf(e.charAt(x++)),l=(a&3)<<6|v,v!==64&&(t+=String.fromCharCode(l));return t}var Jo=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),xm=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function E0(e){return Jo?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function EM(e){return Jo?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Md=function(t){return Jo?xm(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Bb(e){if(typeof ArrayBuffer>"u")return Md(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function I1(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function iX(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var oh=Jo?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:xm(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),l=0;for(t=0,r=0;t<e.length;r+=l,++t)if(l=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(u){return Array.isArray(u)?u:[].slice.call(u)}))};function aX(e){for(var t=[],r=0,n=e.length+250,l=E0(e.length+255),u=0;u<e.length;++u){var d=e.charCodeAt(u);if(d<128)l[r++]=d;else if(d<2048)l[r++]=192|d>>6&31,l[r++]=128|d&63;else if(d>=55296&&d<57344){d=(d&1023)+64;var a=e.charCodeAt(++u)&1023;l[r++]=240|d>>8&7,l[r++]=128|d>>2&63,l[r++]=128|a>>6&15|(d&3)<<4,l[r++]=128|a&63}else l[r++]=224|d>>12&15,l[r++]=128|d>>6&63,l[r++]=128|d&63;r>n&&(t.push(l.slice(0,r)),r=0,l=E0(65535),n=65530)}return t.push(l.slice(0,r)),oh(t)}var Vy=/\u0000/g,$x=/[\u0001-\u0006]/g;function Q_(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Rd(e,t){var r=""+e;return r.length>=t?r:Zl("0",t-r.length)+r}function aI(e,t){var r=""+e;return r.length>=t?r:Zl(" ",t-r.length)+r}function f2(e,t){var r=""+e;return r.length>=t?r:r+Zl(" ",t-r.length)}function oX(e,t){var r=""+Math.round(e);return r.length>=t?r:Zl("0",t-r.length)+r}function sX(e,t){var r=""+e;return r.length>=t?r:Zl("0",t-r.length)+r}var BM=Math.pow(2,32);function m_(e,t){if(e>BM||e<-BM)return oX(e,t);var r=Math.round(e);return sX(r,t)}function A2(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var CM=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],NB=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function lX(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Jl={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},SM={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},cX={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function d2(e,t,r){for(var n=e<0?-1:1,l=e*n,u=0,d=1,a=0,v=1,x=0,b=0,I=Math.floor(l);x<t&&(I=Math.floor(l),a=I*d+u,b=I*x+v,!(l-I<5e-8));)l=1/(l-I),u=d,d=a,v=x,x=b;if(b>t&&(x>t?(b=v,a=u):(b=x,a=d)),!r)return[0,n*a,b];var M=Math.floor(n*a/b);return[M,n*a-M*b,b]}function Xx(e,t,r){if(e>2958465||e<0)return null;var n=e|0,l=Math.floor(86400*(e-n)),u=0,d=[],a={D:n,T:l,u:86400*(e-n)-l,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++l==86400&&(a.T=l=0,++n,++a.D)),n===60)d=r?[1317,10,29]:[1900,2,29],u=3;else if(n===0)d=r?[1317,8,29]:[1900,1,0],u=6;else{n>60&&--n;var v=new Date(1900,0,1);v.setDate(v.getDate()+n-1),d=[v.getFullYear(),v.getMonth()+1,v.getDate()],u=v.getDay(),n<60&&(u=(u+6)%7),r&&(u=mX(v,d))}return a.y=d[0],a.m=d[1],a.d=d[2],a.S=l%60,l=Math.floor(l/60),a.M=l%60,l=Math.floor(l/60),a.H=l,a.q=u,a}var Q6=new Date(1899,11,31,0,0,0),uX=Q6.getTime(),hX=new Date(1900,2,1,0,0,0);function j6(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=hX&&(r+=1440*60*1e3),(r-(uX+(e.getTimezoneOffset()-Q6.getTimezoneOffset())*6e4))/(1440*60*1e3)}function oI(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fX(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function AX(e){var t=e<0?12:11,r=oI(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function dX(e){var t=oI(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function pX(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=AX(e):t===10?r=e.toFixed(10).substr(0,12):r=dX(e),oI(fX(r.toUpperCase()))}function wT(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):pX(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Bg(14,j6(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function mX(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function gX(e,t,r,n){var l="",u=0,d=0,a=r.y,v,x=0;switch(e){case 98:a=r.y+543;case 121:switch(t.length){case 1:case 2:v=a%100,x=2;break;default:v=a%1e4,x=4;break}break;case 109:switch(t.length){case 1:case 2:v=r.m,x=t.length;break;case 3:return NB[r.m-1][1];case 5:return NB[r.m-1][0];default:return NB[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:v=r.d,x=t.length;break;case 3:return CM[r.q][0];default:return CM[r.q][1]}break;case 104:switch(t.length){case 1:case 2:v=1+(r.H+11)%12,x=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:v=r.H,x=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:v=r.M,x=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Rd(r.S,t.length):(n>=2?d=n===3?1e3:100:d=n===1?10:1,u=Math.round(d*(r.S+r.u)),u>=60*d&&(u=0),t==="s"?u===0?"0":""+u/d:(l=Rd(u,2+n),t==="ss"?l.substr(0,2):"."+l.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":v=r.D*24+r.H;break;case"[m]":case"[mm]":v=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":v=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}x=t.length===3?1:2;break;case 101:v=a,x=1;break}var b=x>0?Rd(v,x):"";return b}function gg(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var H6=/%/g;function _X(e,t,r){var n=t.replace(H6,""),l=t.length-n.length;return om(e,n,r*Math.pow(10,2*l))+Zl("%",l)}function vX(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return om(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function V6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+V6(e,-t);var l=e.indexOf(".");l===-1&&(l=e.indexOf("E"));var u=Math.floor(Math.log(t)*Math.LOG10E)%l;if(u<0&&(u+=l),r=(t/Math.pow(10,u)).toPrecision(n+1+(l+u)%l),r.indexOf("e")===-1){var d=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(d-r.length+u):r+="E+"+(d-u);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,l)+"."+r.substr(2+l),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,v,x,b){return v+x+b.substr(0,(l+u)%l)+"."+b.substr(u)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var G6=/# (\?+)( ?)\/( ?)(\d+)/;function yX(e,t,r){var n=parseInt(e[4],10),l=Math.round(t*n),u=Math.floor(l/n),d=l-u*n,a=n;return r+(u===0?"":""+u)+" "+(d===0?Zl(" ",e[1].length+1+e[4].length):aI(d,e[1].length)+e[2]+"/"+e[3]+Rd(a,e[4].length))}function xX(e,t,r){return r+(t===0?"":""+t)+Zl(" ",e[1].length+2+e[4].length)}var K6=/^#*0*\.([0#]+)/,W6=/\).*[0#]/,q6=/\(###\) ###\\?-####/;function of(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function TM(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function IM(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function wX(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function bX(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function WA(e,t,r){if(e.charCodeAt(0)===40&&!t.match(W6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?WA("n",n,r):"("+WA("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return vX(e,t,r);if(t.indexOf("%")!==-1)return _X(e,t,r);if(t.indexOf("E")!==-1)return V6(t,r);if(t.charCodeAt(0)===36)return"$"+WA(e,t.substr(t.charAt(1)==" "?2:1),r);var l,u,d,a,v=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+m_(v,t.length);if(t.match(/^[#?]+$/))return l=m_(r,0),l==="0"&&(l=""),l.length>t.length?l:of(t.substr(0,t.length-l.length))+l;if(u=t.match(G6))return yX(u,v,x);if(t.match(/^#+0+$/))return x+m_(v,t.length-t.indexOf("0"));if(u=t.match(K6))return l=TM(r,u[1].length).replace(/^([^\.]+)$/,"$1."+of(u[1])).replace(/\.$/,"."+of(u[1])).replace(/\.(\d*)$/,function(U,R){return"."+R+Zl("0",of(u[1]).length-R.length)}),t.indexOf("0.")!==-1?l:l.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),u=t.match(/^(0*)\.(#*)$/))return x+TM(v,u[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=t.match(/^#{1,3},##0(\.?)$/))return x+gg(m_(v,0));if(u=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+WA(e,t,-r):gg(""+(Math.floor(r)+wX(r,u[1].length)))+"."+Rd(IM(r,u[1].length),u[1].length);if(u=t.match(/^#,#*,#0/))return WA(e,t.replace(/^#,#*,/,""),r);if(u=t.match(/^([0#]+)(\\?-([0#]+))+$/))return l=Q_(WA(e,t.replace(/[\\-]/g,""),r)),d=0,Q_(Q_(t.replace(/\\/g,"")).replace(/[0#]/g,function(U){return d<l.length?l.charAt(d++):U==="0"?"0":""}));if(t.match(q6))return l=WA(e,"##########",r),"("+l.substr(0,3)+") "+l.substr(3,3)+"-"+l.substr(6);var b="";if(u=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(u[4].length,7),a=d2(v,Math.pow(10,d)-1,!1),l=""+x,b=om("n",u[1],a[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),l+=b+u[2]+"/"+u[3],b=f2(a[2],d),b.length<u[4].length&&(b=of(u[4].substr(u[4].length-b.length))+b),l+=b,l;if(u=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(u[1].length,u[4].length),7),a=d2(v,Math.pow(10,d)-1,!0),x+(a[0]||(a[1]?"":"0"))+" "+(a[1]?aI(a[1],d)+u[2]+"/"+u[3]+f2(a[2],d):Zl(" ",2*d+1+u[2].length+u[3].length));if(u=t.match(/^[#0?]+$/))return l=m_(r,0),t.length<=l.length?l:of(t.substr(0,t.length-l.length))+l;if(u=t.match(/^([#0?]+)\.([#0]+)$/)){l=""+r.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),d=l.indexOf(".");var I=t.indexOf(".")-d,M=t.length-l.length-I;return of(t.substr(0,I)+l+t.substr(t.length-M))}if(u=t.match(/^00,000\.([#0]*0)$/))return d=IM(r,u[1].length),r<0?"-"+WA(e,t,-r):gg(bX(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(U){return"00,"+(U.length<3?Rd(0,3-U.length):"")+U})+"."+Rd(d,u[1].length);switch(t){case"###,##0.00":return WA(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var L=gg(m_(v,0));return L!=="0"?x+L:"";case"###,###.00":return WA(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return WA(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function EX(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return om(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function BX(e,t,r){var n=t.replace(H6,""),l=t.length-n.length;return om(e,n,r*Math.pow(10,2*l))+Zl("%",l)}function $6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+$6(e,-t);var l=e.indexOf(".");l===-1&&(l=e.indexOf("E"));var u=Math.floor(Math.log(t)*Math.LOG10E)%l;if(u<0&&(u+=l),r=(t/Math.pow(10,u)).toPrecision(n+1+(l+u)%l),!r.match(/[Ee]/)){var d=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(d-r.length+u):r+="E+"+(d-u),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,v,x,b){return v+x+b.substr(0,(l+u)%l)+"."+b.substr(u)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function wp(e,t,r){if(e.charCodeAt(0)===40&&!t.match(W6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wp("n",n,r):"("+wp("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return EX(e,t,r);if(t.indexOf("%")!==-1)return BX(e,t,r);if(t.indexOf("E")!==-1)return $6(t,r);if(t.charCodeAt(0)===36)return"$"+wp(e,t.substr(t.charAt(1)==" "?2:1),r);var l,u,d,a,v=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+Rd(v,t.length);if(t.match(/^[#?]+$/))return l=""+r,r===0&&(l=""),l.length>t.length?l:of(t.substr(0,t.length-l.length))+l;if(u=t.match(G6))return xX(u,v,x);if(t.match(/^#+0+$/))return x+Rd(v,t.length-t.indexOf("0"));if(u=t.match(K6))return l=(""+r).replace(/^([^\.]+)$/,"$1."+of(u[1])).replace(/\.$/,"."+of(u[1])),l=l.replace(/\.(\d*)$/,function(U,R){return"."+R+Zl("0",of(u[1]).length-R.length)}),t.indexOf("0.")!==-1?l:l.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),u=t.match(/^(0*)\.(#*)$/))return x+(""+v).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=t.match(/^#{1,3},##0(\.?)$/))return x+gg(""+v);if(u=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wp(e,t,-r):gg(""+r)+"."+Zl("0",u[1].length);if(u=t.match(/^#,#*,#0/))return wp(e,t.replace(/^#,#*,/,""),r);if(u=t.match(/^([0#]+)(\\?-([0#]+))+$/))return l=Q_(wp(e,t.replace(/[\\-]/g,""),r)),d=0,Q_(Q_(t.replace(/\\/g,"")).replace(/[0#]/g,function(U){return d<l.length?l.charAt(d++):U==="0"?"0":""}));if(t.match(q6))return l=wp(e,"##########",r),"("+l.substr(0,3)+") "+l.substr(3,3)+"-"+l.substr(6);var b="";if(u=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(u[4].length,7),a=d2(v,Math.pow(10,d)-1,!1),l=""+x,b=om("n",u[1],a[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),l+=b+u[2]+"/"+u[3],b=f2(a[2],d),b.length<u[4].length&&(b=of(u[4].substr(u[4].length-b.length))+b),l+=b,l;if(u=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(u[1].length,u[4].length),7),a=d2(v,Math.pow(10,d)-1,!0),x+(a[0]||(a[1]?"":"0"))+" "+(a[1]?aI(a[1],d)+u[2]+"/"+u[3]+f2(a[2],d):Zl(" ",2*d+1+u[2].length+u[3].length));if(u=t.match(/^[#0?]+$/))return l=""+r,t.length<=l.length?l:of(t.substr(0,t.length-l.length))+l;if(u=t.match(/^([#0]+)\.([#0]+)$/)){l=""+r.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),d=l.indexOf(".");var I=t.indexOf(".")-d,M=t.length-l.length-I;return of(t.substr(0,I)+l+t.substr(t.length-M))}if(u=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+wp(e,t,-r):gg(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(U){return"00,"+(U.length<3?Rd(0,3-U.length):"")+U})+"."+Rd(0,u[1].length);switch(t){case"###,###":case"##,###":case"#,###":var L=gg(""+v);return L!=="0"?x+L:"";default:if(t.match(/\.[0#?]*$/))return wp(e,t.slice(0,t.lastIndexOf(".")),r)+of(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function om(e,t,r){return(r|0)===r?wp(e,t,r):WA(e,t,r)}function CX(e){for(var t=[],r=!1,n=0,l=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(l,n-l),l=n+1}if(t[t.length]=e.substr(l),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var X6=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Z6(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":A2(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(X6))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function SX(e,t,r,n){for(var l=[],u="",d=0,a="",v="t",x,b,I,M="H";d<e.length;)switch(a=e.charAt(d)){case"G":if(!A2(e,d))throw new Error("unrecognized character "+a+" in "+e);l[l.length]={t:"G",v:"General"},d+=7;break;case'"':for(u="";(I=e.charCodeAt(++d))!==34&&d<e.length;)u+=String.fromCharCode(I);l[l.length]={t:"t",v:u},++d;break;case"\\":var L=e.charAt(++d),U=L==="("||L===")"?L:"t";l[l.length]={t:U,v:L},++d;break;case"_":l[l.length]={t:"t",v:" "},d+=2;break;case"@":l[l.length]={t:"T",v:t},++d;break;case"B":case"b":if(e.charAt(d+1)==="1"||e.charAt(d+1)==="2"){if(x==null&&(x=Xx(t,r,e.charAt(d+1)==="2"),x==null))return"";l[l.length]={t:"X",v:e.substr(d,2)},v=a,d+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||x==null&&(x=Xx(t,r),x==null))return"";for(u=a;++d<e.length&&e.charAt(d).toLowerCase()===a;)u+=a;a==="m"&&v.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=M),l[l.length]={t:a,v:u},v=a;break;case"A":case"a":case"上":var R={t:a,v:a};if(x==null&&(x=Xx(t,r)),e.substr(d,3).toUpperCase()==="A/P"?(x!=null&&(R.v=x.H>=12?"P":"A"),R.t="T",M="h",d+=3):e.substr(d,5).toUpperCase()==="AM/PM"?(x!=null&&(R.v=x.H>=12?"PM":"AM"),R.t="T",d+=5,M="h"):e.substr(d,5).toUpperCase()==="上午/下午"?(x!=null&&(R.v=x.H>=12?"下午":"上午"),R.t="T",d+=5,M="h"):(R.t="t",++d),x==null&&R.t==="T")return"";l[l.length]=R,v=a;break;case"[":for(u=a;e.charAt(d++)!=="]"&&d<e.length;)u+=e.charAt(d);if(u.slice(-1)!=="]")throw'unterminated "[" block: |'+u+"|";if(u.match(X6)){if(x==null&&(x=Xx(t,r),x==null))return"";l[l.length]={t:"Z",v:u.toLowerCase()},v=u.charAt(1)}else u.indexOf("$")>-1&&(u=(u.match(/\$([^-\[\]]*)/)||[])[1]||"$",Z6(e)||(l[l.length]={t:"t",v:u}));break;case".":if(x!=null){for(u=a;++d<e.length&&(a=e.charAt(d))==="0";)u+=a;l[l.length]={t:"s",v:u};break}case"0":case"#":for(u=a;++d<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(d))>-1;)u+=a;l[l.length]={t:"n",v:u};break;case"?":for(u=a;e.charAt(++d)===a;)u+=a;l[l.length]={t:a,v:u},v=a;break;case"*":++d,(e.charAt(d)==" "||e.charAt(d)=="*")&&++d;break;case"(":case")":l[l.length]={t:n===1?"t":a,v:a},++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(u=a;d<e.length&&"0123456789".indexOf(e.charAt(++d))>-1;)u+=e.charAt(d);l[l.length]={t:"D",v:u};break;case" ":l[l.length]={t:a,v:a},++d;break;case"$":l[l.length]={t:"t",v:"$"},++d;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);l[l.length]={t:"t",v:a},++d;break}var H=0,q=0,te;for(d=l.length-1,v="t";d>=0;--d)switch(l[d].t){case"h":case"H":l[d].t=M,v="h",H<1&&(H=1);break;case"s":(te=l[d].v.match(/\.0+$/))&&(q=Math.max(q,te[0].length-1)),H<3&&(H=3);case"d":case"y":case"M":case"e":v=l[d].t;break;case"m":v==="s"&&(l[d].t="M",H<2&&(H=2));break;case"X":break;case"Z":H<1&&l[d].v.match(/[Hh]/)&&(H=1),H<2&&l[d].v.match(/[Mm]/)&&(H=2),H<3&&l[d].v.match(/[Ss]/)&&(H=3)}switch(H){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var J="",se;for(d=0;d<l.length;++d)switch(l[d].t){case"t":case"T":case" ":case"D":break;case"X":l[d].v="",l[d].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[d].v=gX(l[d].t.charCodeAt(0),l[d].v,x,q),l[d].t="t";break;case"n":case"?":for(se=d+1;l[se]!=null&&((a=l[se].t)==="?"||a==="D"||(a===" "||a==="t")&&l[se+1]!=null&&(l[se+1].t==="?"||l[se+1].t==="t"&&l[se+1].v==="/")||l[d].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(l[se].v==="/"||l[se].v===" "&&l[se+1]!=null&&l[se+1].t=="?"));)l[d].v+=l[se].v,l[se]={v:"",t:";"},++se;J+=l[d].v,d=se-1;break;case"G":l[d].t="t",l[d].v=wT(t,r);break}var ye="",Se,Be;if(J.length>0){J.charCodeAt(0)==40?(Se=t<0&&J.charCodeAt(0)===45?-t:t,Be=om("n",J,Se)):(Se=t<0&&n>1?-t:t,Be=om("n",J,Se),Se<0&&l[0]&&l[0].t=="t"&&(Be=Be.substr(1),l[0].v="-"+l[0].v)),se=Be.length-1;var De=l.length;for(d=0;d<l.length;++d)if(l[d]!=null&&l[d].t!="t"&&l[d].v.indexOf(".")>-1){De=d;break}var we=l.length;if(De===l.length&&Be.indexOf("E")===-1){for(d=l.length-1;d>=0;--d)l[d]==null||"n?".indexOf(l[d].t)===-1||(se>=l[d].v.length-1?(se-=l[d].v.length,l[d].v=Be.substr(se+1,l[d].v.length)):se<0?l[d].v="":(l[d].v=Be.substr(0,se+1),se=-1),l[d].t="t",we=d);se>=0&&we<l.length&&(l[we].v=Be.substr(0,se+1)+l[we].v)}else if(De!==l.length&&Be.indexOf("E")===-1){for(se=Be.indexOf(".")-1,d=De;d>=0;--d)if(!(l[d]==null||"n?".indexOf(l[d].t)===-1)){for(b=l[d].v.indexOf(".")>-1&&d===De?l[d].v.indexOf(".")-1:l[d].v.length-1,ye=l[d].v.substr(b+1);b>=0;--b)se>=0&&(l[d].v.charAt(b)==="0"||l[d].v.charAt(b)==="#")&&(ye=Be.charAt(se--)+ye);l[d].v=ye,l[d].t="t",we=d}for(se>=0&&we<l.length&&(l[we].v=Be.substr(0,se+1)+l[we].v),se=Be.indexOf(".")+1,d=De;d<l.length;++d)if(!(l[d]==null||"n?(".indexOf(l[d].t)===-1&&d!==De)){for(b=l[d].v.indexOf(".")>-1&&d===De?l[d].v.indexOf(".")+1:0,ye=l[d].v.substr(0,b);b<l[d].v.length;++b)se<Be.length&&(ye+=Be.charAt(se++));l[d].v=ye,l[d].t="t",we=d}}}for(d=0;d<l.length;++d)l[d]!=null&&"n?".indexOf(l[d].t)>-1&&(Se=n>1&&t<0&&d>0&&l[d-1].v==="-"?-t:t,l[d].v=om(l[d].t,l[d].v,Se),l[d].t="t");var nt="";for(d=0;d!==l.length;++d)l[d]!=null&&(nt+=l[d].v);return nt}var FM=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function PM(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function TX(e,t){var r=CX(e),n=r.length,l=r[n-1].indexOf("@");if(n<4&&l>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||l>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=l>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=l>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=l>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var u=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,u];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var d=r[0].match(FM),a=r[1].match(FM);return PM(t,d)?[n,r[0]]:PM(t,a)?[n,r[1]]:[n,r[d!=null&&a!=null?2:1]]}return[n,u]}function Bg(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Jl)[e],n==null&&(n=r.table&&r.table[SM[e]]||Jl[SM[e]]),n==null&&(n=cX[e]||"General");break}if(A2(n,0))return wT(t,r);t instanceof Date&&(t=j6(t,r.date1904));var l=TX(n,t);if(A2(l[1]))return wT(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return SX(l[1],t,r,l[0])}function Y6(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Jl[r]==null){t<0&&(t=r);continue}if(Jl[r]==e){t=r;break}}t<0&&(t=391)}return Jl[t]=e,t}function Cb(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Y6(e[t],t)}function Sb(){Jl=lX()}var J6=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function IX(e){var t=typeof e=="number"?Jl[e]:e;return t=t.replace(J6,"(\\d+)"),new RegExp("^"+t+"$")}function FX(e,t,r){var n=-1,l=-1,u=-1,d=-1,a=-1,v=-1;(t.match(J6)||[]).forEach(function(I,M){var L=parseInt(r[M+1],10);switch(I.toLowerCase().charAt(0)){case"y":n=L;break;case"d":u=L;break;case"h":d=L;break;case"s":v=L;break;case"m":d>=0?a=L:l=L;break}}),v>=0&&a==-1&&l>=0&&(a=l,l=-1);var x=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(l>=1?l:1)).slice(-2)+"-"+("00"+(u>=1?u:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var b=("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(v>=0?v:0)).slice(-2);return d==-1&&a==-1&&v==-1?x:n==-1&&l==-1&&u==-1?b:x+"T"+b}var PX=function(){var e={};e.version="1.2.0";function t(){for(var Be=0,De=new Array(256),we=0;we!=256;++we)Be=we,Be=Be&1?-306674912^Be>>>1:Be>>>1,Be=Be&1?-306674912^Be>>>1:Be>>>1,Be=Be&1?-306674912^Be>>>1:Be>>>1,Be=Be&1?-306674912^Be>>>1:Be>>>1,Be=Be&1?-306674912^Be>>>1:Be>>>1,Be=Be&1?-306674912^Be>>>1:Be>>>1,Be=Be&1?-306674912^Be>>>1:Be>>>1,Be=Be&1?-306674912^Be>>>1:Be>>>1,De[we]=Be;return typeof Int32Array<"u"?new Int32Array(De):De}var r=t();function n(Be){var De=0,we=0,nt=0,_e=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(nt=0;nt!=256;++nt)_e[nt]=Be[nt];for(nt=0;nt!=256;++nt)for(we=Be[nt],De=256+nt;De<4096;De+=256)we=_e[De]=we>>>8^Be[we&255];var Ie=[];for(nt=1;nt!=16;++nt)Ie[nt-1]=typeof Int32Array<"u"?_e.subarray(nt*256,nt*256+256):_e.slice(nt*256,nt*256+256);return Ie}var l=n(r),u=l[0],d=l[1],a=l[2],v=l[3],x=l[4],b=l[5],I=l[6],M=l[7],L=l[8],U=l[9],R=l[10],H=l[11],q=l[12],te=l[13],J=l[14];function se(Be,De){for(var we=De^-1,nt=0,_e=Be.length;nt<_e;)we=we>>>8^r[(we^Be.charCodeAt(nt++))&255];return~we}function ye(Be,De){for(var we=De^-1,nt=Be.length-15,_e=0;_e<nt;)we=J[Be[_e++]^we&255]^te[Be[_e++]^we>>8&255]^q[Be[_e++]^we>>16&255]^H[Be[_e++]^we>>>24]^R[Be[_e++]]^U[Be[_e++]]^L[Be[_e++]]^M[Be[_e++]]^I[Be[_e++]]^b[Be[_e++]]^x[Be[_e++]]^v[Be[_e++]]^a[Be[_e++]]^d[Be[_e++]]^u[Be[_e++]]^r[Be[_e++]];for(nt+=15;_e<nt;)we=we>>>8^r[(we^Be[_e++])&255];return~we}function Se(Be,De){for(var we=De^-1,nt=0,_e=Be.length,Ie=0,Ze=0;nt<_e;)Ie=Be.charCodeAt(nt++),Ie<128?we=we>>>8^r[(we^Ie)&255]:Ie<2048?(we=we>>>8^r[(we^(192|Ie>>6&31))&255],we=we>>>8^r[(we^(128|Ie&63))&255]):Ie>=55296&&Ie<57344?(Ie=(Ie&1023)+64,Ze=Be.charCodeAt(nt++)&1023,we=we>>>8^r[(we^(240|Ie>>8&7))&255],we=we>>>8^r[(we^(128|Ie>>2&63))&255],we=we>>>8^r[(we^(128|Ze>>6&15|(Ie&3)<<4))&255],we=we>>>8^r[(we^(128|Ze&63))&255]):(we=we>>>8^r[(we^(224|Ie>>12&15))&255],we=we>>>8^r[(we^(128|Ie>>6&63))&255],we=we>>>8^r[(we^(128|Ie&63))&255]);return~we}return e.table=r,e.bstr=se,e.buf=ye,e.str=Se,e}(),Es=function(){var t={};t.version="1.2.1";function r(oe,Ee){for(var me=oe.split("/"),xe=Ee.split("/"),Ne=0,Oe=0,St=Math.min(me.length,xe.length);Ne<St;++Ne){if(Oe=me[Ne].length-xe[Ne].length)return Oe;if(me[Ne]!=xe[Ne])return me[Ne]<xe[Ne]?-1:1}return me.length-xe.length}function n(oe){if(oe.charAt(oe.length-1)=="/")return oe.slice(0,-1).indexOf("/")===-1?oe:n(oe.slice(0,-1));var Ee=oe.lastIndexOf("/");return Ee===-1?oe:oe.slice(0,Ee+1)}function l(oe){if(oe.charAt(oe.length-1)=="/")return l(oe.slice(0,-1));var Ee=oe.lastIndexOf("/");return Ee===-1?oe:oe.slice(Ee+1)}function u(oe,Ee){typeof Ee=="string"&&(Ee=new Date(Ee));var me=Ee.getHours();me=me<<6|Ee.getMinutes(),me=me<<5|Ee.getSeconds()>>>1,oe.write_shift(2,me);var xe=Ee.getFullYear()-1980;xe=xe<<4|Ee.getMonth()+1,xe=xe<<5|Ee.getDate(),oe.write_shift(2,xe)}function d(oe){var Ee=oe.read_shift(2)&65535,me=oe.read_shift(2)&65535,xe=new Date,Ne=me&31;me>>>=5;var Oe=me&15;me>>>=4,xe.setMilliseconds(0),xe.setFullYear(me+1980),xe.setMonth(Oe-1),xe.setDate(Ne);var St=Ee&31;Ee>>>=5;var Ht=Ee&63;return Ee>>>=6,xe.setHours(Ee),xe.setMinutes(Ht),xe.setSeconds(St<<1),xe}function a(oe){uA(oe,0);for(var Ee={},me=0;oe.l<=oe.length-4;){var xe=oe.read_shift(2),Ne=oe.read_shift(2),Oe=oe.l+Ne,St={};switch(xe){case 21589:me=oe.read_shift(1),me&1&&(St.mtime=oe.read_shift(4)),Ne>5&&(me&2&&(St.atime=oe.read_shift(4)),me&4&&(St.ctime=oe.read_shift(4))),St.mtime&&(St.mt=new Date(St.mtime*1e3));break}oe.l=Oe,Ee[xe]=St}return Ee}var v;function x(){return v||(v={})}function b(oe,Ee){if(oe[0]==80&&oe[1]==75)return oo(oe,Ee);if((oe[0]|32)==109&&(oe[1]|32)==105)return _n(oe,Ee);if(oe.length<512)throw new Error("CFB file size "+oe.length+" < 512");var me=3,xe=512,Ne=0,Oe=0,St=0,Ht=0,Rt=0,Vt=[],Gt=oe.slice(0,512);uA(Gt,0);var br=I(Gt);switch(me=br[0],me){case 3:xe=512;break;case 4:xe=4096;break;case 0:if(br[1]==0)return oo(oe,Ee);default:throw new Error("Major Version: Expected 3 or 4 saw "+me)}xe!==512&&(Gt=oe.slice(0,xe),uA(Gt,28));var qr=oe.slice(0,xe);M(Gt,me);var Hr=Gt.read_shift(4,"i");if(me===3&&Hr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Hr);Gt.l+=4,St=Gt.read_shift(4,"i"),Gt.l+=4,Gt.chk("00100000","Mini Stream Cutoff Size: "),Ht=Gt.read_shift(4,"i"),Ne=Gt.read_shift(4,"i"),Rt=Gt.read_shift(4,"i"),Oe=Gt.read_shift(4,"i");for(var Jr=-1,en=0;en<109&&(Jr=Gt.read_shift(4,"i"),!(Jr<0));++en)Vt[en]=Jr;var Vn=L(oe,xe);H(Rt,Oe,Vn,xe,Vt);var Kn=te(Vn,St,Vt,xe);Kn[St].name="!Directory",Ne>0&&Ht!==Ze&&(Kn[Ht].name="!MiniFAT"),Kn[Vt[0]].name="!FAT",Kn.fat_addrs=Vt,Kn.ssz=xe;var Sn={},Ii=[],ha=[],sa=[];J(St,Kn,Vn,Ii,Ne,Sn,ha,Ht),U(ha,sa,Ii),Ii.shift();var Ya={FileIndex:ha,FullPaths:sa};return Ee&&Ee.raw&&(Ya.raw={header:qr,sectors:Vn}),Ya}function I(oe){if(oe[oe.l]==80&&oe[oe.l+1]==75)return[0,0];oe.chk(st,"Header Signature: "),oe.l+=16;var Ee=oe.read_shift(2,"u");return[oe.read_shift(2,"u"),Ee]}function M(oe,Ee){var me=9;switch(oe.l+=2,me=oe.read_shift(2)){case 9:if(Ee!=3)throw new Error("Sector Shift: Expected 9 saw "+me);break;case 12:if(Ee!=4)throw new Error("Sector Shift: Expected 12 saw "+me);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+me)}oe.chk("0600","Mini Sector Shift: "),oe.chk("000000000000","Reserved: ")}function L(oe,Ee){for(var me=Math.ceil(oe.length/Ee)-1,xe=[],Ne=1;Ne<me;++Ne)xe[Ne-1]=oe.slice(Ne*Ee,(Ne+1)*Ee);return xe[me-1]=oe.slice(me*Ee),xe}function U(oe,Ee,me){for(var xe=0,Ne=0,Oe=0,St=0,Ht=0,Rt=me.length,Vt=[],Gt=[];xe<Rt;++xe)Vt[xe]=Gt[xe]=xe,Ee[xe]=me[xe];for(;Ht<Gt.length;++Ht)xe=Gt[Ht],Ne=oe[xe].L,Oe=oe[xe].R,St=oe[xe].C,Vt[xe]===xe&&(Ne!==-1&&Vt[Ne]!==Ne&&(Vt[xe]=Vt[Ne]),Oe!==-1&&Vt[Oe]!==Oe&&(Vt[xe]=Vt[Oe])),St!==-1&&(Vt[St]=xe),Ne!==-1&&xe!=Vt[xe]&&(Vt[Ne]=Vt[xe],Gt.lastIndexOf(Ne)<Ht&&Gt.push(Ne)),Oe!==-1&&xe!=Vt[xe]&&(Vt[Oe]=Vt[xe],Gt.lastIndexOf(Oe)<Ht&&Gt.push(Oe));for(xe=1;xe<Rt;++xe)Vt[xe]===xe&&(Oe!==-1&&Vt[Oe]!==Oe?Vt[xe]=Vt[Oe]:Ne!==-1&&Vt[Ne]!==Ne&&(Vt[xe]=Vt[Ne]));for(xe=1;xe<Rt;++xe)if(oe[xe].type!==0){if(Ht=xe,Ht!=Vt[Ht])do Ht=Vt[Ht],Ee[xe]=Ee[Ht]+"/"+Ee[xe];while(Ht!==0&&Vt[Ht]!==-1&&Ht!=Vt[Ht]);Vt[xe]=-1}for(Ee[0]+="/",xe=1;xe<Rt;++xe)oe[xe].type!==2&&(Ee[xe]+="/")}function R(oe,Ee,me){for(var xe=oe.start,Ne=oe.size,Oe=[],St=xe;me&&Ne>0&&St>=0;)Oe.push(Ee.slice(St*Ie,St*Ie+Ie)),Ne-=Ie,St=s0(me,St*4);return Oe.length===0?Zr(0):oh(Oe).slice(0,oe.size)}function H(oe,Ee,me,xe,Ne){var Oe=Ze;if(oe===Ze){if(Ee!==0)throw new Error("DIFAT chain shorter than expected")}else if(oe!==-1){var St=me[oe],Ht=(xe>>>2)-1;if(!St)return;for(var Rt=0;Rt<Ht&&(Oe=s0(St,Rt*4))!==Ze;++Rt)Ne.push(Oe);H(s0(St,xe-4),Ee-1,me,xe,Ne)}}function q(oe,Ee,me,xe,Ne){var Oe=[],St=[];Ne||(Ne=[]);var Ht=xe-1,Rt=0,Vt=0;for(Rt=Ee;Rt>=0;){Ne[Rt]=!0,Oe[Oe.length]=Rt,St.push(oe[Rt]);var Gt=me[Math.floor(Rt*4/xe)];if(Vt=Rt*4&Ht,xe<4+Vt)throw new Error("FAT boundary crossed: "+Rt+" 4 "+xe);if(!oe[Gt])break;Rt=s0(oe[Gt],Vt)}return{nodes:Oe,data:NM([St])}}function te(oe,Ee,me,xe){var Ne=oe.length,Oe=[],St=[],Ht=[],Rt=[],Vt=xe-1,Gt=0,br=0,qr=0,Hr=0;for(Gt=0;Gt<Ne;++Gt)if(Ht=[],qr=Gt+Ee,qr>=Ne&&(qr-=Ne),!St[qr]){Rt=[];var Jr=[];for(br=qr;br>=0;){Jr[br]=!0,St[br]=!0,Ht[Ht.length]=br,Rt.push(oe[br]);var en=me[Math.floor(br*4/xe)];if(Hr=br*4&Vt,xe<4+Hr)throw new Error("FAT boundary crossed: "+br+" 4 "+xe);if(!oe[en]||(br=s0(oe[en],Hr),Jr[br]))break}Oe[qr]={nodes:Ht,data:NM([Rt])}}return Oe}function J(oe,Ee,me,xe,Ne,Oe,St,Ht){for(var Rt=0,Vt=xe.length?2:0,Gt=Ee[oe].data,br=0,qr=0,Hr;br<Gt.length;br+=128){var Jr=Gt.slice(br,br+128);uA(Jr,64),qr=Jr.read_shift(2),Hr=hI(Jr,0,qr-Vt),xe.push(Hr);var en={name:Hr,type:Jr.read_shift(1),color:Jr.read_shift(1),L:Jr.read_shift(4,"i"),R:Jr.read_shift(4,"i"),C:Jr.read_shift(4,"i"),clsid:Jr.read_shift(16),state:Jr.read_shift(4,"i"),start:0,size:0},Vn=Jr.read_shift(2)+Jr.read_shift(2)+Jr.read_shift(2)+Jr.read_shift(2);Vn!==0&&(en.ct=se(Jr,Jr.l-8));var Kn=Jr.read_shift(2)+Jr.read_shift(2)+Jr.read_shift(2)+Jr.read_shift(2);Kn!==0&&(en.mt=se(Jr,Jr.l-8)),en.start=Jr.read_shift(4,"i"),en.size=Jr.read_shift(4,"i"),en.size<0&&en.start<0&&(en.size=en.type=0,en.start=Ze,en.name=""),en.type===5?(Rt=en.start,Ne>0&&Rt!==Ze&&(Ee[Rt].name="!StreamData")):en.size>=4096?(en.storage="fat",Ee[en.start]===void 0&&(Ee[en.start]=q(me,en.start,Ee.fat_addrs,Ee.ssz)),Ee[en.start].name=en.name,en.content=Ee[en.start].data.slice(0,en.size)):(en.storage="minifat",en.size<0?en.size=0:Rt!==Ze&&en.start!==Ze&&Ee[Rt]&&(en.content=R(en,Ee[Rt].data,(Ee[Ht]||{}).data))),en.content&&uA(en.content,0),Oe[Hr]=en,St.push(en)}}function se(oe,Ee){return new Date((AA(oe,Ee+4)/1e7*Math.pow(2,32)+AA(oe,Ee)/1e7-11644473600)*1e3)}function ye(oe,Ee){return x(),b(v.readFileSync(oe),Ee)}function Se(oe,Ee){var me=Ee&&Ee.type;switch(me||Jo&&Buffer.isBuffer(oe)&&(me="buffer"),me||"base64"){case"file":return ye(oe,Ee);case"base64":return b(Md(Am(oe)),Ee);case"binary":return b(Md(oe),Ee)}return b(oe,Ee)}function Be(oe,Ee){var me=Ee||{},xe=me.root||"Root Entry";if(oe.FullPaths||(oe.FullPaths=[]),oe.FileIndex||(oe.FileIndex=[]),oe.FullPaths.length!==oe.FileIndex.length)throw new Error("inconsistent CFB structure");oe.FullPaths.length===0&&(oe.FullPaths[0]=xe+"/",oe.FileIndex[0]={name:xe,type:5}),me.CLSID&&(oe.FileIndex[0].clsid=me.CLSID),De(oe)}function De(oe){var Ee="Sh33tJ5";if(!Es.find(oe,"/"+Ee)){var me=Zr(4);me[0]=55,me[1]=me[3]=50,me[2]=54,oe.FileIndex.push({name:Ee,type:2,content:me,size:4,L:69,R:69,C:69}),oe.FullPaths.push(oe.FullPaths[0]+Ee),we(oe)}}function we(oe,Ee){Be(oe);for(var me=!1,xe=!1,Ne=oe.FullPaths.length-1;Ne>=0;--Ne){var Oe=oe.FileIndex[Ne];switch(Oe.type){case 0:xe?me=!0:(oe.FileIndex.pop(),oe.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(Oe.R*Oe.L*Oe.C)&&(me=!0),Oe.R>-1&&Oe.L>-1&&Oe.R==Oe.L&&(me=!0);break;default:me=!0;break}}if(!(!me&&!Ee)){var St=new Date(1987,1,19),Ht=0,Rt=Object.create?Object.create(null):{},Vt=[];for(Ne=0;Ne<oe.FullPaths.length;++Ne)Rt[oe.FullPaths[Ne]]=!0,oe.FileIndex[Ne].type!==0&&Vt.push([oe.FullPaths[Ne],oe.FileIndex[Ne]]);for(Ne=0;Ne<Vt.length;++Ne){var Gt=n(Vt[Ne][0]);xe=Rt[Gt],xe||(Vt.push([Gt,{name:l(Gt).replace("/",""),type:1,clsid:Ut,ct:St,mt:St,content:null}]),Rt[Gt]=!0)}for(Vt.sort(function(Hr,Jr){return r(Hr[0],Jr[0])}),oe.FullPaths=[],oe.FileIndex=[],Ne=0;Ne<Vt.length;++Ne)oe.FullPaths[Ne]=Vt[Ne][0],oe.FileIndex[Ne]=Vt[Ne][1];for(Ne=0;Ne<Vt.length;++Ne){var br=oe.FileIndex[Ne],qr=oe.FullPaths[Ne];if(br.name=l(qr).replace("/",""),br.L=br.R=br.C=-(br.color=1),br.size=br.content?br.content.length:0,br.start=0,br.clsid=br.clsid||Ut,Ne===0)br.C=Vt.length>1?1:-1,br.size=0,br.type=5;else if(qr.slice(-1)=="/"){for(Ht=Ne+1;Ht<Vt.length&&n(oe.FullPaths[Ht])!=qr;++Ht);for(br.C=Ht>=Vt.length?-1:Ht,Ht=Ne+1;Ht<Vt.length&&n(oe.FullPaths[Ht])!=n(qr);++Ht);br.R=Ht>=Vt.length?-1:Ht,br.type=1}else n(oe.FullPaths[Ne+1]||"")==n(qr)&&(br.R=Ne+1),br.type=2}}}function nt(oe,Ee){var me=Ee||{};if(me.fileType=="mad")return Tt(oe,me);switch(we(oe),me.fileType){case"zip":return ba(oe,me)}var xe=function(Hr){for(var Jr=0,en=0,Vn=0;Vn<Hr.FileIndex.length;++Vn){var Kn=Hr.FileIndex[Vn];if(Kn.content){var Sn=Kn.content.length;Sn>0&&(Sn<4096?Jr+=Sn+63>>6:en+=Sn+511>>9)}}for(var Ii=Hr.FullPaths.length+3>>2,ha=Jr+7>>3,sa=Jr+127>>7,Ya=ha+en+Ii+sa,Ra=Ya+127>>7,es=Ra<=109?0:Math.ceil((Ra-109)/127);Ya+Ra+es+127>>7>Ra;)es=++Ra<=109?0:Math.ceil((Ra-109)/127);var so=[1,es,Ra,sa,Ii,en,Jr,0];return Hr.FileIndex[0].size=Jr<<6,so[7]=(Hr.FileIndex[0].start=so[0]+so[1]+so[2]+so[3]+so[4]+so[5])+(so[6]+7>>3),so}(oe),Ne=Zr(xe[7]<<9),Oe=0,St=0;{for(Oe=0;Oe<8;++Oe)Ne.write_shift(1,Et[Oe]);for(Oe=0;Oe<8;++Oe)Ne.write_shift(2,0);for(Ne.write_shift(2,62),Ne.write_shift(2,3),Ne.write_shift(2,65534),Ne.write_shift(2,9),Ne.write_shift(2,6),Oe=0;Oe<3;++Oe)Ne.write_shift(2,0);for(Ne.write_shift(4,0),Ne.write_shift(4,xe[2]),Ne.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),Ne.write_shift(4,0),Ne.write_shift(4,4096),Ne.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:Ze),Ne.write_shift(4,xe[3]),Ne.write_shift(-4,xe[1]?xe[0]-1:Ze),Ne.write_shift(4,xe[1]),Oe=0;Oe<109;++Oe)Ne.write_shift(-4,Oe<xe[2]?xe[1]+Oe:-1)}if(xe[1])for(St=0;St<xe[1];++St){for(;Oe<236+St*127;++Oe)Ne.write_shift(-4,Oe<xe[2]?xe[1]+Oe:-1);Ne.write_shift(-4,St===xe[1]-1?Ze:St+1)}var Ht=function(Hr){for(St+=Hr;Oe<St-1;++Oe)Ne.write_shift(-4,Oe+1);Hr&&(++Oe,Ne.write_shift(-4,Ze))};for(St=Oe=0,St+=xe[1];Oe<St;++Oe)Ne.write_shift(-4,jt.DIFSECT);for(St+=xe[2];Oe<St;++Oe)Ne.write_shift(-4,jt.FATSECT);Ht(xe[3]),Ht(xe[4]);for(var Rt=0,Vt=0,Gt=oe.FileIndex[0];Rt<oe.FileIndex.length;++Rt)Gt=oe.FileIndex[Rt],Gt.content&&(Vt=Gt.content.length,!(Vt<4096)&&(Gt.start=St,Ht(Vt+511>>9)));for(Ht(xe[6]+7>>3);Ne.l&511;)Ne.write_shift(-4,jt.ENDOFCHAIN);for(St=Oe=0,Rt=0;Rt<oe.FileIndex.length;++Rt)Gt=oe.FileIndex[Rt],Gt.content&&(Vt=Gt.content.length,!(!Vt||Vt>=4096)&&(Gt.start=St,Ht(Vt+63>>6)));for(;Ne.l&511;)Ne.write_shift(-4,jt.ENDOFCHAIN);for(Oe=0;Oe<xe[4]<<2;++Oe){var br=oe.FullPaths[Oe];if(!br||br.length===0){for(Rt=0;Rt<17;++Rt)Ne.write_shift(4,0);for(Rt=0;Rt<3;++Rt)Ne.write_shift(4,-1);for(Rt=0;Rt<12;++Rt)Ne.write_shift(4,0);continue}Gt=oe.FileIndex[Oe],Oe===0&&(Gt.start=Gt.size?Gt.start-1:Ze);var qr=Oe===0&&me.root||Gt.name;if(Vt=2*(qr.length+1),Ne.write_shift(64,qr,"utf16le"),Ne.write_shift(2,Vt),Ne.write_shift(1,Gt.type),Ne.write_shift(1,Gt.color),Ne.write_shift(-4,Gt.L),Ne.write_shift(-4,Gt.R),Ne.write_shift(-4,Gt.C),Gt.clsid)Ne.write_shift(16,Gt.clsid,"hex");else for(Rt=0;Rt<4;++Rt)Ne.write_shift(4,0);Ne.write_shift(4,Gt.state||0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,Gt.start),Ne.write_shift(4,Gt.size),Ne.write_shift(4,0)}for(Oe=1;Oe<oe.FileIndex.length;++Oe)if(Gt=oe.FileIndex[Oe],Gt.size>=4096)if(Ne.l=Gt.start+1<<9,Jo&&Buffer.isBuffer(Gt.content))Gt.content.copy(Ne,Ne.l,0,Gt.size),Ne.l+=Gt.size+511&-512;else{for(Rt=0;Rt<Gt.size;++Rt)Ne.write_shift(1,Gt.content[Rt]);for(;Rt&511;++Rt)Ne.write_shift(1,0)}for(Oe=1;Oe<oe.FileIndex.length;++Oe)if(Gt=oe.FileIndex[Oe],Gt.size>0&&Gt.size<4096)if(Jo&&Buffer.isBuffer(Gt.content))Gt.content.copy(Ne,Ne.l,0,Gt.size),Ne.l+=Gt.size+63&-64;else{for(Rt=0;Rt<Gt.size;++Rt)Ne.write_shift(1,Gt.content[Rt]);for(;Rt&63;++Rt)Ne.write_shift(1,0)}if(Jo)Ne.l=Ne.length;else for(;Ne.l<Ne.length;)Ne.write_shift(1,0);return Ne}function _e(oe,Ee){var me=oe.FullPaths.map(function(Rt){return Rt.toUpperCase()}),xe=me.map(function(Rt){var Vt=Rt.split("/");return Vt[Vt.length-(Rt.slice(-1)=="/"?2:1)]}),Ne=!1;Ee.charCodeAt(0)===47?(Ne=!0,Ee=me[0].slice(0,-1)+Ee):Ne=Ee.indexOf("/")!==-1;var Oe=Ee.toUpperCase(),St=Ne===!0?me.indexOf(Oe):xe.indexOf(Oe);if(St!==-1)return oe.FileIndex[St];var Ht=!Oe.match($x);for(Oe=Oe.replace(Vy,""),Ht&&(Oe=Oe.replace($x,"!")),St=0;St<me.length;++St)if((Ht?me[St].replace($x,"!"):me[St]).replace(Vy,"")==Oe||(Ht?xe[St].replace($x,"!"):xe[St]).replace(Vy,"")==Oe)return oe.FileIndex[St];return null}var Ie=64,Ze=-2,st="d0cf11e0a1b11ae1",Et=[208,207,17,224,161,177,26,225],Ut="00000000000000000000000000000000",jt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ze,FREESECT:-1,HEADER_SIGNATURE:st,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ut,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function bt(oe,Ee,me){x();var xe=nt(oe,me);v.writeFileSync(Ee,xe)}function Nt(oe){for(var Ee=new Array(oe.length),me=0;me<oe.length;++me)Ee[me]=String.fromCharCode(oe[me]);return Ee.join("")}function ar(oe,Ee){var me=nt(oe,Ee);switch(Ee&&Ee.type||"buffer"){case"file":return x(),v.writeFileSync(Ee.filename,me),me;case"binary":return typeof me=="string"?me:Nt(me);case"base64":return o1(typeof me=="string"?me:Nt(me));case"buffer":if(Jo)return Buffer.isBuffer(me)?me:xm(me);case"array":return typeof me=="string"?Md(me):me}return me}var lt;function ie(oe){try{var Ee=oe.InflateRaw,me=new Ee;if(me._processChunk(new Uint8Array([3,0]),me._finishFlushFlag),me.bytesRead)lt=oe;else throw new Error("zlib does not expose bytesRead")}catch(xe){console.error("cannot use native zlib: "+(xe.message||xe))}}function Le(oe,Ee){if(!lt)return Nn(oe,Ee);var me=lt.InflateRaw,xe=new me,Ne=xe._processChunk(oe.slice(oe.l),xe._finishFlushFlag);return oe.l+=xe.bytesRead,Ne}function Fe(oe){return lt?lt.deflateRawSync(oe):vi(oe)}var Re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],et=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Dt(oe){var Ee=(oe<<1|oe<<11)&139536|(oe<<5|oe<<15)&558144;return(Ee>>16|Ee>>8|Ee)&255}for(var pt=typeof Uint8Array<"u",Ct=pt?new Uint8Array(256):[],mr=0;mr<256;++mr)Ct[mr]=Dt(mr);function Zt(oe,Ee){var me=Ct[oe&255];return Ee<=8?me>>>8-Ee:(me=me<<8|Ct[oe>>8&255],Ee<=16?me>>>16-Ee:(me=me<<8|Ct[oe>>16&255],me>>>24-Ee))}function sn(oe,Ee){var me=Ee&7,xe=Ee>>>3;return(oe[xe]|(me<=6?0:oe[xe+1]<<8))>>>me&3}function er(oe,Ee){var me=Ee&7,xe=Ee>>>3;return(oe[xe]|(me<=5?0:oe[xe+1]<<8))>>>me&7}function mt(oe,Ee){var me=Ee&7,xe=Ee>>>3;return(oe[xe]|(me<=4?0:oe[xe+1]<<8))>>>me&15}function En(oe,Ee){var me=Ee&7,xe=Ee>>>3;return(oe[xe]|(me<=3?0:oe[xe+1]<<8))>>>me&31}function $r(oe,Ee){var me=Ee&7,xe=Ee>>>3;return(oe[xe]|(me<=1?0:oe[xe+1]<<8))>>>me&127}function zn(oe,Ee,me){var xe=Ee&7,Ne=Ee>>>3,Oe=(1<<me)-1,St=oe[Ne]>>>xe;return me<8-xe||(St|=oe[Ne+1]<<8-xe,me<16-xe)||(St|=oe[Ne+2]<<16-xe,me<24-xe)||(St|=oe[Ne+3]<<24-xe),St&Oe}function an(oe,Ee,me){var xe=Ee&7,Ne=Ee>>>3;return xe<=5?oe[Ne]|=(me&7)<<xe:(oe[Ne]|=me<<xe&255,oe[Ne+1]=(me&7)>>8-xe),Ee+3}function Pn(oe,Ee,me){var xe=Ee&7,Ne=Ee>>>3;return me=(me&1)<<xe,oe[Ne]|=me,Ee+1}function yn(oe,Ee,me){var xe=Ee&7,Ne=Ee>>>3;return me<<=xe,oe[Ne]|=me&255,me>>>=8,oe[Ne+1]=me,Ee+8}function Ci(oe,Ee,me){var xe=Ee&7,Ne=Ee>>>3;return me<<=xe,oe[Ne]|=me&255,me>>>=8,oe[Ne+1]=me&255,oe[Ne+2]=me>>>8,Ee+16}function Zn(oe,Ee){var me=oe.length,xe=2*me>Ee?2*me:Ee+5,Ne=0;if(me>=Ee)return oe;if(Jo){var Oe=EM(xe);if(oe.copy)oe.copy(Oe);else for(;Ne<oe.length;++Ne)Oe[Ne]=oe[Ne];return Oe}else if(pt){var St=new Uint8Array(xe);if(St.set)St.set(oe);else for(;Ne<me;++Ne)St[Ne]=oe[Ne];return St}return oe.length=xe,oe}function Vi(oe){for(var Ee=new Array(oe),me=0;me<oe;++me)Ee[me]=0;return Ee}function Ti(oe,Ee,me){var xe=1,Ne=0,Oe=0,St=0,Ht=0,Rt=oe.length,Vt=pt?new Uint16Array(32):Vi(32);for(Oe=0;Oe<32;++Oe)Vt[Oe]=0;for(Oe=Rt;Oe<me;++Oe)oe[Oe]=0;Rt=oe.length;var Gt=pt?new Uint16Array(Rt):Vi(Rt);for(Oe=0;Oe<Rt;++Oe)Vt[Ne=oe[Oe]]++,xe<Ne&&(xe=Ne),Gt[Oe]=0;for(Vt[0]=0,Oe=1;Oe<=xe;++Oe)Vt[Oe+16]=Ht=Ht+Vt[Oe-1]<<1;for(Oe=0;Oe<Rt;++Oe)Ht=oe[Oe],Ht!=0&&(Gt[Oe]=Vt[Ht+16]++);var br=0;for(Oe=0;Oe<Rt;++Oe)if(br=oe[Oe],br!=0)for(Ht=Zt(Gt[Oe],xe)>>xe-br,St=(1<<xe+4-br)-1;St>=0;--St)Ee[Ht|St<<br]=br&15|Oe<<4;return xe}var ui=pt?new Uint16Array(512):Vi(512),ta=pt?new Uint16Array(32):Vi(32);if(!pt){for(var bi=0;bi<512;++bi)ui[bi]=0;for(bi=0;bi<32;++bi)ta[bi]=0}(function(){for(var oe=[],Ee=0;Ee<32;Ee++)oe.push(5);Ti(oe,ta,32);var me=[];for(Ee=0;Ee<=143;Ee++)me.push(8);for(;Ee<=255;Ee++)me.push(9);for(;Ee<=279;Ee++)me.push(7);for(;Ee<=287;Ee++)me.push(8);Ti(me,ui,288)})();var ti=function(){for(var Ee=pt?new Uint8Array(32768):[],me=0,xe=0;me<xt.length-1;++me)for(;xe<xt[me+1];++xe)Ee[xe]=me;for(;xe<32768;++xe)Ee[xe]=29;var Ne=pt?new Uint8Array(259):[];for(me=0,xe=0;me<et.length-1;++me)for(;xe<et[me+1];++xe)Ne[xe]=me;function Oe(Ht,Rt){for(var Vt=0;Vt<Ht.length;){var Gt=Math.min(65535,Ht.length-Vt),br=Vt+Gt==Ht.length;for(Rt.write_shift(1,+br),Rt.write_shift(2,Gt),Rt.write_shift(2,~Gt&65535);Gt-- >0;)Rt[Rt.l++]=Ht[Vt++]}return Rt.l}function St(Ht,Rt){for(var Vt=0,Gt=0,br=pt?new Uint16Array(32768):[];Gt<Ht.length;){var qr=Math.min(65535,Ht.length-Gt);if(qr<10){for(Vt=an(Rt,Vt,+(Gt+qr==Ht.length)),Vt&7&&(Vt+=8-(Vt&7)),Rt.l=Vt/8|0,Rt.write_shift(2,qr),Rt.write_shift(2,~qr&65535);qr-- >0;)Rt[Rt.l++]=Ht[Gt++];Vt=Rt.l*8;continue}Vt=an(Rt,Vt,+(Gt+qr==Ht.length)+2);for(var Hr=0;qr-- >0;){var Jr=Ht[Gt];Hr=(Hr<<5^Jr)&32767;var en=-1,Vn=0;if((en=br[Hr])&&(en|=Gt&-32768,en>Gt&&(en-=32768),en<Gt))for(;Ht[en+Vn]==Ht[Gt+Vn]&&Vn<250;)++Vn;if(Vn>2){Jr=Ne[Vn],Jr<=22?Vt=yn(Rt,Vt,Ct[Jr+1]>>1)-1:(yn(Rt,Vt,3),Vt+=5,yn(Rt,Vt,Ct[Jr-23]>>5),Vt+=3);var Kn=Jr<8?0:Jr-4>>2;Kn>0&&(Ci(Rt,Vt,Vn-et[Jr]),Vt+=Kn),Jr=Ee[Gt-en],Vt=yn(Rt,Vt,Ct[Jr]>>3),Vt-=3;var Sn=Jr<4?0:Jr-2>>1;Sn>0&&(Ci(Rt,Vt,Gt-en-xt[Jr]),Vt+=Sn);for(var Ii=0;Ii<Vn;++Ii)br[Hr]=Gt&32767,Hr=(Hr<<5^Ht[Gt])&32767,++Gt;qr-=Vn-1}else Jr<=143?Jr=Jr+48:Vt=Pn(Rt,Vt,1),Vt=yn(Rt,Vt,Ct[Jr]),br[Hr]=Gt&32767,++Gt}Vt=yn(Rt,Vt,0)-1}return Rt.l=(Vt+7)/8|0,Rt.l}return function(Rt,Vt){return Rt.length<8?Oe(Rt,Vt):St(Rt,Vt)}}();function vi(oe){var Ee=Zr(50+Math.floor(oe.length*1.1)),me=ti(oe,Ee);return Ee.slice(0,me)}var Dn=pt?new Uint16Array(32768):Vi(32768),ua=pt?new Uint16Array(32768):Vi(32768),ca=pt?new Uint16Array(128):Vi(128),Gn=1,Li=1;function xa(oe,Ee){var me=En(oe,Ee)+257;Ee+=5;var xe=En(oe,Ee)+1;Ee+=5;var Ne=mt(oe,Ee)+4;Ee+=4;for(var Oe=0,St=pt?new Uint8Array(19):Vi(19),Ht=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Rt=1,Vt=pt?new Uint8Array(8):Vi(8),Gt=pt?new Uint8Array(8):Vi(8),br=St.length,qr=0;qr<Ne;++qr)St[Re[qr]]=Oe=er(oe,Ee),Rt<Oe&&(Rt=Oe),Vt[Oe]++,Ee+=3;var Hr=0;for(Vt[0]=0,qr=1;qr<=Rt;++qr)Gt[qr]=Hr=Hr+Vt[qr-1]<<1;for(qr=0;qr<br;++qr)(Hr=St[qr])!=0&&(Ht[qr]=Gt[Hr]++);var Jr=0;for(qr=0;qr<br;++qr)if(Jr=St[qr],Jr!=0){Hr=Ct[Ht[qr]]>>8-Jr;for(var en=(1<<7-Jr)-1;en>=0;--en)ca[Hr|en<<Jr]=Jr&7|qr<<3}var Vn=[];for(Rt=1;Vn.length<me+xe;)switch(Hr=ca[$r(oe,Ee)],Ee+=Hr&7,Hr>>>=3){case 16:for(Oe=3+sn(oe,Ee),Ee+=2,Hr=Vn[Vn.length-1];Oe-- >0;)Vn.push(Hr);break;case 17:for(Oe=3+er(oe,Ee),Ee+=3;Oe-- >0;)Vn.push(0);break;case 18:for(Oe=11+$r(oe,Ee),Ee+=7;Oe-- >0;)Vn.push(0);break;default:Vn.push(Hr),Rt<Hr&&(Rt=Hr);break}var Kn=Vn.slice(0,me),Sn=Vn.slice(me);for(qr=me;qr<286;++qr)Kn[qr]=0;for(qr=xe;qr<30;++qr)Sn[qr]=0;return Gn=Ti(Kn,Dn,286),Li=Ti(Sn,ua,30),Ee}function yi(oe,Ee){if(oe[0]==3&&!(oe[1]&3))return[E0(Ee),2];for(var me=0,xe=0,Ne=EM(Ee||1<<18),Oe=0,St=Ne.length>>>0,Ht=0,Rt=0;(xe&1)==0;){if(xe=er(oe,me),me+=3,xe>>>1)xe>>1==1?(Ht=9,Rt=5):(me=xa(oe,me),Ht=Gn,Rt=Li);else{me&7&&(me+=8-(me&7));var Vt=oe[me>>>3]|oe[(me>>>3)+1]<<8;if(me+=32,Vt>0)for(!Ee&&St<Oe+Vt&&(Ne=Zn(Ne,Oe+Vt),St=Ne.length);Vt-- >0;)Ne[Oe++]=oe[me>>>3],me+=8;continue}for(;;){!Ee&&St<Oe+32767&&(Ne=Zn(Ne,Oe+32767),St=Ne.length);var Gt=zn(oe,me,Ht),br=xe>>>1==1?ui[Gt]:Dn[Gt];if(me+=br&15,br>>>=4,(br>>>8&255)===0)Ne[Oe++]=br;else{if(br==256)break;br-=257;var qr=br<8?0:br-4>>2;qr>5&&(qr=0);var Hr=Oe+et[br];qr>0&&(Hr+=zn(oe,me,qr),me+=qr),Gt=zn(oe,me,Rt),br=xe>>>1==1?ta[Gt]:ua[Gt],me+=br&15,br>>>=4;var Jr=br<4?0:br-2>>1,en=xt[br];for(Jr>0&&(en+=zn(oe,me,Jr),me+=Jr),!Ee&&St<Hr&&(Ne=Zn(Ne,Hr+100),St=Ne.length);Oe<Hr;)Ne[Oe]=Ne[Oe-en],++Oe}}}return Ee?[Ne,me+7>>>3]:[Ne.slice(0,Oe),me+7>>>3]}function Nn(oe,Ee){var me=oe.slice(oe.l||0),xe=yi(me,Ee);return oe.l+=xe[1],xe[0]}function ki(oe,Ee){if(oe)typeof console<"u"&&console.error(Ee);else throw new Error(Ee)}function oo(oe,Ee){var me=oe;uA(me,0);var xe=[],Ne=[],Oe={FileIndex:xe,FullPaths:Ne};Be(Oe,{root:Ee.root});for(var St=me.length-4;(me[St]!=80||me[St+1]!=75||me[St+2]!=5||me[St+3]!=6)&&St>=0;)--St;me.l=St+4,me.l+=4;var Ht=me.read_shift(2);me.l+=6;var Rt=me.read_shift(4);for(me.l=Rt,St=0;St<Ht;++St){me.l+=20;var Vt=me.read_shift(4),Gt=me.read_shift(4),br=me.read_shift(2),qr=me.read_shift(2),Hr=me.read_shift(2);me.l+=8;var Jr=me.read_shift(4),en=a(me.slice(me.l+br,me.l+br+qr));me.l+=br+qr+Hr;var Vn=me.l;me.l=Jr+4,wa(me,Vt,Gt,Oe,en),me.l=Vn}return Oe}function wa(oe,Ee,me,xe,Ne){oe.l+=2;var Oe=oe.read_shift(2),St=oe.read_shift(2),Ht=d(oe);if(Oe&8257)throw new Error("Unsupported ZIP encryption");for(var Rt=oe.read_shift(4),Vt=oe.read_shift(4),Gt=oe.read_shift(4),br=oe.read_shift(2),qr=oe.read_shift(2),Hr="",Jr=0;Jr<br;++Jr)Hr+=String.fromCharCode(oe[oe.l++]);if(qr){var en=a(oe.slice(oe.l,oe.l+qr));(en[21589]||{}).mt&&(Ht=en[21589].mt),((Ne||{})[21589]||{}).mt&&(Ht=Ne[21589].mt)}oe.l+=qr;var Vn=oe.slice(oe.l,oe.l+Vt);switch(St){case 8:Vn=Le(oe,Gt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+St)}var Kn=!1;Oe&8&&(Rt=oe.read_shift(4),Rt==134695760&&(Rt=oe.read_shift(4),Kn=!0),Vt=oe.read_shift(4),Gt=oe.read_shift(4)),Vt!=Ee&&ki(Kn,"Bad compressed size: "+Ee+" != "+Vt),Gt!=me&&ki(Kn,"Bad uncompressed size: "+me+" != "+Gt),be(xe,Hr,Vn,{unsafe:!0,mt:Ht})}function ba(oe,Ee){var me=Ee||{},xe=[],Ne=[],Oe=Zr(1),St=me.compression?8:0,Ht=0,Rt=0,Vt=0,Gt=0,br=0,qr=oe.FullPaths[0],Hr=qr,Jr=oe.FileIndex[0],en=[],Vn=0;for(Rt=1;Rt<oe.FullPaths.length;++Rt)if(Hr=oe.FullPaths[Rt].slice(qr.length),Jr=oe.FileIndex[Rt],!(!Jr.size||!Jr.content||Hr=="Sh33tJ5")){var Kn=Gt,Sn=Zr(Hr.length);for(Vt=0;Vt<Hr.length;++Vt)Sn.write_shift(1,Hr.charCodeAt(Vt)&127);Sn=Sn.slice(0,Sn.l),en[br]=PX.buf(Jr.content,0);var Ii=Jr.content;St==8&&(Ii=Fe(Ii)),Oe=Zr(30),Oe.write_shift(4,67324752),Oe.write_shift(2,20),Oe.write_shift(2,Ht),Oe.write_shift(2,St),Jr.mt?u(Oe,Jr.mt):Oe.write_shift(4,0),Oe.write_shift(-4,en[br]),Oe.write_shift(4,Ii.length),Oe.write_shift(4,Jr.content.length),Oe.write_shift(2,Sn.length),Oe.write_shift(2,0),Gt+=Oe.length,xe.push(Oe),Gt+=Sn.length,xe.push(Sn),Gt+=Ii.length,xe.push(Ii),Oe=Zr(46),Oe.write_shift(4,33639248),Oe.write_shift(2,0),Oe.write_shift(2,20),Oe.write_shift(2,Ht),Oe.write_shift(2,St),Oe.write_shift(4,0),Oe.write_shift(-4,en[br]),Oe.write_shift(4,Ii.length),Oe.write_shift(4,Jr.content.length),Oe.write_shift(2,Sn.length),Oe.write_shift(2,0),Oe.write_shift(2,0),Oe.write_shift(2,0),Oe.write_shift(2,0),Oe.write_shift(4,0),Oe.write_shift(4,Kn),Vn+=Oe.l,Ne.push(Oe),Vn+=Sn.length,Ne.push(Sn),++br}return Oe=Zr(22),Oe.write_shift(4,101010256),Oe.write_shift(2,0),Oe.write_shift(2,0),Oe.write_shift(2,br),Oe.write_shift(2,br),Oe.write_shift(4,Vn),Oe.write_shift(4,Gt),Oe.write_shift(2,0),oh([oh(xe),oh(Ne),Oe])}var Mi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ea(oe,Ee){if(oe.ctype)return oe.ctype;var me=oe.name||"",xe=me.match(/\.([^\.]+)$/);return xe&&Mi[xe[1]]||Ee&&(xe=(me=Ee).match(/[\.\\]([^\.\\])+$/),xe&&Mi[xe[1]])?Mi[xe[1]]:"application/octet-stream"}function hr(oe){for(var Ee=o1(oe),me=[],xe=0;xe<Ee.length;xe+=76)me.push(Ee.slice(xe,xe+76));return me.join(`\r
`)+`\r
`}function Bo(oe){var Ee=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Vt){var Gt=Vt.charCodeAt(0).toString(16).toUpperCase();return"="+(Gt.length==1?"0"+Gt:Gt)});Ee=Ee.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Ee.charAt(0)==`
`&&(Ee="=0D"+Ee.slice(1)),Ee=Ee.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var me=[],xe=Ee.split(`\r
`),Ne=0;Ne<xe.length;++Ne){var Oe=xe[Ne];if(Oe.length==0){me.push("");continue}for(var St=0;St<Oe.length;){var Ht=76,Rt=Oe.slice(St,St+Ht);Rt.charAt(Ht-1)=="="?Ht--:Rt.charAt(Ht-2)=="="?Ht-=2:Rt.charAt(Ht-3)=="="&&(Ht-=3),Rt=Oe.slice(St,St+Ht),St+=Ht,St<Oe.length&&(Rt+="="),me.push(Rt)}}return me.join(`\r
`)}function xc(oe){for(var Ee=[],me=0;me<oe.length;++me){for(var xe=oe[me];me<=oe.length&&xe.charAt(xe.length-1)=="=";)xe=xe.slice(0,xe.length-1)+oe[++me];Ee.push(xe)}for(var Ne=0;Ne<Ee.length;++Ne)Ee[Ne]=Ee[Ne].replace(/[=][0-9A-Fa-f]{2}/g,function(Oe){return String.fromCharCode(parseInt(Oe.slice(1),16))});return Md(Ee.join(`\r
`))}function sl(oe,Ee,me){for(var xe="",Ne="",Oe="",St,Ht=0;Ht<10;++Ht){var Rt=Ee[Ht];if(!Rt||Rt.match(/^\s*$/))break;var Vt=Rt.match(/^(.*?):\s*([^\s].*)$/);if(Vt)switch(Vt[1].toLowerCase()){case"content-location":xe=Vt[2].trim();break;case"content-type":Oe=Vt[2].trim();break;case"content-transfer-encoding":Ne=Vt[2].trim();break}}switch(++Ht,Ne.toLowerCase()){case"base64":St=Md(Am(Ee.slice(Ht).join("")));break;case"quoted-printable":St=xc(Ee.slice(Ht));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ne)}var Gt=be(oe,xe.slice(me.length),St,{unsafe:!0});Oe&&(Gt.ctype=Oe)}function _n(oe,Ee){if(Nt(oe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var me=Ee&&Ee.root||"",xe=(Jo&&Buffer.isBuffer(oe)?oe.toString("binary"):Nt(oe)).split(`\r
`),Ne=0,Oe="";for(Ne=0;Ne<xe.length;++Ne)if(Oe=xe[Ne],!!/^Content-Location:/i.test(Oe)&&(Oe=Oe.slice(Oe.indexOf("file")),me||(me=Oe.slice(0,Oe.lastIndexOf("/")+1)),Oe.slice(0,me.length)!=me))for(;me.length>0&&(me=me.slice(0,me.length-1),me=me.slice(0,me.lastIndexOf("/")+1),Oe.slice(0,me.length)!=me););var St=(xe[1]||"").match(/boundary="(.*?)"/);if(!St)throw new Error("MAD cannot find boundary");var Ht="--"+(St[1]||""),Rt=[],Vt=[],Gt={FileIndex:Rt,FullPaths:Vt};Be(Gt);var br,qr=0;for(Ne=0;Ne<xe.length;++Ne){var Hr=xe[Ne];Hr!==Ht&&Hr!==Ht+"--"||(qr++&&sl(Gt,xe.slice(br,Ne),me),br=Ne)}return Gt}function Tt(oe,Ee){var me=Ee||{},xe=me.boundary||"SheetJS";xe="------="+xe;for(var Ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xe.slice(2)+'"',"","",""],Oe=oe.FullPaths[0],St=Oe,Ht=oe.FileIndex[0],Rt=1;Rt<oe.FullPaths.length;++Rt)if(St=oe.FullPaths[Rt].slice(Oe.length),Ht=oe.FileIndex[Rt],!(!Ht.size||!Ht.content||St=="Sh33tJ5")){St=St.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Vn){return"_x"+Vn.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Vn){return"_u"+Vn.charCodeAt(0).toString(16)+"_"});for(var Vt=Ht.content,Gt=Jo&&Buffer.isBuffer(Vt)?Vt.toString("binary"):Nt(Vt),br=0,qr=Math.min(1024,Gt.length),Hr=0,Jr=0;Jr<=qr;++Jr)(Hr=Gt.charCodeAt(Jr))>=32&&Hr<128&&++br;var en=br>=qr*4/5;Ne.push(xe),Ne.push("Content-Location: "+(me.root||"file:///C:/SheetJS/")+St),Ne.push("Content-Transfer-Encoding: "+(en?"quoted-printable":"base64")),Ne.push("Content-Type: "+Ea(Ht,St)),Ne.push(""),Ne.push(en?Bo(Gt):hr(Gt))}return Ne.push(xe+`--\r
`),Ne.join(`\r
`)}function pe(oe){var Ee={};return Be(Ee,oe),Ee}function be(oe,Ee,me,xe){var Ne=xe&&xe.unsafe;Ne||Be(oe);var Oe=!Ne&&Es.find(oe,Ee);if(!Oe){var St=oe.FullPaths[0];Ee.slice(0,St.length)==St?St=Ee:(St.slice(-1)!="/"&&(St+="/"),St=(St+Ee).replace("//","/")),Oe={name:l(Ee),type:2},oe.FileIndex.push(Oe),oe.FullPaths.push(St),Ne||Es.utils.cfb_gc(oe)}return Oe.content=me,Oe.size=me?me.length:0,xe&&(xe.CLSID&&(Oe.clsid=xe.CLSID),xe.mt&&(Oe.mt=xe.mt),xe.ct&&(Oe.ct=xe.ct)),Oe}function Ve(oe,Ee){Be(oe);var me=Es.find(oe,Ee);if(me){for(var xe=0;xe<oe.FileIndex.length;++xe)if(oe.FileIndex[xe]==me)return oe.FileIndex.splice(xe,1),oe.FullPaths.splice(xe,1),!0}return!1}function rt(oe,Ee,me){Be(oe);var xe=Es.find(oe,Ee);if(xe){for(var Ne=0;Ne<oe.FileIndex.length;++Ne)if(oe.FileIndex[Ne]==xe)return oe.FileIndex[Ne].name=l(me),oe.FullPaths[Ne]=me,!0}return!1}function je(oe){we(oe,!0)}return t.find=_e,t.read=Se,t.parse=b,t.write=ar,t.writeFile=bt,t.utils={cfb_new:pe,cfb_add:be,cfb_del:Ve,cfb_mov:rt,cfb_gc:je,ReadShift:Ky,CheckField:g8,prep_blob:uA,bconcat:oh,use_zlib:ie,_deflateRaw:vi,_inflateRaw:Nn,consts:jt},t}();function LX(e){return typeof e=="string"?Bb(e):Array.isArray(e)?iX(e):e}function F1(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Bb(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?l1(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var l=new Blob([LX(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(l,e);if(typeof saveAs<"u")return saveAs(l,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var u=URL.createObjectURL(l);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),chrome.downloads.download({url:u,filename:e,saveAs:!0});var d=document.createElement("a");if(d.download!=null)return d.download=e,d.href=u,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),u}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=I1(t)),a.write(t),a.close(),t}catch(v){if(!v.message||!v.message.match(/onstruct/))throw v}throw new Error("cannot save file "+e)}function hh(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function LM(e,t){for(var r=[],n=hh(e),l=0;l!==n.length;++l)r[e[n[l]][t]]==null&&(r[e[n[l]][t]]=n[l]);return r}function sI(e){for(var t=[],r=hh(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Tb(e){for(var t=[],r=hh(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function MX(e){for(var t=[],r=hh(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var p2=new Date(1899,11,30,0,0,0);function Mf(e,t){var r=e.getTime(),n=p2.getTime()+(e.getTimezoneOffset()-p2.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var e8=new Date,OX=p2.getTime()+(e8.getTimezoneOffset()-p2.getTimezoneOffset())*6e4,MM=e8.getTimezoneOffset();function t8(e){var t=new Date;return t.setTime(e*24*60*60*1e3+OX),t.getTimezoneOffset()!==MM&&t.setTime(t.getTime()+(t.getTimezoneOffset()-MM)*6e4),t}var OM=new Date("2017-02-19T19:06:09.000Z"),r8=isNaN(OM.getFullYear())?new Date("2/19/17"):OM,DX=r8.getFullYear()==2017;function cf(e,t){var r=new Date(e);if(DX)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(r8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var l=e.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+l[0],+l[1]-1,+l[2],+l[3]||0,+l[4]||0,+l[5]||0);return e.indexOf("Z")>-1&&(u=new Date(u.getTime()-u.getTimezoneOffset()*60*1e3)),u}function Ib(e,t){if(Jo&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(u){return r[u]||u})}catch{}for(var n=[],l=0;l!=e.length;++l)n.push(String.fromCharCode(e[l]));return n.join("")}function Of(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Of(e[r]));return t}function Zl(e,t){for(var r="";r.length<t;)r+=e;return r}function sm(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(l,u){return r=-r,u}),!isNaN(t=Number(n)))?t/r:t}var RX=["january","february","march","april","may","june","july","august","september","october","november","december"];function s1(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),l=t.getMonth(),u=t.getDate();if(isNaN(u))return r;var d=e.toLowerCase();if(d.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(d=d.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),d.length>3&&RX.indexOf(d)==-1)return r}else if(d.match(/[a-z]/))return r;return n<0||n>8099?r:(l>0||u>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Va(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Jo?n=xm(r):n=aX(r),Es.utils.cfb_add(e,t,n)}Es.utils.cfb_add(e,t,r)}else e.file(t,r)}function lI(){return Es.utils.cfb_new()}var Wc=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kX={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cI=sI(kX),uI=/[&<>'"]/g,UX=/[\u0000-\u0008\u000b-\u001f]/g;function ms(e){var t=e+"";return t.replace(uI,function(r){return cI[r]}).replace(UX,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function DM(e){return ms(e).replace(/ /g,"_x0020_")}var n8=/[\u0000-\u001f]/g;function NX(e){var t=e+"";return t.replace(uI,function(r){return cI[r]}).replace(/\n/g,"<br/>").replace(n8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function zX(e){var t=e+"";return t.replace(uI,function(r){return cI[r]}).replace(n8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function QX(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function jX(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function zB(e){for(var t="",r=0,n=0,l=0,u=0,d=0,a=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(l=e.charCodeAt(r++),n>191&&n<224){d=(n&31)<<6,d|=l&63,t+=String.fromCharCode(d);continue}if(u=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(l&63)<<6|u&63);continue}d=e.charCodeAt(r++),a=((n&7)<<18|(l&63)<<12|(u&63)<<6|d&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function RM(e){var t=E0(2*e.length),r,n,l=1,u=0,d=0,a;for(n=0;n<e.length;n+=l)l=1,(a=e.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(e.charCodeAt(n+1)&63),l=2):a<240?(r=(a&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),l=3):(l=4,r=(a&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,d=55296+(r>>>10&1023),r=56320+(r&1023)),d!==0&&(t[u++]=d&255,t[u++]=d>>>8,d=0),t[u++]=r%256,t[u++]=r>>>8;return t.slice(0,u).toString("ucs2")}function kM(e){return xm(e,"binary").toString("utf8")}var Zx="foo bar bazâð£",Gy=Jo&&(kM(Zx)==zB(Zx)&&kM||RM(Zx)==zB(Zx)&&RM)||zB,l1=Jo?function(e){return xm(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,l=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,l=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(l>>18&7))),t.push(String.fromCharCode(144+(l>>12&63))),t.push(String.fromCharCode(128+(l>>6&63))),t.push(String.fromCharCode(128+(l&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},HX=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),l=0;l<e.length;++l)n=n.replace(e[l][0],e[l][1]);return n}}(),i8=/(^\s|\s$|\n)/;function sh(e,t){return"<"+e+(t.match(i8)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function c1(e){return hh(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function On(e,t,r){return"<"+e+(r!=null?c1(r):"")+(t!=null?(t.match(i8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function bT(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function VX(e,t){switch(typeof e){case"string":var r=On("vt:lpwstr",ms(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return On((e|0)==e?"vt:i4":"vt:r8",ms(String(e)));case"boolean":return On("vt:bool",e?"true":"false")}if(e instanceof Date)return On("vt:filetime",bT(e));throw new Error("Unable to serialize "+e)}var Nu={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},pv=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fA={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function GX(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),l=e[t+6]&15,u=5;u>=0;--u)l=l*256+e[t+u];return n==2047?l==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,l+=Math.pow(2,52)),r*Math.pow(2,n-52)*l)}function KX(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,l=0,u=0,d=n?-t:t;isFinite(d)?d==0?l=u=0:(l=Math.floor(Math.log(d)/Math.LN2),u=d*Math.pow(2,52-l),l<=-1023&&(!isFinite(u)||u<Math.pow(2,52))?l=-1022:(u-=Math.pow(2,52),l+=1023)):(l=2047,u=isNaN(t)?26985:0);for(var a=0;a<=5;++a,u/=256)e[r+a]=u&255;e[r+6]=(l&15)<<4|u&15,e[r+7]=l>>4|n}var UM=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var l=0,u=e[0][n].length;l<u;l+=r)t.push.apply(t,e[0][n].slice(l,l+r));return t},NM=Jo?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:xm(t)})):UM(e)}:UM,zM=function(e,t,r){for(var n=[],l=t;l<r;l+=2)n.push(String.fromCharCode(Oy(e,l)));return n.join("").replace(Vy,"")},hI=Jo?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Vy,""):zM(e,t,r)}:zM,QM=function(e,t,r){for(var n=[],l=t;l<t+r;++l)n.push(("0"+e[l].toString(16)).slice(-2));return n.join("")},a8=Jo?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):QM(e,t,r)}:QM,jM=function(e,t,r){for(var n=[],l=t;l<r;l++)n.push(String.fromCharCode(F_(e,l)));return n.join("")},P1=Jo?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):jM(t,r,n)}:jM,o8=function(e,t){var r=AA(e,t);return r>0?P1(e,t+4,t+4+r-1):""},s8=o8,l8=function(e,t){var r=AA(e,t);return r>0?P1(e,t+4,t+4+r-1):""},c8=l8,u8=function(e,t){var r=2*AA(e,t);return r>0?P1(e,t+4,t+4+r-1):""},h8=u8,f8=function(t,r){var n=AA(t,r);return n>0?hI(t,r+4,r+4+n):""},A8=f8,d8=function(e,t){var r=AA(e,t);return r>0?P1(e,t+4,t+4+r):""},p8=d8,m8=function(e,t){return GX(e,t)},m2=m8,fI=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Jo&&(s8=function(t,r){if(!Buffer.isBuffer(t))return o8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},c8=function(t,r){if(!Buffer.isBuffer(t))return l8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},h8=function(t,r){if(!Buffer.isBuffer(t))return u8(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},A8=function(t,r){if(!Buffer.isBuffer(t))return f8(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},p8=function(t,r){if(!Buffer.isBuffer(t))return d8(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},m2=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):m8(t,r)},fI=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var F_=function(e,t){return e[t]},Oy=function(e,t){return e[t+1]*256+e[t]},WX=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},AA=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},s0=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},qX=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ky(e,t){var r="",n,l,u=[],d,a,v,x;switch(t){case"dbcs":if(x=this.l,Jo&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(v=0;v<e;++v)r+=String.fromCharCode(Oy(this,x)),x+=2;e*=2;break;case"utf8":r=P1(this,this.l,this.l+e);break;case"utf16le":e*=2,r=hI(this,this.l,this.l+e);break;case"wstr":return Ky.call(this,e,"dbcs");case"lpstr-ansi":r=s8(this,this.l),e=4+AA(this,this.l);break;case"lpstr-cp":r=c8(this,this.l),e=4+AA(this,this.l);break;case"lpwstr":r=h8(this,this.l),e=4+2*AA(this,this.l);break;case"lpp4":e=4+AA(this,this.l),r=A8(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+AA(this,this.l),r=p8(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(d=F_(this,this.l+e++))!==0;)u.push(qx(d));r=u.join("");break;case"_wstr":for(e=0,r="";(d=Oy(this,this.l+e))!==0;)u.push(qx(d)),e+=2;e+=2,r=u.join("");break;case"dbcs-cont":for(r="",x=this.l,v=0;v<e;++v){if(this.lens&&this.lens.indexOf(x)!==-1)return d=F_(this,x),this.l=x+1,a=Ky.call(this,e-v,d?"dbcs-cont":"sbcs-cont"),u.join("")+a;u.push(qx(Oy(this,x))),x+=2}r=u.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",x=this.l,v=0;v!=e;++v){if(this.lens&&this.lens.indexOf(x)!==-1)return d=F_(this,x),this.l=x+1,a=Ky.call(this,e-v,d?"dbcs-cont":"sbcs-cont"),u.join("")+a;u.push(qx(F_(this,x))),x+=1}r=u.join("");break;default:switch(e){case 1:return n=F_(this,this.l),this.l++,n;case 2:return n=(t==="i"?WX:Oy)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?s0:qX)(this,this.l),this.l+=4,n):(l=AA(this,this.l),this.l+=4,l);case 8:case-8:if(t==="f")return e==8?l=m2(this,this.l):l=m2([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,l;e=8;case 16:r=a8(this,this.l,e);break}}return this.l+=e,r}var $X=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},XX=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},ZX=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function YX(e,t,r){var n=0,l=0;if(r==="dbcs"){for(l=0;l!=t.length;++l)ZX(this,t.charCodeAt(l),this.l+2*l);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),l=0;l!=t.length;++l)this[this.l+l]=t.charCodeAt(l)&255;n=t.length}else if(r==="hex"){for(;l<e;++l)this[this.l++]=parseInt(t.slice(2*l,2*l+2),16)||0;return this}else if(r==="utf16le"){var u=Math.min(this.l+e,this.length);for(l=0;l<Math.min(t.length,e);++l){var d=t.charCodeAt(l);this[this.l++]=d&255,this[this.l++]=d>>8}for(;this.l<u;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,$X(this,t,this.l);break;case 8:if(n=8,r==="f"){KX(this,t,this.l);break}case 16:break;case-4:n=4,XX(this,t,this.l);break}return this.l+=n,this}function g8(e,t){var r=a8(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function uA(e,t){e.l=t,e.read_shift=Ky,e.chk=g8,e.write_shift=YX}function Tp(e,t){e.l+=t}function Zr(e){var t=E0(e);return uA(t,0),t}function Lf(){var e=[],t=Jo?256:2048,r=function(x){var b=Zr(x);return uA(b,0),b},n=r(t),l=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},u=function(x){return n&&x<n.length-n.l?n:(l(),n=r(Math.max(x+1,t)))},d=function(){return l(),oh(e)},a=function(x){l(),n=x,n.l==null&&(n.l=n.length),u(t)};return{next:u,push:a,end:d,_bufs:e}}function gn(e,t,r,n){var l=+t,u;if(!isNaN(l)){n||(n=Gre[l].p||(r||[]).length||0),u=1+(l>=128?1:0)+1,n>=128&&++u,n>=16384&&++u,n>=2097152&&++u;var d=e.next(u);l<=127?d.write_shift(1,l):(d.write_shift(1,(l&127)+128),d.write_shift(1,l>>7));for(var a=0;a!=4;++a)if(n>=128)d.write_shift(1,(n&127)+128),n>>=7;else{d.write_shift(1,n);break}n>0&&fI(r)&&e.push(r)}}function Wy(e,t,r){var n=Of(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function HM(e,t,r){var n=Of(e);return n.s=Wy(n.s,t.s,r),n.e=Wy(n.e,t.s,r),n}function qy(e,t){if(e.cRel&&e.c<0)for(e=Of(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Of(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=gs(e);return!e.cRel&&e.cRel!=null&&(r=tZ(r)),!e.rRel&&e.rRel!=null&&(r=JX(r)),r}function QB(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+kh(e.s.c)+":"+(e.e.cRel?"":"$")+kh(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+uh(e.s.r)+":"+(e.e.rRel?"":"$")+uh(e.e.r):qy(e.s,t.biff)+":"+qy(e.e,t.biff)}function AI(e){return parseInt(eZ(e),10)-1}function uh(e){return""+(e+1)}function JX(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function eZ(e){return e.replace(/\$(\d+)$/,"$1")}function dI(e){for(var t=rZ(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function kh(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function tZ(e){return e.replace(/^([A-Z])/,"$$$1")}function rZ(e){return e.replace(/^\$([A-Z])/,"$1")}function nZ(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function zu(e){for(var t=0,r=0,n=0;n<e.length;++n){var l=e.charCodeAt(n);l>=48&&l<=57?t=10*t+(l-48):l>=65&&l<=90&&(r=26*r+(l-64))}return{c:r-1,r:t-1}}function gs(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function _A(e){var t=e.indexOf(":");return t==-1?{s:zu(e),e:zu(e)}:{s:zu(e.slice(0,t)),e:zu(e.slice(t+1))}}function Gc(e,t){return typeof t>"u"||typeof t=="number"?Gc(e.s,e.e):(typeof e!="string"&&(e=gs(e)),typeof t!="string"&&(t=gs(t)),e==t?e:e+":"+t)}function ol(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,l=0,u=e.length;for(r=0;n<u&&!((l=e.charCodeAt(n)-64)<1||l>26);++n)r=26*r+l;for(t.s.c=--r,r=0;n<u&&!((l=e.charCodeAt(n)-48)<0||l>9);++n)r=10*r+l;if(t.s.r=--r,n===u||l!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=u&&!((l=e.charCodeAt(n)-64)<1||l>26);++n)r=26*r+l;for(t.e.c=--r,r=0;n!=u&&!((l=e.charCodeAt(n)-48)<0||l>9);++n)r=10*r+l;return t.e.r=--r,t}function VM(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Bg(e.z,r?Mf(t):t)}catch{}try{return e.w=Bg((e.XF||{}).numFmtId||(r?14:0),r?Mf(t):t)}catch{return""+t}}function dm(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?L1[e.v]||e.v:t==null?VM(e,e.v):VM(e,t))}function O0(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function _8(e,t,r){var n=r||{},l=e?Array.isArray(e):n.dense,u=e||(l?[]:{}),d=0,a=0;if(u&&n.origin!=null){if(typeof n.origin=="number")d=n.origin;else{var v=typeof n.origin=="string"?zu(n.origin):n.origin;d=v.r,a=v.c}u["!ref"]||(u["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(u["!ref"]){var b=ol(u["!ref"]);x.s.c=b.s.c,x.s.r=b.s.r,x.e.c=Math.max(x.e.c,b.e.c),x.e.r=Math.max(x.e.r,b.e.r),d==-1&&(x.e.r=d=b.e.r+1)}for(var I=0;I!=t.length;++I)if(t[I]){if(!Array.isArray(t[I]))throw new Error("aoa_to_sheet expects an array of arrays");for(var M=0;M!=t[I].length;++M)if(!(typeof t[I][M]>"u")){var L={v:t[I][M]},U=d+I,R=a+M;if(x.s.r>U&&(x.s.r=U),x.s.c>R&&(x.s.c=R),x.e.r<U&&(x.e.r=U),x.e.c<R&&(x.e.c=R),t[I][M]&&typeof t[I][M]=="object"&&!Array.isArray(t[I][M])&&!(t[I][M]instanceof Date))L=t[I][M];else if(Array.isArray(L.v)&&(L.f=t[I][M][1],L.v=L.v[0]),L.v===null)if(L.f)L.t="n";else if(n.nullError)L.t="e",L.v=0;else if(n.sheetStubs)L.t="z";else continue;else typeof L.v=="number"?L.t="n":typeof L.v=="boolean"?L.t="b":L.v instanceof Date?(L.z=n.dateNF||Jl[14],n.cellDates?(L.t="d",L.w=Bg(L.z,Mf(L.v))):(L.t="n",L.v=Mf(L.v),L.w=Bg(L.z,L.v))):L.t="s";if(l)u[U]||(u[U]=[]),u[U][R]&&u[U][R].z&&(L.z=u[U][R].z),u[U][R]=L;else{var H=gs({c:R,r:U});u[H]&&u[H].z&&(L.z=u[H].z),u[H]=L}}}return x.s.c<1e7&&(u["!ref"]=Gc(x)),u}function mv(e,t){return _8(null,e,t)}function iZ(e){return e.read_shift(4,"i")}function kd(e,t){return t||(t=Zr(4)),t.write_shift(4,e),t}function Uh(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Qu(e,t){var r=!1;return t==null&&(r=!0,t=Zr(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function aZ(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function oZ(e,t){return t||(t=Zr(4)),t.write_shift(2,0),t.write_shift(2,0),t}function pI(e,t){var r=e.l,n=e.read_shift(1),l=Uh(e),u=[],d={t:l,h:l};if((n&1)!==0){for(var a=e.read_shift(4),v=0;v!=a;++v)u.push(aZ(e));d.r=u}else d.r=[{ich:0,ifnt:0}];return e.l=r+t,d}function sZ(e,t){var r=!1;return t==null&&(r=!0,t=Zr(15+4*e.t.length)),t.write_shift(1,0),Qu(e.t,t),r?t.slice(0,t.l):t}var lZ=pI;function cZ(e,t){var r=!1;return t==null&&(r=!0,t=Zr(23+4*e.t.length)),t.write_shift(1,1),Qu(e.t,t),t.write_shift(4,1),oZ({},t),r?t.slice(0,t.l):t}function sd(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function D0(e,t){return t==null&&(t=Zr(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function R0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function k0(e,t){return t==null&&(t=Zr(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var uZ=Uh,v8=Qu;function mI(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function g2(e,t){var r=!1;return t==null&&(r=!0,t=Zr(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var hZ=Uh,ET=mI,gI=g2;function y8(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var l=n===0?m2([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):s0(t,0)>>2;return r?l/100:l}function x8(e,t){t==null&&(t=Zr(4));var r=0,n=0,l=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:l==(l|0)&&l>=-536870912&&l<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?l:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function w8(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function fZ(e,t){return t||(t=Zr(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var U0=w8,gv=fZ;function _v(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function B0(e,t){return(t||Zr(8)).write_shift(8,e,"f")}function AZ(e){var t={},r=e.read_shift(1),n=r>>>1,l=e.read_shift(1),u=e.read_shift(2,"i"),d=e.read_shift(1),a=e.read_shift(1),v=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=l;var x=wZ[l];x&&(t.rgb=tO(x));break;case 2:t.rgb=tO([d,a,v]);break;case 3:t.theme=l;break}return u!=0&&(t.tint=u>0?u/32767:u/32768),t}function _2(e,t){if(t||(t=Zr(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function dZ(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function pZ(e,t){t||(t=Zr(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var b8=2,cA=3,Yx=11,v2=19,Jx=64,mZ=65,gZ=71,_Z=4108,vZ=4126,nh=80,GM={1:{n:"CodePage",t:b8},2:{n:"Category",t:nh},3:{n:"PresentationFormat",t:nh},4:{n:"ByteCount",t:cA},5:{n:"LineCount",t:cA},6:{n:"ParagraphCount",t:cA},7:{n:"SlideCount",t:cA},8:{n:"NoteCount",t:cA},9:{n:"HiddenCount",t:cA},10:{n:"MultimediaClipCount",t:cA},11:{n:"ScaleCrop",t:Yx},12:{n:"HeadingPairs",t:_Z},13:{n:"TitlesOfParts",t:vZ},14:{n:"Manager",t:nh},15:{n:"Company",t:nh},16:{n:"LinksUpToDate",t:Yx},17:{n:"CharacterCount",t:cA},19:{n:"SharedDoc",t:Yx},22:{n:"HyperlinksChanged",t:Yx},23:{n:"AppVersion",t:cA,p:"version"},24:{n:"DigSig",t:mZ},26:{n:"ContentType",t:nh},27:{n:"ContentStatus",t:nh},28:{n:"Language",t:nh},29:{n:"Version",t:nh},255:{},2147483648:{n:"Locale",t:v2},2147483651:{n:"Behavior",t:v2},1919054434:{}},KM={1:{n:"CodePage",t:b8},2:{n:"Title",t:nh},3:{n:"Subject",t:nh},4:{n:"Author",t:nh},5:{n:"Keywords",t:nh},6:{n:"Comments",t:nh},7:{n:"Template",t:nh},8:{n:"LastAuthor",t:nh},9:{n:"RevNumber",t:nh},10:{n:"EditTime",t:Jx},11:{n:"LastPrinted",t:Jx},12:{n:"CreatedDate",t:Jx},13:{n:"ModifiedDate",t:Jx},14:{n:"PageCount",t:cA},15:{n:"WordCount",t:cA},16:{n:"CharCount",t:cA},17:{n:"Thumbnail",t:gZ},18:{n:"Application",t:nh},19:{n:"DocSecurity",t:cA},255:{},2147483648:{n:"Locale",t:v2},2147483651:{n:"Behavior",t:v2},1919054434:{}};function yZ(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var xZ=yZ([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),wZ=Of(xZ),L1={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},bZ={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ew={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function E8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function B8(e,t){var r=MX(bZ),n=[],l;n[n.length]=Wc,n[n.length]=On("Types",null,{xmlns:Nu.CT,"xmlns:xsd":Nu.xsd,"xmlns:xsi":Nu.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(v){return On("Default",null,{Extension:v[0],ContentType:v[1]})}));var u=function(v){e[v]&&e[v].length>0&&(l=e[v][0],n[n.length]=On("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:ew[v][t.bookType]||ew[v].xlsx}))},d=function(v){(e[v]||[]).forEach(function(x){n[n.length]=On("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:ew[v][t.bookType]||ew[v].xlsx})})},a=function(v){(e[v]||[]).forEach(function(x){n[n.length]=On("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:r[v][0]})})};return u("workbooks"),d("sheets"),d("charts"),a("themes"),["strs","styles"].forEach(u),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),d("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ro={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function C8(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function j_(e){var t=[Wc,On("Relationships",null,{xmlns:Nu.RELS})];return hh(e["!id"]).forEach(function(r){t[t.length]=On("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function As(e,t,r,n,l,u){if(l||(l={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,l.Id="rId"+t,l.Type=n,l.Target=r,[Ro.HLINK,Ro.XPATH,Ro.XMISS].indexOf(l.Type)>-1&&(l.TargetMode="External"),e["!id"][l.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][l.Id]=l,e[("/"+l.Target).replace("//","/")]=l,t}function EZ(e){var t=[Wc];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function WM(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function BZ(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function CZ(e){var t=[Wc];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(WM(e[r][0],e[r][1])),t.push(BZ("",e[r][0]));return t.push(WM("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function S8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+u2.version+"</meta:generator></office:meta></office:document-meta>"}var p0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function jB(e,t,r,n,l){l[e]!=null||t==null||t===""||(l[e]=t,t=ms(t),n[n.length]=r?On(e,t,r):sh(e,t))}function T8(e,t){var r=t||{},n=[Wc,On("cp:coreProperties",null,{"xmlns:cp":Nu.CORE_PROPS,"xmlns:dc":Nu.dc,"xmlns:dcterms":Nu.dcterms,"xmlns:dcmitype":Nu.dcmitype,"xmlns:xsi":Nu.xsi})],l={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&jB("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:bT(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,l),e.ModifiedDate!=null&&jB("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:bT(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,l));for(var u=0;u!=p0.length;++u){var d=p0[u],a=r.Props&&r.Props[d[1]]!=null?r.Props[d[1]]:e?e[d[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&jB(d[0],a,null,n,l)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var H_=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],I8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function F8(e){var t=[],r=On;return e||(e={}),e.Application="SheetJS",t[t.length]=Wc,t[t.length]=On("Properties",null,{xmlns:Nu.EXT_PROPS,"xmlns:vt":Nu.vt}),H_.forEach(function(n){if(e[n[1]]!==void 0){var l;switch(n[2]){case"string":l=ms(String(e[n[1]]));break;case"bool":l=e[n[1]]?"true":"false";break}l!==void 0&&(t[t.length]=r(n[0],l))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ms(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function P8(e){var t=[Wc,On("Properties",null,{xmlns:Nu.CUST_PROPS,"xmlns:vt":Nu.vt})];if(!e)return t.join("");var r=1;return hh(e).forEach(function(l){++r,t[t.length]=On("property",VX(e[l]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ms(l)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var qM={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function SZ(e,t){var r=[];return hh(qM).map(function(n){for(var l=0;l<p0.length;++l)if(p0[l][1]==n)return p0[l];for(l=0;l<H_.length;++l)if(H_[l][1]==n)return H_[l];throw n}).forEach(function(n){if(e[n[1]]!=null){var l=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":l=new Date(l).toISOString().replace(/\.\d*Z/,"Z");break}typeof l=="number"?l=String(l):l===!0||l===!1?l=l?"1":"0":l instanceof Date&&(l=new Date(l).toISOString().replace(/\.\d*Z/,"")),r.push(sh(qM[n[1]]||n[1],l))}}),On("DocumentProperties",r.join(""),{xmlns:fA.o})}function TZ(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",l=[];return e&&hh(e).forEach(function(u){if(Object.prototype.hasOwnProperty.call(e,u)){for(var d=0;d<p0.length;++d)if(u==p0[d][1])return;for(d=0;d<H_.length;++d)if(u==H_[d][1])return;for(d=0;d<r.length;++d)if(u==r[d])return;var a=e[u],v="string";typeof a=="number"?(v="float",a=String(a)):a===!0||a===!1?(v="boolean",a=a?"1":"0"):a=String(a),l.push(On(DM(u),a,{"dt:dt":v}))}}),t&&hh(t).forEach(function(u){if(Object.prototype.hasOwnProperty.call(t,u)&&!(e&&Object.prototype.hasOwnProperty.call(e,u))){var d=t[u],a="string";typeof d=="number"?(a="float",d=String(d)):d===!0||d===!1?(a="boolean",d=d?"1":"0"):d instanceof Date?(a="dateTime.tz",d=d.toISOString()):d=String(d),l.push(On(DM(u),d,{"dt:dt":a}))}}),"<"+n+' xmlns="'+fA.o+'">'+l.join("")+"</"+n+">"}function IZ(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),l=(r-n)/Math.pow(2,32);n*=1e7,l*=1e7;var u=n/Math.pow(2,32)|0;u>0&&(n=n%Math.pow(2,32),l+=u);var d=Zr(8);return d.write_shift(4,n),d.write_shift(4,l),d}function $M(e,t){var r=Zr(4),n=Zr(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Zr(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=IZ(t);break;case 31:case 80:for(n=Zr(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return oh([r,n])}var L8=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function FZ(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function XM(e,t,r){var n=Zr(8),l=[],u=[],d=8,a=0,v=Zr(8),x=Zr(8);if(v.write_shift(4,2),v.write_shift(4,1200),x.write_shift(4,1),u.push(v),l.push(x),d+=8+v.length,!t){x=Zr(8),x.write_shift(4,0),l.unshift(x);var b=[Zr(4)];for(b[0].write_shift(4,e.length),a=0;a<e.length;++a){var I=e[a][0];for(v=Zr(8+2*(I.length+1)+(I.length%2?0:2)),v.write_shift(4,a+2),v.write_shift(4,I.length+1),v.write_shift(0,I,"dbcs");v.l!=v.length;)v.write_shift(1,0);b.push(v)}v=oh(b),u.unshift(v),d+=8+v.length}for(a=0;a<e.length;++a)if(!(t&&!t[e[a][0]])&&!(L8.indexOf(e[a][0])>-1||I8.indexOf(e[a][0])>-1)&&e[a][1]!=null){var M=e[a][1],L=0;if(t){L=+t[e[a][0]];var U=r[L];if(U.p=="version"&&typeof M=="string"){var R=M.split(".");M=(+R[0]<<16)+(+R[1]||0)}v=$M(U.t,M)}else{var H=FZ(M);H==-1&&(H=31,M=String(M)),v=$M(H,M)}u.push(v),x=Zr(8),x.write_shift(4,t?L:2+a),l.push(x),d+=8+v.length}var q=8*(u.length+1);for(a=0;a<u.length;++a)l[a].write_shift(4,q),q+=u[a].length;return n.write_shift(4,d),n.write_shift(4,u.length),oh([n].concat(l).concat(u))}function ZM(e,t,r,n,l,u){var d=Zr(l?68:48),a=[d];d.write_shift(2,65534),d.write_shift(2,0),d.write_shift(4,842412599),d.write_shift(16,Es.utils.consts.HEADER_CLSID,"hex"),d.write_shift(4,l?2:1),d.write_shift(16,t,"hex"),d.write_shift(4,l?68:48);var v=XM(e,r,n);if(a.push(v),l){var x=XM(l,null,null);d.write_shift(16,u,"hex"),d.write_shift(4,68+v.length),a.push(x)}return oh(a)}function PZ(e,t){t||(t=Zr(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function LZ(e,t){return e.read_shift(t)===1}function sf(e,t){return t||(t=Zr(2)),t.write_shift(2,+!!e),t}function M8(e){return e.read_shift(2,"u")}function XA(e,t){return t||(t=Zr(2)),t.write_shift(2,e),t}function O8(e,t,r){return r||(r=Zr(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function D8(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),l="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var u=e.read_shift(1);u&&(l="dbcs-cont")}else r.biff==12&&(l="wstr");r.biff>=2&&r.biff<=5&&(l="cpstr");var d=n?e.read_shift(n,l):"";return d}function MZ(e){var t=e.t||"",r=Zr(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Zr(2*t.length);n.write_shift(2*t.length,t,"utf16le");var l=[r,n];return oh(l)}function OZ(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var l=e.read_shift(1);return l===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function DZ(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):OZ(e,n,r)}function RZ(e,t,r){if(r.biff>5)return DZ(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function R8(e,t,r){return r||(r=Zr(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function YM(e,t){t||(t=Zr(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function kZ(e){var t=Zr(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var l=n.indexOf("#"),u=l>-1?31:23;switch(n.charAt(0)){case"#":u=28;break;case".":u&=-3;break}t.write_shift(4,2),t.write_shift(4,u);var d=[8,6815827,6619237,4849780,83];for(r=0;r<d.length;++r)t.write_shift(4,d[r]);if(u==28)n=n.slice(1),YM(n,t);else if(u&2){for(d="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<d.length;++r)t.write_shift(1,parseInt(d[r],16));var a=l>-1?n.slice(0,l):n;for(t.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)t.write_shift(2,a.charCodeAt(r));t.write_shift(2,0),u&8&&YM(l>-1?n.slice(l+1):"",t)}else{for(d="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<d.length;++r)t.write_shift(1,parseInt(d[r],16));for(var v=0;n.slice(v*3,v*3+3)=="../"||n.slice(v*3,v*3+3)=="..\\";)++v;for(t.write_shift(2,v),t.write_shift(4,n.length-3*v+1),r=0;r<n.length-3*v;++r)t.write_shift(1,n.charCodeAt(r+3*v)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function C0(e,t,r,n){return n||(n=Zr(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function UZ(e,t,r){var n=r.biff>8?4:2,l=e.read_shift(n),u=e.read_shift(n,"i"),d=e.read_shift(n,"i");return[l,u,d]}function NZ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2);return{s:{c:n,r:t},e:{c:l,r}}}function k8(e,t){return t||(t=Zr(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function _I(e,t,r){var n=1536,l=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,l=8;break;case"biff4":n=4,l=6;break;case"biff3":n=3,l=6;break;case"biff2":n=2,l=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var u=Zr(l);return u.write_shift(2,n),u.write_shift(2,t),l>4&&u.write_shift(2,29282),l>6&&u.write_shift(2,1997),l>8&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function zZ(e,t){var r=!t||t.biff==8,n=Zr(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function QZ(e,t){var r=!t||t.biff>=8?2:1,n=Zr(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var l=n.slice(0,n.l);return l.l=n.l,l}function jZ(e,t){var r=Zr(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],l=0;l<e.length;++l)n[l]=MZ(e[l]);var u=oh([r].concat(n));return u.parts=[r.length].concat(n.map(function(d){return d.length})),u}function HZ(){var e=Zr(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function VZ(e){var t=Zr(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function GZ(e,t){var r=e.name||"Arial",n=t&&t.biff==5,l=n?15+r.length:16+2*r.length,u=Zr(l);return u.write_shift(2,e.sz*20),u.write_shift(4,0),u.write_shift(2,400),u.write_shift(4,0),u.write_shift(2,0),u.write_shift(1,r.length),n||u.write_shift(1,1),u.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),u}function KZ(e,t,r,n){var l=Zr(10);return C0(e,t,n,l),l.write_shift(4,r),l}function WZ(e,t,r,n,l){var u=!l||l.biff==8,d=Zr(8+ +u+(1+u)*r.length);return C0(e,t,n,d),d.write_shift(2,r.length),u&&d.write_shift(1,1),d.write_shift((1+u)*r.length,r,u?"utf16le":"sbcs"),d}function qZ(e,t,r,n){var l=r&&r.biff==5;n||(n=Zr(l?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(l?1:2,t.length),l||n.write_shift(1,1),n.write_shift((l?1:2)*t.length,t,l?"sbcs":"utf16le");var u=n.length>n.l?n.slice(0,n.l):n;return u.l==null&&(u.l=u.length),u}function $Z(e,t){var r=t.biff==8||!t.biff?4:2,n=Zr(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function JM(e,t,r,n){var l=r&&r.biff==5;n||(n=Zr(l?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var u=0;return e.numFmtId>0&&l&&(u|=1024),n.write_shift(4,u),n.write_shift(4,0),l||n.write_shift(4,0),n.write_shift(2,0),n}function XZ(e){var t=Zr(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function ZZ(e,t,r,n,l,u){var d=Zr(8);return C0(e,t,n,d),O8(r,u,d),d}function YZ(e,t,r,n){var l=Zr(14);return C0(e,t,n,l),B0(r,l),l}function JZ(e,t,r){if(r.biff<8)return eY(e,t,r);for(var n=[],l=e.l+t,u=e.read_shift(r.biff>8?4:2);u--!==0;)n.push(UZ(e,r.biff>8?12:6,r));if(e.l!=l)throw new Error("Bad ExternSheet: "+e.l+" != "+l);return n}function eY(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=D8(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function tY(e){var t=Zr(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)k8(e[r],t);return t}function rY(e){var t=Zr(24),r=zu(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),l=0;l<16;++l)t.write_shift(1,parseInt(n[l],16));return oh([t,kZ(e[1])])}function nY(e){var t=e[1].Tooltip,r=Zr(10+2*(t.length+1));r.write_shift(2,2048);var n=zu(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var l=0;l<t.length;++l)r.write_shift(2,t.charCodeAt(l));return r.write_shift(2,0),r}function iY(e){return e||(e=Zr(4)),e.write_shift(2,1),e.write_shift(2,1),e}function aY(e,t,r){if(!r.cellStyles)return Tp(e,t);var n=r&&r.biff>=12?4:2,l=e.read_shift(n),u=e.read_shift(n),d=e.read_shift(n),a=e.read_shift(n),v=e.read_shift(2);n==2&&(e.l+=2);var x={s:l,e:u,w:d,ixfe:a,flags:v};return(r.biff>=5||!r.biff)&&(x.level=v>>8&7),x}function oY(e,t){var r=Zr(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function sY(e){for(var t=Zr(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function lY(e,t,r){var n=Zr(15);return O1(n,e,t),n.write_shift(8,r,"f"),n}function cY(e,t,r){var n=Zr(9);return O1(n,e,t),n.write_shift(2,r),n}var uY=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=sI({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,v){var x=[],b=E0(1);switch(v.type){case"base64":b=Md(Am(a));break;case"binary":b=Md(a);break;case"buffer":case"array":b=a;break}uA(b,0);var I=b.read_shift(1),M=!!(I&136),L=!1,U=!1;switch(I){case 2:break;case 3:break;case 48:L=!0,M=!0;break;case 49:L=!0,M=!0;break;case 131:break;case 139:break;case 140:U=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+I.toString(16))}var R=0,H=521;I==2&&(R=b.read_shift(2)),b.l+=3,I!=2&&(R=b.read_shift(4)),R>1048576&&(R=1e6),I!=2&&(H=b.read_shift(2));var q=b.read_shift(2),te=v.codepage||1252;I!=2&&(b.l+=16,b.read_shift(1),b[b.l]!==0&&(te=e[b[b.l]]),b.l+=1,b.l+=2),U&&(b.l+=36);for(var J=[],se={},ye=Math.min(b.length,I==2?521:H-10-(L?264:0)),Se=U?32:11;b.l<ye&&b[b.l]!=13;)switch(se={},se.name=h2.utils.decode(te,b.slice(b.l,b.l+Se)).replace(/[\u0000\r\n].*$/g,""),b.l+=Se,se.type=String.fromCharCode(b.read_shift(1)),I!=2&&!U&&(se.offset=b.read_shift(4)),se.len=b.read_shift(1),I==2&&(se.offset=b.read_shift(2)),se.dec=b.read_shift(1),se.name.length&&J.push(se),I!=2&&(b.l+=U?13:14),se.type){case"B":(!L||se.len!=8)&&v.WTF&&console.log("Skipping "+se.name+":"+se.type);break;case"G":case"P":v.WTF&&console.log("Skipping "+se.name+":"+se.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+se.type)}if(b[b.l]!==13&&(b.l=H-1),b.read_shift(1)!==13)throw new Error("DBF Terminator not found "+b.l+" "+b[b.l]);b.l=H;var Be=0,De=0;for(x[0]=[],De=0;De!=J.length;++De)x[0][De]=J[De].name;for(;R-- >0;){if(b[b.l]===42){b.l+=q;continue}for(++b.l,x[++Be]=[],De=0,De=0;De!=J.length;++De){var we=b.slice(b.l,b.l+J[De].len);b.l+=J[De].len,uA(we,0);var nt=h2.utils.decode(te,we);switch(J[De].type){case"C":nt.trim().length&&(x[Be][De]=nt.replace(/\s+$/,""));break;case"D":nt.length===8?x[Be][De]=new Date(+nt.slice(0,4),+nt.slice(4,6)-1,+nt.slice(6,8)):x[Be][De]=nt;break;case"F":x[Be][De]=parseFloat(nt.trim());break;case"+":case"I":x[Be][De]=U?we.read_shift(-4,"i")^2147483648:we.read_shift(4,"i");break;case"L":switch(nt.trim().toUpperCase()){case"Y":case"T":x[Be][De]=!0;break;case"N":case"F":x[Be][De]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+nt+"|")}break;case"M":if(!M)throw new Error("DBF Unexpected MEMO for type "+I.toString(16));x[Be][De]="##MEMO##"+(U?parseInt(nt.trim(),10):we.read_shift(4));break;case"N":nt=nt.replace(/\u0000/g,"").trim(),nt&&nt!="."&&(x[Be][De]=+nt||0);break;case"@":x[Be][De]=new Date(we.read_shift(-8,"f")-621356832e5);break;case"T":x[Be][De]=new Date((we.read_shift(4)-2440588)*864e5+we.read_shift(4));break;case"Y":x[Be][De]=we.read_shift(4,"i")/1e4+we.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[Be][De]=-we.read_shift(-8,"f");break;case"B":if(L&&J[De].len==8){x[Be][De]=we.read_shift(8,"f");break}case"G":case"P":we.l+=J[De].len;break;case"0":if(J[De].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+J[De].type)}}}if(I!=2&&b.l<b.length&&b[b.l++]!=26)throw new Error("DBF EOF Marker missing "+(b.l-1)+" of "+b.length+" "+b[b.l-1].toString(16));return v&&v.sheetRows&&(x=x.slice(0,v.sheetRows)),v.DBF=J,x}function n(a,v){var x=v||{};x.dateNF||(x.dateNF="yyyymmdd");var b=mv(r(a,x),x);return b["!cols"]=x.DBF.map(function(I){return{wch:I.len,DBF:I}}),delete x.DBF,b}function l(a,v){try{return O0(n(a,v),v)}catch(x){if(v&&v.WTF)throw x}return{SheetNames:[],Sheets:{}}}var u={B:8,C:250,L:1,D:8,"?":0,"":0};function d(a,v){var x=v||{};if(+x.codepage>=0&&a1(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var b=Lf(),I=E2(a,{header:1,raw:!0,cellDates:!0}),M=I[0],L=I.slice(1),U=a["!cols"]||[],R=0,H=0,q=0,te=1;for(R=0;R<M.length;++R){if(((U[R]||{}).DBF||{}).name){M[R]=U[R].DBF.name,++q;continue}if(M[R]!=null){if(++q,typeof M[R]=="number"&&(M[R]=M[R].toString(10)),typeof M[R]!="string")throw new Error("DBF Invalid column name "+M[R]+" |"+typeof M[R]+"|");if(M.indexOf(M[R])!==R){for(H=0;H<1024;++H)if(M.indexOf(M[R]+"_"+H)==-1){M[R]+="_"+H;break}}}}var J=ol(a["!ref"]),se=[],ye=[],Se=[];for(R=0;R<=J.e.c-J.s.c;++R){var Be="",De="",we=0,nt=[];for(H=0;H<L.length;++H)L[H][R]!=null&&nt.push(L[H][R]);if(nt.length==0||M[R]==null){se[R]="?";continue}for(H=0;H<nt.length;++H){switch(typeof nt[H]){case"number":De="B";break;case"string":De="C";break;case"boolean":De="L";break;case"object":De=nt[H]instanceof Date?"D":"C";break;default:De="C"}we=Math.max(we,String(nt[H]).length),Be=Be&&Be!=De?"C":De}we>250&&(we=250),De=((U[R]||{}).DBF||{}).type,De=="C"&&U[R].DBF.len>we&&(we=U[R].DBF.len),Be=="B"&&De=="N"&&(Be="N",Se[R]=U[R].DBF.dec,we=U[R].DBF.len),ye[R]=Be=="C"||De=="N"?we:u[Be]||0,te+=ye[R],se[R]=Be}var _e=b.next(32);for(_e.write_shift(4,318902576),_e.write_shift(4,L.length),_e.write_shift(2,296+32*q),_e.write_shift(2,te),R=0;R<4;++R)_e.write_shift(4,0);for(_e.write_shift(4,0|(+t[N6]||3)<<8),R=0,H=0;R<M.length;++R)if(M[R]!=null){var Ie=b.next(32),Ze=(M[R].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Ie.write_shift(1,Ze,"sbcs"),Ie.write_shift(1,se[R]=="?"?"C":se[R],"sbcs"),Ie.write_shift(4,H),Ie.write_shift(1,ye[R]||u[se[R]]||0),Ie.write_shift(1,Se[R]||0),Ie.write_shift(1,2),Ie.write_shift(4,0),Ie.write_shift(1,0),Ie.write_shift(4,0),Ie.write_shift(4,0),H+=ye[R]||u[se[R]]||0}var st=b.next(264);for(st.write_shift(4,13),R=0;R<65;++R)st.write_shift(4,0);for(R=0;R<L.length;++R){var Et=b.next(te);for(Et.write_shift(1,0),H=0;H<M.length;++H)if(M[H]!=null)switch(se[H]){case"L":Et.write_shift(1,L[R][H]==null?63:L[R][H]?84:70);break;case"B":Et.write_shift(8,L[R][H]||0,"f");break;case"N":var Ut="0";for(typeof L[R][H]=="number"&&(Ut=L[R][H].toFixed(Se[H]||0)),q=0;q<ye[H]-Ut.length;++q)Et.write_shift(1,32);Et.write_shift(1,Ut,"sbcs");break;case"D":L[R][H]?(Et.write_shift(4,("0000"+L[R][H].getFullYear()).slice(-4),"sbcs"),Et.write_shift(2,("00"+(L[R][H].getMonth()+1)).slice(-2),"sbcs"),Et.write_shift(2,("00"+L[R][H].getDate()).slice(-2),"sbcs")):Et.write_shift(8,"00000000","sbcs");break;case"C":var jt=String(L[R][H]!=null?L[R][H]:"").slice(0,ye[H]);for(Et.write_shift(1,jt,"sbcs"),q=0;q<ye[H]-jt.length;++q)Et.write_shift(1,32);break}}return b.next(1).write_shift(1,26),b.end()}return{to_workbook:l,to_sheet:n,from_sheet:d}}(),hY=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+hh(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(M,L){var U=e[L];return typeof U=="number"?bM(U):U},n=function(M,L,U){var R=L.charCodeAt(0)-32<<4|U.charCodeAt(0)-48;return R==59?M:bM(R)};e["|"]=254;function l(M,L){switch(L.type){case"base64":return u(Am(M),L);case"binary":return u(M,L);case"buffer":return u(Jo&&Buffer.isBuffer(M)?M.toString("binary"):I1(M),L);case"array":return u(Ib(M),L)}throw new Error("Unrecognized type "+L.type)}function u(M,L){var U=M.split(/[\n\r]+/),R=-1,H=-1,q=0,te=0,J=[],se=[],ye=null,Se={},Be=[],De=[],we=[],nt=0,_e;for(+L.codepage>=0&&a1(+L.codepage);q!==U.length;++q){nt=0;var Ie=U[q].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Ze=Ie.replace(/;;/g,"\0").split(";").map(function(Re){return Re.replace(/\u0000/g,";")}),st=Ze[0],Et;if(Ie.length>0)switch(st){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ze[1].charAt(0)=="P"&&se.push(Ie.slice(3).replace(/;;/g,";"));break;case"C":var Ut=!1,jt=!1,bt=!1,Nt=!1,ar=-1,lt=-1;for(te=1;te<Ze.length;++te)switch(Ze[te].charAt(0)){case"A":break;case"X":H=parseInt(Ze[te].slice(1))-1,jt=!0;break;case"Y":for(R=parseInt(Ze[te].slice(1))-1,jt||(H=0),_e=J.length;_e<=R;++_e)J[_e]=[];break;case"K":Et=Ze[te].slice(1),Et.charAt(0)==='"'?Et=Et.slice(1,Et.length-1):Et==="TRUE"?Et=!0:Et==="FALSE"?Et=!1:isNaN(sm(Et))?isNaN(s1(Et).getDate())||(Et=cf(Et)):(Et=sm(Et),ye!==null&&Z6(ye)&&(Et=t8(Et))),Ut=!0;break;case"E":Nt=!0;var ie=cJ(Ze[te].slice(1),{r:R,c:H});J[R][H]=[J[R][H],ie];break;case"S":bt=!0,J[R][H]=[J[R][H],"S5S"];break;case"G":break;case"R":ar=parseInt(Ze[te].slice(1))-1;break;case"C":lt=parseInt(Ze[te].slice(1))-1;break;default:if(L&&L.WTF)throw new Error("SYLK bad record "+Ie)}if(Ut&&(J[R][H]&&J[R][H].length==2?J[R][H][0]=Et:J[R][H]=Et,ye=null),bt){if(Nt)throw new Error("SYLK shared formula cannot have own formula");var Le=ar>-1&&J[ar][lt];if(!Le||!Le[1])throw new Error("SYLK shared formula cannot find base");J[R][H][1]=uJ(Le[1],{r:R-ar,c:H-lt})}break;case"F":var Fe=0;for(te=1;te<Ze.length;++te)switch(Ze[te].charAt(0)){case"X":H=parseInt(Ze[te].slice(1))-1,++Fe;break;case"Y":for(R=parseInt(Ze[te].slice(1))-1,_e=J.length;_e<=R;++_e)J[_e]=[];break;case"M":nt=parseInt(Ze[te].slice(1))/20;break;case"F":break;case"G":break;case"P":ye=se[parseInt(Ze[te].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(we=Ze[te].slice(1).split(" "),_e=parseInt(we[0],10);_e<=parseInt(we[1],10);++_e)nt=parseInt(we[2],10),De[_e-1]=nt===0?{hidden:!0}:{wch:nt},vI(De[_e-1]);break;case"C":H=parseInt(Ze[te].slice(1))-1,De[H]||(De[H]={});break;case"R":R=parseInt(Ze[te].slice(1))-1,Be[R]||(Be[R]={}),nt>0?(Be[R].hpt=nt,Be[R].hpx=j8(nt)):nt===0&&(Be[R].hidden=!0);break;default:if(L&&L.WTF)throw new Error("SYLK bad record "+Ie)}Fe<1&&(ye=null);break;default:if(L&&L.WTF)throw new Error("SYLK bad record "+Ie)}}return Be.length>0&&(Se["!rows"]=Be),De.length>0&&(Se["!cols"]=De),L&&L.sheetRows&&(J=J.slice(0,L.sheetRows)),[J,Se]}function d(M,L){var U=l(M,L),R=U[0],H=U[1],q=mv(R,L);return hh(H).forEach(function(te){q[te]=H[te]}),q}function a(M,L){return O0(d(M,L),L)}function v(M,L,U,R){var H="C;Y"+(U+1)+";X"+(R+1)+";K";switch(M.t){case"n":H+=M.v||0,M.f&&!M.F&&(H+=";E"+xI(M.f,{r:U,c:R}));break;case"b":H+=M.v?"TRUE":"FALSE";break;case"e":H+=M.w||M.v;break;case"d":H+='"'+(M.w||M.v)+'"';break;case"s":H+='"'+M.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return H}function x(M,L){L.forEach(function(U,R){var H="F;W"+(R+1)+" "+(R+1)+" ";U.hidden?H+="0":(typeof U.width=="number"&&!U.wpx&&(U.wpx=y2(U.width)),typeof U.wpx=="number"&&!U.wch&&(U.wch=x2(U.wpx)),typeof U.wch=="number"&&(H+=Math.round(U.wch))),H.charAt(H.length-1)!=" "&&M.push(H)})}function b(M,L){L.forEach(function(U,R){var H="F;";U.hidden?H+="M0;":U.hpt?H+="M"+20*U.hpt+";":U.hpx&&(H+="M"+20*w2(U.hpx)+";"),H.length>2&&M.push(H+"R"+(R+1))})}function I(M,L){var U=["ID;PWXL;N;E"],R=[],H=ol(M["!ref"]),q,te=Array.isArray(M),J=`\r
`;U.push("P;PGeneral"),U.push("F;P0;DG0G8;M255"),M["!cols"]&&x(U,M["!cols"]),M["!rows"]&&b(U,M["!rows"]),U.push("B;Y"+(H.e.r-H.s.r+1)+";X"+(H.e.c-H.s.c+1)+";D"+[H.s.c,H.s.r,H.e.c,H.e.r].join(" "));for(var se=H.s.r;se<=H.e.r;++se)for(var ye=H.s.c;ye<=H.e.c;++ye){var Se=gs({r:se,c:ye});q=te?(M[se]||[])[ye]:M[Se],!(!q||q.v==null&&(!q.f||q.F))&&R.push(v(q,M,se,ye))}return U.join(J)+J+R.join(J)+J+"E"+J}return{to_workbook:a,to_sheet:d,from_sheet:I}}(),fY=function(){function e(u,d){switch(d.type){case"base64":return t(Am(u),d);case"binary":return t(u,d);case"buffer":return t(Jo&&Buffer.isBuffer(u)?u.toString("binary"):I1(u),d);case"array":return t(Ib(u),d)}throw new Error("Unrecognized type "+d.type)}function t(u,d){for(var a=u.split(`
`),v=-1,x=-1,b=0,I=[];b!==a.length;++b){if(a[b].trim()==="BOT"){I[++v]=[],x=0;continue}if(!(v<0)){var M=a[b].trim().split(","),L=M[0],U=M[1];++b;for(var R=a[b]||"";(R.match(/["]/g)||[]).length&1&&b<a.length-1;)R+=`
`+a[++b];switch(R=R.trim(),+L){case-1:if(R==="BOT"){I[++v]=[],x=0;continue}else if(R!=="EOD")throw new Error("Unrecognized DIF special command "+R);break;case 0:R==="TRUE"?I[v][x]=!0:R==="FALSE"?I[v][x]=!1:isNaN(sm(U))?isNaN(s1(U).getDate())?I[v][x]=U:I[v][x]=cf(U):I[v][x]=sm(U),++x;break;case 1:R=R.slice(1,R.length-1),R=R.replace(/""/g,'"'),R&&R.match(/^=".*"$/)&&(R=R.slice(2,-1)),I[v][x++]=R!==""?R:null;break}if(R==="EOD")break}}return d&&d.sheetRows&&(I=I.slice(0,d.sheetRows)),I}function r(u,d){return mv(e(u,d),d)}function n(u,d){return O0(r(u,d),d)}var l=function(){var u=function(v,x,b,I,M){v.push(x),v.push(b+","+I),v.push('"'+M.replace(/"/g,'""')+'"')},d=function(v,x,b,I){v.push(x+","+b),v.push(x==1?'"'+I.replace(/"/g,'""')+'"':I)};return function(v){var x=[],b=ol(v["!ref"]),I,M=Array.isArray(v);u(x,"TABLE",0,1,"sheetjs"),u(x,"VECTORS",0,b.e.r-b.s.r+1,""),u(x,"TUPLES",0,b.e.c-b.s.c+1,""),u(x,"DATA",0,0,"");for(var L=b.s.r;L<=b.e.r;++L){d(x,-1,0,"BOT");for(var U=b.s.c;U<=b.e.c;++U){var R=gs({r:L,c:U});if(I=M?(v[L]||[])[U]:v[R],!I){d(x,1,0,"");continue}switch(I.t){case"n":var H=I.w;!H&&I.v!=null&&(H=I.v),H==null?I.f&&!I.F?d(x,1,0,"="+I.f):d(x,1,0,""):d(x,0,H,"V");break;case"b":d(x,0,I.v?1:0,I.v?"TRUE":"FALSE");break;case"s":d(x,1,0,isNaN(I.v)?I.v:'="'+I.v+'"');break;case"d":I.w||(I.w=Bg(I.z||Jl[14],Mf(cf(I.v)))),d(x,0,I.w,"V");break;default:d(x,1,0,"")}}}d(x,-1,0,"EOD");var q=`\r
`,te=x.join(q);return te}}();return{to_workbook:n,to_sheet:r,from_sheet:l}}(),U8=function(){function e(I){return I.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(I){return I.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(I,M){for(var L=I.split(`
`),U=-1,R=-1,H=0,q=[];H!==L.length;++H){var te=L[H].trim().split(":");if(te[0]==="cell"){var J=zu(te[1]);if(q.length<=J.r)for(U=q.length;U<=J.r;++U)q[U]||(q[U]=[]);switch(U=J.r,R=J.c,te[2]){case"t":q[U][R]=e(te[3]);break;case"v":q[U][R]=+te[3];break;case"vtf":var se=te[te.length-1];case"vtc":switch(te[3]){case"nl":q[U][R]=!!+te[4];break;default:q[U][R]=+te[4];break}te[2]=="vtf"&&(q[U][R]=[q[U][R],se])}}}return M&&M.sheetRows&&(q=q.slice(0,M.sheetRows)),q}function n(I,M){return mv(r(I,M),M)}function l(I,M){return O0(n(I,M),M)}var u=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),d=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),v="--SocialCalcSpreadsheetControlSave--";function x(I){if(!I||!I["!ref"])return"";for(var M=[],L=[],U,R="",H=_A(I["!ref"]),q=Array.isArray(I),te=H.s.r;te<=H.e.r;++te)for(var J=H.s.c;J<=H.e.c;++J)if(R=gs({r:te,c:J}),U=q?(I[te]||[])[J]:I[R],!(!U||U.v==null||U.t==="z")){switch(L=["cell",R,"t"],U.t){case"s":case"str":L.push(t(U.v));break;case"n":U.f?(L[2]="vtf",L[3]="n",L[4]=U.v,L[5]=t(U.f)):(L[2]="v",L[3]=U.v);break;case"b":L[2]="vt"+(U.f?"f":"c"),L[3]="nl",L[4]=U.v?"1":"0",L[5]=t(U.f||(U.v?"TRUE":"FALSE"));break;case"d":var se=Mf(cf(U.v));L[2]="vtc",L[3]="nd",L[4]=""+se,L[5]=U.w||Bg(U.z||Jl[14],se);break;case"e":continue}M.push(L.join(":"))}return M.push("sheet:c:"+(H.e.c-H.s.c+1)+":r:"+(H.e.r-H.s.r+1)+":tvf:1"),M.push("valueformat:1:text-wiki"),M.join(`
`)}function b(I){return[u,d,a,d,x(I),v].join(`
`)}return{to_workbook:l,to_sheet:n,from_sheet:b}}(),AY=function(){function e(b,I,M,L,U){U.raw?I[M][L]=b:b===""||(b==="TRUE"?I[M][L]=!0:b==="FALSE"?I[M][L]=!1:isNaN(sm(b))?isNaN(s1(b).getDate())?I[M][L]=b:I[M][L]=cf(b):I[M][L]=sm(b))}function t(b,I){var M=I||{},L=[];if(!b||b.length===0)return L;for(var U=b.split(/[\r\n]/),R=U.length-1;R>=0&&U[R].length===0;)--R;for(var H=10,q=0,te=0;te<=R;++te)q=U[te].indexOf(" "),q==-1?q=U[te].length:q++,H=Math.max(H,q);for(te=0;te<=R;++te){L[te]=[];var J=0;for(e(U[te].slice(0,H).trim(),L,te,J,M),J=1;J<=(U[te].length-H)/10+1;++J)e(U[te].slice(H+(J-1)*10,H+J*10).trim(),L,te,J,M)}return M.sheetRows&&(L=L.slice(0,M.sheetRows)),L}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function l(b){for(var I={},M=!1,L=0,U=0;L<b.length;++L)(U=b.charCodeAt(L))==34?M=!M:!M&&U in r&&(I[U]=(I[U]||0)+1);U=[];for(L in I)Object.prototype.hasOwnProperty.call(I,L)&&U.push([I[L],L]);if(!U.length){I=n;for(L in I)Object.prototype.hasOwnProperty.call(I,L)&&U.push([I[L],L])}return U.sort(function(R,H){return R[0]-H[0]||n[R[1]]-n[H[1]]}),r[U.pop()[1]]||44}function u(b,I){var M=I||{},L="",U=M.dense?[]:{},R={s:{c:0,r:0},e:{c:0,r:0}};b.slice(0,4)=="sep="?b.charCodeAt(5)==13&&b.charCodeAt(6)==10?(L=b.charAt(4),b=b.slice(7)):b.charCodeAt(5)==13||b.charCodeAt(5)==10?(L=b.charAt(4),b=b.slice(6)):L=l(b.slice(0,1024)):M&&M.FS?L=M.FS:L=l(b.slice(0,1024));var H=0,q=0,te=0,J=0,se=0,ye=L.charCodeAt(0),Se=!1,Be=0,De=b.charCodeAt(0);b=b.replace(/\r\n/mg,`
`);var we=M.dateNF!=null?IX(M.dateNF):null;function nt(){var _e=b.slice(J,se),Ie={};if(_e.charAt(0)=='"'&&_e.charAt(_e.length-1)=='"'&&(_e=_e.slice(1,-1).replace(/""/g,'"')),_e.length===0)Ie.t="z";else if(M.raw)Ie.t="s",Ie.v=_e;else if(_e.trim().length===0)Ie.t="s",Ie.v=_e;else if(_e.charCodeAt(0)==61)_e.charCodeAt(1)==34&&_e.charCodeAt(_e.length-1)==34?(Ie.t="s",Ie.v=_e.slice(2,-1).replace(/""/g,'"')):hJ(_e)?(Ie.t="n",Ie.f=_e.slice(1)):(Ie.t="s",Ie.v=_e);else if(_e=="TRUE")Ie.t="b",Ie.v=!0;else if(_e=="FALSE")Ie.t="b",Ie.v=!1;else if(!isNaN(te=sm(_e)))Ie.t="n",M.cellText!==!1&&(Ie.w=_e),Ie.v=te;else if(!isNaN(s1(_e).getDate())||we&&_e.match(we)){Ie.z=M.dateNF||Jl[14];var Ze=0;we&&_e.match(we)&&(_e=FX(_e,M.dateNF,_e.match(we)||[]),Ze=1),M.cellDates?(Ie.t="d",Ie.v=cf(_e,Ze)):(Ie.t="n",Ie.v=Mf(cf(_e,Ze))),M.cellText!==!1&&(Ie.w=Bg(Ie.z,Ie.v instanceof Date?Mf(Ie.v):Ie.v)),M.cellNF||delete Ie.z}else Ie.t="s",Ie.v=_e;if(Ie.t=="z"||(M.dense?(U[H]||(U[H]=[]),U[H][q]=Ie):U[gs({c:q,r:H})]=Ie),J=se+1,De=b.charCodeAt(J),R.e.c<q&&(R.e.c=q),R.e.r<H&&(R.e.r=H),Be==ye)++q;else if(q=0,++H,M.sheetRows&&M.sheetRows<=H)return!0}e:for(;se<b.length;++se)switch(Be=b.charCodeAt(se)){case 34:De===34&&(Se=!Se);break;case ye:case 10:case 13:if(!Se&&nt())break e;break}return se-J>0&&nt(),U["!ref"]=Gc(R),U}function d(b,I){return!(I&&I.PRN)||I.FS||b.slice(0,4)=="sep="||b.indexOf("	")>=0||b.indexOf(",")>=0||b.indexOf(";")>=0?u(b,I):mv(t(b,I),I)}function a(b,I){var M="",L=I.type=="string"?[0,0,0,0]:Bne(b,I);switch(I.type){case"base64":M=Am(b);break;case"binary":M=b;break;case"buffer":I.codepage==65001?M=b.toString("utf8"):I.codepage&&typeof h2<"u"||(M=Jo&&Buffer.isBuffer(b)?b.toString("binary"):I1(b));break;case"array":M=Ib(b);break;case"string":M=b;break;default:throw new Error("Unrecognized type "+I.type)}return L[0]==239&&L[1]==187&&L[2]==191?M=Gy(M.slice(3)):I.type!="string"&&I.type!="buffer"&&I.codepage==65001?M=Gy(M):I.type=="binary"&&typeof h2<"u",M.slice(0,19)=="socialcalc:version:"?U8.to_sheet(I.type=="string"?M:Gy(M),I):d(M,I)}function v(b,I){return O0(a(b,I),I)}function x(b){for(var I=[],M=ol(b["!ref"]),L,U=Array.isArray(b),R=M.s.r;R<=M.e.r;++R){for(var H=[],q=M.s.c;q<=M.e.c;++q){var te=gs({r:R,c:q});if(L=U?(b[R]||[])[q]:b[te],!L||L.v==null){H.push("          ");continue}for(var J=(L.w||(dm(L),L.w)||"").slice(0,10);J.length<10;)J+=" ";H.push(J+(q===0?" ":""))}I.push(H.join(""))}return I.join(`
`)}return{to_workbook:v,to_sheet:a,from_sheet:x}}(),eO=function(){function e(ie,Le,Fe){if(ie){uA(ie,ie.l||0);for(var Re=Fe.Enum||ar;ie.l<ie.length;){var et=ie.read_shift(2),xt=Re[et]||Re[65535],Dt=ie.read_shift(2),pt=ie.l+Dt,Ct=xt.f&&xt.f(ie,Dt,Fe);if(ie.l=pt,Le(Ct,xt,et))return}}}function t(ie,Le){switch(Le.type){case"base64":return r(Md(Am(ie)),Le);case"binary":return r(Md(ie),Le);case"buffer":case"array":return r(ie,Le)}throw"Unsupported type "+Le.type}function r(ie,Le){if(!ie)return ie;var Fe=Le||{},Re=Fe.dense?[]:{},et="Sheet1",xt="",Dt=0,pt={},Ct=[],mr=[],Zt={s:{r:0,c:0},e:{r:0,c:0}},sn=Fe.sheetRows||0;if(ie[2]==0&&(ie[3]==8||ie[3]==9)&&ie.length>=16&&ie[14]==5&&ie[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(ie[2]==2)Fe.Enum=ar,e(ie,function($r,zn,an){switch(an){case 0:Fe.vers=$r,$r>=4096&&(Fe.qpro=!0);break;case 6:Zt=$r;break;case 204:$r&&(xt=$r);break;case 222:xt=$r;break;case 15:case 51:Fe.qpro||($r[1].v=$r[1].v.slice(1));case 13:case 14:case 16:an==14&&($r[2]&112)==112&&($r[2]&15)>1&&($r[2]&15)<15&&($r[1].z=Fe.dateNF||Jl[14],Fe.cellDates&&($r[1].t="d",$r[1].v=t8($r[1].v))),Fe.qpro&&$r[3]>Dt&&(Re["!ref"]=Gc(Zt),pt[et]=Re,Ct.push(et),Re=Fe.dense?[]:{},Zt={s:{r:0,c:0},e:{r:0,c:0}},Dt=$r[3],et=xt||"Sheet"+(Dt+1),xt="");var Pn=Fe.dense?(Re[$r[0].r]||[])[$r[0].c]:Re[gs($r[0])];if(Pn){Pn.t=$r[1].t,Pn.v=$r[1].v,$r[1].z!=null&&(Pn.z=$r[1].z),$r[1].f!=null&&(Pn.f=$r[1].f);break}Fe.dense?(Re[$r[0].r]||(Re[$r[0].r]=[]),Re[$r[0].r][$r[0].c]=$r[1]):Re[gs($r[0])]=$r[1];break}},Fe);else if(ie[2]==26||ie[2]==14)Fe.Enum=lt,ie[2]==14&&(Fe.qpro=!0,ie.l=0),e(ie,function($r,zn,an){switch(an){case 204:et=$r;break;case 22:$r[1].v=$r[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if($r[3]>Dt&&(Re["!ref"]=Gc(Zt),pt[et]=Re,Ct.push(et),Re=Fe.dense?[]:{},Zt={s:{r:0,c:0},e:{r:0,c:0}},Dt=$r[3],et="Sheet"+(Dt+1)),sn>0&&$r[0].r>=sn)break;Fe.dense?(Re[$r[0].r]||(Re[$r[0].r]=[]),Re[$r[0].r][$r[0].c]=$r[1]):Re[gs($r[0])]=$r[1],Zt.e.c<$r[0].c&&(Zt.e.c=$r[0].c),Zt.e.r<$r[0].r&&(Zt.e.r=$r[0].r);break;case 27:$r[14e3]&&(mr[$r[14e3][0]]=$r[14e3][1]);break;case 1537:mr[$r[0]]=$r[1],$r[0]==Dt&&(et=$r[1]);break}},Fe);else throw new Error("Unrecognized LOTUS BOF "+ie[2]);if(Re["!ref"]=Gc(Zt),pt[xt||et]=Re,Ct.push(xt||et),!mr.length)return{SheetNames:Ct,Sheets:pt};for(var er={},mt=[],En=0;En<mr.length;++En)pt[Ct[En]]?(mt.push(mr[En]||Ct[En]),er[mr[En]]=pt[mr[En]]||pt[Ct[En]]):(mt.push(mr[En]),er[mr[En]]={"!ref":"A1"});return{SheetNames:mt,Sheets:er}}function n(ie,Le){var Fe=Le||{};if(+Fe.codepage>=0&&a1(+Fe.codepage),Fe.type=="string")throw new Error("Cannot write WK1 to JS string");var Re=Lf(),et=ol(ie["!ref"]),xt=Array.isArray(ie),Dt=[];Rn(Re,0,u(1030)),Rn(Re,6,v(et));for(var pt=Math.min(et.e.r,8191),Ct=et.s.r;Ct<=pt;++Ct)for(var mr=uh(Ct),Zt=et.s.c;Zt<=et.e.c;++Zt){Ct===et.s.r&&(Dt[Zt]=kh(Zt));var sn=Dt[Zt]+mr,er=xt?(ie[Ct]||[])[Zt]:ie[sn];if(!(!er||er.t=="z"))if(er.t=="n")(er.v|0)==er.v&&er.v>=-32768&&er.v<=32767?Rn(Re,13,L(Ct,Zt,er.v)):Rn(Re,14,R(Ct,Zt,er.v));else{var mt=dm(er);Rn(Re,15,I(Ct,Zt,mt.slice(0,239)))}}return Rn(Re,1),Re.end()}function l(ie,Le){var Fe=Le||{};if(+Fe.codepage>=0&&a1(+Fe.codepage),Fe.type=="string")throw new Error("Cannot write WK3 to JS string");var Re=Lf();Rn(Re,0,d(ie));for(var et=0,xt=0;et<ie.SheetNames.length;++et)(ie.Sheets[ie.SheetNames[et]]||{})["!ref"]&&Rn(Re,27,Nt(ie.SheetNames[et],xt++));var Dt=0;for(et=0;et<ie.SheetNames.length;++et){var pt=ie.Sheets[ie.SheetNames[et]];if(!(!pt||!pt["!ref"])){for(var Ct=ol(pt["!ref"]),mr=Array.isArray(pt),Zt=[],sn=Math.min(Ct.e.r,8191),er=Ct.s.r;er<=sn;++er)for(var mt=uh(er),En=Ct.s.c;En<=Ct.e.c;++En){er===Ct.s.r&&(Zt[En]=kh(En));var $r=Zt[En]+mt,zn=mr?(pt[er]||[])[En]:pt[$r];if(!(!zn||zn.t=="z"))if(zn.t=="n")Rn(Re,23,nt(er,En,Dt,zn.v));else{var an=dm(zn);Rn(Re,22,Be(er,En,Dt,an.slice(0,239)))}}++Dt}}return Rn(Re,1),Re.end()}function u(ie){var Le=Zr(2);return Le.write_shift(2,ie),Le}function d(ie){var Le=Zr(26);Le.write_shift(2,4096),Le.write_shift(2,4),Le.write_shift(4,0);for(var Fe=0,Re=0,et=0,xt=0;xt<ie.SheetNames.length;++xt){var Dt=ie.SheetNames[xt],pt=ie.Sheets[Dt];if(!(!pt||!pt["!ref"])){++et;var Ct=_A(pt["!ref"]);Fe<Ct.e.r&&(Fe=Ct.e.r),Re<Ct.e.c&&(Re=Ct.e.c)}}return Fe>8191&&(Fe=8191),Le.write_shift(2,Fe),Le.write_shift(1,et),Le.write_shift(1,Re),Le.write_shift(2,0),Le.write_shift(2,0),Le.write_shift(1,1),Le.write_shift(1,2),Le.write_shift(4,0),Le.write_shift(4,0),Le}function a(ie,Le,Fe){var Re={s:{c:0,r:0},e:{c:0,r:0}};return Le==8&&Fe.qpro?(Re.s.c=ie.read_shift(1),ie.l++,Re.s.r=ie.read_shift(2),Re.e.c=ie.read_shift(1),ie.l++,Re.e.r=ie.read_shift(2),Re):(Re.s.c=ie.read_shift(2),Re.s.r=ie.read_shift(2),Le==12&&Fe.qpro&&(ie.l+=2),Re.e.c=ie.read_shift(2),Re.e.r=ie.read_shift(2),Le==12&&Fe.qpro&&(ie.l+=2),Re.s.c==65535&&(Re.s.c=Re.e.c=Re.s.r=Re.e.r=0),Re)}function v(ie){var Le=Zr(8);return Le.write_shift(2,ie.s.c),Le.write_shift(2,ie.s.r),Le.write_shift(2,ie.e.c),Le.write_shift(2,ie.e.r),Le}function x(ie,Le,Fe){var Re=[{c:0,r:0},{t:"n",v:0},0,0];return Fe.qpro&&Fe.vers!=20768?(Re[0].c=ie.read_shift(1),Re[3]=ie.read_shift(1),Re[0].r=ie.read_shift(2),ie.l+=2):(Re[2]=ie.read_shift(1),Re[0].c=ie.read_shift(2),Re[0].r=ie.read_shift(2)),Re}function b(ie,Le,Fe){var Re=ie.l+Le,et=x(ie,Le,Fe);if(et[1].t="s",Fe.vers==20768){ie.l++;var xt=ie.read_shift(1);return et[1].v=ie.read_shift(xt,"utf8"),et}return Fe.qpro&&ie.l++,et[1].v=ie.read_shift(Re-ie.l,"cstr"),et}function I(ie,Le,Fe){var Re=Zr(7+Fe.length);Re.write_shift(1,255),Re.write_shift(2,Le),Re.write_shift(2,ie),Re.write_shift(1,39);for(var et=0;et<Re.length;++et){var xt=Fe.charCodeAt(et);Re.write_shift(1,xt>=128?95:xt)}return Re.write_shift(1,0),Re}function M(ie,Le,Fe){var Re=x(ie,Le,Fe);return Re[1].v=ie.read_shift(2,"i"),Re}function L(ie,Le,Fe){var Re=Zr(7);return Re.write_shift(1,255),Re.write_shift(2,Le),Re.write_shift(2,ie),Re.write_shift(2,Fe,"i"),Re}function U(ie,Le,Fe){var Re=x(ie,Le,Fe);return Re[1].v=ie.read_shift(8,"f"),Re}function R(ie,Le,Fe){var Re=Zr(13);return Re.write_shift(1,255),Re.write_shift(2,Le),Re.write_shift(2,ie),Re.write_shift(8,Fe,"f"),Re}function H(ie,Le,Fe){var Re=ie.l+Le,et=x(ie,Le,Fe);if(et[1].v=ie.read_shift(8,"f"),Fe.qpro)ie.l=Re;else{var xt=ie.read_shift(2);se(ie.slice(ie.l,ie.l+xt),et),ie.l+=xt}return et}function q(ie,Le,Fe){var Re=Le&32768;return Le&=-32769,Le=(Re?ie:0)+(Le>=8192?Le-16384:Le),(Re?"":"$")+(Fe?kh(Le):uh(Le))}var te={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},J=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function se(ie,Le){uA(ie,0);for(var Fe=[],Re=0,et="",xt="",Dt="",pt="";ie.l<ie.length;){var Ct=ie[ie.l++];switch(Ct){case 0:Fe.push(ie.read_shift(8,"f"));break;case 1:xt=q(Le[0].c,ie.read_shift(2),!0),et=q(Le[0].r,ie.read_shift(2),!1),Fe.push(xt+et);break;case 2:{var mr=q(Le[0].c,ie.read_shift(2),!0),Zt=q(Le[0].r,ie.read_shift(2),!1);xt=q(Le[0].c,ie.read_shift(2),!0),et=q(Le[0].r,ie.read_shift(2),!1),Fe.push(mr+Zt+":"+xt+et)}break;case 3:if(ie.l<ie.length){console.error("WK1 premature formula end");return}break;case 4:Fe.push("("+Fe.pop()+")");break;case 5:Fe.push(ie.read_shift(2));break;case 6:{for(var sn="";Ct=ie[ie.l++];)sn+=String.fromCharCode(Ct);Fe.push('"'+sn.replace(/"/g,'""')+'"')}break;case 8:Fe.push("-"+Fe.pop());break;case 23:Fe.push("+"+Fe.pop());break;case 22:Fe.push("NOT("+Fe.pop()+")");break;case 20:case 21:pt=Fe.pop(),Dt=Fe.pop(),Fe.push(["AND","OR"][Ct-20]+"("+Dt+","+pt+")");break;default:if(Ct<32&&J[Ct])pt=Fe.pop(),Dt=Fe.pop(),Fe.push(Dt+J[Ct]+pt);else if(te[Ct]){if(Re=te[Ct][1],Re==69&&(Re=ie[ie.l++]),Re>Fe.length){console.error("WK1 bad formula parse 0x"+Ct.toString(16)+":|"+Fe.join("|")+"|");return}var er=Fe.slice(-Re);Fe.length-=Re,Fe.push(te[Ct][0]+"("+er.join(",")+")")}else return Ct<=7?console.error("WK1 invalid opcode "+Ct.toString(16)):Ct<=24?console.error("WK1 unsupported op "+Ct.toString(16)):Ct<=30?console.error("WK1 invalid opcode "+Ct.toString(16)):Ct<=115?console.error("WK1 unsupported function opcode "+Ct.toString(16)):console.error("WK1 unrecognized opcode "+Ct.toString(16))}}Fe.length==1?Le[1].f=""+Fe[0]:console.error("WK1 bad formula parse |"+Fe.join("|")+"|")}function ye(ie){var Le=[{c:0,r:0},{t:"n",v:0},0];return Le[0].r=ie.read_shift(2),Le[3]=ie[ie.l++],Le[0].c=ie[ie.l++],Le}function Se(ie,Le){var Fe=ye(ie);return Fe[1].t="s",Fe[1].v=ie.read_shift(Le-4,"cstr"),Fe}function Be(ie,Le,Fe,Re){var et=Zr(6+Re.length);et.write_shift(2,ie),et.write_shift(1,Fe),et.write_shift(1,Le),et.write_shift(1,39);for(var xt=0;xt<Re.length;++xt){var Dt=Re.charCodeAt(xt);et.write_shift(1,Dt>=128?95:Dt)}return et.write_shift(1,0),et}function De(ie,Le){var Fe=ye(ie);Fe[1].v=ie.read_shift(2);var Re=Fe[1].v>>1;if(Fe[1].v&1)switch(Re&7){case 0:Re=(Re>>3)*5e3;break;case 1:Re=(Re>>3)*500;break;case 2:Re=(Re>>3)/20;break;case 3:Re=(Re>>3)/200;break;case 4:Re=(Re>>3)/2e3;break;case 5:Re=(Re>>3)/2e4;break;case 6:Re=(Re>>3)/16;break;case 7:Re=(Re>>3)/64;break}return Fe[1].v=Re,Fe}function we(ie,Le){var Fe=ye(ie),Re=ie.read_shift(4),et=ie.read_shift(4),xt=ie.read_shift(2);if(xt==65535)return Re===0&&et===3221225472?(Fe[1].t="e",Fe[1].v=15):Re===0&&et===3489660928?(Fe[1].t="e",Fe[1].v=42):Fe[1].v=0,Fe;var Dt=xt&32768;return xt=(xt&32767)-16446,Fe[1].v=(1-Dt*2)*(et*Math.pow(2,xt+32)+Re*Math.pow(2,xt)),Fe}function nt(ie,Le,Fe,Re){var et=Zr(14);if(et.write_shift(2,ie),et.write_shift(1,Fe),et.write_shift(1,Le),Re==0)return et.write_shift(4,0),et.write_shift(4,0),et.write_shift(2,65535),et;var xt=0,Dt=0,pt=0,Ct=0;return Re<0&&(xt=1,Re=-Re),Dt=Math.log2(Re)|0,Re/=Math.pow(2,Dt-31),Ct=Re>>>0,(Ct&2147483648)==0&&(Re/=2,++Dt,Ct=Re>>>0),Re-=Ct,Ct|=2147483648,Ct>>>=0,Re*=Math.pow(2,32),pt=Re>>>0,et.write_shift(4,pt),et.write_shift(4,Ct),Dt+=16383+(xt?32768:0),et.write_shift(2,Dt),et}function _e(ie,Le){var Fe=we(ie);return ie.l+=Le-14,Fe}function Ie(ie,Le){var Fe=ye(ie),Re=ie.read_shift(4);return Fe[1].v=Re>>6,Fe}function Ze(ie,Le){var Fe=ye(ie),Re=ie.read_shift(8,"f");return Fe[1].v=Re,Fe}function st(ie,Le){var Fe=Ze(ie);return ie.l+=Le-10,Fe}function Et(ie,Le){return ie[ie.l+Le-1]==0?ie.read_shift(Le,"cstr"):""}function Ut(ie,Le){var Fe=ie[ie.l++];Fe>Le-1&&(Fe=Le-1);for(var Re="";Re.length<Fe;)Re+=String.fromCharCode(ie[ie.l++]);return Re}function jt(ie,Le,Fe){if(!(!Fe.qpro||Le<21)){var Re=ie.read_shift(1);ie.l+=17,ie.l+=1,ie.l+=2;var et=ie.read_shift(Le-21,"cstr");return[Re,et]}}function bt(ie,Le){for(var Fe={},Re=ie.l+Le;ie.l<Re;){var et=ie.read_shift(2);if(et==14e3){for(Fe[et]=[0,""],Fe[et][0]=ie.read_shift(2);ie[ie.l];)Fe[et][1]+=String.fromCharCode(ie[ie.l]),ie.l++;ie.l++}}return Fe}function Nt(ie,Le){var Fe=Zr(5+ie.length);Fe.write_shift(2,14e3),Fe.write_shift(2,Le);for(var Re=0;Re<ie.length;++Re){var et=ie.charCodeAt(Re);Fe[Fe.l++]=et>127?95:et}return Fe[Fe.l++]=0,Fe}var ar={0:{n:"BOF",f:M8},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:M},14:{n:"NUMBER",f:U},15:{n:"LABEL",f:b},16:{n:"FORMULA",f:H},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:b},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Et},222:{n:"SHEETNAMELP",f:Ut},65535:{n:""}},lt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Se},23:{n:"NUMBER17",f:we},24:{n:"NUMBER18",f:De},25:{n:"FORMULA19",f:_e},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:bt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Ie},38:{n:"??"},39:{n:"NUMBER27",f:Ze},40:{n:"FORMULA28",f:st},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Et},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:jt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:l,to_workbook:t}}(),dY=/^\s|\s$|[\t\n\r]/;function N8(e,t){if(!t.bookSST)return"";var r=[Wc];r[r.length]=On("sst",null,{xmlns:pv[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var l=e[n],u="<si>";l.r?u+=l.r:(u+="<t",l.t||(l.t=""),l.t.match(dY)&&(u+=' xml:space="preserve"'),u+=">"+ms(l.t)+"</t>"),u+="</si>",r[r.length]=u}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function pY(e){return[e.read_shift(4),e.read_shift(4)]}function mY(e,t){return t||(t=Zr(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var gY=sZ;function _Y(e){var t=Lf();gn(t,159,mY(e));for(var r=0;r<e.length;++r)gn(t,19,gY(e[r]));return gn(t,160),t.end()}function vY(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function z8(e){var t=0,r,n=vY(e),l=n.length+1,u,d,a,v,x;for(r=E0(l),r[0]=n.length,u=1;u!=l;++u)r[u]=n[u-1];for(u=l-1;u>=0;--u)d=r[u],a=(t&16384)===0?0:1,v=t<<1&32767,x=a|v,t=x^d;return t^52811}var yY=function(){function e(l,u){switch(u.type){case"base64":return t(Am(l),u);case"binary":return t(l,u);case"buffer":return t(Jo&&Buffer.isBuffer(l)?l.toString("binary"):I1(l),u);case"array":return t(Ib(l),u)}throw new Error("Unrecognized type "+u.type)}function t(l,u){var d=u||{},a=d.dense?[]:{},v=l.match(/\\trowd.*?\\row\b/g);if(!v.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:v.length-1}};return v.forEach(function(b,I){Array.isArray(a)&&(a[I]=[]);for(var M=/\\\w+\b/g,L=0,U,R=-1;U=M.exec(b);){switch(U[0]){case"\\cell":var H=b.slice(L,M.lastIndex-U[0].length);if(H[0]==" "&&(H=H.slice(1)),++R,H.length){var q={v:H,t:"s"};Array.isArray(a)?a[I][R]=q:a[gs({r:I,c:R})]=q}break}L=M.lastIndex}R>x.e.c&&(x.e.c=R)}),a["!ref"]=Gc(x),a}function r(l,u){return O0(e(l,u),u)}function n(l){for(var u=["{\\rtf1\\ansi"],d=ol(l["!ref"]),a,v=Array.isArray(l),x=d.s.r;x<=d.e.r;++x){u.push("\\trowd\\trautofit1");for(var b=d.s.c;b<=d.e.c;++b)u.push("\\cellx"+(b+1));for(u.push("\\pard\\intbl"),b=d.s.c;b<=d.e.c;++b){var I=gs({r:x,c:b});a=v?(l[x]||[])[b]:l[I],!(!a||a.v==null&&(!a.f||a.F))&&(u.push(" "+(a.w||(dm(a),a.w))),u.push("\\cell"))}u.push("\\pard\\intbl\\row")}return u.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function tO(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var xY=6,lm=xY;function y2(e){return Math.floor((e+Math.round(128/lm)/256)*lm)}function x2(e){return Math.floor((e-5)/lm*100+.5)/100}function BT(e){return Math.round((e*lm+5)/lm*256)/256}function vI(e){e.width?(e.wpx=y2(e.width),e.wch=x2(e.wpx),e.MDW=lm):e.wpx?(e.wch=x2(e.wpx),e.width=BT(e.wch),e.MDW=lm):typeof e.wch=="number"&&(e.width=BT(e.wch),e.wpx=y2(e.width),e.MDW=lm),e.customWidth&&delete e.customWidth}var wY=96,Q8=wY;function w2(e){return e*96/Q8}function j8(e){return e*Q8/96}function bY(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=On("numFmt",null,{numFmtId:n,formatCode:ms(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=On("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function EY(e){var t=[];return t[t.length]=On("cellXfs",null),e.forEach(function(r){t[t.length]=On("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=On("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function H8(e,t){var r=[Wc,On("styleSheet",null,{xmlns:pv[0],"xmlns:vt":Nu.vt})],n;return e.SSF&&(n=bY(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=EY(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function BY(e,t){var r=e.read_shift(2),n=Uh(e);return[r,n]}function CY(e,t,r){r||(r=Zr(6+4*t.length)),r.write_shift(2,e),Qu(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function SY(e,t,r){var n={};n.sz=e.read_shift(2)/20;var l=dZ(e);l.fItalic&&(n.italic=1),l.fCondense&&(n.condense=1),l.fExtend&&(n.extend=1),l.fShadow&&(n.shadow=1),l.fOutline&&(n.outline=1),l.fStrikeout&&(n.strike=1);var u=e.read_shift(2);switch(u===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var d=e.read_shift(1);d!=0&&(n.underline=d);var a=e.read_shift(1);a>0&&(n.family=a);var v=e.read_shift(1);switch(v>0&&(n.charset=v),e.l++,n.color=AZ(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Uh(e),n}function TY(e,t){t||(t=Zr(153)),t.write_shift(2,e.sz*20),pZ(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_2(e.color,t);var n=0;return n=2,t.write_shift(1,n),Qu(e.name,t),t.length>t.l?t.slice(0,t.l):t}var IY=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],HB,FY=Tp;function rO(e,t){t||(t=Zr(84)),HB||(HB=sI(IY));var r=HB[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(_2({auto:1},t),_2({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function PY(e,t){var r=e.l+t,n=e.read_shift(2),l=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:l}}function V8(e,t,r){r||(r=Zr(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function _y(e,t){return t||(t=Zr(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var LY=Tp;function MY(e,t){return t||(t=Zr(51)),t.write_shift(1,0),_y(null,t),_y(null,t),_y(null,t),_y(null,t),_y(null,t),t.length>t.l?t.slice(0,t.l):t}function OY(e,t){return t||(t=Zr(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),g2(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function DY(e,t,r){var n=Zr(2052);return n.write_shift(4,e),g2(t,n),g2(r,n),n.length>n.l?n.slice(0,n.l):n}function RY(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var l=n[0];l<=n[1];++l)t[l]!=null&&++r}),r!=0&&(gn(e,615,kd(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var l=n[0];l<=n[1];++l)t[l]!=null&&gn(e,44,CY(l,t[l]))}),gn(e,616))}}function kY(e){var t=1;gn(e,611,kd(t)),gn(e,43,TY({sz:12,color:{theme:1},name:"Calibri",family:2})),gn(e,612)}function UY(e){var t=2;gn(e,603,kd(t)),gn(e,45,rO({patternType:"none"})),gn(e,45,rO({patternType:"gray125"})),gn(e,604)}function NY(e){var t=1;gn(e,613,kd(t)),gn(e,46,MY()),gn(e,614)}function zY(e){var t=1;gn(e,626,kd(t)),gn(e,47,V8({numFmtId:0},65535)),gn(e,627)}function QY(e,t){gn(e,617,kd(t.length)),t.forEach(function(r){gn(e,47,V8(r,0))}),gn(e,618)}function jY(e){var t=1;gn(e,619,kd(t)),gn(e,48,OY({xfId:0,name:"Normal"})),gn(e,620)}function HY(e){var t=0;gn(e,505,kd(t)),gn(e,506)}function VY(e){var t=0;gn(e,508,DY(t,"TableStyleMedium9","PivotStyleMedium4")),gn(e,509)}function GY(e,t){var r=Lf();return gn(r,278),RY(r,e.SSF),kY(r),UY(r),NY(r),zY(r),QY(r,t.cellXfs),jY(r),HY(r),VY(r),gn(r,279),r.end()}function G8(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Wc];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function KY(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Uh(e)}}function WY(e){var t=Zr(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Qu(e.name,t),t.slice(0,t.l)}function qY(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function $Y(e){var t=Zr(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function XY(e,t){var r=Zr(8+2*t.length);return r.write_shift(4,e),Qu(t,r),r.slice(0,r.l)}function ZY(e){return e.l+=4,e.read_shift(4)!=0}function YY(e,t){var r=Zr(8);return r.write_shift(4,e),r.write_shift(4,1),r}function JY(){var e=Lf();return gn(e,332),gn(e,334,kd(1)),gn(e,335,WY({name:"XLDAPR",version:12e4,flags:3496657072})),gn(e,336),gn(e,339,XY(1,"XLDAPR")),gn(e,52),gn(e,35,kd(514)),gn(e,4096,kd(0)),gn(e,4097,XA(1)),gn(e,36),gn(e,53),gn(e,340),gn(e,337,YY(1)),gn(e,51,$Y([[1,0]])),gn(e,338),gn(e,333),e.end()}function K8(){var e=[Wc];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function eJ(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=gs(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var D_=1024;function W8(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),l=[On("xml",null,{"xmlns:v":fA.v,"xmlns:o":fA.o,"xmlns:x":fA.x,"xmlns:mv":fA.mv}).replace(/\/>/,">"),On("o:shapelayout",On("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),On("v:shapetype",[On("v:stroke",null,{joinstyle:"miter"}),On("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];D_<e*1e3;)D_+=1e3;return t.forEach(function(u){var d=zu(u[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var v=a.type=="gradient"?On("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,x=On("v:fill",v,a),b={on:"t",obscured:"t"};++D_,l=l.concat(["<v:shape"+c1({id:"_x0000_s"+D_,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(u[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",x,On("v:shadow",null,b),On("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",sh("x:Anchor",[d.c+1,0,d.r+1,0,d.c+3,20,d.r+5,20].join(",")),sh("x:AutoFill","False"),sh("x:Row",String(d.r)),sh("x:Column",String(d.c)),u[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),l.push("</xml>"),l.join("")}function q8(e){var t=[Wc,On("comments",null,{xmlns:pv[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(l){var u=ms(l.a);r.indexOf(u)==-1&&(r.push(u),t.push("<author>"+u+"</author>")),l.T&&l.ID&&r.indexOf("tc="+l.ID)==-1&&(r.push("tc="+l.ID),t.push("<author>tc="+l.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var l=0,u=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?l=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(v){v.a&&(l=r.indexOf(ms(v.a))),u.push(v.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+l+'"><text>'),u.length<=1)t.push(sh("t",ms(u[0]||"")));else{for(var d=`Comment:
    `+u[0]+`
`,a=1;a<u.length;++a)d+=`Reply:
    `+u[a]+`
`;t.push(sh("t",ms(d)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function tJ(e,t,r){var n=[Wc,On("ThreadedComments",null,{xmlns:Nu.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(l){var u="";(l[1]||[]).forEach(function(d,a){if(!d.T){delete d.ID;return}d.a&&t.indexOf(d.a)==-1&&t.push(d.a);var v={ref:l[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?u=v.id:v.parentId=u,d.ID=v.id,d.a&&(v.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(d.a)).slice(-12)+"}"),n.push(On("threadedComment",sh("text",d.t||""),v))})}),n.push("</ThreadedComments>"),n.join("")}function rJ(e){var t=[Wc,On("personList",null,{xmlns:Nu.TCMNT,"xmlns:x":pv[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(On("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function nJ(e){var t={};t.iauthor=e.read_shift(4);var r=U0(e);return t.rfx=r.s,t.ref=gs(r.s),e.l+=16,t}function iJ(e,t){return t==null&&(t=Zr(36)),t.write_shift(4,e[1].iauthor),gv(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var aJ=Uh;function oJ(e){return Qu(e.slice(0,54))}function sJ(e){var t=Lf(),r=[];return gn(t,628),gn(t,630),e.forEach(function(n){n[1].forEach(function(l){r.indexOf(l.a)>-1||(r.push(l.a.slice(0,54)),gn(t,632,oJ(l.a)))})}),gn(t,631),gn(t,633),e.forEach(function(n){n[1].forEach(function(l){l.iauthor=r.indexOf(l.a);var u={s:zu(n[0]),e:zu(n[0])};gn(t,635,iJ([u,l])),l.t&&l.t.length>0&&gn(t,637,cZ(l)),gn(t,636),delete l.iauthor})}),gn(t,634),gn(t,629),t.end()}function lJ(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var l=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");l.slice(-1)!=="/"&&Es.utils.cfb_add(e,l,t.FileIndex[n].content)}})}var $8=["xlsb","xlsm","xlam","biff8","xla"],cJ=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,l,u,d){var a=!1,v=!1;u.length==0?v=!0:u.charAt(0)=="["&&(v=!0,u=u.slice(1,-1)),d.length==0?a=!0:d.charAt(0)=="["&&(a=!0,d=d.slice(1,-1));var x=u.length>0?parseInt(u,10)|0:0,b=d.length>0?parseInt(d,10)|0:0;return a?b+=t.c:--b,v?x+=t.r:--x,l+(a?"":"$")+kh(b)+(v?"":"$")+uh(x)}return function(l,u){return t=u,l.replace(e,r)}}(),yI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,xI=function(){return function(t,r){return t.replace(yI,function(n,l,u,d,a,v){var x=dI(d)-(u?0:r.c),b=AI(v)-(a?0:r.r),I=b==0?"":a?b+1:"["+b+"]",M=x==0?"":u?x+1:"["+x+"]";return l+"R"+I+"C"+M})}}();function uJ(e,t){return e.replace(yI,function(r,n,l,u,d,a){return n+(l=="$"?l+u:kh(dI(u)+t.c))+(d=="$"?d+a:uh(AI(a)+t.r))})}function hJ(e){return e.length!=1}function Qc(e){e.l+=1}function Cg(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function X8(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Z8(e);r.biff==12&&(n=4)}var l=e.read_shift(n),u=e.read_shift(n),d=Cg(e),a=Cg(e);return{s:{r:l,c:d[0],cRel:d[1],rRel:d[2]},e:{r:u,c:a[0],cRel:a[1],rRel:a[2]}}}function Z8(e){var t=Cg(e),r=Cg(e),n=e.read_shift(1),l=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:l,cRel:r[1],rRel:r[2]}}}function fJ(e,t,r){if(r.biff<8)return Z8(e);var n=e.read_shift(r.biff==12?4:2),l=e.read_shift(r.biff==12?4:2),u=Cg(e),d=Cg(e);return{s:{r:n,c:u[0],cRel:u[1],rRel:u[2]},e:{r:l,c:d[0],cRel:d[1],rRel:d[2]}}}function Y8(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return AJ(e);var n=e.read_shift(r&&r.biff==12?4:2),l=Cg(e);return{r:n,c:l[0],cRel:l[1],rRel:l[2]}}function AJ(e){var t=Cg(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function dJ(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function pJ(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return mJ(e);var l=e.read_shift(n>=12?4:2),u=e.read_shift(2),d=(u&16384)>>14,a=(u&32768)>>15;if(u&=16383,a==1)for(;l>524287;)l-=1048576;if(d==1)for(;u>8191;)u=u-16384;return{r:l,c:u,cRel:d,rRel:a}}function mJ(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,l=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),l==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:l,rRel:n}}function gJ(e,t,r){var n=(e[e.l++]&96)>>5,l=X8(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,l]}function _J(e,t,r){var n=(e[e.l++]&96)>>5,l=e.read_shift(2,"i"),u=8;if(r)switch(r.biff){case 5:e.l+=12,u=6;break;case 12:u=12;break}var d=X8(e,u,r);return[n,l,d]}function vJ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function yJ(e,t,r){var n=(e[e.l++]&96)>>5,l=e.read_shift(2),u=8;if(r)switch(r.biff){case 5:e.l+=12,u=6;break;case 12:u=12;break}return e.l+=u,[n,l]}function xJ(e,t,r){var n=(e[e.l++]&96)>>5,l=fJ(e,t-1,r);return[n,l]}function wJ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function nO(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function bJ(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),l=[],u=0;u<=n;++u)l.push(e.read_shift(r&&r.biff==2?1:2));return l}function EJ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function BJ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function CJ(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function SJ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function J8(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function TJ(e){return e.read_shift(2),J8(e)}function IJ(e){return e.read_shift(2),J8(e)}function FJ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var l=Y8(e,0,r);return[n,l]}function PJ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var l=pJ(e,0,r);return[n,l]}function LJ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var l=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var u=Y8(e,0,r);return[n,l,u]}function MJ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var l=e.read_shift(r&&r.biff<=3?1:2);return[Mee[l],rz[l],n]}function OJ(e,t,r){var n=e[e.l++],l=e.read_shift(1),u=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:DJ(e);return[l,(u[0]===0?rz:Lee)[u[1]]]}function DJ(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function RJ(e,t,r){e.l+=r&&r.biff==2?3:4}function kJ(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),l=e.read_shift(r&&r.biff==2?1:2);return[n,l]}function UJ(e){return e.l++,L1[e.read_shift(1)]}function NJ(e){return e.l++,e.read_shift(2)}function zJ(e){return e.l++,e.read_shift(1)!==0}function QJ(e){return e.l++,_v(e)}function jJ(e,t,r){return e.l++,D8(e,t-1,r)}function HJ(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=LZ(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=L1[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=_v(e);break;case 2:r[1]=RZ(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function VJ(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),l=[],u=0;u!=n;++u)l.push((r.biff==12?U0:NZ)(e));return l}function GJ(e,t,r){var n=0,l=0;r.biff==12?(n=e.read_shift(4),l=e.read_shift(4)):(l=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--l==0&&(l=256));for(var u=0,d=[];u!=n&&(d[u]=[]);++u)for(var a=0;a!=l;++a)d[u][a]=HJ(e,r.biff);return d}function KJ(e,t,r){var n=e.read_shift(1)>>>5&3,l=!r||r.biff>=8?4:2,u=e.read_shift(l);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,u]}function WJ(e,t,r){if(r.biff==5)return qJ(e);var n=e.read_shift(1)>>>5&3,l=e.read_shift(2),u=e.read_shift(4);return[n,l,u]}function qJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function $J(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var l=e.read_shift(r&&r.biff==2?1:2);return[n,l]}function XJ(e,t,r){var n=e.read_shift(1)>>>5&3,l=e.read_shift(r&&r.biff==2?1:2);return[n,l]}function ZJ(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function YJ(e,t,r){var n=(e[e.l++]&96)>>5,l=e.read_shift(2),u=4;if(r)switch(r.biff){case 5:u=15;break;case 12:u=6;break}return e.l+=u,[n,l]}var JJ=Tp,eee=Tp,tee=Tp;function M1(e,t,r){return e.l+=2,[dJ(e)]}function wI(e){return e.l+=6,[]}var ree=M1,nee=wI,iee=wI,aee=M1;function ez(e){return e.l+=2,[M8(e),e.read_shift(2)&1]}var oee=M1,see=ez,lee=wI,cee=M1,uee=M1,hee=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fee(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),l=e.read_shift(2),u=e.read_shift(2),d=hee[r>>2&31];return{ixti:t,coltype:r&3,rt:d,idx:n,c:l,C:u}}function Aee(e){return e.l+=2,[e.read_shift(4)]}function dee(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function pee(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function mee(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gee(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function _ee(e){return e.l+=4,[0,0]}var iO={1:{n:"PtgExp",f:kJ},2:{n:"PtgTbl",f:tee},3:{n:"PtgAdd",f:Qc},4:{n:"PtgSub",f:Qc},5:{n:"PtgMul",f:Qc},6:{n:"PtgDiv",f:Qc},7:{n:"PtgPower",f:Qc},8:{n:"PtgConcat",f:Qc},9:{n:"PtgLt",f:Qc},10:{n:"PtgLe",f:Qc},11:{n:"PtgEq",f:Qc},12:{n:"PtgGe",f:Qc},13:{n:"PtgGt",f:Qc},14:{n:"PtgNe",f:Qc},15:{n:"PtgIsect",f:Qc},16:{n:"PtgUnion",f:Qc},17:{n:"PtgRange",f:Qc},18:{n:"PtgUplus",f:Qc},19:{n:"PtgUminus",f:Qc},20:{n:"PtgPercent",f:Qc},21:{n:"PtgParen",f:Qc},22:{n:"PtgMissArg",f:Qc},23:{n:"PtgStr",f:jJ},26:{n:"PtgSheet",f:dee},27:{n:"PtgEndSheet",f:pee},28:{n:"PtgErr",f:UJ},29:{n:"PtgBool",f:zJ},30:{n:"PtgInt",f:NJ},31:{n:"PtgNum",f:QJ},32:{n:"PtgArray",f:wJ},33:{n:"PtgFunc",f:MJ},34:{n:"PtgFuncVar",f:OJ},35:{n:"PtgName",f:KJ},36:{n:"PtgRef",f:FJ},37:{n:"PtgArea",f:gJ},38:{n:"PtgMemArea",f:$J},39:{n:"PtgMemErr",f:JJ},40:{n:"PtgMemNoMem",f:eee},41:{n:"PtgMemFunc",f:XJ},42:{n:"PtgRefErr",f:ZJ},43:{n:"PtgAreaErr",f:vJ},44:{n:"PtgRefN",f:PJ},45:{n:"PtgAreaN",f:xJ},46:{n:"PtgMemAreaN",f:mee},47:{n:"PtgMemNoMemN",f:gee},57:{n:"PtgNameX",f:WJ},58:{n:"PtgRef3d",f:LJ},59:{n:"PtgArea3d",f:_J},60:{n:"PtgRefErr3d",f:YJ},61:{n:"PtgAreaErr3d",f:yJ},255:{}},vee={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yee={1:{n:"PtgElfLel",f:ez},2:{n:"PtgElfRw",f:cee},3:{n:"PtgElfCol",f:ree},6:{n:"PtgElfRwV",f:uee},7:{n:"PtgElfColV",f:aee},10:{n:"PtgElfRadical",f:oee},11:{n:"PtgElfRadicalS",f:lee},13:{n:"PtgElfColS",f:nee},15:{n:"PtgElfColSV",f:iee},16:{n:"PtgElfRadicalLel",f:see},25:{n:"PtgList",f:fee},29:{n:"PtgSxName",f:Aee},255:{}},xee={0:{n:"PtgAttrNoop",f:_ee},1:{n:"PtgAttrSemi",f:SJ},2:{n:"PtgAttrIf",f:BJ},4:{n:"PtgAttrChoose",f:bJ},8:{n:"PtgAttrGoto",f:EJ},16:{n:"PtgAttrSum",f:RJ},32:{n:"PtgAttrBaxcel",f:nO},33:{n:"PtgAttrBaxcel",f:nO},64:{n:"PtgAttrSpace",f:TJ},65:{n:"PtgAttrSpaceSemi",f:IJ},128:{n:"PtgAttrIfError",f:CJ},255:{}};function wee(e,t,r,n){if(n.biff<8)return Tp(e,t);for(var l=e.l+t,u=[],d=0;d!==r.length;++d)switch(r[d][0]){case"PtgArray":r[d][1]=GJ(e,0,n),u.push(r[d][1]);break;case"PtgMemArea":r[d][2]=VJ(e,r[d][1],n),u.push(r[d][2]);break;case"PtgExp":n&&n.biff==12&&(r[d][1][1]=e.read_shift(4),u.push(r[d][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[d][0]}return t=l-e.l,t!==0&&u.push(Tp(e,t)),u}function bee(e,t,r){for(var n=e.l+t,l,u,d=[];n!=e.l;)t=n-e.l,u=e[e.l],l=iO[u]||iO[vee[u]],(u===24||u===25)&&(l=(u===24?yee:xee)[e[e.l+1]]),!l||!l.f?Tp(e,t):d.push([l.n,l.f(e,t,r)]);return d}function Eee(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],l=[],u=0;u<n.length;++u){var d=n[u];if(d)switch(d[0]){case 2:l.push('"'+d[1].replace(/"/g,'""')+'"');break;default:l.push(d[1])}else l.push("")}t.push(l.join(","))}return t.join(";")}var Bee={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Cee(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function tz(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var l="";if(r.biff>8)switch(e[n[0]][0]){case 357:return l=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?l:l+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return l=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?l:l+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(u){return u.Name}).join(";;");default:return e[n[0]][0][3]?(l=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?l:l+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function aO(e,t,r){var n=tz(e,t,r);return n=="#REF"?n:Cee(n,r)}function Y_(e,t,r,n,l){var u=l&&l.biff||8,d={s:{c:0,r:0}},a=[],v,x,b,I=0,M=0,L,U="";if(!e[0]||!e[0][0])return"";for(var R=-1,H="",q=0,te=e[0].length;q<te;++q){var J=e[0][q];switch(J[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(v=a.pop(),x=a.pop(),R>=0){switch(e[0][R][1][0]){case 0:H=Zl(" ",e[0][R][1][1]);break;case 1:H=Zl("\r",e[0][R][1][1]);break;default:if(H="",l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][R][1][0])}x=x+H,R=-1}a.push(x+Bee[J[0]]+v);break;case"PtgIsect":v=a.pop(),x=a.pop(),a.push(x+" "+v);break;case"PtgUnion":v=a.pop(),x=a.pop(),a.push(x+","+v);break;case"PtgRange":v=a.pop(),x=a.pop(),a.push(x+":"+v);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":b=Wy(J[1][1],d,l),a.push(qy(b,u));break;case"PtgRefN":b=r?Wy(J[1][1],r,l):J[1][1],a.push(qy(b,u));break;case"PtgRef3d":I=J[1][1],b=Wy(J[1][2],d,l),U=aO(n,I,l),a.push(U+"!"+qy(b,u));break;case"PtgFunc":case"PtgFuncVar":var se=J[1][0],ye=J[1][1];se||(se=0),se&=127;var Se=se==0?[]:a.slice(-se);a.length-=se,ye==="User"&&(ye=Se.shift()),a.push(ye+"("+Se.join(",")+")");break;case"PtgBool":a.push(J[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(J[1]);break;case"PtgNum":a.push(String(J[1]));break;case"PtgStr":a.push('"'+J[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(J[1]);break;case"PtgAreaN":L=HM(J[1][1],r?{s:r}:d,l),a.push(QB(L,l));break;case"PtgArea":L=HM(J[1][1],d,l),a.push(QB(L,l));break;case"PtgArea3d":I=J[1][1],L=J[1][2],U=aO(n,I,l),a.push(U+"!"+QB(L,l));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":M=J[1][2];var Be=(n.names||[])[M-1]||(n[0]||[])[M],De=Be?Be.Name:"SH33TJSNAME"+String(M);De&&De.slice(0,6)=="_xlfn."&&!l.xlfn&&(De=De.slice(6)),a.push(De);break;case"PtgNameX":var we=J[1][1];M=J[1][2];var nt;if(l.biff<=5)we<0&&(we=-we),n[we]&&(nt=n[we][M]);else{var _e="";if(((n[we]||[])[0]||[])[0]==14849||(((n[we]||[])[0]||[])[0]==1025?n[we][M]&&n[we][M].itab>0&&(_e=n.SheetNames[n[we][M].itab-1]+"!"):_e=n.SheetNames[M-1]+"!"),n[we]&&n[we][M])_e+=n[we][M].Name;else if(n[0]&&n[0][M])_e+=n[0][M].Name;else{var Ie=(tz(n,we,l)||"").split(";;");Ie[M-1]?_e=Ie[M-1]:_e+="SH33TJSERRX"}a.push(_e);break}nt||(nt={Name:"SH33TJSERRY"}),a.push(nt.Name);break;case"PtgParen":var Ze="(",st=")";if(R>=0){switch(H="",e[0][R][1][0]){case 2:Ze=Zl(" ",e[0][R][1][1])+Ze;break;case 3:Ze=Zl("\r",e[0][R][1][1])+Ze;break;case 4:st=Zl(" ",e[0][R][1][1])+st;break;case 5:st=Zl("\r",e[0][R][1][1])+st;break;default:if(l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][R][1][0])}R=-1}a.push(Ze+a.pop()+st);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":b={c:J[1][1],r:J[1][0]};var Et={c:r.c,r:r.r};if(n.sharedf[gs(b)]){var Ut=n.sharedf[gs(b)];a.push(Y_(Ut,d,Et,n,l))}else{var jt=!1;for(v=0;v!=n.arrayf.length;++v)if(x=n.arrayf[v],!(b.c<x[0].s.c||b.c>x[0].e.c)&&!(b.r<x[0].s.r||b.r>x[0].e.r)){a.push(Y_(x[1],d,Et,n,l)),jt=!0;break}jt||a.push(J[1])}break;case"PtgArray":a.push("{"+Eee(J[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":R=q;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+J[1].idx+"[#"+J[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(J));default:throw new Error("Unrecognized Formula Token: "+String(J))}var bt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(l.biff!=3&&R>=0&&bt.indexOf(e[0][q][0])==-1){J=e[0][R];var Nt=!0;switch(J[1][0]){case 4:Nt=!1;case 0:H=Zl(" ",J[1][1]);break;case 5:Nt=!1;case 1:H=Zl("\r",J[1][1]);break;default:if(H="",l.WTF)throw new Error("Unexpected PtgAttrSpaceType "+J[1][0])}a.push((Nt?H:"")+a.pop()+(Nt?"":H)),R=-1}}if(a.length>1&&l.WTF)throw new Error("bad formula stack");return a[0]}function See(e){if(e==null){var t=Zr(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return B0(e);return B0(0)}function Tee(e,t,r,n,l){var u=C0(t,r,l),d=See(e.v),a=Zr(6),v=33;a.write_shift(2,v),a.write_shift(4,0);for(var x=Zr(e.bf.length),b=0;b<e.bf.length;++b)x[b]=e.bf[b];var I=oh([u,d,a,x]);return I}function Fb(e,t,r){var n=e.read_shift(4),l=bee(e,n,r),u=e.read_shift(4),d=u>0?wee(e,u,l,r):null;return[l,d]}var Iee=Fb,Pb=Fb,Fee=Fb,Pee=Fb,Lee={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},rz={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Mee={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Oee(e){var t="of:="+e.replace(yI,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Dee(e){return e.replace(/\./,"!")}var $y=typeof Map<"u";function bI(e,t,r){var n=0,l=e.length;if(r){if($y?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var u=$y?r.get(t):r[t];n<u.length;++n)if(e[u[n]].t===t)return e.Count++,u[n]}}else for(;n<l;++n)if(e[n].t===t)return e.Count++,n;return e[l]={t},e.Count++,e.Unique++,r&&($y?(r.has(t)||r.set(t,[]),r.get(t).push(l)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(l))),l}function Lb(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(lm=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=x2(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=BT(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function nz(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Lg(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],l=60,u=e.length;if(n==null&&r.ssf){for(;l<392;++l)if(r.ssf[l]==null){Y6(t.z,l),r.ssf[l]=t.z,r.revssf[t.z]=n=l;break}}for(l=0;l!=u;++l)if(e[l].numFmtId===n)return l;return e[u]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},u}function Ree(e,t,r){if(e&&e["!ref"]){var n=ol(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function kee(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Gc(e[r])+'"/>';return t+"</mergeCells>"}function Uee(e,t,r,n,l){var u=!1,d={},a=null;if(n.bookType!=="xlsx"&&t.vbaraw){var v=t.SheetNames[r];try{t.Workbook&&(v=t.Workbook.Sheets[r].CodeName||v)}catch{}u=!0,d.codeName=l1(ms(v))}if(e&&e["!outline"]){var x={summaryBelow:1,summaryRight:1};e["!outline"].above&&(x.summaryBelow=0),e["!outline"].left&&(x.summaryRight=0),a=(a||"")+On("outlinePr",null,x)}!u&&!a||(l[l.length]=On("sheetPr",a,d))}var Nee=["objects","scenarios","selectLockedCells","selectUnlockedCells"],zee=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Qee(e){var t={sheet:1};return Nee.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),zee.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=z8(e.password).toString(16).toUpperCase()),On("sheetProtection",null,t)}function jee(e){return nz(e),On("pageMargins",null,e)}function Hee(e,t){for(var r=["<cols>"],n,l=0;l!=t.length;++l)(n=t[l])&&(r[r.length]=On("col",null,Lb(l,n)));return r[r.length]="</cols>",r.join("")}function Vee(e,t,r,n){var l=typeof e.ref=="string"?e.ref:Gc(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var u=r.Workbook.Names,d=_A(l);d.s.r==d.e.r&&(d.e.r=_A(t["!ref"]).e.r,l=Gc(d));for(var a=0;a<u.length;++a){var v=u[a];if(v.Name=="_xlnm._FilterDatabase"&&v.Sheet==n){v.Ref="'"+r.SheetNames[n]+"'!"+l;break}}return a==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),On("autoFilter",null,{ref:l})}function Gee(e,t,r,n){var l={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(l.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),On("sheetViews",On("sheetView",null,l),{})}function Kee(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var l="",u=e.t,d=e.v;if(e.t!=="z")switch(e.t){case"b":l=e.v?"1":"0";break;case"n":l=""+e.v;break;case"e":l=L1[e.v];break;case"d":n&&n.cellDates?l=cf(e.v,-1).toISOString():(e=Of(e),e.t="n",l=""+(e.v=Mf(cf(e.v)))),typeof e.z>"u"&&(e.z=Jl[14]);break;default:l=e.v;break}var a=sh("v",ms(l)),v={r:t},x=Lg(n.cellXfs,e,n);switch(x!==0&&(v.s=x),e.t){case"n":break;case"d":v.t="d";break;case"b":v.t="b";break;case"e":v.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){a=sh("v",""+bI(n.Strings,e.v,n.revStrings)),v.t="s";break}v.t="str";break}if(e.t!=u&&(e.t=u,e.v=d),typeof e.f=="string"&&e.f){var b=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=On("f",ms(e.f),b)+(e.v!=null?a:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(v.cm=1),On("c",a,v)}function Wee(e,t,r,n){var l=[],u=[],d=ol(e["!ref"]),a="",v,x="",b=[],I=0,M=0,L=e["!rows"],U=Array.isArray(e),R={r:x},H,q=-1;for(M=d.s.c;M<=d.e.c;++M)b[M]=kh(M);for(I=d.s.r;I<=d.e.r;++I){for(u=[],x=uh(I),M=d.s.c;M<=d.e.c;++M){v=b[M]+x;var te=U?(e[I]||[])[M]:e[v];te!==void 0&&(a=Kee(te,v,e,t))!=null&&u.push(a)}(u.length>0||L&&L[I])&&(R={r:x},L&&L[I]&&(H=L[I],H.hidden&&(R.hidden=1),q=-1,H.hpx?q=w2(H.hpx):H.hpt&&(q=H.hpt),q>-1&&(R.ht=q,R.customHeight=1),H.level&&(R.outlineLevel=H.level)),l[l.length]=On("row",u.join(""),R))}if(L)for(;I<L.length;++I)L&&L[I]&&(R={r:I+1},H=L[I],H.hidden&&(R.hidden=1),q=-1,H.hpx?q=w2(H.hpx):H.hpt&&(q=H.hpt),q>-1&&(R.ht=q,R.customHeight=1),H.level&&(R.outlineLevel=H.level),l[l.length]=On("row","",R));return l.join("")}function iz(e,t,r,n){var l=[Wc,On("worksheet",null,{xmlns:pv[0],"xmlns:r":Nu.r})],u=r.SheetNames[e],d=0,a="",v=r.Sheets[u];v==null&&(v={});var x=v["!ref"]||"A1",b=ol(x);if(b.e.c>16383||b.e.r>1048575){if(t.WTF)throw new Error("Range "+x+" exceeds format limit A1:XFD1048576");b.e.c=Math.min(b.e.c,16383),b.e.r=Math.min(b.e.c,1048575),x=Gc(b)}n||(n={}),v["!comments"]=[];var I=[];Uee(v,r,e,t,l),l[l.length]=On("dimension",null,{ref:x}),l[l.length]=Gee(v,t,e,r),t.sheetFormat&&(l[l.length]=On("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),v["!cols"]!=null&&v["!cols"].length>0&&(l[l.length]=Hee(v,v["!cols"])),l[d=l.length]="<sheetData/>",v["!links"]=[],v["!ref"]!=null&&(a=Wee(v,t),a.length>0&&(l[l.length]=a)),l.length>d+1&&(l[l.length]="</sheetData>",l[d]=l[d].replace("/>",">")),v["!protect"]&&(l[l.length]=Qee(v["!protect"])),v["!autofilter"]!=null&&(l[l.length]=Vee(v["!autofilter"],v,r,e)),v["!merges"]!=null&&v["!merges"].length>0&&(l[l.length]=kee(v["!merges"]));var M=-1,L,U=-1;return v["!links"].length>0&&(l[l.length]="<hyperlinks>",v["!links"].forEach(function(R){R[1].Target&&(L={ref:R[0]},R[1].Target.charAt(0)!="#"&&(U=As(n,-1,ms(R[1].Target).replace(/#.*$/,""),Ro.HLINK),L["r:id"]="rId"+U),(M=R[1].Target.indexOf("#"))>-1&&(L.location=ms(R[1].Target.slice(M+1))),R[1].Tooltip&&(L.tooltip=ms(R[1].Tooltip)),l[l.length]=On("hyperlink",null,L))}),l[l.length]="</hyperlinks>"),delete v["!links"],v["!margins"]!=null&&(l[l.length]=jee(v["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(l[l.length]=sh("ignoredErrors",On("ignoredError",null,{numberStoredAsText:1,sqref:x}))),I.length>0&&(U=As(n,-1,"../drawings/drawing"+(e+1)+".xml",Ro.DRAW),l[l.length]=On("drawing",null,{"r:id":"rId"+U}),v["!drawing"]=I),v["!comments"].length>0&&(U=As(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ro.VML),l[l.length]=On("legacyDrawing",null,{"r:id":"rId"+U}),v["!legacy"]=U),l.length>1&&(l[l.length]="</worksheet>",l[1]=l[1].replace("/>",">")),l.join("")}function qee(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var l=e.read_shift(2);e.l+=1;var u=e.read_shift(1);return e.l=n,u&7&&(r.level=u&7),u&16&&(r.hidden=!0),u&32&&(r.hpt=l/20),r}function $ee(e,t,r){var n=Zr(145),l=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var u=320;l.hpx?u=w2(l.hpx)*20:l.hpt&&(u=l.hpt*20),n.write_shift(2,u),n.write_shift(1,0);var d=0;l.level&&(d|=l.level),l.hidden&&(d|=16),(l.hpx||l.hpt)&&(d|=32),n.write_shift(1,d),n.write_shift(1,0);var a=0,v=n.l;n.l+=4;for(var x={r:e,c:0},b=0;b<16;++b)if(!(t.s.c>b+1<<10||t.e.c<b<<10)){for(var I=-1,M=-1,L=b<<10;L<b+1<<10;++L){x.c=L;var U=Array.isArray(r)?(r[x.r]||[])[x.c]:r[gs(x)];U&&(I<0&&(I=L),M=L)}I<0||(++a,n.write_shift(4,I),n.write_shift(4,M))}var R=n.l;return n.l=v,n.write_shift(4,a),n.l=R,n.length>n.l?n.slice(0,n.l):n}function Xee(e,t,r,n){var l=$ee(n,r,t);(l.length>17||(t["!rows"]||[])[n])&&gn(e,0,l)}var Zee=U0,Yee=gv;function Jee(){}function ete(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=uZ(e),r}function tte(e,t,r){r==null&&(r=Zr(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var l=1;l<3;++l)r.write_shift(1,0);return _2({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),v8(e,r),r.slice(0,r.l)}function rte(e){var t=sd(e);return[t]}function nte(e,t,r){return r==null&&(r=Zr(8)),D0(t,r)}function ite(e){var t=R0(e);return[t]}function ate(e,t,r){return r==null&&(r=Zr(4)),k0(t,r)}function ote(e){var t=sd(e),r=e.read_shift(1);return[t,r,"b"]}function ste(e,t,r){return r==null&&(r=Zr(9)),D0(t,r),r.write_shift(1,e.v?1:0),r}function lte(e){var t=R0(e),r=e.read_shift(1);return[t,r,"b"]}function cte(e,t,r){return r==null&&(r=Zr(5)),k0(t,r),r.write_shift(1,e.v?1:0),r}function ute(e){var t=sd(e),r=e.read_shift(1);return[t,r,"e"]}function hte(e,t,r){return r==null&&(r=Zr(9)),D0(t,r),r.write_shift(1,e.v),r}function fte(e){var t=R0(e),r=e.read_shift(1);return[t,r,"e"]}function Ate(e,t,r){return r==null&&(r=Zr(8)),k0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function dte(e){var t=sd(e),r=e.read_shift(4);return[t,r,"s"]}function pte(e,t,r){return r==null&&(r=Zr(12)),D0(t,r),r.write_shift(4,t.v),r}function mte(e){var t=R0(e),r=e.read_shift(4);return[t,r,"s"]}function gte(e,t,r){return r==null&&(r=Zr(8)),k0(t,r),r.write_shift(4,t.v),r}function _te(e){var t=sd(e),r=_v(e);return[t,r,"n"]}function vte(e,t,r){return r==null&&(r=Zr(16)),D0(t,r),B0(e.v,r),r}function yte(e){var t=R0(e),r=_v(e);return[t,r,"n"]}function xte(e,t,r){return r==null&&(r=Zr(12)),k0(t,r),B0(e.v,r),r}function wte(e){var t=sd(e),r=y8(e);return[t,r,"n"]}function bte(e,t,r){return r==null&&(r=Zr(12)),D0(t,r),x8(e.v,r),r}function Ete(e){var t=R0(e),r=y8(e);return[t,r,"n"]}function Bte(e,t,r){return r==null&&(r=Zr(8)),k0(t,r),x8(e.v,r),r}function Cte(e){var t=sd(e),r=pI(e);return[t,r,"is"]}function Ste(e){var t=sd(e),r=Uh(e);return[t,r,"str"]}function Tte(e,t,r){return r==null&&(r=Zr(12+4*e.v.length)),D0(t,r),Qu(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Ite(e){var t=R0(e),r=Uh(e);return[t,r,"str"]}function Fte(e,t,r){return r==null&&(r=Zr(8+4*e.v.length)),k0(t,r),Qu(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Pte(e,t,r){var n=e.l+t,l=sd(e);l.r=r["!row"];var u=e.read_shift(1),d=[l,u,"b"];if(r.cellFormula){e.l+=2;var a=Pb(e,n-e.l,r);d[3]=Y_(a,null,l,r.supbooks,r)}else e.l=n;return d}function Lte(e,t,r){var n=e.l+t,l=sd(e);l.r=r["!row"];var u=e.read_shift(1),d=[l,u,"e"];if(r.cellFormula){e.l+=2;var a=Pb(e,n-e.l,r);d[3]=Y_(a,null,l,r.supbooks,r)}else e.l=n;return d}function Mte(e,t,r){var n=e.l+t,l=sd(e);l.r=r["!row"];var u=_v(e),d=[l,u,"n"];if(r.cellFormula){e.l+=2;var a=Pb(e,n-e.l,r);d[3]=Y_(a,null,l,r.supbooks,r)}else e.l=n;return d}function Ote(e,t,r){var n=e.l+t,l=sd(e);l.r=r["!row"];var u=Uh(e),d=[l,u,"str"];if(r.cellFormula){e.l+=2;var a=Pb(e,n-e.l,r);d[3]=Y_(a,null,l,r.supbooks,r)}else e.l=n;return d}var Dte=U0,Rte=gv;function kte(e,t){return t==null&&(t=Zr(4)),t.write_shift(4,e),t}function Ute(e,t){var r=e.l+t,n=U0(e),l=mI(e),u=Uh(e),d=Uh(e),a=Uh(e);e.l=r;var v={rfx:n,relId:l,loc:u,display:a};return d&&(v.Tooltip=d),v}function Nte(e,t){var r=Zr(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));gv({s:zu(e[0]),e:zu(e[0])},r),gI("rId"+t,r);var n=e[1].Target.indexOf("#"),l=n==-1?"":e[1].Target.slice(n+1);return Qu(l||"",r),Qu(e[1].Tooltip||"",r),Qu("",r),r.slice(0,r.l)}function zte(){}function Qte(e,t,r){var n=e.l+t,l=w8(e),u=e.read_shift(1),d=[l];if(d[2]=u,r.cellFormula){var a=Iee(e,n-e.l,r);d[1]=a}else e.l=n;return d}function jte(e,t,r){var n=e.l+t,l=U0(e),u=[l];if(r.cellFormula){var d=Pee(e,n-e.l,r);u[1]=d,e.l=n}else e.l=n;return u}function Hte(e,t,r){r==null&&(r=Zr(18));var n=Lb(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var l=0;return t.hidden&&(l|=1),typeof n.width=="number"&&(l|=2),t.level&&(l|=t.level<<8),r.write_shift(2,l),r}var az=["left","right","top","bottom","header","footer"];function Vte(e){var t={};return az.forEach(function(r){t[r]=_v(e)}),t}function Gte(e,t){return t==null&&(t=Zr(48)),nz(e),az.forEach(function(r){B0(e[r],t)}),t}function Kte(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Wte(e,t,r){r==null&&(r=Zr(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function qte(e){var t=Zr(24);return t.write_shift(4,4),t.write_shift(4,1),gv(e,t),t}function $te(e,t){return t==null&&(t=Zr(66)),t.write_shift(2,e.password?z8(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Xte(){}function Zte(){}function Yte(e,t,r,n,l,u,d){if(t.v===void 0)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":t=Of(t),t.z=t.z||Jl[14],t.v=Mf(cf(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v;break}var v={r,c:n};switch(v.s=Lg(l.cellXfs,t,l),t.l&&u["!links"].push([gs(v),t.l]),t.c&&u["!comments"].push([gs(v),t.c]),t.t){case"s":case"str":return l.bookSST?(a=bI(l.Strings,t.v,l.revStrings),v.t="s",v.v=a,d?gn(e,18,gte(t,v)):gn(e,7,pte(t,v))):(v.t="str",d?gn(e,17,Fte(t,v)):gn(e,6,Tte(t,v))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?d?gn(e,13,Bte(t,v)):gn(e,2,bte(t,v)):d?gn(e,16,xte(t,v)):gn(e,5,vte(t,v)),!0;case"b":return v.t="b",d?gn(e,15,cte(t,v)):gn(e,4,ste(t,v)),!0;case"e":return v.t="e",d?gn(e,14,Ate(t,v)):gn(e,3,hte(t,v)),!0}return d?gn(e,12,ate(t,v)):gn(e,1,nte(t,v)),!0}function Jte(e,t,r,n){var l=ol(t["!ref"]||"A1"),u,d="",a=[];gn(e,145);var v=Array.isArray(t),x=l.e.r;t["!rows"]&&(x=Math.max(l.e.r,t["!rows"].length-1));for(var b=l.s.r;b<=x;++b){d=uh(b),Xee(e,t,l,b);var I=!1;if(b<=l.e.r)for(var M=l.s.c;M<=l.e.c;++M){b===l.s.r&&(a[M]=kh(M)),u=a[M]+d;var L=v?(t[b]||[])[M]:t[u];if(!L){I=!1;continue}I=Yte(e,L,b,M,n,t,I)}}gn(e,146)}function ere(e,t){!t||!t["!merges"]||(gn(e,177,kte(t["!merges"].length)),t["!merges"].forEach(function(r){gn(e,176,Rte(r))}),gn(e,178))}function tre(e,t){!t||!t["!cols"]||(gn(e,390),t["!cols"].forEach(function(r,n){r&&gn(e,60,Hte(n,r))}),gn(e,391))}function rre(e,t){!t||!t["!ref"]||(gn(e,648),gn(e,649,qte(ol(t["!ref"]))),gn(e,650))}function nre(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var l=As(r,-1,n[1].Target.replace(/#.*$/,""),Ro.HLINK);gn(e,494,Nte(n,l))}}),delete t["!links"]}function ire(e,t,r,n){if(t["!comments"].length>0){var l=As(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ro.VML);gn(e,551,gI("rId"+l)),t["!legacy"]=l}}function are(e,t,r,n){if(t["!autofilter"]){var l=t["!autofilter"],u=typeof l.ref=="string"?l.ref:Gc(l.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var d=r.Workbook.Names,a=_A(u);a.s.r==a.e.r&&(a.e.r=_A(t["!ref"]).e.r,u=Gc(a));for(var v=0;v<d.length;++v){var x=d[v];if(x.Name=="_xlnm._FilterDatabase"&&x.Sheet==n){x.Ref="'"+r.SheetNames[n]+"'!"+u;break}}v==d.length&&d.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+u}),gn(e,161,gv(ol(u))),gn(e,162)}}function ore(e,t,r){gn(e,133),gn(e,137,Wte(t,r)),gn(e,138),gn(e,134)}function sre(e,t){t["!protect"]&&gn(e,535,$te(t["!protect"]))}function lre(e,t,r,n){var l=Lf(),u=r.SheetNames[e],d=r.Sheets[u]||{},a=u;try{r&&r.Workbook&&(a=r.Workbook.Sheets[e].CodeName||a)}catch{}var v=ol(d["!ref"]||"A1");if(v.e.c>16383||v.e.r>1048575){if(t.WTF)throw new Error("Range "+(d["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");v.e.c=Math.min(v.e.c,16383),v.e.r=Math.min(v.e.c,1048575)}return d["!links"]=[],d["!comments"]=[],gn(l,129),(r.vbaraw||d["!outline"])&&gn(l,147,tte(a,d["!outline"])),gn(l,148,Yee(v)),ore(l,d,r.Workbook),tre(l,d),Jte(l,d,e,t),sre(l,d),are(l,d,r,e),ere(l,d),nre(l,d,n),d["!margins"]&&gn(l,476,Gte(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&rre(l,d),ire(l,d,e,n),gn(l,130),l.end()}function cre(e,t){e.l+=10;var r=Uh(e);return{name:r}}var ure=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function hre(e){return!e.Workbook||!e.Workbook.WBProps?"false":jX(e.Workbook.WBProps.date1904)?"true":"false"}var fre="][*?/\\".split("");function oz(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return fre.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Are(e,t,r){e.forEach(function(n,l){oz(n);for(var u=0;u<l;++u)if(n==e[u])throw new Error("Duplicate Sheet Name: "+n);if(r){var d=t&&t[l]&&t[l].CodeName||n;if(d.charCodeAt(0)==95&&d.length>22)throw new Error("Bad Code Name: Worksheet"+d)}})}function dre(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Are(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Ree(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function sz(e){var t=[Wc];t[t.length]=On("workbook",null,{xmlns:pv[0],"xmlns:r":Nu.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ure.forEach(function(a){e.Workbook.WBProps[a[0]]!=null&&e.Workbook.WBProps[a[0]]!=a[1]&&(n[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=On("workbookPr",null,n);var l=e.Workbook&&e.Workbook.Sheets||[],u=0;if(l&&l[0]&&l[0].Hidden){for(t[t.length]="<bookViews>",u=0;u!=e.SheetNames.length&&!(!l[u]||!l[u].Hidden);++u);u==e.SheetNames.length&&(u=0),t[t.length]='<workbookView firstSheet="'+u+'" activeTab="'+u+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",u=0;u!=e.SheetNames.length;++u){var d={name:ms(e.SheetNames[u].slice(0,31))};if(d.sheetId=""+(u+1),d["r:id"]="rId"+(u+1),l[u])switch(l[u].Hidden){case 1:d.state="hidden";break;case 2:d.state="veryHidden";break}t[t.length]=On("sheet",null,d)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var v={name:a.Name};a.Comment&&(v.comment=a.Comment),a.Sheet!=null&&(v.localSheetId=""+a.Sheet),a.Hidden&&(v.hidden="1"),a.Ref&&(t[t.length]=On("definedName",ms(a.Ref),v))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function pre(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ET(e),r.name=Uh(e),r}function mre(e,t){return t||(t=Zr(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),gI(e.strRelID,t),Qu(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function gre(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var l=t>8?Uh(e):"";return l.length>0&&(r.CodeName=l),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function _re(e,t){t||(t=Zr(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),v8(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function vre(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var l=e.read_shift(4),u=hZ(e),d=Fee(e,0,r),a=mI(e);e.l=n;var v={Name:u,Ptg:d};return l<268435455&&(v.Sheet=l),a&&(v.Comment=a),v}function yre(e,t){gn(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,l={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};gn(e,156,mre(l))}gn(e,144)}function xre(e,t){t||(t=Zr(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Qu("SheetJS",t),Qu(u2.version,t),Qu(u2.version,t),Qu("7262",t),t.length>t.l?t.slice(0,t.l):t}function wre(e,t){t||(t=Zr(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function bre(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,l=-1,u=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&l==-1?l=n:r[n].Hidden==1&&u==-1&&(u=n);u>l||(gn(e,135),gn(e,158,wre(l)),gn(e,136))}}function Ere(e,t){var r=Lf();return gn(r,131),gn(r,128,xre()),gn(r,153,_re(e.Workbook&&e.Workbook.WBProps||null)),bre(r,e),yre(r,e),gn(r,132),r.end()}function Bre(e,t,r){return(t.slice(-4)===".bin"?Ere:sz)(e)}function Cre(e,t,r,n,l){return(t.slice(-4)===".bin"?lre:iz)(e,r,n,l)}function Sre(e,t,r){return(t.slice(-4)===".bin"?GY:H8)(e,r)}function Tre(e,t,r){return(t.slice(-4)===".bin"?_Y:N8)(e,r)}function Ire(e,t,r){return(t.slice(-4)===".bin"?sJ:q8)(e)}function Fre(e){return(e.slice(-4)===".bin"?JY:K8)()}function Pre(e,t){var r=[];return e.Props&&r.push(SZ(e.Props,t)),e.Custprops&&r.push(TZ(e.Props,e.Custprops)),r.join("")}function Lre(){return""}function Mre(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,l){var u=[];u.push(On("NumberFormat",null,{"ss:Format":ms(Jl[n.numFmtId])}));var d={"ss:ID":"s"+(21+l)};r.push(On("Style",u.join(""),d))}),On("Styles",r.join(""))}function lz(e){return On("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+xI(e.Ref,{r:0,c:0})})}function Ore(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var l=t[n];l.Sheet==null&&(l.Name.match(/^_xlfn\./)||r.push(lz(l)))}return On("Names",r.join(""))}function Dre(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var l=n.Workbook.Names,u=[],d=0;d<l.length;++d){var a=l[d];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||u.push(lz(a)))}return u.join("")}function Rre(e,t,r,n){if(!e)return"";var l=[];if(e["!margins"]&&(l.push("<PageSetup>"),e["!margins"].header&&l.push(On("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&l.push(On("Footer",null,{"x:Margin":e["!margins"].footer})),l.push(On("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),l.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)l.push(On("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var u=0;u<r&&!(n.Workbook.Sheets[u]&&!n.Workbook.Sheets[u].Hidden);++u);u==r&&l.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&l.push("<DisplayRightToLeft/>"),e["!protect"]&&(l.push(sh("ProtectContents","True")),e["!protect"].objects&&l.push(sh("ProtectObjects","True")),e["!protect"].scenarios&&l.push(sh("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?l.push(sh("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&l.push(sh("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(d){e["!protect"][d[0]]&&l.push("<"+d[1]+"/>")})),l.length==0?"":On("WorksheetOptions",l.join(""),{xmlns:fA.x})}function kre(e){return e.map(function(t){var r=QX(t.t||""),n=On("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return On("Comment",n,{"ss:Author":t.a})}).join("")}function Ure(e,t,r,n,l,u,d){if(!e||e.v==null&&e.f==null)return"";var a={};if(e.f&&(a["ss:Formula"]="="+ms(xI(e.f,d))),e.F&&e.F.slice(0,t.length)==t){var v=zu(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(v.r==d.r?"":"["+(v.r-d.r)+"]")+"C"+(v.c==d.c?"":"["+(v.c-d.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=ms(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=ms(e.l.Tooltip))),r["!merges"])for(var x=r["!merges"],b=0;b!=x.length;++b)x[b].s.c!=d.c||x[b].s.r!=d.r||(x[b].e.c>x[b].s.c&&(a["ss:MergeAcross"]=x[b].e.c-x[b].s.c),x[b].e.r>x[b].s.r&&(a["ss:MergeDown"]=x[b].e.r-x[b].s.r));var I="",M="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":I="Number",M=String(e.v);break;case"b":I="Boolean",M=e.v?"1":"0";break;case"e":I="Error",M=L1[e.v];break;case"d":I="DateTime",M=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Jl[14]);break;case"s":I="String",M=zX(e.v||"");break}var L=Lg(n.cellXfs,e,n);a["ss:StyleID"]="s"+(21+L),a["ss:Index"]=d.c+1;var U=e.v!=null?M:"",R=e.t=="z"?"":'<Data ss:Type="'+I+'">'+U+"</Data>";return(e.c||[]).length>0&&(R+=kre(e.c)),On("Cell",R,a)}function Nre(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=j8(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function zre(e,t,r,n){if(!e["!ref"])return"";var l=ol(e["!ref"]),u=e["!merges"]||[],d=0,a=[];e["!cols"]&&e["!cols"].forEach(function(H,q){vI(H);var te=!!H.width,J=Lb(q,H),se={"ss:Index":q+1};te&&(se["ss:Width"]=y2(J.width)),H.hidden&&(se["ss:Hidden"]="1"),a.push(On("Column",null,se))});for(var v=Array.isArray(e),x=l.s.r;x<=l.e.r;++x){for(var b=[Nre(x,(e["!rows"]||[])[x])],I=l.s.c;I<=l.e.c;++I){var M=!1;for(d=0;d!=u.length;++d)if(!(u[d].s.c>I)&&!(u[d].s.r>x)&&!(u[d].e.c<I)&&!(u[d].e.r<x)){(u[d].s.c!=I||u[d].s.r!=x)&&(M=!0);break}if(!M){var L={r:x,c:I},U=gs(L),R=v?(e[x]||[])[I]:e[U];b.push(Ure(R,U,e,t,r,n,L))}}b.push("</Row>"),b.length>2&&a.push(b.join(""))}return a.join("")}function Qre(e,t,r){var n=[],l=r.SheetNames[e],u=r.Sheets[l],d=u?Dre(u,t,e,r):"";return d.length>0&&n.push("<Names>"+d+"</Names>"),d=u?zre(u,t,e,r):"",d.length>0&&n.push("<Table>"+d+"</Table>"),n.push(Rre(u,t,e,r)),n.join("")}function jre(e,t){t||(t={}),e.SSF||(e.SSF=Of(Jl)),e.SSF&&(Sb(),Cb(e.SSF),t.revssf=Tb(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Lg(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Pre(e,t)),r.push(Lre()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(On("Worksheet",Qre(n,t,e),{"ss:Name":ms(e.SheetNames[n])}));return r[2]=Mre(e,t),r[3]=Ore(e),Wc+On("Workbook",r.join(""),{xmlns:fA.ss,"xmlns:o":fA.o,"xmlns:x":fA.x,"xmlns:ss":fA.ss,"xmlns:dt":fA.dt,"xmlns:html":fA.html})}var VB={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Hre(e,t){var r=[],n=[],l=[],u=0,d,a=LM(GM,"n"),v=LM(KM,"n");if(e.Props)for(d=hh(e.Props),u=0;u<d.length;++u)(Object.prototype.hasOwnProperty.call(a,d[u])?r:Object.prototype.hasOwnProperty.call(v,d[u])?n:l).push([d[u],e.Props[d[u]]]);if(e.Custprops)for(d=hh(e.Custprops),u=0;u<d.length;++u)Object.prototype.hasOwnProperty.call(e.Props||{},d[u])||(Object.prototype.hasOwnProperty.call(a,d[u])?r:Object.prototype.hasOwnProperty.call(v,d[u])?n:l).push([d[u],e.Custprops[d[u]]]);var x=[];for(u=0;u<l.length;++u)L8.indexOf(l[u][0])>-1||I8.indexOf(l[u][0])>-1||l[u][1]!=null&&x.push(l[u]);n.length&&Es.utils.cfb_add(t,"/SummaryInformation",ZM(n,VB.SI,v,KM)),(r.length||x.length)&&Es.utils.cfb_add(t,"/DocumentSummaryInformation",ZM(r,VB.DSI,a,GM,x.length?x:null,VB.UDI))}function Vre(e,t){var r=t||{},n=Es.utils.cfb_new({root:"R"}),l="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":l="/Workbook",r.biff=8;break;case"biff5":l="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Es.utils.cfb_add(n,l,cz(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Hre(e,n),r.biff==8&&e.vbaraw&&lJ(n,Es.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Gre={0:{f:qee},1:{f:rte},2:{f:wte},3:{f:ute},4:{f:ote},5:{f:_te},6:{f:Ste},7:{f:dte},8:{f:Ote},9:{f:Mte},10:{f:Pte},11:{f:Lte},12:{f:ite},13:{f:Ete},14:{f:fte},15:{f:lte},16:{f:yte},17:{f:Ite},18:{f:mte},19:{f:pI},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:vre},40:{},42:{},43:{f:SY},44:{f:BY},45:{f:FY},46:{f:LY},47:{f:PY},48:{},49:{f:iZ},50:{},51:{f:qY},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:aY},62:{f:Cte},63:{f:eJ},64:{f:Xte},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Tp,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Kte},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ete},148:{f:Zee,p:16},151:{f:zte},152:{},153:{f:gre},154:{},155:{},156:{f:pre},157:{},158:{},159:{T:1,f:pY},160:{T:-1},161:{T:1,f:U0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Dte},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:KY},336:{T:-1},337:{f:ZY,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ET},357:{},358:{},359:{},360:{T:1},361:{},362:{f:JZ},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Qte},427:{f:jte},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Vte},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Jee},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Ute},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ET},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:aJ},633:{T:1},634:{T:-1},635:{T:1,f:nJ},636:{T:-1},637:{f:lZ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:cre},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Zte},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Rn(e,t,r,n){var l=t;if(!isNaN(l)){var u=n||(r||[]).length||0,d=e.next(4);d.write_shift(2,l),d.write_shift(2,u),u>0&&fI(r)&&e.push(r)}}function Kre(e,t,r,n){var l=(r||[]).length||0;if(l<=8224)return Rn(e,t,r,l);var u=t;if(!isNaN(u)){for(var d=r.parts||[],a=0,v=0,x=0;x+(d[a]||8224)<=8224;)x+=d[a]||8224,a++;var b=e.next(4);for(b.write_shift(2,u),b.write_shift(2,x),e.push(r.slice(v,v+x)),v+=x;v<l;){for(b=e.next(4),b.write_shift(2,60),x=0;x+(d[a]||8224)<=8224;)x+=d[a]||8224,a++;b.write_shift(2,x),e.push(r.slice(v,v+x)),v+=x}}}function O1(e,t,r){return e||(e=Zr(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Wre(e,t,r,n){var l=Zr(9);return O1(l,e,t),O8(r,n||"b",l),l}function qre(e,t,r){var n=Zr(8+2*r.length);return O1(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function $re(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var l=t.t=="d"?Mf(cf(t.v)):t.v;l==(l|0)&&l>=0&&l<65536?Rn(e,2,cY(r,n,l)):Rn(e,3,lY(r,n,l));return;case"b":case"e":Rn(e,5,Wre(r,n,t.v,t.t));return;case"s":case"str":Rn(e,4,qre(r,n,(t.v||"").slice(0,255)));return}Rn(e,1,O1(null,r,n))}function Xre(e,t,r,n){var l=Array.isArray(t),u=ol(t["!ref"]||"A1"),d,a="",v=[];if(u.e.c>255||u.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,16383),d=Gc(u)}for(var x=u.s.r;x<=u.e.r;++x){a=uh(x);for(var b=u.s.c;b<=u.e.c;++b){x===u.s.r&&(v[b]=kh(b)),d=v[b]+a;var I=l?(t[x]||[])[b]:t[d];I&&$re(e,I,x,b)}}}function Zre(e,t){for(var r=t||{},n=Lf(),l=0,u=0;u<e.SheetNames.length;++u)e.SheetNames[u]==r.sheet&&(l=u);if(l==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Rn(n,r.biff==4?1033:r.biff==3?521:9,_I(e,16,r)),Xre(n,e.Sheets[e.SheetNames[l]],l,r),Rn(n,10),n.end()}function Yre(e,t,r){Rn(e,49,GZ({sz:12,name:"Arial"},r))}function Jre(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var l=n[0];l<=n[1];++l)t[l]!=null&&Rn(e,1054,qZ(l,t[l],r))})}function ene(e,t){var r=Zr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Rn(e,2151,r),r=Zr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),k8(ol(t["!ref"]||"A1"),r),r.write_shift(4,4),Rn(e,2152,r)}function tne(e,t){for(var r=0;r<16;++r)Rn(e,224,JM({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Rn(e,224,JM(n,0,t))})}function rne(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Rn(e,440,rY(n)),n[1].Tooltip&&Rn(e,2048,nY(n))}delete t["!links"]}function nne(e,t){if(t){var r=0;t.forEach(function(n,l){++r<=256&&n&&Rn(e,125,oY(Lb(l,n),l))})}}function ine(e,t,r,n,l){var u=16+Lg(l.cellXfs,t,l);if(t.v==null&&!t.bf){Rn(e,513,C0(r,n,u));return}if(t.bf)Rn(e,6,Tee(t,r,n,l,u));else switch(t.t){case"d":case"n":var d=t.t=="d"?Mf(cf(t.v)):t.v;Rn(e,515,YZ(r,n,d,u));break;case"b":case"e":Rn(e,517,ZZ(r,n,t.v,u,l,t.t));break;case"s":case"str":if(l.bookSST){var a=bI(l.Strings,t.v,l.revStrings);Rn(e,253,KZ(r,n,a,u))}else Rn(e,516,WZ(r,n,(t.v||"").slice(0,255),u,l));break;default:Rn(e,513,C0(r,n,u))}}function ane(e,t,r){var n=Lf(),l=r.SheetNames[e],u=r.Sheets[l]||{},d=(r||{}).Workbook||{},a=(d.Sheets||[])[e]||{},v=Array.isArray(u),x=t.biff==8,b,I="",M=[],L=ol(u["!ref"]||"A1"),U=x?65536:16384;if(L.e.c>255||L.e.r>=U){if(t.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:IV16384");L.e.c=Math.min(L.e.c,255),L.e.r=Math.min(L.e.c,U-1)}Rn(n,2057,_I(r,16,t)),Rn(n,13,XA(1)),Rn(n,12,XA(100)),Rn(n,15,sf(!0)),Rn(n,17,sf(!1)),Rn(n,16,B0(.001)),Rn(n,95,sf(!0)),Rn(n,42,sf(!1)),Rn(n,43,sf(!1)),Rn(n,130,XA(1)),Rn(n,128,XZ()),Rn(n,131,sf(!1)),Rn(n,132,sf(!1)),x&&nne(n,u["!cols"]),Rn(n,512,$Z(L,t)),x&&(u["!links"]=[]);for(var R=L.s.r;R<=L.e.r;++R){I=uh(R);for(var H=L.s.c;H<=L.e.c;++H){R===L.s.r&&(M[H]=kh(H)),b=M[H]+I;var q=v?(u[R]||[])[H]:u[b];q&&(ine(n,q,R,H,t),x&&q.l&&u["!links"].push([b,q.l]))}}var te=a.CodeName||a.name||l;return x&&Rn(n,574,VZ((d.Views||[])[0])),x&&(u["!merges"]||[]).length&&Rn(n,229,tY(u["!merges"])),x&&rne(n,u),Rn(n,442,R8(te)),x&&ene(n,u),Rn(n,10),n.end()}function one(e,t,r){var n=Lf(),l=(e||{}).Workbook||{},u=l.Sheets||[],d=l.WBProps||{},a=r.biff==8,v=r.biff==5;if(Rn(n,2057,_I(e,5,r)),r.bookType=="xla"&&Rn(n,135),Rn(n,225,a?XA(1200):null),Rn(n,193,PZ(2)),v&&Rn(n,191),v&&Rn(n,192),Rn(n,226),Rn(n,92,zZ("SheetJS",r)),Rn(n,66,XA(a?1200:1252)),a&&Rn(n,353,XA(0)),a&&Rn(n,448),Rn(n,317,sY(e.SheetNames.length)),a&&e.vbaraw&&Rn(n,211),a&&e.vbaraw){var x=d.CodeName||"ThisWorkbook";Rn(n,442,R8(x))}Rn(n,156,XA(17)),Rn(n,25,sf(!1)),Rn(n,18,sf(!1)),Rn(n,19,XA(0)),a&&Rn(n,431,sf(!1)),a&&Rn(n,444,XA(0)),Rn(n,61,HZ()),Rn(n,64,sf(!1)),Rn(n,141,XA(0)),Rn(n,34,sf(hre(e)=="true")),Rn(n,14,sf(!0)),a&&Rn(n,439,sf(!1)),Rn(n,218,XA(0)),Yre(n,e,r),Jre(n,e.SSF,r),tne(n,r),a&&Rn(n,352,sf(!1));var b=n.end(),I=Lf();a&&Rn(I,140,iY()),a&&r.Strings&&Kre(I,252,jZ(r.Strings)),Rn(I,10);var M=I.end(),L=Lf(),U=0,R=0;for(R=0;R<e.SheetNames.length;++R)U+=(a?12:11)+(a?2:1)*e.SheetNames[R].length;var H=b.length+U+M.length;for(R=0;R<e.SheetNames.length;++R){var q=u[R]||{};Rn(L,133,QZ({pos:H,hs:q.Hidden||0,dt:0,name:e.SheetNames[R]},r)),H+=t[R].length}var te=L.end();if(U!=te.length)throw new Error("BS8 "+U+" != "+te.length);var J=[];return b.length&&J.push(b),te.length&&J.push(te),M.length&&J.push(M),oh(J)}function sne(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Of(Jl)),e&&e.SSF&&(Sb(),Cb(e.SSF),r.revssf=Tb(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,EI(r),r.cellXfs=[],Lg(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var l=0;l<e.SheetNames.length;++l)n[n.length]=ane(l,r,e);return n.unshift(one(e,n,r)),oh(n)}function cz(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var l=_A(n["!ref"]);l.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var u=t||{};switch(u.biff||2){case 8:case 5:return sne(e,t);case 4:case 3:case 2:return Zre(e,t)}throw new Error("invalid type "+u.bookType+" for BIFF")}function lne(e,t,r,n){for(var l=e["!merges"]||[],u=[],d=t.s.c;d<=t.e.c;++d){for(var a=0,v=0,x=0;x<l.length;++x)if(!(l[x].s.r>r||l[x].s.c>d)&&!(l[x].e.r<r||l[x].e.c<d)){if(l[x].s.r<r||l[x].s.c<d){a=-1;break}a=l[x].e.r-l[x].s.r+1,v=l[x].e.c-l[x].s.c+1;break}if(!(a<0)){var b=gs({r,c:d}),I=n.dense?(e[r]||[])[d]:e[b],M=I&&I.v!=null&&(I.h||NX(I.w||(dm(I),I.w)||""))||"",L={};a>1&&(L.rowspan=a),v>1&&(L.colspan=v),n.editable?M='<span contenteditable="true">'+M+"</span>":I&&(L["data-t"]=I&&I.t||"z",I.v!=null&&(L["data-v"]=I.v),I.z!=null&&(L["data-z"]=I.z),I.l&&(I.l.Target||"#").charAt(0)!="#"&&(M='<a href="'+I.l.Target+'">'+M+"</a>")),L.id=(n.id||"sjs")+"-"+b,u.push(On("td",M,L))}}var U="<tr>";return U+u.join("")+"</tr>"}var cne='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',une="</body></html>";function hne(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function uz(e,t){var r=t||{},n=r.header!=null?r.header:cne,l=r.footer!=null?r.footer:une,u=[n],d=_A(e["!ref"]);r.dense=Array.isArray(e),u.push(hne(e,d,r));for(var a=d.s.r;a<=d.e.r;++a)u.push(lne(e,d,a,r));return u.push("</table>"+l),u.join("")}function hz(e,t,r){var n=r||{},l=0,u=0;if(n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var d=typeof n.origin=="string"?zu(n.origin):n.origin;l=d.r,u=d.c}var a=t.getElementsByTagName("tr"),v=Math.min(n.sheetRows||1e7,a.length),x={s:{r:0,c:0},e:{r:l,c:u}};if(e["!ref"]){var b=_A(e["!ref"]);x.s.r=Math.min(x.s.r,b.s.r),x.s.c=Math.min(x.s.c,b.s.c),x.e.r=Math.max(x.e.r,b.e.r),x.e.c=Math.max(x.e.c,b.e.c),l==-1&&(x.e.r=l=b.e.r+1)}var I=[],M=0,L=e["!rows"]||(e["!rows"]=[]),U=0,R=0,H=0,q=0,te=0,J=0;for(e["!cols"]||(e["!cols"]=[]);U<a.length&&R<v;++U){var se=a[U];if(oO(se)){if(n.display)continue;L[R]={hidden:!0}}var ye=se.children;for(H=q=0;H<ye.length;++H){var Se=ye[H];if(!(n.display&&oO(Se))){var Be=Se.hasAttribute("data-v")?Se.getAttribute("data-v"):Se.hasAttribute("v")?Se.getAttribute("v"):HX(Se.innerHTML),De=Se.getAttribute("data-z")||Se.getAttribute("z");for(M=0;M<I.length;++M){var we=I[M];we.s.c==q+u&&we.s.r<R+l&&R+l<=we.e.r&&(q=we.e.c+1-u,M=-1)}J=+Se.getAttribute("colspan")||1,((te=+Se.getAttribute("rowspan")||1)>1||J>1)&&I.push({s:{r:R+l,c:q+u},e:{r:R+l+(te||1)-1,c:q+u+(J||1)-1}});var nt={t:"s",v:Be},_e=Se.getAttribute("data-t")||Se.getAttribute("t")||"";Be!=null&&(Be.length==0?nt.t=_e||"z":n.raw||Be.trim().length==0||_e=="s"||(Be==="TRUE"?nt={t:"b",v:!0}:Be==="FALSE"?nt={t:"b",v:!1}:isNaN(sm(Be))?isNaN(s1(Be).getDate())||(nt={t:"d",v:cf(Be)},n.cellDates||(nt={t:"n",v:Mf(nt.v)}),nt.z=n.dateNF||Jl[14]):nt={t:"n",v:sm(Be)})),nt.z===void 0&&De!=null&&(nt.z=De);var Ie="",Ze=Se.getElementsByTagName("A");if(Ze&&Ze.length)for(var st=0;st<Ze.length&&!(Ze[st].hasAttribute("href")&&(Ie=Ze[st].getAttribute("href"),Ie.charAt(0)!="#"));++st);Ie&&Ie.charAt(0)!="#"&&(nt.l={Target:Ie}),n.dense?(e[R+l]||(e[R+l]=[]),e[R+l][q+u]=nt):e[gs({c:q+u,r:R+l})]=nt,x.e.c<q+u&&(x.e.c=q+u),q+=J}}++R}return I.length&&(e["!merges"]=(e["!merges"]||[]).concat(I)),x.e.r=Math.max(x.e.r,R-1+l),e["!ref"]=Gc(x),R>=v&&(e["!fullref"]=Gc((x.e.r=a.length-U+R-1+l,x))),e}function fz(e,t){var r=t||{},n=r.dense?[]:{};return hz(n,e,t)}function fne(e,t){return O0(fz(e,t),t)}function oO(e){var t="",r=Ane(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Ane(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var dne=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+c1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Wc+t}}(),sO=function(){var e=function(u){return ms(u).replace(/  +/g,function(d){return'<text:s text:c="'+d.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(u,d,a){var v=[];v.push('      <table:table table:name="'+ms(d.SheetNames[a])+`" table:style-name="ta1">
`);var x=0,b=0,I=_A(u["!ref"]||"A1"),M=u["!merges"]||[],L=0,U=Array.isArray(u);if(u["!cols"])for(b=0;b<=I.e.c;++b)v.push("        <table:table-column"+(u["!cols"][b]?' table:style-name="co'+u["!cols"][b].ods+'"':"")+`></table:table-column>
`);var R="",H=u["!rows"]||[];for(x=0;x<I.s.r;++x)R=H[x]?' table:style-name="ro'+H[x].ods+'"':"",v.push("        <table:table-row"+R+`></table:table-row>
`);for(;x<=I.e.r;++x){for(R=H[x]?' table:style-name="ro'+H[x].ods+'"':"",v.push("        <table:table-row"+R+`>
`),b=0;b<I.s.c;++b)v.push(t);for(;b<=I.e.c;++b){var q=!1,te={},J="";for(L=0;L!=M.length;++L)if(!(M[L].s.c>b)&&!(M[L].s.r>x)&&!(M[L].e.c<b)&&!(M[L].e.r<x)){(M[L].s.c!=b||M[L].s.r!=x)&&(q=!0),te["table:number-columns-spanned"]=M[L].e.c-M[L].s.c+1,te["table:number-rows-spanned"]=M[L].e.r-M[L].s.r+1;break}if(q){v.push(r);continue}var se=gs({r:x,c:b}),ye=U?(u[x]||[])[b]:u[se];if(ye&&ye.f&&(te["table:formula"]=ms(Oee(ye.f)),ye.F&&ye.F.slice(0,se.length)==se)){var Se=_A(ye.F);te["table:number-matrix-columns-spanned"]=Se.e.c-Se.s.c+1,te["table:number-matrix-rows-spanned"]=Se.e.r-Se.s.r+1}if(!ye){v.push(t);continue}switch(ye.t){case"b":J=ye.v?"TRUE":"FALSE",te["office:value-type"]="boolean",te["office:boolean-value"]=ye.v?"true":"false";break;case"n":J=ye.w||String(ye.v||0),te["office:value-type"]="float",te["office:value"]=ye.v||0;break;case"s":case"str":J=ye.v==null?"":ye.v,te["office:value-type"]="string";break;case"d":J=ye.w||cf(ye.v).toISOString(),te["office:value-type"]="date",te["office:date-value"]=cf(ye.v).toISOString(),te["table:style-name"]="ce1";break;default:v.push(t);continue}var Be=e(J);if(ye.l&&ye.l.Target){var De=ye.l.Target;De=De.charAt(0)=="#"?"#"+Dee(De.slice(1)):De,De.charAt(0)!="#"&&!De.match(/^\w+:/)&&(De="../"+De),Be=On("text:a",Be,{"xlink:href":De.replace(/&/g,"&amp;")})}v.push("          "+On("table:table-cell",On("text:p",Be,{}),te)+`
`)}v.push(`        </table:table-row>
`)}return v.push(`      </table:table>
`),v.join("")},l=function(u,d){u.push(` <office:automatic-styles>
`),u.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),u.push(`   <number:month number:style="long"/>
`),u.push(`   <number:text>/</number:text>
`),u.push(`   <number:day number:style="long"/>
`),u.push(`   <number:text>/</number:text>
`),u.push(`   <number:year/>
`),u.push(`  </number:date-style>
`);var a=0;d.SheetNames.map(function(x){return d.Sheets[x]}).forEach(function(x){if(x&&x["!cols"]){for(var b=0;b<x["!cols"].length;++b)if(x["!cols"][b]){var I=x["!cols"][b];if(I.width==null&&I.wpx==null&&I.wch==null)continue;vI(I),I.ods=a;var M=x["!cols"][b].wpx+"px";u.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),u.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+M+`"/>
`),u.push(`  </style:style>
`),++a}}});var v=0;d.SheetNames.map(function(x){return d.Sheets[x]}).forEach(function(x){if(x&&x["!rows"]){for(var b=0;b<x["!rows"].length;++b)if(x["!rows"][b]){x["!rows"][b].ods=v;var I=x["!rows"][b].hpx+"px";u.push('  <style:style style:name="ro'+v+`" style:family="table-row">
`),u.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+I+`"/>
`),u.push(`  </style:style>
`),++v}}}),u.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),u.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),u.push(`  </style:style>
`),u.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),u.push(` </office:automatic-styles>
`)};return function(d,a){var v=[Wc],x=c1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),b=c1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(v.push("<office:document"+x+b+`>
`),v.push(S8().replace(/office:document-meta/g,"office:meta"))):v.push("<office:document-content"+x+`>
`),l(v,d),v.push(`  <office:body>
`),v.push(`    <office:spreadsheet>
`);for(var I=0;I!=d.SheetNames.length;++I)v.push(n(d.Sheets[d.SheetNames[I]],d,I));return v.push(`    </office:spreadsheet>
`),v.push(`  </office:body>
`),a.bookType=="fods"?v.push("</office:document>"):v.push("</office:document-content>"),v.join("")}}();function Az(e,t){if(t.bookType=="fods")return sO(e,t);var r=lI(),n="",l=[],u=[];return n="mimetype",Va(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Va(r,n,sO(e,t)),l.push([n,"text/xml"]),u.push([n,"ContentFile"]),n="styles.xml",Va(r,n,dne(e,t)),l.push([n,"text/xml"]),u.push([n,"StylesFile"]),n="meta.xml",Va(r,n,Wc+S8()),l.push([n,"text/xml"]),u.push([n,"MetadataFile"]),n="manifest.rdf",Va(r,n,CZ(u)),l.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Va(r,n,EZ(l)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function b2(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function pne(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Md(l1(e))}function mne(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Sg(e){var t=e.reduce(function(l,u){return l+u.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(l){r.set(l,n),n+=l.length}),r}function gne(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,l=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var u=0;l>=1;++u,l/=256)e[t+u]=l&255;e[t+15]|=r>=0?0:128}function u1(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function fs(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function V_(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function hu(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],l=u1(e,r),u=l&7;l=Math.floor(l/8);var d=0,a;if(l==0)break;switch(u){case 0:{for(var v=r[0];e[r[0]++]>=128;);a=e.slice(v,r[0])}break;case 5:d=4,a=e.slice(r[0],r[0]+d),r[0]+=d;break;case 1:d=8,a=e.slice(r[0],r[0]+d),r[0]+=d;break;case 2:d=u1(e,r),a=e.slice(r[0],r[0]+d),r[0]+=d;break;case 3:case 4:default:throw new Error("PB Type ".concat(u," for Field ").concat(l," at offset ").concat(n))}var x={data:a,type:u};t[l]==null?t[l]=[x]:t[l].push(x)}return t}function th(e){var t=[];return e.forEach(function(r,n){r.forEach(function(l){l.data&&(t.push(fs(n*8+l.type)),l.type==2&&t.push(fs(l.data.length)),t.push(l.data))})}),Sg(t)}function Id(e){for(var t,r=[],n=[0];n[0]<e.length;){var l=u1(e,n),u=hu(e.slice(n[0],n[0]+l));n[0]+=l;var d={id:V_(u[1][0].data),messages:[]};u[2].forEach(function(a){var v=hu(a.data),x=V_(v[3][0].data);d.messages.push({meta:v,data:e.slice(n[0],n[0]+x)}),n[0]+=x}),(t=u[3])!=null&&t[0]&&(d.merge=V_(u[3][0].data)>>>0>0),r.push(d)}return r}function g_(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:fs(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:fs(+!!r.merge),type:0}]);var l=[];r.messages.forEach(function(d){l.push(d.data),d.meta[3]=[{type:0,data:fs(d.data.length)}],n[2].push({data:th(d.meta),type:2})});var u=th(n);t.push(fs(u.length)),t.push(u),l.forEach(function(d){return t.push(d)})}),Sg(t)}function _ne(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=u1(t,r),l=[];r[0]<t.length;){var u=t[r[0]]&3;if(u==0){var d=t[r[0]++]>>2;if(d<60)++d;else{var a=d-59;d=t[r[0]],a>1&&(d|=t[r[0]+1]<<8),a>2&&(d|=t[r[0]+2]<<16),a>3&&(d|=t[r[0]+3]<<24),d>>>=0,d++,r[0]+=a}l.push(t.slice(r[0],r[0]+d)),r[0]+=d;continue}else{var v=0,x=0;if(u==1?(x=(t[r[0]]>>2&7)+4,v=(t[r[0]++]&224)<<3,v|=t[r[0]++]):(x=(t[r[0]++]>>2)+1,u==2?(v=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(v=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),l=[Sg(l)],v==0)throw new Error("Invalid offset 0");if(v>l[0].length)throw new Error("Invalid offset beyond length");if(x>=v)for(l.push(l[0].slice(-v)),x-=v;x>=l[l.length-1].length;)l.push(l[l.length-1]),x-=l[l.length-1].length;l.push(l[0].slice(-v,-v+x))}}var b=Sg(l);if(b.length!=n)throw new Error("Unexpected length: ".concat(b.length," != ").concat(n));return b}function Fd(e){for(var t=[],r=0;r<e.length;){var n=e[r++],l=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(_ne(n,e.slice(r,r+l))),r+=l}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Sg(t)}function __(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),l=new Uint8Array(4);t.push(l);var u=fs(n),d=u.length;t.push(u),n<=60?(d++,t.push(new Uint8Array([n-1<<2]))):n<=256?(d+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(d+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(d+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(d+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),d+=n,l[0]=0,l[1]=d&255,l[2]=d>>8&255,l[3]=d>>16&255,r+=n}return Sg(t)}function GB(e,t){var r=new Uint8Array(32),n=b2(r),l=12,u=0;switch(r[0]=5,e.t){case"n":r[1]=2,gne(r,l,e.v),u|=1,l+=16;break;case"b":r[1]=6,n.setFloat64(l,e.v?1:0,!0),u|=2,l+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(l,t.indexOf(e.v),!0),u|=8,l+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,u,!0),r.slice(0,l)}function KB(e,t){var r=new Uint8Array(32),n=b2(r),l=12,u=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(l,e.v,!0),u|=32,l+=8;break;case"b":r[2]=6,n.setFloat64(l,e.v?1:0,!0),u|=32,l+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(l,t.indexOf(e.v),!0),u|=16,l+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,u,!0),r.slice(0,l)}function og(e){var t=hu(e);return u1(t[1][0].data)}function vne(e,t,r){var n,l,u,d;if(!((n=e[6])!=null&&n[0])||!((l=e[7])!=null&&l[0]))throw"Mutation only works on post-BNC storages!";var a=((d=(u=e[8])==null?void 0:u[0])==null?void 0:d.data)&&V_(e[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var v=0,x=b2(e[7][0].data),b=0,I=[],M=b2(e[4][0].data),L=0,U=[],R=0;R<t.length;++R){if(t[R]==null){x.setUint16(R*2,65535,!0),M.setUint16(R*2,65535);continue}x.setUint16(R*2,b,!0),M.setUint16(R*2,L,!0);var H,q;switch(typeof t[R]){case"string":H=GB({t:"s",v:t[R]},r),q=KB({t:"s",v:t[R]},r);break;case"number":H=GB({t:"n",v:t[R]},r),q=KB({t:"n",v:t[R]},r);break;case"boolean":H=GB({t:"b",v:t[R]},r),q=KB({t:"b",v:t[R]},r);break;default:throw new Error("Unsupported value "+t[R])}I.push(H),b+=H.length,U.push(q),L+=q.length,++v}for(e[2][0].data=fs(v);R<e[7][0].data.length/2;++R)x.setUint16(R*2,65535,!0),M.setUint16(R*2,65535,!0);return e[6][0].data=Sg(I),e[3][0].data=Sg(U),v}function yne(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=_A(r["!ref"]);n.s.r=n.s.c=0;var l=!1;n.e.c>9&&(l=!0,n.e.c=9),n.e.r>49&&(l=!0,n.e.r=49),l&&console.error("The Numbers writer is currently limited to ".concat(Gc(n)));var u=E2(r,{range:n,header:1}),d=["~Sh33tJ5~"];u.forEach(function(Le){return Le.forEach(function(Fe){typeof Fe=="string"&&d.push(Fe)})});var a={},v=[],x=Es.read(t.numbers,{type:"base64"});x.FileIndex.map(function(Le,Fe){return[Le,x.FullPaths[Fe]]}).forEach(function(Le){var Fe=Le[0],Re=Le[1];if(Fe.type==2&&Fe.name.match(/\.iwa/)){var et=Fe.content,xt=Fd(et),Dt=Id(xt);Dt.forEach(function(pt){v.push(pt.id),a[pt.id]={deps:[],location:Re,type:V_(pt.messages[0].meta[1][0].data)}})}}),v.sort(function(Le,Fe){return Le-Fe});var b=v.filter(function(Le){return Le>1}).map(function(Le){return[Le,fs(Le)]});x.FileIndex.map(function(Le,Fe){return[Le,x.FullPaths[Fe]]}).forEach(function(Le){var Fe=Le[0];if(Le[1],!!Fe.name.match(/\.iwa/)){var Re=Id(Fd(Fe.content));Re.forEach(function(et){et.messages.forEach(function(xt){b.forEach(function(Dt){et.messages.some(function(pt){return V_(pt.meta[1][0].data)!=11006&&mne(pt.data,Dt[1])})&&a[Dt[0]].deps.push(et.id)})})})}});for(var I=Es.find(x,a[1].location),M=Id(Fd(I.content)),L,U=0;U<M.length;++U){var R=M[U];R.id==1&&(L=R)}var H=og(hu(L.messages[0].data)[1][0].data);for(I=Es.find(x,a[H].location),M=Id(Fd(I.content)),U=0;U<M.length;++U)R=M[U],R.id==H&&(L=R);for(H=og(hu(L.messages[0].data)[2][0].data),I=Es.find(x,a[H].location),M=Id(Fd(I.content)),U=0;U<M.length;++U)R=M[U],R.id==H&&(L=R);for(H=og(hu(L.messages[0].data)[2][0].data),I=Es.find(x,a[H].location),M=Id(Fd(I.content)),U=0;U<M.length;++U)R=M[U],R.id==H&&(L=R);var q=hu(L.messages[0].data);{q[6][0].data=fs(n.e.r+1),q[7][0].data=fs(n.e.c+1);var te=og(q[46][0].data),J=Es.find(x,a[te].location),se=Id(Fd(J.content));{for(var ye=0;ye<se.length&&se[ye].id!=te;++ye);if(se[ye].id!=te)throw"Bad ColumnRowUIDMapArchive";var Se=hu(se[ye].messages[0].data);Se[1]=[],Se[2]=[],Se[3]=[];for(var Be=0;Be<=n.e.c;++Be){var De=[];De[1]=De[2]=[{type:0,data:fs(Be+420690)}],Se[1].push({type:2,data:th(De)}),Se[2].push({type:0,data:fs(Be)}),Se[3].push({type:0,data:fs(Be)})}Se[4]=[],Se[5]=[],Se[6]=[];for(var we=0;we<=n.e.r;++we)De=[],De[1]=De[2]=[{type:0,data:fs(we+726270)}],Se[4].push({type:2,data:th(De)}),Se[5].push({type:0,data:fs(we)}),Se[6].push({type:0,data:fs(we)});se[ye].messages[0].data=th(Se)}J.content=__(g_(se)),J.size=J.content.length,delete q[46];var nt=hu(q[4][0].data);{nt[7][0].data=fs(n.e.r+1);var _e=hu(nt[1][0].data),Ie=og(_e[2][0].data);J=Es.find(x,a[Ie].location),se=Id(Fd(J.content));{if(se[0].id!=Ie)throw"Bad HeaderStorageBucket";var Ze=hu(se[0].messages[0].data);for(we=0;we<u.length;++we){var st=hu(Ze[2][0].data);st[1][0].data=fs(we),st[4][0].data=fs(u[we].length),Ze[2][we]={type:Ze[2][0].type,data:th(st)}}se[0].messages[0].data=th(Ze)}J.content=__(g_(se)),J.size=J.content.length;var Et=og(nt[2][0].data);J=Es.find(x,a[Et].location),se=Id(Fd(J.content));{if(se[0].id!=Et)throw"Bad HeaderStorageBucket";for(Ze=hu(se[0].messages[0].data),Be=0;Be<=n.e.c;++Be)st=hu(Ze[2][0].data),st[1][0].data=fs(Be),st[4][0].data=fs(n.e.r+1),Ze[2][Be]={type:Ze[2][0].type,data:th(st)};se[0].messages[0].data=th(Ze)}J.content=__(g_(se)),J.size=J.content.length;var Ut=og(nt[4][0].data);(function(){for(var Le=Es.find(x,a[Ut].location),Fe=Id(Fd(Le.content)),Re,et=0;et<Fe.length;++et){var xt=Fe[et];xt.id==Ut&&(Re=xt)}var Dt=hu(Re.messages[0].data);{Dt[3]=[];var pt=[];d.forEach(function(Zt,sn){pt[1]=[{type:0,data:fs(sn)}],pt[2]=[{type:0,data:fs(1)}],pt[3]=[{type:2,data:pne(Zt)}],Dt[3].push({type:2,data:th(pt)})})}Re.messages[0].data=th(Dt);var Ct=g_(Fe),mr=__(Ct);Le.content=mr,Le.size=Le.content.length})();var jt=hu(nt[3][0].data);{var bt=jt[1][0];delete jt[2];var Nt=hu(bt.data);{var ar=og(Nt[2][0].data);(function(){for(var Le=Es.find(x,a[ar].location),Fe=Id(Fd(Le.content)),Re,et=0;et<Fe.length;++et){var xt=Fe[et];xt.id==ar&&(Re=xt)}var Dt=hu(Re.messages[0].data);{delete Dt[6],delete jt[7];var pt=new Uint8Array(Dt[5][0].data);Dt[5]=[];for(var Ct=0,mr=0;mr<=n.e.r;++mr){var Zt=hu(pt);Ct+=vne(Zt,u[mr],d),Zt[1][0].data=fs(mr),Dt[5].push({data:th(Zt),type:2})}Dt[1]=[{type:0,data:fs(n.e.c+1)}],Dt[2]=[{type:0,data:fs(n.e.r+1)}],Dt[3]=[{type:0,data:fs(Ct)}],Dt[4]=[{type:0,data:fs(n.e.r+1)}]}Re.messages[0].data=th(Dt);var sn=g_(Fe),er=__(sn);Le.content=er,Le.size=Le.content.length})()}bt.data=th(Nt)}nt[3][0].data=th(jt)}q[4][0].data=th(nt)}L.messages[0].data=th(q);var lt=g_(M),ie=__(lt);return I.content=ie,I.size=I.content.length,x}function xne(e){return function(r){for(var n=0;n!=e.length;++n){var l=e[n];r[l[0]]===void 0&&(r[l[0]]=l[1]),l[2]==="n"&&(r[l[0]]=Number(r[l[0]]))}}}function EI(e){xne([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function wne(e,t){return t.bookType=="ods"?Az(e,t):t.bookType=="numbers"?yne(e,t):t.bookType=="xlsb"?bne(e,t):Ene(e,t)}function bne(e,t){D_=1024,e&&!e.SSF&&(e.SSF=Of(Jl)),e&&e.SSF&&(Sb(),Cb(e.SSF),t.revssf=Tb(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,$y?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=$8.indexOf(t.bookType)>-1,l=E8();EI(t=t||{});var u=lI(),d="",a=0;if(t.cellXfs=[],Lg(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",Va(u,d,T8(e.Props,t)),l.coreprops.push(d),As(t.rels,2,d,Ro.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var v=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&v.push(e.SheetNames[x]);e.Props.SheetNames=v}for(e.Props.Worksheets=e.Props.SheetNames.length,Va(u,d,F8(e.Props)),l.extprops.push(d),As(t.rels,3,d,Ro.EXT_PROPS),e.Custprops!==e.Props&&hh(e.Custprops||{}).length>0&&(d="docProps/custom.xml",Va(u,d,P8(e.Custprops)),l.custprops.push(d),As(t.rels,4,d,Ro.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var b={"!id":{}},I=e.Sheets[e.SheetNames[a-1]],M=(I||{})["!type"]||"sheet";switch(M){case"chart":default:d="xl/worksheets/sheet"+a+"."+r,Va(u,d,Cre(a-1,d,t,e,b)),l.sheets.push(d),As(t.wbrels,-1,"worksheets/sheet"+a+"."+r,Ro.WS[0])}if(I){var L=I["!comments"],U=!1,R="";L&&L.length>0&&(R="xl/comments"+a+"."+r,Va(u,R,Ire(L,R)),l.comments.push(R),As(b,-1,"../comments"+a+"."+r,Ro.CMNT),U=!0),I["!legacy"]&&U&&Va(u,"xl/drawings/vmlDrawing"+a+".vml",W8(a,I["!comments"])),delete I["!comments"],delete I["!legacy"]}b["!id"].rId1&&Va(u,C8(d),j_(b))}return t.Strings!=null&&t.Strings.length>0&&(d="xl/sharedStrings."+r,Va(u,d,Tre(t.Strings,d,t)),l.strs.push(d),As(t.wbrels,-1,"sharedStrings."+r,Ro.SST)),d="xl/workbook."+r,Va(u,d,Bre(e,d)),l.workbooks.push(d),As(t.rels,1,d,Ro.WB),d="xl/theme/theme1.xml",Va(u,d,G8(e.Themes,t)),l.themes.push(d),As(t.wbrels,-1,"theme/theme1.xml",Ro.THEME),d="xl/styles."+r,Va(u,d,Sre(e,d,t)),l.styles.push(d),As(t.wbrels,-1,"styles."+r,Ro.STY),e.vbaraw&&n&&(d="xl/vbaProject.bin",Va(u,d,e.vbaraw),l.vba.push(d),As(t.wbrels,-1,"vbaProject.bin",Ro.VBA)),d="xl/metadata."+r,Va(u,d,Fre(d)),l.metadata.push(d),As(t.wbrels,-1,"metadata."+r,Ro.XLMETA),Va(u,"[Content_Types].xml",B8(l,t)),Va(u,"_rels/.rels",j_(t.rels)),Va(u,"xl/_rels/workbook."+r+".rels",j_(t.wbrels)),delete t.revssf,delete t.ssf,u}function Ene(e,t){D_=1024,e&&!e.SSF&&(e.SSF=Of(Jl)),e&&e.SSF&&(Sb(),Cb(e.SSF),t.revssf=Tb(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,$y?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=$8.indexOf(t.bookType)>-1,l=E8();EI(t=t||{});var u=lI(),d="",a=0;if(t.cellXfs=[],Lg(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",Va(u,d,T8(e.Props,t)),l.coreprops.push(d),As(t.rels,2,d,Ro.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var v=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&v.push(e.SheetNames[x]);e.Props.SheetNames=v}e.Props.Worksheets=e.Props.SheetNames.length,Va(u,d,F8(e.Props)),l.extprops.push(d),As(t.rels,3,d,Ro.EXT_PROPS),e.Custprops!==e.Props&&hh(e.Custprops||{}).length>0&&(d="docProps/custom.xml",Va(u,d,P8(e.Custprops)),l.custprops.push(d),As(t.rels,4,d,Ro.CUST_PROPS));var b=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var I={"!id":{}},M=e.Sheets[e.SheetNames[a-1]],L=(M||{})["!type"]||"sheet";switch(L){case"chart":default:d="xl/worksheets/sheet"+a+"."+r,Va(u,d,iz(a-1,t,e,I)),l.sheets.push(d),As(t.wbrels,-1,"worksheets/sheet"+a+"."+r,Ro.WS[0])}if(M){var U=M["!comments"],R=!1,H="";if(U&&U.length>0){var q=!1;U.forEach(function(te){te[1].forEach(function(J){J.T==!0&&(q=!0)})}),q&&(H="xl/threadedComments/threadedComment"+a+"."+r,Va(u,H,tJ(U,b,t)),l.threadedcomments.push(H),As(I,-1,"../threadedComments/threadedComment"+a+"."+r,Ro.TCMNT)),H="xl/comments"+a+"."+r,Va(u,H,q8(U)),l.comments.push(H),As(I,-1,"../comments"+a+"."+r,Ro.CMNT),R=!0}M["!legacy"]&&R&&Va(u,"xl/drawings/vmlDrawing"+a+".vml",W8(a,M["!comments"])),delete M["!comments"],delete M["!legacy"]}I["!id"].rId1&&Va(u,C8(d),j_(I))}return t.Strings!=null&&t.Strings.length>0&&(d="xl/sharedStrings."+r,Va(u,d,N8(t.Strings,t)),l.strs.push(d),As(t.wbrels,-1,"sharedStrings."+r,Ro.SST)),d="xl/workbook."+r,Va(u,d,sz(e)),l.workbooks.push(d),As(t.rels,1,d,Ro.WB),d="xl/theme/theme1.xml",Va(u,d,G8(e.Themes,t)),l.themes.push(d),As(t.wbrels,-1,"theme/theme1.xml",Ro.THEME),d="xl/styles."+r,Va(u,d,H8(e,t)),l.styles.push(d),As(t.wbrels,-1,"styles."+r,Ro.STY),e.vbaraw&&n&&(d="xl/vbaProject.bin",Va(u,d,e.vbaraw),l.vba.push(d),As(t.wbrels,-1,"vbaProject.bin",Ro.VBA)),d="xl/metadata."+r,Va(u,d,K8()),l.metadata.push(d),As(t.wbrels,-1,"metadata."+r,Ro.XLMETA),b.length>1&&(d="xl/persons/person.xml",Va(u,d,rJ(b)),l.people.push(d),As(t.wbrels,-1,"persons/person.xml",Ro.PEOPLE)),Va(u,"[Content_Types].xml",B8(l,t)),Va(u,"_rels/.rels",j_(t.rels)),Va(u,"xl/_rels/workbook."+r+".rels",j_(t.wbrels)),delete t.revssf,delete t.ssf,u}function Bne(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Am(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function dz(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return F1(t.file,Es.write(e,{type:Jo?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Es.write(e,t)}function Cne(e,t){var r=Of(t||{}),n=wne(e,r);return Sne(n,r)}function Sne(e,t){var r={},n=Jo?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var l=e.FullPaths?Es.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof l=="string"){if(t.type=="binary"||t.type=="base64")return l;l=new Uint8Array(Bb(l))}return t.password&&typeof encrypt_agile<"u"?dz(encrypt_agile(l,t.password),t):t.type==="file"?F1(t.file,l):t.type=="string"?Gy(l):l}function Tne(e,t){var r=t||{},n=Vre(e,r);return dz(n,r)}function bp(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return o1(l1(n));case"binary":return l1(n);case"string":return e;case"file":return F1(t.file,n,"utf8");case"buffer":return Jo?xm(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):bp(n,{type:"binary"}).split("").map(function(l){return l.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ine(e,t){switch(t.type){case"base64":return o1(e);case"binary":return e;case"string":return e;case"file":return F1(t.file,e,"binary");case"buffer":return Jo?xm(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function tw(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?o1(r):t.type=="string"?Gy(r):r;case"file":return F1(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function pz(e,t){nX(),dre(e);var r=Of(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=pz(e,r);return r.type="array",Bb(n)}var l=0;if(r.sheet&&(typeof r.sheet=="number"?l=r.sheet:l=e.SheetNames.indexOf(r.sheet),!e.SheetNames[l]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return bp(jre(e,r),r);case"slk":case"sylk":return bp(hY.from_sheet(e.Sheets[e.SheetNames[l]],r),r);case"htm":case"html":return bp(uz(e.Sheets[e.SheetNames[l]],r),r);case"txt":return Ine(mz(e.Sheets[e.SheetNames[l]],r),r);case"csv":return bp(BI(e.Sheets[e.SheetNames[l]],r),r,"\uFEFF");case"dif":return bp(fY.from_sheet(e.Sheets[e.SheetNames[l]],r),r);case"dbf":return tw(uY.from_sheet(e.Sheets[e.SheetNames[l]],r),r);case"prn":return bp(AY.from_sheet(e.Sheets[e.SheetNames[l]],r),r);case"rtf":return bp(yY.from_sheet(e.Sheets[e.SheetNames[l]],r),r);case"eth":return bp(U8.from_sheet(e.Sheets[e.SheetNames[l]],r),r);case"fods":return bp(Az(e,r),r);case"wk1":return tw(eO.sheet_to_wk1(e.Sheets[e.SheetNames[l]],r),r);case"wk3":return tw(eO.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),tw(cz(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Tne(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Cne(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Fne(e,t,r,n,l,u,d,a){var v=uh(r),x=a.defval,b=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),I=!0,M=l===1?[]:{};if(l!==1)if(Object.defineProperty)try{Object.defineProperty(M,"__rowNum__",{value:r,enumerable:!1})}catch{M.__rowNum__=r}else M.__rowNum__=r;if(!d||e[r])for(var L=t.s.c;L<=t.e.c;++L){var U=d?e[r][L]:e[n[L]+v];if(U===void 0||U.t===void 0){if(x===void 0)continue;u[L]!=null&&(M[u[L]]=x);continue}var R=U.v;switch(U.t){case"z":if(R==null)break;continue;case"e":R=R==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+U.t)}if(u[L]!=null){if(R==null)if(U.t=="e"&&R===null)M[u[L]]=null;else if(x!==void 0)M[u[L]]=x;else if(b&&R===null)M[u[L]]=null;else continue;else M[u[L]]=b&&(U.t!=="n"||U.t==="n"&&a.rawNumbers!==!1)?R:dm(U,R,a);R!=null&&(I=!1)}}return{row:M,isempty:I}}function E2(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,l=1,u=[],d=0,a="",v={s:{r:0,c:0},e:{r:0,c:0}},x=t||{},b=x.range!=null?x.range:e["!ref"];switch(x.header===1?n=1:x.header==="A"?n=2:Array.isArray(x.header)?n=3:x.header==null&&(n=0),typeof b){case"string":v=ol(b);break;case"number":v=ol(e["!ref"]),v.s.r=b;break;default:v=b}n>0&&(l=0);var I=uh(v.s.r),M=[],L=[],U=0,R=0,H=Array.isArray(e),q=v.s.r,te=0,J={};H&&!e[q]&&(e[q]=[]);var se=x.skipHidden&&e["!cols"]||[],ye=x.skipHidden&&e["!rows"]||[];for(te=v.s.c;te<=v.e.c;++te)if(!(se[te]||{}).hidden)switch(M[te]=kh(te),r=H?e[q][te]:e[M[te]+I],n){case 1:u[te]=te-v.s.c;break;case 2:u[te]=M[te];break;case 3:u[te]=x.header[te-v.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=d=dm(r,null,x),R=J[d]||0,!R)J[d]=1;else{do a=d+"_"+R++;while(J[a]);J[d]=R,J[a]=1}u[te]=a}for(q=v.s.r+l;q<=v.e.r;++q)if(!(ye[q]||{}).hidden){var Se=Fne(e,v,q,M,n,u,H,x);(Se.isempty===!1||(n===1?x.blankrows!==!1:x.blankrows))&&(L[U++]=Se.row)}return L.length=U,L}var lO=/"/g;function Pne(e,t,r,n,l,u,d,a){for(var v=!0,x=[],b="",I=uh(r),M=t.s.c;M<=t.e.c;++M)if(n[M]){var L=a.dense?(e[r]||[])[M]:e[n[M]+I];if(L==null)b="";else if(L.v!=null){v=!1,b=""+(a.rawNumbers&&L.t=="n"?L.v:dm(L,null,a));for(var U=0,R=0;U!==b.length;++U)if((R=b.charCodeAt(U))===l||R===u||R===34||a.forceQuotes){b='"'+b.replace(lO,'""')+'"';break}b=="ID"&&(b='"ID"')}else L.f!=null&&!L.F?(v=!1,b="="+L.f,b.indexOf(",")>=0&&(b='"'+b.replace(lO,'""')+'"')):b="";x.push(b)}return a.blankrows===!1&&v?null:x.join(d)}function BI(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var l=ol(e["!ref"]),u=n.FS!==void 0?n.FS:",",d=u.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,v=a.charCodeAt(0),x=new RegExp((u=="|"?"\\|":u)+"+$"),b="",I=[];n.dense=Array.isArray(e);for(var M=n.skipHidden&&e["!cols"]||[],L=n.skipHidden&&e["!rows"]||[],U=l.s.c;U<=l.e.c;++U)(M[U]||{}).hidden||(I[U]=kh(U));for(var R=0,H=l.s.r;H<=l.e.r;++H)(L[H]||{}).hidden||(b=Pne(e,l,H,I,d,v,u,n),b!=null&&(n.strip&&(b=b.replace(x,"")),(b||n.blankrows!==!1)&&r.push((R++?a:"")+b)));return delete n.dense,r.join("")}function mz(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=BI(e,t);return r}function Lne(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var l=ol(e["!ref"]),u="",d=[],a,v=[],x=Array.isArray(e);for(a=l.s.c;a<=l.e.c;++a)d[a]=kh(a);for(var b=l.s.r;b<=l.e.r;++b)for(u=uh(b),a=l.s.c;a<=l.e.c;++a)if(t=d[a]+u,r=x?(e[b]||[])[a]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}v[v.length]=t+"="+n}return v}function gz(e,t,r){var n=r||{},l=+!n.skipHeader,u=e||{},d=0,a=0;if(u&&n.origin!=null)if(typeof n.origin=="number")d=n.origin;else{var v=typeof n.origin=="string"?zu(n.origin):n.origin;d=v.r,a=v.c}var x,b={s:{c:0,r:0},e:{c:a,r:d+t.length-1+l}};if(u["!ref"]){var I=ol(u["!ref"]);b.e.c=Math.max(b.e.c,I.e.c),b.e.r=Math.max(b.e.r,I.e.r),d==-1&&(d=I.e.r+1,b.e.r=d+t.length-1+l)}else d==-1&&(d=0,b.e.r=t.length-1+l);var M=n.header||[],L=0;t.forEach(function(R,H){hh(R).forEach(function(q){(L=M.indexOf(q))==-1&&(M[L=M.length]=q);var te=R[q],J="z",se="",ye=gs({c:a+L,r:d+H+l});x=h1(u,ye),te&&typeof te=="object"&&!(te instanceof Date)?u[ye]=te:(typeof te=="number"?J="n":typeof te=="boolean"?J="b":typeof te=="string"?J="s":te instanceof Date?(J="d",n.cellDates||(J="n",te=Mf(te)),se=n.dateNF||Jl[14]):te===null&&n.nullError&&(J="e",te=0),x?(x.t=J,x.v=te,delete x.w,delete x.R,se&&(x.z=se)):u[ye]=x={t:J,v:te},se&&(x.z=se))})}),b.e.c=Math.max(b.e.c,a+M.length-1);var U=uh(d);if(l)for(L=0;L<M.length;++L)u[kh(L+a)+U]={t:"s",v:M[L]};return u["!ref"]=Gc(b),u}function Mne(e,t){return gz(null,e,t)}function h1(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=zu(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?h1(e,gs(t)):h1(e,gs({r:t,c:r||0}))}function One(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Dne(){return{SheetNames:[],Sheets:{}}}function Rne(e,t,r,n){var l=1;if(!r)for(;l<=65535&&e.SheetNames.indexOf(r="Sheet"+l)!=-1;++l,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var u=r.match(/(^.*?)(\d+)$/);l=u&&+u[2]||0;var d=u&&u[1]||r;for(++l;l<=65535&&e.SheetNames.indexOf(r=d+l)!=-1;++l);}if(oz(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function kne(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=One(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Une(e,t){return e.z=t,e}function _z(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Nne(e,t,r){return _z(e,"#"+t,r)}function zne(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Qne(e,t,r,n){for(var l=typeof t!="string"?t:ol(t),u=typeof t=="string"?t:Gc(t),d=l.s.r;d<=l.e.r;++d)for(var a=l.s.c;a<=l.e.c;++a){var v=h1(e,d,a);v.t="n",v.F=u,delete v.v,d==l.s.r&&a==l.s.c&&(v.f=r,n&&(v.D=!0))}return e}var WB={encode_col:kh,encode_row:uh,encode_cell:gs,encode_range:Gc,decode_col:dI,decode_row:AI,split_cell:nZ,decode_cell:zu,decode_range:_A,format_cell:dm,sheet_add_aoa:_8,sheet_add_json:gz,sheet_add_dom:hz,aoa_to_sheet:mv,json_to_sheet:Mne,table_to_sheet:fz,table_to_book:fne,sheet_to_csv:BI,sheet_to_txt:mz,sheet_to_json:E2,sheet_to_html:uz,sheet_to_formulae:Lne,sheet_to_row_object_array:E2,sheet_get_cell:h1,book_new:Dne,book_append_sheet:Rne,book_set_sheet_visibility:kne,cell_set_number_format:Une,cell_set_hyperlink:_z,cell_set_internal_link:Nne,cell_add_comment:zne,sheet_set_array_formula:Qne,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Zw={exports:{}},jne=Zw.exports,cO;function Hne(){return cO||(cO=1,function(e,t){(function(r,n){n()})(jne,function(){function r(x,b){return typeof b>"u"?b={autoBom:!1}:typeof b!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob(["\uFEFF",x],{type:x.type}):x}function n(x,b,I){var M=new XMLHttpRequest;M.open("GET",x),M.responseType="blob",M.onload=function(){v(M.response,b,I)},M.onerror=function(){console.error("could not download file")},M.send()}function l(x){var b=new XMLHttpRequest;b.open("HEAD",x,!1);try{b.send()}catch{}return 200<=b.status&&299>=b.status}function u(x){try{x.dispatchEvent(new MouseEvent("click"))}catch{var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),x.dispatchEvent(b)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Vx=="object"&&Vx.global===Vx?Vx:void 0,a=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(x,b,I){var M=d.URL||d.webkitURL,L=document.createElement("a");b=b||x.name||"download",L.download=b,L.rel="noopener",typeof x=="string"?(L.href=x,L.origin===location.origin?u(L):l(L.href)?n(x,b,I):u(L,L.target="_blank")):(L.href=M.createObjectURL(x),setTimeout(function(){M.revokeObjectURL(L.href)},4e4),setTimeout(function(){u(L)},0))}:"msSaveOrOpenBlob"in navigator?function(x,b,I){if(b=b||x.name||"download",typeof x!="string")navigator.msSaveOrOpenBlob(r(x,I),b);else if(l(x))n(x,b,I);else{var M=document.createElement("a");M.href=x,M.target="_blank",setTimeout(function(){u(M)})}}:function(x,b,I,M){if(M=M||open("","_blank"),M&&(M.document.title=M.document.body.innerText="downloading..."),typeof x=="string")return n(x,b,I);var L=x.type==="application/octet-stream",U=/constructor/i.test(d.HTMLElement)||d.safari,R=/CriOS\/[\d]+/.test(navigator.userAgent);if((R||L&&U||a)&&typeof FileReader<"u"){var H=new FileReader;H.onloadend=function(){var J=H.result;J=R?J:J.replace(/^data:[^;]*;/,"data:attachment/file;"),M?M.location.href=J:location=J,M=null},H.readAsDataURL(x)}else{var q=d.URL||d.webkitURL,te=q.createObjectURL(x);M?M.location=te:location.href=te,M=null,setTimeout(function(){q.revokeObjectURL(te)},4e4)}});d.saveAs=v.saveAs=v,e.exports=v})}(Zw)),Zw.exports}var Vne=Hne(),Gne=Object.defineProperty,B2=Object.getOwnPropertySymbols,vz=Object.prototype.hasOwnProperty,yz=Object.prototype.propertyIsEnumerable,uO=(e,t,r)=>t in e?Gne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,CT=(e,t)=>{for(var r in t||(t={}))vz.call(t,r)&&uO(e,r,t[r]);if(B2)for(var r of B2(t))yz.call(t,r)&&uO(e,r,t[r]);return e},ST=(e,t)=>{var r={};for(var n in e)vz.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&B2)for(var n of B2(e))t.indexOf(n)<0&&yz.call(e,n)&&(r[n]=e[n]);return r};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var S0;(e=>{const t=class ao{constructor(v,x,b,I){if(this.version=v,this.errorCorrectionLevel=x,this.modules=[],this.isFunction=[],v<ao.MIN_VERSION||v>ao.MAX_VERSION)throw new RangeError("Version value out of range");if(I<-1||I>7)throw new RangeError("Mask value out of range");this.size=v*4+17;let M=[];for(let U=0;U<this.size;U++)M.push(!1);for(let U=0;U<this.size;U++)this.modules.push(M.slice()),this.isFunction.push(M.slice());this.drawFunctionPatterns();const L=this.addEccAndInterleave(b);if(this.drawCodewords(L),I==-1){let U=1e9;for(let R=0;R<8;R++){this.applyMask(R),this.drawFormatBits(R);const H=this.getPenaltyScore();H<U&&(I=R,U=H),this.applyMask(R)}}l(0<=I&&I<=7),this.mask=I,this.applyMask(I),this.drawFormatBits(I),this.isFunction=[]}static encodeText(v,x){const b=e.QrSegment.makeSegments(v);return ao.encodeSegments(b,x)}static encodeBinary(v,x){const b=e.QrSegment.makeBytes(v);return ao.encodeSegments([b],x)}static encodeSegments(v,x,b=1,I=40,M=-1,L=!0){if(!(ao.MIN_VERSION<=b&&b<=I&&I<=ao.MAX_VERSION)||M<-1||M>7)throw new RangeError("Invalid value");let U,R;for(U=b;;U++){const J=ao.getNumDataCodewords(U,x)*8,se=d.getTotalBits(v,U);if(se<=J){R=se;break}if(U>=I)throw new RangeError("Data too long")}for(const J of[ao.Ecc.MEDIUM,ao.Ecc.QUARTILE,ao.Ecc.HIGH])L&&R<=ao.getNumDataCodewords(U,J)*8&&(x=J);let H=[];for(const J of v){r(J.mode.modeBits,4,H),r(J.numChars,J.mode.numCharCountBits(U),H);for(const se of J.getData())H.push(se)}l(H.length==R);const q=ao.getNumDataCodewords(U,x)*8;l(H.length<=q),r(0,Math.min(4,q-H.length),H),r(0,(8-H.length%8)%8,H),l(H.length%8==0);for(let J=236;H.length<q;J^=253)r(J,8,H);let te=[];for(;te.length*8<H.length;)te.push(0);return H.forEach((J,se)=>te[se>>>3]|=J<<7-(se&7)),new ao(U,x,te,M)}getModule(v,x){return 0<=v&&v<this.size&&0<=x&&x<this.size&&this.modules[x][v]}getModules(){return this.modules}drawFunctionPatterns(){for(let b=0;b<this.size;b++)this.setFunctionModule(6,b,b%2==0),this.setFunctionModule(b,6,b%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const v=this.getAlignmentPatternPositions(),x=v.length;for(let b=0;b<x;b++)for(let I=0;I<x;I++)b==0&&I==0||b==0&&I==x-1||b==x-1&&I==0||this.drawAlignmentPattern(v[b],v[I]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(v){const x=this.errorCorrectionLevel.formatBits<<3|v;let b=x;for(let M=0;M<10;M++)b=b<<1^(b>>>9)*1335;const I=(x<<10|b)^21522;l(I>>>15==0);for(let M=0;M<=5;M++)this.setFunctionModule(8,M,n(I,M));this.setFunctionModule(8,7,n(I,6)),this.setFunctionModule(8,8,n(I,7)),this.setFunctionModule(7,8,n(I,8));for(let M=9;M<15;M++)this.setFunctionModule(14-M,8,n(I,M));for(let M=0;M<8;M++)this.setFunctionModule(this.size-1-M,8,n(I,M));for(let M=8;M<15;M++)this.setFunctionModule(8,this.size-15+M,n(I,M));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let v=this.version;for(let b=0;b<12;b++)v=v<<1^(v>>>11)*7973;const x=this.version<<12|v;l(x>>>18==0);for(let b=0;b<18;b++){const I=n(x,b),M=this.size-11+b%3,L=Math.floor(b/3);this.setFunctionModule(M,L,I),this.setFunctionModule(L,M,I)}}drawFinderPattern(v,x){for(let b=-4;b<=4;b++)for(let I=-4;I<=4;I++){const M=Math.max(Math.abs(I),Math.abs(b)),L=v+I,U=x+b;0<=L&&L<this.size&&0<=U&&U<this.size&&this.setFunctionModule(L,U,M!=2&&M!=4)}}drawAlignmentPattern(v,x){for(let b=-2;b<=2;b++)for(let I=-2;I<=2;I++)this.setFunctionModule(v+I,x+b,Math.max(Math.abs(I),Math.abs(b))!=1)}setFunctionModule(v,x,b){this.modules[x][v]=b,this.isFunction[x][v]=!0}addEccAndInterleave(v){const x=this.version,b=this.errorCorrectionLevel;if(v.length!=ao.getNumDataCodewords(x,b))throw new RangeError("Invalid argument");const I=ao.NUM_ERROR_CORRECTION_BLOCKS[b.ordinal][x],M=ao.ECC_CODEWORDS_PER_BLOCK[b.ordinal][x],L=Math.floor(ao.getNumRawDataModules(x)/8),U=I-L%I,R=Math.floor(L/I);let H=[];const q=ao.reedSolomonComputeDivisor(M);for(let J=0,se=0;J<I;J++){let ye=v.slice(se,se+R-M+(J<U?0:1));se+=ye.length;const Se=ao.reedSolomonComputeRemainder(ye,q);J<U&&ye.push(0),H.push(ye.concat(Se))}let te=[];for(let J=0;J<H[0].length;J++)H.forEach((se,ye)=>{(J!=R-M||ye>=U)&&te.push(se[J])});return l(te.length==L),te}drawCodewords(v){if(v.length!=Math.floor(ao.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let x=0;for(let b=this.size-1;b>=1;b-=2){b==6&&(b=5);for(let I=0;I<this.size;I++)for(let M=0;M<2;M++){const L=b-M,R=(b+1&2)==0?this.size-1-I:I;!this.isFunction[R][L]&&x<v.length*8&&(this.modules[R][L]=n(v[x>>>3],7-(x&7)),x++)}}l(x==v.length*8)}applyMask(v){if(v<0||v>7)throw new RangeError("Mask value out of range");for(let x=0;x<this.size;x++)for(let b=0;b<this.size;b++){let I;switch(v){case 0:I=(b+x)%2==0;break;case 1:I=x%2==0;break;case 2:I=b%3==0;break;case 3:I=(b+x)%3==0;break;case 4:I=(Math.floor(b/3)+Math.floor(x/2))%2==0;break;case 5:I=b*x%2+b*x%3==0;break;case 6:I=(b*x%2+b*x%3)%2==0;break;case 7:I=((b+x)%2+b*x%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[x][b]&&I&&(this.modules[x][b]=!this.modules[x][b])}}getPenaltyScore(){let v=0;for(let M=0;M<this.size;M++){let L=!1,U=0,R=[0,0,0,0,0,0,0];for(let H=0;H<this.size;H++)this.modules[M][H]==L?(U++,U==5?v+=ao.PENALTY_N1:U>5&&v++):(this.finderPenaltyAddHistory(U,R),L||(v+=this.finderPenaltyCountPatterns(R)*ao.PENALTY_N3),L=this.modules[M][H],U=1);v+=this.finderPenaltyTerminateAndCount(L,U,R)*ao.PENALTY_N3}for(let M=0;M<this.size;M++){let L=!1,U=0,R=[0,0,0,0,0,0,0];for(let H=0;H<this.size;H++)this.modules[H][M]==L?(U++,U==5?v+=ao.PENALTY_N1:U>5&&v++):(this.finderPenaltyAddHistory(U,R),L||(v+=this.finderPenaltyCountPatterns(R)*ao.PENALTY_N3),L=this.modules[H][M],U=1);v+=this.finderPenaltyTerminateAndCount(L,U,R)*ao.PENALTY_N3}for(let M=0;M<this.size-1;M++)for(let L=0;L<this.size-1;L++){const U=this.modules[M][L];U==this.modules[M][L+1]&&U==this.modules[M+1][L]&&U==this.modules[M+1][L+1]&&(v+=ao.PENALTY_N2)}let x=0;for(const M of this.modules)x=M.reduce((L,U)=>L+(U?1:0),x);const b=this.size*this.size,I=Math.ceil(Math.abs(x*20-b*10)/b)-1;return l(0<=I&&I<=9),v+=I*ao.PENALTY_N4,l(0<=v&&v<=2568888),v}getAlignmentPatternPositions(){if(this.version==1)return[];{const v=Math.floor(this.version/7)+2,x=this.version==32?26:Math.ceil((this.version*4+4)/(v*2-2))*2;let b=[6];for(let I=this.size-7;b.length<v;I-=x)b.splice(1,0,I);return b}}static getNumRawDataModules(v){if(v<ao.MIN_VERSION||v>ao.MAX_VERSION)throw new RangeError("Version number out of range");let x=(16*v+128)*v+64;if(v>=2){const b=Math.floor(v/7)+2;x-=(25*b-10)*b-55,v>=7&&(x-=36)}return l(208<=x&&x<=29648),x}static getNumDataCodewords(v,x){return Math.floor(ao.getNumRawDataModules(v)/8)-ao.ECC_CODEWORDS_PER_BLOCK[x.ordinal][v]*ao.NUM_ERROR_CORRECTION_BLOCKS[x.ordinal][v]}static reedSolomonComputeDivisor(v){if(v<1||v>255)throw new RangeError("Degree out of range");let x=[];for(let I=0;I<v-1;I++)x.push(0);x.push(1);let b=1;for(let I=0;I<v;I++){for(let M=0;M<x.length;M++)x[M]=ao.reedSolomonMultiply(x[M],b),M+1<x.length&&(x[M]^=x[M+1]);b=ao.reedSolomonMultiply(b,2)}return x}static reedSolomonComputeRemainder(v,x){let b=x.map(I=>0);for(const I of v){const M=I^b.shift();b.push(0),x.forEach((L,U)=>b[U]^=ao.reedSolomonMultiply(L,M))}return b}static reedSolomonMultiply(v,x){if(v>>>8||x>>>8)throw new RangeError("Byte out of range");let b=0;for(let I=7;I>=0;I--)b=b<<1^(b>>>7)*285,b^=(x>>>I&1)*v;return l(b>>>8==0),b}finderPenaltyCountPatterns(v){const x=v[1];l(x<=this.size*3);const b=x>0&&v[2]==x&&v[3]==x*3&&v[4]==x&&v[5]==x;return(b&&v[0]>=x*4&&v[6]>=x?1:0)+(b&&v[6]>=x*4&&v[0]>=x?1:0)}finderPenaltyTerminateAndCount(v,x,b){return v&&(this.finderPenaltyAddHistory(x,b),x=0),x+=this.size,this.finderPenaltyAddHistory(x,b),this.finderPenaltyCountPatterns(b)}finderPenaltyAddHistory(v,x){x[0]==0&&(v+=this.size),x.pop(),x.unshift(v)}};t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;function r(a,v,x){if(v<0||v>31||a>>>v)throw new RangeError("Value out of range");for(let b=v-1;b>=0;b--)x.push(a>>>b&1)}function n(a,v){return(a>>>v&1)!=0}function l(a){if(!a)throw new Error("Assertion error")}const u=class ql{constructor(v,x,b){if(this.mode=v,this.numChars=x,this.bitData=b,x<0)throw new RangeError("Invalid argument");this.bitData=b.slice()}static makeBytes(v){let x=[];for(const b of v)r(b,8,x);return new ql(ql.Mode.BYTE,v.length,x)}static makeNumeric(v){if(!ql.isNumeric(v))throw new RangeError("String contains non-numeric characters");let x=[];for(let b=0;b<v.length;){const I=Math.min(v.length-b,3);r(parseInt(v.substring(b,b+I),10),I*3+1,x),b+=I}return new ql(ql.Mode.NUMERIC,v.length,x)}static makeAlphanumeric(v){if(!ql.isAlphanumeric(v))throw new RangeError("String contains unencodable characters in alphanumeric mode");let x=[],b;for(b=0;b+2<=v.length;b+=2){let I=ql.ALPHANUMERIC_CHARSET.indexOf(v.charAt(b))*45;I+=ql.ALPHANUMERIC_CHARSET.indexOf(v.charAt(b+1)),r(I,11,x)}return b<v.length&&r(ql.ALPHANUMERIC_CHARSET.indexOf(v.charAt(b)),6,x),new ql(ql.Mode.ALPHANUMERIC,v.length,x)}static makeSegments(v){return v==""?[]:ql.isNumeric(v)?[ql.makeNumeric(v)]:ql.isAlphanumeric(v)?[ql.makeAlphanumeric(v)]:[ql.makeBytes(ql.toUtf8ByteArray(v))]}static makeEci(v){let x=[];if(v<0)throw new RangeError("ECI assignment value out of range");if(v<128)r(v,8,x);else if(v<16384)r(2,2,x),r(v,14,x);else if(v<1e6)r(6,3,x),r(v,21,x);else throw new RangeError("ECI assignment value out of range");return new ql(ql.Mode.ECI,0,x)}static isNumeric(v){return ql.NUMERIC_REGEX.test(v)}static isAlphanumeric(v){return ql.ALPHANUMERIC_REGEX.test(v)}getData(){return this.bitData.slice()}static getTotalBits(v,x){let b=0;for(const I of v){const M=I.mode.numCharCountBits(x);if(I.numChars>=1<<M)return 1/0;b+=4+M+I.bitData.length}return b}static toUtf8ByteArray(v){v=encodeURI(v);let x=[];for(let b=0;b<v.length;b++)v.charAt(b)!="%"?x.push(v.charCodeAt(b)):(x.push(parseInt(v.substring(b+1,b+3),16)),b+=2);return x}};u.NUMERIC_REGEX=/^[0-9]*$/,u.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,u.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let d=u;e.QrSegment=u})(S0||(S0={}));(e=>{(t=>{const r=class{constructor(l,u){this.ordinal=l,this.formatBits=u}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),t.Ecc=r})(e.QrCode||(e.QrCode={}))})(S0||(S0={}));(e=>{(t=>{const r=class{constructor(l,u){this.modeBits=l,this.numBitsCharCount=u}numCharCountBits(l){return this.numBitsCharCount[Math.floor((l+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),t.Mode=r})(e.QrSegment||(e.QrSegment={}))})(S0||(S0={}));var R_=S0;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Kne={L:R_.QrCode.Ecc.LOW,M:R_.QrCode.Ecc.MEDIUM,Q:R_.QrCode.Ecc.QUARTILE,H:R_.QrCode.Ecc.HIGH},xz=128,wz="L",bz="#FFFFFF",Ez="#000000",Bz=!1,Cz=1,Wne=4,qne=0,$ne=.1;function Sz(e,t=0){const r=[];return e.forEach(function(n,l){let u=null;n.forEach(function(d,a){if(!d&&u!==null){r.push(`M${u+t} ${l+t}h${a-u}v1H${u+t}z`),u=null;return}if(a===n.length-1){if(!d)return;u===null?r.push(`M${a+t},${l+t} h1v1H${a+t}z`):r.push(`M${u+t},${l+t} h${a+1-u}v1H${u+t}z`);return}d&&u===null&&(u=a)})}),r.join("")}function Tz(e,t){return e.slice().map((r,n)=>n<t.y||n>=t.y+t.h?r:r.map((l,u)=>u<t.x||u>=t.x+t.w?l:!1))}function Xne(e,t,r,n){if(n==null)return null;const l=e.length+r*2,u=Math.floor(t*$ne),d=l/t,a=(n.width||u)*d,v=(n.height||u)*d,x=n.x==null?e.length/2-a/2:n.x*d,b=n.y==null?e.length/2-v/2:n.y*d,I=n.opacity==null?1:n.opacity;let M=null;if(n.excavate){let U=Math.floor(x),R=Math.floor(b),H=Math.ceil(a+x-U),q=Math.ceil(v+b-R);M={x:U,y:R,w:H,h:q}}const L=n.crossOrigin;return{x,y:b,h:v,w:a,excavation:M,opacity:I,crossOrigin:L}}function Zne(e,t){return t!=null?Math.max(Math.floor(t),0):e?Wne:qne}function Iz({value:e,level:t,minVersion:r,includeMargin:n,marginSize:l,imageSettings:u,size:d,boostLevel:a}){let v=pc.useMemo(()=>{const U=(Array.isArray(e)?e:[e]).reduce((R,H)=>(R.push(...R_.QrSegment.makeSegments(H)),R),[]);return R_.QrCode.encodeSegments(U,Kne[t],r,void 0,void 0,a)},[e,t,r,a]);const{cells:x,margin:b,numCells:I,calculatedImageSettings:M}=pc.useMemo(()=>{let L=v.getModules();const U=Zne(n,l),R=L.length+U*2,H=Xne(L,d,U,u);return{cells:L,margin:U,numCells:R,calculatedImageSettings:H}},[v,d,u,n,l]);return{qrcode:v,margin:b,cells:x,numCells:I,calculatedImageSettings:M}}var Yne=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),CI=pc.forwardRef(function(t,r){const n=t,{value:l,size:u=xz,level:d=wz,bgColor:a=bz,fgColor:v=Ez,includeMargin:x=Bz,minVersion:b=Cz,boostLevel:I,marginSize:M,imageSettings:L}=n,R=ST(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:H}=R,q=ST(R,["style"]),te=L?.src,J=pc.useRef(null),se=pc.useRef(null),ye=pc.useCallback(st=>{J.current=st,typeof r=="function"?r(st):r&&(r.current=st)},[r]),[Se,Be]=pc.useState(!1),{margin:De,cells:we,numCells:nt,calculatedImageSettings:_e}=Iz({value:l,level:d,minVersion:b,boostLevel:I,includeMargin:x,marginSize:M,imageSettings:L,size:u});pc.useEffect(()=>{if(J.current!=null){const st=J.current,Et=st.getContext("2d");if(!Et)return;let Ut=we;const jt=se.current,bt=_e!=null&&jt!==null&&jt.complete&&jt.naturalHeight!==0&&jt.naturalWidth!==0;bt&&_e.excavation!=null&&(Ut=Tz(we,_e.excavation));const Nt=window.devicePixelRatio||1;st.height=st.width=u*Nt;const ar=u/nt*Nt;Et.scale(ar,ar),Et.fillStyle=a,Et.fillRect(0,0,nt,nt),Et.fillStyle=v,Yne?Et.fill(new Path2D(Sz(Ut,De))):we.forEach(function(lt,ie){lt.forEach(function(Le,Fe){Le&&Et.fillRect(Fe+De,ie+De,1,1)})}),_e&&(Et.globalAlpha=_e.opacity),bt&&Et.drawImage(jt,_e.x+De,_e.y+De,_e.w,_e.h)}}),pc.useEffect(()=>{Be(!1)},[te]);const Ie=CT({height:u,width:u},H);let Ze=null;return te!=null&&(Ze=pc.createElement("img",{src:te,key:te,style:{display:"none"},onLoad:()=>{Be(!0)},ref:se,crossOrigin:_e?.crossOrigin})),pc.createElement(pc.Fragment,null,pc.createElement("canvas",CT({style:Ie,height:u,width:u,ref:ye,role:"img"},q)),Ze)});CI.displayName="QRCodeCanvas";var Jne=pc.forwardRef(function(t,r){const n=t,{value:l,size:u=xz,level:d=wz,bgColor:a=bz,fgColor:v=Ez,includeMargin:x=Bz,minVersion:b=Cz,boostLevel:I,title:M,marginSize:L,imageSettings:U}=n,R=ST(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:H,cells:q,numCells:te,calculatedImageSettings:J}=Iz({value:l,level:d,minVersion:b,boostLevel:I,includeMargin:x,marginSize:L,imageSettings:U,size:u});let se=q,ye=null;U!=null&&J!=null&&(J.excavation!=null&&(se=Tz(q,J.excavation)),ye=pc.createElement("image",{href:U.src,height:J.h,width:J.w,x:J.x+H,y:J.y+H,preserveAspectRatio:"none",opacity:J.opacity,crossOrigin:J.crossOrigin}));const Se=Sz(se,H);return pc.createElement("svg",CT({height:u,width:u,viewBox:`0 0 ${te} ${te}`,ref:r,role:"img"},R),!!M&&pc.createElement("title",null,M),pc.createElement("path",{fill:a,d:`M0,0 h${te}v${te}H0z`,shapeRendering:"crispEdges"}),pc.createElement("path",{fill:v,d:Se,shapeRendering:"crispEdges"}),ye)});Jne.displayName="QRCodeSVG";const eie=({selectedLand:e})=>{if(!e)return null;const t={number:["parcel_no","number"],planNumber:["PLAN_NUM","planNumber"],status:["status","invested","rent"],area:["Shape_Area","area"],ACTIV:["ACTIV_NAME","type_project","project_type","main_activ","ACTIV"],main_activ:["mainActivity","primary_activity","primaryActivity","ACTIV","main_activ"],rent:["rent","rental"],dis_nam:["dis_nam","district_name","neighborhood"]},r=(x,b="غير محدد")=>{const I=t[x]||[];for(let M of I){if(e.properties&&e.properties[M]!==void 0&&e.properties[M]!==null&&e.properties[M]!=="")return e.properties[M];if(e[M]!==void 0&&e[M]!==null&&e[M]!=="")return e[M]}return b},n=()=>{const x=r("status");return x==="مستثمر"||x===!0?"مستثمرة":x==="قيد الطرح"?"قيد الطرح":x==="تحت الإيجار"?"تحت الإيجار":"غير مستثمرة"},l=()=>{const x=n();return x==="مستثمرة"?"text-red-400":x==="قيد الطرح"?"text-yellow-300":x==="تحت الإيجار"?"text-orange-300":"text-green-300"},u=()=>n()==="مستثمرة"?"مؤجر":"غير مؤجر",d=()=>{const x={"رقم القطعة":r("number"),"رقم المخطط":r("planNumber"),الحالة:n(),"المساحة (م²)":r("area"),"نوع المشروع":r("main_activ"),"النشاط الرئيسي":r("ACTIV"),الإيجار:u(),الحي:r("dis_nam")},b=WB.json_to_sheet([x]),I=WB.book_new();WB.book_append_sheet(I,b,"Land Info");const M=pz(I,{bookType:"xlsx",type:"array"}),L=new Blob([M],{type:"application/octet-stream"});Vne.saveAs(L,"land-info.xlsx")},a=[{label:"رقم القطعة",value:r("number")},{label:"رقم المخطط",value:r("planNumber")},{label:"الحي",value:r("dis_nam")},{label:"الحالة",value:n(),colored:!0},{label:"المساحة",value:`${r("area")} م²`},{label:"الإيجار",value:u(),colored:!0}],v=r("number");return Nr.jsxs("div",{className:"fixed bottom-4 right-4 w-[320px] bg-gradient-to-r from-green-800 to-green-600 text-white p-4 rounded-xl shadow-lg border border-green-900 z-[1000]",children:[Nr.jsx("h2",{className:"font-bold text-lg border-b border-green-300 pb-2 text-center",children:"بيانات قطعة الأرض"}),Nr.jsx("div",{className:"flex justify-center mt-3 mb-2",children:Nr.jsx(CI,{value:v,size:120,bgColor:"transparent",fgColor:"#fff",level:"H"})}),Nr.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:a.map((x,b)=>Nr.jsxs("div",{className:"bg-green-700/40 border border-green-400 rounded-lg px-2 py-1 flex justify-between items-center text-sm",children:[Nr.jsx("span",{className:"font-semibold",children:x.label}),Nr.jsx("span",{className:`${x.colored?l():"text-white"} font-medium`,children:x.value})]},b))}),Nr.jsx("button",{onClick:d,className:"mt-4 w-full bg-white text-green-800 font-semibold py-2 rounded-lg hover:bg-green-100 transition",children:"تصدير إلى Excel"})]})};Jp.accessToken="pk.eyJ1Ijoib21hci1oZWdhenkxMjMiLCJhIjoiY21mMHV1OTIyMGtxNjJrc2Jrc3ptd3hyeSJ9.0DL-T3mWdUhrcfOaRKenNA";function tie({plots:e,onSelectPlot:t,selectedPlot:r,use3D:n}){const l=Me.useRef(null),u=Me.useRef(null),d=Me.useRef(null),[a,v]=Me.useState(!1),[x,b]=Me.useState(!1),[I,M]=Me.useState("mapbox://styles/mapbox/streets-v12"),L=[{name:"Streets",style:"mapbox://styles/mapbox/streets-v12",img:"https://api.mapbox.com/styles/v1/mapbox/streets-v12/static/37.1,31.2,3/100x100?access_token="+Jp.accessToken},{name:"Satellite",style:"mapbox://styles/mapbox/satellite-v9",img:"https://api.mapbox.com/styles/v1/mapbox/satellite-v9/static/37.1,31.2,3/100x100?access_token="+Jp.accessToken},{name:"Dark",style:"mapbox://styles/mapbox/dark-v10",img:"https://api.mapbox.com/styles/v1/mapbox/dark-v10/static/37.1,31.2,3/100x100?access_token="+Jp.accessToken},{name:"Light",style:"mapbox://styles/mapbox/light-v10",img:"https://api.mapbox.com/styles/v1/mapbox/light-v10/static/37.1,31.2,3/100x100?access_token="+Jp.accessToken},{name:"Outdoors",style:"mapbox://styles/mapbox/outdoors-v12",img:"https://api.mapbox.com/styles/v1/mapbox/outdoors-v12/static/37.1,31.2,3/100x100?access_token="+Jp.accessToken}],U=H=>{H.getSource("plots")||H.addSource("plots",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),H.getLayer("plots-fill")||H.addLayer({id:"plots-fill",type:"fill-extrusion",source:"plots",paint:{"fill-extrusion-color":["get","color"],"fill-extrusion-height":n?["get","height"]:0,"fill-extrusion-opacity":.6}}),H.getLayer("plots-outline")||H.addLayer({id:"plots-outline",type:"line",source:"plots",paint:{"line-color":"#000","line-width":1}}),d.current&&H.getSource("plots")&&H.getSource("plots").setData(d.current)};Me.useEffect(()=>{if(u.current)return;const H=new Jp.Map({container:l.current,style:I,center:[0,0],zoom:1.2,pitch:0,bearing:0,antialias:!0});u.current=H,H.on("load",()=>{if(U(H),v(!0),e&&e.length){const q=e.flatMap(te=>te.coordinates).map(te=>Array.isArray(te[0])?te:[te]).flat().filter(([te,J])=>!isNaN(te)&&!isNaN(J)).map(([te,J])=>[J,te]);if(q.length){const te=q.reduce((J,se)=>J.extend(se),new Jp.LngLatBounds(q[0],q[0]));H.fitBounds(te,{padding:40})}}})},[e,I]),Me.useEffect(()=>{if(!u.current||!a||!e)return;const H=u.current,q={type:"FeatureCollection",features:e.map(te=>{const J=te.status==="مستثمر"?"red":te.status==="قيد الطرح"?"orange":"green",se=r?.id===te.id?50:20;return{type:"Feature",geometry:{type:"Polygon",coordinates:[te.coordinates.map(([ye,Se])=>[Se,ye])]},properties:{...te,color:J,height:se}}})};if(d.current=q,H.getSource("plots")&&H.getSource("plots").setData(q),r&&r.coordinates.length>0)try{const J=(Array.isArray(r.coordinates[0][0])?r.coordinates:[r.coordinates]).flat().filter(([se,ye])=>!isNaN(se)&&!isNaN(ye));if(J.length){const se=J.map(([De])=>De),ye=J.map(([,De])=>De),Se=(Math.min(...se)+Math.max(...se))/2,Be=(Math.min(...ye)+Math.max(...ye))/2;H.easeTo({center:[Be,Se],zoom:18,duration:1200})}}catch(te){console.error("Invalid coordinates for selected plot:",te)}else{const te=e.flatMap(J=>J.coordinates).map(J=>Array.isArray(J[0])?J:[J]).flat().filter(([J,se])=>!isNaN(J)&&!isNaN(se)).map(([J,se])=>[se,J]);if(te.length){const J=te.reduce((se,ye)=>se.extend(ye),new Jp.LngLatBounds(te[0],te[0]));H.fitBounds(J,{padding:40})}}},[e,r,a,n]),Me.useEffect(()=>{if(!u.current)return;const H=u.current,q=te=>{const J=H.queryRenderedFeatures(te.point,{layers:["plots-fill"]});if(J.length){const se=J[0].properties.id,ye=e.find(Se=>Se.id===se);ye&&t&&t(ye)}};return H.on("click",q),()=>H.off("click",q)},[t,e]),Me.useEffect(()=>{if(!u.current)return;const H=u.current,q="mapbox://styles/mapbox/streets-v12",te="mapbox://styles/mapbox/satellite-v9",J=()=>{const se=H.getZoom();se>16&&I!==te?(M(te),H.setStyle(te),H.once("style.load",()=>U(H))):se<=16&&I!==q&&(M(q),H.setStyle(q),H.once("style.load",()=>U(H)))};return H.on("zoom",J),()=>H.off("zoom",J)},[I]);const R=()=>{u.current&&u.current.easeTo({bearing:0,pitch:0,duration:1e3})};return Nr.jsxs("div",{className:"relative w-full h-full rounded-lg overflow-hidden shadow-lg",children:[Nr.jsx("div",{ref:l,className:"w-full h-full"}),Nr.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-3 z-10",children:[Nr.jsxs("div",{className:"bg-gray-100 backdrop-blur-sm rounded-lg shadow-md flex flex-col border border-gray-200",children:[Nr.jsx("button",{onClick:()=>u.current&&u.current.zoomIn({duration:500}),className:"w-12 h-12 flex items-center justify-center border-b border-gray-200",children:"+"}),Nr.jsx("button",{onClick:()=>u.current&&u.current.zoomOut({duration:500}),className:"w-12 h-12 flex items-center justify-center",children:"-"})]}),Nr.jsx("div",{children:Nr.jsx("button",{onClick:R,className:"w-12 h-12 flex items-center justify-center text-5xl ",children:"🧭"})})]}),Nr.jsxs("div",{className:"absolute bottom-7 left-4 z-10 flex items-center gap-2",children:[Nr.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-md shadow-xl border-2 border-gray-600 overflow-hidden w-24 h-24 relative",children:Nr.jsxs("button",{onClick:()=>b(!x),className:"w-full h-full flex flex-col items-center justify-center p-0 relative",children:[Nr.jsx("img",{src:L.find(H=>H.style===I)?.img,alt:"الخريطة الحالية",className:"w-full h-full object-cover rounded-md"}),Nr.jsxs("div",{className:"absolute top-1/2 -translate-y-1/2 flex flex-col items-center pointer-events-none",children:[Nr.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 24 24",stroke:"none",className:"w-10 h-10 drop-shadow-lg",children:Nr.jsx("path",{d:"M4 6l8-3 8 3M4 12l8-3 8 3M4 18l8-3 8 3"})}),Nr.jsx("span",{className:"text-sm font-semibold text-white mt-1 drop-shadow-md",children:"Maps"})]})]})}),x&&Nr.jsx("div",{className:"absolute bottom-0 left-28 bg-white/30 backdrop-blur-md rounded-lg shadow-2xl border border-gray-300 p-2 flex flex-row gap-2",children:L.map((H,q)=>Nr.jsxs("button",{className:`flex flex-col items-center p-1 rounded transition-all duration-200 transform hover:scale-105 ${I===H.style?"bg-blue-50 ring-2 ring-blue-500":"hover:bg-gray-100"}`,onClick:()=>{M(H.style),u.current.setStyle(H.style),u.current.on("style.load",()=>U(u.current)),b(!1)},children:[Nr.jsx("div",{className:"w-14 h-14 rounded overflow-hidden border border-gray-300",children:Nr.jsx("img",{src:H.img,alt:H.name,className:"w-full h-full object-cover"})}),Nr.jsx("span",{className:"text-xs font-medium text-gray-700 mt-1",children:H.name})]},q))})]})]})}const rie=({onScan:e})=>{const[t,r]=Me.useState(""),n=l=>{l.preventDefault(),t.trim()&&(e(t.trim()),r(""))};return Nr.jsx("div",{className:"p-2 bg-white rounded shadow",children:Nr.jsxs("form",{onSubmit:n,className:"flex gap-2",children:[Nr.jsx("input",{type:"text",placeholder:"ادخل رقم قطعة الأرض",value:t,onChange:l=>r(l.target.value),className:"border p-1 rounded flex-1"}),Nr.jsx("button",{type:"submit",className:"bg-green-900 text-white px-3 rounded",children:"بحث"})]})})};function Fz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(t=0;t<l;t++)e[t]&&(r=Fz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Bs(){for(var e,t,r=0,n="",l=arguments.length;r<l;r++)(e=arguments[r])&&(t=Fz(e))&&(n&&(n+=" "),n+=t);return n}var qB={},$B={},hO;function nie(){return hO||(hO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t}($B)),$B}var XB={},fO;function Pz(){return fO||(fO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t}(XB)),XB}var ZB={},AO;function Lz(){return AO||(AO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t}(ZB)),ZB}var YB={},dO;function SI(){return dO||(dO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],l=r.length;if(l===0)return n;let u=0,d="",a="",v=!1;for(r.charCodeAt(0)===46&&(n.push(""),u++);u<l;){const x=r[u];a?x==="\\"&&u+1<l?(u++,d+=r[u]):x===a?a="":d+=x:v?x==='"'||x==="'"?a=x:x==="]"?(v=!1,n.push(d),d=""):d+=x:x==="["?(v=!0,d&&(n.push(d),d="")):x==="."?d&&(n.push(d),d=""):d+=x,u++}return d&&n.push(d),n}e.toPath=t}(YB)),YB}var pO;function TI(){return pO||(pO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nie(),r=Pz(),n=Lz(),l=SI();function u(a,v,x){if(a==null)return x;switch(typeof v){case"string":{if(t.isUnsafeProperty(v))return x;const b=a[v];return b===void 0?r.isDeepKey(v)?u(a,l.toPath(v),x):x:b}case"number":case"symbol":{typeof v=="number"&&(v=n.toKey(v));const b=a[v];return b===void 0?x:b}default:{if(Array.isArray(v))return d(a,v,x);if(Object.is(v?.valueOf(),-0)?v="-0":v=String(v),t.isUnsafeProperty(v))return x;const b=a[v];return b===void 0?x:b}}}function d(a,v,x){if(v.length===0)return x;let b=a;for(let I=0;I<v.length;I++){if(b==null||t.isUnsafeProperty(v[I]))return x;b=b[v[I]]}return b===void 0?x:b}e.get=u}(qB)),qB}var JB,mO;function iie(){return mO||(mO=1,JB=TI().get),JB}var aie=iie();const Tg=od(aie);var eC={exports:{}},bs={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gO;function oie(){if(gO)return bs;gO=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),M=Symbol.for("react.view_transition"),L=Symbol.for("react.client.reference");function U(R){if(typeof R=="object"&&R!==null){var H=R.$$typeof;switch(H){case e:switch(R=R.type,R){case r:case l:case n:case v:case x:case M:return R;default:switch(R=R&&R.$$typeof,R){case d:case a:case I:case b:return R;case u:return R;default:return H}}case t:return H}}}return bs.ContextConsumer=u,bs.ContextProvider=d,bs.Element=e,bs.ForwardRef=a,bs.Fragment=r,bs.Lazy=I,bs.Memo=b,bs.Portal=t,bs.Profiler=l,bs.StrictMode=n,bs.Suspense=v,bs.SuspenseList=x,bs.isContextConsumer=function(R){return U(R)===u},bs.isContextProvider=function(R){return U(R)===d},bs.isElement=function(R){return typeof R=="object"&&R!==null&&R.$$typeof===e},bs.isForwardRef=function(R){return U(R)===a},bs.isFragment=function(R){return U(R)===r},bs.isLazy=function(R){return U(R)===I},bs.isMemo=function(R){return U(R)===b},bs.isPortal=function(R){return U(R)===t},bs.isProfiler=function(R){return U(R)===l},bs.isStrictMode=function(R){return U(R)===n},bs.isSuspense=function(R){return U(R)===v},bs.isSuspenseList=function(R){return U(R)===x},bs.isValidElementType=function(R){return typeof R=="string"||typeof R=="function"||R===r||R===l||R===n||R===v||R===x||typeof R=="object"&&R!==null&&(R.$$typeof===I||R.$$typeof===b||R.$$typeof===d||R.$$typeof===u||R.$$typeof===a||R.$$typeof===L||R.getModuleId!==void 0)},bs.typeOf=U,bs}var _O;function sie(){return _O||(_O=1,eC.exports=oie()),eC.exports}var lie=sie(),lh=e=>e===0?0:e>0?1:-1,rd=e=>typeof e=="number"&&e!=+e,u0=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Ri=e=>(typeof e=="number"||e instanceof Number)&&!rd(e),Ip=e=>Ri(e)||typeof e=="string",cie=0,f1=e=>{var t=++cie;return"".concat(e||"").concat(t)},uf=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ri(t)&&typeof t!="string")return n;var u;if(u0(t)){if(r==null)return n;var d=t.indexOf("%");u=r*parseFloat(t.slice(0,d))/100}else u=+t;return rd(u)&&(u=n),l&&r!=null&&u>r&&(u=r),u},Mz=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1},vO=(e,t)=>Ri(e)&&Ri(t)?r=>e+r*(t-e):()=>t;function v_(e,t,r){return Ri(e)&&Ri(t)?e+r*(t-e):t}function uie(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Tg(n,t))===r)}var Au=e=>e===null||typeof e>"u",D1=e=>Au(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),hie=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function II(e){if(typeof e!="string")return!1;var t=hie;return t.includes(e)}var fie=["viewBox","children"],yO=["points","pathLength"],tC={svg:fie,polygon:yO,polyline:yO},Aie=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(Me.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(l=>{II(l)&&(n[l]=u=>r[l](r,u))}),n},die=(e,t,r)=>n=>(e(t,r,n),null),Mb=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(l=>{var u=e[l];II(l)&&typeof u=="function"&&(n||(n={}),n[l]=die(u,t,r))}),n},pie=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function Oz(e){if(typeof e!="string")return!1;var t=pie;return t.includes(e)}function vv(e){var t=Object.entries(e).filter(r=>{var[n]=r;return Oz(n)});return Object.fromEntries(t)}var xO=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",wO=null,rC=null,Dz=e=>{if(e===wO&&Array.isArray(rC))return rC;var t=[];return Me.Children.forEach(e,r=>{Au(r)||(lie.isFragment(r)?t=t.concat(Dz(r.props.children)):t.push(r))}),rC=t,wO=e,t};function R1(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(l=>xO(l)):n=[xO(t)],Dz(e).forEach(l=>{var u=Tg(l,"type.displayName")||Tg(l,"type.name");n.indexOf(u)!==-1&&r.push(l)}),r}var mie=(e,t,r,n)=>{var l;if(typeof t=="symbol"||typeof t=="number")return!0;var u=(l=n&&tC?.[n])!==null&&l!==void 0?l:[],d=t.startsWith("data-"),a=typeof e!="function"&&(!!n&&u.includes(t)||Oz(t)),v=!!r&&II(t);return d||a||v},Hc=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(Me.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var l={};return Object.keys(n).forEach(u=>{var d;mie((d=n)===null||d===void 0?void 0:d[u],u,t,r)&&(l[u]=n[u])}),l},gie=["children","width","height","viewBox","className","style","title","desc"];function TT(){return TT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},TT.apply(null,arguments)}function _ie(e,t){if(e==null)return{};var r,n,l=vie(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function vie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Rz=Me.forwardRef((e,t)=>{var{children:r,width:n,height:l,viewBox:u,className:d,style:a,title:v,desc:x}=e,b=_ie(e,gie),I=u||{width:n,height:l,x:0,y:0},M=Bs("recharts-surface",d);return Me.createElement("svg",TT({},Hc(b,!0,"svg"),{className:M,width:n,height:l,style:a,viewBox:"".concat(I.x," ").concat(I.y," ").concat(I.width," ").concat(I.height),ref:t}),Me.createElement("title",null,v),Me.createElement("desc",null,x),r)}),yie=["children","className"];function IT(){return IT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IT.apply(null,arguments)}function xie(e,t){if(e==null)return{};var r,n,l=wie(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function wie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vA=Me.forwardRef((e,t)=>{var{children:r,className:n}=e,l=xie(e,yie),u=Bs("recharts-layer",n);return Me.createElement("g",IT({className:u},Hc(l,!0),{ref:t}),r)}),bie=Me.createContext(null);function $s(e){return function(){return e}}const kz=Math.cos,C2=Math.sin,Qd=Math.sqrt,S2=Math.PI,Ob=2*S2,FT=Math.PI,PT=2*FT,n0=1e-6,Eie=PT-n0;function Uz(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Bie(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Uz;const r=10**t;return function(n){this._+=n[0];for(let l=1,u=n.length;l<u;++l)this._+=Math.round(arguments[l]*r)/r+n[l]}}class Cie{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Uz:Bie(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,l){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+l}`}bezierCurveTo(t,r,n,l,u,d){this._append`C${+t},${+r},${+n},${+l},${this._x1=+u},${this._y1=+d}`}arcTo(t,r,n,l,u){if(t=+t,r=+r,n=+n,l=+l,u=+u,u<0)throw new Error(`negative radius: ${u}`);let d=this._x1,a=this._y1,v=n-t,x=l-r,b=d-t,I=a-r,M=b*b+I*I;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(M>n0)if(!(Math.abs(I*v-x*b)>n0)||!u)this._append`L${this._x1=t},${this._y1=r}`;else{let L=n-d,U=l-a,R=v*v+x*x,H=L*L+U*U,q=Math.sqrt(R),te=Math.sqrt(M),J=u*Math.tan((FT-Math.acos((R+M-H)/(2*q*te)))/2),se=J/te,ye=J/q;Math.abs(se-1)>n0&&this._append`L${t+se*b},${r+se*I}`,this._append`A${u},${u},0,0,${+(I*L>b*U)},${this._x1=t+ye*v},${this._y1=r+ye*x}`}}arc(t,r,n,l,u,d){if(t=+t,r=+r,n=+n,d=!!d,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(l),v=n*Math.sin(l),x=t+a,b=r+v,I=1^d,M=d?l-u:u-l;this._x1===null?this._append`M${x},${b}`:(Math.abs(this._x1-x)>n0||Math.abs(this._y1-b)>n0)&&this._append`L${x},${b}`,n&&(M<0&&(M=M%PT+PT),M>Eie?this._append`A${n},${n},0,1,${I},${t-a},${r-v}A${n},${n},0,1,${I},${this._x1=x},${this._y1=b}`:M>n0&&this._append`A${n},${n},0,${+(M>=FT)},${I},${this._x1=t+n*Math.cos(u)},${this._y1=r+n*Math.sin(u)}`)}rect(t,r,n,l){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+l}h${-n}Z`}toString(){return this._}}function FI(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Cie(t)}function PI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Nz(e){this._context=e}Nz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Db(e){return new Nz(e)}function zz(e){return e[0]}function Qz(e){return e[1]}function jz(e,t){var r=$s(!0),n=null,l=Db,u=null,d=FI(a);e=typeof e=="function"?e:e===void 0?zz:$s(e),t=typeof t=="function"?t:t===void 0?Qz:$s(t);function a(v){var x,b=(v=PI(v)).length,I,M=!1,L;for(n==null&&(u=l(L=d())),x=0;x<=b;++x)!(x<b&&r(I=v[x],x,v))===M&&((M=!M)?u.lineStart():u.lineEnd()),M&&u.point(+e(I,x,v),+t(I,x,v));if(L)return u=null,L+""||null}return a.x=function(v){return arguments.length?(e=typeof v=="function"?v:$s(+v),a):e},a.y=function(v){return arguments.length?(t=typeof v=="function"?v:$s(+v),a):t},a.defined=function(v){return arguments.length?(r=typeof v=="function"?v:$s(!!v),a):r},a.curve=function(v){return arguments.length?(l=v,n!=null&&(u=l(n)),a):l},a.context=function(v){return arguments.length?(v==null?n=u=null:u=l(n=v),a):n},a}function rw(e,t,r){var n=null,l=$s(!0),u=null,d=Db,a=null,v=FI(x);e=typeof e=="function"?e:e===void 0?zz:$s(+e),t=typeof t=="function"?t:$s(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?Qz:$s(+r);function x(I){var M,L,U,R=(I=PI(I)).length,H,q=!1,te,J=new Array(R),se=new Array(R);for(u==null&&(a=d(te=v())),M=0;M<=R;++M){if(!(M<R&&l(H=I[M],M,I))===q)if(q=!q)L=M,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),U=M-1;U>=L;--U)a.point(J[U],se[U]);a.lineEnd(),a.areaEnd()}q&&(J[M]=+e(H,M,I),se[M]=+t(H,M,I),a.point(n?+n(H,M,I):J[M],r?+r(H,M,I):se[M]))}if(te)return a=null,te+""||null}function b(){return jz().defined(l).curve(d).context(u)}return x.x=function(I){return arguments.length?(e=typeof I=="function"?I:$s(+I),n=null,x):e},x.x0=function(I){return arguments.length?(e=typeof I=="function"?I:$s(+I),x):e},x.x1=function(I){return arguments.length?(n=I==null?null:typeof I=="function"?I:$s(+I),x):n},x.y=function(I){return arguments.length?(t=typeof I=="function"?I:$s(+I),r=null,x):t},x.y0=function(I){return arguments.length?(t=typeof I=="function"?I:$s(+I),x):t},x.y1=function(I){return arguments.length?(r=I==null?null:typeof I=="function"?I:$s(+I),x):r},x.lineX0=x.lineY0=function(){return b().x(e).y(t)},x.lineY1=function(){return b().x(e).y(r)},x.lineX1=function(){return b().x(n).y(t)},x.defined=function(I){return arguments.length?(l=typeof I=="function"?I:$s(!!I),x):l},x.curve=function(I){return arguments.length?(d=I,u!=null&&(a=d(u)),x):d},x.context=function(I){return arguments.length?(I==null?u=a=null:a=d(u=I),x):u},x}class Hz{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Sie(e){return new Hz(e,!0)}function Tie(e){return new Hz(e,!1)}const LI={draw(e,t){const r=Qd(t/S2);e.moveTo(r,0),e.arc(0,0,r,0,Ob)}},Iie={draw(e,t){const r=Qd(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},Vz=Qd(1/3),Fie=Vz*2,Pie={draw(e,t){const r=Qd(t/Fie),n=r*Vz;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},Lie={draw(e,t){const r=Qd(t),n=-r/2;e.rect(n,n,r,r)}},Mie=.8908130915292852,Gz=C2(S2/10)/C2(7*S2/10),Oie=C2(Ob/10)*Gz,Die=-kz(Ob/10)*Gz,Rie={draw(e,t){const r=Qd(t*Mie),n=Oie*r,l=Die*r;e.moveTo(0,-r),e.lineTo(n,l);for(let u=1;u<5;++u){const d=Ob*u/5,a=kz(d),v=C2(d);e.lineTo(v*r,-a*r),e.lineTo(a*n-v*l,v*n+a*l)}e.closePath()}},nC=Qd(3),kie={draw(e,t){const r=-Qd(t/(nC*3));e.moveTo(0,r*2),e.lineTo(-nC*r,-r),e.lineTo(nC*r,-r),e.closePath()}},GA=-.5,KA=Qd(3)/2,LT=1/Qd(12),Uie=(LT/2+1)*3,Nie={draw(e,t){const r=Qd(t/Uie),n=r/2,l=r*LT,u=n,d=r*LT+r,a=-u,v=d;e.moveTo(n,l),e.lineTo(u,d),e.lineTo(a,v),e.lineTo(GA*n-KA*l,KA*n+GA*l),e.lineTo(GA*u-KA*d,KA*u+GA*d),e.lineTo(GA*a-KA*v,KA*a+GA*v),e.lineTo(GA*n+KA*l,GA*l-KA*n),e.lineTo(GA*u+KA*d,GA*d-KA*u),e.lineTo(GA*a+KA*v,GA*v-KA*a),e.closePath()}};function zie(e,t){let r=null,n=FI(l);e=typeof e=="function"?e:$s(e||LI),t=typeof t=="function"?t:$s(t===void 0?64:+t);function l(){let u;if(r||(r=u=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),u)return r=null,u+""||null}return l.type=function(u){return arguments.length?(e=typeof u=="function"?u:$s(u),l):e},l.size=function(u){return arguments.length?(t=typeof u=="function"?u:$s(+u),l):t},l.context=function(u){return arguments.length?(r=u??null,l):r},l}function T2(){}function I2(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function Kz(e){this._context=e}Kz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:I2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:I2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Qie(e){return new Kz(e)}function Wz(e){this._context=e}Wz.prototype={areaStart:T2,areaEnd:T2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:I2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function jie(e){return new Wz(e)}function qz(e){this._context=e}qz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:I2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Hie(e){return new qz(e)}function $z(e){this._context=e}$z.prototype={areaStart:T2,areaEnd:T2,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Vie(e){return new $z(e)}function bO(e){return e<0?-1:1}function EO(e,t,r){var n=e._x1-e._x0,l=t-e._x1,u=(e._y1-e._y0)/(n||l<0&&-0),d=(r-e._y1)/(l||n<0&&-0),a=(u*l+d*n)/(n+l);return(bO(u)+bO(d))*Math.min(Math.abs(u),Math.abs(d),.5*Math.abs(a))||0}function BO(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function iC(e,t,r){var n=e._x0,l=e._y0,u=e._x1,d=e._y1,a=(u-n)/3;e._context.bezierCurveTo(n+a,l+a*t,u-a,d-a*r,u,d)}function F2(e){this._context=e}F2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:iC(this,this._t0,BO(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,iC(this,BO(this,r=EO(this,e,t)),r);break;default:iC(this,this._t0,r=EO(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Xz(e){this._context=new Zz(e)}(Xz.prototype=Object.create(F2.prototype)).point=function(e,t){F2.prototype.point.call(this,t,e)};function Zz(e){this._context=e}Zz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,l,u){this._context.bezierCurveTo(t,e,n,r,u,l)}};function Gie(e){return new F2(e)}function Kie(e){return new Xz(e)}function Yz(e){this._context=e}Yz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=CO(e),l=CO(t),u=0,d=1;d<r;++u,++d)this._context.bezierCurveTo(n[0][u],l[0][u],n[1][u],l[1][u],e[d],t[d]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function CO(e){var t,r=e.length-1,n,l=new Array(r),u=new Array(r),d=new Array(r);for(l[0]=0,u[0]=2,d[0]=e[0]+2*e[1],t=1;t<r-1;++t)l[t]=1,u[t]=4,d[t]=4*e[t]+2*e[t+1];for(l[r-1]=2,u[r-1]=7,d[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=l[t]/u[t-1],u[t]-=n,d[t]-=n*d[t-1];for(l[r-1]=d[r-1]/u[r-1],t=r-2;t>=0;--t)l[t]=(d[t]-l[t+1])/u[t];for(u[r-1]=(e[r]+l[r-1])/2,t=0;t<r-1;++t)u[t]=2*e[t+1]-l[t+1];return[l,u]}function Wie(e){return new Yz(e)}function Rb(e,t){this._context=e,this._t=t}Rb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function qie(e){return new Rb(e,.5)}function $ie(e){return new Rb(e,0)}function Xie(e){return new Rb(e,1)}function J_(e,t){if((d=e.length)>1)for(var r=1,n,l,u=e[t[0]],d,a=u.length;r<d;++r)for(l=u,u=e[t[r]],n=0;n<a;++n)u[n][1]+=u[n][0]=isNaN(l[n][1])?l[n][0]:l[n][1]}function MT(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Zie(e,t){return e[t]}function Yie(e){const t=[];return t.key=e,t}function Jie(){var e=$s([]),t=MT,r=J_,n=Zie;function l(u){var d=Array.from(e.apply(this,arguments),Yie),a,v=d.length,x=-1,b;for(const I of u)for(a=0,++x;a<v;++a)(d[a][x]=[0,+n(I,d[a].key,x,u)]).data=I;for(a=0,b=PI(t(d));a<v;++a)d[b[a]].index=a;return r(d,b),d}return l.keys=function(u){return arguments.length?(e=typeof u=="function"?u:$s(Array.from(u)),l):e},l.value=function(u){return arguments.length?(n=typeof u=="function"?u:$s(+u),l):n},l.order=function(u){return arguments.length?(t=u==null?MT:typeof u=="function"?u:$s(Array.from(u)),l):t},l.offset=function(u){return arguments.length?(r=u??J_,l):r},l}function eae(e,t){if((n=e.length)>0){for(var r,n,l=0,u=e[0].length,d;l<u;++l){for(d=r=0;r<n;++r)d+=e[r][l][1]||0;if(d)for(r=0;r<n;++r)e[r][l][1]/=d}J_(e,t)}}function tae(e,t){if((l=e.length)>0){for(var r=0,n=e[t[0]],l,u=n.length;r<u;++r){for(var d=0,a=0;d<l;++d)a+=e[d][r][1]||0;n[r][1]+=n[r][0]=-a/2}J_(e,t)}}function rae(e,t){if(!(!((d=e.length)>0)||!((u=(l=e[t[0]]).length)>0))){for(var r=0,n=1,l,u,d;n<u;++n){for(var a=0,v=0,x=0;a<d;++a){for(var b=e[t[a]],I=b[n][1]||0,M=b[n-1][1]||0,L=(I-M)/2,U=0;U<a;++U){var R=e[t[U]],H=R[n][1]||0,q=R[n-1][1]||0;L+=H-q}v+=I,x+=L*I}l[n-1][1]+=l[n-1][0]=r,v&&(r-=x/v)}l[n-1][1]+=l[n-1][0]=r,J_(e,t)}}var nae=["type","size","sizeType"];function OT(){return OT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OT.apply(null,arguments)}function SO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function TO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SO(Object(r),!0).forEach(function(n){iae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iae(e,t,r){return(t=aae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aae(e){var t=oae(e,"string");return typeof t=="symbol"?t:t+""}function oae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sae(e,t){if(e==null)return{};var r,n,l=lae(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function lae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Jz={symbolCircle:LI,symbolCross:Iie,symbolDiamond:Pie,symbolSquare:Lie,symbolStar:Rie,symbolTriangle:kie,symbolWye:Nie},cae=Math.PI/180,uae=e=>{var t="symbol".concat(D1(e));return Jz[t]||LI},hae=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*cae;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},fae=(e,t)=>{Jz["symbol".concat(D1(e))]=t},eQ=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,l=sae(e,nae),u=TO(TO({},l),{},{type:t,size:r,sizeType:n}),d=()=>{var I=uae(t),M=zie().type(I).size(hae(r,n,t));return M()},{className:a,cx:v,cy:x}=u,b=Hc(u,!0);return v===+v&&x===+x&&r===+r?Me.createElement("path",OT({},b,{className:Bs("recharts-symbols",a),transform:"translate(".concat(v,", ").concat(x,")"),d:d()})):null};eQ.registerSymbol=fae;var aC={},oC={},IO;function Aae(){return IO||(IO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const l=new Map;for(let u=0;u<r.length;u++){const d=r[u],a=n(d);l.has(a)||l.set(a,d)}return Array.from(l.values())}e.uniqBy=t}(oC)),oC}var sC={},FO;function tQ(){return FO||(FO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t}(sC)),sC}var lC={},cC={},uC={},PO;function dae(){return PO||(PO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t}(uC)),uC}var LO;function MI(){return LO||(LO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dae();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r}(cC)),cC}var hC={},MO;function pae(){return MO||(MO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t}(hC)),hC}var OO;function mae(){return OO||(OO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MI(),r=pae();function n(l){return r.isObjectLike(l)&&t.isArrayLike(l)}e.isArrayLikeObject=n}(lC)),lC}var fC={},AC={},DO;function gae(){return DO||(DO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TI();function r(n){return function(l){return t.get(l,n)}}e.property=r}(AC)),AC}var dC={},pC={},mC={},gC={},RO;function rQ(){return RO||(RO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t}(gC)),gC}var _C={},kO;function nQ(){return kO||(kO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t}(_C)),_C}var vC={},UO;function OI(){return UO||(UO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t}(vC)),vC}var NO;function _ae(){return NO||(NO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DI(),r=rQ(),n=nQ(),l=OI();function u(I,M,L){return typeof L!="function"?t.isMatch(I,M):d(I,M,function U(R,H,q,te,J,se){const ye=L(R,H,q,te,J,se);return ye!==void 0?!!ye:d(R,H,U,se)},new Map)}function d(I,M,L,U){if(M===I)return!0;switch(typeof M){case"object":return a(I,M,L,U);case"function":return Object.keys(M).length>0?d(I,{...M},L,U):l.eq(I,M);default:return r.isObject(I)?typeof M=="string"?M==="":!0:l.eq(I,M)}}function a(I,M,L,U){if(M==null)return!0;if(Array.isArray(M))return x(I,M,L,U);if(M instanceof Map)return v(I,M,L,U);if(M instanceof Set)return b(I,M,L,U);const R=Object.keys(M);if(I==null)return R.length===0;if(R.length===0)return!0;if(U&&U.has(M))return U.get(M)===I;U&&U.set(M,I);try{for(let H=0;H<R.length;H++){const q=R[H];if(!n.isPrimitive(I)&&!(q in I)||M[q]===void 0&&I[q]!==void 0||M[q]===null&&I[q]!==null||!L(I[q],M[q],q,I,M,U))return!1}return!0}finally{U&&U.delete(M)}}function v(I,M,L,U){if(M.size===0)return!0;if(!(I instanceof Map))return!1;for(const[R,H]of M.entries()){const q=I.get(R);if(L(q,H,R,I,M,U)===!1)return!1}return!0}function x(I,M,L,U){if(M.length===0)return!0;if(!Array.isArray(I))return!1;const R=new Set;for(let H=0;H<M.length;H++){const q=M[H];let te=!1;for(let J=0;J<I.length;J++){if(R.has(J))continue;const se=I[J];let ye=!1;if(L(se,q,H,I,M,U)&&(ye=!0),ye){R.add(J),te=!0;break}}if(!te)return!1}return!0}function b(I,M,L,U){return M.size===0?!0:I instanceof Set?x([...I],[...M],L,U):!1}e.isMatchWith=u,e.isSetMatch=b}(mC)),mC}var zO;function DI(){return zO||(zO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_ae();function r(n,l){return t.isMatchWith(n,l,()=>{})}e.isMatch=r}(pC)),pC}var yC={},xC={},wC={},QO;function iQ(){return QO||(QO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t}(wC)),wC}var bC={},jO;function RI(){return jO||(jO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t}(bC)),bC}var EC={},HO;function kI(){return HO||(HO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",l="[object Boolean]",u="[object Arguments]",d="[object Symbol]",a="[object Date]",v="[object Map]",x="[object Set]",b="[object Array]",I="[object Function]",M="[object ArrayBuffer]",L="[object Object]",U="[object Error]",R="[object DataView]",H="[object Uint8Array]",q="[object Uint8ClampedArray]",te="[object Uint16Array]",J="[object Uint32Array]",se="[object BigUint64Array]",ye="[object Int8Array]",Se="[object Int16Array]",Be="[object Int32Array]",De="[object BigInt64Array]",we="[object Float32Array]",nt="[object Float64Array]";e.argumentsTag=u,e.arrayBufferTag=M,e.arrayTag=b,e.bigInt64ArrayTag=De,e.bigUint64ArrayTag=se,e.booleanTag=l,e.dataViewTag=R,e.dateTag=a,e.errorTag=U,e.float32ArrayTag=we,e.float64ArrayTag=nt,e.functionTag=I,e.int16ArrayTag=Se,e.int32ArrayTag=Be,e.int8ArrayTag=ye,e.mapTag=v,e.numberTag=n,e.objectTag=L,e.regexpTag=t,e.setTag=x,e.stringTag=r,e.symbolTag=d,e.uint16ArrayTag=te,e.uint32ArrayTag=J,e.uint8ArrayTag=H,e.uint8ClampedArrayTag=q}(EC)),EC}var BC={},VO;function vae(){return VO||(VO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t}(BC)),BC}var GO;function aQ(){return GO||(GO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iQ(),r=RI(),n=kI(),l=nQ(),u=vae();function d(b,I){return a(b,void 0,b,new Map,I)}function a(b,I,M,L=new Map,U=void 0){const R=U?.(b,I,M,L);if(R!=null)return R;if(l.isPrimitive(b))return b;if(L.has(b))return L.get(b);if(Array.isArray(b)){const H=new Array(b.length);L.set(b,H);for(let q=0;q<b.length;q++)H[q]=a(b[q],q,M,L,U);return Object.hasOwn(b,"index")&&(H.index=b.index),Object.hasOwn(b,"input")&&(H.input=b.input),H}if(b instanceof Date)return new Date(b.getTime());if(b instanceof RegExp){const H=new RegExp(b.source,b.flags);return H.lastIndex=b.lastIndex,H}if(b instanceof Map){const H=new Map;L.set(b,H);for(const[q,te]of b)H.set(q,a(te,q,M,L,U));return H}if(b instanceof Set){const H=new Set;L.set(b,H);for(const q of b)H.add(a(q,void 0,M,L,U));return H}if(typeof Buffer<"u"&&Buffer.isBuffer(b))return b.subarray();if(u.isTypedArray(b)){const H=new(Object.getPrototypeOf(b)).constructor(b.length);L.set(b,H);for(let q=0;q<b.length;q++)H[q]=a(b[q],q,M,L,U);return H}if(b instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&b instanceof SharedArrayBuffer)return b.slice(0);if(b instanceof DataView){const H=new DataView(b.buffer.slice(0),b.byteOffset,b.byteLength);return L.set(b,H),v(H,b,M,L,U),H}if(typeof File<"u"&&b instanceof File){const H=new File([b],b.name,{type:b.type});return L.set(b,H),v(H,b,M,L,U),H}if(b instanceof Blob){const H=new Blob([b],{type:b.type});return L.set(b,H),v(H,b,M,L,U),H}if(b instanceof Error){const H=new b.constructor;return L.set(b,H),H.message=b.message,H.name=b.name,H.stack=b.stack,H.cause=b.cause,v(H,b,M,L,U),H}if(typeof b=="object"&&x(b)){const H=Object.create(Object.getPrototypeOf(b));return L.set(b,H),v(H,b,M,L,U),H}return b}function v(b,I,M=b,L,U){const R=[...Object.keys(I),...t.getSymbols(I)];for(let H=0;H<R.length;H++){const q=R[H],te=Object.getOwnPropertyDescriptor(b,q);(te==null||te.writable)&&(b[q]=a(I[q],q,M,L,U))}}function x(b){switch(r.getTag(b)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=d,e.cloneDeepWithImpl=a,e.copyProperties=v}(xC)),xC}var KO;function yae(){return KO||(KO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aQ();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r}(yC)),yC}var WO;function xae(){return WO||(WO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DI(),r=yae();function n(l){return l=r.cloneDeep(l),u=>t.isMatch(u,l)}e.matches=n}(dC)),dC}var CC={},SC={},TC={},qO;function wae(){return qO||(qO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aQ(),r=kI();function n(l,u){return t.cloneDeepWith(l,(d,a,v,x)=>{const b=u?.(d,a,v,x);if(b!=null)return b;if(typeof l=="object")switch(Object.prototype.toString.call(l)){case r.numberTag:case r.stringTag:case r.booleanTag:{const I=new l.constructor(l?.valueOf());return t.copyProperties(I,l),I}case r.argumentsTag:{const I={};return t.copyProperties(I,l),I.length=l.length,I[Symbol.iterator]=l[Symbol.iterator],I}default:return}})}e.cloneDeepWith=n}(TC)),TC}var $O;function bae(){return $O||($O=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wae();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r}(SC)),SC}var IC={},FC={},XO;function oQ(){return XO||(XO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,l=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<l;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r}(FC)),FC}var PC={},ZO;function Eae(){return ZO||(ZO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RI();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r}(PC)),PC}var YO;function Bae(){return YO||(YO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pz(),r=oQ(),n=Eae(),l=SI();function u(d,a){let v;if(Array.isArray(a)?v=a:typeof a=="string"&&t.isDeepKey(a)&&d?.[a]==null?v=l.toPath(a):v=[a],v.length===0)return!1;let x=d;for(let b=0;b<v.length;b++){const I=v[b];if((x==null||!Object.hasOwn(x,I))&&!((Array.isArray(x)||n.isArguments(x))&&r.isIndex(I)&&I<x.length))return!1;x=x[I]}return!0}e.has=u}(IC)),IC}var JO;function Cae(){return JO||(JO=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DI(),r=Lz(),n=bae(),l=TI(),u=Bae();function d(a,v){switch(typeof a){case"object":{Object.is(a?.valueOf(),-0)&&(a="-0");break}case"number":{a=r.toKey(a);break}}return v=n.cloneDeep(v),function(x){const b=l.get(x,a);return b===void 0?u.has(x,a):v===void 0?b===void 0:t.isMatch(b,v)}}e.matchesProperty=d}(CC)),CC}var eD;function Sae(){return eD||(eD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tQ(),r=gae(),n=xae(),l=Cae();function u(d){if(d==null)return t.identity;switch(typeof d){case"function":return d;case"object":return Array.isArray(d)&&d.length===2?l.matchesProperty(d[0],d[1]):n.matches(d);case"string":case"symbol":case"number":return r.property(d)}}e.iteratee=u}(fC)),fC}var tD;function Tae(){return tD||(tD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Aae(),r=tQ(),n=mae(),l=Sae();function u(d,a=r.identity){return n.isArrayLikeObject(d)?t.uniqBy(Array.from(d),l.iteratee(a)):[]}e.uniqBy=u}(aC)),aC}var LC,rD;function Iae(){return rD||(rD=1,LC=Tae().uniqBy),LC}var Fae=Iae();const nD=od(Fae);function Pae(e,t,r){return t===!0?nD(e,r):typeof t=="function"?nD(e,t):e}var MC={exports:{}},OC={},DC={exports:{}},RC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iD;function Lae(){if(iD)return RC;iD=1;var e=hv();function t(I,M){return I===M&&(I!==0||1/I===1/M)||I!==I&&M!==M}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,l=e.useEffect,u=e.useLayoutEffect,d=e.useDebugValue;function a(I,M){var L=M(),U=n({inst:{value:L,getSnapshot:M}}),R=U[0].inst,H=U[1];return u(function(){R.value=L,R.getSnapshot=M,v(R)&&H({inst:R})},[I,L,M]),l(function(){return v(R)&&H({inst:R}),I(function(){v(R)&&H({inst:R})})},[I]),d(L),L}function v(I){var M=I.getSnapshot;I=I.value;try{var L=M();return!r(I,L)}catch{return!0}}function x(I,M){return M()}var b=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?x:a;return RC.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:b,RC}var aD;function Mae(){return aD||(aD=1,DC.exports=Lae()),DC.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oD;function Oae(){if(oD)return OC;oD=1;var e=hv(),t=Mae();function r(x,b){return x===b&&(x!==0||1/x===1/b)||x!==x&&b!==b}var n=typeof Object.is=="function"?Object.is:r,l=t.useSyncExternalStore,u=e.useRef,d=e.useEffect,a=e.useMemo,v=e.useDebugValue;return OC.useSyncExternalStoreWithSelector=function(x,b,I,M,L){var U=u(null);if(U.current===null){var R={hasValue:!1,value:null};U.current=R}else R=U.current;U=a(function(){function q(Se){if(!te){if(te=!0,J=Se,Se=M(Se),L!==void 0&&R.hasValue){var Be=R.value;if(L(Be,Se))return se=Be}return se=Se}if(Be=se,n(J,Se))return Be;var De=M(Se);return L!==void 0&&L(Be,De)?(J=Se,Be):(J=Se,se=De)}var te=!1,J,se,ye=I===void 0?null:I;return[function(){return q(b())},ye===null?void 0:function(){return q(ye())}]},[b,I,M,L]);var H=l(x,U[0],U[1]);return d(function(){R.hasValue=!0,R.value=H},[H]),v(H),H},OC}var sD;function Dae(){return sD||(sD=1,MC.exports=Oae()),MC.exports}var Rae=Dae(),UI=Me.createContext(null),kae=e=>e,vc=()=>{var e=Me.useContext(UI);return e?e.store.dispatch:kae},Yw=()=>{},Uae=()=>Yw,Nae=(e,t)=>e===t;function Yi(e){var t=Me.useContext(UI);return Rae.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Uae,t?t.store.getState:Yw,t?t.store.getState:Yw,t?e:Yw,Nae)}function zae(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Qae(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function jae(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var lD=e=>Array.isArray(e)?e:[e];function Hae(e){const t=Array.isArray(e[0])?e[0]:e;return jae(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Vae(e,t){const r=[],{length:n}=e;for(let l=0;l<n;l++)r.push(e[l].apply(null,t));return r}var Gae=class{constructor(e){this.value=e}deref(){return this.value}},Kae=typeof WeakRef<"u"?WeakRef:Gae,Wae=0,cD=1;function nw(){return{s:Wae,v:void 0,o:null,p:null}}function sQ(e,t={}){let r=nw();const{resultEqualityCheck:n}=t;let l,u=0;function d(){let a=r;const{length:v}=arguments;for(let I=0,M=v;I<M;I++){const L=arguments[I];if(typeof L=="function"||typeof L=="object"&&L!==null){let U=a.o;U===null&&(a.o=U=new WeakMap);const R=U.get(L);R===void 0?(a=nw(),U.set(L,a)):a=R}else{let U=a.p;U===null&&(a.p=U=new Map);const R=U.get(L);R===void 0?(a=nw(),U.set(L,a)):a=R}}const x=a;let b;if(a.s===cD)b=a.v;else if(b=e.apply(null,arguments),u++,n){const I=l?.deref?.()??l;I!=null&&n(I,b)&&(b=I,u!==0&&u--),l=typeof b=="object"&&b!==null||typeof b=="function"?new Kae(b):b}return x.s=cD,x.v=b,b}return d.clearCache=()=>{r=nw(),d.resetResultsCount()},d.resultsCount=()=>u,d.resetResultsCount=()=>{u=0},d}function qae(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...l)=>{let u=0,d=0,a,v={},x=l.pop();typeof x=="object"&&(v=x,x=l.pop()),zae(x,`createSelector expects an output function after the inputs, but received: [${typeof x}]`);const b={...r,...v},{memoize:I,memoizeOptions:M=[],argsMemoize:L=sQ,argsMemoizeOptions:U=[]}=b,R=lD(M),H=lD(U),q=Hae(l),te=I(function(){return u++,x.apply(null,arguments)},...R),J=L(function(){d++;const ye=Vae(q,arguments);return a=te.apply(null,ye),a},...H);return Object.assign(J,{resultFunc:x,memoizedResultFunc:te,dependencies:q,dependencyRecomputations:()=>d,resetDependencyRecomputations:()=>{d=0},lastResult:()=>a,recomputations:()=>u,resetRecomputations:()=>{u=0},memoize:I,argsMemoize:L})};return Object.assign(n,{withTypes:()=>n}),n}var kr=qae(sQ),$ae=Object.assign((e,t=kr)=>{Qae(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(u=>e[u]);return t(n,(...u)=>u.reduce((d,a,v)=>(d[r[v]]=a,d),{}))},{withTypes:()=>$ae}),kC={},UC={},NC={},uD;function Xae(){return uD||(uD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,l,u)=>{if(n!==l){const d=t(n),a=t(l);if(d===a&&d===0){if(n<l)return u==="desc"?1:-1;if(n>l)return u==="desc"?-1:1}return u==="desc"?a-d:d-a}return 0};e.compareValues=r}(NC)),NC}var zC={},QC={},hD;function lQ(){return hD||(hD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t}(QC)),QC}var fD;function Zae(){return fD||(fD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lQ(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function l(u,d){return Array.isArray(u)?!1:typeof u=="number"||typeof u=="boolean"||u==null||t.isSymbol(u)?!0:typeof u=="string"&&(n.test(u)||!r.test(u))||d!=null&&Object.hasOwn(d,u)}e.isKey=l}(zC)),zC}var AD;function Yae(){return AD||(AD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Xae(),r=Zae(),n=SI();function l(u,d,a,v){if(u==null)return[];a=v?void 0:a,Array.isArray(u)||(u=Object.values(u)),Array.isArray(d)||(d=d==null?[null]:[d]),d.length===0&&(d=[null]),Array.isArray(a)||(a=a==null?[]:[a]),a=a.map(L=>String(L));const x=(L,U)=>{let R=L;for(let H=0;H<U.length&&R!=null;++H)R=R[U[H]];return R},b=(L,U)=>U==null||L==null?U:typeof L=="object"&&"key"in L?Object.hasOwn(U,L.key)?U[L.key]:x(U,L.path):typeof L=="function"?L(U):Array.isArray(L)?x(U,L):typeof U=="object"?U[L]:U,I=d.map(L=>(Array.isArray(L)&&L.length===1&&(L=L[0]),L==null||typeof L=="function"||Array.isArray(L)||r.isKey(L)?L:{key:L,path:n.toPath(L)}));return u.map(L=>({original:L,criteria:I.map(U=>b(U,L))})).slice().sort((L,U)=>{for(let R=0;R<I.length;R++){const H=t.compareValues(L.criteria[R],U.criteria[R],a[R]);if(H!==0)return H}return 0}).map(L=>L.original)}e.orderBy=l}(UC)),UC}var jC={},dD;function Jae(){return dD||(dD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const l=[],u=Math.floor(n),d=(a,v)=>{for(let x=0;x<a.length;x++){const b=a[x];Array.isArray(b)&&v<u?d(b,v+1):l.push(b)}};return d(r,0),l}e.flatten=t}(jC)),jC}var HC={},pD;function cQ(){return pD||(pD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oQ(),r=MI(),n=rQ(),l=OI();function u(d,a,v){return n.isObject(v)&&(typeof a=="number"&&r.isArrayLike(v)&&t.isIndex(a)&&a<v.length||typeof a=="string"&&a in v)?l.eq(v[a],d):!1}e.isIterateeCall=u}(HC)),HC}var mD;function eoe(){return mD||(mD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Yae(),r=Jae(),n=cQ();function l(u,...d){const a=d.length;return a>1&&n.isIterateeCall(u,d[0],d[1])?d=[]:a>2&&n.isIterateeCall(d[0],d[1],d[2])&&(d=[d[0]]),t.orderBy(u,r.flatten(d),["asc"])}e.sortBy=l}(kC)),kC}var VC,gD;function toe(){return gD||(gD=1,VC=eoe().sortBy),VC}var roe=toe();const kb=od(roe);var uQ=e=>e.legend.settings,noe=e=>e.legend.size,ioe=e=>e.legend.payload;kr([ioe,uQ],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?kb(n,r):n});var iw=1;function aoe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=Me.useState({height:0,left:0,top:0,width:0}),n=Me.useCallback(l=>{if(l!=null){var u=l.getBoundingClientRect(),d={height:u.height,left:u.left,top:u.top,width:u.width};(Math.abs(d.height-t.height)>iw||Math.abs(d.left-t.left)>iw||Math.abs(d.top-t.top)>iw||Math.abs(d.width-t.width)>iw)&&r({height:d.height,left:d.left,top:d.top,width:d.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function rh(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ooe=typeof Symbol=="function"&&Symbol.observable||"@@observable",_D=ooe,GC=()=>Math.random().toString(36).substring(7).split("").join("."),soe={INIT:`@@redux/INIT${GC()}`,REPLACE:`@@redux/REPLACE${GC()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${GC()}`},P2=soe;function NI(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function hQ(e,t,r){if(typeof e!="function")throw new Error(rh(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(rh(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(rh(1));return r(hQ)(e,t)}let n=e,l=t,u=new Map,d=u,a=0,v=!1;function x(){d===u&&(d=new Map,u.forEach((H,q)=>{d.set(q,H)}))}function b(){if(v)throw new Error(rh(3));return l}function I(H){if(typeof H!="function")throw new Error(rh(4));if(v)throw new Error(rh(5));let q=!0;x();const te=a++;return d.set(te,H),function(){if(q){if(v)throw new Error(rh(6));q=!1,x(),d.delete(te),u=null}}}function M(H){if(!NI(H))throw new Error(rh(7));if(typeof H.type>"u")throw new Error(rh(8));if(typeof H.type!="string")throw new Error(rh(17));if(v)throw new Error(rh(9));try{v=!0,l=n(l,H)}finally{v=!1}return(u=d).forEach(te=>{te()}),H}function L(H){if(typeof H!="function")throw new Error(rh(10));n=H,M({type:P2.REPLACE})}function U(){const H=I;return{subscribe(q){if(typeof q!="object"||q===null)throw new Error(rh(11));function te(){const se=q;se.next&&se.next(b())}return te(),{unsubscribe:H(te)}},[_D](){return this}}}return M({type:P2.INIT}),{dispatch:M,subscribe:I,getState:b,replaceReducer:L,[_D]:U}}function loe(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:P2.INIT})>"u")throw new Error(rh(12));if(typeof r(void 0,{type:P2.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(rh(13))})}function fQ(e){const t=Object.keys(e),r={};for(let u=0;u<t.length;u++){const d=t[u];typeof e[d]=="function"&&(r[d]=e[d])}const n=Object.keys(r);let l;try{loe(r)}catch(u){l=u}return function(d={},a){if(l)throw l;let v=!1;const x={};for(let b=0;b<n.length;b++){const I=n[b],M=r[I],L=d[I],U=M(L,a);if(typeof U>"u")throw a&&a.type,new Error(rh(14));x[I]=U,v=v||U!==L}return v=v||n.length!==Object.keys(d).length,v?x:d}}function L2(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function coe(...e){return t=>(r,n)=>{const l=t(r,n);let u=()=>{throw new Error(rh(15))};const d={getState:l.getState,dispatch:(v,...x)=>u(v,...x)},a=e.map(v=>v(d));return u=L2(...a)(l.dispatch),{...l,dispatch:u}}}function AQ(e){return NI(e)&&"type"in e&&typeof e.type=="string"}var dQ=Symbol.for("immer-nothing"),vD=Symbol.for("immer-draftable"),yA=Symbol.for("immer-state");function Od(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ev=Object.getPrototypeOf;function T0(e){return!!e&&!!e[yA]}function pm(e){return e?pQ(e)||Array.isArray(e)||!!e[vD]||!!e.constructor?.[vD]||Nb(e)||zb(e):!1}var uoe=Object.prototype.constructor.toString();function pQ(e){if(!e||typeof e!="object")return!1;const t=ev(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===uoe}function M2(e,t){Ub(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Ub(e){const t=e[yA];return t?t.type_:Array.isArray(e)?1:Nb(e)?2:zb(e)?3:0}function DT(e,t){return Ub(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function mQ(e,t,r){const n=Ub(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function hoe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Nb(e){return e instanceof Map}function zb(e){return e instanceof Set}function i0(e){return e.copy_||e.base_}function RT(e,t){if(Nb(e))return new Map(e);if(zb(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=pQ(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[yA];let l=Reflect.ownKeys(n);for(let u=0;u<l.length;u++){const d=l[u],a=n[d];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[d]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[d]})}return Object.create(ev(e),n)}else{const n=ev(e);if(n!==null&&r)return{...e};const l=Object.create(n);return Object.assign(l,e)}}function zI(e,t=!1){return Qb(e)||T0(e)||!pm(e)||(Ub(e)>1&&(e.set=e.add=e.clear=e.delete=foe),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>zI(n,!0))),e}function foe(){Od(2)}function Qb(e){return Object.isFrozen(e)}var Aoe={};function I0(e){const t=Aoe[e];return t||Od(0,e),t}var A1;function gQ(){return A1}function doe(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function yD(e,t){t&&(I0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function kT(e){UT(e),e.drafts_.forEach(poe),e.drafts_=null}function UT(e){e===A1&&(A1=e.parent_)}function xD(e){return A1=doe(A1,e)}function poe(e){const t=e[yA];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function wD(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[yA].modified_&&(kT(t),Od(4)),pm(e)&&(e=O2(t,e),t.parent_||D2(t,e)),t.patches_&&I0("Patches").generateReplacementPatches_(r[yA].base_,e,t.patches_,t.inversePatches_)):e=O2(t,r,[]),kT(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==dQ?e:void 0}function O2(e,t,r){if(Qb(t))return t;const n=t[yA];if(!n)return M2(t,(l,u)=>bD(e,n,t,l,u,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return D2(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const l=n.copy_;let u=l,d=!1;n.type_===3&&(u=new Set(l),l.clear(),d=!0),M2(u,(a,v)=>bD(e,n,l,a,v,r,d)),D2(e,l,!1),r&&e.patches_&&I0("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function bD(e,t,r,n,l,u,d){if(T0(l)){const a=u&&t&&t.type_!==3&&!DT(t.assigned_,n)?u.concat(n):void 0,v=O2(e,l,a);if(mQ(r,n,v),T0(v))e.canAutoFreeze_=!1;else return}else d&&r.add(l);if(pm(l)&&!Qb(l)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;O2(e,l),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&D2(e,l)}}function D2(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&zI(t,r)}function moe(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:gQ(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let l=n,u=QI;r&&(l=[n],u=d1);const{revoke:d,proxy:a}=Proxy.revocable(l,u);return n.draft_=a,n.revoke_=d,a}var QI={get(e,t){if(t===yA)return e;const r=i0(e);if(!DT(r,t))return goe(e,r,t);const n=r[t];return e.finalized_||!pm(n)?n:n===KC(e.base_,t)?(WC(e),e.copy_[t]=zT(n,e)):n},has(e,t){return t in i0(e)},ownKeys(e){return Reflect.ownKeys(i0(e))},set(e,t,r){const n=_Q(i0(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const l=KC(i0(e),t),u=l?.[yA];if(u&&u.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(hoe(r,l)&&(r!==void 0||DT(e.base_,t)))return!0;WC(e),NT(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return KC(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,WC(e),NT(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=i0(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Od(11)},getPrototypeOf(e){return ev(e.base_)},setPrototypeOf(){Od(12)}},d1={};M2(QI,(e,t)=>{d1[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});d1.deleteProperty=function(e,t){return d1.set.call(this,e,t,void 0)};d1.set=function(e,t,r){return QI.set.call(this,e[0],t,r,e[0])};function KC(e,t){const r=e[yA];return(r?i0(r):e)[t]}function goe(e,t,r){const n=_Q(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function _Q(e,t){if(!(t in e))return;let r=ev(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=ev(r)}}function NT(e){e.modified_||(e.modified_=!0,e.parent_&&NT(e.parent_))}function WC(e){e.copy_||(e.copy_=RT(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var _oe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const u=r;r=t;const d=this;return function(v=u,...x){return d.produce(v,b=>r.call(this,b,...x))}}typeof r!="function"&&Od(6),n!==void 0&&typeof n!="function"&&Od(7);let l;if(pm(t)){const u=xD(this),d=zT(t,void 0);let a=!0;try{l=r(d),a=!1}finally{a?kT(u):UT(u)}return yD(u,n),wD(l,u)}else if(!t||typeof t!="object"){if(l=r(t),l===void 0&&(l=t),l===dQ&&(l=void 0),this.autoFreeze_&&zI(l,!0),n){const u=[],d=[];I0("Patches").generateReplacementPatches_(t,l,u,d),n(u,d)}return l}else Od(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(d,...a)=>this.produceWithPatches(d,v=>t(v,...a));let n,l;return[this.produce(t,r,(d,a)=>{n=d,l=a}),n,l]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){pm(e)||Od(8),T0(e)&&(e=cm(e));const t=xD(this),r=zT(e,void 0);return r[yA].isManual_=!0,UT(t),r}finishDraft(e,t){const r=e&&e[yA];(!r||!r.isManual_)&&Od(9);const{scope_:n}=r;return yD(n,t),wD(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const l=t[r];if(l.path.length===0&&l.op==="replace"){e=l.value;break}}r>-1&&(t=t.slice(r+1));const n=I0("Patches").applyPatches_;return T0(e)?n(e,t):this.produce(e,l=>n(l,t))}};function zT(e,t){const r=Nb(e)?I0("MapSet").proxyMap_(e,t):zb(e)?I0("MapSet").proxySet_(e,t):moe(e,t);return(t?t.scope_:gQ()).drafts_.push(r),r}function cm(e){return T0(e)||Od(10,e),vQ(e)}function vQ(e){if(!pm(e)||Qb(e))return e;const t=e[yA];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=RT(e,t.scope_.immer_.useStrictShallowCopy_)}else r=RT(e,!0);return M2(r,(n,l)=>{mQ(r,n,vQ(l))}),t&&(t.finalized_=!1),r}var xA=new _oe,yQ=xA.produce;xA.produceWithPatches.bind(xA);xA.setAutoFreeze.bind(xA);xA.setUseStrictShallowCopy.bind(xA);xA.applyPatches.bind(xA);xA.createDraft.bind(xA);xA.finishDraft.bind(xA);function xQ(e){return({dispatch:r,getState:n})=>l=>u=>typeof u=="function"?u(r,n,e):l(u)}var voe=xQ(),yoe=xQ,xoe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?L2:L2.apply(null,arguments)};function nd(e,t){function r(...n){if(t){let l=t(...n);if(!l)throw new Error(gA(0));return{type:e,payload:l.payload,..."meta"in l&&{meta:l.meta},..."error"in l&&{error:l.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>AQ(n)&&n.type===e,r}var wQ=class Dy extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Dy.prototype)}static get[Symbol.species](){return Dy}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Dy(...t[0].concat(this)):new Dy(...t.concat(this))}};function ED(e){return pm(e)?yQ(e,()=>{}):e}function aw(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function woe(e){return typeof e=="boolean"}var boe=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:l=!0,actionCreatorCheck:u=!0}=t??{};let d=new wQ;return r&&(woe(r)?d.push(voe):d.push(yoe(r.extraArgument))),d},Eoe="RTK_autoBatch",BD=e=>t=>{setTimeout(t,e)},Boe=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let l=!0,u=!1,d=!1;const a=new Set,v=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:BD(10):e.type==="callback"?e.queueNotification:BD(e.timeout),x=()=>{d=!1,u&&(u=!1,a.forEach(b=>b()))};return Object.assign({},n,{subscribe(b){const I=()=>l&&b(),M=n.subscribe(I);return a.add(b),()=>{M(),a.delete(b)}},dispatch(b){try{return l=!b?.meta?.[Eoe],u=!l,u&&(d||(d=!0,v(x))),n.dispatch(b)}finally{l=!0}}})},Coe=e=>function(r){const{autoBatch:n=!0}=r??{};let l=new wQ(e);return n&&l.push(Boe(typeof n=="object"?n:void 0)),l};function Soe(e){const t=boe(),{reducer:r=void 0,middleware:n,devTools:l=!0,preloadedState:u=void 0,enhancers:d=void 0}=e||{};let a;if(typeof r=="function")a=r;else if(NI(r))a=fQ(r);else throw new Error(gA(1));let v;typeof n=="function"?v=n(t):v=t();let x=L2;l&&(x=xoe({trace:!1,...typeof l=="object"&&l}));const b=coe(...v),I=Coe(b);let M=typeof d=="function"?d(I):I();const L=x(...M);return hQ(a,u,L)}function bQ(e){const t={},r=[];let n;const l={addCase(u,d){const a=typeof u=="string"?u:u.type;if(!a)throw new Error(gA(28));if(a in t)throw new Error(gA(29));return t[a]=d,l},addMatcher(u,d){return r.push({matcher:u,reducer:d}),l},addDefaultCase(u){return n=u,l}};return e(l),[t,r,n]}function Toe(e){return typeof e=="function"}function Ioe(e,t){let[r,n,l]=bQ(t),u;if(Toe(e))u=()=>ED(e());else{const a=ED(e);u=()=>a}function d(a=u(),v){let x=[r[v.type],...n.filter(({matcher:b})=>b(v)).map(({reducer:b})=>b)];return x.filter(b=>!!b).length===0&&(x=[l]),x.reduce((b,I)=>{if(I)if(T0(b)){const L=I(b,v);return L===void 0?b:L}else{if(pm(b))return yQ(b,M=>I(M,v));{const M=I(b,v);if(M===void 0){if(b===null)return b;throw Error("A case reducer on a non-draftable value must not return undefined")}return M}}return b},a)}return d.getInitialState=u,d}var Foe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Poe=(e=21)=>{let t="",r=e;for(;r--;)t+=Foe[Math.random()*64|0];return t},Loe=Symbol.for("rtk-slice-createasyncthunk");function Moe(e,t){return`${e}/${t}`}function Ooe({creators:e}={}){const t=e?.asyncThunk?.[Loe];return function(n){const{name:l,reducerPath:u=l}=n;if(!l)throw new Error(gA(11));const d=(typeof n.reducers=="function"?n.reducers(Roe()):n.reducers)||{},a=Object.keys(d),v={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},x={addCase(J,se){const ye=typeof J=="string"?J:J.type;if(!ye)throw new Error(gA(12));if(ye in v.sliceCaseReducersByType)throw new Error(gA(13));return v.sliceCaseReducersByType[ye]=se,x},addMatcher(J,se){return v.sliceMatchers.push({matcher:J,reducer:se}),x},exposeAction(J,se){return v.actionCreators[J]=se,x},exposeCaseReducer(J,se){return v.sliceCaseReducersByName[J]=se,x}};a.forEach(J=>{const se=d[J],ye={reducerName:J,type:Moe(l,J),createNotation:typeof n.reducers=="function"};Uoe(se)?zoe(ye,se,x,t):koe(ye,se,x)});function b(){const[J={},se=[],ye=void 0]=typeof n.extraReducers=="function"?bQ(n.extraReducers):[n.extraReducers],Se={...J,...v.sliceCaseReducersByType};return Ioe(n.initialState,Be=>{for(let De in Se)Be.addCase(De,Se[De]);for(let De of v.sliceMatchers)Be.addMatcher(De.matcher,De.reducer);for(let De of se)Be.addMatcher(De.matcher,De.reducer);ye&&Be.addDefaultCase(ye)})}const I=J=>J,M=new Map,L=new WeakMap;let U;function R(J,se){return U||(U=b()),U(J,se)}function H(){return U||(U=b()),U.getInitialState()}function q(J,se=!1){function ye(Be){let De=Be[J];return typeof De>"u"&&se&&(De=aw(L,ye,H)),De}function Se(Be=I){const De=aw(M,se,()=>new WeakMap);return aw(De,Be,()=>{const we={};for(const[nt,_e]of Object.entries(n.selectors??{}))we[nt]=Doe(_e,Be,()=>aw(L,Be,H),se);return we})}return{reducerPath:J,getSelectors:Se,get selectors(){return Se(ye)},selectSlice:ye}}const te={name:l,reducer:R,actions:v.actionCreators,caseReducers:v.sliceCaseReducersByName,getInitialState:H,...q(u),injectInto(J,{reducerPath:se,...ye}={}){const Se=se??u;return J.inject({reducerPath:Se,reducer:R},ye),{...te,...q(Se,!0)}}};return te}}function Doe(e,t,r,n){function l(u,...d){let a=t(u);return typeof a>"u"&&n&&(a=r()),e(a,...d)}return l.unwrapped=e,l}var bA=Ooe();function Roe(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function koe({type:e,reducerName:t,createNotation:r},n,l){let u,d;if("reducer"in n){if(r&&!Noe(n))throw new Error(gA(17));u=n.reducer,d=n.prepare}else u=n;l.addCase(e,u).exposeCaseReducer(t,u).exposeAction(t,d?nd(e,d):nd(e))}function Uoe(e){return e._reducerDefinitionType==="asyncThunk"}function Noe(e){return e._reducerDefinitionType==="reducerWithPrepare"}function zoe({type:e,reducerName:t},r,n,l){if(!l)throw new Error(gA(18));const{payloadCreator:u,fulfilled:d,pending:a,rejected:v,settled:x,options:b}=r,I=l(e,u,b);n.exposeAction(t,I),d&&n.addCase(I.fulfilled,d),a&&n.addCase(I.pending,a),v&&n.addCase(I.rejected,v),x&&n.addMatcher(I.settled,x),n.exposeCaseReducer(t,{fulfilled:d||ow,pending:a||ow,rejected:v||ow,settled:x||ow})}function ow(){}var Qoe="task",EQ="listener",BQ="completed",jI="cancelled",joe=`task-${jI}`,Hoe=`task-${BQ}`,QT=`${EQ}-${jI}`,Voe=`${EQ}-${BQ}`,jb=class{constructor(e){this.code=e,this.message=`${Qoe} ${jI} (reason: ${e})`}name="TaskAbortError";message},HI=(e,t)=>{if(typeof e!="function")throw new TypeError(gA(32))},R2=()=>{},CQ=(e,t=R2)=>(e.catch(t),e),SQ=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),m0=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},g0=e=>{if(e.aborted){const{reason:t}=e;throw new jb(t)}};function TQ(e,t){let r=R2;return new Promise((n,l)=>{const u=()=>l(new jb(e.reason));if(e.aborted){u();return}r=SQ(e,u),t.finally(()=>r()).then(n,l)}).finally(()=>{r=R2})}var Goe=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof jb?"cancelled":"rejected",error:r}}finally{t?.()}},k2=e=>t=>CQ(TQ(e,t).then(r=>(g0(e),r))),IQ=e=>{const t=k2(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:G_}=Object,CD={},Hb="listenerMiddleware",Koe=(e,t)=>{const r=n=>SQ(e,()=>m0(n,e.reason));return(n,l)=>{HI(n);const u=new AbortController;r(u);const d=Goe(async()=>{g0(e),g0(u.signal);const a=await n({pause:k2(u.signal),delay:IQ(u.signal),signal:u.signal});return g0(u.signal),a},()=>m0(u,Hoe));return l?.autoJoin&&t.push(d.catch(R2)),{result:k2(e)(d),cancel(){m0(u,joe)}}}},Woe=(e,t)=>{const r=async(n,l)=>{g0(t);let u=()=>{};const a=[new Promise((v,x)=>{let b=e({predicate:n,effect:(I,M)=>{M.unsubscribe(),v([I,M.getState(),M.getOriginalState()])}});u=()=>{b(),x()}})];l!=null&&a.push(new Promise(v=>setTimeout(v,l,null)));try{const v=await TQ(t,Promise.race(a));return g0(t),v}finally{u()}};return(n,l)=>CQ(r(n,l))},FQ=e=>{let{type:t,actionCreator:r,matcher:n,predicate:l,effect:u}=e;if(t)l=nd(t).match;else if(r)t=r.type,l=r.match;else if(n)l=n;else if(!l)throw new Error(gA(21));return HI(u),{predicate:l,type:t,effect:u}},PQ=G_(e=>{const{type:t,predicate:r,effect:n}=FQ(e);return{id:Poe(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(gA(22))}}},{withTypes:()=>PQ}),SD=(e,t)=>{const{type:r,effect:n,predicate:l}=FQ(t);return Array.from(e.values()).find(u=>(typeof r=="string"?u.type===r:u.predicate===l)&&u.effect===n)},jT=e=>{e.pending.forEach(t=>{m0(t,QT)})},qoe=e=>()=>{e.forEach(jT),e.clear()},TD=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},LQ=G_(nd(`${Hb}/add`),{withTypes:()=>LQ}),$oe=nd(`${Hb}/removeAll`),MQ=G_(nd(`${Hb}/remove`),{withTypes:()=>MQ}),Xoe=(...e)=>{console.error(`${Hb}/error`,...e)},k1=(e={})=>{const t=new Map,{extra:r,onError:n=Xoe}=e;HI(n);const l=b=>(b.unsubscribe=()=>t.delete(b.id),t.set(b.id,b),I=>{b.unsubscribe(),I?.cancelActive&&jT(b)}),u=b=>{const I=SD(t,b)??PQ(b);return l(I)};G_(u,{withTypes:()=>u});const d=b=>{const I=SD(t,b);return I&&(I.unsubscribe(),b.cancelActive&&jT(I)),!!I};G_(d,{withTypes:()=>d});const a=async(b,I,M,L)=>{const U=new AbortController,R=Woe(u,U.signal),H=[];try{b.pending.add(U),await Promise.resolve(b.effect(I,G_({},M,{getOriginalState:L,condition:(q,te)=>R(q,te).then(Boolean),take:R,delay:IQ(U.signal),pause:k2(U.signal),extra:r,signal:U.signal,fork:Koe(U.signal,H),unsubscribe:b.unsubscribe,subscribe:()=>{t.set(b.id,b)},cancelActiveListeners:()=>{b.pending.forEach((q,te,J)=>{q!==U&&(m0(q,QT),J.delete(q))})},cancel:()=>{m0(U,QT),b.pending.delete(U)},throwIfCancelled:()=>{g0(U.signal)}})))}catch(q){q instanceof jb||TD(n,q,{raisedBy:"effect"})}finally{await Promise.all(H),m0(U,Voe),b.pending.delete(U)}},v=qoe(t);return{middleware:b=>I=>M=>{if(!AQ(M))return I(M);if(LQ.match(M))return u(M.payload);if($oe.match(M)){v();return}if(MQ.match(M))return d(M.payload);let L=b.getState();const U=()=>{if(L===CD)throw new Error(gA(23));return L};let R;try{if(R=I(M),t.size>0){const H=b.getState(),q=Array.from(t.values());for(const te of q){let J=!1;try{J=te.predicate(M,H,L)}catch(se){J=!1,TD(n,se,{raisedBy:"predicate"})}J&&a(te,M,b,U)}}}finally{L=CD}return R},startListening:u,stopListening:d,clearListeners:v}};function gA(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Zoe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},OQ=bA({name:"chartLayout",initialState:Zoe,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:Yoe,setLayout:Joe,setChartSize:ese,setScale:tse}=OQ.actions,rse=OQ.reducer;function ID(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function FD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ID(Object(r),!0).forEach(function(n){nse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ID(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nse(e,t,r){return(t=ise(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ise(e){var t=ase(e,"string");return typeof t=="symbol"?t:t+""}function ase(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U2=Math.PI/180,ose=e=>e*180/Math.PI,Vc=(e,t,r,n)=>({x:e+Math.cos(-U2*n)*r,y:t+Math.sin(-U2*n)*r}),DQ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},sse=(e,t)=>{var{x:r,y:n}=e,{x:l,y:u}=t;return Math.sqrt((r-l)**2+(n-u)**2)},lse=(e,t)=>{var{x:r,y:n}=e,{cx:l,cy:u}=t,d=sse({x:r,y:n},{x:l,y:u});if(d<=0)return{radius:d,angle:0};var a=(r-l)/d,v=Math.acos(a);return n>u&&(v=2*Math.PI-v),{radius:d,angle:ose(v),angleInRadian:v}},cse=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),l=Math.floor(r/360),u=Math.min(n,l);return{startAngle:t-u*360,endAngle:r-u*360}},use=(e,t)=>{var{startAngle:r,endAngle:n}=t,l=Math.floor(r/360),u=Math.floor(n/360),d=Math.min(l,u);return e+d*360},hse=(e,t)=>{var{x:r,y:n}=e,{radius:l,angle:u}=lse({x:r,y:n},t),{innerRadius:d,outerRadius:a}=t;if(l<d||l>a||l===0)return null;var{startAngle:v,endAngle:x}=cse(t),b=u,I;if(v<=x){for(;b>x;)b-=360;for(;b<v;)b+=360;I=b>=v&&b<=x}else{for(;b>v;)b-=360;for(;b<x;)b+=360;I=b>=x&&b<=v}return I?FD(FD({},t),{},{radius:l,angle:use(b,t)}):null};function RQ(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function PD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function ZA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PD(Object(r),!0).forEach(function(n){fse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fse(e,t,r){return(t=Ase(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ase(e){var t=dse(e,"string");return typeof t=="symbol"?t:t+""}function dse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wl(e,t,r){return Au(e)||Au(t)?r:Ip(t)?Tg(e,t,r):typeof t=="function"?t(e):r}var pse=(e,t,r,n,l)=>{var u,d=-1,a=(u=t?.length)!==null&&u!==void 0?u:0;if(a<=1||e==null)return 0;if(n==="angleAxis"&&l!=null&&Math.abs(Math.abs(l[1]-l[0])-360)<=1e-6)for(var v=0;v<a;v++){var x=v>0?r[v-1].coordinate:r[a-1].coordinate,b=r[v].coordinate,I=v>=a-1?r[0].coordinate:r[v+1].coordinate,M=void 0;if(lh(b-x)!==lh(I-b)){var L=[];if(lh(I-b)===lh(l[1]-l[0])){M=I;var U=b+l[1]-l[0];L[0]=Math.min(U,(U+x)/2),L[1]=Math.max(U,(U+x)/2)}else{M=x;var R=I+l[1]-l[0];L[0]=Math.min(b,(R+b)/2),L[1]=Math.max(b,(R+b)/2)}var H=[Math.min(b,(M+b)/2),Math.max(b,(M+b)/2)];if(e>H[0]&&e<=H[1]||e>=L[0]&&e<=L[1]){({index:d}=r[v]);break}}else{var q=Math.min(x,I),te=Math.max(x,I);if(e>(q+b)/2&&e<=(te+b)/2){({index:d}=r[v]);break}}}else if(t){for(var J=0;J<a;J++)if(J===0&&e<=(t[J].coordinate+t[J+1].coordinate)/2||J>0&&J<a-1&&e>(t[J].coordinate+t[J-1].coordinate)/2&&e<=(t[J].coordinate+t[J+1].coordinate)/2||J===a-1&&e>(t[J].coordinate+t[J-1].coordinate)/2){({index:d}=t[J]);break}}return d},mse=(e,t,r)=>{if(t&&r){var{width:n,height:l}=r,{align:u,verticalAlign:d,layout:a}=t;if((a==="vertical"||a==="horizontal"&&d==="middle")&&u!=="center"&&Ri(e[u]))return ZA(ZA({},e),{},{[u]:e[u]+(n||0)});if((a==="horizontal"||a==="vertical"&&u==="center")&&d!=="middle"&&Ri(e[d]))return ZA(ZA({},e),{},{[d]:e[d]+(l||0)})}return e},N0=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",LD=1e-4,gse=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),l=Math.min(n[0],n[1])-LD,u=Math.max(n[0],n[1])+LD,d=e(t[0]),a=e(t[r-1]);(d<l||d>u||a<l||a>u)&&e.domain([t[0],t[r-1]])}},_se=(e,t)=>{if(!t||t.length!==2||!Ri(t[0])||!Ri(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),l=[e[0],e[1]];return(!Ri(e[0])||e[0]<r)&&(l[0]=r),(!Ri(e[1])||e[1]>n)&&(l[1]=n),l[0]>n&&(l[0]=n),l[1]<r&&(l[1]=r),l},vse=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var l=0,u=0,d=0;d<t;++d){var a=rd(e[d][r][1])?e[d][r][0]:e[d][r][1];a>=0?(e[d][r][0]=l,e[d][r][1]=l+a,l=e[d][r][1]):(e[d][r][0]=u,e[d][r][1]=u+a,u=e[d][r][1])}},yse=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var l=0,u=0;u<t;++u){var d=rd(e[u][r][1])?e[u][r][0]:e[u][r][1];d>=0?(e[u][r][0]=l,e[u][r][1]=l+d,l=e[u][r][1]):(e[u][r][0]=0,e[u][r][1]=0)}},xse={sign:vse,expand:eae,none:J_,silhouette:tae,wiggle:rae,positive:yse},wse=(e,t,r)=>{var n=xse[r],l=Jie().keys(t).value((u,d)=>+wl(u,d,0)).order(MT).offset(n);return l(e)};function bse(e){return e==null?void 0:String(e)}var MD=e=>{var{axis:t,ticks:r,offset:n,bandSize:l,entry:u,index:d}=e;if(t.type==="category")return r[d]?r[d].coordinate+n:null;var a=wl(u,t.dataKey,t.scale.domain()[d]);return Au(a)?null:t.scale(a)-l/2+n},Ese=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),l=Math.max(r[0],r[1]);return n<=0&&l>=0?0:l<0?l:n}return r[0]},Bse=e=>{var t=e.flat(2).filter(Ri);return[Math.min(...t),Math.max(...t)]},Cse=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Sse=(e,t,r)=>{if(e!=null)return Cse(Object.keys(e).reduce((n,l)=>{var u=e[l],{stackedData:d}=u,a=d.reduce((v,x)=>{var b=RQ(x,t,r),I=Bse(b);return[Math.min(v[0],I[0]),Math.max(v[1],I[1])]},[1/0,-1/0]);return[Math.min(a[0],n[0]),Math.max(a[1],n[1])]},[1/0,-1/0]))},OD=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,DD=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,VI=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var l=kb(t,b=>b.coordinate),u=1/0,d=1,a=l.length;d<a;d++){var v=l[d],x=l[d-1];u=Math.min((v.coordinate||0)-(x.coordinate||0),u)}return u===1/0?0:u}return r?void 0:0};function RD(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:l,name:u}=e;return ZA(ZA({},t),{},{dataKey:r,payload:n,value:l,name:u})}function Vb(e,t){if(e)return String(e);if(typeof t=="string")return t}function Tse(e,t,r,n,l){if(r==="horizontal"||r==="vertical"){var u=e>=l.left&&e<=l.left+l.width&&t>=l.top&&t<=l.top+l.height;return u?{x:e,y:t}:null}return n?hse({x:e,y:t},n):null}var Ise=(e,t,r,n)=>{var l=t.find(x=>x&&x.index===r);if(l){if(e==="horizontal")return{x:l.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:l.coordinate};if(e==="centric"){var u=l.coordinate,{radius:d}=n;return ZA(ZA(ZA({},n),Vc(n.cx,n.cy,d,u)),{},{angle:u,radius:d})}var a=l.coordinate,{angle:v}=n;return ZA(ZA(ZA({},n),Vc(n.cx,n.cy,a,v)),{},{angle:v,radius:a})}return{x:0,y:0}},Fse=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,wm=e=>e.layout.width,bm=e=>e.layout.height,Pse=e=>e.layout.scale,kQ=e=>e.layout.margin,GI=kr(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),KI=kr(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),UQ="data-recharts-item-index",NQ="data-recharts-item-data-key",Gb=60;function kD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function sg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kD(Object(r),!0).forEach(function(n){Lse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lse(e,t,r){return(t=Mse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mse(e){var t=Ose(e,"string");return typeof t=="symbol"?t:t+""}function Ose(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dse=e=>e.brush.height,du=kr([wm,bm,kQ,Dse,GI,KI,uQ,noe],(e,t,r,n,l,u,d,a)=>{var v=u.reduce((U,R)=>{var{orientation:H}=R;if(!R.mirror&&!R.hide){var q=typeof R.width=="number"?R.width:Gb;return sg(sg({},U),{},{[H]:U[H]+q})}return U},{left:r.left||0,right:r.right||0}),x=l.reduce((U,R)=>{var{orientation:H}=R;return!R.mirror&&!R.hide?sg(sg({},U),{},{[H]:Tg(U,"".concat(H))+R.height}):U},{top:r.top||0,bottom:r.bottom||0}),b=sg(sg({},x),v),I=b.bottom;b.bottom+=n,b=mse(b,d,a);var M=e-b.left-b.right,L=t-b.top-b.bottom;return sg(sg({brushBottom:I},b),{},{width:Math.max(M,0),height:Math.max(L,0)})}),Rse=kr(du,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),zQ=kr(wm,bm,(e,t)=>({x:0,y:0,width:e,height:t})),kse=Me.createContext(null),jd=()=>Me.useContext(kse)!=null,Kb=e=>e.brush,Wb=kr([Kb,du,kQ],(e,t,r)=>({height:e.height,x:Ri(e.x)?e.x:t.left,y:Ri(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:Ri(e.width)?e.width:t.width})),WI=()=>{var e,t=jd(),r=Yi(Rse),n=Yi(Wb),l=(e=Yi(Kb))===null||e===void 0?void 0:e.padding;return!t||!n||!l?r:{width:n.width-l.left-l.right,height:n.height-l.top-l.bottom,x:l.left,y:l.top}},Use={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Nse=()=>{var e;return(e=Yi(du))!==null&&e!==void 0?e:Use},zse=()=>Yi(wm),Qse=()=>Yi(bm),Uo=e=>e.layout.layoutType,qI=()=>Yi(Uo),jse={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},QQ=bA({name:"legend",initialState:jse,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=cm(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:SBe,setLegendSettings:TBe,addLegendPayload:jQ,removeLegendPayload:HQ}=QQ.actions,Hse=QQ.reducer;function HT(){return HT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HT.apply(null,arguments)}function UD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function qC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UD(Object(r),!0).forEach(function(n){Vse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vse(e,t,r){return(t=Gse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gse(e){var t=Kse(e,"string");return typeof t=="symbol"?t:t+""}function Kse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wse(e){return Array.isArray(e)&&Ip(e[0])&&Ip(e[1])?e.join(" ~ "):e}var qse=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:l={},payload:u,formatter:d,itemSorter:a,wrapperClassName:v,labelClassName:x,label:b,labelFormatter:I,accessibilityLayer:M=!1}=e,L=()=>{if(u&&u.length){var ye={padding:0,margin:0},Se=(a?kb(u,a):u).map((Be,De)=>{if(Be.type==="none")return null;var we=Be.formatter||d||Wse,{value:nt,name:_e}=Be,Ie=nt,Ze=_e;if(we){var st=we(nt,_e,Be,De,u);if(Array.isArray(st))[Ie,Ze]=st;else if(st!=null)Ie=st;else return null}var Et=qC({display:"block",paddingTop:4,paddingBottom:4,color:Be.color||"#000"},n);return Me.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(De),style:Et},Ip(Ze)?Me.createElement("span",{className:"recharts-tooltip-item-name"},Ze):null,Ip(Ze)?Me.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,Me.createElement("span",{className:"recharts-tooltip-item-value"},Ie),Me.createElement("span",{className:"recharts-tooltip-item-unit"},Be.unit||""))});return Me.createElement("ul",{className:"recharts-tooltip-item-list",style:ye},Se)}return null},U=qC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),R=qC({margin:0},l),H=!Au(b),q=H?b:"",te=Bs("recharts-default-tooltip",v),J=Bs("recharts-tooltip-label",x);H&&I&&u!==void 0&&u!==null&&(q=I(b,u));var se=M?{role:"status","aria-live":"assertive"}:{};return Me.createElement("div",HT({className:te,style:U},se),Me.createElement("p",{className:J,style:R},Me.isValidElement(q)?q:"".concat(q)),L())},vy="recharts-tooltip-wrapper",$se={visibility:"hidden"};function Xse(e){var{coordinate:t,translateX:r,translateY:n}=e;return Bs(vy,{["".concat(vy,"-right")]:Ri(r)&&t&&Ri(t.x)&&r>=t.x,["".concat(vy,"-left")]:Ri(r)&&t&&Ri(t.x)&&r<t.x,["".concat(vy,"-bottom")]:Ri(n)&&t&&Ri(t.y)&&n>=t.y,["".concat(vy,"-top")]:Ri(n)&&t&&Ri(t.y)&&n<t.y})}function ND(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:l,position:u,reverseDirection:d,tooltipDimension:a,viewBox:v,viewBoxDimension:x}=e;if(u&&Ri(u[n]))return u[n];var b=r[n]-a-(l>0?l:0),I=r[n]+l;if(t[n])return d[n]?b:I;var M=v[n];if(M==null)return 0;if(d[n]){var L=b,U=M;return L<U?Math.max(I,M):Math.max(b,M)}if(x==null)return 0;var R=I+a,H=M+x;return R>H?Math.max(b,M):Math.max(I,M)}function Zse(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Yse(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:l,reverseDirection:u,tooltipBox:d,useTranslate3d:a,viewBox:v}=e,x,b,I;return d.height>0&&d.width>0&&r?(b=ND({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:l,reverseDirection:u,tooltipDimension:d.width,viewBox:v,viewBoxDimension:v.width}),I=ND({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:l,reverseDirection:u,tooltipDimension:d.height,viewBox:v,viewBoxDimension:v.height}),x=Zse({translateX:b,translateY:I,useTranslate3d:a})):x=$se,{cssProperties:x,cssClasses:Xse({translateX:b,translateY:I,coordinate:r})}}function zD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function sw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zD(Object(r),!0).forEach(function(n){VT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VT(e,t,r){return(t=Jse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jse(e){var t=ele(e,"string");return typeof t=="symbol"?t:t+""}function ele(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class tle extends Me.PureComponent{constructor(){super(...arguments),VT(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),VT(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,l,u;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(l=(u=this.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:l,children:u,coordinate:d,hasPayload:a,isAnimationActive:v,offset:x,position:b,reverseDirection:I,useTranslate3d:M,viewBox:L,wrapperStyle:U,lastBoundingBox:R,innerRef:H,hasPortalFromProps:q}=this.props,{cssClasses:te,cssProperties:J}=Yse({allowEscapeViewBox:r,coordinate:d,offsetTopLeft:x,position:b,reverseDirection:I,tooltipBox:{height:R.height,width:R.width},useTranslate3d:M,viewBox:L}),se=q?{}:sw(sw({transition:v&&t?"transform ".concat(n,"ms ").concat(l):void 0},J),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&a?"visible":"hidden",position:"absolute",top:0,left:0}),ye=sw(sw({},se),{},{visibility:!this.state.dismissed&&t&&a?"visible":"hidden"},U);return Me.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:te,style:ye,ref:H},u)}}var rle=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),yv={isSsr:rle()},VQ=()=>Yi(e=>e.rootProps.accessibilityLayer);function wA(e){return Number.isFinite(e)}function tv(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function GT(){return GT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GT.apply(null,arguments)}function QD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function jD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QD(Object(r),!0).forEach(function(n){nle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nle(e,t,r){return(t=ile(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ile(e){var t=ale(e,"string");return typeof t=="symbol"?t:t+""}function ale(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HD={curveBasisClosed:jie,curveBasisOpen:Hie,curveBasis:Qie,curveBumpX:Sie,curveBumpY:Tie,curveLinearClosed:Vie,curveLinear:Db,curveMonotoneX:Gie,curveMonotoneY:Kie,curveNatural:Wie,curveStep:qie,curveStepAfter:Xie,curveStepBefore:$ie},lw=e=>wA(e.x)&&wA(e.y),yy=e=>e.x,xy=e=>e.y,ole=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(D1(e));return(r==="curveMonotone"||r==="curveBump")&&t?HD["".concat(r).concat(t==="vertical"?"Y":"X")]:HD[r]||Db},sle=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:l,connectNulls:u=!1}=e,d=ole(t,l),a=u?r.filter(lw):r,v;if(Array.isArray(n)){var x=u?n.filter(I=>lw(I)):n,b=a.map((I,M)=>jD(jD({},I),{},{base:x[M]}));return l==="vertical"?v=rw().y(xy).x1(yy).x0(I=>I.base.x):v=rw().x(yy).y1(xy).y0(I=>I.base.y),v.defined(lw).curve(d),v(b)}return l==="vertical"&&Ri(n)?v=rw().y(xy).x1(yy).x0(n):Ri(n)?v=rw().x(yy).y1(xy).y0(n):v=jz().x(yy).y(xy),v.defined(lw).curve(d),v(a)},GQ=e=>{var{className:t,points:r,path:n,pathRef:l}=e;if((!r||!r.length)&&!n)return null;var u=r&&r.length?sle(e):n;return Me.createElement("path",GT({},vv(e),Aie(e),{className:Bs("recharts-curve",t),d:u===null?void 0:u,ref:l}))},lle=["x","y","top","left","width","height","className"];function KT(){return KT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KT.apply(null,arguments)}function VD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function cle(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VD(Object(r),!0).forEach(function(n){ule(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ule(e,t,r){return(t=hle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hle(e){var t=fle(e,"string");return typeof t=="symbol"?t:t+""}function fle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ale(e,t){if(e==null)return{};var r,n,l=dle(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function dle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ple=(e,t,r,n,l,u)=>"M".concat(e,",").concat(l,"v").concat(n,"M").concat(u,",").concat(t,"h").concat(r),mle=e=>{var{x:t=0,y:r=0,top:n=0,left:l=0,width:u=0,height:d=0,className:a}=e,v=Ale(e,lle),x=cle({x:t,y:r,top:n,left:l,width:u,height:d},v);return!Ri(t)||!Ri(r)||!Ri(u)||!Ri(d)||!Ri(n)||!Ri(l)?null:Me.createElement("path",KT({},Hc(x,!0),{className:Bs("recharts-cross",a),d:ple(t,r,u,d,n,l)}))};function gle(e,t,r,n){var l=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-l:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-l,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function GD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function _le(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GD(Object(r),!0).forEach(function(n){vle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vle(e,t,r){return(t=yle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yle(e){var t=xle(e,"string");return typeof t=="symbol"?t:t+""}function xle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lp(e,t){var r=_le({},e),n=t,l=Object.keys(t),u=l.reduce((d,a)=>(d[a]===void 0&&n[a]!==void 0&&(d[a]=n[a]),d),r);return u}var $C={},XC={},ZC={},KD;function wle(){return KD||(KD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}e.isPlainObject=t}(ZC)),ZC}var WD;function ble(){return WD||(WD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wle(),r=iQ(),n=RI(),l=kI(),u=OI();function d(x,b,I){return a(x,b,void 0,void 0,void 0,void 0,I)}function a(x,b,I,M,L,U,R){const H=R(x,b,I,M,L,U);if(H!==void 0)return H;if(typeof x==typeof b)switch(typeof x){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return x===b;case"number":return x===b||Object.is(x,b);case"function":return x===b;case"object":return v(x,b,U,R)}return v(x,b,U,R)}function v(x,b,I,M){if(Object.is(x,b))return!0;let L=n.getTag(x),U=n.getTag(b);if(L===l.argumentsTag&&(L=l.objectTag),U===l.argumentsTag&&(U=l.objectTag),L!==U)return!1;switch(L){case l.stringTag:return x.toString()===b.toString();case l.numberTag:{const q=x.valueOf(),te=b.valueOf();return u.eq(q,te)}case l.booleanTag:case l.dateTag:case l.symbolTag:return Object.is(x.valueOf(),b.valueOf());case l.regexpTag:return x.source===b.source&&x.flags===b.flags;case l.functionTag:return x===b}I=I??new Map;const R=I.get(x),H=I.get(b);if(R!=null&&H!=null)return R===b;I.set(x,b),I.set(b,x);try{switch(L){case l.mapTag:{if(x.size!==b.size)return!1;for(const[q,te]of x.entries())if(!b.has(q)||!a(te,b.get(q),q,x,b,I,M))return!1;return!0}case l.setTag:{if(x.size!==b.size)return!1;const q=Array.from(x.values()),te=Array.from(b.values());for(let J=0;J<q.length;J++){const se=q[J],ye=te.findIndex(Se=>a(se,Se,void 0,x,b,I,M));if(ye===-1)return!1;te.splice(ye,1)}return!0}case l.arrayTag:case l.uint8ArrayTag:case l.uint8ClampedArrayTag:case l.uint16ArrayTag:case l.uint32ArrayTag:case l.bigUint64ArrayTag:case l.int8ArrayTag:case l.int16ArrayTag:case l.int32ArrayTag:case l.bigInt64ArrayTag:case l.float32ArrayTag:case l.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(x)!==Buffer.isBuffer(b)||x.length!==b.length)return!1;for(let q=0;q<x.length;q++)if(!a(x[q],b[q],q,x,b,I,M))return!1;return!0}case l.arrayBufferTag:return x.byteLength!==b.byteLength?!1:v(new Uint8Array(x),new Uint8Array(b),I,M);case l.dataViewTag:return x.byteLength!==b.byteLength||x.byteOffset!==b.byteOffset?!1:v(new Uint8Array(x),new Uint8Array(b),I,M);case l.errorTag:return x.name===b.name&&x.message===b.message;case l.objectTag:{if(!(v(x.constructor,b.constructor,I,M)||t.isPlainObject(x)&&t.isPlainObject(b)))return!1;const te=[...Object.keys(x),...r.getSymbols(x)],J=[...Object.keys(b),...r.getSymbols(b)];if(te.length!==J.length)return!1;for(let se=0;se<te.length;se++){const ye=te[se],Se=x[ye];if(!Object.hasOwn(b,ye))return!1;const Be=b[ye];if(!a(Se,Be,ye,x,b,I,M))return!1}return!0}default:return!1}}finally{I.delete(x),I.delete(b)}}e.isEqualWith=d}(XC)),XC}var YC={},qD;function Ele(){return qD||(qD=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(){}e.noop=t}(YC)),YC}var $D;function Ble(){return $D||($D=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ble(),r=Ele();function n(l,u){return t.isEqualWith(l,u,r.noop)}e.isEqual=n}($C)),$C}var JC,XD;function Cle(){return XD||(XD=1,JC=Ble().isEqual),JC}var Sle=Cle();const Tle=od(Sle);var N2=1e-4,KQ=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],WQ=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),ZD=(e,t)=>r=>{var n=KQ(e,t);return WQ(n,r)},Ile=(e,t)=>r=>{var n=KQ(e,t),l=[...n.map((u,d)=>u*d).slice(1),0];return WQ(l,r)},YD=function(){for(var t,r,n,l,u=arguments.length,d=new Array(u),a=0;a<u;a++)d[a]=arguments[a];if(d.length===1)switch(d[0]){case"linear":[t,n,r,l]=[0,0,1,1];break;case"ease":[t,n,r,l]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,l]=[.42,0,1,1];break;case"ease-out":[t,n,r,l]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,l]=[0,0,.58,1];break;default:{var v=d[0].split("(");v[0]==="cubic-bezier"&&v[1].split(")")[0].split(",").length===4&&([t,n,r,l]=v[1].split(")")[0].split(",").map(U=>parseFloat(U)))}}else d.length===4&&([t,n,r,l]=d);var x=ZD(t,r),b=ZD(n,l),I=Ile(t,r),M=U=>U>1?1:U<0?0:U,L=U=>{for(var R=U>1?1:U,H=R,q=0;q<8;++q){var te=x(H)-R,J=I(H);if(Math.abs(te-R)<N2||J<N2)return b(H);H=M(H-te/J)}return b(H)};return L.isStepper=!1,L},Fle=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:l=17}=t,u=(d,a,v)=>{var x=-(d-a)*r,b=v*n,I=v+(x-b)*l/1e3,M=v*l/1e3+d;return Math.abs(M-a)<N2&&Math.abs(I)<N2?[a,0]:[M,I]};return u.isStepper=!0,u.dt=l,u},qQ=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return YD(e);case"spring":return Fle();default:if(e.split("(")[0]==="cubic-bezier")return YD(e)}return typeof e=="function"?e:null};function JD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function eR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JD(Object(r),!0).forEach(function(n){Ple(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ple(e,t,r){return(t=Lle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lle(e){var t=Mle(e,"string");return typeof t=="symbol"?t:t+""}function Mle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ole=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Dle=(e,t,r)=>e.map(n=>"".concat(Ole(n)," ").concat(t,"ms ").concat(r)).join(","),Rle=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(l=>n.includes(l))),p1=(e,t)=>Object.keys(t).reduce((r,n)=>eR(eR({},r),{},{[n]:e(n,t[n])}),{});function tR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function ah(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tR(Object(r),!0).forEach(function(n){kle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kle(e,t,r){return(t=Ule(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ule(e){var t=Nle(e,"string");return typeof t=="symbol"?t:t+""}function Nle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z2=(e,t,r)=>e+(t-e)*r,WT=e=>{var{from:t,to:r}=e;return t!==r},$Q=(e,t,r)=>{var n=p1((l,u)=>{if(WT(u)){var[d,a]=e(u.from,u.to,u.velocity);return ah(ah({},u),{},{from:d,velocity:a})}return u},t);return r<1?p1((l,u)=>WT(u)?ah(ah({},u),{},{velocity:z2(u.velocity,n[l].velocity,r),from:z2(u.from,n[l].from,r)}):u,t):$Q(e,n,r-1)};function zle(e,t,r,n,l,u){var d,a=n.reduce((M,L)=>ah(ah({},M),{},{[L]:{from:e[L],velocity:0,to:t[L]}}),{}),v=()=>p1((M,L)=>L.from,a),x=()=>!Object.values(a).filter(WT).length,b=null,I=M=>{d||(d=M);var L=M-d,U=L/r.dt;a=$Q(r,a,U),l(ah(ah(ah({},e),t),v())),d=M,x()||(b=u.setTimeout(I))};return()=>(b=u.setTimeout(I),()=>{b()})}function Qle(e,t,r,n,l,u,d){var a=null,v=l.reduce((I,M)=>ah(ah({},I),{},{[M]:[e[M],t[M]]}),{}),x,b=I=>{x||(x=I);var M=(I-x)/n,L=p1((R,H)=>z2(...H,r(M)),v);if(u(ah(ah(ah({},e),t),L)),M<1)a=d.setTimeout(b);else{var U=p1((R,H)=>z2(...H,r(1)),v);u(ah(ah(ah({},e),t),U))}};return()=>(a=d.setTimeout(b),()=>{a()})}const XQ=(e,t,r,n,l,u)=>{var d=Rle(e,t);return r.isStepper===!0?zle(e,t,r,d,l,u):Qle(e,t,r,n,d,l,u)};function jle(e){var t,r=()=>null,n=!1,l=null,u=d=>{if(!n){if(Array.isArray(d)){if(!d.length)return;var a=d,[v,...x]=a;if(typeof v=="number"){l=e.setTimeout(u.bind(null,x),v);return}u(v),l=e.setTimeout(u.bind(null,x));return}typeof d=="string"&&(t=d,r(t)),typeof d=="object"&&(t=d,r(t)),typeof d=="function"&&d()}};return{stop:()=>{n=!0},start:d=>{n=!1,l&&(l(),l=null),u(d)},subscribe:d=>(r=d,()=>{r=()=>null}),getTimeoutController:()=>e}}class Hle{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),l=null,u=d=>{d-n>=r?t(d):typeof requestAnimationFrame=="function"&&(l=requestAnimationFrame(u))};return l=requestAnimationFrame(u),()=>{cancelAnimationFrame(l)}}}function Vle(){return jle(new Hle)}var Gle=Me.createContext(Vle);function ZQ(e,t){var r=Me.useContext(Gle);return Me.useMemo(()=>t??r(e),[e,t,r])}var Kle=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function qT(){return qT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qT.apply(null,arguments)}function Wle(e,t){if(e==null)return{};var r,n,l=qle(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function qle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function rR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function lg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rR(Object(r),!0).forEach(function(n){h0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h0(e,t,r){return(t=$le(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $le(e){var t=Xle(e,"string");return typeof t=="symbol"?t:t+""}function Xle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class $I extends Me.PureComponent{constructor(t,r){super(t,r),h0(this,"mounted",!1),h0(this,"manager",void 0),h0(this,"stopJSAnimation",null),h0(this,"unSubscribe",null);var{isActive:n,attributeName:l,from:u,to:d,children:a,duration:v,animationManager:x}=this.props;if(this.manager=x,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||v<=0){this.state={style:{}},typeof a=="function"&&(this.state={style:d});return}if(u){if(typeof a=="function"){this.state={style:u};return}this.state={style:l?{[l]:u}:u}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:r}=this.props;this.mounted=!0,!(!t||!r)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:r,canBegin:n,attributeName:l,shouldReAnimate:u,to:d,from:a}=this.props,{style:v}=this.state;if(n){if(!r){var x={style:l?{[l]:d}:d};this.state&&v&&(l&&v[l]!==d||!l&&v!==d)&&this.setState(x);return}if(!(Tle(t.to,d)&&t.canBegin&&t.isActive)){var b=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var I=b||u?a:t.to;if(this.state&&v){var M={style:l?{[l]:I}:I};(l&&v[l]!==I||!l&&v!==I)&&this.setState(M)}this.runAnimation(lg(lg({},this.props),{},{from:I,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:r,to:n,duration:l,easing:u,begin:d,onAnimationEnd:a,onAnimationStart:v}=t,x=XQ(r,n,qQ(u),l,this.changeStyle,this.manager.getTimeoutController()),b=()=>{this.stopJSAnimation=x()};this.manager.start([v,d,b,l,a])}runAnimation(t){var{begin:r,duration:n,attributeName:l,to:u,easing:d,onAnimationStart:a,onAnimationEnd:v,children:x}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof d=="function"||typeof x=="function"||d==="spring"){this.runJSAnimation(t);return}var b=l?{[l]:u}:u,I=Dle(Object.keys(b),n,d);this.manager.start([a,r,lg(lg({},b),{},{transition:I}),n,v])}render(){var t=this.props,{children:r,begin:n,duration:l,attributeName:u,easing:d,isActive:a,from:v,to:x,canBegin:b,onAnimationEnd:I,shouldReAnimate:M,onAnimationReStart:L,animationManager:U}=t,R=Wle(t,Kle),H=Me.Children.count(r),q=this.state.style;if(typeof r=="function")return r(q);if(!a||H===0||l<=0)return r;var te=J=>{var{style:se={},className:ye}=J.props,Se=Me.cloneElement(J,lg(lg({},R),{},{style:lg(lg({},se),q),className:ye}));return Se};return H===1?te(Me.Children.only(r)):Me.createElement("div",null,Me.Children.map(r,J=>te(J)))}}h0($I,"displayName","Animate");h0($I,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});function Q2(e){var t,r=ZQ((t=e.attributeName)!==null&&t!==void 0?t:Object.keys(e.to).join(","),e.animationManager);return Me.createElement($I,qT({},e,{animationManager:r}))}function j2(){return j2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},j2.apply(null,arguments)}var nR=(e,t,r,n,l)=>{var u=Math.min(Math.abs(r)/2,Math.abs(n)/2),d=n>=0?1:-1,a=r>=0?1:-1,v=n>=0&&r>=0||n<0&&r<0?1:0,x;if(u>0&&l instanceof Array){for(var b=[0,0,0,0],I=0,M=4;I<M;I++)b[I]=l[I]>u?u:l[I];x="M".concat(e,",").concat(t+d*b[0]),b[0]>0&&(x+="A ".concat(b[0],",").concat(b[0],",0,0,").concat(v,",").concat(e+a*b[0],",").concat(t)),x+="L ".concat(e+r-a*b[1],",").concat(t),b[1]>0&&(x+="A ".concat(b[1],",").concat(b[1],",0,0,").concat(v,`,
        `).concat(e+r,",").concat(t+d*b[1])),x+="L ".concat(e+r,",").concat(t+n-d*b[2]),b[2]>0&&(x+="A ".concat(b[2],",").concat(b[2],",0,0,").concat(v,`,
        `).concat(e+r-a*b[2],",").concat(t+n)),x+="L ".concat(e+a*b[3],",").concat(t+n),b[3]>0&&(x+="A ".concat(b[3],",").concat(b[3],",0,0,").concat(v,`,
        `).concat(e,",").concat(t+n-d*b[3])),x+="Z"}else if(u>0&&l===+l&&l>0){var L=Math.min(u,l);x="M ".concat(e,",").concat(t+d*L,`
            A `).concat(L,",").concat(L,",0,0,").concat(v,",").concat(e+a*L,",").concat(t,`
            L `).concat(e+r-a*L,",").concat(t,`
            A `).concat(L,",").concat(L,",0,0,").concat(v,",").concat(e+r,",").concat(t+d*L,`
            L `).concat(e+r,",").concat(t+n-d*L,`
            A `).concat(L,",").concat(L,",0,0,").concat(v,",").concat(e+r-a*L,",").concat(t+n,`
            L `).concat(e+a*L,",").concat(t+n,`
            A `).concat(L,",").concat(L,",0,0,").concat(v,",").concat(e,",").concat(t+n-d*L," Z")}else x="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return x},Zle={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},YQ=e=>{var t=Lp(e,Zle),r=Me.useRef(null),[n,l]=Me.useState(-1);Me.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var q=r.current.getTotalLength();q&&l(q)}catch{}},[]);var{x:u,y:d,width:a,height:v,radius:x,className:b}=t,{animationEasing:I,animationDuration:M,animationBegin:L,isAnimationActive:U,isUpdateAnimationActive:R}=t;if(u!==+u||d!==+d||a!==+a||v!==+v||a===0||v===0)return null;var H=Bs("recharts-rectangle",b);return R?Me.createElement(Q2,{canBegin:n>0,from:{width:a,height:v,x:u,y:d},to:{width:a,height:v,x:u,y:d},duration:M,animationEasing:I,isActive:R},q=>{var{width:te,height:J,x:se,y:ye}=q;return Me.createElement(Q2,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:L,duration:M,isActive:U,easing:I},Me.createElement("path",j2({},Hc(t,!0),{className:H,d:nR(se,ye,te,J,x),ref:r})))}):Me.createElement("path",j2({},Hc(t,!0),{className:H,d:nR(u,d,a,v,x)}))};function JQ(e){var{cx:t,cy:r,radius:n,startAngle:l,endAngle:u}=e,d=Vc(t,r,n,l),a=Vc(t,r,n,u);return{points:[d,a],cx:t,cy:r,radius:n,startAngle:l,endAngle:u}}function $T(){return $T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$T.apply(null,arguments)}var Yle=(e,t)=>{var r=lh(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},cw=e=>{var{cx:t,cy:r,radius:n,angle:l,sign:u,isExternal:d,cornerRadius:a,cornerIsExternal:v}=e,x=a*(d?1:-1)+n,b=Math.asin(a/x)/U2,I=v?l:l+u*b,M=Vc(t,r,x,I),L=Vc(t,r,n,I),U=v?l-u*b:l,R=Vc(t,r,x*Math.cos(b*U2),U);return{center:M,circleTangency:L,lineTangency:R,theta:b}},e7=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:l,startAngle:u,endAngle:d}=e,a=Yle(u,d),v=u+a,x=Vc(t,r,l,u),b=Vc(t,r,l,v),I="M ".concat(x.x,",").concat(x.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(a)>180),",").concat(+(u>v),`,
    `).concat(b.x,",").concat(b.y,`
  `);if(n>0){var M=Vc(t,r,n,u),L=Vc(t,r,n,v);I+="L ".concat(L.x,",").concat(L.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(a)>180),",").concat(+(u<=v),`,
            `).concat(M.x,",").concat(M.y," Z")}else I+="L ".concat(t,",").concat(r," Z");return I},Jle=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:l,cornerRadius:u,forceCornerRadius:d,cornerIsExternal:a,startAngle:v,endAngle:x}=e,b=lh(x-v),{circleTangency:I,lineTangency:M,theta:L}=cw({cx:t,cy:r,radius:l,angle:v,sign:b,cornerRadius:u,cornerIsExternal:a}),{circleTangency:U,lineTangency:R,theta:H}=cw({cx:t,cy:r,radius:l,angle:x,sign:-b,cornerRadius:u,cornerIsExternal:a}),q=a?Math.abs(v-x):Math.abs(v-x)-L-H;if(q<0)return d?"M ".concat(M.x,",").concat(M.y,`
        a`).concat(u,",").concat(u,",0,0,1,").concat(u*2,`,0
        a`).concat(u,",").concat(u,",0,0,1,").concat(-u*2,`,0
      `):e7({cx:t,cy:r,innerRadius:n,outerRadius:l,startAngle:v,endAngle:x});var te="M ".concat(M.x,",").concat(M.y,`
    A`).concat(u,",").concat(u,",0,0,").concat(+(b<0),",").concat(I.x,",").concat(I.y,`
    A`).concat(l,",").concat(l,",0,").concat(+(q>180),",").concat(+(b<0),",").concat(U.x,",").concat(U.y,`
    A`).concat(u,",").concat(u,",0,0,").concat(+(b<0),",").concat(R.x,",").concat(R.y,`
  `);if(n>0){var{circleTangency:J,lineTangency:se,theta:ye}=cw({cx:t,cy:r,radius:n,angle:v,sign:b,isExternal:!0,cornerRadius:u,cornerIsExternal:a}),{circleTangency:Se,lineTangency:Be,theta:De}=cw({cx:t,cy:r,radius:n,angle:x,sign:-b,isExternal:!0,cornerRadius:u,cornerIsExternal:a}),we=a?Math.abs(v-x):Math.abs(v-x)-ye-De;if(we<0&&u===0)return"".concat(te,"L").concat(t,",").concat(r,"Z");te+="L".concat(Be.x,",").concat(Be.y,`
      A`).concat(u,",").concat(u,",0,0,").concat(+(b<0),",").concat(Se.x,",").concat(Se.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(we>180),",").concat(+(b>0),",").concat(J.x,",").concat(J.y,`
      A`).concat(u,",").concat(u,",0,0,").concat(+(b<0),",").concat(se.x,",").concat(se.y,"Z")}else te+="L".concat(t,",").concat(r,"Z");return te},ece={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},t7=e=>{var t=Lp(e,ece),{cx:r,cy:n,innerRadius:l,outerRadius:u,cornerRadius:d,forceCornerRadius:a,cornerIsExternal:v,startAngle:x,endAngle:b,className:I}=t;if(u<l||x===b)return null;var M=Bs("recharts-sector",I),L=u-l,U=uf(d,L,0,!0),R;return U>0&&Math.abs(x-b)<360?R=Jle({cx:r,cy:n,innerRadius:l,outerRadius:u,cornerRadius:Math.min(U,L/2),forceCornerRadius:a,cornerIsExternal:v,startAngle:x,endAngle:b}):R=e7({cx:r,cy:n,innerRadius:l,outerRadius:u,startAngle:x,endAngle:b}),Me.createElement("path",$T({},Hc(t,!0),{className:M,d:R}))};function tce(e,t,r){var n,l,u,d;if(e==="horizontal")n=t.x,u=n,l=r.top,d=r.top+r.height;else if(e==="vertical")l=t.y,d=l,n=r.left,u=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:a,cy:v,innerRadius:x,outerRadius:b,angle:I}=t,M=Vc(a,v,x,I),L=Vc(a,v,b,I);n=M.x,l=M.y,u=L.x,d=L.y}else return JQ(t);return[{x:n,y:l},{x:u,y:d}]}var eS={},tS={},rS={},iR;function rce(){return iR||(iR=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lQ();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r}(rS)),rS}var aR;function nce(){return aR||(aR=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rce();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r}(tS)),tS}var oR;function ice(){return oR||(oR=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cQ(),r=nce();function n(l,u,d){d&&typeof d!="number"&&t.isIterateeCall(l,u,d)&&(u=d=void 0),l=r.toFinite(l),u===void 0?(u=l,l=0):u=r.toFinite(u),d=d===void 0?l<u?1:-1:r.toFinite(d);const a=Math.max(Math.ceil((u-l)/(d||1)),0),v=new Array(a);for(let x=0;x<a;x++)v[x]=l,l+=d;return v}e.range=n}(eS)),eS}var nS,sR;function ace(){return sR||(sR=1,nS=ice().range),nS}var oce=ace();const r7=od(oce);function wg(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function sce(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function XI(e){let t,r,n;e.length!==2?(t=wg,r=(a,v)=>wg(e(a),v),n=(a,v)=>e(a)-v):(t=e===wg||e===sce?e:lce,r=e,n=e);function l(a,v,x=0,b=a.length){if(x<b){if(t(v,v)!==0)return b;do{const I=x+b>>>1;r(a[I],v)<0?x=I+1:b=I}while(x<b)}return x}function u(a,v,x=0,b=a.length){if(x<b){if(t(v,v)!==0)return b;do{const I=x+b>>>1;r(a[I],v)<=0?x=I+1:b=I}while(x<b)}return x}function d(a,v,x=0,b=a.length){const I=l(a,v,x,b-1);return I>x&&n(a[I-1],v)>-n(a[I],v)?I-1:I}return{left:l,center:d,right:u}}function lce(){return 0}function n7(e){return e===null?NaN:+e}function*cce(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const uce=XI(wg),U1=uce.right;XI(n7).center;class lR extends Map{constructor(t,r=Ace){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,l]of t)this.set(n,l)}get(t){return super.get(cR(this,t))}has(t){return super.has(cR(this,t))}set(t,r){return super.set(hce(this,t),r)}delete(t){return super.delete(fce(this,t))}}function cR({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function hce({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function fce({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function Ace(e){return e!==null&&typeof e=="object"?e.valueOf():e}function dce(e=wg){if(e===wg)return i7;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function i7(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const pce=Math.sqrt(50),mce=Math.sqrt(10),gce=Math.sqrt(2);function H2(e,t,r){const n=(t-e)/Math.max(0,r),l=Math.floor(Math.log10(n)),u=n/Math.pow(10,l),d=u>=pce?10:u>=mce?5:u>=gce?2:1;let a,v,x;return l<0?(x=Math.pow(10,-l)/d,a=Math.round(e*x),v=Math.round(t*x),a/x<e&&++a,v/x>t&&--v,x=-x):(x=Math.pow(10,l)*d,a=Math.round(e/x),v=Math.round(t/x),a*x<e&&++a,v*x>t&&--v),v<a&&.5<=r&&r<2?H2(e,t,r*2):[a,v,x]}function XT(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[l,u,d]=n?H2(t,e,r):H2(e,t,r);if(!(u>=l))return[];const a=u-l+1,v=new Array(a);if(n)if(d<0)for(let x=0;x<a;++x)v[x]=(u-x)/-d;else for(let x=0;x<a;++x)v[x]=(u-x)*d;else if(d<0)for(let x=0;x<a;++x)v[x]=(l+x)/-d;else for(let x=0;x<a;++x)v[x]=(l+x)*d;return v}function ZT(e,t,r){return t=+t,e=+e,r=+r,H2(e,t,r)[2]}function YT(e,t,r){t=+t,e=+e,r=+r;const n=t<e,l=n?ZT(t,e,r):ZT(e,t,r);return(n?-1:1)*(l<0?1/-l:l)}function uR(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function hR(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function a7(e,t,r=0,n=1/0,l){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(l=l===void 0?i7:dce(l);n>r;){if(n-r>600){const v=n-r+1,x=t-r+1,b=Math.log(v),I=.5*Math.exp(2*b/3),M=.5*Math.sqrt(b*I*(v-I)/v)*(x-v/2<0?-1:1),L=Math.max(r,Math.floor(t-x*I/v+M)),U=Math.min(n,Math.floor(t+(v-x)*I/v+M));a7(e,t,L,U,l)}const u=e[t];let d=r,a=n;for(wy(e,r,t),l(e[n],u)>0&&wy(e,r,n);d<a;){for(wy(e,d,a),++d,--a;l(e[d],u)<0;)++d;for(;l(e[a],u)>0;)--a}l(e[r],u)===0?wy(e,r,a):(++a,wy(e,a,n)),a<=t&&(r=a+1),t<=a&&(n=a-1)}return e}function wy(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function _ce(e,t,r){if(e=Float64Array.from(cce(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return hR(e);if(t>=1)return uR(e);var n,l=(n-1)*t,u=Math.floor(l),d=uR(a7(e,u).subarray(0,u+1)),a=hR(e.subarray(u+1));return d+(a-d)*(l-u)}}function vce(e,t,r=n7){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,l=(n-1)*t,u=Math.floor(l),d=+r(e[u],u,e),a=+r(e[u+1],u+1,e);return d+(a-d)*(l-u)}}function yce(e,t,r){e=+e,t=+t,r=(l=arguments.length)<2?(t=e,e=0,1):l<3?1:+r;for(var n=-1,l=Math.max(0,Math.ceil((t-e)/r))|0,u=new Array(l);++n<l;)u[n]=e+n*r;return u}function ld(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Em(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const JT=Symbol("implicit");function ZI(){var e=new lR,t=[],r=[],n=JT;function l(u){let d=e.get(u);if(d===void 0){if(n!==JT)return n;e.set(u,d=t.push(u)-1)}return r[d%r.length]}return l.domain=function(u){if(!arguments.length)return t.slice();t=[],e=new lR;for(const d of u)e.has(d)||e.set(d,t.push(d)-1);return l},l.range=function(u){return arguments.length?(r=Array.from(u),l):r.slice()},l.unknown=function(u){return arguments.length?(n=u,l):n},l.copy=function(){return ZI(t,r).unknown(n)},ld.apply(l,arguments),l}function YI(){var e=ZI().unknown(void 0),t=e.domain,r=e.range,n=0,l=1,u,d,a=!1,v=0,x=0,b=.5;delete e.unknown;function I(){var M=t().length,L=l<n,U=L?l:n,R=L?n:l;u=(R-U)/Math.max(1,M-v+x*2),a&&(u=Math.floor(u)),U+=(R-U-u*(M-v))*b,d=u*(1-v),a&&(U=Math.round(U),d=Math.round(d));var H=yce(M).map(function(q){return U+u*q});return r(L?H.reverse():H)}return e.domain=function(M){return arguments.length?(t(M),I()):t()},e.range=function(M){return arguments.length?([n,l]=M,n=+n,l=+l,I()):[n,l]},e.rangeRound=function(M){return[n,l]=M,n=+n,l=+l,a=!0,I()},e.bandwidth=function(){return d},e.step=function(){return u},e.round=function(M){return arguments.length?(a=!!M,I()):a},e.padding=function(M){return arguments.length?(v=Math.min(1,x=+M),I()):v},e.paddingInner=function(M){return arguments.length?(v=Math.min(1,M),I()):v},e.paddingOuter=function(M){return arguments.length?(x=+M,I()):x},e.align=function(M){return arguments.length?(b=Math.max(0,Math.min(1,M)),I()):b},e.copy=function(){return YI(t(),[n,l]).round(a).paddingInner(v).paddingOuter(x).align(b)},ld.apply(I(),arguments)}function o7(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return o7(t())},e}function xce(){return o7(YI.apply(null,arguments).paddingInner(1))}function JI(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function s7(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function N1(){}var m1=.7,V2=1/m1,K_="\\s*([+-]?\\d+)\\s*",g1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Sp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wce=/^#([0-9a-f]{3,8})$/,bce=new RegExp(`^rgb\\(${K_},${K_},${K_}\\)$`),Ece=new RegExp(`^rgb\\(${Sp},${Sp},${Sp}\\)$`),Bce=new RegExp(`^rgba\\(${K_},${K_},${K_},${g1}\\)$`),Cce=new RegExp(`^rgba\\(${Sp},${Sp},${Sp},${g1}\\)$`),Sce=new RegExp(`^hsl\\(${g1},${Sp},${Sp}\\)$`),Tce=new RegExp(`^hsla\\(${g1},${Sp},${Sp},${g1}\\)$`),fR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};JI(N1,_1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:AR,formatHex:AR,formatHex8:Ice,formatHsl:Fce,formatRgb:dR,toString:dR});function AR(){return this.rgb().formatHex()}function Ice(){return this.rgb().formatHex8()}function Fce(){return l7(this).formatHsl()}function dR(){return this.rgb().formatRgb()}function _1(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=wce.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?pR(t):r===3?new Pf(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?uw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?uw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=bce.exec(e))?new Pf(t[1],t[2],t[3],1):(t=Ece.exec(e))?new Pf(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Bce.exec(e))?uw(t[1],t[2],t[3],t[4]):(t=Cce.exec(e))?uw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Sce.exec(e))?_R(t[1],t[2]/100,t[3]/100,1):(t=Tce.exec(e))?_R(t[1],t[2]/100,t[3]/100,t[4]):fR.hasOwnProperty(e)?pR(fR[e]):e==="transparent"?new Pf(NaN,NaN,NaN,0):null}function pR(e){return new Pf(e>>16&255,e>>8&255,e&255,1)}function uw(e,t,r,n){return n<=0&&(e=t=r=NaN),new Pf(e,t,r,n)}function Pce(e){return e instanceof N1||(e=_1(e)),e?(e=e.rgb(),new Pf(e.r,e.g,e.b,e.opacity)):new Pf}function e5(e,t,r,n){return arguments.length===1?Pce(e):new Pf(e,t,r,n??1)}function Pf(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}JI(Pf,e5,s7(N1,{brighter(e){return e=e==null?V2:Math.pow(V2,e),new Pf(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?m1:Math.pow(m1,e),new Pf(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Pf(_0(this.r),_0(this.g),_0(this.b),G2(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:mR,formatHex:mR,formatHex8:Lce,formatRgb:gR,toString:gR}));function mR(){return`#${f0(this.r)}${f0(this.g)}${f0(this.b)}`}function Lce(){return`#${f0(this.r)}${f0(this.g)}${f0(this.b)}${f0((isNaN(this.opacity)?1:this.opacity)*255)}`}function gR(){const e=G2(this.opacity);return`${e===1?"rgb(":"rgba("}${_0(this.r)}, ${_0(this.g)}, ${_0(this.b)}${e===1?")":`, ${e})`}`}function G2(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function _0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function f0(e){return e=_0(e),(e<16?"0":"")+e.toString(16)}function _R(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Dd(e,t,r,n)}function l7(e){if(e instanceof Dd)return new Dd(e.h,e.s,e.l,e.opacity);if(e instanceof N1||(e=_1(e)),!e)return new Dd;if(e instanceof Dd)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,l=Math.min(t,r,n),u=Math.max(t,r,n),d=NaN,a=u-l,v=(u+l)/2;return a?(t===u?d=(r-n)/a+(r<n)*6:r===u?d=(n-t)/a+2:d=(t-r)/a+4,a/=v<.5?u+l:2-u-l,d*=60):a=v>0&&v<1?0:d,new Dd(d,a,v,e.opacity)}function Mce(e,t,r,n){return arguments.length===1?l7(e):new Dd(e,t,r,n??1)}function Dd(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}JI(Dd,Mce,s7(N1,{brighter(e){return e=e==null?V2:Math.pow(V2,e),new Dd(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?m1:Math.pow(m1,e),new Dd(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,l=2*r-n;return new Pf(iS(e>=240?e-240:e+120,l,n),iS(e,l,n),iS(e<120?e+240:e-120,l,n),this.opacity)},clamp(){return new Dd(vR(this.h),hw(this.s),hw(this.l),G2(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=G2(this.opacity);return`${e===1?"hsl(":"hsla("}${vR(this.h)}, ${hw(this.s)*100}%, ${hw(this.l)*100}%${e===1?")":`, ${e})`}`}}));function vR(e){return e=(e||0)%360,e<0?e+360:e}function hw(e){return Math.max(0,Math.min(1,e||0))}function iS(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const e3=e=>()=>e;function Oce(e,t){return function(r){return e+r*t}}function Dce(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Rce(e){return(e=+e)==1?c7:function(t,r){return r-t?Dce(t,r,e):e3(isNaN(t)?r:t)}}function c7(e,t){var r=t-e;return r?Oce(e,r):e3(isNaN(e)?t:e)}const yR=function e(t){var r=Rce(t);function n(l,u){var d=r((l=e5(l)).r,(u=e5(u)).r),a=r(l.g,u.g),v=r(l.b,u.b),x=c7(l.opacity,u.opacity);return function(b){return l.r=d(b),l.g=a(b),l.b=v(b),l.opacity=x(b),l+""}}return n.gamma=e,n}(1);function kce(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),l;return function(u){for(l=0;l<r;++l)n[l]=e[l]*(1-u)+t[l]*u;return n}}function Uce(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Nce(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,l=new Array(n),u=new Array(r),d;for(d=0;d<n;++d)l[d]=xv(e[d],t[d]);for(;d<r;++d)u[d]=t[d];return function(a){for(d=0;d<n;++d)u[d]=l[d](a);return u}}function zce(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function K2(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Qce(e,t){var r={},n={},l;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(l in t)l in e?r[l]=xv(e[l],t[l]):n[l]=t[l];return function(u){for(l in r)n[l]=r[l](u);return n}}var t5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,aS=new RegExp(t5.source,"g");function jce(e){return function(){return e}}function Hce(e){return function(t){return e(t)+""}}function Vce(e,t){var r=t5.lastIndex=aS.lastIndex=0,n,l,u,d=-1,a=[],v=[];for(e=e+"",t=t+"";(n=t5.exec(e))&&(l=aS.exec(t));)(u=l.index)>r&&(u=t.slice(r,u),a[d]?a[d]+=u:a[++d]=u),(n=n[0])===(l=l[0])?a[d]?a[d]+=l:a[++d]=l:(a[++d]=null,v.push({i:d,x:K2(n,l)})),r=aS.lastIndex;return r<t.length&&(u=t.slice(r),a[d]?a[d]+=u:a[++d]=u),a.length<2?v[0]?Hce(v[0].x):jce(t):(t=v.length,function(x){for(var b=0,I;b<t;++b)a[(I=v[b]).i]=I.x(x);return a.join("")})}function xv(e,t){var r=typeof t,n;return t==null||r==="boolean"?e3(t):(r==="number"?K2:r==="string"?(n=_1(t))?(t=n,yR):Vce:t instanceof _1?yR:t instanceof Date?zce:Uce(t)?kce:Array.isArray(t)?Nce:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Qce:K2)(e,t)}function t3(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Gce(e,t){t===void 0&&(t=e,e=xv);for(var r=0,n=t.length-1,l=t[0],u=new Array(n<0?0:n);r<n;)u[r]=e(l,l=t[++r]);return function(d){var a=Math.max(0,Math.min(n-1,Math.floor(d*=n)));return u[a](d-a)}}function Kce(e){return function(){return e}}function W2(e){return+e}var xR=[0,1];function lf(e){return e}function r5(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Kce(isNaN(t)?NaN:.5)}function Wce(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function qce(e,t,r){var n=e[0],l=e[1],u=t[0],d=t[1];return l<n?(n=r5(l,n),u=r(d,u)):(n=r5(n,l),u=r(u,d)),function(a){return u(n(a))}}function $ce(e,t,r){var n=Math.min(e.length,t.length)-1,l=new Array(n),u=new Array(n),d=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++d<n;)l[d]=r5(e[d],e[d+1]),u[d]=r(t[d],t[d+1]);return function(a){var v=U1(e,a,1,n)-1;return u[v](l[v](a))}}function z1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function qb(){var e=xR,t=xR,r=xv,n,l,u,d=lf,a,v,x;function b(){var M=Math.min(e.length,t.length);return d!==lf&&(d=Wce(e[0],e[M-1])),a=M>2?$ce:qce,v=x=null,I}function I(M){return M==null||isNaN(M=+M)?u:(v||(v=a(e.map(n),t,r)))(n(d(M)))}return I.invert=function(M){return d(l((x||(x=a(t,e.map(n),K2)))(M)))},I.domain=function(M){return arguments.length?(e=Array.from(M,W2),b()):e.slice()},I.range=function(M){return arguments.length?(t=Array.from(M),b()):t.slice()},I.rangeRound=function(M){return t=Array.from(M),r=t3,b()},I.clamp=function(M){return arguments.length?(d=M?!0:lf,b()):d!==lf},I.interpolate=function(M){return arguments.length?(r=M,b()):r},I.unknown=function(M){return arguments.length?(u=M,I):u},function(M,L){return n=M,l=L,b()}}function r3(){return qb()(lf,lf)}function Xce(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function q2(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function rv(e){return e=q2(Math.abs(e)),e?e[1]:NaN}function Zce(e,t){return function(r,n){for(var l=r.length,u=[],d=0,a=e[0],v=0;l>0&&a>0&&(v+a+1>n&&(a=Math.max(1,n-v)),u.push(r.substring(l-=a,l+a)),!((v+=a+1)>n));)a=e[d=(d+1)%e.length];return u.reverse().join(t)}}function Yce(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Jce=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function v1(e){if(!(t=Jce.exec(e)))throw new Error("invalid format: "+e);var t;return new n3({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}v1.prototype=n3.prototype;function n3(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}n3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function eue(e){e:for(var t=e.length,r=1,n=-1,l;r<t;++r)switch(e[r]){case".":n=l=r;break;case"0":n===0&&(n=r),l=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(l+1):e}var u7;function tue(e,t){var r=q2(e,t);if(!r)return e+"";var n=r[0],l=r[1],u=l-(u7=Math.max(-8,Math.min(8,Math.floor(l/3)))*3)+1,d=n.length;return u===d?n:u>d?n+new Array(u-d+1).join("0"):u>0?n.slice(0,u)+"."+n.slice(u):"0."+new Array(1-u).join("0")+q2(e,Math.max(0,t+u-1))[0]}function wR(e,t){var r=q2(e,t);if(!r)return e+"";var n=r[0],l=r[1];return l<0?"0."+new Array(-l).join("0")+n:n.length>l+1?n.slice(0,l+1)+"."+n.slice(l+1):n+new Array(l-n.length+2).join("0")}const bR={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Xce,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>wR(e*100,t),r:wR,s:tue,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ER(e){return e}var BR=Array.prototype.map,CR=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function rue(e){var t=e.grouping===void 0||e.thousands===void 0?ER:Zce(BR.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",l=e.decimal===void 0?".":e.decimal+"",u=e.numerals===void 0?ER:Yce(BR.call(e.numerals,String)),d=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",v=e.nan===void 0?"NaN":e.nan+"";function x(I){I=v1(I);var M=I.fill,L=I.align,U=I.sign,R=I.symbol,H=I.zero,q=I.width,te=I.comma,J=I.precision,se=I.trim,ye=I.type;ye==="n"?(te=!0,ye="g"):bR[ye]||(J===void 0&&(J=12),se=!0,ye="g"),(H||M==="0"&&L==="=")&&(H=!0,M="0",L="=");var Se=R==="$"?r:R==="#"&&/[boxX]/.test(ye)?"0"+ye.toLowerCase():"",Be=R==="$"?n:/[%p]/.test(ye)?d:"",De=bR[ye],we=/[defgprs%]/.test(ye);J=J===void 0?6:/[gprs]/.test(ye)?Math.max(1,Math.min(21,J)):Math.max(0,Math.min(20,J));function nt(_e){var Ie=Se,Ze=Be,st,Et,Ut;if(ye==="c")Ze=De(_e)+Ze,_e="";else{_e=+_e;var jt=_e<0||1/_e<0;if(_e=isNaN(_e)?v:De(Math.abs(_e),J),se&&(_e=eue(_e)),jt&&+_e==0&&U!=="+"&&(jt=!1),Ie=(jt?U==="("?U:a:U==="-"||U==="("?"":U)+Ie,Ze=(ye==="s"?CR[8+u7/3]:"")+Ze+(jt&&U==="("?")":""),we){for(st=-1,Et=_e.length;++st<Et;)if(Ut=_e.charCodeAt(st),48>Ut||Ut>57){Ze=(Ut===46?l+_e.slice(st+1):_e.slice(st))+Ze,_e=_e.slice(0,st);break}}}te&&!H&&(_e=t(_e,1/0));var bt=Ie.length+_e.length+Ze.length,Nt=bt<q?new Array(q-bt+1).join(M):"";switch(te&&H&&(_e=t(Nt+_e,Nt.length?q-Ze.length:1/0),Nt=""),L){case"<":_e=Ie+_e+Ze+Nt;break;case"=":_e=Ie+Nt+_e+Ze;break;case"^":_e=Nt.slice(0,bt=Nt.length>>1)+Ie+_e+Ze+Nt.slice(bt);break;default:_e=Nt+Ie+_e+Ze;break}return u(_e)}return nt.toString=function(){return I+""},nt}function b(I,M){var L=x((I=v1(I),I.type="f",I)),U=Math.max(-8,Math.min(8,Math.floor(rv(M)/3)))*3,R=Math.pow(10,-U),H=CR[8+U/3];return function(q){return L(R*q)+H}}return{format:x,formatPrefix:b}}var fw,i3,h7;nue({thousands:",",grouping:[3],currency:["$",""]});function nue(e){return fw=rue(e),i3=fw.format,h7=fw.formatPrefix,fw}function iue(e){return Math.max(0,-rv(Math.abs(e)))}function aue(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(rv(t)/3)))*3-rv(Math.abs(e)))}function oue(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,rv(t)-rv(e))+1}function f7(e,t,r,n){var l=YT(e,t,r),u;switch(n=v1(n??",f"),n.type){case"s":{var d=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(u=aue(l,d))&&(n.precision=u),h7(n,d)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(u=oue(l,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=u-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(u=iue(l))&&(n.precision=u-(n.type==="%")*2);break}}return i3(n)}function Mg(e){var t=e.domain;return e.ticks=function(r){var n=t();return XT(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var l=t();return f7(l[0],l[l.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),l=0,u=n.length-1,d=n[l],a=n[u],v,x,b=10;for(a<d&&(x=d,d=a,a=x,x=l,l=u,u=x);b-- >0;){if(x=ZT(d,a,r),x===v)return n[l]=d,n[u]=a,t(n);if(x>0)d=Math.floor(d/x)*x,a=Math.ceil(a/x)*x;else if(x<0)d=Math.ceil(d*x)/x,a=Math.floor(a*x)/x;else break;v=x}return e},e}function A7(){var e=r3();return e.copy=function(){return z1(e,A7())},ld.apply(e,arguments),Mg(e)}function d7(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,W2),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return d7(e).unknown(t)},e=arguments.length?Array.from(e,W2):[0,1],Mg(r)}function p7(e,t){e=e.slice();var r=0,n=e.length-1,l=e[r],u=e[n],d;return u<l&&(d=r,r=n,n=d,d=l,l=u,u=d),e[r]=t.floor(l),e[n]=t.ceil(u),e}function SR(e){return Math.log(e)}function TR(e){return Math.exp(e)}function sue(e){return-Math.log(-e)}function lue(e){return-Math.exp(-e)}function cue(e){return isFinite(e)?+("1e"+e):e<0?0:e}function uue(e){return e===10?cue:e===Math.E?Math.exp:t=>Math.pow(e,t)}function hue(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function IR(e){return(t,r)=>-e(-t,r)}function a3(e){const t=e(SR,TR),r=t.domain;let n=10,l,u;function d(){return l=hue(n),u=uue(n),r()[0]<0?(l=IR(l),u=IR(u),e(sue,lue)):e(SR,TR),t}return t.base=function(a){return arguments.length?(n=+a,d()):n},t.domain=function(a){return arguments.length?(r(a),d()):r()},t.ticks=a=>{const v=r();let x=v[0],b=v[v.length-1];const I=b<x;I&&([x,b]=[b,x]);let M=l(x),L=l(b),U,R;const H=a==null?10:+a;let q=[];if(!(n%1)&&L-M<H){if(M=Math.floor(M),L=Math.ceil(L),x>0){for(;M<=L;++M)for(U=1;U<n;++U)if(R=M<0?U/u(-M):U*u(M),!(R<x)){if(R>b)break;q.push(R)}}else for(;M<=L;++M)for(U=n-1;U>=1;--U)if(R=M>0?U/u(-M):U*u(M),!(R<x)){if(R>b)break;q.push(R)}q.length*2<H&&(q=XT(x,b,H))}else q=XT(M,L,Math.min(L-M,H)).map(u);return I?q.reverse():q},t.tickFormat=(a,v)=>{if(a==null&&(a=10),v==null&&(v=n===10?"s":","),typeof v!="function"&&(!(n%1)&&(v=v1(v)).precision==null&&(v.trim=!0),v=i3(v)),a===1/0)return v;const x=Math.max(1,n*a/t.ticks().length);return b=>{let I=b/u(Math.round(l(b)));return I*n<n-.5&&(I*=n),I<=x?v(b):""}},t.nice=()=>r(p7(r(),{floor:a=>u(Math.floor(l(a))),ceil:a=>u(Math.ceil(l(a)))})),t}function m7(){const e=a3(qb()).domain([1,10]);return e.copy=()=>z1(e,m7()).base(e.base()),ld.apply(e,arguments),e}function FR(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function PR(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function o3(e){var t=1,r=e(FR(t),PR(t));return r.constant=function(n){return arguments.length?e(FR(t=+n),PR(t)):t},Mg(r)}function g7(){var e=o3(qb());return e.copy=function(){return z1(e,g7()).constant(e.constant())},ld.apply(e,arguments)}function LR(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function fue(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Aue(e){return e<0?-e*e:e*e}function s3(e){var t=e(lf,lf),r=1;function n(){return r===1?e(lf,lf):r===.5?e(fue,Aue):e(LR(r),LR(1/r))}return t.exponent=function(l){return arguments.length?(r=+l,n()):r},Mg(t)}function l3(){var e=s3(qb());return e.copy=function(){return z1(e,l3()).exponent(e.exponent())},ld.apply(e,arguments),e}function due(){return l3.apply(null,arguments).exponent(.5)}function MR(e){return Math.sign(e)*e*e}function pue(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function _7(){var e=r3(),t=[0,1],r=!1,n;function l(u){var d=pue(e(u));return isNaN(d)?n:r?Math.round(d):d}return l.invert=function(u){return e.invert(MR(u))},l.domain=function(u){return arguments.length?(e.domain(u),l):e.domain()},l.range=function(u){return arguments.length?(e.range((t=Array.from(u,W2)).map(MR)),l):t.slice()},l.rangeRound=function(u){return l.range(u).round(!0)},l.round=function(u){return arguments.length?(r=!!u,l):r},l.clamp=function(u){return arguments.length?(e.clamp(u),l):e.clamp()},l.unknown=function(u){return arguments.length?(n=u,l):n},l.copy=function(){return _7(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ld.apply(l,arguments),Mg(l)}function v7(){var e=[],t=[],r=[],n;function l(){var d=0,a=Math.max(1,t.length);for(r=new Array(a-1);++d<a;)r[d-1]=vce(e,d/a);return u}function u(d){return d==null||isNaN(d=+d)?n:t[U1(r,d)]}return u.invertExtent=function(d){var a=t.indexOf(d);return a<0?[NaN,NaN]:[a>0?r[a-1]:e[0],a<r.length?r[a]:e[e.length-1]]},u.domain=function(d){if(!arguments.length)return e.slice();e=[];for(let a of d)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(wg),l()},u.range=function(d){return arguments.length?(t=Array.from(d),l()):t.slice()},u.unknown=function(d){return arguments.length?(n=d,u):n},u.quantiles=function(){return r.slice()},u.copy=function(){return v7().domain(e).range(t).unknown(n)},ld.apply(u,arguments)}function y7(){var e=0,t=1,r=1,n=[.5],l=[0,1],u;function d(v){return v!=null&&v<=v?l[U1(n,v,0,r)]:u}function a(){var v=-1;for(n=new Array(r);++v<r;)n[v]=((v+1)*t-(v-r)*e)/(r+1);return d}return d.domain=function(v){return arguments.length?([e,t]=v,e=+e,t=+t,a()):[e,t]},d.range=function(v){return arguments.length?(r=(l=Array.from(v)).length-1,a()):l.slice()},d.invertExtent=function(v){var x=l.indexOf(v);return x<0?[NaN,NaN]:x<1?[e,n[0]]:x>=r?[n[r-1],t]:[n[x-1],n[x]]},d.unknown=function(v){return arguments.length&&(u=v),d},d.thresholds=function(){return n.slice()},d.copy=function(){return y7().domain([e,t]).range(l).unknown(u)},ld.apply(Mg(d),arguments)}function x7(){var e=[.5],t=[0,1],r,n=1;function l(u){return u!=null&&u<=u?t[U1(e,u,0,n)]:r}return l.domain=function(u){return arguments.length?(e=Array.from(u),n=Math.min(e.length,t.length-1),l):e.slice()},l.range=function(u){return arguments.length?(t=Array.from(u),n=Math.min(e.length,t.length-1),l):t.slice()},l.invertExtent=function(u){var d=t.indexOf(u);return[e[d-1],e[d]]},l.unknown=function(u){return arguments.length?(r=u,l):r},l.copy=function(){return x7().domain(e).range(t).unknown(r)},ld.apply(l,arguments)}const oS=new Date,sS=new Date;function pu(e,t,r,n){function l(u){return e(u=arguments.length===0?new Date:new Date(+u)),u}return l.floor=u=>(e(u=new Date(+u)),u),l.ceil=u=>(e(u=new Date(u-1)),t(u,1),e(u),u),l.round=u=>{const d=l(u),a=l.ceil(u);return u-d<a-u?d:a},l.offset=(u,d)=>(t(u=new Date(+u),d==null?1:Math.floor(d)),u),l.range=(u,d,a)=>{const v=[];if(u=l.ceil(u),a=a==null?1:Math.floor(a),!(u<d)||!(a>0))return v;let x;do v.push(x=new Date(+u)),t(u,a),e(u);while(x<u&&u<d);return v},l.filter=u=>pu(d=>{if(d>=d)for(;e(d),!u(d);)d.setTime(d-1)},(d,a)=>{if(d>=d)if(a<0)for(;++a<=0;)for(;t(d,-1),!u(d););else for(;--a>=0;)for(;t(d,1),!u(d););}),r&&(l.count=(u,d)=>(oS.setTime(+u),sS.setTime(+d),e(oS),e(sS),Math.floor(r(oS,sS))),l.every=u=>(u=Math.floor(u),!isFinite(u)||!(u>0)?null:u>1?l.filter(n?d=>n(d)%u===0:d=>l.count(0,d)%u===0):l)),l}const $2=pu(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);$2.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?pu(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):$2);$2.range;const nm=1e3,JA=nm*60,im=JA*60,mm=im*24,c3=mm*7,OR=mm*30,lS=mm*365,A0=pu(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*nm)},(e,t)=>(t-e)/nm,e=>e.getUTCSeconds());A0.range;const u3=pu(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*nm)},(e,t)=>{e.setTime(+e+t*JA)},(e,t)=>(t-e)/JA,e=>e.getMinutes());u3.range;const h3=pu(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*JA)},(e,t)=>(t-e)/JA,e=>e.getUTCMinutes());h3.range;const f3=pu(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*nm-e.getMinutes()*JA)},(e,t)=>{e.setTime(+e+t*im)},(e,t)=>(t-e)/im,e=>e.getHours());f3.range;const A3=pu(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*im)},(e,t)=>(t-e)/im,e=>e.getUTCHours());A3.range;const Q1=pu(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*JA)/mm,e=>e.getDate()-1);Q1.range;const $b=pu(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/mm,e=>e.getUTCDate()-1);$b.range;const w7=pu(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/mm,e=>Math.floor(e/mm));w7.range;function z0(e){return pu(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*JA)/c3)}const Xb=z0(0),X2=z0(1),mue=z0(2),gue=z0(3),nv=z0(4),_ue=z0(5),vue=z0(6);Xb.range;X2.range;mue.range;gue.range;nv.range;_ue.range;vue.range;function Q0(e){return pu(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/c3)}const Zb=Q0(0),Z2=Q0(1),yue=Q0(2),xue=Q0(3),iv=Q0(4),wue=Q0(5),bue=Q0(6);Zb.range;Z2.range;yue.range;xue.range;iv.range;wue.range;bue.range;const d3=pu(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());d3.range;const p3=pu(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());p3.range;const gm=pu(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());gm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:pu(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});gm.range;const _m=pu(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());_m.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:pu(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});_m.range;function b7(e,t,r,n,l,u){const d=[[A0,1,nm],[A0,5,5*nm],[A0,15,15*nm],[A0,30,30*nm],[u,1,JA],[u,5,5*JA],[u,15,15*JA],[u,30,30*JA],[l,1,im],[l,3,3*im],[l,6,6*im],[l,12,12*im],[n,1,mm],[n,2,2*mm],[r,1,c3],[t,1,OR],[t,3,3*OR],[e,1,lS]];function a(x,b,I){const M=b<x;M&&([x,b]=[b,x]);const L=I&&typeof I.range=="function"?I:v(x,b,I),U=L?L.range(x,+b+1):[];return M?U.reverse():U}function v(x,b,I){const M=Math.abs(b-x)/I,L=XI(([,,H])=>H).right(d,M);if(L===d.length)return e.every(YT(x/lS,b/lS,I));if(L===0)return $2.every(Math.max(YT(x,b,I),1));const[U,R]=d[M/d[L-1][2]<d[L][2]/M?L-1:L];return U.every(R)}return[a,v]}const[Eue,Bue]=b7(_m,p3,Zb,w7,A3,h3),[Cue,Sue]=b7(gm,d3,Xb,Q1,f3,u3);function cS(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function uS(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function by(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Tue(e){var t=e.dateTime,r=e.date,n=e.time,l=e.periods,u=e.days,d=e.shortDays,a=e.months,v=e.shortMonths,x=Ey(l),b=By(l),I=Ey(u),M=By(u),L=Ey(d),U=By(d),R=Ey(a),H=By(a),q=Ey(v),te=By(v),J={a:jt,A:bt,b:Nt,B:ar,c:null,d:zR,e:zR,f:Zue,g:she,G:che,H:que,I:$ue,j:Xue,L:E7,m:Yue,M:Jue,p:lt,q:ie,Q:HR,s:VR,S:ehe,u:the,U:rhe,V:nhe,w:ihe,W:ahe,x:null,X:null,y:ohe,Y:lhe,Z:uhe,"%":jR},se={a:Le,A:Fe,b:Re,B:et,c:null,d:QR,e:QR,f:dhe,g:Ehe,G:Che,H:hhe,I:fhe,j:Ahe,L:C7,m:phe,M:mhe,p:xt,q:Dt,Q:HR,s:VR,S:ghe,u:_he,U:vhe,V:yhe,w:xhe,W:whe,x:null,X:null,y:bhe,Y:Bhe,Z:She,"%":jR},ye={a:nt,A:_e,b:Ie,B:Ze,c:st,d:UR,e:UR,f:Vue,g:kR,G:RR,H:NR,I:NR,j:zue,L:Hue,m:Nue,M:Que,p:we,q:Uue,Q:Kue,s:Wue,S:jue,u:Mue,U:Oue,V:Due,w:Lue,W:Rue,x:Et,X:Ut,y:kR,Y:RR,Z:kue,"%":Gue};J.x=Se(r,J),J.X=Se(n,J),J.c=Se(t,J),se.x=Se(r,se),se.X=Se(n,se),se.c=Se(t,se);function Se(pt,Ct){return function(mr){var Zt=[],sn=-1,er=0,mt=pt.length,En,$r,zn;for(mr instanceof Date||(mr=new Date(+mr));++sn<mt;)pt.charCodeAt(sn)===37&&(Zt.push(pt.slice(er,sn)),($r=DR[En=pt.charAt(++sn)])!=null?En=pt.charAt(++sn):$r=En==="e"?" ":"0",(zn=Ct[En])&&(En=zn(mr,$r)),Zt.push(En),er=sn+1);return Zt.push(pt.slice(er,sn)),Zt.join("")}}function Be(pt,Ct){return function(mr){var Zt=by(1900,void 0,1),sn=De(Zt,pt,mr+="",0),er,mt;if(sn!=mr.length)return null;if("Q"in Zt)return new Date(Zt.Q);if("s"in Zt)return new Date(Zt.s*1e3+("L"in Zt?Zt.L:0));if(Ct&&!("Z"in Zt)&&(Zt.Z=0),"p"in Zt&&(Zt.H=Zt.H%12+Zt.p*12),Zt.m===void 0&&(Zt.m="q"in Zt?Zt.q:0),"V"in Zt){if(Zt.V<1||Zt.V>53)return null;"w"in Zt||(Zt.w=1),"Z"in Zt?(er=uS(by(Zt.y,0,1)),mt=er.getUTCDay(),er=mt>4||mt===0?Z2.ceil(er):Z2(er),er=$b.offset(er,(Zt.V-1)*7),Zt.y=er.getUTCFullYear(),Zt.m=er.getUTCMonth(),Zt.d=er.getUTCDate()+(Zt.w+6)%7):(er=cS(by(Zt.y,0,1)),mt=er.getDay(),er=mt>4||mt===0?X2.ceil(er):X2(er),er=Q1.offset(er,(Zt.V-1)*7),Zt.y=er.getFullYear(),Zt.m=er.getMonth(),Zt.d=er.getDate()+(Zt.w+6)%7)}else("W"in Zt||"U"in Zt)&&("w"in Zt||(Zt.w="u"in Zt?Zt.u%7:"W"in Zt?1:0),mt="Z"in Zt?uS(by(Zt.y,0,1)).getUTCDay():cS(by(Zt.y,0,1)).getDay(),Zt.m=0,Zt.d="W"in Zt?(Zt.w+6)%7+Zt.W*7-(mt+5)%7:Zt.w+Zt.U*7-(mt+6)%7);return"Z"in Zt?(Zt.H+=Zt.Z/100|0,Zt.M+=Zt.Z%100,uS(Zt)):cS(Zt)}}function De(pt,Ct,mr,Zt){for(var sn=0,er=Ct.length,mt=mr.length,En,$r;sn<er;){if(Zt>=mt)return-1;if(En=Ct.charCodeAt(sn++),En===37){if(En=Ct.charAt(sn++),$r=ye[En in DR?Ct.charAt(sn++):En],!$r||(Zt=$r(pt,mr,Zt))<0)return-1}else if(En!=mr.charCodeAt(Zt++))return-1}return Zt}function we(pt,Ct,mr){var Zt=x.exec(Ct.slice(mr));return Zt?(pt.p=b.get(Zt[0].toLowerCase()),mr+Zt[0].length):-1}function nt(pt,Ct,mr){var Zt=L.exec(Ct.slice(mr));return Zt?(pt.w=U.get(Zt[0].toLowerCase()),mr+Zt[0].length):-1}function _e(pt,Ct,mr){var Zt=I.exec(Ct.slice(mr));return Zt?(pt.w=M.get(Zt[0].toLowerCase()),mr+Zt[0].length):-1}function Ie(pt,Ct,mr){var Zt=q.exec(Ct.slice(mr));return Zt?(pt.m=te.get(Zt[0].toLowerCase()),mr+Zt[0].length):-1}function Ze(pt,Ct,mr){var Zt=R.exec(Ct.slice(mr));return Zt?(pt.m=H.get(Zt[0].toLowerCase()),mr+Zt[0].length):-1}function st(pt,Ct,mr){return De(pt,t,Ct,mr)}function Et(pt,Ct,mr){return De(pt,r,Ct,mr)}function Ut(pt,Ct,mr){return De(pt,n,Ct,mr)}function jt(pt){return d[pt.getDay()]}function bt(pt){return u[pt.getDay()]}function Nt(pt){return v[pt.getMonth()]}function ar(pt){return a[pt.getMonth()]}function lt(pt){return l[+(pt.getHours()>=12)]}function ie(pt){return 1+~~(pt.getMonth()/3)}function Le(pt){return d[pt.getUTCDay()]}function Fe(pt){return u[pt.getUTCDay()]}function Re(pt){return v[pt.getUTCMonth()]}function et(pt){return a[pt.getUTCMonth()]}function xt(pt){return l[+(pt.getUTCHours()>=12)]}function Dt(pt){return 1+~~(pt.getUTCMonth()/3)}return{format:function(pt){var Ct=Se(pt+="",J);return Ct.toString=function(){return pt},Ct},parse:function(pt){var Ct=Be(pt+="",!1);return Ct.toString=function(){return pt},Ct},utcFormat:function(pt){var Ct=Se(pt+="",se);return Ct.toString=function(){return pt},Ct},utcParse:function(pt){var Ct=Be(pt+="",!0);return Ct.toString=function(){return pt},Ct}}}var DR={"-":"",_:" ",0:"0"},ju=/^\s*\d+/,Iue=/^%/,Fue=/[\\^$*+?|[\]().{}]/g;function ko(e,t,r){var n=e<0?"-":"",l=(n?-e:e)+"",u=l.length;return n+(u<r?new Array(r-u+1).join(t)+l:l)}function Pue(e){return e.replace(Fue,"\\$&")}function Ey(e){return new RegExp("^(?:"+e.map(Pue).join("|")+")","i")}function By(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Lue(e,t,r){var n=ju.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Mue(e,t,r){var n=ju.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Oue(e,t,r){var n=ju.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Due(e,t,r){var n=ju.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Rue(e,t,r){var n=ju.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function RR(e,t,r){var n=ju.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function kR(e,t,r){var n=ju.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function kue(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Uue(e,t,r){var n=ju.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Nue(e,t,r){var n=ju.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function UR(e,t,r){var n=ju.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function zue(e,t,r){var n=ju.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function NR(e,t,r){var n=ju.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Que(e,t,r){var n=ju.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function jue(e,t,r){var n=ju.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Hue(e,t,r){var n=ju.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Vue(e,t,r){var n=ju.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Gue(e,t,r){var n=Iue.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Kue(e,t,r){var n=ju.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Wue(e,t,r){var n=ju.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function zR(e,t){return ko(e.getDate(),t,2)}function que(e,t){return ko(e.getHours(),t,2)}function $ue(e,t){return ko(e.getHours()%12||12,t,2)}function Xue(e,t){return ko(1+Q1.count(gm(e),e),t,3)}function E7(e,t){return ko(e.getMilliseconds(),t,3)}function Zue(e,t){return E7(e,t)+"000"}function Yue(e,t){return ko(e.getMonth()+1,t,2)}function Jue(e,t){return ko(e.getMinutes(),t,2)}function ehe(e,t){return ko(e.getSeconds(),t,2)}function the(e){var t=e.getDay();return t===0?7:t}function rhe(e,t){return ko(Xb.count(gm(e)-1,e),t,2)}function B7(e){var t=e.getDay();return t>=4||t===0?nv(e):nv.ceil(e)}function nhe(e,t){return e=B7(e),ko(nv.count(gm(e),e)+(gm(e).getDay()===4),t,2)}function ihe(e){return e.getDay()}function ahe(e,t){return ko(X2.count(gm(e)-1,e),t,2)}function ohe(e,t){return ko(e.getFullYear()%100,t,2)}function she(e,t){return e=B7(e),ko(e.getFullYear()%100,t,2)}function lhe(e,t){return ko(e.getFullYear()%1e4,t,4)}function che(e,t){var r=e.getDay();return e=r>=4||r===0?nv(e):nv.ceil(e),ko(e.getFullYear()%1e4,t,4)}function uhe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ko(t/60|0,"0",2)+ko(t%60,"0",2)}function QR(e,t){return ko(e.getUTCDate(),t,2)}function hhe(e,t){return ko(e.getUTCHours(),t,2)}function fhe(e,t){return ko(e.getUTCHours()%12||12,t,2)}function Ahe(e,t){return ko(1+$b.count(_m(e),e),t,3)}function C7(e,t){return ko(e.getUTCMilliseconds(),t,3)}function dhe(e,t){return C7(e,t)+"000"}function phe(e,t){return ko(e.getUTCMonth()+1,t,2)}function mhe(e,t){return ko(e.getUTCMinutes(),t,2)}function ghe(e,t){return ko(e.getUTCSeconds(),t,2)}function _he(e){var t=e.getUTCDay();return t===0?7:t}function vhe(e,t){return ko(Zb.count(_m(e)-1,e),t,2)}function S7(e){var t=e.getUTCDay();return t>=4||t===0?iv(e):iv.ceil(e)}function yhe(e,t){return e=S7(e),ko(iv.count(_m(e),e)+(_m(e).getUTCDay()===4),t,2)}function xhe(e){return e.getUTCDay()}function whe(e,t){return ko(Z2.count(_m(e)-1,e),t,2)}function bhe(e,t){return ko(e.getUTCFullYear()%100,t,2)}function Ehe(e,t){return e=S7(e),ko(e.getUTCFullYear()%100,t,2)}function Bhe(e,t){return ko(e.getUTCFullYear()%1e4,t,4)}function Che(e,t){var r=e.getUTCDay();return e=r>=4||r===0?iv(e):iv.ceil(e),ko(e.getUTCFullYear()%1e4,t,4)}function She(){return"+0000"}function jR(){return"%"}function HR(e){return+e}function VR(e){return Math.floor(+e/1e3)}var y_,T7,I7;The({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function The(e){return y_=Tue(e),T7=y_.format,y_.parse,I7=y_.utcFormat,y_.utcParse,y_}function Ihe(e){return new Date(e)}function Fhe(e){return e instanceof Date?+e:+new Date(+e)}function m3(e,t,r,n,l,u,d,a,v,x){var b=r3(),I=b.invert,M=b.domain,L=x(".%L"),U=x(":%S"),R=x("%I:%M"),H=x("%I %p"),q=x("%a %d"),te=x("%b %d"),J=x("%B"),se=x("%Y");function ye(Se){return(v(Se)<Se?L:a(Se)<Se?U:d(Se)<Se?R:u(Se)<Se?H:n(Se)<Se?l(Se)<Se?q:te:r(Se)<Se?J:se)(Se)}return b.invert=function(Se){return new Date(I(Se))},b.domain=function(Se){return arguments.length?M(Array.from(Se,Fhe)):M().map(Ihe)},b.ticks=function(Se){var Be=M();return e(Be[0],Be[Be.length-1],Se??10)},b.tickFormat=function(Se,Be){return Be==null?ye:x(Be)},b.nice=function(Se){var Be=M();return(!Se||typeof Se.range!="function")&&(Se=t(Be[0],Be[Be.length-1],Se??10)),Se?M(p7(Be,Se)):b},b.copy=function(){return z1(b,m3(e,t,r,n,l,u,d,a,v,x))},b}function Phe(){return ld.apply(m3(Cue,Sue,gm,d3,Xb,Q1,f3,u3,A0,T7).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Lhe(){return ld.apply(m3(Eue,Bue,_m,p3,Zb,$b,A3,h3,A0,I7).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Yb(){var e=0,t=1,r,n,l,u,d=lf,a=!1,v;function x(I){return I==null||isNaN(I=+I)?v:d(l===0?.5:(I=(u(I)-r)*l,a?Math.max(0,Math.min(1,I)):I))}x.domain=function(I){return arguments.length?([e,t]=I,r=u(e=+e),n=u(t=+t),l=r===n?0:1/(n-r),x):[e,t]},x.clamp=function(I){return arguments.length?(a=!!I,x):a},x.interpolator=function(I){return arguments.length?(d=I,x):d};function b(I){return function(M){var L,U;return arguments.length?([L,U]=M,d=I(L,U),x):[d(0),d(1)]}}return x.range=b(xv),x.rangeRound=b(t3),x.unknown=function(I){return arguments.length?(v=I,x):v},function(I){return u=I,r=I(e),n=I(t),l=r===n?0:1/(n-r),x}}function Og(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function F7(){var e=Mg(Yb()(lf));return e.copy=function(){return Og(e,F7())},Em.apply(e,arguments)}function P7(){var e=a3(Yb()).domain([1,10]);return e.copy=function(){return Og(e,P7()).base(e.base())},Em.apply(e,arguments)}function L7(){var e=o3(Yb());return e.copy=function(){return Og(e,L7()).constant(e.constant())},Em.apply(e,arguments)}function g3(){var e=s3(Yb());return e.copy=function(){return Og(e,g3()).exponent(e.exponent())},Em.apply(e,arguments)}function Mhe(){return g3.apply(null,arguments).exponent(.5)}function M7(){var e=[],t=lf;function r(n){if(n!=null&&!isNaN(n=+n))return t((U1(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let l of n)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(wg),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,l)=>t(l/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(l,u)=>_ce(e,u/n))},r.copy=function(){return M7(t).domain(e)},Em.apply(r,arguments)}function Jb(){var e=0,t=.5,r=1,n=1,l,u,d,a,v,x=lf,b,I=!1,M;function L(R){return isNaN(R=+R)?M:(R=.5+((R=+b(R))-u)*(n*R<n*u?a:v),x(I?Math.max(0,Math.min(1,R)):R))}L.domain=function(R){return arguments.length?([e,t,r]=R,l=b(e=+e),u=b(t=+t),d=b(r=+r),a=l===u?0:.5/(u-l),v=u===d?0:.5/(d-u),n=u<l?-1:1,L):[e,t,r]},L.clamp=function(R){return arguments.length?(I=!!R,L):I},L.interpolator=function(R){return arguments.length?(x=R,L):x};function U(R){return function(H){var q,te,J;return arguments.length?([q,te,J]=H,x=Gce(R,[q,te,J]),L):[x(0),x(.5),x(1)]}}return L.range=U(xv),L.rangeRound=U(t3),L.unknown=function(R){return arguments.length?(M=R,L):M},function(R){return b=R,l=R(e),u=R(t),d=R(r),a=l===u?0:.5/(u-l),v=u===d?0:.5/(d-u),n=u<l?-1:1,L}}function O7(){var e=Mg(Jb()(lf));return e.copy=function(){return Og(e,O7())},Em.apply(e,arguments)}function D7(){var e=a3(Jb()).domain([.1,1,10]);return e.copy=function(){return Og(e,D7()).base(e.base())},Em.apply(e,arguments)}function R7(){var e=o3(Jb());return e.copy=function(){return Og(e,R7()).constant(e.constant())},Em.apply(e,arguments)}function _3(){var e=s3(Jb());return e.copy=function(){return Og(e,_3()).exponent(e.exponent())},Em.apply(e,arguments)}function Ohe(){return _3.apply(null,arguments).exponent(.5)}const Ry=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:YI,scaleDiverging:O7,scaleDivergingLog:D7,scaleDivergingPow:_3,scaleDivergingSqrt:Ohe,scaleDivergingSymlog:R7,scaleIdentity:d7,scaleImplicit:JT,scaleLinear:A7,scaleLog:m7,scaleOrdinal:ZI,scalePoint:xce,scalePow:l3,scaleQuantile:v7,scaleQuantize:y7,scaleRadial:_7,scaleSequential:F7,scaleSequentialLog:P7,scaleSequentialPow:g3,scaleSequentialQuantile:M7,scaleSequentialSqrt:Mhe,scaleSequentialSymlog:L7,scaleSqrt:due,scaleSymlog:g7,scaleThreshold:x7,scaleTime:Phe,scaleUtc:Lhe,tickFormat:f7},Symbol.toStringTag,{value:"Module"}));var Dg=e=>e.chartData,v3=kr([Dg],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),y3=(e,t,r,n)=>n?v3(e):Dg(e);function av(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(wA(t)&&wA(r))return!0}return!1}function GR(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function Dhe(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,l,u;if(wA(r))l=r;else if(typeof r=="function")return;if(wA(n))u=n;else if(typeof n=="function")return;var d=[l,u];if(av(d))return d}}function Rhe(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(av(n))return GR(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[l,u]=e,d,a;if(l==="auto")t!=null&&(d=Math.min(...t));else if(Ri(l))d=l;else if(typeof l=="function")try{t!=null&&(d=l(t?.[0]))}catch{}else if(typeof l=="string"&&OD.test(l)){var v=OD.exec(l);if(v==null||t==null)d=void 0;else{var x=+v[1];d=t[0]-x}}else d=t?.[0];if(u==="auto")t!=null&&(a=Math.max(...t));else if(Ri(u))a=u;else if(typeof u=="function")try{t!=null&&(a=u(t?.[1]))}catch{}else if(typeof u=="string"&&DD.test(u)){var b=DD.exec(u);if(b==null||t==null)a=void 0;else{var I=+b[1];a=t[1]+I}}else a=t?.[1];var M=[d,a];if(av(M))return t==null?M:GR(M,t,r)}}}var wv=1e9,khe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},w3,bl=!0,id="[DecimalError] ",v0=id+"Invalid argument: ",x3=id+"Exponent out of range: ",bv=Math.floor,a0=Math.pow,Uhe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,pA,ku=1e7,il=7,k7=9007199254740991,Y2=bv(k7/il),_i={};_i.absoluteValue=_i.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};_i.comparedTo=_i.cmp=function(e){var t,r,n,l,u=this;if(e=new u.constructor(e),u.s!==e.s)return u.s||-e.s;if(u.e!==e.e)return u.e>e.e^u.s<0?1:-1;for(n=u.d.length,l=e.d.length,t=0,r=n<l?n:l;t<r;++t)if(u.d[t]!==e.d[t])return u.d[t]>e.d[t]^u.s<0?1:-1;return n===l?0:n>l^u.s<0?1:-1};_i.decimalPlaces=_i.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*il;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};_i.dividedBy=_i.div=function(e){return um(this,new this.constructor(e))};_i.dividedToIntegerBy=_i.idiv=function(e){var t=this,r=t.constructor;return Ns(um(t,new r(e),0,1),r.precision)};_i.equals=_i.eq=function(e){return!this.cmp(e)};_i.exponent=function(){return Kc(this)};_i.greaterThan=_i.gt=function(e){return this.cmp(e)>0};_i.greaterThanOrEqualTo=_i.gte=function(e){return this.cmp(e)>=0};_i.isInteger=_i.isint=function(){return this.e>this.d.length-2};_i.isNegative=_i.isneg=function(){return this.s<0};_i.isPositive=_i.ispos=function(){return this.s>0};_i.isZero=function(){return this.s===0};_i.lessThan=_i.lt=function(e){return this.cmp(e)<0};_i.lessThanOrEqualTo=_i.lte=function(e){return this.cmp(e)<1};_i.logarithm=_i.log=function(e){var t,r=this,n=r.constructor,l=n.precision,u=l+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(pA))throw Error(id+"NaN");if(r.s<1)throw Error(id+(r.s?"NaN":"-Infinity"));return r.eq(pA)?new n(0):(bl=!1,t=um(y1(r,u),y1(e,u),u),bl=!0,Ns(t,l))};_i.minus=_i.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?z7(t,e):U7(t,(e.s=-e.s,e))};_i.modulo=_i.mod=function(e){var t,r=this,n=r.constructor,l=n.precision;if(e=new n(e),!e.s)throw Error(id+"NaN");return r.s?(bl=!1,t=um(r,e,0,1).times(e),bl=!0,r.minus(t)):Ns(new n(r),l)};_i.naturalExponential=_i.exp=function(){return N7(this)};_i.naturalLogarithm=_i.ln=function(){return y1(this)};_i.negated=_i.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};_i.plus=_i.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?U7(t,e):z7(t,(e.s=-e.s,e))};_i.precision=_i.sd=function(e){var t,r,n,l=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(v0+e);if(t=Kc(l)+1,n=l.d.length-1,r=n*il+1,n=l.d[n],n){for(;n%10==0;n/=10)r--;for(n=l.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};_i.squareRoot=_i.sqrt=function(){var e,t,r,n,l,u,d,a=this,v=a.constructor;if(a.s<1){if(!a.s)return new v(0);throw Error(id+"NaN")}for(e=Kc(a),bl=!1,l=Math.sqrt(+a),l==0||l==1/0?(t=Bp(a.d),(t.length+e)%2==0&&(t+="0"),l=Math.sqrt(t),e=bv((e+1)/2)-(e<0||e%2),l==1/0?t="5e"+e:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new v(t)):n=new v(l.toString()),r=v.precision,l=d=r+3;;)if(u=n,n=u.plus(um(a,u,d+2)).times(.5),Bp(u.d).slice(0,d)===(t=Bp(n.d)).slice(0,d)){if(t=t.slice(d-3,d+1),l==d&&t=="4999"){if(Ns(u,r+1,0),u.times(u).eq(a)){n=u;break}}else if(t!="9999")break;d+=4}return bl=!0,Ns(n,r)};_i.times=_i.mul=function(e){var t,r,n,l,u,d,a,v,x,b=this,I=b.constructor,M=b.d,L=(e=new I(e)).d;if(!b.s||!e.s)return new I(0);for(e.s*=b.s,r=b.e+e.e,v=M.length,x=L.length,v<x&&(u=M,M=L,L=u,d=v,v=x,x=d),u=[],d=v+x,n=d;n--;)u.push(0);for(n=x;--n>=0;){for(t=0,l=v+n;l>n;)a=u[l]+L[n]*M[l-n-1]+t,u[l--]=a%ku|0,t=a/ku|0;u[l]=(u[l]+t)%ku|0}for(;!u[--d];)u.pop();return t?++r:u.shift(),e.d=u,e.e=r,bl?Ns(e,I.precision):e};_i.toDecimalPlaces=_i.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Fp(e,0,wv),t===void 0?t=n.rounding:Fp(t,0,8),Ns(r,e+Kc(r)+1,t))};_i.toExponential=function(e,t){var r,n=this,l=n.constructor;return e===void 0?r=F0(n,!0):(Fp(e,0,wv),t===void 0?t=l.rounding:Fp(t,0,8),n=Ns(new l(n),e+1,t),r=F0(n,!0,e+1)),r};_i.toFixed=function(e,t){var r,n,l=this,u=l.constructor;return e===void 0?F0(l):(Fp(e,0,wv),t===void 0?t=u.rounding:Fp(t,0,8),n=Ns(new u(l),e+Kc(l)+1,t),r=F0(n.abs(),!1,e+Kc(n)+1),l.isneg()&&!l.isZero()?"-"+r:r)};_i.toInteger=_i.toint=function(){var e=this,t=e.constructor;return Ns(new t(e),Kc(e)+1,t.rounding)};_i.toNumber=function(){return+this};_i.toPower=_i.pow=function(e){var t,r,n,l,u,d,a=this,v=a.constructor,x=12,b=+(e=new v(e));if(!e.s)return new v(pA);if(a=new v(a),!a.s){if(e.s<1)throw Error(id+"Infinity");return a}if(a.eq(pA))return a;if(n=v.precision,e.eq(pA))return Ns(a,n);if(t=e.e,r=e.d.length-1,d=t>=r,u=a.s,d){if((r=b<0?-b:b)<=k7){for(l=new v(pA),t=Math.ceil(n/il+4),bl=!1;r%2&&(l=l.times(a),WR(l.d,t)),r=bv(r/2),r!==0;)a=a.times(a),WR(a.d,t);return bl=!0,e.s<0?new v(pA).div(l):Ns(l,n)}}else if(u<0)throw Error(id+"NaN");return u=u<0&&e.d[Math.max(t,r)]&1?-1:1,a.s=1,bl=!1,l=e.times(y1(a,n+x)),bl=!0,l=N7(l),l.s=u,l};_i.toPrecision=function(e,t){var r,n,l=this,u=l.constructor;return e===void 0?(r=Kc(l),n=F0(l,r<=u.toExpNeg||r>=u.toExpPos)):(Fp(e,1,wv),t===void 0?t=u.rounding:Fp(t,0,8),l=Ns(new u(l),e,t),r=Kc(l),n=F0(l,e<=r||r<=u.toExpNeg,e)),n};_i.toSignificantDigits=_i.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Fp(e,1,wv),t===void 0?t=n.rounding:Fp(t,0,8)),Ns(new n(r),e,t)};_i.toString=_i.valueOf=_i.val=_i.toJSON=_i[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Kc(e),r=e.constructor;return F0(e,t<=r.toExpNeg||t>=r.toExpPos)};function U7(e,t){var r,n,l,u,d,a,v,x,b=e.constructor,I=b.precision;if(!e.s||!t.s)return t.s||(t=new b(e)),bl?Ns(t,I):t;if(v=e.d,x=t.d,d=e.e,l=t.e,v=v.slice(),u=d-l,u){for(u<0?(n=v,u=-u,a=x.length):(n=x,l=d,a=v.length),d=Math.ceil(I/il),a=d>a?d+1:a+1,u>a&&(u=a,n.length=1),n.reverse();u--;)n.push(0);n.reverse()}for(a=v.length,u=x.length,a-u<0&&(u=a,n=x,x=v,v=n),r=0;u;)r=(v[--u]=v[u]+x[u]+r)/ku|0,v[u]%=ku;for(r&&(v.unshift(r),++l),a=v.length;v[--a]==0;)v.pop();return t.d=v,t.e=l,bl?Ns(t,I):t}function Fp(e,t,r){if(e!==~~e||e<t||e>r)throw Error(v0+e)}function Bp(e){var t,r,n,l=e.length-1,u="",d=e[0];if(l>0){for(u+=d,t=1;t<l;t++)n=e[t]+"",r=il-n.length,r&&(u+=Ag(r)),u+=n;d=e[t],n=d+"",r=il-n.length,r&&(u+=Ag(r))}else if(d===0)return"0";for(;d%10===0;)d/=10;return u+d}var um=function(){function e(n,l){var u,d=0,a=n.length;for(n=n.slice();a--;)u=n[a]*l+d,n[a]=u%ku|0,d=u/ku|0;return d&&n.unshift(d),n}function t(n,l,u,d){var a,v;if(u!=d)v=u>d?1:-1;else for(a=v=0;a<u;a++)if(n[a]!=l[a]){v=n[a]>l[a]?1:-1;break}return v}function r(n,l,u){for(var d=0;u--;)n[u]-=d,d=n[u]<l[u]?1:0,n[u]=d*ku+n[u]-l[u];for(;!n[0]&&n.length>1;)n.shift()}return function(n,l,u,d){var a,v,x,b,I,M,L,U,R,H,q,te,J,se,ye,Se,Be,De,we=n.constructor,nt=n.s==l.s?1:-1,_e=n.d,Ie=l.d;if(!n.s)return new we(n);if(!l.s)throw Error(id+"Division by zero");for(v=n.e-l.e,Be=Ie.length,ye=_e.length,L=new we(nt),U=L.d=[],x=0;Ie[x]==(_e[x]||0);)++x;if(Ie[x]>(_e[x]||0)&&--v,u==null?te=u=we.precision:d?te=u+(Kc(n)-Kc(l))+1:te=u,te<0)return new we(0);if(te=te/il+2|0,x=0,Be==1)for(b=0,Ie=Ie[0],te++;(x<ye||b)&&te--;x++)J=b*ku+(_e[x]||0),U[x]=J/Ie|0,b=J%Ie|0;else{for(b=ku/(Ie[0]+1)|0,b>1&&(Ie=e(Ie,b),_e=e(_e,b),Be=Ie.length,ye=_e.length),se=Be,R=_e.slice(0,Be),H=R.length;H<Be;)R[H++]=0;De=Ie.slice(),De.unshift(0),Se=Ie[0],Ie[1]>=ku/2&&++Se;do b=0,a=t(Ie,R,Be,H),a<0?(q=R[0],Be!=H&&(q=q*ku+(R[1]||0)),b=q/Se|0,b>1?(b>=ku&&(b=ku-1),I=e(Ie,b),M=I.length,H=R.length,a=t(I,R,M,H),a==1&&(b--,r(I,Be<M?De:Ie,M))):(b==0&&(a=b=1),I=Ie.slice()),M=I.length,M<H&&I.unshift(0),r(R,I,H),a==-1&&(H=R.length,a=t(Ie,R,Be,H),a<1&&(b++,r(R,Be<H?De:Ie,H))),H=R.length):a===0&&(b++,R=[0]),U[x++]=b,a&&R[0]?R[H++]=_e[se]||0:(R=[_e[se]],H=1);while((se++<ye||R[0]!==void 0)&&te--)}return U[0]||U.shift(),L.e=v,Ns(L,d?u+Kc(L)+1:u)}}();function N7(e,t){var r,n,l,u,d,a,v=0,x=0,b=e.constructor,I=b.precision;if(Kc(e)>16)throw Error(x3+Kc(e));if(!e.s)return new b(pA);for(bl=!1,a=I,d=new b(.03125);e.abs().gte(.1);)e=e.times(d),x+=5;for(n=Math.log(a0(2,x))/Math.LN10*2+5|0,a+=n,r=l=u=new b(pA),b.precision=a;;){if(l=Ns(l.times(e),a),r=r.times(++v),d=u.plus(um(l,r,a)),Bp(d.d).slice(0,a)===Bp(u.d).slice(0,a)){for(;x--;)u=Ns(u.times(u),a);return b.precision=I,t==null?(bl=!0,Ns(u,I)):u}u=d}}function Kc(e){for(var t=e.e*il,r=e.d[0];r>=10;r/=10)t++;return t}function hS(e,t,r){if(t>e.LN10.sd())throw bl=!0,r&&(e.precision=r),Error(id+"LN10 precision limit exceeded");return Ns(new e(e.LN10),t)}function Ag(e){for(var t="";e--;)t+="0";return t}function y1(e,t){var r,n,l,u,d,a,v,x,b,I=1,M=10,L=e,U=L.d,R=L.constructor,H=R.precision;if(L.s<1)throw Error(id+(L.s?"NaN":"-Infinity"));if(L.eq(pA))return new R(0);if(t==null?(bl=!1,x=H):x=t,L.eq(10))return t==null&&(bl=!0),hS(R,x);if(x+=M,R.precision=x,r=Bp(U),n=r.charAt(0),u=Kc(L),Math.abs(u)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)L=L.times(e),r=Bp(L.d),n=r.charAt(0),I++;u=Kc(L),n>1?(L=new R("0."+r),u++):L=new R(n+"."+r.slice(1))}else return v=hS(R,x+2,H).times(u+""),L=y1(new R(n+"."+r.slice(1)),x-M).plus(v),R.precision=H,t==null?(bl=!0,Ns(L,H)):L;for(a=d=L=um(L.minus(pA),L.plus(pA),x),b=Ns(L.times(L),x),l=3;;){if(d=Ns(d.times(b),x),v=a.plus(um(d,new R(l),x)),Bp(v.d).slice(0,x)===Bp(a.d).slice(0,x))return a=a.times(2),u!==0&&(a=a.plus(hS(R,x+2,H).times(u+""))),a=um(a,new R(I),x),R.precision=H,t==null?(bl=!0,Ns(a,H)):a;a=v,l+=2}}function KR(e,t){var r,n,l;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(l=t.length;t.charCodeAt(l-1)===48;)--l;if(t=t.slice(n,l),t){if(l-=n,r=r-n-1,e.e=bv(r/il),e.d=[],n=(r+1)%il,r<0&&(n+=il),n<l){for(n&&e.d.push(+t.slice(0,n)),l-=il;n<l;)e.d.push(+t.slice(n,n+=il));t=t.slice(n),n=il-t.length}else n-=l;for(;n--;)t+="0";if(e.d.push(+t),bl&&(e.e>Y2||e.e<-Y2))throw Error(x3+r)}else e.s=0,e.e=0,e.d=[0];return e}function Ns(e,t,r){var n,l,u,d,a,v,x,b,I=e.d;for(d=1,u=I[0];u>=10;u/=10)d++;if(n=t-d,n<0)n+=il,l=t,x=I[b=0];else{if(b=Math.ceil((n+1)/il),u=I.length,b>=u)return e;for(x=u=I[b],d=1;u>=10;u/=10)d++;n%=il,l=n-il+d}if(r!==void 0&&(u=a0(10,d-l-1),a=x/u%10|0,v=t<0||I[b+1]!==void 0||x%u,v=r<4?(a||v)&&(r==0||r==(e.s<0?3:2)):a>5||a==5&&(r==4||v||r==6&&(n>0?l>0?x/a0(10,d-l):0:I[b-1])%10&1||r==(e.s<0?8:7))),t<1||!I[0])return v?(u=Kc(e),I.length=1,t=t-u-1,I[0]=a0(10,(il-t%il)%il),e.e=bv(-t/il)||0):(I.length=1,I[0]=e.e=e.s=0),e;if(n==0?(I.length=b,u=1,b--):(I.length=b+1,u=a0(10,il-n),I[b]=l>0?(x/a0(10,d-l)%a0(10,l)|0)*u:0),v)for(;;)if(b==0){(I[0]+=u)==ku&&(I[0]=1,++e.e);break}else{if(I[b]+=u,I[b]!=ku)break;I[b--]=0,u=1}for(n=I.length;I[--n]===0;)I.pop();if(bl&&(e.e>Y2||e.e<-Y2))throw Error(x3+Kc(e));return e}function z7(e,t){var r,n,l,u,d,a,v,x,b,I,M=e.constructor,L=M.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new M(e),bl?Ns(t,L):t;if(v=e.d,I=t.d,n=t.e,x=e.e,v=v.slice(),d=x-n,d){for(b=d<0,b?(r=v,d=-d,a=I.length):(r=I,n=x,a=v.length),l=Math.max(Math.ceil(L/il),a)+2,d>l&&(d=l,r.length=1),r.reverse(),l=d;l--;)r.push(0);r.reverse()}else{for(l=v.length,a=I.length,b=l<a,b&&(a=l),l=0;l<a;l++)if(v[l]!=I[l]){b=v[l]<I[l];break}d=0}for(b&&(r=v,v=I,I=r,t.s=-t.s),a=v.length,l=I.length-a;l>0;--l)v[a++]=0;for(l=I.length;l>d;){if(v[--l]<I[l]){for(u=l;u&&v[--u]===0;)v[u]=ku-1;--v[u],v[l]+=ku}v[l]-=I[l]}for(;v[--a]===0;)v.pop();for(;v[0]===0;v.shift())--n;return v[0]?(t.d=v,t.e=n,bl?Ns(t,L):t):new M(0)}function F0(e,t,r){var n,l=Kc(e),u=Bp(e.d),d=u.length;return t?(r&&(n=r-d)>0?u=u.charAt(0)+"."+u.slice(1)+Ag(n):d>1&&(u=u.charAt(0)+"."+u.slice(1)),u=u+(l<0?"e":"e+")+l):l<0?(u="0."+Ag(-l-1)+u,r&&(n=r-d)>0&&(u+=Ag(n))):l>=d?(u+=Ag(l+1-d),r&&(n=r-l-1)>0&&(u=u+"."+Ag(n))):((n=l+1)<d&&(u=u.slice(0,n)+"."+u.slice(n)),r&&(n=r-d)>0&&(l+1===d&&(u+="."),u+=Ag(n))),e.s<0?"-"+u:u}function WR(e,t){if(e.length>t)return e.length=t,!0}function Q7(e){var t,r,n;function l(u){var d=this;if(!(d instanceof l))return new l(u);if(d.constructor=l,u instanceof l){d.s=u.s,d.e=u.e,d.d=(u=u.d)?u.slice():u;return}if(typeof u=="number"){if(u*0!==0)throw Error(v0+u);if(u>0)d.s=1;else if(u<0)u=-u,d.s=-1;else{d.s=0,d.e=0,d.d=[0];return}if(u===~~u&&u<1e7){d.e=0,d.d=[u];return}return KR(d,u.toString())}else if(typeof u!="string")throw Error(v0+u);if(u.charCodeAt(0)===45?(u=u.slice(1),d.s=-1):d.s=1,Uhe.test(u))KR(d,u);else throw Error(v0+u)}if(l.prototype=_i,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.clone=Q7,l.config=l.set=Nhe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return l.config(e),l}function Nhe(e){if(!e||typeof e!="object")throw Error(id+"Object expected");var t,r,n,l=["precision",1,wv,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<l.length;t+=3)if((n=e[r=l[t]])!==void 0)if(bv(n)===n&&n>=l[t+1]&&n<=l[t+2])this[r]=n;else throw Error(v0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(v0+r+": "+n);return this}var w3=Q7(khe);pA=new w3(1);const ds=w3;var zhe=e=>e,j7={},H7=e=>e===j7,qR=e=>function t(){return arguments.length===0||arguments.length===1&&H7(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},V7=(e,t)=>e===1?t:qR(function(){for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];var u=n.filter(d=>d!==j7).length;return u>=e?t(...n):V7(e-u,qR(function(){for(var d=arguments.length,a=new Array(d),v=0;v<d;v++)a[v]=arguments[v];var x=n.map(b=>H7(b)?a.shift():b);return t(...x,...a)}))}),eE=e=>V7(e.length,e),n5=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},Qhe=eE((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),jhe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return zhe;var l=r.reverse(),u=l[0],d=l.slice(1);return function(){return d.reduce((a,v)=>v(a),u(...arguments))}},i5=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),G7=e=>{var t=null,r=null;return function(){for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return t&&l.every((d,a)=>{var v;return d===((v=t)===null||v===void 0?void 0:v[a])})||(t=l,r=e(...l)),r}};function K7(e){var t;return e===0?t=1:t=Math.floor(new ds(e).abs().log(10).toNumber())+1,t}function W7(e,t,r){for(var n=new ds(e),l=0,u=[];n.lt(t)&&l<1e5;)u.push(n.toNumber()),n=n.add(r),l++;return u}eE((e,t,r)=>{var n=+e,l=+t;return n+r*(l-n)});eE((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});eE((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var q7=e=>{var[t,r]=e,[n,l]=[t,r];return t>r&&([n,l]=[r,t]),[n,l]},$7=(e,t,r)=>{if(e.lte(0))return new ds(0);var n=K7(e.toNumber()),l=new ds(10).pow(n),u=e.div(l),d=n!==1?.05:.1,a=new ds(Math.ceil(u.div(d).toNumber())).add(r).mul(d),v=a.mul(l);return t?new ds(v.toNumber()):new ds(Math.ceil(v.toNumber()))},Hhe=(e,t,r)=>{var n=new ds(1),l=new ds(e);if(!l.isint()&&r){var u=Math.abs(e);u<1?(n=new ds(10).pow(K7(e)-1),l=new ds(Math.floor(l.div(n).toNumber())).mul(n)):u>1&&(l=new ds(Math.floor(e)))}else e===0?l=new ds(Math.floor((t-1)/2)):r||(l=new ds(Math.floor(e)));var d=Math.floor((t-1)/2),a=jhe(Qhe(v=>l.add(new ds(v-d).mul(n)).toNumber()),n5);return a(0,t)},X7=function(t,r,n,l){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new ds(0),tickMin:new ds(0),tickMax:new ds(0)};var d=$7(new ds(r).sub(t).div(n-1),l,u),a;t<=0&&r>=0?a=new ds(0):(a=new ds(t).add(r).div(2),a=a.sub(new ds(a).mod(d)));var v=Math.ceil(a.sub(t).div(d).toNumber()),x=Math.ceil(new ds(r).sub(a).div(d).toNumber()),b=v+x+1;return b>n?X7(t,r,n,l,u+1):(b<n&&(x=r>0?x+(n-b):x,v=r>0?v:v+(n-b)),{step:d,tickMin:a.sub(new ds(v).mul(d)),tickMax:a.add(new ds(x).mul(d))})};function Vhe(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=Math.max(n,2),[d,a]=q7([t,r]);if(d===-1/0||a===1/0){var v=a===1/0?[d,...n5(0,n-1).map(()=>1/0)]:[...n5(0,n-1).map(()=>-1/0),a];return t>r?i5(v):v}if(d===a)return Hhe(d,n,l);var{step:x,tickMin:b,tickMax:I}=X7(d,a,u,l,0),M=W7(b,I.add(new ds(.1).mul(x)),x);return t>r?i5(M):M}function Ghe(e,t){var[r,n]=e,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[u,d]=q7([r,n]);if(u===-1/0||d===1/0)return[r,n];if(u===d)return[u];var a=Math.max(t,2),v=$7(new ds(d).sub(u).div(a-1),l,0),x=[...W7(new ds(u),new ds(d),v),d];return l===!1&&(x=x.map(b=>Math.round(b))),r>n?i5(x):x}var Khe=G7(Vhe),Whe=G7(Ghe),Z7=e=>e.rootProps.maxBarSize,qhe=e=>e.rootProps.barGap,Y7=e=>e.rootProps.barCategoryGap,$he=e=>e.rootProps.barSize,j1=e=>e.rootProps.stackOffset,b3=e=>e.options.chartName,E3=e=>e.rootProps.syncId,J7=e=>e.rootProps.syncMethod,B3=e=>e.options.eventEmitter,tm={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},hA={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},tE=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},Xhe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:tm.angleAxisId,includeHidden:!1,name:void 0,reversed:tm.reversed,scale:tm.scale,tick:tm.tick,tickCount:void 0,ticks:void 0,type:tm.type,unit:void 0},Zhe={allowDataOverflow:hA.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:hA.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:hA.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:hA.scale,tick:hA.tick,tickCount:hA.tickCount,ticks:void 0,type:hA.type,unit:void 0},Yhe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:tm.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:tm.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:tm.scale,tick:tm.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Jhe={allowDataOverflow:hA.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:hA.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:hA.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:hA.scale,tick:hA.tick,tickCount:hA.tickCount,ticks:void 0,type:"category",unit:void 0},C3=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?Yhe:Xhe,S3=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?Jhe:Zhe,rE=e=>e.polarOptions,T3=kr([wm,bm,du],DQ),ej=kr([rE,T3],(e,t)=>{if(e!=null)return uf(e.innerRadius,t,0)}),tj=kr([rE,T3],(e,t)=>{if(e!=null)return uf(e.outerRadius,t,t*.8)}),efe=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},rj=kr([rE],efe);kr([C3,rj],tE);var nj=kr([T3,ej,tj],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});kr([S3,nj],tE);var ij=kr([Uo,rE,ej,tj,wm,bm],(e,t,r,n,l,u)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:d,cy:a,startAngle:v,endAngle:x}=t;return{cx:uf(d,l,l/2),cy:uf(a,u,u/2),innerRadius:r,outerRadius:n,startAngle:v,endAngle:x,clockWise:!1}}}),Bl=(e,t)=>t,H1=(e,t,r)=>r;function I3(e){return e?.id}var mu=e=>{var t=Uo(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Ev=e=>e.tooltip.settings.axisId,gu=e=>{var t=mu(e),r=Ev(e);return V1(e,t,r)};function aj(e,t,r){var{chartData:n=[]}=t,l=r?.dataKey,u=new Map;return e.forEach(d=>{var a,v=(a=d.data)!==null&&a!==void 0?a:n;if(!(v==null||v.length===0)){var x=I3(d);v.forEach((b,I)=>{var M=l==null?I:String(wl(b,l,null)),L=wl(b,d.dataKey,0),U;u.has(M)?U=u.get(M):U={},Object.assign(U,{[x]:L}),u.set(M,U)})}}),Array.from(u.values())}function nE(e){return e.stackId!=null&&e.dataKey!=null}function $R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function J2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$R(Object(r),!0).forEach(function(n){tfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$R(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tfe(e,t,r){return(t=rfe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rfe(e){var t=nfe(e,"string");return typeof t=="symbol"?t:t+""}function nfe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a5=[0,"auto"],sA={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Bm=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return r??sA},lA={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:a5,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Gb},Rg=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return r??lA},ife={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},F3=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??ife},yc=(e,t,r)=>{switch(t){case"xAxis":return Bm(e,r);case"yAxis":return Rg(e,r);case"zAxis":return F3(e,r);case"angleAxis":return C3(e,r);case"radiusAxis":return S3(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},afe=(e,t,r)=>{switch(t){case"xAxis":return Bm(e,r);case"yAxis":return Rg(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},V1=(e,t,r)=>{switch(t){case"xAxis":return Bm(e,r);case"yAxis":return Rg(e,r);case"angleAxis":return C3(e,r);case"radiusAxis":return S3(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},oj=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function P3(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var L3=e=>e.graphicalItems.cartesianItems,ofe=kr([Bl,H1],P3),M3=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),G1=kr([L3,yc,ofe],M3),sj=kr([G1],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(nE)),lj=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),cj=kr([G1],lj),O3=e=>e.map(t=>t.data).filter(Boolean).flat(1),sfe=kr([G1],O3),D3=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:l}=t;return e.length>0?e:r.slice(n,l+1)},R3=kr([sfe,y3],D3),k3=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:wl(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(l=>({value:wl(l,n)}))):e.map(n=>({value:n})),iE=kr([R3,yc,G1],k3);function uj(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function j0(e){return e.filter(t=>Ip(t)||t instanceof Date).map(Number).filter(t=>rd(t)===!1)}function lfe(e,t,r){return!r||typeof t!="number"||rd(t)?[]:r.length?j0(r.flatMap(n=>{var l=wl(e,n.dataKey),u,d;if(Array.isArray(l)?[u,d]=l:u=d=l,!(!wA(u)||!wA(d)))return[t-u,t+d]})):[]}var cfe=kr([sj,y3,gu],aj),hj=(e,t,r)=>{var n={},l=t.reduce((u,d)=>(d.stackId==null||(u[d.stackId]==null&&(u[d.stackId]=[]),u[d.stackId].push(d)),u),n);return Object.fromEntries(Object.entries(l).map(u=>{var[d,a]=u,v=a.map(I3);return[d,{stackedData:wse(e,v,r),graphicalItems:a}]}))},o5=kr([cfe,sj,j1],hj),fj=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:l}=t;if(r!=="zAxis"){var u=Sse(e,n,l);if(!(u!=null&&u[0]===0&&u[1]===0))return u}},ufe=kr([o5,Dg,Bl],fj),Aj=(e,t,r,n,l)=>r.length>0?e.flatMap(u=>r.flatMap(d=>{var a,v,x=(a=n[d.id])===null||a===void 0?void 0:a.filter(I=>uj(l,I)),b=wl(u,(v=t.dataKey)!==null&&v!==void 0?v:d.dataKey);return{value:b,errorDomain:lfe(u,b,x)}})).filter(Boolean):t?.dataKey!=null?e.map(u=>({value:wl(u,t.dataKey),errorDomain:[]})):e.map(u=>({value:u,errorDomain:[]})),aE=e=>e.errorBars,dj=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>uj(r,n));kr([cj,aE,Bl],dj);var hfe=kr([R3,yc,cj,aE,Bl],Aj);function ffe(e){var{value:t}=e;if(Ip(t)||t instanceof Date)return t}var XR=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=j0(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Afe=(e,t,r)=>{var n=e.map(ffe).filter(l=>l!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&Mz(n))?r7(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},U3=e=>{var t;if(e==null||!("domain"in e))return a5;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=j0(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:a5},eb=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var l=r.filter(Boolean);if(l.length!==0){var u=l.flat(),d=Math.min(...u),a=Math.max(...u);return[d,a]}},pj=e=>e.referenceElements.dots,Bv=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),dfe=kr([pj,Bl,H1],Bv),mj=e=>e.referenceElements.areas,pfe=kr([mj,Bl,H1],Bv),gj=e=>e.referenceElements.lines,mfe=kr([gj,Bl,H1],Bv),_j=(e,t)=>{var r=j0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},gfe=kr(dfe,Bl,_j),vj=(e,t)=>{var r=j0(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},_fe=kr([pfe,Bl],vj),yj=(e,t)=>{var r=j0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},vfe=kr(mfe,Bl,yj),yfe=kr(gfe,vfe,_fe,(e,t,r)=>eb(e,r,t)),xj=kr([yc],U3),N3=(e,t,r,n,l,u,d)=>{var a=Dhe(t,e.allowDataOverflow);if(a!=null)return a;var v=u==="vertical"&&d==="xAxis"||u==="horizontal"&&d==="yAxis",x=v?eb(r,l,XR(n)):eb(l,XR(n));return Rhe(t,x,e.allowDataOverflow)},xfe=kr([yc,xj,ufe,hfe,yfe,Uo,Bl],N3),wfe=[0,1],z3=(e,t,r,n,l,u,d)=>{if(!((e==null||r==null||r.length===0)&&d===void 0)){var{dataKey:a,type:v}=e,x=N0(t,u);return x&&a==null?r7(0,r.length):v==="category"?Afe(n,e,x):l==="expand"?wfe:d}},Q3=kr([yc,Uo,R3,iE,j1,Bl,xfe],z3),wj=(e,t,r,n,l)=>{if(e!=null){var{scale:u,type:d}=e;if(u==="auto")return t==="radial"&&l==="radiusAxis"?"band":t==="radial"&&l==="angleAxis"?"linear":d==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":d==="category"?"band":"linear";if(typeof u=="string"){var a="scale".concat(D1(u));return a in Ry?a:"point"}}},Cv=kr([yc,Uo,oj,b3,Bl],wj);function bfe(e){if(e!=null){if(e in Ry)return Ry[e]();var t="scale".concat(D1(e));if(t in Ry)return Ry[t]()}}function j3(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var l=bfe(t);if(l!=null){var u=l.domain(r).range(n);return gse(u),u}}}var H3=(e,t,r)=>{var n=U3(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&av(e))return Khe(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&av(e))return Whe(e,t.tickCount,t.allowDecimals)}},V3=kr([Q3,V1,Cv],H3),G3=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&av(t)&&Array.isArray(r)&&r.length>0){var l=t[0],u=r[0],d=t[1],a=r[r.length-1];return[Math.min(l,u),Math.max(d,a)]}return t},Efe=kr([yc,Q3,V3,Bl],G3),Bfe=kr(iE,yc,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(j0(e.map(a=>a.value))).sort((a,v)=>a-v);if(n.length<2)return 1/0;var l=n[n.length-1]-n[0];if(l===0)return 1/0;for(var u=0;u<n.length-1;u++){var d=n[u+1]-n[u];r=Math.min(r,d)}return r/l}}),bj=kr(Bfe,Uo,Y7,du,(e,t,r,n)=>n,(e,t,r,n,l)=>{if(!wA(e))return 0;var u=t==="vertical"?n.height:n.width;if(l==="gap")return e*u/2;if(l==="no-gap"){var d=uf(r,e*u),a=e*u/2;return a-d-(a-d)/u*d}return 0}),Cfe=(e,t)=>{var r=Bm(e,t);return r==null||typeof r.padding!="string"?0:bj(e,"xAxis",t,r.padding)},Sfe=(e,t)=>{var r=Rg(e,t);return r==null||typeof r.padding!="string"?0:bj(e,"yAxis",t,r.padding)},Tfe=kr(Bm,Cfe,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:l}=e;return typeof l=="string"?{left:t,right:t}:{left:((r=l.left)!==null&&r!==void 0?r:0)+t,right:((n=l.right)!==null&&n!==void 0?n:0)+t}}),Ife=kr(Rg,Sfe,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:l}=e;return typeof l=="string"?{top:t,bottom:t}:{top:((r=l.top)!==null&&r!==void 0?r:0)+t,bottom:((n=l.bottom)!==null&&n!==void 0?n:0)+t}}),Ffe=kr([du,Tfe,Wb,Kb,(e,t,r)=>r],(e,t,r,n,l)=>{var{padding:u}=n;return l?[u.left,r.width-u.right]:[e.left+t.left,e.left+e.width-t.right]}),Pfe=kr([du,Uo,Ife,Wb,Kb,(e,t,r)=>r],(e,t,r,n,l,u)=>{var{padding:d}=l;return u?[n.height-d.bottom,d.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),K1=(e,t,r,n)=>{var l;switch(t){case"xAxis":return Ffe(e,r,n);case"yAxis":return Pfe(e,r,n);case"zAxis":return(l=F3(e,r))===null||l===void 0?void 0:l.range;case"angleAxis":return rj(e);case"radiusAxis":return nj(e,r);default:return}},Ej=kr([yc,K1],tE),Sv=kr([yc,Cv,Efe,Ej],j3);kr([G1,aE,Bl],dj);function Bj(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var oE=(e,t)=>t,sE=(e,t,r)=>r,Lfe=kr(GI,oE,sE,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(Bj)),Mfe=kr(KI,oE,sE,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(Bj)),Cj=(e,t)=>({width:e.width,height:t.height}),Ofe=(e,t)=>{var r=typeof t.width=="number"?t.width:Gb;return{width:r,height:e.height}},Sj=kr(du,Bm,Cj),Dfe=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},Rfe=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},kfe=kr(bm,du,Lfe,oE,sE,(e,t,r,n,l)=>{var u={},d;return r.forEach(a=>{var v=Cj(t,a);d==null&&(d=Dfe(t,n,e));var x=n==="top"&&!l||n==="bottom"&&l;u[a.id]=d-Number(x)*v.height,d+=(x?-1:1)*v.height}),u}),Ufe=kr(wm,du,Mfe,oE,sE,(e,t,r,n,l)=>{var u={},d;return r.forEach(a=>{var v=Ofe(t,a);d==null&&(d=Rfe(t,n,e));var x=n==="left"&&!l||n==="right"&&l;u[a.id]=d-Number(x)*v.width,d+=(x?-1:1)*v.width}),u}),Nfe=(e,t)=>{var r=du(e),n=Bm(e,t);if(n!=null){var l=kfe(e,n.orientation,n.mirror),u=l[t];return u==null?{x:r.left,y:0}:{x:r.left,y:u}}},zfe=(e,t)=>{var r=du(e),n=Rg(e,t);if(n!=null){var l=Ufe(e,n.orientation,n.mirror),u=l[t];return u==null?{x:0,y:r.top}:{x:u,y:r.top}}},Tj=kr(du,Rg,(e,t)=>{var r=typeof t.width=="number"?t.width:Gb;return{width:r,height:e.height}}),ZR=(e,t,r)=>{switch(t){case"xAxis":return Sj(e,r).width;case"yAxis":return Tj(e,r).height;default:return}},Ij=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:l,type:u,dataKey:d}=r,a=N0(e,n),v=t.map(x=>x.value);if(d&&a&&u==="category"&&l&&Mz(v))return v}},K3=kr([Uo,iE,yc,Bl],Ij),Fj=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:l,scale:u}=r,d=N0(e,n);if(d&&(l==="number"||u!=="auto"))return t.map(a=>a.value)}},W3=kr([Uo,iE,V1,Bl],Fj);kr([Uo,afe,Cv,Sv,K3,W3,K1,V3,Bl],(e,t,r,n,l,u,d,a,v)=>{if(t==null)return null;var x=N0(e,v);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:v,categoricalDomain:u,duplicateDomain:l,isCategorical:x,niceTicks:a,range:d,realScaleType:r,scale:n}});var Qfe=(e,t,r,n,l,u,d,a,v)=>{if(!(t==null||n==null)){var x=N0(e,v),{type:b,ticks:I,tickCount:M}=t,L=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,U=b==="category"&&n.bandwidth?n.bandwidth()/L:0;U=v==="angleAxis"&&u!=null&&u.length>=2?lh(u[0]-u[1])*2*U:U;var R=I||l;if(R){var H=R.map((q,te)=>{var J=d?d.indexOf(q):q;return{index:te,coordinate:n(J)+U,value:q,offset:U}});return H.filter(q=>!rd(q.coordinate))}return x&&a?a.map((q,te)=>({coordinate:n(q)+U,value:q,index:te,offset:U})):n.ticks?n.ticks(M).map(q=>({coordinate:n(q)+U,value:q,offset:U})):n.domain().map((q,te)=>({coordinate:n(q)+U,value:d?d[q]:q,index:te,offset:U}))}},Pj=kr([Uo,V1,Cv,Sv,V3,K1,K3,W3,Bl],Qfe),jfe=(e,t,r,n,l,u,d)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var a=N0(e,d),{tickCount:v}=t,x=0;return x=d==="angleAxis"&&n?.length>=2?lh(n[0]-n[1])*2*x:x,a&&u?u.map((b,I)=>({coordinate:r(b)+x,value:b,index:I,offset:x})):r.ticks?r.ticks(v).map(b=>({coordinate:r(b)+x,value:b,offset:x})):r.domain().map((b,I)=>({coordinate:r(b)+x,value:l?l[b]:b,index:I,offset:x}))}},ov=kr([Uo,V1,Sv,K1,K3,W3,Bl],jfe),sv=kr(yc,Sv,(e,t)=>{if(!(e==null||t==null))return J2(J2({},e),{},{scale:t})}),Hfe=kr([yc,Cv,Q3,Ej],j3);kr((e,t,r)=>F3(e,r),Hfe,(e,t)=>{if(!(e==null||t==null))return J2(J2({},e),{},{scale:t})});var Vfe=kr([Uo,GI,KI],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Lj=e=>e.options.defaultTooltipEventType,Mj=e=>e.options.validateTooltipEventTypes;function Oj(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function q3(e,t){var r=Lj(e),n=Mj(e);return Oj(t,r,n)}function Gfe(e){return Yi(t=>q3(t,e))}var Dj=(e,t)=>{var r,n=Number(t);if(!(rd(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},Kfe=e=>e.tooltip.settings,pg={active:!1,index:null,dataKey:void 0,coordinate:void 0},Wfe={itemInteraction:{click:pg,hover:pg},axisInteraction:{click:pg,hover:pg},keyboardInteraction:pg,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Rj=bA({name:"tooltip",initialState:Wfe,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=cm(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:qfe,removeTooltipEntrySettings:$fe,setTooltipSettingsState:Xfe,setActiveMouseOverItemIndex:kj,mouseLeaveItem:Zfe,mouseLeaveChart:Uj,setActiveClickItemIndex:Yfe,setMouseOverAxisIndex:Nj,setMouseClickAxisIndex:Jfe,setSyncInteraction:s5,setKeyboardInteraction:l5}=Rj.actions,eAe=Rj.reducer;function YR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function Aw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YR(Object(r),!0).forEach(function(n){tAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tAe(e,t,r){return(t=rAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rAe(e){var t=nAe(e,"string");return typeof t=="symbol"?t:t+""}function nAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iAe(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function aAe(e){return e.index!=null}var zj=(e,t,r,n)=>{if(t==null)return pg;var l=iAe(e,t,r);if(l==null)return pg;if(l.active)return l;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var u=e.settings.active===!0;if(aAe(l)){if(u)return Aw(Aw({},l),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Aw(Aw({},pg),{},{coordinate:l.coordinate})},$3=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!wA(n))return r;var l=0,u=1/0;return t.length>0&&(u=t.length-1),String(Math.max(l,Math.min(n,u)))},Qj=(e,t,r,n,l,u,d,a)=>{if(!(u==null||a==null)){var v=d[0],x=v==null?void 0:a(v.positions,u);if(x!=null)return x;var b=l?.[Number(u)];if(b)switch(r){case"horizontal":return{x:b.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:b.coordinate}}}},jj=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var l;return r==="hover"?l=e.itemInteraction.hover.dataKey:l=e.itemInteraction.click.dataKey,l==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(u=>{var d;return((d=u.settings)===null||d===void 0?void 0:d.dataKey)===l})},W1=e=>e.options.tooltipPayloadSearcher,Tv=e=>e.tooltip;function JR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function ek(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JR(Object(r),!0).forEach(function(n){oAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oAe(e,t,r){return(t=sAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sAe(e){var t=lAe(e,"string");return typeof t=="symbol"?t:t+""}function lAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cAe(e,t){return e??t}var Hj=(e,t,r,n,l,u,d)=>{if(!(t==null||u==null)){var{chartData:a,computedData:v,dataStartIndex:x,dataEndIndex:b}=r,I=[];return e.reduce((M,L)=>{var U,{dataDefinedOnItem:R,settings:H}=L,q=cAe(R,a),te=Array.isArray(q)?RQ(q,x,b):q,J=(U=H?.dataKey)!==null&&U!==void 0?U:n?.dataKey,se=H?.nameKey,ye;if(n!=null&&n.dataKey&&Array.isArray(te)&&!Array.isArray(te[0])&&d==="axis"?ye=uie(te,n.dataKey,l):ye=u(te,t,v,se),Array.isArray(ye))ye.forEach(Be=>{var De=ek(ek({},H),{},{name:Be.name,unit:Be.unit,color:void 0,fill:void 0});M.push(RD({tooltipEntrySettings:De,dataKey:Be.dataKey,payload:Be.payload,value:wl(Be.payload,Be.dataKey),name:Be.name}))});else{var Se;M.push(RD({tooltipEntrySettings:H,dataKey:J,payload:ye,value:wl(ye,J),name:(Se=wl(ye,se))!==null&&Se!==void 0?Se:H?.name}))}return M},I)}},X3=kr([gu,Uo,oj,b3,mu],wj),uAe=kr([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),hAe=kr([mu,Ev],P3),q1=kr([uAe,gu,hAe],M3),fAe=kr([q1],e=>e.filter(nE)),AAe=kr([q1],O3),Iv=kr([AAe,Dg],D3),dAe=kr([fAe,Dg,gu],aj),Z3=kr([Iv,gu,q1],k3),pAe=kr([gu],U3),mAe=kr([q1],e=>e.filter(nE)),gAe=kr([dAe,mAe,j1],hj),_Ae=kr([gAe,Dg,mu],fj),vAe=kr([q1],lj),yAe=kr([Iv,gu,vAe,aE,mu],Aj),xAe=kr([pj,mu,Ev],Bv),wAe=kr([xAe,mu],_j),bAe=kr([mj,mu,Ev],Bv),EAe=kr([bAe,mu],vj),BAe=kr([gj,mu,Ev],Bv),CAe=kr([BAe,mu],yj),SAe=kr([wAe,CAe,EAe],eb),TAe=kr([gu,pAe,_Ae,yAe,SAe,Uo,mu],N3),Vj=kr([gu,Uo,Iv,Z3,j1,mu,TAe],z3),IAe=kr([Vj,gu,X3],H3),FAe=kr([gu,Vj,IAe,mu],G3),Gj=e=>{var t=mu(e),r=Ev(e),n=!1;return K1(e,t,r,n)},Kj=kr([gu,Gj],tE),Wj=kr([gu,X3,FAe,Kj],j3),PAe=kr([Uo,Z3,gu,mu],Ij),LAe=kr([Uo,Z3,gu,mu],Fj),MAe=(e,t,r,n,l,u,d,a)=>{if(t){var{type:v}=t,x=N0(e,a);if(n){var b=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,I=v==="category"&&n.bandwidth?n.bandwidth()/b:0;return I=a==="angleAxis"&&l!=null&&l?.length>=2?lh(l[0]-l[1])*2*I:I,x&&d?d.map((M,L)=>({coordinate:n(M)+I,value:M,index:L,offset:I})):n.domain().map((M,L)=>({coordinate:n(M)+I,value:u?u[M]:M,index:L,offset:I}))}}},Cm=kr([Uo,gu,X3,Wj,Gj,PAe,LAe,mu],MAe),Y3=kr([Lj,Mj,Kfe],(e,t,r)=>Oj(r.shared,e,t)),qj=e=>e.tooltip.settings.trigger,J3=e=>e.tooltip.settings.defaultIndex,lE=kr([Tv,Y3,qj,J3],zj),P0=kr([lE,Iv],$3),$j=kr([Cm,P0],Dj),Xj=kr([lE],e=>{if(e)return e.dataKey}),Zj=kr([Tv,Y3,qj,J3],jj),OAe=kr([wm,bm,Uo,du,Cm,J3,Zj,W1],Qj),DAe=kr([lE,OAe],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),RAe=kr([lE],e=>e.active),kAe=kr([Zj,P0,Dg,gu,$j,W1,Y3],Hj);kr([kAe],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function tk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function rk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tk(Object(r),!0).forEach(function(n){UAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UAe(e,t,r){return(t=NAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NAe(e){var t=zAe(e,"string");return typeof t=="symbol"?t:t+""}function zAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QAe=()=>Yi(gu),jAe=()=>{var e=QAe(),t=Yi(Cm),r=Yi(Wj);return VI(rk(rk({},e),{},{scale:r}),t)},HAe=()=>Yi(b3),eF=(e,t)=>t,Yj=(e,t,r)=>r,tF=(e,t,r,n)=>n,VAe=kr(Cm,e=>kb(e,t=>t.coordinate)),rF=kr([Tv,eF,Yj,tF],zj),Jj=kr([rF,Iv],$3),GAe=(e,t,r)=>{if(t!=null){var n=Tv(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},eH=kr([Tv,eF,Yj,tF],jj),tb=kr([wm,bm,Uo,du,Cm,tF,eH,W1],Qj),KAe=kr([rF,tb],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),tH=kr(Cm,Jj,Dj),WAe=kr([eH,Jj,Dg,gu,tH,W1,eF],Hj),qAe=kr([rF],e=>({isActive:e.active,activeIndex:e.index})),$Ae=(e,t,r,n,l,u,d,a)=>{if(!(!e||!t||!n||!l||!u)){var v=Tse(e.chartX,e.chartY,t,r,a);if(v){var x=Fse(v,t),b=pse(x,d,u,n,l),I=Ise(t,u,b,v);return{activeIndex:String(b),activeCoordinate:I}}}};function c5(){return c5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c5.apply(null,arguments)}function nk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function dw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nk(Object(r),!0).forEach(function(n){XAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XAe(e,t,r){return(t=ZAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZAe(e){var t=YAe(e,"string");return typeof t=="symbol"?t:t+""}function YAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JAe(e){var{coordinate:t,payload:r,index:n,offset:l,tooltipAxisBandSize:u,layout:d,cursor:a,tooltipEventType:v,chartName:x}=e,b=t,I=r,M=n;if(!a||!b||x!=="ScatterChart"&&v!=="axis")return null;var L,U;if(x==="ScatterChart")L=b,U=mle;else if(x==="BarChart")L=gle(d,b,l,u),U=YQ;else if(d==="radial"){var{cx:R,cy:H,radius:q,startAngle:te,endAngle:J}=JQ(b);L={cx:R,cy:H,startAngle:te,endAngle:J,innerRadius:q,outerRadius:q},U=t7}else L={points:tce(d,b,l)},U=GQ;var se=typeof a=="object"&&"className"in a?a.className:void 0,ye=dw(dw(dw(dw({stroke:"#ccc",pointerEvents:"none"},l),L),Hc(a,!1)),{},{payload:I,payloadIndex:M,className:Bs("recharts-tooltip-cursor",se)});return Me.isValidElement(a)?Me.cloneElement(a,ye):Me.createElement(U,ye)}function ede(e){var t=jAe(),r=Nse(),n=qI(),l=HAe();return Me.createElement(JAe,c5({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:l}))}var rH=Me.createContext(null),tde=()=>Me.useContext(rH),fS={exports:{}},ik;function rde(){return ik||(ik=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function l(v,x,b){this.fn=v,this.context=x,this.once=b||!1}function u(v,x,b,I,M){if(typeof b!="function")throw new TypeError("The listener must be a function");var L=new l(b,I||v,M),U=r?r+x:x;return v._events[U]?v._events[U].fn?v._events[U]=[v._events[U],L]:v._events[U].push(L):(v._events[U]=L,v._eventsCount++),v}function d(v,x){--v._eventsCount===0?v._events=new n:delete v._events[x]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var x=[],b,I;if(this._eventsCount===0)return x;for(I in b=this._events)t.call(b,I)&&x.push(r?I.slice(1):I);return Object.getOwnPropertySymbols?x.concat(Object.getOwnPropertySymbols(b)):x},a.prototype.listeners=function(x){var b=r?r+x:x,I=this._events[b];if(!I)return[];if(I.fn)return[I.fn];for(var M=0,L=I.length,U=new Array(L);M<L;M++)U[M]=I[M].fn;return U},a.prototype.listenerCount=function(x){var b=r?r+x:x,I=this._events[b];return I?I.fn?1:I.length:0},a.prototype.emit=function(x,b,I,M,L,U){var R=r?r+x:x;if(!this._events[R])return!1;var H=this._events[R],q=arguments.length,te,J;if(H.fn){switch(H.once&&this.removeListener(x,H.fn,void 0,!0),q){case 1:return H.fn.call(H.context),!0;case 2:return H.fn.call(H.context,b),!0;case 3:return H.fn.call(H.context,b,I),!0;case 4:return H.fn.call(H.context,b,I,M),!0;case 5:return H.fn.call(H.context,b,I,M,L),!0;case 6:return H.fn.call(H.context,b,I,M,L,U),!0}for(J=1,te=new Array(q-1);J<q;J++)te[J-1]=arguments[J];H.fn.apply(H.context,te)}else{var se=H.length,ye;for(J=0;J<se;J++)switch(H[J].once&&this.removeListener(x,H[J].fn,void 0,!0),q){case 1:H[J].fn.call(H[J].context);break;case 2:H[J].fn.call(H[J].context,b);break;case 3:H[J].fn.call(H[J].context,b,I);break;case 4:H[J].fn.call(H[J].context,b,I,M);break;default:if(!te)for(ye=1,te=new Array(q-1);ye<q;ye++)te[ye-1]=arguments[ye];H[J].fn.apply(H[J].context,te)}}return!0},a.prototype.on=function(x,b,I){return u(this,x,b,I,!1)},a.prototype.once=function(x,b,I){return u(this,x,b,I,!0)},a.prototype.removeListener=function(x,b,I,M){var L=r?r+x:x;if(!this._events[L])return this;if(!b)return d(this,L),this;var U=this._events[L];if(U.fn)U.fn===b&&(!M||U.once)&&(!I||U.context===I)&&d(this,L);else{for(var R=0,H=[],q=U.length;R<q;R++)(U[R].fn!==b||M&&!U[R].once||I&&U[R].context!==I)&&H.push(U[R]);H.length?this._events[L]=H.length===1?H[0]:H:d(this,L)}return this},a.prototype.removeAllListeners=function(x){var b;return x?(b=r?r+x:x,this._events[b]&&d(this,b)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a}(fS)),fS.exports}var nde=rde();const ide=od(nde);var x1=new ide,u5="recharts.syncEvent.tooltip",ak="recharts.syncEvent.brush";function nH(e,t){if(t){var r=Number.parseInt(t,10);if(!rd(r))return e?.[r]}}var ade={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},iH=bA({name:"options",initialState:ade,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),ode=iH.reducer,{createEventEmitter:sde}=iH.actions;function lde(e){return e.tooltip.syncInteraction}var cde={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},aH=bA({name:"chartData",initialState:cde,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:ok,setDataStartEndIndexes:ude,setComputedData:IBe}=aH.actions,hde=aH.reducer,oH=()=>{};function fde(){var e=Yi(E3),t=Yi(B3),r=vc(),n=Yi(J7),l=Yi(Cm),u=qI(),d=WI(),a=Yi(v=>v.rootProps.className);Me.useEffect(()=>{if(e==null)return oH;var v=(x,b,I)=>{if(t!==I&&e===x){if(n==="index"){r(b);return}if(l!=null){var M;if(typeof n=="function"){var L={activeTooltipIndex:b.payload.index==null?void 0:Number(b.payload.index),isTooltipActive:b.payload.active,activeIndex:b.payload.index==null?void 0:Number(b.payload.index),activeLabel:b.payload.label,activeDataKey:b.payload.dataKey,activeCoordinate:b.payload.coordinate},U=n(l,L);M=l[U]}else n==="value"&&(M=l.find(Se=>String(Se.value)===b.payload.label));var{coordinate:R}=b.payload;if(M==null||b.payload.active===!1||R==null||d==null){r(s5({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:H,y:q}=R,te=Math.min(H,d.x+d.width),J=Math.min(q,d.y+d.height),se={x:u==="horizontal"?M.coordinate:te,y:u==="horizontal"?J:M.coordinate},ye=s5({active:b.payload.active,coordinate:se,dataKey:b.payload.dataKey,index:String(M.index),label:b.payload.label});r(ye)}}};return x1.on(u5,v),()=>{x1.off(u5,v)}},[a,r,t,e,n,l,u,d])}function Ade(){var e=Yi(E3),t=Yi(B3),r=vc();Me.useEffect(()=>{if(e==null)return oH;var n=(l,u,d)=>{t!==d&&e===l&&r(ude(u))};return x1.on(ak,n),()=>{x1.off(ak,n)}},[r,t,e])}function dde(){var e=vc();Me.useEffect(()=>{e(sde())},[e]),fde(),Ade()}function pde(e,t,r,n,l,u){var d=Yi(M=>GAe(M,e,t)),a=Yi(B3),v=Yi(E3),x=Yi(J7),b=Yi(lde),I=b?.active;Me.useEffect(()=>{if(!I&&v!=null&&a!=null){var M=s5({active:u,coordinate:r,dataKey:d,index:l,label:typeof n=="number"?String(n):n});x1.emit(u5,v,M,a)}},[I,r,d,l,n,a,v,x,u])}function sk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function lk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sk(Object(r),!0).forEach(function(n){mde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mde(e,t,r){return(t=gde(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gde(e){var t=_de(e,"string");return typeof t=="symbol"?t:t+""}function _de(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vde(e){return e.dataKey}function yde(e,t){return Me.isValidElement(e)?Me.cloneElement(e,t):typeof e=="function"?Me.createElement(e,t):Me.createElement(qse,t)}var ck=[],xde={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!yv.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function uk(e){var t=Lp(e,xde),{active:r,allowEscapeViewBox:n,animationDuration:l,animationEasing:u,content:d,filterNull:a,isAnimationActive:v,offset:x,payloadUniqBy:b,position:I,reverseDirection:M,useTranslate3d:L,wrapperStyle:U,cursor:R,shared:H,trigger:q,defaultIndex:te,portal:J,axisId:se}=t,ye=vc(),Se=typeof te=="number"?String(te):te;Me.useEffect(()=>{ye(Xfe({shared:H,trigger:q,axisId:se,active:r,defaultIndex:Se}))},[ye,H,q,se,r,Se]);var Be=WI(),De=VQ(),we=Gfe(H),{activeIndex:nt,isActive:_e}=Yi(Re=>qAe(Re,we,q,Se)),Ie=Yi(Re=>WAe(Re,we,q,Se)),Ze=Yi(Re=>tH(Re,we,q,Se)),st=Yi(Re=>KAe(Re,we,q,Se)),Et=Ie,Ut=tde(),jt=r??_e,[bt,Nt]=aoe([Et,jt]),ar=we==="axis"?Ze:void 0;pde(we,q,st,ar,nt,jt);var lt=J??Ut;if(lt==null)return null;var ie=Et??ck;jt||(ie=ck),a&&ie.length&&(ie=Pae(Et.filter(Re=>Re.value!=null&&(Re.hide!==!0||t.includeHidden)),b,vde));var Le=ie.length>0,Fe=Me.createElement(tle,{allowEscapeViewBox:n,animationDuration:l,animationEasing:u,isAnimationActive:v,active:jt,coordinate:st,hasPayload:Le,offset:x,position:I,reverseDirection:M,useTranslate3d:L,viewBox:Be,wrapperStyle:U,lastBoundingBox:bt,innerRef:Nt,hasPortalFromProps:!!J},yde(d,lk(lk({},t),{},{payload:ie,label:ar,active:jt,coordinate:st,accessibilityLayer:De})));return Me.createElement(Me.Fragment,null,$$.createPortal(Fe,lt),jt&&Me.createElement(ede,{cursor:R,tooltipEventType:we,coordinate:st,payload:Et,index:nt}))}var AS={},dS={},pS={},hk;function wde(){return hk||(hk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:l,edges:u}={}){let d,a=null;const v=u!=null&&u.includes("leading"),x=u==null||u.includes("trailing"),b=()=>{a!==null&&(r.apply(d,a),d=void 0,a=null)},I=()=>{x&&b(),R()};let M=null;const L=()=>{M!=null&&clearTimeout(M),M=setTimeout(()=>{M=null,I()},n)},U=()=>{M!==null&&(clearTimeout(M),M=null)},R=()=>{U(),d=void 0,a=null},H=()=>{b()},q=function(...te){if(l?.aborted)return;d=this,a=te;const J=M==null;L(),v&&J&&b()};return q.schedule=L,q.cancel=R,q.flush=H,l?.addEventListener("abort",R,{once:!0}),q}e.debounce=t}(pS)),pS}var fk;function bde(){return fk||(fk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wde();function r(n,l=0,u={}){typeof u!="object"&&(u={});const{leading:d=!1,trailing:a=!0,maxWait:v}=u,x=Array(2);d&&(x[0]="leading"),a&&(x[1]="trailing");let b,I=null;const M=t.debounce(function(...R){b=n.apply(this,R),I=null},l,{edges:x}),L=function(...R){return v!=null&&(I===null&&(I=Date.now()),Date.now()-I>=v)?(b=n.apply(this,R),I=Date.now(),M.cancel(),M.schedule(),b):(M.apply(this,R),b)},U=()=>(M.flush(),b);return L.cancel=M.cancel,L.flush=U,L}e.debounce=r}(dS)),dS}var Ak;function Ede(){return Ak||(Ak=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bde();function r(n,l=0,u={}){const{leading:d=!0,trailing:a=!0}=u;return t.debounce(n,l,{leading:d,maxWait:l,trailing:a})}e.throttle=r}(AS)),AS}var mS,dk;function Bde(){return dk||(dk=1,mS=Ede().throttle),mS}var Cde=Bde();const Sde=od(Cde);var gS=function(t,r){for(var n=arguments.length,l=new Array(n>2?n-2:0),u=2;u<n;u++)l[u-2]=arguments[u]};function pk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function _S(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pk(Object(r),!0).forEach(function(n){Tde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tde(e,t,r){return(t=Ide(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ide(e){var t=Fde(e,"string");return typeof t=="symbol"?t:t+""}function Fde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mk=Me.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:l="100%",height:u="100%",minWidth:d=0,minHeight:a,maxHeight:v,children:x,debounce:b=0,id:I,className:M,onResize:L,style:U={}}=e,R=Me.useRef(null),H=Me.useRef();H.current=L,Me.useImperativeHandle(t,()=>R.current);var[q,te]=Me.useState({containerWidth:n.width,containerHeight:n.height}),J=Me.useCallback((ye,Se)=>{te(Be=>{var De=Math.round(ye),we=Math.round(Se);return Be.containerWidth===De&&Be.containerHeight===we?Be:{containerWidth:De,containerHeight:we}})},[]);Me.useEffect(()=>{var ye=we=>{var nt,{width:_e,height:Ie}=we[0].contentRect;J(_e,Ie),(nt=H.current)===null||nt===void 0||nt.call(H,_e,Ie)};b>0&&(ye=Sde(ye,b,{trailing:!0,leading:!1}));var Se=new ResizeObserver(ye),{width:Be,height:De}=R.current.getBoundingClientRect();return J(Be,De),Se.observe(R.current),()=>{Se.disconnect()}},[J,b]);var se=Me.useMemo(()=>{var{containerWidth:ye,containerHeight:Se}=q;if(ye<0||Se<0)return null;gS(u0(l)||u0(u),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,l,u),gS(!r||r>0,"The aspect(%s) must be greater than zero.",r);var Be=u0(l)?ye:l,De=u0(u)?Se:u;return r&&r>0&&(Be?De=Be/r:De&&(Be=De*r),v&&De>v&&(De=v)),gS(Be>0||De>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Be,De,l,u,d,a,r),Me.Children.map(x,we=>Me.cloneElement(we,{width:Be,height:De,style:_S({width:Be,height:De},we.props.style)}))},[r,x,u,v,a,d,q,l]);return Me.createElement("div",{id:I?"".concat(I):void 0,className:Bs("recharts-responsive-container",M),style:_S(_S({},U),{},{width:l,height:u,minWidth:d,minHeight:a,maxHeight:v}),ref:R},Me.createElement("div",{style:{width:0,height:0,overflow:"visible"}},se))}),lv=e=>null;lv.displayName="Cell";function Pde(e,t,r){return(t=Lde(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lde(e){var t=Mde(e,"string");return typeof t=="symbol"?t:t+""}function Mde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Ode{constructor(t){Pde(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function gk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function Dde(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gk(Object(r),!0).forEach(function(n){Rde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rde(e,t,r){return(t=kde(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kde(e){var t=Ude(e,"string");return typeof t=="symbol"?t:t+""}function Ude(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nde={cacheSize:2e3,enableCache:!0},sH=Dde({},Nde),_k=new Ode(sH.cacheSize),zde={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},vk="recharts_measurement_span";function Qde(e,t){var r=t.fontSize||"",n=t.fontFamily||"",l=t.fontWeight||"",u=t.fontStyle||"",d=t.letterSpacing||"",a=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(l,"|").concat(u,"|").concat(d,"|").concat(a)}var yk=(e,t)=>{try{var r=document.getElementById(vk);r||(r=document.createElement("span"),r.setAttribute("id",vk),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,zde,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Xy=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||yv.isSsr)return{width:0,height:0};if(!sH.enableCache)return yk(t,r);var n=Qde(t,r),l=_k.get(n);if(l)return l;var u=yk(t,r);return _k.set(n,u),u},xk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,wk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,jde=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Hde=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,lH={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Vde=Object.keys(lH),k_="NaN";function Gde(e,t){return e*lH[t]}class If{static parse(t){var r,[,n,l]=(r=Hde.exec(t))!==null&&r!==void 0?r:[];return new If(parseFloat(n),l??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,rd(t)&&(this.unit=""),r!==""&&!jde.test(r)&&(this.num=NaN,this.unit=""),Vde.includes(r)&&(this.num=Gde(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new If(NaN,""):new If(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new If(NaN,""):new If(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new If(NaN,""):new If(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new If(NaN,""):new If(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return rd(this.num)}}function cH(e){if(e.includes(k_))return k_;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,l,u]=(r=xk.exec(t))!==null&&r!==void 0?r:[],d=If.parse(n??""),a=If.parse(u??""),v=l==="*"?d.multiply(a):d.divide(a);if(v.isNaN())return k_;t=t.replace(xk,v.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var x,[,b,I,M]=(x=wk.exec(t))!==null&&x!==void 0?x:[],L=If.parse(b??""),U=If.parse(M??""),R=I==="+"?L.add(U):L.subtract(U);if(R.isNaN())return k_;t=t.replace(wk,R.toString())}return t}var bk=/\(([^()]*)\)/;function Kde(e){for(var t=e,r;(r=bk.exec(t))!=null;){var[,n]=r;t=t.replace(bk,cH(n))}return t}function Wde(e){var t=e.replace(/\s+/g,"");return t=Kde(t),t=cH(t),t}function qde(e){try{return Wde(e)}catch{return k_}}function vS(e){var t=qde(e.slice(5,-1));return t===k_?"":t}var $de=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Xde=["dx","dy","angle","className","breakAll"];function h5(){return h5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h5.apply(null,arguments)}function Ek(e,t){if(e==null)return{};var r,n,l=Zde(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function Zde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uH=/[ \f\n\r\t\v\u2028\u2029]+/,hH=e=>{var{children:t,breakAll:r,style:n}=e;try{var l=[];Au(t)||(r?l=t.toString().split(""):l=t.toString().split(uH));var u=l.map(a=>({word:a,width:Xy(a,n).width})),d=r?0:Xy(" ",n).width;return{wordsWithComputedWidth:u,spaceWidth:d}}catch{return null}},Yde=(e,t,r,n,l)=>{var{maxLines:u,children:d,style:a,breakAll:v}=e,x=Ri(u),b=d,I=function(){var _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return _e.reduce((Ie,Ze)=>{var{word:st,width:Et}=Ze,Ut=Ie[Ie.length-1];if(Ut&&(n==null||l||Ut.width+Et+r<Number(n)))Ut.words.push(st),Ut.width+=Et+r;else{var jt={words:[st],width:Et};Ie.push(jt)}return Ie},[])},M=I(t),L=nt=>nt.reduce((_e,Ie)=>_e.width>Ie.width?_e:Ie);if(!x||l)return M;var U=M.length>u||L(M).width>Number(n);if(!U)return M;for(var R="…",H=nt=>{var _e=b.slice(0,nt),Ie=hH({breakAll:v,style:a,children:_e+R}).wordsWithComputedWidth,Ze=I(Ie),st=Ze.length>u||L(Ze).width>Number(n);return[st,Ze]},q=0,te=b.length-1,J=0,se;q<=te&&J<=b.length-1;){var ye=Math.floor((q+te)/2),Se=ye-1,[Be,De]=H(Se),[we]=H(ye);if(!Be&&!we&&(q=ye+1),Be&&we&&(te=ye-1),!Be&&we){se=De;break}J++}return se||M},Bk=e=>{var t=Au(e)?[]:e.toString().split(uH);return[{words:t}]},Jde=e=>{var{width:t,scaleToFit:r,children:n,style:l,breakAll:u,maxLines:d}=e;if((t||r)&&!yv.isSsr){var a,v,x=hH({breakAll:u,children:n,style:l});if(x){var{wordsWithComputedWidth:b,spaceWidth:I}=x;a=b,v=I}else return Bk(n);return Yde({breakAll:u,children:n,maxLines:d,style:l},a,v,t,r)}return Bk(n)},Ck="#808080",cE=Me.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:l="1em",capHeight:u="0.71em",scaleToFit:d=!1,textAnchor:a="start",verticalAnchor:v="end",fill:x=Ck}=e,b=Ek(e,$de),I=Me.useMemo(()=>Jde({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:d,style:b.style,width:b.width}),[b.breakAll,b.children,b.maxLines,d,b.style,b.width]),{dx:M,dy:L,angle:U,className:R,breakAll:H}=b,q=Ek(b,Xde);if(!Ip(r)||!Ip(n))return null;var te=r+(Ri(M)?M:0),J=n+(Ri(L)?L:0),se;switch(v){case"start":se=vS("calc(".concat(u,")"));break;case"middle":se=vS("calc(".concat((I.length-1)/2," * -").concat(l," + (").concat(u," / 2))"));break;default:se=vS("calc(".concat(I.length-1," * -").concat(l,")"));break}var ye=[];if(d){var Se=I[0].width,{width:Be}=b;ye.push("scale(".concat(Ri(Be)?Be/Se:1,")"))}return U&&ye.push("rotate(".concat(U,", ").concat(te,", ").concat(J,")")),ye.length&&(q.transform=ye.join(" ")),Me.createElement("text",h5({},Hc(q,!0),{ref:t,x:te,y:J,className:Bs("recharts-text",R),textAnchor:a,fill:x.includes("url")?Ck:x}),I.map((De,we)=>{var nt=De.words.join(H?"":" ");return Me.createElement("tspan",{x:te,dy:we===0?se:l,key:"".concat(nt,"-").concat(we)},nt)}))});cE.displayName="Text";var epe=["offset"],tpe=["labelRef"];function Sk(e,t){if(e==null)return{};var r,n,l=rpe(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function rpe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Tk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function $l(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tk(Object(r),!0).forEach(function(n){npe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function npe(e,t,r){return(t=ipe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ipe(e){var t=ape(e,"string");return typeof t=="symbol"?t:t+""}function ape(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rm(){return rm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rm.apply(null,arguments)}var ope=e=>{var{value:t,formatter:r}=e,n=Au(e.children)?t:e.children;return typeof r=="function"?r(n):n},nF=e=>e!=null&&typeof e=="function",spe=(e,t)=>{var r=lh(t-e),n=Math.min(Math.abs(t-e),360);return r*n},lpe=(e,t,r,n)=>{var{position:l,offset:u,className:d}=e,{cx:a,cy:v,innerRadius:x,outerRadius:b,startAngle:I,endAngle:M,clockWise:L}=n,U=(x+b)/2,R=spe(I,M),H=R>=0?1:-1,q,te;l==="insideStart"?(q=I+H*u,te=L):l==="insideEnd"?(q=M-H*u,te=!L):l==="end"&&(q=M+H*u,te=L),te=R<=0?te:!te;var J=Vc(a,v,U,q),se=Vc(a,v,U,q+(te?1:-1)*359),ye="M".concat(J.x,",").concat(J.y,`
    A`).concat(U,",").concat(U,",0,1,").concat(te?0:1,`,
    `).concat(se.x,",").concat(se.y),Se=Au(e.id)?f1("recharts-radial-line-"):e.id;return Me.createElement("text",rm({},r,{dominantBaseline:"central",className:Bs("recharts-radial-bar-label",d)}),Me.createElement("defs",null,Me.createElement("path",{id:Se,d:ye})),Me.createElement("textPath",{xlinkHref:"#".concat(Se)},t))},cpe=(e,t,r)=>{var{cx:n,cy:l,innerRadius:u,outerRadius:d,startAngle:a,endAngle:v}=e,x=(a+v)/2;if(r==="outside"){var{x:b,y:I}=Vc(n,l,d+t,x);return{x:b,y:I,textAnchor:b>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:l,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:l,textAnchor:"middle",verticalAnchor:"end"};var M=(u+d)/2,{x:L,y:U}=Vc(n,l,M,x);return{x:L,y:U,textAnchor:"middle",verticalAnchor:"middle"}},upe=(e,t)=>{var{parentViewBox:r,offset:n,position:l}=e,{x:u,y:d,width:a,height:v}=t,x=v>=0?1:-1,b=x*n,I=x>0?"end":"start",M=x>0?"start":"end",L=a>=0?1:-1,U=L*n,R=L>0?"end":"start",H=L>0?"start":"end";if(l==="top"){var q={x:u+a/2,y:d-x*n,textAnchor:"middle",verticalAnchor:I};return $l($l({},q),r?{height:Math.max(d-r.y,0),width:a}:{})}if(l==="bottom"){var te={x:u+a/2,y:d+v+b,textAnchor:"middle",verticalAnchor:M};return $l($l({},te),r?{height:Math.max(r.y+r.height-(d+v),0),width:a}:{})}if(l==="left"){var J={x:u-U,y:d+v/2,textAnchor:R,verticalAnchor:"middle"};return $l($l({},J),r?{width:Math.max(J.x-r.x,0),height:v}:{})}if(l==="right"){var se={x:u+a+U,y:d+v/2,textAnchor:H,verticalAnchor:"middle"};return $l($l({},se),r?{width:Math.max(r.x+r.width-se.x,0),height:v}:{})}var ye=r?{width:a,height:v}:{};return l==="insideLeft"?$l({x:u+U,y:d+v/2,textAnchor:H,verticalAnchor:"middle"},ye):l==="insideRight"?$l({x:u+a-U,y:d+v/2,textAnchor:R,verticalAnchor:"middle"},ye):l==="insideTop"?$l({x:u+a/2,y:d+b,textAnchor:"middle",verticalAnchor:M},ye):l==="insideBottom"?$l({x:u+a/2,y:d+v-b,textAnchor:"middle",verticalAnchor:I},ye):l==="insideTopLeft"?$l({x:u+U,y:d+b,textAnchor:H,verticalAnchor:M},ye):l==="insideTopRight"?$l({x:u+a-U,y:d+b,textAnchor:R,verticalAnchor:M},ye):l==="insideBottomLeft"?$l({x:u+U,y:d+v-b,textAnchor:H,verticalAnchor:I},ye):l==="insideBottomRight"?$l({x:u+a-U,y:d+v-b,textAnchor:R,verticalAnchor:I},ye):l&&typeof l=="object"&&(Ri(l.x)||u0(l.x))&&(Ri(l.y)||u0(l.y))?$l({x:u+uf(l.x,a),y:d+uf(l.y,v),textAnchor:"end",verticalAnchor:"end"},ye):$l({x:u+a/2,y:d+v/2,textAnchor:"middle",verticalAnchor:"middle"},ye)},hpe=e=>"cx"in e&&Ri(e.cx);function dA(e){var{offset:t=5}=e,r=Sk(e,epe),n=$l({offset:t},r),{viewBox:l,position:u,value:d,children:a,content:v,className:x="",textBreakAll:b,labelRef:I}=n,M=Yi(ij),L=WI(),U=u==="center"?L:M??L,R=l||U;if(!R||Au(d)&&Au(a)&&!Me.isValidElement(v)&&typeof v!="function")return null;var H=$l($l({},n),{},{viewBox:R});if(Me.isValidElement(v)){var{labelRef:q}=H,te=Sk(H,tpe);return Me.cloneElement(v,te)}var J;if(typeof v=="function"){if(J=Me.createElement(v,H),Me.isValidElement(J))return J}else J=ope(n);var se=hpe(R),ye=Hc(n,!0);if(se&&(u==="insideStart"||u==="insideEnd"||u==="end"))return lpe(n,J,ye,R);var Se=se?cpe(R,n.offset,n.position):upe(n,R);return Me.createElement(cE,rm({ref:I,className:Bs("recharts-label",x)},ye,Se,{breakAll:b}),J)}dA.displayName="Label";var fH=e=>{var{cx:t,cy:r,angle:n,startAngle:l,endAngle:u,r:d,radius:a,innerRadius:v,outerRadius:x,x:b,y:I,top:M,left:L,width:U,height:R,clockWise:H,labelViewBox:q}=e;if(q)return q;if(Ri(U)&&Ri(R)){if(Ri(b)&&Ri(I))return{x:b,y:I,width:U,height:R};if(Ri(M)&&Ri(L))return{x:M,y:L,width:U,height:R}}if(Ri(b)&&Ri(I))return{x:b,y:I,width:0,height:0};if(Ri(t)&&Ri(r))return{cx:t,cy:r,startAngle:l||n||0,endAngle:u||n||0,innerRadius:v||0,outerRadius:x||a||d||0,clockWise:H};if(e.viewBox)return e.viewBox},fpe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?Me.createElement(dA,rm({key:"label-implicit"},n)):Ip(e)?Me.createElement(dA,rm({key:"label-implicit",value:e},n)):Me.isValidElement(e)?e.type===dA?Me.cloneElement(e,$l({key:"label-implicit"},n)):Me.createElement(dA,rm({key:"label-implicit",content:e},n)):nF(e)?Me.createElement(dA,rm({key:"label-implicit",content:e},n)):e&&typeof e=="object"?Me.createElement(dA,rm({},e,{key:"label-implicit"},n)):null},Ape=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var{children:l,labelRef:u}=t,d=fH(t),a=R1(l,dA).map((x,b)=>Me.cloneElement(x,{viewBox:r||d,key:"label-".concat(b)}));if(!n)return a;var v=fpe(t.label,r||d,u);return[v,...a]};dA.parseViewBox=fH;dA.renderCallByParent=Ape;var yS={},xS={},Ik;function dpe(){return Ik||(Ik=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t}(xS)),xS}var wS={},Fk;function ppe(){return Fk||(Fk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t}(wS)),wS}var Pk;function mpe(){return Pk||(Pk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dpe(),r=ppe(),n=MI();function l(u){if(n.isArrayLike(u))return t.last(r.toArray(u))}e.last=l}(yS)),yS}var bS,Lk;function gpe(){return Lk||(Lk=1,bS=mpe().last),bS}var _pe=gpe();const vpe=od(_pe);var ype=["valueAccessor"],xpe=["data","dataKey","clockWise","id","textBreakAll"];function rb(){return rb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rb.apply(null,arguments)}function Mk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function Ok(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mk(Object(r),!0).forEach(function(n){wpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wpe(e,t,r){return(t=bpe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bpe(e){var t=Epe(e,"string");return typeof t=="symbol"?t:t+""}function Epe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dk(e,t){if(e==null)return{};var r,n,l=Bpe(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function Bpe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Cpe=e=>Array.isArray(e.value)?vpe(e.value):e.value;function y0(e){var{valueAccessor:t=Cpe}=e,r=Dk(e,ype),{data:n,dataKey:l,clockWise:u,id:d,textBreakAll:a}=r,v=Dk(r,xpe);return!n||!n.length?null:Me.createElement(vA,{className:"recharts-label-list"},n.map((x,b)=>{var I=Au(l)?t(x,b):wl(x&&x.payload,l),M=Au(d)?{}:{id:"".concat(d,"-").concat(b)};return Me.createElement(dA,rb({},Hc(x,!0),v,M,{parentViewBox:x.parentViewBox,value:I,textBreakAll:a,viewBox:dA.parseViewBox(Au(u)?x:Ok(Ok({},x),{},{clockWise:u})),key:"label-".concat(b),index:b}))}))}y0.displayName="LabelList";function Spe(e,t){return e?e===!0?Me.createElement(y0,{key:"labelList-implicit",data:t}):Me.isValidElement(e)||nF(e)?Me.createElement(y0,{key:"labelList-implicit",data:t,content:e}):typeof e=="object"?Me.createElement(y0,rb({data:t},e,{key:"labelList-implicit"})):null:null}function Tpe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var{children:n}=e,l=R1(n,y0).map((d,a)=>Me.cloneElement(d,{data:t,key:"labelList-".concat(a)}));if(!r)return l;var u=Spe(e.label,t);return[u,...l]}y0.renderCallByParent=Tpe;var AH=e=>e.graphicalItems.polarItems,Ipe=kr([Bl,H1],P3),iF=kr([AH,yc,Ipe],M3),Fpe=kr([iF],O3),aF=kr([Fpe,v3],D3),Ppe=kr([aF,yc,iF],k3),Lpe=kr([aF,yc,iF],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(l=>{var u,d=wl(n,(u=t.dataKey)!==null&&u!==void 0?u:l.dataKey);return{value:d,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:wl(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),Rk=()=>{},Mpe=kr([yc,xj,Rk,Lpe,Rk,Uo,Bl],N3),dH=kr([yc,Uo,aF,Ppe,j1,Bl,Mpe],z3),Ope=kr([dH,yc,Cv],H3);kr([yc,dH,Ope,Bl],G3);var Dpe={radiusAxis:{},angleAxis:{}},pH=bA({name:"polarAxis",initialState:Dpe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:FBe,removeRadiusAxis:PBe,addAngleAxis:LBe,removeAngleAxis:MBe}=pH.actions,Rpe=pH.reducer;function kk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function Uk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kk(Object(r),!0).forEach(function(n){kpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kpe(e,t,r){return(t=Upe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Upe(e){var t=Npe(e,"string");return typeof t=="symbol"?t:t+""}function Npe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zpe=(e,t)=>t,oF=kr([AH,zpe],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),Qpe=[],sF=(e,t,r)=>r?.length===0?Qpe:r,mH=kr([v3,oF,sF],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var l;if(t?.data!=null&&t.data.length>0?l=t.data:l=n,(!l||!l.length)&&r!=null&&(l=r.map(u=>Uk(Uk({},t.presentationProps),u.props))),l!=null)return l}}),jpe=kr([mH,oF,sF],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,l)=>{var u,d=wl(n,t.nameKey,t.name),a;return r!=null&&(u=r[l])!==null&&u!==void 0&&(u=u.props)!==null&&u!==void 0&&u.fill?a=r[l].props.fill:typeof n=="object"&&n!=null&&"fill"in n?a=n.fill:a=t.fill,{value:Vb(d,t.dataKey),color:a,payload:n,type:t.legendType}})}),Hpe=kr([mH,oF,sF,du],(e,t,r,n)=>{if(!(t==null||e==null))return Ume({offset:n,pieSettings:t,displayedData:e,cells:r})}),ES={},Nk;function Vpe(){return Nk||(Nk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const l=r[Symbol.toStringTag];return l==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${l}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t}(ES)),ES}var BS,zk;function Gpe(){return zk||(zk=1,BS=Vpe().isPlainObject),BS}var Kpe=Gpe();const Wpe=od(Kpe);function nb(){return nb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nb.apply(null,arguments)}var Qk=(e,t,r,n,l)=>{var u=r-n,d;return d="M ".concat(e,",").concat(t),d+="L ".concat(e+r,",").concat(t),d+="L ".concat(e+r-u/2,",").concat(t+l),d+="L ".concat(e+r-u/2-n,",").concat(t+l),d+="L ".concat(e,",").concat(t," Z"),d},qpe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},$pe=e=>{var t=Lp(e,qpe),r=Me.useRef(),[n,l]=Me.useState(-1);Me.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var H=r.current.getTotalLength();H&&l(H)}catch{}},[]);var{x:u,y:d,upperWidth:a,lowerWidth:v,height:x,className:b}=t,{animationEasing:I,animationDuration:M,animationBegin:L,isUpdateAnimationActive:U}=t;if(u!==+u||d!==+d||a!==+a||v!==+v||x!==+x||a===0&&v===0||x===0)return null;var R=Bs("recharts-trapezoid",b);return U?Me.createElement(Q2,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:x,x:u,y:d},to:{upperWidth:a,lowerWidth:v,height:x,x:u,y:d},duration:M,animationEasing:I,isActive:U},H=>{var{upperWidth:q,lowerWidth:te,height:J,x:se,y:ye}=H;return Me.createElement(Q2,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:L,duration:M,easing:I},Me.createElement("path",nb({},Hc(t,!0),{className:R,d:Qk(se,ye,q,te,J),ref:r})))}):Me.createElement("g",null,Me.createElement("path",nb({},Hc(t,!0),{className:R,d:Qk(u,d,a,v,x)})))},Xpe=["option","shapeType","propTransformer","activeClassName","isActive"];function Zpe(e,t){if(e==null)return{};var r,n,l=Ype(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function Ype(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function jk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function ib(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jk(Object(r),!0).forEach(function(n){Jpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jpe(e,t,r){return(t=eme(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eme(e){var t=tme(e,"string");return typeof t=="symbol"?t:t+""}function tme(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rme(e,t){return ib(ib({},t),e)}function nme(e,t){return e==="symbols"}function Hk(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return Me.createElement(YQ,r);case"trapezoid":return Me.createElement($pe,r);case"sector":return Me.createElement(t7,r);case"symbols":if(nme(t))return Me.createElement(eQ,r);break;default:return null}}function ime(e){return Me.isValidElement(e)?e.props:e}function gH(e){var{option:t,shapeType:r,propTransformer:n=rme,activeClassName:l="recharts-active-shape",isActive:u}=e,d=Zpe(e,Xpe),a;if(Me.isValidElement(t))a=Me.cloneElement(t,ib(ib({},d),ime(t)));else if(typeof t=="function")a=t(d);else if(Wpe(t)&&typeof t!="boolean"){var v=n(t,d);a=Me.createElement(Hk,{shapeType:r,elementProps:v})}else{var x=d;a=Me.createElement(Hk,{shapeType:r,elementProps:x})}return u?Me.createElement(vA,{className:l},a):a}var lF=(e,t)=>{var r=vc();return(n,l)=>u=>{e?.(n,l,u),r(kj({activeIndex:String(l),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},cF=e=>{var t=vc();return(r,n)=>l=>{e?.(r,n,l),t(Zfe())}},uF=(e,t)=>{var r=vc();return(n,l)=>u=>{e?.(n,l,u),r(Yfe({activeIndex:String(l),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function _H(e){var{fn:t,args:r}=e,n=vc(),l=jd();return Me.useEffect(()=>{if(!l){var u=t(r);return n(qfe(u)),()=>{n($fe(u))}}},[t,r,n,l]),null}var vH=()=>{};function ame(e){var{legendPayload:t}=e,r=vc(),n=jd();return Me.useEffect(()=>n?vH:(r(jQ(t)),()=>{r(HQ(t))}),[r,n,t]),null}function ome(e){var{legendPayload:t}=e,r=vc(),n=Yi(Uo);return Me.useEffect(()=>n!=="centric"&&n!=="radial"?vH:(r(jQ(t)),()=>{r(HQ(t))}),[r,n,t]),null}function yH(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=Me.useRef(f1(t)),n=Me.useRef(e);return n.current!==e&&(r.current=f1(t),n.current=e),r.current}var CS,sme=()=>{var[e]=Me.useState(()=>f1("uid-"));return e},lme=(CS=yq.useId)!==null&&CS!==void 0?CS:sme;function cme(e,t){var r=lme();return t||(e?"".concat(e,"-").concat(r):r)}var ume=Me.createContext(void 0),xH=e=>{var{id:t,type:r,children:n}=e,l=cme("recharts-".concat(r),t);return Me.createElement(ume.Provider,{value:l},n(l))},hme={cartesianItems:[],polarItems:[]},wH=bA({name:"graphicalItems",initialState:hme,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,l=cm(e).cartesianItems.indexOf(r);l>-1&&(e.cartesianItems[l]=n)},removeCartesianGraphicalItem(e,t){var r=cm(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=cm(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:fme,replaceCartesianGraphicalItem:Ame,removeCartesianGraphicalItem:dme,addPolarGraphicalItem:pme,removePolarGraphicalItem:mme}=wH.actions,gme=wH.reducer;function _me(e){var t=vc(),r=Me.useRef(null);return Me.useEffect(()=>{r.current===null?t(fme(e)):r.current!==e&&t(Ame({prev:r.current,next:e})),r.current=e},[t,e]),Me.useEffect(()=>()=>{r.current&&(t(dme(r.current)),r.current=null)},[t]),null}function vme(e){var t=vc();return Me.useEffect(()=>(t(pme(e)),()=>{t(mme(e))}),[t,e]),null}function yme(){}var xme={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Vk={t:0},SS={t:1};function bH(e){var t=Lp(e,xme),{isActive:r,canBegin:n,duration:l,easing:u,begin:d,onAnimationEnd:a,onAnimationStart:v,children:x}=t,b=ZQ("JavascriptAnimate",t.animationManager),[I,M]=Me.useState(r?Vk:SS),L=Me.useRef(null);return Me.useEffect(()=>{r||M(SS)},[r]),Me.useEffect(()=>{if(!r||!n)return yme;var U=XQ(Vk,SS,qQ(u),l,M,b.getTimeoutController()),R=()=>{L.current=U()};return b.start([v,d,R,l,a]),()=>{b.stop(),L.current&&L.current(),a()}},[r,n,l,u,d,v,a,b]),x(I.t)}var wme=["onMouseEnter","onClick","onMouseLeave"],bme=["id"],Eme=["id"];function hF(e,t){if(e==null)return{};var r,n,l=Bme(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function Bme(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Gk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function Yl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gk(Object(r),!0).forEach(function(n){Cme(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cme(e,t,r){return(t=Sme(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sme(e){var t=Tme(e,"string");return typeof t=="symbol"?t:t+""}function Tme(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vm(){return vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vm.apply(null,arguments)}function Ime(e){var t=Me.useMemo(()=>R1(e.children,lv),[e.children]),r=Yi(n=>jpe(n,e.id,t));return r==null?null:Me.createElement(ome,{legendPayload:r})}function Fme(e){var{dataKey:t,nameKey:r,sectors:n,stroke:l,strokeWidth:u,fill:d,name:a,hide:v,tooltipType:x}=e;return{dataDefinedOnItem:n?.map(b=>b.tooltipPayload),positions:n?.map(b=>b.tooltipPosition),settings:{stroke:l,strokeWidth:u,fill:d,dataKey:t,nameKey:r,name:Vb(a,t),hide:v,type:x,color:d,unit:""}}}var Pme=(e,t)=>e>t?"start":e<t?"end":"middle",Lme=(e,t,r)=>typeof t=="function"?t(e):uf(t,r,r*.8),Mme=(e,t,r)=>{var{top:n,left:l,width:u,height:d}=t,a=DQ(u,d),v=l+uf(e.cx,u,u/2),x=n+uf(e.cy,d,d/2),b=uf(e.innerRadius,a,0),I=Lme(r,e.outerRadius,a),M=e.maxRadius||Math.sqrt(u*u+d*d)/2;return{cx:v,cy:x,innerRadius:b,outerRadius:I,maxRadius:M}},Ome=(e,t)=>{var r=lh(t-e),n=Math.min(Math.abs(t-e),360);return r*n},Dme=(e,t)=>{if(Me.isValidElement(e))return Me.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Bs("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return Me.createElement(GQ,vm({},t,{type:"linear",className:r}))},Rme=(e,t,r)=>{if(Me.isValidElement(e))return Me.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),Me.isValidElement(n)))return n;var l=Bs("recharts-pie-label-text",typeof e!="boolean"&&typeof e!="function"?e.className:"");return Me.createElement(cE,vm({},t,{alignmentBaseline:"middle",className:l}),n)};function kme(e){var{sectors:t,props:r,showLabels:n}=e,{label:l,labelLine:u,dataKey:d}=r;if(!n||!l||!t)return null;var a=vv(r),v=Hc(l,!1),x=Hc(u,!1),b=typeof l=="object"&&"offsetRadius"in l&&l.offsetRadius||20,I=t.map((M,L)=>{var U=(M.startAngle+M.endAngle)/2,R=Vc(M.cx,M.cy,M.outerRadius+b,U),H=Yl(Yl(Yl(Yl({},a),M),{},{stroke:"none"},v),{},{index:L,textAnchor:Pme(R.x,M.cx)},R),q=Yl(Yl(Yl(Yl({},a),M),{},{fill:"none",stroke:M.fill},x),{},{index:L,points:[Vc(M.cx,M.cy,M.outerRadius,U),R],key:"line"});return Me.createElement(vA,{key:"label-".concat(M.startAngle,"-").concat(M.endAngle,"-").concat(M.midAngle,"-").concat(L)},u&&Dme(u,q),Rme(l,H,wl(M,d)))});return Me.createElement(vA,{className:"recharts-pie-labels"},I)}function EH(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:l,showLabels:u}=e,d=Yi(P0),{onMouseEnter:a,onClick:v,onMouseLeave:x}=l,b=hF(l,wme),I=lF(a,l.dataKey),M=cF(x),L=uF(v,l.dataKey);return t==null?null:Me.createElement(Me.Fragment,null,t.map((U,R)=>{if(U?.startAngle===0&&U?.endAngle===0&&t.length!==1)return null;var H=r&&String(R)===d,q=d?n:null,te=H?r:q,J=Yl(Yl({},U),{},{stroke:U.stroke,tabIndex:-1,[UQ]:R,[NQ]:l.dataKey});return Me.createElement(vA,vm({tabIndex:-1,className:"recharts-pie-sector"},Mb(b,U,R),{onMouseEnter:I(U,R),onMouseLeave:M(U,R),onClick:L(U,R),key:"sector-".concat(U?.startAngle,"-").concat(U?.endAngle,"-").concat(U.midAngle,"-").concat(R)}),Me.createElement(gH,vm({option:te,isActive:H,shapeType:"sector"},J)))}),Me.createElement(kme,{sectors:t,props:l,showLabels:u}))}function Ume(e){var t,{pieSettings:r,displayedData:n,cells:l,offset:u}=e,{cornerRadius:d,startAngle:a,endAngle:v,dataKey:x,nameKey:b,tooltipType:I}=r,M=Math.abs(r.minAngle),L=Ome(a,v),U=Math.abs(L),R=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,H=n.filter(Se=>wl(Se,x,0)!==0).length,q=(U>=360?H:H-1)*R,te=U-H*M-q,J=n.reduce((Se,Be)=>{var De=wl(Be,x,0);return Se+(Ri(De)?De:0)},0),se;if(J>0){var ye;se=n.map((Se,Be)=>{var De=wl(Se,x,0),we=wl(Se,b,Be),nt=Mme(r,u,Se),_e=(Ri(De)?De:0)/J,Ie,Ze=Yl(Yl({},Se),l&&l[Be]&&l[Be].props);Be?Ie=ye.endAngle+lh(L)*R*(De!==0?1:0):Ie=a;var st=Ie+lh(L)*((De!==0?M:0)+_e*te),Et=(Ie+st)/2,Ut=(nt.innerRadius+nt.outerRadius)/2,jt=[{name:we,value:De,payload:Ze,dataKey:x,type:I}],bt=Vc(nt.cx,nt.cy,Ut,Et);return ye=Yl(Yl(Yl(Yl({},r.presentationProps),{},{percent:_e,cornerRadius:d,name:we,tooltipPayload:jt,midAngle:Et,middleRadius:Ut,tooltipPosition:bt},Ze),nt),{},{value:wl(Se,x),startAngle:Ie,endAngle:st,payload:Ze,paddingAngle:lh(L)*R}),ye})}return se}function Nme(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:l,animationBegin:u,animationDuration:d,animationEasing:a,activeShape:v,inactiveShape:x,onAnimationStart:b,onAnimationEnd:I}=t,M=yH(t,"recharts-pie-"),L=r.current,[U,R]=Me.useState(!0),H=Me.useCallback(()=>{typeof I=="function"&&I(),R(!1)},[I]),q=Me.useCallback(()=>{typeof b=="function"&&b(),R(!0)},[b]);return Me.createElement(bH,{begin:u,duration:d,isActive:l,easing:a,onAnimationStart:q,onAnimationEnd:H,key:M},te=>{var J=[],se=n&&n[0],ye=se.startAngle;return n.forEach((Se,Be)=>{var De=L&&L[Be],we=Be>0?Tg(Se,"paddingAngle",0):0;if(De){var nt=vO(De.endAngle-De.startAngle,Se.endAngle-Se.startAngle),_e=Yl(Yl({},Se),{},{startAngle:ye+we,endAngle:ye+nt(te)+we});J.push(_e),ye=_e.endAngle}else{var{endAngle:Ie,startAngle:Ze}=Se,st=vO(0,Ie-Ze),Et=st(te),Ut=Yl(Yl({},Se),{},{startAngle:ye+we,endAngle:ye+Et+we});J.push(Ut),ye=Ut.endAngle}}),r.current=J,Me.createElement(vA,null,Me.createElement(EH,{sectors:J,activeShape:v,inactiveShape:x,allOtherPieProps:t,showLabels:!U}))})}function zme(e){var{sectors:t,isAnimationActive:r,activeShape:n,inactiveShape:l}=e,u=Me.useRef(null),d=u.current;return r&&t&&t.length&&(!d||d!==t)?Me.createElement(Nme,{props:e,previousSectorsRef:u}):Me.createElement(EH,{sectors:t,activeShape:n,inactiveShape:l,allOtherPieProps:e,showLabels:!0})}function Qme(e){var{hide:t,className:r,rootTabIndex:n}=e,l=Bs("recharts-pie",r);return t?null:Me.createElement(vA,{tabIndex:n,className:l},Me.createElement(zme,e))}var jme={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!yv.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function Hme(e){var{id:t}=e,r=hF(e,bme),n=Me.useMemo(()=>R1(e.children,lv),[e.children]),l=Yi(u=>Hpe(u,t,n));return Me.createElement(Me.Fragment,null,Me.createElement(_H,{fn:Fme,args:Yl(Yl({},e),{},{sectors:l})}),Me.createElement(Qme,vm({},r,{sectors:l})))}function BH(e){var t=Lp(e,jme),{id:r}=t,n=hF(t,Eme),l=vv(n);return Me.createElement(xH,{id:r,type:"pie"},u=>Me.createElement(Me.Fragment,null,Me.createElement(vme,{type:"pie",id:u,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:l}),Me.createElement(Ime,vm({},n,{id:u})),Me.createElement(Hme,vm({},n,{id:u})),n.children))}BH.displayName="Pie";var Vme=kr([du],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),Gme=kr([Vme,wm,bm],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),CH=()=>Yi(Gme),Kme="Invariant failed";function Wme(e,t){throw new Error(Kme)}var qme=["x","y"];function f5(){return f5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f5.apply(null,arguments)}function Kk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function Cy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kk(Object(r),!0).forEach(function(n){$me(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $me(e,t,r){return(t=Xme(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xme(e){var t=Zme(e,"string");return typeof t=="symbol"?t:t+""}function Zme(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yme(e,t){if(e==null)return{};var r,n,l=Jme(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function Jme(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ege(e,t){var{x:r,y:n}=e,l=Yme(e,qme),u="".concat(r),d=parseInt(u,10),a="".concat(n),v=parseInt(a,10),x="".concat(t.height||l.height),b=parseInt(x,10),I="".concat(t.width||l.width),M=parseInt(I,10);return Cy(Cy(Cy(Cy(Cy({},t),l),d?{x:d}:{}),v?{y:v}:{}),{},{height:b,width:M,name:t.name,radius:t.radius})}function SH(e){return Me.createElement(gH,f5({shapeType:"rectangle",propTransformer:ege,activeClassName:"recharts-active-bar"},e))}var tge=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,l)=>{if(Ri(t))return t;var u=Ri(n)||Au(n);return u?t(n,l):(u||Wme(),r)}},rge={},TH=bA({name:"errorBars",initialState:rge,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(l=>l.dataKey!==n.dataKey||l.direction!==n.direction))}}}),{addErrorBar:OBe,removeErrorBar:DBe}=TH.actions,nge=TH.reducer,ige=["children"];function age(e,t){if(e==null)return{};var r,n,l=oge(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function oge(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var sge={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},lge=Me.createContext(sge);function cge(e){var{children:t}=e,r=age(e,ige);return Me.createElement(lge.Provider,{value:r},t)}function IH(e,t){var r,n,l=Yi(x=>Bm(x,e)),u=Yi(x=>Rg(x,t)),d=(r=l?.allowDataOverflow)!==null&&r!==void 0?r:sA.allowDataOverflow,a=(n=u?.allowDataOverflow)!==null&&n!==void 0?n:lA.allowDataOverflow,v=d||a;return{needClip:v,needClipX:d,needClipY:a}}function uge(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,l=CH(),{needClipX:u,needClipY:d,needClip:a}=IH(t,r);if(!a)return null;var{x:v,y:x,width:b,height:I}=l;return Me.createElement("clipPath",{id:"clipPath-".concat(n)},Me.createElement("rect",{x:u?v:v-b/2,y:d?x:x-I/2,width:u?b:b*2,height:d?I:I*2}))}var hge=["onMouseEnter","onMouseLeave","onClick"],fge=["value","background","tooltipPosition"],Age=["id"],dge=["onMouseEnter","onClick","onMouseLeave"];function cv(){return cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cv.apply(null,arguments)}function Wk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function Rh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wk(Object(r),!0).forEach(function(n){pge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pge(e,t,r){return(t=mge(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mge(e){var t=gge(e,"string");return typeof t=="symbol"?t:t+""}function gge(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ab(e,t){if(e==null)return{};var r,n,l=_ge(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function _ge(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vge=e=>{var{dataKey:t,name:r,fill:n,legendType:l,hide:u}=e;return[{inactive:u,dataKey:t,type:l,color:n,value:Vb(r,t),payload:e}]};function yge(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:l,name:u,hide:d,unit:a}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:l,dataKey:t,nameKey:void 0,name:Vb(u,t),hide:d,type:e.tooltipType,color:e.fill,unit:a}}}function xge(e){var t=Yi(P0),{data:r,dataKey:n,background:l,allOtherBarProps:u}=e,{onMouseEnter:d,onMouseLeave:a,onClick:v}=u,x=ab(u,hge),b=lF(d,n),I=cF(a),M=uF(v,n);if(!l||r==null)return null;var L=Hc(l,!1);return Me.createElement(Me.Fragment,null,r.map((U,R)=>{var{value:H,background:q,tooltipPosition:te}=U,J=ab(U,fge);if(!q)return null;var se=b(U,R),ye=I(U,R),Se=M(U,R),Be=Rh(Rh(Rh(Rh(Rh({option:l,isActive:String(R)===t},J),{},{fill:"#eee"},q),L),Mb(x,U,R)),{},{onMouseEnter:se,onMouseLeave:ye,onClick:Se,dataKey:n,index:R,className:"recharts-bar-background-rectangle"});return Me.createElement(SH,cv({key:"background-bar-".concat(R)},Be))}))}function FH(e){var{data:t,props:r,showLabels:n}=e,l=vv(r),{id:u}=l,d=ab(l,Age),{shape:a,dataKey:v,activeBar:x}=r,b=Yi(P0),I=Yi(Xj),{onMouseEnter:M,onClick:L,onMouseLeave:U}=r,R=ab(r,dge),H=lF(M,v),q=cF(U),te=uF(L,v);return t?Me.createElement(Me.Fragment,null,t.map((J,se)=>{var ye=x&&String(se)===b&&(I==null||v===I),Se=ye?x:a,Be=Rh(Rh(Rh({},d),J),{},{isActive:ye,option:Se,index:se,dataKey:v});return Me.createElement(vA,cv({className:"recharts-bar-rectangle"},Mb(R,J,se),{onMouseEnter:H(J,se),onMouseLeave:q(J,se),onClick:te(J,se),key:"rectangle-".concat(J?.x,"-").concat(J?.y,"-").concat(J?.value,"-").concat(se)}),Me.createElement(SH,Be))}),n&&y0.renderCallByParent(r,t)):null}function wge(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:l,isAnimationActive:u,animationBegin:d,animationDuration:a,animationEasing:v,onAnimationEnd:x,onAnimationStart:b}=t,I=r.current,M=yH(t,"recharts-bar-"),[L,U]=Me.useState(!1),R=Me.useCallback(()=>{typeof x=="function"&&x(),U(!1)},[x]),H=Me.useCallback(()=>{typeof b=="function"&&b(),U(!0)},[b]);return Me.createElement(bH,{begin:d,duration:a,isActive:u,easing:v,onAnimationEnd:R,onAnimationStart:H,key:M},q=>{var te=q===1?n:n?.map((J,se)=>{var ye=I&&I[se];if(ye)return Rh(Rh({},J),{},{x:v_(ye.x,J.x,q),y:v_(ye.y,J.y,q),width:v_(ye.width,J.width,q),height:v_(ye.height,J.height,q)});if(l==="horizontal"){var Se=v_(0,J.height,q);return Rh(Rh({},J),{},{y:J.y+J.height-Se,height:Se})}var Be=v_(0,J.width,q);return Rh(Rh({},J),{},{width:Be})});return q>0&&(r.current=te??null),te==null?null:Me.createElement(vA,null,Me.createElement(FH,{props:t,data:te,showLabels:!L}))})}function bge(e){var{data:t,isAnimationActive:r}=e,n=Me.useRef(null);return r&&t&&t.length&&(n.current==null||n.current!==t)?Me.createElement(wge,{previousRectanglesRef:n,props:e}):Me.createElement(FH,{props:e,data:t,showLabels:!0})}var PH=0,Ege=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:wl(e,t)}};class Bge extends Me.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:l,xAxisId:u,yAxisId:d,needClip:a,background:v,id:x}=this.props;if(t)return null;var b=Bs("recharts-bar",l),I=x;return Me.createElement(vA,{className:b,id:x},a&&Me.createElement("defs",null,Me.createElement(uge,{clipPathId:I,xAxisId:u,yAxisId:d})),Me.createElement(vA,{className:"recharts-bar-rectangles",clipPath:a?"url(#clipPath-".concat(I,")"):void 0},Me.createElement(xge,{data:r,dataKey:n,background:v,allOtherBarProps:this.props}),Me.createElement(bge,this.props)),this.props.children)}}var Cge={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!yv.isSsr,legendType:"rect",minPointSize:PH,xAxisId:0,yAxisId:0};function Sge(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:l,minPointSize:u,activeBar:d,animationBegin:a,animationDuration:v,animationEasing:x,isAnimationActive:b}=e,{needClip:I}=IH(t,r),M=qI(),L=jd(),U=R1(e.children,lv),R=Yi(te=>e0e(te,t,r,L,e.id,U));if(M!=="vertical"&&M!=="horizontal")return null;var H,q=R?.[0];return q==null||q.height==null||q.width==null?H=0:H=M==="vertical"?q.height/2:q.width/2,Me.createElement(cge,{xAxisId:t,yAxisId:r,data:R,dataPointFormatter:Ege,errorBarOffset:H},Me.createElement(Bge,cv({},e,{layout:M,needClip:I,data:R,xAxisId:t,yAxisId:r,hide:n,legendType:l,minPointSize:u,activeBar:d,animationBegin:a,animationDuration:v,animationEasing:x,isAnimationActive:b})))}function Tge(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:l,bandSize:u,xAxis:d,yAxis:a,xAxisTicks:v,yAxisTicks:x,stackedData:b,displayedData:I,offset:M,cells:L}=e,U=t==="horizontal"?a:d,R=b?U.scale.domain():null,H=Ese({numericAxis:U});return I.map((q,te)=>{var J,se,ye,Se,Be,De;b?J=_se(b[te],R):(J=wl(q,r),Array.isArray(J)||(J=[H,J]));var we=tge(n,PH)(J[1],te);if(t==="horizontal"){var nt,[_e,Ie]=[a.scale(J[0]),a.scale(J[1])];se=MD({axis:d,ticks:v,bandSize:u,offset:l.offset,entry:q,index:te}),ye=(nt=Ie??_e)!==null&&nt!==void 0?nt:void 0,Se=l.size;var Ze=_e-Ie;if(Be=rd(Ze)?0:Ze,De={x:se,y:M.top,width:Se,height:M.height},Math.abs(we)>0&&Math.abs(Be)<Math.abs(we)){var st=lh(Be||we)*(Math.abs(we)-Math.abs(Be));ye-=st,Be+=st}}else{var[Et,Ut]=[d.scale(J[0]),d.scale(J[1])];if(se=Et,ye=MD({axis:a,ticks:x,bandSize:u,offset:l.offset,entry:q,index:te}),Se=Ut-Et,Be=l.size,De={x:M.left,y:ye,width:M.width,height:Be},Math.abs(we)>0&&Math.abs(Se)<Math.abs(we)){var jt=lh(Se||we)*(Math.abs(we)-Math.abs(Se));Se+=jt}}if(se==null||ye==null||Se==null||Be==null)return null;var bt=Rh(Rh({},q),{},{x:se,y:ye,width:Se,height:Be,value:b?J:J[1],payload:q,background:De,tooltipPosition:{x:se+Se/2,y:ye+Be/2}},L&&L[te]&&L[te].props);return bt}).filter(Boolean)}function LH(e){var t=Lp(e,Cge),r=jd();return Me.createElement(xH,{id:t.id,type:"bar"},n=>Me.createElement(Me.Fragment,null,Me.createElement(ame,{legendPayload:vge(t)}),Me.createElement(_H,{fn:yge,args:t}),Me.createElement(_me,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:bse(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),Me.createElement(Sge,cv({},t,{id:n}))))}LH.displayName="Bar";function qk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function pw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qk(Object(r),!0).forEach(function(n){Ige(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ige(e,t,r){return(t=Fge(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fge(e){var t=Pge(e,"string");return typeof t=="symbol"?t:t+""}function Pge(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lge=(e,t)=>t,Mge=(e,t,r)=>r,Oge=(e,t,r,n)=>n,Dge=(e,t,r,n,l)=>l,$1=kr([L3,Dge],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),Rge=kr([$1],e=>e?.maxBarSize),kge=(e,t,r,n,l,u)=>u,$k=(e,t,r)=>{var n=r??e;if(!Au(n))return uf(n,t,0)},Uge=kr([Uo,L3,Lge,Mge,Oge],(e,t,r,n,l)=>t.filter(u=>e==="horizontal"?u.xAxisId===r:u.yAxisId===n).filter(u=>u.isPanorama===l).filter(u=>u.hide===!1).filter(u=>u.type==="bar")),Nge=(e,t,r,n)=>{var l=Uo(e);return l==="horizontal"?o5(e,"yAxis",r,n):o5(e,"xAxis",t,n)},zge=(e,t,r)=>{var n=Uo(e);return n==="horizontal"?ZR(e,"xAxis",t):ZR(e,"yAxis",r)},Qge=(e,t,r)=>{var n={},l=e.filter(nE),u=e.filter(x=>x.stackId==null),d=l.reduce((x,b)=>(x[b.stackId]||(x[b.stackId]=[]),x[b.stackId].push(b),x),n),a=Object.entries(d).map(x=>{var[b,I]=x,M=I.map(U=>U.dataKey),L=$k(t,r,I[0].barSize);return{stackId:b,dataKeys:M,barSize:L}}),v=u.map(x=>{var b=[x.dataKey].filter(M=>M!=null),I=$k(t,r,x.barSize);return{stackId:void 0,dataKeys:b,barSize:I}});return[...a,...v]},jge=kr([Uge,$he,zge],Qge),Hge=(e,t,r,n,l)=>{var u,d,a=$1(e,t,r,n,l);if(a!=null){var v=Uo(e),x=Z7(e),{maxBarSize:b}=a,I=Au(b)?x:b,M,L;return v==="horizontal"?(M=sv(e,"xAxis",t,n),L=ov(e,"xAxis",t,n)):(M=sv(e,"yAxis",r,n),L=ov(e,"yAxis",r,n)),(u=(d=VI(M,L,!0))!==null&&d!==void 0?d:I)!==null&&u!==void 0?u:0}},MH=(e,t,r,n)=>{var l=Uo(e),u,d;return l==="horizontal"?(u=sv(e,"xAxis",t,n),d=ov(e,"xAxis",t,n)):(u=sv(e,"yAxis",r,n),d=ov(e,"yAxis",r,n)),VI(u,d)};function Vge(e,t,r,n,l){var u=n.length;if(!(u<1)){var d=uf(e,r,0,!0),a,v=[];if(wA(n[0].barSize)){var x=!1,b=r/u,I=n.reduce((q,te)=>q+(te.barSize||0),0);I+=(u-1)*d,I>=r&&(I-=(u-1)*d,d=0),I>=r&&b>0&&(x=!0,b*=.9,I=u*b);var M=(r-I)/2>>0,L={offset:M-d,size:0};a=n.reduce((q,te)=>{var J,se={stackId:te.stackId,dataKeys:te.dataKeys,position:{offset:L.offset+L.size+d,size:x?b:(J=te.barSize)!==null&&J!==void 0?J:0}},ye=[...q,se];return L=ye[ye.length-1].position,ye},v)}else{var U=uf(t,r,0,!0);r-2*U-(u-1)*d<=0&&(d=0);var R=(r-2*U-(u-1)*d)/u;R>1&&(R>>=0);var H=wA(l)?Math.min(R,l):R;a=n.reduce((q,te,J)=>[...q,{stackId:te.stackId,dataKeys:te.dataKeys,position:{offset:U+(R+d)*J+(R-H)/2,size:H}}],v)}return a}}var Gge=(e,t,r,n,l,u,d)=>{var a=Au(d)?t:d,v=Vge(r,n,l!==u?l:u,e,a);return l!==u&&v!=null&&(v=v.map(x=>pw(pw({},x),{},{position:pw(pw({},x.position),{},{offset:x.position.offset-l/2})}))),v},Kge=kr([jge,Z7,qhe,Y7,Hge,MH,Rge],Gge),Wge=(e,t,r,n)=>sv(e,"xAxis",t,n),qge=(e,t,r,n)=>sv(e,"yAxis",r,n),$ge=(e,t,r,n)=>ov(e,"xAxis",t,n),Xge=(e,t,r,n)=>ov(e,"yAxis",r,n),Zge=kr([Kge,$1],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),Yge=(e,t)=>{var r=I3(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var l=e[n];if(l){var{stackedData:u}=l;if(u)return u.find(d=>d.key===r)}}}},Jge=kr([Nge,$1],Yge),e0e=kr([du,Wge,qge,$ge,Xge,Zge,Uo,y3,MH,Jge,$1,kge],(e,t,r,n,l,u,d,a,v,x,b,I)=>{var{chartData:M,dataStartIndex:L,dataEndIndex:U}=a;if(!(b==null||u==null||d!=="horizontal"&&d!=="vertical"||t==null||r==null||n==null||l==null||v==null)){var{data:R}=b,H;if(R!=null&&R.length>0?H=R:H=M?.slice(L,U+1),H!=null)return Tge({layout:d,barSettings:b,pos:u,bandSize:v,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:l,stackedData:x,displayedData:H,offset:e,cells:I})}}),OH=e=>{var{chartData:t}=e,r=vc(),n=jd();return Me.useEffect(()=>n?()=>{}:(r(ok(t)),()=>{r(ok(void 0))}),[t,r,n]),null},Xk={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},DH=bA({name:"brush",initialState:Xk,reducers:{setBrushSettings(e,t){return t.payload==null?Xk:t.payload}}}),{setBrushSettings:RBe}=DH.actions,t0e=DH.reducer;function r0e(e,t,r){return(t=n0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n0e(e){var t=i0e(e,"string");return typeof t=="symbol"?t:t+""}function i0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class fF{static create(t){return new fF(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+l}case"end":{var u=this.bandwidth?this.bandwidth():0;return this.scale(t)+u}default:return this.scale(t)}if(r){var d=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+d}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],l=r[r.length-1];return n<=l?t>=n&&t<=l:t>=l&&t<=n}}r0e(fF,"EPS",1e-4);function a0e(e){return(e%180+180)%180}var o0e=function(t){var{width:r,height:n}=t,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=a0e(l),d=u*Math.PI/180,a=Math.atan(n/r),v=d>a&&d<Math.PI-a?n/Math.sin(d):r/Math.cos(d);return Math.abs(v)},s0e={dots:[],areas:[],lines:[]},RH=bA({name:"referenceElements",initialState:s0e,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=cm(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=cm(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=cm(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:kBe,removeDot:UBe,addArea:NBe,removeArea:zBe,addLine:QBe,removeLine:jBe}=RH.actions,l0e=RH.reducer,c0e=Me.createContext(void 0),u0e=e=>{var{children:t}=e,[r]=Me.useState("".concat(f1("recharts"),"-clip")),n=CH();if(n==null)return null;var{x:l,y:u,width:d,height:a}=n;return Me.createElement(c0e.Provider,{value:r},Me.createElement("defs",null,Me.createElement("clipPath",{id:r},Me.createElement("rect",{x:l,y:u,height:a,width:d}))),t)};function TS(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function kH(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],l=0;l<e.length;l+=t)n.push(e[l]);return n}function h0e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return o0e(n,r)}function f0e(e,t,r){var n=r==="width",{x:l,y:u,width:d,height:a}=e;return t===1?{start:n?l:u,end:n?l+d:u+a}:{start:n?l+d:u+a,end:n?l:u}}function ob(e,t,r,n,l){if(e*t<e*n||e*t>e*l)return!1;var u=r();return e*(t-e*u/2-n)>=0&&e*(t+e*u/2-l)<=0}function A0e(e,t){return kH(e,t+1)}function d0e(e,t,r,n,l){for(var u=(n||[]).slice(),{start:d,end:a}=t,v=0,x=1,b=d,I=function(){var U=n?.[v];if(U===void 0)return{v:kH(n,x)};var R=v,H,q=()=>(H===void 0&&(H=r(U,R)),H),te=U.coordinate,J=v===0||ob(e,te,q,b,a);J||(v=0,b=d,x+=1),J&&(b=te+e*(q()/2+l),v+=x)},M;x<=u.length;)if(M=I(),M)return M.v;return[]}function Zk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function Oh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zk(Object(r),!0).forEach(function(n){p0e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p0e(e,t,r){return(t=m0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m0e(e){var t=g0e(e,"string");return typeof t=="symbol"?t:t+""}function g0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _0e(e,t,r,n,l){for(var u=(n||[]).slice(),d=u.length,{start:a}=t,{end:v}=t,x=function(M){var L=u[M],U,R=()=>(U===void 0&&(U=r(L,M)),U);if(M===d-1){var H=e*(L.coordinate+e*R()/2-v);u[M]=L=Oh(Oh({},L),{},{tickCoord:H>0?L.coordinate-H*e:L.coordinate})}else u[M]=L=Oh(Oh({},L),{},{tickCoord:L.coordinate});var q=ob(e,L.tickCoord,R,a,v);q&&(v=L.tickCoord-e*(R()/2+l),u[M]=Oh(Oh({},L),{},{isShow:!0}))},b=d-1;b>=0;b--)x(b);return u}function v0e(e,t,r,n,l,u){var d=(n||[]).slice(),a=d.length,{start:v,end:x}=t;if(u){var b=n[a-1],I=r(b,a-1),M=e*(b.coordinate+e*I/2-x);d[a-1]=b=Oh(Oh({},b),{},{tickCoord:M>0?b.coordinate-M*e:b.coordinate});var L=ob(e,b.tickCoord,()=>I,v,x);L&&(x=b.tickCoord-e*(I/2+l),d[a-1]=Oh(Oh({},b),{},{isShow:!0}))}for(var U=u?a-1:a,R=function(te){var J=d[te],se,ye=()=>(se===void 0&&(se=r(J,te)),se);if(te===0){var Se=e*(J.coordinate-e*ye()/2-v);d[te]=J=Oh(Oh({},J),{},{tickCoord:Se<0?J.coordinate-Se*e:J.coordinate})}else d[te]=J=Oh(Oh({},J),{},{tickCoord:J.coordinate});var Be=ob(e,J.tickCoord,ye,v,x);Be&&(v=J.tickCoord+e*(ye()/2+l),d[te]=Oh(Oh({},J),{},{isShow:!0}))},H=0;H<U;H++)R(H);return d}function y0e(e,t,r){var{tick:n,ticks:l,viewBox:u,minTickGap:d,orientation:a,interval:v,tickFormatter:x,unit:b,angle:I}=e;if(!l||!l.length||!n)return[];if(Ri(v)||yv.isSsr){var M;return(M=A0e(l,Ri(v)?v:0))!==null&&M!==void 0?M:[]}var L=[],U=a==="top"||a==="bottom"?"width":"height",R=b&&U==="width"?Xy(b,{fontSize:t,letterSpacing:r}):{width:0,height:0},H=(J,se)=>{var ye=typeof x=="function"?x(J.value,se):J.value;return U==="width"?h0e(Xy(ye,{fontSize:t,letterSpacing:r}),R,I):Xy(ye,{fontSize:t,letterSpacing:r})[U]},q=l.length>=2?lh(l[1].coordinate-l[0].coordinate):1,te=f0e(u,q,U);return v==="equidistantPreserveStart"?d0e(q,te,H,l,d):(v==="preserveStart"||v==="preserveStartEnd"?L=v0e(q,te,H,l,d,v==="preserveStartEnd"):L=_0e(q,te,H,l,d),L.filter(J=>J.isShow))}var x0e=["viewBox"],w0e=["viewBox"];function U_(){return U_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U_.apply(null,arguments)}function Yk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function uu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yk(Object(r),!0).forEach(function(n){AF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jk(e,t){if(e==null)return{};var r,n,l=b0e(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function b0e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function AF(e,t,r){return(t=E0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E0e(e){var t=B0e(e,"string");return typeof t=="symbol"?t:t+""}function B0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Fv extends Me.Component{constructor(t){super(t),this.tickRefs=Me.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,r){var{viewBox:n}=t,l=Jk(t,x0e),u=this.props,{viewBox:d}=u,a=Jk(u,w0e);return!TS(n,d)||!TS(l,a)||!TS(r,this.state)}getTickLineCoord(t){var{x:r,y:n,width:l,height:u,orientation:d,tickSize:a,mirror:v,tickMargin:x}=this.props,b,I,M,L,U,R,H=v?-1:1,q=t.tickSize||a,te=Ri(t.tickCoord)?t.tickCoord:t.coordinate;switch(d){case"top":b=I=t.coordinate,L=n+ +!v*u,M=L-H*q,R=M-H*x,U=te;break;case"left":M=L=t.coordinate,I=r+ +!v*l,b=I-H*q,U=b-H*x,R=te;break;case"right":M=L=t.coordinate,I=r+ +v*l,b=I+H*q,U=b+H*x,R=te;break;default:b=I=t.coordinate,L=n+ +v*u,M=L+H*q,R=M+H*x,U=te;break}return{line:{x1:b,y1:M,x2:I,y2:L},tick:{x:U,y:R}}}getTickTextAnchor(){var{orientation:t,mirror:r}=this.props,n;switch(t){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:t,y:r,width:n,height:l,orientation:u,mirror:d,axisLine:a}=this.props,v=uu(uu(uu({},Hc(this.props,!1)),Hc(a,!1)),{},{fill:"none"});if(u==="top"||u==="bottom"){var x=+(u==="top"&&!d||u==="bottom"&&d);v=uu(uu({},v),{},{x1:t,y1:r+x*l,x2:t+n,y2:r+x*l})}else{var b=+(u==="left"&&!d||u==="right"&&d);v=uu(uu({},v),{},{x1:t+b*n,y1:r,x2:t+b*n,y2:r+l})}return Me.createElement("line",U_({},v,{className:Bs("recharts-cartesian-axis-line",Tg(a,"className"))}))}static renderTickItem(t,r,n){var l,u=Bs(r.className,"recharts-cartesian-axis-tick-value");if(Me.isValidElement(t))l=Me.cloneElement(t,uu(uu({},r),{},{className:u}));else if(typeof t=="function")l=t(uu(uu({},r),{},{className:u}));else{var d="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(d=Bs(d,t.className)),l=Me.createElement(cE,U_({},r,{className:d}),n)}return l}renderTicks(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:l,stroke:u,tick:d,tickFormatter:a,unit:v,padding:x}=this.props,b=y0e(uu(uu({},this.props),{},{ticks:n}),t,r),I=this.getTickTextAnchor(),M=this.getTickVerticalAnchor(),L=vv(this.props),U=Hc(d,!1),R=uu(uu({},L),{},{fill:"none"},Hc(l,!1)),H=b.map((q,te)=>{var{line:J,tick:se}=this.getTickLineCoord(q),ye=uu(uu(uu(uu({textAnchor:I,verticalAnchor:M},L),{},{stroke:"none",fill:u},U),se),{},{index:te,payload:q,visibleTicksCount:b.length,tickFormatter:a,padding:x});return Me.createElement(vA,U_({className:"recharts-cartesian-axis-tick",key:"tick-".concat(q.value,"-").concat(q.coordinate,"-").concat(q.tickCoord)},Mb(this.props,q,te)),l&&Me.createElement("line",U_({},R,J,{className:Bs("recharts-cartesian-axis-tick-line",Tg(l,"className"))})),d&&Fv.renderTickItem(d,ye,"".concat(typeof a=="function"?a(q.value,te):q.value).concat(v||"")))});return H.length>0?Me.createElement("g",{className:"recharts-cartesian-axis-ticks"},H):null}render(){var{axisLine:t,width:r,height:n,className:l,hide:u}=this.props;if(u)return null;var{ticks:d}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:Me.createElement(vA,{className:Bs("recharts-cartesian-axis",l),ref:a=>{if(a){var v=a.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(v);var x=v[0];if(x){var b=window.getComputedStyle(x).fontSize,I=window.getComputedStyle(x).letterSpacing;(b!==this.state.fontSize||I!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(x).fontSize,letterSpacing:window.getComputedStyle(x).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,d),dA.renderCallByParent(this.props))}}AF(Fv,"displayName","CartesianAxis");AF(Fv,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});function eU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function tU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eU(Object(r),!0).forEach(function(n){C0e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function C0e(e,t,r){return(t=S0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S0e(e){var t=T0e(e,"string");return typeof t=="symbol"?t:t+""}function T0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I0e={xAxis:{},yAxis:{},zAxis:{}},UH=bA({name:"cartesianAxis",initialState:I0e,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=tU(tU({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:F0e,removeXAxis:P0e,addYAxis:L0e,removeYAxis:M0e,addZAxis:HBe,removeZAxis:VBe,updateYAxisWidth:O0e}=UH.actions,D0e=UH.reducer,R0e=["children"],k0e=["dangerouslySetInnerHTML","ticks"];function NH(e,t,r){return(t=U0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U0e(e){var t=N0e(e,"string");return typeof t=="symbol"?t:t+""}function N0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A5(){return A5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A5.apply(null,arguments)}function zH(e,t){if(e==null)return{};var r,n,l=z0e(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function z0e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Q0e(e){var t=vc(),r=Me.useMemo(()=>{var{children:u}=e,d=zH(e,R0e);return d},[e]),n=Yi(u=>Bm(u,r.id)),l=r===n;return Me.useEffect(()=>(t(F0e(r)),()=>{t(P0e(r))}),[r,t]),l?e.children:null}var j0e=e=>{var{xAxisId:t,className:r}=e,n=Yi(zQ),l=jd(),u="xAxis",d=Yi(L=>Sv(L,u,t,l)),a=Yi(L=>Pj(L,u,t,l)),v=Yi(L=>Sj(L,t)),x=Yi(L=>Nfe(L,t));if(v==null||x==null)return null;var{dangerouslySetInnerHTML:b,ticks:I}=e,M=zH(e,k0e);return Me.createElement(Fv,A5({},M,{scale:d,x:x.x,y:x.y,width:v.width,height:v.height,className:Bs("recharts-".concat(u," ").concat(u),r),viewBox:n,ticks:a}))},H0e=e=>{var t,r,n,l,u;return Me.createElement(Q0e,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(l=e.minTickGap)!==null&&l!==void 0?l:5,tick:(u=e.tick)!==null&&u!==void 0?u:!0,tickFormatter:e.tickFormatter},Me.createElement(j0e,e))};class dF extends Me.Component{render(){return Me.createElement(H0e,this.props)}}NH(dF,"displayName","XAxis");NH(dF,"defaultProps",{allowDataOverflow:sA.allowDataOverflow,allowDecimals:sA.allowDecimals,allowDuplicatedCategory:sA.allowDuplicatedCategory,height:sA.height,hide:!1,mirror:sA.mirror,orientation:sA.orientation,padding:sA.padding,reversed:sA.reversed,scale:sA.scale,tickCount:sA.tickCount,type:sA.type,xAxisId:0});var V0e=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:l=0,tickMargin:u=0}=e,d=0;if(t){t.forEach(b=>{if(b){var I=b.getBoundingClientRect();I.width>d&&(d=I.width)}});var a=r?r.getBoundingClientRect().width:0,v=l+u,x=d+v+a+(r?n:0);return Math.round(x)}return 0},G0e=["dangerouslySetInnerHTML","ticks"];function QH(e,t,r){return(t=K0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K0e(e){var t=W0e(e,"string");return typeof t=="symbol"?t:t+""}function W0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function d5(){return d5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d5.apply(null,arguments)}function q0e(e,t){if(e==null)return{};var r,n,l=$0e(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function $0e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function X0e(e){var t=vc();return Me.useEffect(()=>(t(L0e(e)),()=>{t(M0e(e))}),[e,t]),null}var Z0e=e=>{var t,{yAxisId:r,className:n,width:l,label:u}=e,d=Me.useRef(null),a=Me.useRef(null),v=Yi(zQ),x=jd(),b=vc(),I="yAxis",M=Yi(J=>Sv(J,I,r,x)),L=Yi(J=>Tj(J,r)),U=Yi(J=>zfe(J,r)),R=Yi(J=>Pj(J,I,r,x));if(Me.useLayoutEffect(()=>{var J;if(!(l!=="auto"||!L||nF(u)||Me.isValidElement(u))){var se=d.current,ye=se==null||(J=se.tickRefs)===null||J===void 0?void 0:J.current,{tickSize:Se,tickMargin:Be}=se.props,De=V0e({ticks:ye,label:a.current,labelGapWithTick:5,tickSize:Se,tickMargin:Be});Math.round(L.width)!==Math.round(De)&&b(O0e({id:r,width:De}))}},[d,d==null||(t=d.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,L?.width,L,b,u,r,l]),L==null||U==null)return null;var{dangerouslySetInnerHTML:H,ticks:q}=e,te=q0e(e,G0e);return Me.createElement(Fv,d5({},te,{ref:d,labelRef:a,scale:M,x:U.x,y:U.y,width:L.width,height:L.height,className:Bs("recharts-".concat(I," ").concat(I),n),viewBox:v,ticks:R}))},Y0e=e=>{var t,r,n,l,u;return Me.createElement(Me.Fragment,null,Me.createElement(X0e,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(l=e.minTickGap)!==null&&l!==void 0?l:5,tick:(u=e.tick)!==null&&u!==void 0?u:!0,tickFormatter:e.tickFormatter}),Me.createElement(Z0e,e))},J0e={allowDataOverflow:lA.allowDataOverflow,allowDecimals:lA.allowDecimals,allowDuplicatedCategory:lA.allowDuplicatedCategory,hide:!1,mirror:lA.mirror,orientation:lA.orientation,padding:lA.padding,reversed:lA.reversed,scale:lA.scale,tickCount:lA.tickCount,type:lA.type,width:lA.width,yAxisId:0};class pF extends Me.Component{render(){return Me.createElement(Y0e,this.props)}}QH(pF,"displayName","YAxis");QH(pF,"defaultProps",J0e);var IS={exports:{}},FS={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rU;function e_e(){if(rU)return FS;rU=1;var e=hv();function t(v,x){return v===x&&(v!==0||1/v===1/x)||v!==v&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,l=e.useRef,u=e.useEffect,d=e.useMemo,a=e.useDebugValue;return FS.useSyncExternalStoreWithSelector=function(v,x,b,I,M){var L=l(null);if(L.current===null){var U={hasValue:!1,value:null};L.current=U}else U=L.current;L=d(function(){function H(ye){if(!q){if(q=!0,te=ye,ye=I(ye),M!==void 0&&U.hasValue){var Se=U.value;if(M(Se,ye))return J=Se}return J=ye}if(Se=J,r(te,ye))return Se;var Be=I(ye);return M!==void 0&&M(Se,Be)?(te=ye,Se):(te=ye,J=Be)}var q=!1,te,J,se=b===void 0?null:b;return[function(){return H(x())},se===null?void 0:function(){return H(se())}]},[x,b,I,M]);var R=n(v,L[0],L[1]);return u(function(){U.hasValue=!0,U.value=R},[R]),a(R),R},FS}var nU;function t_e(){return nU||(nU=1,IS.exports=e_e()),IS.exports}t_e();function r_e(e){e()}function n_e(){let e=null,t=null;return{clear(){e=null,t=null},notify(){r_e(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const l=t={callback:r,next:null,prev:t};return l.prev?l.prev.next=l:e=l,function(){!n||e===null||(n=!1,l.next?l.next.prev=l.prev:t=l.prev,l.prev?l.prev.next=l.next:e=l.next)}}}}var iU={notify(){},get:()=>[]};function i_e(e,t){let r,n=iU,l=0,u=!1;function d(R){b();const H=n.subscribe(R);let q=!1;return()=>{q||(q=!0,H(),I())}}function a(){n.notify()}function v(){U.onStateChange&&U.onStateChange()}function x(){return u}function b(){l++,r||(r=e.subscribe(v),n=n_e())}function I(){l--,r&&l===0&&(r(),r=void 0,n.clear(),n=iU)}function M(){u||(u=!0,b())}function L(){u&&(u=!1,I())}const U={addNestedSub:d,notifyNestedSubs:a,handleChangeWrapper:v,isSubscribed:x,trySubscribe:M,tryUnsubscribe:L,getListeners:()=>n};return U}var a_e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",o_e=a_e(),s_e=()=>typeof navigator<"u"&&navigator.product==="ReactNative",l_e=s_e(),c_e=()=>o_e||l_e?Me.useLayoutEffect:Me.useEffect,u_e=c_e(),h_e=Symbol.for("react-redux-context"),f_e=typeof globalThis<"u"?globalThis:{};function A_e(){if(!Me.createContext)return{};const e=f_e[h_e]??=new Map;let t=e.get(Me.createContext);return t||(t=Me.createContext(null),e.set(Me.createContext,t)),t}var d_e=A_e();function p_e(e){const{children:t,context:r,serverState:n,store:l}=e,u=Me.useMemo(()=>{const v=i_e(l);return{store:l,subscription:v,getServerState:n?()=>n:void 0}},[l,n]),d=Me.useMemo(()=>l.getState(),[l]);u_e(()=>{const{subscription:v}=u;return v.onStateChange=v.notifyNestedSubs,v.trySubscribe(),d!==l.getState()&&v.notifyNestedSubs(),()=>{v.tryUnsubscribe(),v.onStateChange=void 0}},[u,d]);const a=r||d_e;return Me.createElement(a.Provider,{value:u},t)}var m_e=p_e,g_e=(e,t)=>t,mF=kr([g_e,Uo,ij,mu,Kj,Cm,VAe,du],$Ae),gF=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},jH=nd("mouseClick"),HH=k1();HH.startListening({actionCreator:jH,effect:(e,t)=>{var r=e.payload,n=mF(t.getState(),gF(r));n?.activeIndex!=null&&t.dispatch(Jfe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var p5=nd("mouseMove"),VH=k1();VH.startListening({actionCreator:p5,effect:(e,t)=>{var r=e.payload,n=t.getState(),l=q3(n,n.tooltip.settings.shared),u=mF(n,gF(r));l==="axis"&&(u?.activeIndex!=null?t.dispatch(Nj({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate})):t.dispatch(Uj()))}});function __e(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var aU={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},GH=bA({name:"rootProps",initialState:aU,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:aU.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),v_e=GH.reducer,{updateOptions:y_e}=GH.actions,KH=bA({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:x_e}=KH.actions,w_e=KH.reducer,WH=nd("keyDown"),qH=nd("focus"),_F=k1();_F.startListening({actionCreator:WH,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:l}=r.tooltip,u=e.payload;if(!(u!=="ArrowRight"&&u!=="ArrowLeft"&&u!=="Enter")){var d=Number($3(l,Iv(r))),a=Cm(r);if(u==="Enter"){var v=tb(r,"axis","hover",String(l.index));t.dispatch(l5({active:!l.active,activeIndex:l.index,activeDataKey:l.dataKey,activeCoordinate:v}));return}var x=Vfe(r),b=x==="left-to-right"?1:-1,I=u==="ArrowRight"?1:-1,M=d+I*b;if(!(a==null||M>=a.length||M<0)){var L=tb(r,"axis","hover",String(M));t.dispatch(l5({active:!0,activeIndex:M.toString(),activeDataKey:void 0,activeCoordinate:L}))}}}}});_F.startListening({actionCreator:qH,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:l}=r.tooltip;if(!l.active&&l.index==null){var u="0",d=tb(r,"axis","hover",String(u));t.dispatch(l5({activeDataKey:void 0,active:!0,activeIndex:u,activeCoordinate:d}))}}}});var qA=nd("externalEvent"),$H=k1();$H.startListening({actionCreator:qA,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:DAe(r),activeDataKey:Xj(r),activeIndex:P0(r),activeLabel:$j(r),activeTooltipIndex:P0(r),isTooltipActive:RAe(r)};e.payload.handler(n,e.payload.reactEvent)}}});var b_e=kr([Tv],e=>e.tooltipItemPayloads),E_e=kr([b_e,W1,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var l=e.find(a=>a.settings.dataKey===n);if(l!=null){var{positions:u}=l;if(u!=null){var d=t(u,r);return d}}}),XH=nd("touchMove"),ZH=k1();ZH.startListening({actionCreator:XH,effect:(e,t)=>{var r=e.payload,n=t.getState(),l=q3(n,n.tooltip.settings.shared);if(l==="axis"){var u=mF(n,gF({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));u?.activeIndex!=null&&t.dispatch(Nj({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate}))}else if(l==="item"){var d,a=r.touches[0],v=document.elementFromPoint(a.clientX,a.clientY);if(!v||!v.getAttribute)return;var x=v.getAttribute(UQ),b=(d=v.getAttribute(NQ))!==null&&d!==void 0?d:void 0,I=E_e(t.getState(),x,b);t.dispatch(kj({activeDataKey:b,activeIndex:x,activeCoordinate:I}))}}});var B_e=fQ({brush:t0e,cartesianAxis:D0e,chartData:hde,errorBars:nge,graphicalItems:gme,layout:rse,legend:Hse,options:ode,polarAxis:Rpe,polarOptions:w_e,referenceElements:l0e,rootProps:v_e,tooltip:eAe}),C_e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return Soe({reducer:B_e,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([HH.middleware,VH.middleware,_F.middleware,$H.middleware,ZH.middleware]),devTools:{serialize:{replacer:__e},name:"recharts-".concat(r)}})};function YH(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,l=jd(),u=Me.useRef(null);if(l)return r;u.current==null&&(u.current=C_e(t,n));var d=UI;return Me.createElement(m_e,{context:d,store:u.current},r)}function JH(e){var{layout:t,width:r,height:n,margin:l}=e,u=vc(),d=jd();return Me.useEffect(()=>{d||(u(Joe(t)),u(ese({width:r,height:n})),u(Yoe(l)))},[u,d,t,r,n,l]),null}function eV(e){var t=vc();return Me.useEffect(()=>{t(y_e(e))},[t,e]),null}var S_e=["children"];function T_e(e,t){if(e==null)return{};var r,n,l=I_e(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function I_e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function sb(){return sb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sb.apply(null,arguments)}var F_e={width:"100%",height:"100%"},P_e=Me.forwardRef((e,t)=>{var r=zse(),n=Qse(),l=VQ();if(!tv(r)||!tv(n))return null;var{children:u,otherAttributes:d,title:a,desc:v}=e,x,b;return typeof d.tabIndex=="number"?x=d.tabIndex:x=l?0:void 0,typeof d.role=="string"?b=d.role:b=l?"application":void 0,Me.createElement(Rz,sb({},d,{title:a,desc:v,role:b,tabIndex:x,width:r,height:n,style:F_e,ref:t}),u)}),L_e=e=>{var{children:t}=e,r=Yi(Wb);if(!r)return null;var{width:n,height:l,y:u,x:d}=r;return Me.createElement(Rz,{width:n,height:l,x:d,y:u},t)},oU=Me.forwardRef((e,t)=>{var{children:r}=e,n=T_e(e,S_e),l=jd();return l?Me.createElement(L_e,null,r):Me.createElement(P_e,sb({ref:t},n),r)});function M_e(){var e=vc(),[t,r]=Me.useState(null),n=Yi(Pse);return Me.useEffect(()=>{if(t!=null){var l=t.getBoundingClientRect(),u=l.width/t.offsetWidth;wA(u)&&u!==n&&e(tse(u))}},[t,e,n]),r}function sU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,n)}return r}function O_e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sU(Object(r),!0).forEach(function(n){D_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D_e(e,t,r){return(t=R_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R_e(e){var t=k_e(e,"string");return typeof t=="symbol"?t:t+""}function k_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U_e=Me.forwardRef((e,t)=>{var{children:r,className:n,height:l,onClick:u,onContextMenu:d,onDoubleClick:a,onMouseDown:v,onMouseEnter:x,onMouseLeave:b,onMouseMove:I,onMouseUp:M,onTouchEnd:L,onTouchMove:U,onTouchStart:R,style:H,width:q}=e,te=vc(),[J,se]=Me.useState(null),[ye,Se]=Me.useState(null);dde();var Be=M_e(),De=Me.useCallback(ie=>{Be(ie),typeof t=="function"&&t(ie),se(ie),Se(ie)},[Be,t,se,Se]),we=Me.useCallback(ie=>{te(jH(ie)),te(qA({handler:u,reactEvent:ie}))},[te,u]),nt=Me.useCallback(ie=>{te(p5(ie)),te(qA({handler:x,reactEvent:ie}))},[te,x]),_e=Me.useCallback(ie=>{te(Uj()),te(qA({handler:b,reactEvent:ie}))},[te,b]),Ie=Me.useCallback(ie=>{te(p5(ie)),te(qA({handler:I,reactEvent:ie}))},[te,I]),Ze=Me.useCallback(()=>{te(qH())},[te]),st=Me.useCallback(ie=>{te(WH(ie.key))},[te]),Et=Me.useCallback(ie=>{te(qA({handler:d,reactEvent:ie}))},[te,d]),Ut=Me.useCallback(ie=>{te(qA({handler:a,reactEvent:ie}))},[te,a]),jt=Me.useCallback(ie=>{te(qA({handler:v,reactEvent:ie}))},[te,v]),bt=Me.useCallback(ie=>{te(qA({handler:M,reactEvent:ie}))},[te,M]),Nt=Me.useCallback(ie=>{te(qA({handler:R,reactEvent:ie}))},[te,R]),ar=Me.useCallback(ie=>{te(XH(ie)),te(qA({handler:U,reactEvent:ie}))},[te,U]),lt=Me.useCallback(ie=>{te(qA({handler:L,reactEvent:ie}))},[te,L]);return Me.createElement(rH.Provider,{value:J},Me.createElement(bie.Provider,{value:ye},Me.createElement("div",{className:Bs("recharts-wrapper",n),style:O_e({position:"relative",cursor:"default",width:q,height:l},H),onClick:we,onContextMenu:Et,onDoubleClick:Ut,onFocus:Ze,onKeyDown:st,onMouseDown:jt,onMouseEnter:nt,onMouseLeave:_e,onMouseMove:Ie,onMouseUp:bt,onTouchEnd:lt,onTouchMove:ar,onTouchStart:Nt,ref:De},r)))}),N_e=["children","className","width","height","style","compact","title","desc"];function z_e(e,t){if(e==null)return{};var r,n,l=Q_e(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function Q_e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tV=Me.forwardRef((e,t)=>{var{children:r,className:n,width:l,height:u,style:d,compact:a,title:v,desc:x}=e,b=z_e(e,N_e),I=vv(b);return a?Me.createElement(oU,{otherAttributes:I,title:v,desc:x},r):Me.createElement(U_e,{className:n,style:d,width:l,height:u,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},Me.createElement(oU,{otherAttributes:I,title:v,desc:x,ref:t},Me.createElement(u0e,null,r)))}),j_e=["width","height"];function m5(){return m5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m5.apply(null,arguments)}function H_e(e,t){if(e==null)return{};var r,n,l=V_e(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function V_e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var G_e={top:5,right:5,bottom:5,left:5},K_e={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:G_e,reverseStackOrder:!1,syncMethod:"index"},W_e=Me.forwardRef(function(t,r){var n,l=Lp(t.categoricalChartProps,K_e),{width:u,height:d}=l,a=H_e(l,j_e);if(!tv(u)||!tv(d))return null;var{chartName:v,defaultTooltipEventType:x,validateTooltipEventTypes:b,tooltipPayloadSearcher:I,categoricalChartProps:M}=t,L={chartName:v,defaultTooltipEventType:x,validateTooltipEventTypes:b,tooltipPayloadSearcher:I,eventEmitter:void 0};return Me.createElement(YH,{preloadedState:{options:L},reduxStoreName:(n=M.id)!==null&&n!==void 0?n:v},Me.createElement(OH,{chartData:M.data}),Me.createElement(JH,{width:u,height:d,layout:l.layout,margin:l.margin}),Me.createElement(eV,{accessibilityLayer:l.accessibilityLayer,barCategoryGap:l.barCategoryGap,maxBarSize:l.maxBarSize,stackOffset:l.stackOffset,barGap:l.barGap,barSize:l.barSize,syncId:l.syncId,syncMethod:l.syncMethod,className:l.className}),Me.createElement(tV,m5({},a,{width:u,height:d,ref:r})))}),q_e=["axis","item"],$_e=Me.forwardRef((e,t)=>Me.createElement(W_e,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:q_e,tooltipPayloadSearcher:nH,categoricalChartProps:e,ref:t}));function X_e(e){var t=vc();return Me.useEffect(()=>{t(x_e(e))},[t,e]),null}var Z_e=["width","height","layout"];function g5(){return g5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g5.apply(null,arguments)}function Y_e(e,t){if(e==null)return{};var r,n,l=J_e(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function J_e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eve={top:5,right:5,bottom:5,left:5},tve={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:eve,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},rve=Me.forwardRef(function(t,r){var n,l=Lp(t.categoricalChartProps,tve),{width:u,height:d,layout:a}=l,v=Y_e(l,Z_e);if(!tv(u)||!tv(d))return null;var{chartName:x,defaultTooltipEventType:b,validateTooltipEventTypes:I,tooltipPayloadSearcher:M}=t,L={chartName:x,defaultTooltipEventType:b,validateTooltipEventTypes:I,tooltipPayloadSearcher:M,eventEmitter:void 0};return Me.createElement(YH,{preloadedState:{options:L},reduxStoreName:(n=l.id)!==null&&n!==void 0?n:x},Me.createElement(OH,{chartData:l.data}),Me.createElement(JH,{width:u,height:d,layout:a,margin:l.margin}),Me.createElement(eV,{accessibilityLayer:l.accessibilityLayer,barCategoryGap:l.barCategoryGap,maxBarSize:l.maxBarSize,stackOffset:l.stackOffset,barGap:l.barGap,barSize:l.barSize,syncId:l.syncId,syncMethod:l.syncMethod,className:l.className}),Me.createElement(X_e,{cx:l.cx,cy:l.cy,startAngle:l.startAngle,endAngle:l.endAngle,innerRadius:l.innerRadius,outerRadius:l.outerRadius}),Me.createElement(tV,g5({width:u,height:d},v,{ref:r})))}),nve=["item"],ive={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},ave=Me.forwardRef((e,t)=>{var r=Lp(e,ive);return Me.createElement(rve,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:nve,tooltipPayloadSearcher:nH,categoricalChartProps:r,ref:t})});function ove({setScannedPlot:e}){const t=bb(),[r,n]=Me.useState({neighborhood:"",investmentStatus:"",projectType:"",minArea:"",maxArea:""}),[l,u]=Me.useState(null),[d,a]=Me.useState([]);Me.useEffect(()=>{fetch("/data/lands.geojson").then(J=>{if(!J.ok)throw new Error(`HTTP error! status: ${J.status}`);return J.json()}).then(J=>{if(!J.features)throw new Error("Invalid GeoJSON structure");const se=J.features.map(ye=>{const Se=ye.properties||{};let Be=[];return ye.geometry&&(ye.geometry.type==="Polygon"?Be=(ye.geometry.coordinates[0]||[]).map(([De,we])=>[we,De]):ye.geometry.type==="MultiPolygon"&&(Be=(ye.geometry.coordinates[0]&&ye.geometry.coordinates[0][0]||[]).map(([De,we])=>[we,De]))),(!Be.length||Be.some(([De,we])=>isNaN(De)||isNaN(we)))&&(Be=[[30.986,41.038]]),{id:`${Se.dis_nam||""}-${Se.ACTIV||""}-${Se.parcel_no||""}`,neighborhood:Se.dis_nam||"غير محدد",number:Se.parcel_no||"غير محدد",planNumber:Se.PLAN_NUM||"غير محدد",area:Se.Shape_Area||0,invested:Se.rent==="مؤجر",status:Se.rent==="مؤجر"?"مستثمر":Se.rent==="قيد الطرح"?"قيد الطرح":"غير مستثمر",projectType:Se.main_activ||"غير محدد",facilityType:Se.ACTIV||"غير محدد",image:"/default-plot-image.jpg",coordinates:Be}});a(se)}).catch(J=>console.error("Error loading GeoJSON:",J))},[]);const v=Me.useMemo(()=>!d||!Array.isArray(d)?[]:d.filter(J=>{const se=!r.neighborhood||J.neighborhood&&J.neighborhood.includes(r.neighborhood),ye=!r.investmentStatus||J.status===r.investmentStatus,Se=!r.projectType||J.projectType===r.projectType,Be=parseFloat(J.area)||0,De=r.minArea?parseFloat(r.minArea):0,we=r.maxArea?parseFloat(r.maxArea):1/0,nt=Be>=De&&Be<=we;return se&&ye&&Se&&nt}),[r,d]),x=(J,se)=>{n(ye=>({...ye,[J]:se})),u(null)},b=()=>{n({neighborhood:"",investmentStatus:"",projectType:"",minArea:"",maxArea:""}),u(null)},I=Me.useMemo(()=>!d||!Array.isArray(d)?[]:[...new Set(d.map(J=>J.neighborhood||"غير محدد"))],[d]),M=Me.useMemo(()=>!d||!Array.isArray(d)?[]:r.neighborhood?d.filter(J=>J.neighborhood===r.neighborhood):[],[r.neighborhood,d]),L=Me.useMemo(()=>{const J={مستثمر:0,"غير مستثمر":0,"قيد الطرح":0};M.forEach(ye=>{J[ye.status]=(J[ye.status]||0)+1});const se=Object.values(J).reduce((ye,Se)=>ye+Se,0);return[{name:"مستثمر",value:J.مستثمر,percentage:se?(J.مستثمر/se*100).toFixed(1):0},{name:"غير مستثمر",value:J["غير مستثمر"],percentage:se?(J["غير مستثمر"]/se*100).toFixed(1):0},{name:"قيد الطرح",value:J["قيد الطرح"],percentage:se?(J["قيد الطرح"]/se*100).toFixed(1):0}]},[M]),U=Me.useMemo(()=>{const J={مصنع:0,مستودع:0,ورشة:0};return M.forEach(se=>{se.facilityType in J&&J[se.facilityType]++}),Object.entries(J).map(([se,ye])=>({name:se,value:ye}))},[M]),R={مستثمر:"#EF4444","غير مستثمر":"#22C55E","قيد الطرح":"#FACC15"},H={مصنع:"#22C55E",ورشة:"#FACC15",مستودع:"#3B82F6"},q=({cx:J,cy:se,midAngle:ye,innerRadius:Se,outerRadius:Be,index:De})=>{const we=Math.PI/180,nt=Se+(Be-Se)*.5,_e=J+nt*Math.cos(-ye*we),Ie=se+nt*Math.sin(-ye*we);return Nr.jsxs("text",{x:_e,y:Ie,fill:"white",textAnchor:"middle",dominantBaseline:"middle",fontSize:"13",fontWeight:"bold",children:[L[De]?.percentage||0,"%"]})},te=J=>{const se=d.find(ye=>ye.number===J);se?(e(se),t("/scanned-plot")):alert("لم يتم العثور على قطعة أرض بهذا الرقم")};return Nr.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[Nr.jsxs("div",{className:"w-full bg-green-900 h-14 flex items-center px-4 gap-4",children:[Nr.jsx("img",{src:"2.png",alt:"شعار أمانة",className:"h-10 object-contain"}),Nr.jsx(Z$,{filters:r,onFilterChange:x,onReset:b,neighborhoods:I,horizontal:!0})]}),Nr.jsx("div",{className:"fixed top-20 right-4 z-[9999]",children:Nr.jsx(rie,{onScan:te})}),Nr.jsxs("div",{className:"flex-1 relative",children:[Nr.jsx("div",{className:"h-[calc(100vh-56px)]",children:Nr.jsx(tie,{plots:v.length?v:d,onSelectPlot:u,selectedPlot:l,use3D:!0,animated:!0})}),l&&Nr.jsx("div",{className:"absolute bottom-0 left-0 w-full flex justify-center z-[1000]",children:Nr.jsx("div",{className:"w-full max-w-3xl px-4",children:Nr.jsx(eie,{selectedLand:l})})})]}),r.neighborhood&&!l&&Nr.jsx("div",{className:"w-full border-t border-gray-200 bg-gray-50 px-2 sm:px-4 py-4 flex justify-center",children:Nr.jsxs("div",{className:"flex flex-col md:flex-row gap-3 sm:gap-4 bg-white rounded-xl p-3 shadow-inner w-full max-w-5xl overflow-visible",children:[Nr.jsxs("div",{className:"w-full md:w-1/2",children:[Nr.jsx("h3",{className:"text-center font-semibold mb-2",children:"توزيع أنواع المشاريع"}),Nr.jsx(mk,{width:"100%",height:180,children:Nr.jsxs($_e,{data:U||[],children:[Nr.jsx(dF,{dataKey:"name"}),Nr.jsx(pF,{domain:[0,10],allowDecimals:!1}),Nr.jsx(uk,{}),Nr.jsx(LH,{dataKey:"value",radius:[4,4,0,0],children:(U||[]).map((J,se)=>Nr.jsx(lv,{fill:H[J.name]||"#8884d8"},`cell-bar-${se}`))})]})})]}),Nr.jsxs("div",{className:"w-full md:w-1/2 flex flex-col items-center mt-6 md:mt-0",children:[Nr.jsx("h3",{className:"text-center font-semibold mb-2",children:"حالة الاستثمار"}),Nr.jsx(mk,{width:"100%",height:180,children:Nr.jsxs(ave,{children:[Nr.jsx(BH,{data:L||[],dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:60,label:q,labelLine:!1,children:(L||[]).map((J,se)=>Nr.jsx(lv,{fill:R[J.name]||"#ccc"},`cell-${se}`))}),Nr.jsx(uk,{})]})}),Nr.jsx("div",{className:"flex justify-center mt-4 gap-4 flex-wrap",children:(L||[]).map(J=>Nr.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[Nr.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:R[J.name]||"#ccc"}}),Nr.jsxs("span",{children:[J.name," (",J.value||0,")"]})]},J.name))})]})]})})]})}const sve="modulepreload",lve=function(e){return"/InteractiveMap/"+e},lU={},PS=function(t,r,n){let l=Promise.resolve();if(r&&r.length>0){let v=function(x){return Promise.all(x.map(b=>Promise.resolve(b).then(I=>({status:"fulfilled",value:I}),I=>({status:"rejected",reason:I}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),a=d?.nonce||d?.getAttribute("nonce");l=v(r.map(x=>{if(x=lve(x),x in lU)return;lU[x]=!0;const b=x.endsWith(".css"),I=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${I}`))return;const M=document.createElement("link");if(M.rel=b?"stylesheet":sve,b||(M.as="script"),M.crossOrigin="",M.href=x,a&&M.setAttribute("nonce",a),document.head.appendChild(M),b)return new Promise((L,U)=>{M.addEventListener("load",L),M.addEventListener("error",()=>U(new Error(`Unable to preload CSS for ${x}`)))})}))}function u(d){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=d,window.dispatchEvent(a),!a.defaultPrevented)throw d}return l.then(d=>{for(const a of d||[])a.status==="rejected"&&u(a.reason);return t().catch(u)})};function ps(e){"@babel/helpers - typeof";return ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ps(e)}var Nd=Uint8Array,mA=Uint16Array,vF=Int32Array,yF=new Nd([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xF=new Nd([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cU=new Nd([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rV=function(e,t){for(var r=new mA(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var l=new vF(r[30]),n=1;n<30;++n)for(var u=r[n];u<r[n+1];++u)l[u]=u-r[n]<<5|n;return{b:r,r:l}},nV=rV(yF,2),cve=nV.b,_5=nV.r;cve[28]=258,_5[258]=28;var uve=rV(xF,0),uU=uve.r,v5=new mA(32768);for(var al=0;al<32768;++al){var cg=(al&43690)>>1|(al&21845)<<1;cg=(cg&52428)>>2|(cg&13107)<<2,cg=(cg&61680)>>4|(cg&3855)<<4,v5[al]=((cg&65280)>>8|(cg&255)<<8)>>1}var Zy=function(e,t,r){for(var n=e.length,l=0,u=new mA(t);l<n;++l)e[l]&&++u[e[l]-1];var d=new mA(t);for(l=1;l<t;++l)d[l]=d[l-1]+u[l-1]<<1;var a;if(r){a=new mA(1<<t);var v=15-t;for(l=0;l<n;++l)if(e[l])for(var x=l<<4|e[l],b=t-e[l],I=d[e[l]-1]++<<b,M=I|(1<<b)-1;I<=M;++I)a[v5[I]>>v]=x}else for(a=new mA(n),l=0;l<n;++l)e[l]&&(a[l]=v5[d[e[l]-1]++]>>15-e[l]);return a},L0=new Nd(288);for(var al=0;al<144;++al)L0[al]=8;for(var al=144;al<256;++al)L0[al]=9;for(var al=256;al<280;++al)L0[al]=7;for(var al=280;al<288;++al)L0[al]=8;var lb=new Nd(32);for(var al=0;al<32;++al)lb[al]=5;var hve=Zy(L0,9,0),fve=Zy(lb,5,0),iV=function(e){return(e+7)/8|0},Ave=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Nd(e.subarray(t,r))},$p=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Sy=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},LS=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var l=r.length,u=r.slice();if(!l)return{t:oV,l:0};if(l==1){var d=new Nd(r[0].s+1);return d[r[0].s]=1,{t:d,l:1}}r.sort(function(ye,Se){return ye.f-Se.f}),r.push({s:-1,f:25001});var a=r[0],v=r[1],x=0,b=1,I=2;for(r[0]={s:-1,f:a.f+v.f,l:a,r:v};b!=l-1;)a=r[r[x].f<r[I].f?x++:I++],v=r[x!=b&&r[x].f<r[I].f?x++:I++],r[b++]={s:-1,f:a.f+v.f,l:a,r:v};for(var M=u[0].s,n=1;n<l;++n)u[n].s>M&&(M=u[n].s);var L=new mA(M+1),U=y5(r[b-1],L,0);if(U>t){var n=0,R=0,H=U-t,q=1<<H;for(u.sort(function(Se,Be){return L[Be.s]-L[Se.s]||Se.f-Be.f});n<l;++n){var te=u[n].s;if(L[te]>t)R+=q-(1<<U-L[te]),L[te]=t;else break}for(R>>=H;R>0;){var J=u[n].s;L[J]<t?R-=1<<t-L[J]++-1:++n}for(;n>=0&&R;--n){var se=u[n].s;L[se]==t&&(--L[se],++R)}U=t}return{t:new Nd(L),l:U}},y5=function(e,t,r){return e.s==-1?Math.max(y5(e.l,t,r+1),y5(e.r,t,r+1)):t[e.s]=r},hU=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new mA(++t),n=0,l=e[0],u=1,d=function(v){r[n++]=v},a=1;a<=t;++a)if(e[a]==l&&a!=t)++u;else{if(!l&&u>2){for(;u>138;u-=138)d(32754);u>2&&(d(u>10?u-11<<5|28690:u-3<<5|12305),u=0)}else if(u>3){for(d(l),--u;u>6;u-=6)d(8304);u>2&&(d(u-3<<5|8208),u=0)}for(;u--;)d(l);u=1,l=e[a]}return{c:r.subarray(0,n),n:t}},Ty=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},aV=function(e,t,r){var n=r.length,l=iV(t+2);e[l]=n&255,e[l+1]=n>>8,e[l+2]=e[l]^255,e[l+3]=e[l+1]^255;for(var u=0;u<n;++u)e[l+u+4]=r[u];return(l+4+n)*8},fU=function(e,t,r,n,l,u,d,a,v,x,b){$p(t,b++,r),++l[256];for(var I=LS(l,15),M=I.t,L=I.l,U=LS(u,15),R=U.t,H=U.l,q=hU(M),te=q.c,J=q.n,se=hU(R),ye=se.c,Se=se.n,Be=new mA(19),De=0;De<te.length;++De)++Be[te[De]&31];for(var De=0;De<ye.length;++De)++Be[ye[De]&31];for(var we=LS(Be,7),nt=we.t,_e=we.l,Ie=19;Ie>4&&!nt[cU[Ie-1]];--Ie);var Ze=x+5<<3,st=Ty(l,L0)+Ty(u,lb)+d,Et=Ty(l,M)+Ty(u,R)+d+14+3*Ie+Ty(Be,nt)+2*Be[16]+3*Be[17]+7*Be[18];if(v>=0&&Ze<=st&&Ze<=Et)return aV(t,b,e.subarray(v,v+x));var Ut,jt,bt,Nt;if($p(t,b,1+(Et<st)),b+=2,Et<st){Ut=Zy(M,L,0),jt=M,bt=Zy(R,H,0),Nt=R;var ar=Zy(nt,_e,0);$p(t,b,J-257),$p(t,b+5,Se-1),$p(t,b+10,Ie-4),b+=14;for(var De=0;De<Ie;++De)$p(t,b+3*De,nt[cU[De]]);b+=3*Ie;for(var lt=[te,ye],ie=0;ie<2;++ie)for(var Le=lt[ie],De=0;De<Le.length;++De){var Fe=Le[De]&31;$p(t,b,ar[Fe]),b+=nt[Fe],Fe>15&&($p(t,b,Le[De]>>5&127),b+=Le[De]>>12)}}else Ut=hve,jt=L0,bt=fve,Nt=lb;for(var De=0;De<a;++De){var Re=n[De];if(Re>255){var Fe=Re>>18&31;Sy(t,b,Ut[Fe+257]),b+=jt[Fe+257],Fe>7&&($p(t,b,Re>>23&31),b+=yF[Fe]);var et=Re&31;Sy(t,b,bt[et]),b+=Nt[et],et>3&&(Sy(t,b,Re>>5&8191),b+=xF[et])}else Sy(t,b,Ut[Re]),b+=jt[Re]}return Sy(t,b,Ut[256]),b+jt[256]},dve=new vF([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),oV=new Nd(0),pve=function(e,t,r,n,l,u){var d=u.z||e.length,a=new Nd(n+d+5*(1+Math.ceil(d/7e3))+l),v=a.subarray(n,a.length-l),x=u.l,b=(u.r||0)&7;if(t){b&&(v[0]=u.r>>3);for(var I=dve[t-1],M=I>>13,L=I&8191,U=(1<<r)-1,R=u.p||new mA(32768),H=u.h||new mA(U+1),q=Math.ceil(r/3),te=2*q,J=function(er){return(e[er]^e[er+1]<<q^e[er+2]<<te)&U},se=new vF(25e3),ye=new mA(288),Se=new mA(32),Be=0,De=0,we=u.i||0,nt=0,_e=u.w||0,Ie=0;we+2<d;++we){var Ze=J(we),st=we&32767,Et=H[Ze];if(R[st]=Et,H[Ze]=st,_e<=we){var Ut=d-we;if((Be>7e3||nt>24576)&&(Ut>423||!x)){b=fU(e,v,0,se,ye,Se,De,nt,Ie,we-Ie,b),nt=Be=De=0,Ie=we;for(var jt=0;jt<286;++jt)ye[jt]=0;for(var jt=0;jt<30;++jt)Se[jt]=0}var bt=2,Nt=0,ar=L,lt=st-Et&32767;if(Ut>2&&Ze==J(we-lt))for(var ie=Math.min(M,Ut)-1,Le=Math.min(32767,we),Fe=Math.min(258,Ut);lt<=Le&&--ar&&st!=Et;){if(e[we+bt]==e[we+bt-lt]){for(var Re=0;Re<Fe&&e[we+Re]==e[we+Re-lt];++Re);if(Re>bt){if(bt=Re,Nt=lt,Re>ie)break;for(var et=Math.min(lt,Re-2),xt=0,jt=0;jt<et;++jt){var Dt=we-lt+jt&32767,pt=R[Dt],Ct=Dt-pt&32767;Ct>xt&&(xt=Ct,Et=Dt)}}}st=Et,Et=R[st],lt+=st-Et&32767}if(Nt){se[nt++]=268435456|_5[bt]<<18|uU[Nt];var mr=_5[bt]&31,Zt=uU[Nt]&31;De+=yF[mr]+xF[Zt],++ye[257+mr],++Se[Zt],_e=we+bt,++Be}else se[nt++]=e[we],++ye[e[we]]}}for(we=Math.max(we,_e);we<d;++we)se[nt++]=e[we],++ye[e[we]];b=fU(e,v,x,se,ye,Se,De,nt,Ie,we-Ie,b),x||(u.r=b&7|v[b/8|0]<<3,b-=7,u.h=H,u.p=R,u.i=we,u.w=_e)}else{for(var we=u.w||0;we<d+x;we+=65535){var sn=we+65535;sn>=d&&(v[b/8|0]=x,sn=d),b=aV(v,b+1,e.subarray(we,sn))}u.i=d}return Ave(a,0,n+iV(b)+l)},sV=function(){var e=1,t=0;return{p:function(r){for(var n=e,l=t,u=r.length|0,d=0;d!=u;){for(var a=Math.min(d+2655,u);d<a;++d)l+=n+=r[d];n=(n&65535)+15*(n>>16),l=(l&65535)+15*(l>>16)}e=n,t=l},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},mve=function(e,t,r,n,l){if(!l&&(l={l:1},t.dictionary)){var u=t.dictionary.subarray(-32768),d=new Nd(u.length+e.length);d.set(u),d.set(e,u.length),e=d,l.w=u.length}return pve(e,t.level==null?6:t.level,t.mem==null?l.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,l)},lV=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},gve=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var l=sV();l.p(t.dictionary),lV(e,2,l.d())}};function x5(e,t){t||(t={});var r=sV();r.p(e);var n=mve(e,t,t.dictionary?6:2,4);return gve(n,t),lV(n,n.length-4,r.d()),n}var _ve=typeof TextDecoder<"u"&&new TextDecoder,vve=0;try{_ve.decode(oV,{stream:!0}),vve=1}catch{}function yve(e){if(Array.isArray(e))return e}function xve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,l,u,d,a=[],v=!0,x=!1;try{if(u=(r=r.call(e)).next,t!==0)for(;!(v=(n=u.call(r)).done)&&(a.push(n.value),a.length!==t);v=!0);}catch(b){x=!0,l=b}finally{try{if(!v&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw l}}return a}}function AU(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function wve(e,t){if(e){if(typeof e=="string")return AU(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?AU(e,t):void 0}}function bve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dU(e,t){return yve(e)||xve(e,t)||wve(e,t)||bve()}function pU(e,t="utf8"){return new TextDecoder(t).decode(e)}const Eve=new TextEncoder;function Bve(e){return Eve.encode(e)}const Cve=1024*8,Sve=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),MS={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class wF{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(t=Cve,r={}){let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const l=r.offset?r.offset>>>0:0,u=t.byteLength-l;let d=l;(ArrayBuffer.isView(t)||t instanceof wF)&&(t.byteLength!==t.buffer.byteLength&&(d=t.byteOffset+l),t=t.buffer),n?this.lastWrittenByte=u:this.lastWrittenByte=0,this.buffer=t,this.length=u,this.byteLength=u,this.byteOffset=d,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,d,u),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,l=new Uint8Array(n);l.set(new Uint8Array(this.buffer)),this.buffer=l.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=MS[r].BYTES_PER_ELEMENT*t,l=this.byteOffset+this.offset,u=this.buffer.slice(l,l+n);if(this.littleEndian===Sve&&r!=="uint8"&&r!=="int8"){const a=new Uint8Array(this.buffer.slice(l,l+n));a.reverse();const v=new MS[r](a.buffer);return this.offset+=n,v.reverse(),v}const d=new MS[r](u);return this.offset+=n,d}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return pU(this.readBytes(t))}decodeText(t=1,r="utf8"){return pU(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(Bve(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Pv(e){let t=e.length;for(;--t>=0;)e[t]=0}const Tve=3,Ive=258,cV=29,Fve=256,Pve=Fve+1+cV,uV=30,Lve=512,Mve=new Array((Pve+2)*2);Pv(Mve);const Ove=new Array(uV*2);Pv(Ove);const Dve=new Array(Lve);Pv(Dve);const Rve=new Array(Ive-Tve+1);Pv(Rve);const kve=new Array(cV);Pv(kve);const Uve=new Array(uV);Pv(Uve);const Nve=(e,t,r,n)=>{let l=e&65535|0,u=e>>>16&65535|0,d=0;for(;r!==0;){d=r>2e3?2e3:r,r-=d;do l=l+t[n++]|0,u=u+l|0;while(--d);l%=65521,u%=65521}return l|u<<16|0};var w5=Nve;const zve=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},Qve=new Uint32Array(zve()),jve=(e,t,r,n)=>{const l=Qve,u=n+r;e^=-1;for(let d=n;d<u;d++)e=e>>>8^l[(e^t[d])&255];return e^-1};var yp=jve,b5={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},hV={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Hve=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Vve=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)Hve(r,n)&&(e[n]=r[n])}}return e},Gve=e=>{let t=0;for(let n=0,l=e.length;n<l;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,l=0,u=e.length;n<u;n++){let d=e[n];r.set(d,l),l+=d.length}return r},fV={assign:Vve,flattenChunks:Gve};let AV=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{AV=!1}const w1=new Uint8Array(256);for(let e=0;e<256;e++)w1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;w1[254]=w1[254]=1;var Kve=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,l,u,d=e.length,a=0;for(l=0;l<d;l++)r=e.charCodeAt(l),(r&64512)===55296&&l+1<d&&(n=e.charCodeAt(l+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),l++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(a),u=0,l=0;u<a;l++)r=e.charCodeAt(l),(r&64512)===55296&&l+1<d&&(n=e.charCodeAt(l+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),l++)),r<128?t[u++]=r:r<2048?(t[u++]=192|r>>>6,t[u++]=128|r&63):r<65536?(t[u++]=224|r>>>12,t[u++]=128|r>>>6&63,t[u++]=128|r&63):(t[u++]=240|r>>>18,t[u++]=128|r>>>12&63,t[u++]=128|r>>>6&63,t[u++]=128|r&63);return t};const Wve=(e,t)=>{if(t<65534&&e.subarray&&AV)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var qve=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,l;const u=new Array(r*2);for(l=0,n=0;n<r;){let d=e[n++];if(d<128){u[l++]=d;continue}let a=w1[d];if(a>4){u[l++]=65533,n+=a-1;continue}for(d&=a===2?31:a===3?15:7;a>1&&n<r;)d=d<<6|e[n++]&63,a--;if(a>1){u[l++]=65533;continue}d<65536?u[l++]=d:(d-=65536,u[l++]=55296|d>>10&1023,u[l++]=56320|d&1023)}return Wve(u,l)},$ve=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+w1[e[r]]>t?r:t},E5={string2buf:Kve,buf2string:qve,utf8border:$ve};function Xve(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Zve=Xve;const mw=16209,Yve=16191;var Jve=function(t,r){let n,l,u,d,a,v,x,b,I,M,L,U,R,H,q,te,J,se,ye,Se,Be,De,we,nt;const _e=t.state;n=t.next_in,we=t.input,l=n+(t.avail_in-5),u=t.next_out,nt=t.output,d=u-(r-t.avail_out),a=u+(t.avail_out-257),v=_e.dmax,x=_e.wsize,b=_e.whave,I=_e.wnext,M=_e.window,L=_e.hold,U=_e.bits,R=_e.lencode,H=_e.distcode,q=(1<<_e.lenbits)-1,te=(1<<_e.distbits)-1;e:do{U<15&&(L+=we[n++]<<U,U+=8,L+=we[n++]<<U,U+=8),J=R[L&q];t:for(;;){if(se=J>>>24,L>>>=se,U-=se,se=J>>>16&255,se===0)nt[u++]=J&65535;else if(se&16){ye=J&65535,se&=15,se&&(U<se&&(L+=we[n++]<<U,U+=8),ye+=L&(1<<se)-1,L>>>=se,U-=se),U<15&&(L+=we[n++]<<U,U+=8,L+=we[n++]<<U,U+=8),J=H[L&te];r:for(;;){if(se=J>>>24,L>>>=se,U-=se,se=J>>>16&255,se&16){if(Se=J&65535,se&=15,U<se&&(L+=we[n++]<<U,U+=8,U<se&&(L+=we[n++]<<U,U+=8)),Se+=L&(1<<se)-1,Se>v){t.msg="invalid distance too far back",_e.mode=mw;break e}if(L>>>=se,U-=se,se=u-d,Se>se){if(se=Se-se,se>b&&_e.sane){t.msg="invalid distance too far back",_e.mode=mw;break e}if(Be=0,De=M,I===0){if(Be+=x-se,se<ye){ye-=se;do nt[u++]=M[Be++];while(--se);Be=u-Se,De=nt}}else if(I<se){if(Be+=x+I-se,se-=I,se<ye){ye-=se;do nt[u++]=M[Be++];while(--se);if(Be=0,I<ye){se=I,ye-=se;do nt[u++]=M[Be++];while(--se);Be=u-Se,De=nt}}}else if(Be+=I-se,se<ye){ye-=se;do nt[u++]=M[Be++];while(--se);Be=u-Se,De=nt}for(;ye>2;)nt[u++]=De[Be++],nt[u++]=De[Be++],nt[u++]=De[Be++],ye-=3;ye&&(nt[u++]=De[Be++],ye>1&&(nt[u++]=De[Be++]))}else{Be=u-Se;do nt[u++]=nt[Be++],nt[u++]=nt[Be++],nt[u++]=nt[Be++],ye-=3;while(ye>2);ye&&(nt[u++]=nt[Be++],ye>1&&(nt[u++]=nt[Be++]))}}else if((se&64)===0){J=H[(J&65535)+(L&(1<<se)-1)];continue r}else{t.msg="invalid distance code",_e.mode=mw;break e}break}}else if((se&64)===0){J=R[(J&65535)+(L&(1<<se)-1)];continue t}else if(se&32){_e.mode=Yve;break e}else{t.msg="invalid literal/length code",_e.mode=mw;break e}break}}while(n<l&&u<a);ye=U>>3,n-=ye,U-=ye<<3,L&=(1<<U)-1,t.next_in=n,t.next_out=u,t.avail_in=n<l?5+(l-n):5-(n-l),t.avail_out=u<a?257+(a-u):257-(u-a),_e.hold=L,_e.bits=U};const x_=15,mU=852,gU=592,_U=0,OS=1,vU=2,eye=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),tye=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),rye=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),nye=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),iye=(e,t,r,n,l,u,d,a)=>{const v=a.bits;let x=0,b=0,I=0,M=0,L=0,U=0,R=0,H=0,q=0,te=0,J,se,ye,Se,Be,De=null,we;const nt=new Uint16Array(x_+1),_e=new Uint16Array(x_+1);let Ie=null,Ze,st,Et;for(x=0;x<=x_;x++)nt[x]=0;for(b=0;b<n;b++)nt[t[r+b]]++;for(L=v,M=x_;M>=1&&nt[M]===0;M--);if(L>M&&(L=M),M===0)return l[u++]=1<<24|64<<16|0,l[u++]=1<<24|64<<16|0,a.bits=1,0;for(I=1;I<M&&nt[I]===0;I++);for(L<I&&(L=I),H=1,x=1;x<=x_;x++)if(H<<=1,H-=nt[x],H<0)return-1;if(H>0&&(e===_U||M!==1))return-1;for(_e[1]=0,x=1;x<x_;x++)_e[x+1]=_e[x]+nt[x];for(b=0;b<n;b++)t[r+b]!==0&&(d[_e[t[r+b]]++]=b);if(e===_U?(De=Ie=d,we=20):e===OS?(De=eye,Ie=tye,we=257):(De=rye,Ie=nye,we=0),te=0,b=0,x=I,Be=u,U=L,R=0,ye=-1,q=1<<L,Se=q-1,e===OS&&q>mU||e===vU&&q>gU)return 1;for(;;){Ze=x-R,d[b]+1<we?(st=0,Et=d[b]):d[b]>=we?(st=Ie[d[b]-we],Et=De[d[b]-we]):(st=96,Et=0),J=1<<x-R,se=1<<U,I=se;do se-=J,l[Be+(te>>R)+se]=Ze<<24|st<<16|Et|0;while(se!==0);for(J=1<<x-1;te&J;)J>>=1;if(J!==0?(te&=J-1,te+=J):te=0,b++,--nt[x]===0){if(x===M)break;x=t[r+d[b]]}if(x>L&&(te&Se)!==ye){for(R===0&&(R=L),Be+=I,U=x-R,H=1<<U;U+R<M&&(H-=nt[U+R],!(H<=0));)U++,H<<=1;if(q+=1<<U,e===OS&&q>mU||e===vU&&q>gU)return 1;ye=te&Se,l[ye]=L<<24|U<<16|Be-u|0}}return te!==0&&(l[Be+te]=x-R<<24|64<<16|0),a.bits=L,0};var Yy=iye;const aye=0,dV=1,pV=2,{Z_FINISH:yU,Z_BLOCK:oye,Z_TREES:gw,Z_OK:M0,Z_STREAM_END:sye,Z_NEED_DICT:lye,Z_STREAM_ERROR:ad,Z_DATA_ERROR:mV,Z_MEM_ERROR:gV,Z_BUF_ERROR:cye,Z_DEFLATED:xU}=hV,uE=16180,wU=16181,bU=16182,EU=16183,BU=16184,CU=16185,SU=16186,TU=16187,IU=16188,FU=16189,cb=16190,Xp=16191,DS=16192,PU=16193,RS=16194,LU=16195,MU=16196,OU=16197,DU=16198,_w=16199,vw=16200,RU=16201,kU=16202,UU=16203,NU=16204,zU=16205,kS=16206,QU=16207,jU=16208,yl=16209,_V=16210,vV=16211,uye=852,hye=592,fye=15,Aye=fye,HU=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function dye(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const H0=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<uE||t.mode>vV?1:0},yV=e=>{if(H0(e))return ad;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=uE,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(uye),t.distcode=t.distdyn=new Int32Array(hye),t.sane=1,t.back=-1,M0},xV=e=>{if(H0(e))return ad;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,yV(e)},wV=(e,t)=>{let r;if(H0(e))return ad;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?ad:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,xV(e))},bV=(e,t)=>{if(!e)return ad;const r=new dye;e.state=r,r.strm=e,r.window=null,r.mode=uE;const n=wV(e,t);return n!==M0&&(e.state=null),n},pye=e=>bV(e,Aye);let VU=!0,US,NS;const mye=e=>{if(VU){US=new Int32Array(512),NS=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Yy(dV,e.lens,0,288,US,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Yy(pV,e.lens,0,32,NS,0,e.work,{bits:5}),VU=!1}e.lencode=US,e.lenbits=9,e.distcode=NS,e.distbits=5},EV=(e,t,r,n)=>{let l;const u=e.state;return u.window===null&&(u.wsize=1<<u.wbits,u.wnext=0,u.whave=0,u.window=new Uint8Array(u.wsize)),n>=u.wsize?(u.window.set(t.subarray(r-u.wsize,r),0),u.wnext=0,u.whave=u.wsize):(l=u.wsize-u.wnext,l>n&&(l=n),u.window.set(t.subarray(r-n,r-n+l),u.wnext),n-=l,n?(u.window.set(t.subarray(r-n,r),0),u.wnext=n,u.whave=u.wsize):(u.wnext+=l,u.wnext===u.wsize&&(u.wnext=0),u.whave<u.wsize&&(u.whave+=l))),0},gye=(e,t)=>{let r,n,l,u,d,a,v,x,b,I,M,L,U,R,H=0,q,te,J,se,ye,Se,Be,De;const we=new Uint8Array(4);let nt,_e;const Ie=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(H0(e)||!e.output||!e.input&&e.avail_in!==0)return ad;r=e.state,r.mode===Xp&&(r.mode=DS),d=e.next_out,l=e.output,v=e.avail_out,u=e.next_in,n=e.input,a=e.avail_in,x=r.hold,b=r.bits,I=a,M=v,De=M0;e:for(;;)switch(r.mode){case uE:if(r.wrap===0){r.mode=DS;break}for(;b<16;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if(r.wrap&2&&x===35615){r.wbits===0&&(r.wbits=15),r.check=0,we[0]=x&255,we[1]=x>>>8&255,r.check=yp(r.check,we,2,0),x=0,b=0,r.mode=wU;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((x&255)<<8)+(x>>8))%31){e.msg="incorrect header check",r.mode=yl;break}if((x&15)!==xU){e.msg="unknown compression method",r.mode=yl;break}if(x>>>=4,b-=4,Be=(x&15)+8,r.wbits===0&&(r.wbits=Be),Be>15||Be>r.wbits){e.msg="invalid window size",r.mode=yl;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=x&512?FU:Xp,x=0,b=0;break;case wU:for(;b<16;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if(r.flags=x,(r.flags&255)!==xU){e.msg="unknown compression method",r.mode=yl;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=yl;break}r.head&&(r.head.text=x>>8&1),r.flags&512&&r.wrap&4&&(we[0]=x&255,we[1]=x>>>8&255,r.check=yp(r.check,we,2,0)),x=0,b=0,r.mode=bU;case bU:for(;b<32;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}r.head&&(r.head.time=x),r.flags&512&&r.wrap&4&&(we[0]=x&255,we[1]=x>>>8&255,we[2]=x>>>16&255,we[3]=x>>>24&255,r.check=yp(r.check,we,4,0)),x=0,b=0,r.mode=EU;case EU:for(;b<16;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}r.head&&(r.head.xflags=x&255,r.head.os=x>>8),r.flags&512&&r.wrap&4&&(we[0]=x&255,we[1]=x>>>8&255,r.check=yp(r.check,we,2,0)),x=0,b=0,r.mode=BU;case BU:if(r.flags&1024){for(;b<16;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}r.length=x,r.head&&(r.head.extra_len=x),r.flags&512&&r.wrap&4&&(we[0]=x&255,we[1]=x>>>8&255,r.check=yp(r.check,we,2,0)),x=0,b=0}else r.head&&(r.head.extra=null);r.mode=CU;case CU:if(r.flags&1024&&(L=r.length,L>a&&(L=a),L&&(r.head&&(Be=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(u,u+L),Be)),r.flags&512&&r.wrap&4&&(r.check=yp(r.check,n,L,u)),a-=L,u+=L,r.length-=L),r.length))break e;r.length=0,r.mode=SU;case SU:if(r.flags&2048){if(a===0)break e;L=0;do Be=n[u+L++],r.head&&Be&&r.length<65536&&(r.head.name+=String.fromCharCode(Be));while(Be&&L<a);if(r.flags&512&&r.wrap&4&&(r.check=yp(r.check,n,L,u)),a-=L,u+=L,Be)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=TU;case TU:if(r.flags&4096){if(a===0)break e;L=0;do Be=n[u+L++],r.head&&Be&&r.length<65536&&(r.head.comment+=String.fromCharCode(Be));while(Be&&L<a);if(r.flags&512&&r.wrap&4&&(r.check=yp(r.check,n,L,u)),a-=L,u+=L,Be)break e}else r.head&&(r.head.comment=null);r.mode=IU;case IU:if(r.flags&512){for(;b<16;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if(r.wrap&4&&x!==(r.check&65535)){e.msg="header crc mismatch",r.mode=yl;break}x=0,b=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Xp;break;case FU:for(;b<32;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}e.adler=r.check=HU(x),x=0,b=0,r.mode=cb;case cb:if(r.havedict===0)return e.next_out=d,e.avail_out=v,e.next_in=u,e.avail_in=a,r.hold=x,r.bits=b,lye;e.adler=r.check=1,r.mode=Xp;case Xp:if(t===oye||t===gw)break e;case DS:if(r.last){x>>>=b&7,b-=b&7,r.mode=kS;break}for(;b<3;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}switch(r.last=x&1,x>>>=1,b-=1,x&3){case 0:r.mode=PU;break;case 1:if(mye(r),r.mode=_w,t===gw){x>>>=2,b-=2;break e}break;case 2:r.mode=MU;break;case 3:e.msg="invalid block type",r.mode=yl}x>>>=2,b-=2;break;case PU:for(x>>>=b&7,b-=b&7;b<32;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if((x&65535)!==(x>>>16^65535)){e.msg="invalid stored block lengths",r.mode=yl;break}if(r.length=x&65535,x=0,b=0,r.mode=RS,t===gw)break e;case RS:r.mode=LU;case LU:if(L=r.length,L){if(L>a&&(L=a),L>v&&(L=v),L===0)break e;l.set(n.subarray(u,u+L),d),a-=L,u+=L,v-=L,d+=L,r.length-=L;break}r.mode=Xp;break;case MU:for(;b<14;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if(r.nlen=(x&31)+257,x>>>=5,b-=5,r.ndist=(x&31)+1,x>>>=5,b-=5,r.ncode=(x&15)+4,x>>>=4,b-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=yl;break}r.have=0,r.mode=OU;case OU:for(;r.have<r.ncode;){for(;b<3;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}r.lens[Ie[r.have++]]=x&7,x>>>=3,b-=3}for(;r.have<19;)r.lens[Ie[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,nt={bits:r.lenbits},De=Yy(aye,r.lens,0,19,r.lencode,0,r.work,nt),r.lenbits=nt.bits,De){e.msg="invalid code lengths set",r.mode=yl;break}r.have=0,r.mode=DU;case DU:for(;r.have<r.nlen+r.ndist;){for(;H=r.lencode[x&(1<<r.lenbits)-1],q=H>>>24,te=H>>>16&255,J=H&65535,!(q<=b);){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if(J<16)x>>>=q,b-=q,r.lens[r.have++]=J;else{if(J===16){for(_e=q+2;b<_e;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if(x>>>=q,b-=q,r.have===0){e.msg="invalid bit length repeat",r.mode=yl;break}Be=r.lens[r.have-1],L=3+(x&3),x>>>=2,b-=2}else if(J===17){for(_e=q+3;b<_e;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}x>>>=q,b-=q,Be=0,L=3+(x&7),x>>>=3,b-=3}else{for(_e=q+7;b<_e;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}x>>>=q,b-=q,Be=0,L=11+(x&127),x>>>=7,b-=7}if(r.have+L>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=yl;break}for(;L--;)r.lens[r.have++]=Be}}if(r.mode===yl)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=yl;break}if(r.lenbits=9,nt={bits:r.lenbits},De=Yy(dV,r.lens,0,r.nlen,r.lencode,0,r.work,nt),r.lenbits=nt.bits,De){e.msg="invalid literal/lengths set",r.mode=yl;break}if(r.distbits=6,r.distcode=r.distdyn,nt={bits:r.distbits},De=Yy(pV,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,nt),r.distbits=nt.bits,De){e.msg="invalid distances set",r.mode=yl;break}if(r.mode=_w,t===gw)break e;case _w:r.mode=vw;case vw:if(a>=6&&v>=258){e.next_out=d,e.avail_out=v,e.next_in=u,e.avail_in=a,r.hold=x,r.bits=b,Jve(e,M),d=e.next_out,l=e.output,v=e.avail_out,u=e.next_in,n=e.input,a=e.avail_in,x=r.hold,b=r.bits,r.mode===Xp&&(r.back=-1);break}for(r.back=0;H=r.lencode[x&(1<<r.lenbits)-1],q=H>>>24,te=H>>>16&255,J=H&65535,!(q<=b);){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if(te&&(te&240)===0){for(se=q,ye=te,Se=J;H=r.lencode[Se+((x&(1<<se+ye)-1)>>se)],q=H>>>24,te=H>>>16&255,J=H&65535,!(se+q<=b);){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}x>>>=se,b-=se,r.back+=se}if(x>>>=q,b-=q,r.back+=q,r.length=J,te===0){r.mode=zU;break}if(te&32){r.back=-1,r.mode=Xp;break}if(te&64){e.msg="invalid literal/length code",r.mode=yl;break}r.extra=te&15,r.mode=RU;case RU:if(r.extra){for(_e=r.extra;b<_e;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}r.length+=x&(1<<r.extra)-1,x>>>=r.extra,b-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=kU;case kU:for(;H=r.distcode[x&(1<<r.distbits)-1],q=H>>>24,te=H>>>16&255,J=H&65535,!(q<=b);){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if((te&240)===0){for(se=q,ye=te,Se=J;H=r.distcode[Se+((x&(1<<se+ye)-1)>>se)],q=H>>>24,te=H>>>16&255,J=H&65535,!(se+q<=b);){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}x>>>=se,b-=se,r.back+=se}if(x>>>=q,b-=q,r.back+=q,te&64){e.msg="invalid distance code",r.mode=yl;break}r.offset=J,r.extra=te&15,r.mode=UU;case UU:if(r.extra){for(_e=r.extra;b<_e;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}r.offset+=x&(1<<r.extra)-1,x>>>=r.extra,b-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=yl;break}r.mode=NU;case NU:if(v===0)break e;if(L=M-v,r.offset>L){if(L=r.offset-L,L>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=yl;break}L>r.wnext?(L-=r.wnext,U=r.wsize-L):U=r.wnext-L,L>r.length&&(L=r.length),R=r.window}else R=l,U=d-r.offset,L=r.length;L>v&&(L=v),v-=L,r.length-=L;do l[d++]=R[U++];while(--L);r.length===0&&(r.mode=vw);break;case zU:if(v===0)break e;l[d++]=r.length,v--,r.mode=vw;break;case kS:if(r.wrap){for(;b<32;){if(a===0)break e;a--,x|=n[u++]<<b,b+=8}if(M-=v,e.total_out+=M,r.total+=M,r.wrap&4&&M&&(e.adler=r.check=r.flags?yp(r.check,l,M,d-M):w5(r.check,l,M,d-M)),M=v,r.wrap&4&&(r.flags?x:HU(x))!==r.check){e.msg="incorrect data check",r.mode=yl;break}x=0,b=0}r.mode=QU;case QU:if(r.wrap&&r.flags){for(;b<32;){if(a===0)break e;a--,x+=n[u++]<<b,b+=8}if(r.wrap&4&&x!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=yl;break}x=0,b=0}r.mode=jU;case jU:De=sye;break e;case yl:De=mV;break e;case _V:return gV;case vV:default:return ad}return e.next_out=d,e.avail_out=v,e.next_in=u,e.avail_in=a,r.hold=x,r.bits=b,(r.wsize||M!==e.avail_out&&r.mode<yl&&(r.mode<kS||t!==yU))&&EV(e,e.output,e.next_out,M-e.avail_out),I-=e.avail_in,M-=e.avail_out,e.total_in+=I,e.total_out+=M,r.total+=M,r.wrap&4&&M&&(e.adler=r.check=r.flags?yp(r.check,l,M,e.next_out-M):w5(r.check,l,M,e.next_out-M)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Xp?128:0)+(r.mode===_w||r.mode===RS?256:0),(I===0&&M===0||t===yU)&&De===M0&&(De=cye),De},_ye=e=>{if(H0(e))return ad;let t=e.state;return t.window&&(t.window=null),e.state=null,M0},vye=(e,t)=>{if(H0(e))return ad;const r=e.state;return(r.wrap&2)===0?ad:(r.head=t,t.done=!1,M0)},yye=(e,t)=>{const r=t.length;let n,l,u;return H0(e)||(n=e.state,n.wrap!==0&&n.mode!==cb)?ad:n.mode===cb&&(l=1,l=w5(l,t,r,0),l!==n.check)?mV:(u=EV(e,t,r,r),u?(n.mode=_V,gV):(n.havedict=1,M0))};var xye=xV,wye=wV,bye=yV,Eye=pye,Bye=bV,Cye=gye,Sye=_ye,Tye=vye,Iye=yye,Fye="pako inflate (from Nodeca project)",em={inflateReset:xye,inflateReset2:wye,inflateResetKeep:bye,inflateInit:Eye,inflateInit2:Bye,inflate:Cye,inflateEnd:Sye,inflateGetHeader:Tye,inflateSetDictionary:Iye,inflateInfo:Fye};function Pye(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Lye=Pye;const BV=Object.prototype.toString,{Z_NO_FLUSH:Mye,Z_FINISH:Oye,Z_OK:b1,Z_STREAM_END:zS,Z_NEED_DICT:QS,Z_STREAM_ERROR:Dye,Z_DATA_ERROR:GU,Z_MEM_ERROR:Rye}=hV;function X1(e){this.options=fV.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zve,this.strm.avail_out=0;let r=em.inflateInit2(this.strm,t.windowBits);if(r!==b1)throw new Error(b5[r]);if(this.header=new Lye,em.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=E5.string2buf(t.dictionary):BV.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=em.inflateSetDictionary(this.strm,t.dictionary),r!==b1)))throw new Error(b5[r])}X1.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,l=this.options.dictionary;let u,d,a;if(this.ended)return!1;for(t===~~t?d=t:d=t===!0?Oye:Mye,BV.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),u=em.inflate(r,d),u===QS&&l&&(u=em.inflateSetDictionary(r,l),u===b1?u=em.inflate(r,d):u===GU&&(u=QS));r.avail_in>0&&u===zS&&r.state.wrap>0&&e[r.next_in]!==0;)em.inflateReset(r),u=em.inflate(r,d);switch(u){case Dye:case GU:case QS:case Rye:return this.onEnd(u),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(r.avail_out===0||u===zS))if(this.options.to==="string"){let v=E5.utf8border(r.output,r.next_out),x=r.next_out-v,b=E5.buf2string(r.output,v);r.next_out=x,r.avail_out=n-x,x&&r.output.set(r.output.subarray(v,v+x),0),this.onData(b)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(u===b1&&a===0)){if(u===zS)return u=em.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};X1.prototype.onData=function(e){this.chunks.push(e)};X1.prototype.onEnd=function(e){e===b1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fV.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function kye(e,t){const r=new X1(t);if(r.push(e),r.err)throw r.msg||b5[r.err];return r.result}var Uye=X1,Nye=kye,zye={Inflate:Uye,inflate:Nye};const{Inflate:Qye,inflate:jye}=zye;var KU=Qye,Hye=jye;const CV=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;CV[e]=t}const WU=4294967295;function Vye(e,t,r){let n=e;for(let l=0;l<r;l++)n=CV[(n^t[l])&255]^n>>>8;return n}function Gye(e,t){return(Vye(WU,e,t)^WU)>>>0}function qU(e,t,r){const n=e.readUint32(),l=Gye(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(l!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${l}`)}function SV(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function TV(e,t,r,n){let l=0;for(;l<n;l++)t[l]=e[l];for(;l<r;l++)t[l]=e[l]+t[l-n]&255}function IV(e,t,r,n){let l=0;if(r.length===0)for(;l<n;l++)t[l]=e[l];else for(;l<n;l++)t[l]=e[l]+r[l]&255}function FV(e,t,r,n,l){let u=0;if(r.length===0){for(;u<l;u++)t[u]=e[u];for(;u<n;u++)t[u]=e[u]+(t[u-l]>>1)&255}else{for(;u<l;u++)t[u]=e[u]+(r[u]>>1)&255;for(;u<n;u++)t[u]=e[u]+(t[u-l]+r[u]>>1)&255}}function PV(e,t,r,n,l){let u=0;if(r.length===0){for(;u<l;u++)t[u]=e[u];for(;u<n;u++)t[u]=e[u]+t[u-l]&255}else{for(;u<l;u++)t[u]=e[u]+r[u]&255;for(;u<n;u++)t[u]=e[u]+Kye(t[u-l],r[u],r[u-l])&255}}function Kye(e,t,r){const n=e+t-r,l=Math.abs(n-e),u=Math.abs(n-t),d=Math.abs(n-r);return l<=u&&l<=d?e:u<=d?t:r}function Wye(e,t,r,n,l,u){switch(e){case 0:SV(t,r,l);break;case 1:TV(t,r,l,u);break;case 2:IV(t,r,n,l);break;case 3:FV(t,r,n,l,u);break;case 4:PV(t,r,n,l,u);break;default:throw new Error(`Unsupported filter: ${e}`)}}const qye=new Uint16Array([255]),$ye=new Uint8Array(qye.buffer),Xye=$ye[0]===255;function Zye(e){const{data:t,width:r,height:n,channels:l,depth:u}=e,d=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(u/8)*l,v=new Uint8Array(n*r*a);let x=0;for(let b=0;b<7;b++){const I=d[b],M=Math.ceil((r-I.x)/I.xStep),L=Math.ceil((n-I.y)/I.yStep);if(M<=0||L<=0)continue;const U=M*a,R=new Uint8Array(U);for(let H=0;H<L;H++){const q=t[x++],te=t.subarray(x,x+U);x+=U;const J=new Uint8Array(U);Wye(q,te,J,R,U,a),R.set(J);for(let se=0;se<M;se++){const ye=I.x+se*I.xStep,Se=I.y+H*I.yStep;if(!(ye>=r||Se>=n))for(let Be=0;Be<a;Be++)v[(Se*r+ye)*a+Be]=J[se*a+Be]}}}if(u===16){const b=new Uint16Array(v.buffer);if(Xye)for(let I=0;I<b.length;I++)b[I]=Yye(b[I]);return b}else return v}function Yye(e){return(e&255)<<8|e>>8&255}const Jye=new Uint16Array([255]),e1e=new Uint8Array(Jye.buffer),t1e=e1e[0]===255,r1e=new Uint8Array(0);function $U(e){const{data:t,width:r,height:n,channels:l,depth:u}=e,d=Math.ceil(u/8)*l,a=Math.ceil(u/8*l*r),v=new Uint8Array(n*a);let x=r1e,b=0,I,M;for(let L=0;L<n;L++){switch(I=t.subarray(b+1,b+1+a),M=v.subarray(L*a,(L+1)*a),t[b]){case 0:SV(I,M,a);break;case 1:TV(I,M,a,d);break;case 2:IV(I,M,x,a);break;case 3:FV(I,M,x,a,d);break;case 4:PV(I,M,x,a,d);break;default:throw new Error(`Unsupported filter: ${t[b]}`)}x=M,b+=a+1}if(u===16){const L=new Uint16Array(v.buffer);if(t1e)for(let U=0;U<L.length;U++)L[U]=n1e(L[U]);return L}else return v}function n1e(e){return(e&255)<<8|e>>8&255}const Jw=Uint8Array.of(137,80,78,71,13,10,26,10);function XU(e){if(!i1e(e.readBytes(Jw.length)))throw new Error("wrong PNG signature")}function i1e(e){if(e.length<Jw.length)return!1;for(let t=0;t<Jw.length;t++)if(e[t]!==Jw[t])return!1;return!0}const a1e="tEXt",o1e=0,LV=new TextDecoder("latin1");function s1e(e){if(c1e(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const l1e=/^[\u0000-\u00FF]*$/;function c1e(e){if(!l1e.test(e))throw new Error("invalid latin1 text")}function u1e(e,t,r){const n=MV(t);e[n]=h1e(t,r-n.length-1)}function MV(e){for(e.mark();e.readByte()!==o1e;);const t=e.offset;e.reset();const r=LV.decode(e.readBytes(t-e.offset-1));return e.skip(1),s1e(r),r}function h1e(e,t){return LV.decode(e.readBytes(t))}const aA={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},jS={UNKNOWN:-1,DEFLATE:0},ZU={UNKNOWN:-1,ADAPTIVE:0},HS={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},yw={NONE:0,BACKGROUND:1,PREVIOUS:2},VS={SOURCE:0,OVER:1};class f1e extends wF{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(t,r={}){super(t);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new KU,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=jS.UNKNOWN,this._filterMethod=ZU.UNKNOWN,this._interlaceMethod=HS.UNKNOWN,this._colorType=aA.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(XU(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeChunk(t,r)}return this.decodeImage(),this._png}decodeApng(){for(XU(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(t,r)}return this.decodeApngImage(),this._apng}decodeChunk(t,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case a1e:u1e(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-n!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?qU(this,t+4,r):this.skip(4)}decodeApngChunk(t,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,r),this.offset=n+t;break}if(this.offset-n!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?qU(this,t+4,r):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=A1e(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case aA.GREYSCALE:n=1;break;case aA.TRUECOLOUR:n=3;break;case aA.INDEXED_COLOUR:n=1;break;case aA.GREYSCALE_ALPHA:n=2;break;case aA.TRUECOLOUR_ALPHA:n=4;break;case aA.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==jS.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const r=t/3;this._hasPalette=!0;const n=[];this._palette=n;for(let l=0;l<r;l++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const r=t,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let r=t,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case aA.GREYSCALE:case aA.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let r=0;r<t/2;r++)this._transparency[r]=this.readUint16();break}case aA.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let r=0;for(;r<t;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case aA.UNKNOWN:case aA.GREYSCALE_ALPHA:case aA.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const r=MV(this),n=this.readUint8();if(n!==jS.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const l=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:Hye(l)}}decodepHYs(){const t=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:t,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const r={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(t);if(n){if(n.data=$U({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const l=this._apng.frames.at(t-1);this.disposeFrame(n,l,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(t,r,n){switch(t.disposeOp){case yw.NONE:break;case yw.BACKGROUND:for(let l=0;l<this._png.height;l++)for(let u=0;u<this._png.width;u++){const d=(l*t.width+u)*this._png.channels;for(let a=0;a<this._png.channels;a++)n.data[d+a]=0}break;case yw.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,r){const n=1<<this._png.depth,l=(u,d)=>{const a=((u+r.yOffset)*this._png.width+r.xOffset+d)*this._png.channels,v=(u*r.width+d)*this._png.channels;return{index:a,frameIndex:v}};switch(r.blendOp){case VS.SOURCE:for(let u=0;u<r.height;u++)for(let d=0;d<r.width;d++){const{index:a,frameIndex:v}=l(u,d);for(let x=0;x<this._png.channels;x++)t.data[a+x]=r.data[v+x]}break;case VS.OVER:for(let u=0;u<r.height;u++)for(let d=0;d<r.width;d++){const{index:a,frameIndex:v}=l(u,d);for(let x=0;x<this._png.channels;x++){const b=r.data[v+this._png.channels-1]/n,I=x%(this._png.channels-1)===0?1:r.data[v+x],M=Math.floor(b*I+(1-b)*t.data[a+x]);t.data[a+x]+=M}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==ZU.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===HS.NO_INTERLACE)this._png.data=$U({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===HS.ADAM7)this._png.data=Zye({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,r=this._frames.at(-1);r?r.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:yw.NONE,blendOp:VS.SOURCE,data:t}),this._inflator=new KU,this._writingDataChunks=!1}}function A1e(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var YU;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(YU||(YU={}));function d1e(e,t){return new f1e(e,t).decode()}var pa=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function GS(){pa.console&&typeof pa.console.log=="function"&&pa.console.log.apply(pa.console,arguments)}var Us={log:GS,warn:function(e){pa.console&&(typeof pa.console.warn=="function"?pa.console.warn.apply(pa.console,arguments):GS.call(null,arguments))},error:function(e){pa.console&&(typeof pa.console.error=="function"?pa.console.error.apply(pa.console,arguments):GS(e))}};function KS(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){o0(n.response,t,r)},n.onerror=function(){Us.error("could not download file")},n.send()}function JU(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function xw(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o0=pa.saveAs||((typeof window>"u"?"undefined":ps(window))!=="object"||window!==pa?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=pa.URL||pa.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener",typeof e=="string"?(l.href=e,l.origin!==location.origin?JU(l.href)?KS(e,t,r):xw(l,l.target="_blank"):xw(l)):(l.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(l.href)},4e4),setTimeout(function(){xw(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(JU(e))KS(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){xw(n)})}else navigator.msSaveOrOpenBlob(function(l,u){return u===void 0?u={autoBom:!1}:ps(u)!=="object"&&(Us.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return KS(e,t,r);var l=e.type==="application/octet-stream",u=/constructor/i.test(pa.HTMLElement)||pa.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||l&&u)&&(typeof FileReader>"u"?"undefined":ps(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var b=a.result;b=d?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=b:location=b,n=null},a.readAsDataURL(e)}else{var v=pa.URL||pa.webkitURL,x=v.createObjectURL(e);n?n.location=x:location.href=x,n=null,setTimeout(function(){v.revokeObjectURL(x)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function OV(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],n=0;n<r.length;n++){var l=r[n].re,u=r[n].process,d=l.exec(e);d&&(t=u(d),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),v=this.g.toString(16),x=this.b.toString(16);return a.length==1&&(a="0"+a),v.length==1&&(v="0"+v),x.length==1&&(x="0"+x),"#"+a+v+x}}var e2=pa.atob.bind(pa),eN=pa.btoa.bind(pa);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function WS(e,t){var r=e[0],n=e[1],l=e[2],u=e[3];r=Ih(r,n,l,u,t[0],7,-680876936),u=Ih(u,r,n,l,t[1],12,-389564586),l=Ih(l,u,r,n,t[2],17,606105819),n=Ih(n,l,u,r,t[3],22,-1044525330),r=Ih(r,n,l,u,t[4],7,-176418897),u=Ih(u,r,n,l,t[5],12,1200080426),l=Ih(l,u,r,n,t[6],17,-1473231341),n=Ih(n,l,u,r,t[7],22,-45705983),r=Ih(r,n,l,u,t[8],7,1770035416),u=Ih(u,r,n,l,t[9],12,-1958414417),l=Ih(l,u,r,n,t[10],17,-42063),n=Ih(n,l,u,r,t[11],22,-1990404162),r=Ih(r,n,l,u,t[12],7,1804603682),u=Ih(u,r,n,l,t[13],12,-40341101),l=Ih(l,u,r,n,t[14],17,-1502002290),r=Fh(r,n=Ih(n,l,u,r,t[15],22,1236535329),l,u,t[1],5,-165796510),u=Fh(u,r,n,l,t[6],9,-1069501632),l=Fh(l,u,r,n,t[11],14,643717713),n=Fh(n,l,u,r,t[0],20,-373897302),r=Fh(r,n,l,u,t[5],5,-701558691),u=Fh(u,r,n,l,t[10],9,38016083),l=Fh(l,u,r,n,t[15],14,-660478335),n=Fh(n,l,u,r,t[4],20,-405537848),r=Fh(r,n,l,u,t[9],5,568446438),u=Fh(u,r,n,l,t[14],9,-1019803690),l=Fh(l,u,r,n,t[3],14,-187363961),n=Fh(n,l,u,r,t[8],20,1163531501),r=Fh(r,n,l,u,t[13],5,-1444681467),u=Fh(u,r,n,l,t[2],9,-51403784),l=Fh(l,u,r,n,t[7],14,1735328473),r=Ph(r,n=Fh(n,l,u,r,t[12],20,-1926607734),l,u,t[5],4,-378558),u=Ph(u,r,n,l,t[8],11,-2022574463),l=Ph(l,u,r,n,t[11],16,1839030562),n=Ph(n,l,u,r,t[14],23,-35309556),r=Ph(r,n,l,u,t[1],4,-1530992060),u=Ph(u,r,n,l,t[4],11,1272893353),l=Ph(l,u,r,n,t[7],16,-155497632),n=Ph(n,l,u,r,t[10],23,-1094730640),r=Ph(r,n,l,u,t[13],4,681279174),u=Ph(u,r,n,l,t[0],11,-358537222),l=Ph(l,u,r,n,t[3],16,-722521979),n=Ph(n,l,u,r,t[6],23,76029189),r=Ph(r,n,l,u,t[9],4,-640364487),u=Ph(u,r,n,l,t[12],11,-421815835),l=Ph(l,u,r,n,t[15],16,530742520),r=Lh(r,n=Ph(n,l,u,r,t[2],23,-995338651),l,u,t[0],6,-198630844),u=Lh(u,r,n,l,t[7],10,1126891415),l=Lh(l,u,r,n,t[14],15,-1416354905),n=Lh(n,l,u,r,t[5],21,-57434055),r=Lh(r,n,l,u,t[12],6,1700485571),u=Lh(u,r,n,l,t[3],10,-1894986606),l=Lh(l,u,r,n,t[10],15,-1051523),n=Lh(n,l,u,r,t[1],21,-2054922799),r=Lh(r,n,l,u,t[8],6,1873313359),u=Lh(u,r,n,l,t[15],10,-30611744),l=Lh(l,u,r,n,t[6],15,-1560198380),n=Lh(n,l,u,r,t[13],21,1309151649),r=Lh(r,n,l,u,t[4],6,-145523070),u=Lh(u,r,n,l,t[11],10,-1120210379),l=Lh(l,u,r,n,t[2],15,718787259),n=Lh(n,l,u,r,t[9],21,-343485551),e[0]=_g(r,e[0]),e[1]=_g(n,e[1]),e[2]=_g(l,e[2]),e[3]=_g(u,e[3])}function hE(e,t,r,n,l,u){return t=_g(_g(t,e),_g(n,u)),_g(t<<l|t>>>32-l,r)}function Ih(e,t,r,n,l,u,d){return hE(t&r|~t&n,e,t,l,u,d)}function Fh(e,t,r,n,l,u,d){return hE(t&n|r&~n,e,t,l,u,d)}function Ph(e,t,r,n,l,u,d){return hE(t^r^n,e,t,l,u,d)}function Lh(e,t,r,n,l,u,d){return hE(r^(t|~n),e,t,l,u,d)}function DV(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)WS(n,p1e(e.substring(t-64,t)));e=e.substring(t-64);var l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)l[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(l[t>>2]|=128<<(t%4<<3),t>55)for(WS(n,l),t=0;t<16;t++)l[t]=0;return l[14]=8*r,WS(n,l),n}function p1e(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var tN="0123456789abcdef".split("");function m1e(e){for(var t="",r=0;r<4;r++)t+=tN[e>>8*r+4&15]+tN[e>>8*r&15];return t}function g1e(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function B5(e){return DV(e).map(g1e).join("")}var _1e=function(e){for(var t=0;t<e.length;t++)e[t]=m1e(e[t]);return e.join("")}(DV("hello"))!="5d41402abc4b2a76b9719d911017c592";function _g(e,t){if(_1e){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function C5(e,t){var r,n,l,u;if(e!==r){for(var d=(l=e,u=1+(256/e.length|0),new Array(u+1).join(l)),a=[],v=0;v<256;v++)a[v]=v;var x=0;for(v=0;v<256;v++){var b=a[v];x=(x+b+d.charCodeAt(v))%256,a[v]=a[x],a[x]=b}r=e,n=a}else a=n;var I=t.length,M=0,L=0,U="";for(v=0;v<I;v++)L=(L+(b=a[M=(M+1)%256]))%256,a[M]=a[L],a[L]=b,d=a[(a[M]+a[L])%256],U+=String.fromCharCode(t.charCodeAt(v)^d);return U}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var rN={print:4,modify:8,copy:16,"annot-forms":32};function P_(e,t,r,n){this.v=1,this.r=2;var l=192;e.forEach(function(a){if(rN.perm!==void 0)throw new Error("Invalid permission: "+a);l+=rN[a]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var u=(t+this.padding).substr(0,32),d=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(u,d),this.P=-(1+(255^l)),this.encryptionKey=B5(u+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=C5(this.encryptionKey,this.padding)}function L_(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var l=e.charCodeAt(n);t+=l<33||l===35||l===37||l===40||l===41||l===47||l===60||l===62||l===91||l===93||l===123||l===125||l>126?"#"+("0"+l.toString(16)).slice(-2):e[n]}return t}function nN(e){if(ps(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,l){if(l=l||!1,typeof r!="string"||typeof n!="function"||typeof l!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var u=Math.random().toString(35);return t[r][u]=[n,!!l],u},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),l=[];for(var u in t[r]){var d=t[r][u];try{d[0].apply(e,n)}catch(a){pa.console&&Us.error("jsPDF PubSub Error",a.message,a)}d[1]&&l.push(u)}l.length&&l.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function ub(e){if(!(this instanceof ub))return new ub(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function RV(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function l0(e,t,r,n,l){if(!(this instanceof l0))return new l0(e,t,r,n,l);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,RV.call(this,n,l)}function N_(e,t,r,n,l){if(!(this instanceof N_))return new N_(e,t,r,n,l);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,RV.call(this,n,l)}function Qi(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],l=arguments[2],u=arguments[3],d=[],a=1,v=16,x="S",b=null;ps(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,l=e.format||l,u=e.compress||e.compressPdf||u,(b=e.encryption||null)!==null&&(b.userPassword=b.userPassword||"",b.ownerPassword=b.ownerPassword||"",b.userPermissions=b.userPermissions||[]),a=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(v=e.floatPrecision),x=e.defaultPathOperation||"S"),d=e.filters||(u===!0?["FlateEncode"]:d),n=n||"mm",r=(""+(r||"P")).toLowerCase();var I=e.putOnlyUsedFonts||!1,M={},L={internal:{},__private__:{}};L.__private__.PubSub=nN;var U="1.3",R=L.__private__.getPdfVersion=function(){return U};L.__private__.setPdfVersion=function(ne){U=ne};var H={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};L.__private__.getPageFormats=function(){return H};var q=L.__private__.getPageFormat=function(ne){return H[ne]};l=l||"a4";var te="compat",J="advanced",se=te;function ye(){this.saveGraphicsState(),mt(new _n(vi,0,0,-vi,0,fo()*vi).toString()+" cm"),this.setFontSize(this.getFontSize()/vi),x="n",se=J}function Se(){this.restoreGraphicsState(),x="S",se=te}var Be=L.__private__.combineFontStyleAndFontWeight=function(ne,ze){if(ne=="bold"&&ze=="normal"||ne=="bold"&&ze==400||ne=="normal"&&ze=="italic"||ne=="bold"&&ze=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ze&&(ne=ze==400||ze==="normal"?ne==="italic"?"italic":"normal":ze!=700&&ze!=="bold"||ne!=="normal"?(ze==700?"bold":ze)+""+ne:"bold"),ne};L.advancedAPI=function(ne){var ze=se===te;return ze&&ye.call(this),typeof ne!="function"||(ne(this),ze&&Se.call(this)),this},L.compatAPI=function(ne){var ze=se===J;return ze&&Se.call(this),typeof ne!="function"||(ne(this),ze&&ye.call(this)),this},L.isAdvancedAPI=function(){return se===J};var De,we=function(ne){if(se!==J)throw new Error(ne+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},nt=L.roundToPrecision=L.__private__.roundToPrecision=function(ne,ze){var ft=t||ze;if(isNaN(ne)||isNaN(ft))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return ne.toFixed(ft).replace(/0+$/,"")};De=L.hpf=L.__private__.hpf=typeof v=="number"?function(ne){if(isNaN(ne))throw new Error("Invalid argument passed to jsPDF.hpf");return nt(ne,v)}:v==="smart"?function(ne){if(isNaN(ne))throw new Error("Invalid argument passed to jsPDF.hpf");return nt(ne,ne>-1&&ne<1?16:5)}:function(ne){if(isNaN(ne))throw new Error("Invalid argument passed to jsPDF.hpf");return nt(ne,16)};var _e=L.f2=L.__private__.f2=function(ne){if(isNaN(ne))throw new Error("Invalid argument passed to jsPDF.f2");return nt(ne,2)},Ie=L.__private__.f3=function(ne){if(isNaN(ne))throw new Error("Invalid argument passed to jsPDF.f3");return nt(ne,3)},Ze=L.scale=L.__private__.scale=function(ne){if(isNaN(ne))throw new Error("Invalid argument passed to jsPDF.scale");return se===te?ne*vi:se===J?ne:void 0},st=function(ne){return Ze(function(ze){return se===te?fo()-ze:se===J?ze:void 0}(ne))};L.__private__.setPrecision=L.setPrecision=function(ne){typeof parseInt(ne,10)=="number"&&(t=parseInt(ne,10))};var Et,Ut="00000000000000000000000000000000",jt=L.__private__.getFileId=function(){return Ut},bt=L.__private__.setFileId=function(ne){return Ut=ne!==void 0&&/^[a-fA-F0-9]{32}$/.test(ne)?ne.toUpperCase():Ut.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),b!==null&&(No=new P_(b.userPermissions,b.userPassword,b.ownerPassword,Ut)),Ut};L.setFileId=function(ne){return bt(ne),this},L.getFileId=function(){return jt()};var Nt=L.__private__.convertDateToPDFDate=function(ne){var ze=ne.getTimezoneOffset(),ft=ze<0?"+":"-",Qt=Math.floor(Math.abs(ze/60)),sr=Math.abs(ze%60),Xr=[ft,Fe(Qt),"'",Fe(sr),"'"].join("");return["D:",ne.getFullYear(),Fe(ne.getMonth()+1),Fe(ne.getDate()),Fe(ne.getHours()),Fe(ne.getMinutes()),Fe(ne.getSeconds()),Xr].join("")},ar=L.__private__.convertPDFDateToDate=function(ne){var ze=parseInt(ne.substr(2,4),10),ft=parseInt(ne.substr(6,2),10)-1,Qt=parseInt(ne.substr(8,2),10),sr=parseInt(ne.substr(10,2),10),Xr=parseInt(ne.substr(12,2),10),tr=parseInt(ne.substr(14,2),10);return new Date(ze,ft,Qt,sr,Xr,tr,0)},lt=L.__private__.setCreationDate=function(ne){var ze;if(ne===void 0&&(ne=new Date),ne instanceof Date)ze=Nt(ne);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(ne))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ze=ne}return Et=ze},ie=L.__private__.getCreationDate=function(ne){var ze=Et;return ne==="jsDate"&&(ze=ar(Et)),ze};L.setCreationDate=function(ne){return lt(ne),this},L.getCreationDate=function(ne){return ie(ne)};var Le,Fe=L.__private__.padd2=function(ne){return("0"+parseInt(ne)).slice(-2)},Re=L.__private__.padd2Hex=function(ne){return("00"+(ne=ne.toString())).substr(ne.length)},et=0,xt=[],Dt=[],pt=0,Ct=[],mr=[],Zt=!1,sn=Dt;L.__private__.setCustomOutputDestination=function(ne){Zt=!0,sn=ne};var er=function(ne){Zt||(sn=ne)};L.__private__.resetCustomOutputDestination=function(){Zt=!1,sn=Dt};var mt=L.__private__.out=function(ne){return ne=ne.toString(),pt+=ne.length+1,sn.push(ne),sn},En=L.__private__.write=function(ne){return mt(arguments.length===1?ne.toString():Array.prototype.join.call(arguments," "))},$r=L.__private__.getArrayBuffer=function(ne){for(var ze=ne.length,ft=new ArrayBuffer(ze),Qt=new Uint8Array(ft);ze--;)Qt[ze]=ne.charCodeAt(ze);return ft},zn=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];L.__private__.getStandardFonts=function(){return zn};var an=e.fontSize||16;L.__private__.setFontSize=L.setFontSize=function(ne){return an=se===J?ne/vi:ne,this};var Pn,yn=L.__private__.getFontSize=L.getFontSize=function(){return se===te?an:an*vi},Ci=e.R2L||!1;L.__private__.setR2L=L.setR2L=function(ne){return Ci=ne,this},L.__private__.getR2L=L.getR2L=function(){return Ci};var Zn,Vi=L.__private__.setZoomMode=function(ne){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(ne))Pn=ne;else if(isNaN(ne)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(ne)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+ne+'" is not recognized.');Pn=ne}else Pn=parseInt(ne,10)};L.__private__.getZoomMode=function(){return Pn};var Ti,ui=L.__private__.setPageMode=function(ne){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(ne)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+ne+'" is not recognized.');Zn=ne};L.__private__.getPageMode=function(){return Zn};var ta=L.__private__.setLayoutMode=function(ne){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(ne)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+ne+'" is not recognized.');Ti=ne};L.__private__.getLayoutMode=function(){return Ti},L.__private__.setDisplayMode=L.setDisplayMode=function(ne,ze,ft){return Vi(ne),ta(ze),ui(ft),this};var bi={title:"",subject:"",author:"",keywords:"",creator:""};L.__private__.getDocumentProperty=function(ne){if(Object.keys(bi).indexOf(ne)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return bi[ne]},L.__private__.getDocumentProperties=function(){return bi},L.__private__.setDocumentProperties=L.setProperties=L.setDocumentProperties=function(ne){for(var ze in bi)bi.hasOwnProperty(ze)&&ne[ze]&&(bi[ze]=ne[ze]);return this},L.__private__.setDocumentProperty=function(ne,ze){if(Object.keys(bi).indexOf(ne)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return bi[ne]=ze};var ti,vi,Dn,ua,ca,Gn={},Li={},xa=[],yi={},Nn={},ki={},oo={},wa=null,ba=0,Mi=[],Ea=new nN(L),hr=e.hotfixes||[],Bo={},xc={},sl=[],_n=function ne(ze,ft,Qt,sr,Xr,tr){if(!(this instanceof ne))return new ne(ze,ft,Qt,sr,Xr,tr);isNaN(ze)&&(ze=1),isNaN(ft)&&(ft=0),isNaN(Qt)&&(Qt=0),isNaN(sr)&&(sr=1),isNaN(Xr)&&(Xr=0),isNaN(tr)&&(tr=0),this._matrix=[ze,ft,Qt,sr,Xr,tr]};Object.defineProperty(_n.prototype,"sx",{get:function(){return this._matrix[0]},set:function(ne){this._matrix[0]=ne}}),Object.defineProperty(_n.prototype,"shy",{get:function(){return this._matrix[1]},set:function(ne){this._matrix[1]=ne}}),Object.defineProperty(_n.prototype,"shx",{get:function(){return this._matrix[2]},set:function(ne){this._matrix[2]=ne}}),Object.defineProperty(_n.prototype,"sy",{get:function(){return this._matrix[3]},set:function(ne){this._matrix[3]=ne}}),Object.defineProperty(_n.prototype,"tx",{get:function(){return this._matrix[4]},set:function(ne){this._matrix[4]=ne}}),Object.defineProperty(_n.prototype,"ty",{get:function(){return this._matrix[5]},set:function(ne){this._matrix[5]=ne}}),Object.defineProperty(_n.prototype,"a",{get:function(){return this._matrix[0]},set:function(ne){this._matrix[0]=ne}}),Object.defineProperty(_n.prototype,"b",{get:function(){return this._matrix[1]},set:function(ne){this._matrix[1]=ne}}),Object.defineProperty(_n.prototype,"c",{get:function(){return this._matrix[2]},set:function(ne){this._matrix[2]=ne}}),Object.defineProperty(_n.prototype,"d",{get:function(){return this._matrix[3]},set:function(ne){this._matrix[3]=ne}}),Object.defineProperty(_n.prototype,"e",{get:function(){return this._matrix[4]},set:function(ne){this._matrix[4]=ne}}),Object.defineProperty(_n.prototype,"f",{get:function(){return this._matrix[5]},set:function(ne){this._matrix[5]=ne}}),Object.defineProperty(_n.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(_n.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(_n.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(_n.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),_n.prototype.join=function(ne){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(De).join(ne)},_n.prototype.multiply=function(ne){var ze=ne.sx*this.sx+ne.shy*this.shx,ft=ne.sx*this.shy+ne.shy*this.sy,Qt=ne.shx*this.sx+ne.sy*this.shx,sr=ne.shx*this.shy+ne.sy*this.sy,Xr=ne.tx*this.sx+ne.ty*this.shx+this.tx,tr=ne.tx*this.shy+ne.ty*this.sy+this.ty;return new _n(ze,ft,Qt,sr,Xr,tr)},_n.prototype.decompose=function(){var ne=this.sx,ze=this.shy,ft=this.shx,Qt=this.sy,sr=this.tx,Xr=this.ty,tr=Math.sqrt(ne*ne+ze*ze),ri=(ne/=tr)*ft+(ze/=tr)*Qt;ft-=ne*ri,Qt-=ze*ri;var Yn=Math.sqrt(ft*ft+Qt*Qt);return ri/=Yn,ne*(Qt/=Yn)<ze*(ft/=Yn)&&(ne=-ne,ze=-ze,ri=-ri,tr=-tr),{scale:new _n(tr,0,0,Yn,0,0),translate:new _n(1,0,0,1,sr,Xr),rotate:new _n(ne,ze,-ze,ne,0,0),skew:new _n(1,0,ri,1,0,0)}},_n.prototype.toString=function(ne){return this.join(" ")},_n.prototype.inversed=function(){var ne=this.sx,ze=this.shy,ft=this.shx,Qt=this.sy,sr=this.tx,Xr=this.ty,tr=1/(ne*Qt-ze*ft),ri=Qt*tr,Yn=-ze*tr,Bi=-ft*tr,Si=ne*tr;return new _n(ri,Yn,Bi,Si,-ri*sr-Bi*Xr,-Yn*sr-Si*Xr)},_n.prototype.applyToPoint=function(ne){var ze=ne.x*this.sx+ne.y*this.shx+this.tx,ft=ne.x*this.shy+ne.y*this.sy+this.ty;return new Cc(ze,ft)},_n.prototype.applyToRectangle=function(ne){var ze=this.applyToPoint(ne),ft=this.applyToPoint(new Cc(ne.x+ne.w,ne.y+ne.h));return new vu(ze.x,ze.y,ft.x-ze.x,ft.y-ze.y)},_n.prototype.clone=function(){var ne=this.sx,ze=this.shy,ft=this.shx,Qt=this.sy,sr=this.tx,Xr=this.ty;return new _n(ne,ze,ft,Qt,sr,Xr)},L.Matrix=_n;var Tt=L.matrixMult=function(ne,ze){return ze.multiply(ne)},pe=new _n(1,0,0,1,0,0);L.unitMatrix=L.identityMatrix=pe;var be=function(ne,ze){if(!Nn[ne]){var ft=(ze instanceof l0?"Sh":"P")+(Object.keys(yi).length+1).toString(10);ze.id=ft,Nn[ne]=ft,yi[ft]=ze,Ea.publish("addPattern",ze)}};L.ShadingPattern=l0,L.TilingPattern=N_,L.addShadingPattern=function(ne,ze){return we("addShadingPattern()"),be(ne,ze),this},L.beginTilingPattern=function(ne){we("beginTilingPattern()"),ts(ne.boundingBox[0],ne.boundingBox[1],ne.boundingBox[2]-ne.boundingBox[0],ne.boundingBox[3]-ne.boundingBox[1],ne.matrix)},L.endTilingPattern=function(ne,ze){we("endTilingPattern()"),ze.stream=mr[Le].join(`
`),be(ne,ze),Ea.publish("endTilingPattern",ze),sl.pop().restore()};var Ve,rt=L.__private__.newObject=function(){var ne=je();return oe(ne,!0),ne},je=L.__private__.newObjectDeferred=function(){return et++,xt[et]=function(){return pt},et},oe=function(ne,ze){return ze=typeof ze=="boolean"&&ze,xt[ne]=pt,ze&&mt(ne+" 0 obj"),ne},Ee=L.__private__.newAdditionalObject=function(){var ne={objId:je(),content:""};return Ct.push(ne),ne},me=je(),xe=je(),Ne=L.__private__.decodeColorString=function(ne){var ze=ne.split(" ");if(ze.length!==2||ze[1]!=="g"&&ze[1]!=="G")ze.length!==5||ze[4]!=="k"&&ze[4]!=="K"||(ze=[(1-ze[0])*(1-ze[3]),(1-ze[1])*(1-ze[3]),(1-ze[2])*(1-ze[3]),"r"]);else{var ft=parseFloat(ze[0]);ze=[ft,ft,ft,"r"]}for(var Qt="#",sr=0;sr<3;sr++)Qt+=("0"+Math.floor(255*parseFloat(ze[sr])).toString(16)).slice(-2);return Qt},Oe=L.__private__.encodeColorString=function(ne){var ze;typeof ne=="string"&&(ne={ch1:ne});var ft=ne.ch1,Qt=ne.ch2,sr=ne.ch3,Xr=ne.ch4,tr=ne.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ft=="string"&&ft.charAt(0)!=="#"){var ri=new OV(ft);if(ri.ok)ft=ri.toHex();else if(!/^\d*\.?\d*$/.test(ft))throw new Error('Invalid color "'+ft+'" passed to jsPDF.encodeColorString.')}if(typeof ft=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ft)&&(ft="#"+ft[1]+ft[1]+ft[2]+ft[2]+ft[3]+ft[3]),typeof ft=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ft)){var Yn=parseInt(ft.substr(1),16);ft=Yn>>16&255,Qt=Yn>>8&255,sr=255&Yn}if(Qt===void 0||Xr===void 0&&ft===Qt&&Qt===sr)ze=typeof ft=="string"?ft+" "+tr[0]:ne.precision===2?_e(ft/255)+" "+tr[0]:Ie(ft/255)+" "+tr[0];else if(Xr===void 0||ps(Xr)==="object"){if(Xr&&!isNaN(Xr.a)&&Xr.a===0)return["1.","1.","1.",tr[1]].join(" ");ze=typeof ft=="string"?[ft,Qt,sr,tr[1]].join(" "):ne.precision===2?[_e(ft/255),_e(Qt/255),_e(sr/255),tr[1]].join(" "):[Ie(ft/255),Ie(Qt/255),Ie(sr/255),tr[1]].join(" ")}else ze=typeof ft=="string"?[ft,Qt,sr,Xr,tr[2]].join(" "):ne.precision===2?[_e(ft),_e(Qt),_e(sr),_e(Xr),tr[2]].join(" "):[Ie(ft),Ie(Qt),Ie(sr),Ie(Xr),tr[2]].join(" ");return ze},St=L.__private__.getFilters=function(){return d},Ht=L.__private__.putStream=function(ne){var ze=(ne=ne||{}).data||"",ft=ne.filters||St(),Qt=ne.alreadyAppliedFilters||[],sr=ne.addLength1||!1,Xr=ze.length,tr=ne.objectId,ri=function(oi){return oi};if(b!==null&&tr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");b!==null&&(ri=No.encryptor(tr,0));var Yn={};ft===!0&&(ft=["FlateEncode"]);var Bi=ne.additionalKeyValues||[],Si=(Yn=Qi.API.processDataByFilters!==void 0?Qi.API.processDataByFilters(ze,ft):{data:ze,reverseChain:[]}).reverseChain+(Array.isArray(Qt)?Qt.join(" "):Qt.toString());if(Yn.data.length!==0&&(Bi.push({key:"Length",value:Yn.data.length}),sr===!0&&Bi.push({key:"Length1",value:Xr})),Si.length!=0)if(Si.split("/").length-1==1)Bi.push({key:"Filter",value:Si});else{Bi.push({key:"Filter",value:"["+Si+"]"});for(var Ga=0;Ga<Bi.length;Ga+=1)if(Bi[Ga].key==="DecodeParms"){for(var xo=[],Yr=0;Yr<Yn.reverseChain.split("/").length-1;Yr+=1)xo.push("null");xo.push(Bi[Ga].value),Bi[Ga].value="["+xo.join(" ")+"]"}}mt("<<");for(var Un=0;Un<Bi.length;Un++)mt("/"+Bi[Un].key+" "+Bi[Un].value);mt(">>"),Yn.data.length!==0&&(mt("stream"),mt(ri(Yn.data)),mt("endstream"))},Rt=L.__private__.putPage=function(ne){var ze=ne.number,ft=ne.data,Qt=ne.objId,sr=ne.contentsObjId;oe(Qt,!0),mt("<</Type /Page"),mt("/Parent "+ne.rootDictionaryObjId+" 0 R"),mt("/Resources "+ne.resourceDictionaryObjId+" 0 R"),mt("/MediaBox ["+parseFloat(De(ne.mediaBox.bottomLeftX))+" "+parseFloat(De(ne.mediaBox.bottomLeftY))+" "+De(ne.mediaBox.topRightX)+" "+De(ne.mediaBox.topRightY)+"]"),ne.cropBox!==null&&mt("/CropBox ["+De(ne.cropBox.bottomLeftX)+" "+De(ne.cropBox.bottomLeftY)+" "+De(ne.cropBox.topRightX)+" "+De(ne.cropBox.topRightY)+"]"),ne.bleedBox!==null&&mt("/BleedBox ["+De(ne.bleedBox.bottomLeftX)+" "+De(ne.bleedBox.bottomLeftY)+" "+De(ne.bleedBox.topRightX)+" "+De(ne.bleedBox.topRightY)+"]"),ne.trimBox!==null&&mt("/TrimBox ["+De(ne.trimBox.bottomLeftX)+" "+De(ne.trimBox.bottomLeftY)+" "+De(ne.trimBox.topRightX)+" "+De(ne.trimBox.topRightY)+"]"),ne.artBox!==null&&mt("/ArtBox ["+De(ne.artBox.bottomLeftX)+" "+De(ne.artBox.bottomLeftY)+" "+De(ne.artBox.topRightX)+" "+De(ne.artBox.topRightY)+"]"),typeof ne.userUnit=="number"&&ne.userUnit!==1&&mt("/UserUnit "+ne.userUnit),Ea.publish("putPage",{objId:Qt,pageContext:Mi[ze],pageNumber:ze,page:ft}),mt("/Contents "+sr+" 0 R"),mt(">>"),mt("endobj");var Xr=ft.join(`
`);return se===J&&(Xr+=`
Q`),oe(sr,!0),Ht({data:Xr,filters:St(),objectId:sr}),mt("endobj"),Qt},Vt=L.__private__.putPages=function(){var ne,ze,ft=[];for(ne=1;ne<=ba;ne++)Mi[ne].objId=je(),Mi[ne].contentsObjId=je();for(ne=1;ne<=ba;ne++)ft.push(Rt({number:ne,data:mr[ne],objId:Mi[ne].objId,contentsObjId:Mi[ne].contentsObjId,mediaBox:Mi[ne].mediaBox,cropBox:Mi[ne].cropBox,bleedBox:Mi[ne].bleedBox,trimBox:Mi[ne].trimBox,artBox:Mi[ne].artBox,userUnit:Mi[ne].userUnit,rootDictionaryObjId:me,resourceDictionaryObjId:xe}));oe(me,!0),mt("<</Type /Pages");var Qt="/Kids [";for(ze=0;ze<ba;ze++)Qt+=ft[ze]+" 0 R ";mt(Qt+"]"),mt("/Count "+ba),mt(">>"),mt("endobj"),Ea.publish("postPutPages")},Gt=function(ne){Ea.publish("putFont",{font:ne,out:mt,newObject:rt,putStream:Ht}),ne.isAlreadyPutted!==!0&&(ne.objectNumber=rt(),mt("<<"),mt("/Type /Font"),mt("/BaseFont /"+L_(ne.postScriptName)),mt("/Subtype /Type1"),typeof ne.encoding=="string"&&mt("/Encoding /"+ne.encoding),mt("/FirstChar 32"),mt("/LastChar 255"),mt(">>"),mt("endobj"))},br=function(ne){ne.objectNumber=rt();var ze=[];ze.push({key:"Type",value:"/XObject"}),ze.push({key:"Subtype",value:"/Form"}),ze.push({key:"BBox",value:"["+[De(ne.x),De(ne.y),De(ne.x+ne.width),De(ne.y+ne.height)].join(" ")+"]"}),ze.push({key:"Matrix",value:"["+ne.matrix.toString()+"]"});var ft=ne.pages[1].join(`
`);Ht({data:ft,additionalKeyValues:ze,objectId:ne.objectNumber}),mt("endobj")},qr=function(ne,ze){ze||(ze=21);var ft=rt(),Qt=function(tr,ri){var Yn,Bi=[],Si=1/(ri-1);for(Yn=0;Yn<1;Yn+=Si)Bi.push(Yn);if(Bi.push(1),tr[0].offset!=0){var Ga={offset:0,color:tr[0].color};tr.unshift(Ga)}if(tr[tr.length-1].offset!=1){var xo={offset:1,color:tr[tr.length-1].color};tr.push(xo)}for(var Yr="",Un=0,oi=0;oi<Bi.length;oi++){for(Yn=Bi[oi];Yn>tr[Un+1].offset;)Un++;var Ka=tr[Un].offset,Qo=(Yn-Ka)/(tr[Un+1].offset-Ka),Oi=tr[Un].color,qu=tr[Un+1].color;Yr+=Re(Math.round((1-Qo)*Oi[0]+Qo*qu[0]).toString(16))+Re(Math.round((1-Qo)*Oi[1]+Qo*qu[1]).toString(16))+Re(Math.round((1-Qo)*Oi[2]+Qo*qu[2]).toString(16))}return Yr.trim()}(ne.colors,ze),sr=[];sr.push({key:"FunctionType",value:"0"}),sr.push({key:"Domain",value:"[0.0 1.0]"}),sr.push({key:"Size",value:"["+ze+"]"}),sr.push({key:"BitsPerSample",value:"8"}),sr.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),sr.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ht({data:Qt,additionalKeyValues:sr,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ft}),mt("endobj"),ne.objectNumber=rt(),mt("<< /ShadingType "+ne.type),mt("/ColorSpace /DeviceRGB");var Xr="/Coords ["+De(parseFloat(ne.coords[0]))+" "+De(parseFloat(ne.coords[1]))+" ";ne.type===2?Xr+=De(parseFloat(ne.coords[2]))+" "+De(parseFloat(ne.coords[3])):Xr+=De(parseFloat(ne.coords[2]))+" "+De(parseFloat(ne.coords[3]))+" "+De(parseFloat(ne.coords[4]))+" "+De(parseFloat(ne.coords[5])),mt(Xr+="]"),ne.matrix&&mt("/Matrix ["+ne.matrix.toString()+"]"),mt("/Function "+ft+" 0 R"),mt("/Extend [true true]"),mt(">>"),mt("endobj")},Hr=function(ne,ze){var ft=je(),Qt=rt();ze.push({resourcesOid:ft,objectOid:Qt}),ne.objectNumber=Qt;var sr=[];sr.push({key:"Type",value:"/Pattern"}),sr.push({key:"PatternType",value:"1"}),sr.push({key:"PaintType",value:"1"}),sr.push({key:"TilingType",value:"1"}),sr.push({key:"BBox",value:"["+ne.boundingBox.map(De).join(" ")+"]"}),sr.push({key:"XStep",value:De(ne.xStep)}),sr.push({key:"YStep",value:De(ne.yStep)}),sr.push({key:"Resources",value:ft+" 0 R"}),ne.matrix&&sr.push({key:"Matrix",value:"["+ne.matrix.toString()+"]"}),Ht({data:ne.stream,additionalKeyValues:sr,objectId:ne.objectNumber}),mt("endobj")},Jr=function(ne){for(var ze in ne.objectNumber=rt(),mt("<<"),ne)switch(ze){case"opacity":mt("/ca "+_e(ne[ze]));break;case"stroke-opacity":mt("/CA "+_e(ne[ze]))}mt(">>"),mt("endobj")},en=function(ne){oe(ne.resourcesOid,!0),mt("<<"),mt("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ze in mt("/Font <<"),Gn)Gn.hasOwnProperty(ze)&&(I===!1||I===!0&&M.hasOwnProperty(ze))&&mt("/"+ze+" "+Gn[ze].objectNumber+" 0 R");mt(">>")}(),function(){if(Object.keys(yi).length>0){for(var ze in mt("/Shading <<"),yi)yi.hasOwnProperty(ze)&&yi[ze]instanceof l0&&yi[ze].objectNumber>=0&&mt("/"+ze+" "+yi[ze].objectNumber+" 0 R");Ea.publish("putShadingPatternDict"),mt(">>")}}(),function(ze){if(Object.keys(yi).length>0){for(var ft in mt("/Pattern <<"),yi)yi.hasOwnProperty(ft)&&yi[ft]instanceof L.TilingPattern&&yi[ft].objectNumber>=0&&yi[ft].objectNumber<ze&&mt("/"+ft+" "+yi[ft].objectNumber+" 0 R");Ea.publish("putTilingPatternDict"),mt(">>")}}(ne.objectOid),function(){if(Object.keys(ki).length>0){var ze;for(ze in mt("/ExtGState <<"),ki)ki.hasOwnProperty(ze)&&ki[ze].objectNumber>=0&&mt("/"+ze+" "+ki[ze].objectNumber+" 0 R");Ea.publish("putGStateDict"),mt(">>")}}(),function(){for(var ze in mt("/XObject <<"),Bo)Bo.hasOwnProperty(ze)&&Bo[ze].objectNumber>=0&&mt("/"+ze+" "+Bo[ze].objectNumber+" 0 R");Ea.publish("putXobjectDict"),mt(">>")}(),mt(">>"),mt("endobj")},Vn=function(ne){Li[ne.fontName]=Li[ne.fontName]||{},Li[ne.fontName][ne.fontStyle]=ne.id},Kn=function(ne,ze,ft,Qt,sr){var Xr={id:"F"+(Object.keys(Gn).length+1).toString(10),postScriptName:ne,fontName:ze,fontStyle:ft,encoding:Qt,isStandardFont:sr||!1,metadata:{}};return Ea.publish("addFont",{font:Xr,instance:this}),Gn[Xr.id]=Xr,Vn(Xr),Xr.id},Sn=L.__private__.pdfEscape=L.pdfEscape=function(ne,ze){return function(ft,Qt){var sr,Xr,tr,ri,Yn,Bi,Si,Ga,xo;if(tr=(Qt=Qt||{}).sourceEncoding||"Unicode",Yn=Qt.outputEncoding,(Qt.autoencode||Yn)&&Gn[ti].metadata&&Gn[ti].metadata[tr]&&Gn[ti].metadata[tr].encoding&&(ri=Gn[ti].metadata[tr].encoding,!Yn&&Gn[ti].encoding&&(Yn=Gn[ti].encoding),!Yn&&ri.codePages&&(Yn=ri.codePages[0]),typeof Yn=="string"&&(Yn=ri[Yn]),Yn)){for(Si=!1,Bi=[],sr=0,Xr=ft.length;sr<Xr;sr++)(Ga=Yn[ft.charCodeAt(sr)])?Bi.push(String.fromCharCode(Ga)):Bi.push(ft[sr]),Bi[sr].charCodeAt(0)>>8&&(Si=!0);ft=Bi.join("")}for(sr=ft.length;Si===void 0&&sr!==0;)ft.charCodeAt(sr-1)>>8&&(Si=!0),sr--;if(!Si)return ft;for(Bi=Qt.noBOM?[]:[254,255],sr=0,Xr=ft.length;sr<Xr;sr++){if((xo=(Ga=ft.charCodeAt(sr))>>8)>>8)throw new Error("Character at position "+sr+" of string '"+ft+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Bi.push(xo),Bi.push(Ga-(xo<<8))}return String.fromCharCode.apply(void 0,Bi)}(ne,ze).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ii=L.__private__.beginPage=function(ne){mr[++ba]=[],Mi[ba]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(ne[0]),topRightY:Number(ne[1])}},Ya(ba),er(mr[Le])},ha=function(ne,ze){var ft,Qt,sr;switch(r=ze||r,typeof ne=="string"&&(ft=q(ne.toLowerCase()),Array.isArray(ft)&&(Qt=ft[0],sr=ft[1])),Array.isArray(ne)&&(Qt=ne[0]*vi,sr=ne[1]*vi),isNaN(Qt)&&(Qt=l[0],sr=l[1]),(Qt>14400||sr>14400)&&(Us.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Qt=Math.min(14400,Qt),sr=Math.min(14400,sr)),l=[Qt,sr],r.substr(0,1)){case"l":sr>Qt&&(l=[sr,Qt]);break;case"p":Qt>sr&&(l=[sr,Qt])}Ii(l),ff(Tl),mt(Zc),ph!==0&&mt(ph+" J"),Ku!==0&&mt(Ku+" j"),Ea.publish("addPage",{pageNumber:ba})},sa=function(ne){ne>0&&ne<=ba&&(mr.splice(ne,1),Mi.splice(ne,1),ba--,Le>ba&&(Le=ba),this.setPage(Le))},Ya=function(ne){ne>0&&ne<=ba&&(Le=ne)},Ra=L.__private__.getNumberOfPages=L.getNumberOfPages=function(){return mr.length-1},es=function(ne,ze,ft){var Qt,sr=void 0;return ft=ft||{},ne=ne!==void 0?ne:Gn[ti].fontName,ze=ze!==void 0?ze:Gn[ti].fontStyle,Qt=ne.toLowerCase(),Li[Qt]!==void 0&&Li[Qt][ze]!==void 0?sr=Li[Qt][ze]:Li[ne]!==void 0&&Li[ne][ze]!==void 0?sr=Li[ne][ze]:ft.disableWarning===!1&&Us.warn("Unable to look up font label for font '"+ne+"', '"+ze+"'. Refer to getFontList() for available fonts."),sr||ft.noFallback||(sr=Li.times[ze])==null&&(sr=Li.times.normal),sr},so=L.__private__.putInfo=function(){var ne=rt(),ze=function(Qt){return Qt};for(var ft in b!==null&&(ze=No.encryptor(ne,0)),mt("<<"),mt("/Producer ("+Sn(ze("jsPDF "+Qi.version))+")"),bi)bi.hasOwnProperty(ft)&&bi[ft]&&mt("/"+ft.substr(0,1).toUpperCase()+ft.substr(1)+" ("+Sn(ze(bi[ft]))+")");mt("/CreationDate ("+Sn(ze(Et))+")"),mt(">>"),mt("endobj")},Ss=L.__private__.putCatalog=function(ne){var ze=(ne=ne||{}).rootDictionaryObjId||me;switch(rt(),mt("<<"),mt("/Type /Catalog"),mt("/Pages "+ze+" 0 R"),Pn||(Pn="fullwidth"),Pn){case"fullwidth":mt("/OpenAction [3 0 R /FitH null]");break;case"fullheight":mt("/OpenAction [3 0 R /FitV null]");break;case"fullpage":mt("/OpenAction [3 0 R /Fit]");break;case"original":mt("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ft=""+Pn;ft.substr(ft.length-1)==="%"&&(Pn=parseInt(Pn)/100),typeof Pn=="number"&&mt("/OpenAction [3 0 R /XYZ null null "+_e(Pn)+"]")}switch(Ti||(Ti="continuous"),Ti){case"continuous":mt("/PageLayout /OneColumn");break;case"single":mt("/PageLayout /SinglePage");break;case"two":case"twoleft":mt("/PageLayout /TwoColumnLeft");break;case"tworight":mt("/PageLayout /TwoColumnRight")}Zn&&mt("/PageMode /"+Zn),Ea.publish("putCatalog"),mt(">>"),mt("endobj")},Co=L.__private__.putTrailer=function(){mt("trailer"),mt("<<"),mt("/Size "+(et+1)),mt("/Root "+et+" 0 R"),mt("/Info "+(et-1)+" 0 R"),b!==null&&mt("/Encrypt "+No.oid+" 0 R"),mt("/ID [ <"+Ut+"> <"+Ut+"> ]"),mt(">>")},Rf=L.__private__.putHeader=function(){mt("%PDF-"+U),mt("%ºß¬à")},Hu=L.__private__.putXRef=function(){var ne="0000000000";mt("xref"),mt("0 "+(et+1)),mt("0000000000 65535 f ");for(var ze=1;ze<=et;ze++)typeof xt[ze]=="function"?mt((ne+xt[ze]()).slice(-10)+" 00000 n "):xt[ze]!==void 0?mt((ne+xt[ze]).slice(-10)+" 00000 n "):mt("0000000000 00000 n ")},Ul=L.__private__.buildDocument=function(){var ne;et=0,pt=0,Dt=[],xt=[],Ct=[],me=je(),xe=je(),er(Dt),Ea.publish("buildDocument"),Rf(),Vt(),function(){Ea.publish("putAdditionalObjects");for(var ft=0;ft<Ct.length;ft++){var Qt=Ct[ft];oe(Qt.objId,!0),mt(Qt.content),mt("endobj")}Ea.publish("postPutAdditionalObjects")}(),ne=[],function(){for(var ft in Gn)Gn.hasOwnProperty(ft)&&(I===!1||I===!0&&M.hasOwnProperty(ft))&&Gt(Gn[ft])}(),function(){var ft;for(ft in ki)ki.hasOwnProperty(ft)&&Jr(ki[ft])}(),function(){for(var ft in Bo)Bo.hasOwnProperty(ft)&&br(Bo[ft])}(),function(ft){var Qt;for(Qt in yi)yi.hasOwnProperty(Qt)&&(yi[Qt]instanceof l0?qr(yi[Qt]):yi[Qt]instanceof N_&&Hr(yi[Qt],ft))}(ne),Ea.publish("putResources"),ne.forEach(en),en({resourcesOid:xe,objectOid:Number.MAX_SAFE_INTEGER}),Ea.publish("postPutResources"),b!==null&&(No.oid=rt(),mt("<<"),mt("/Filter /Standard"),mt("/V "+No.v),mt("/R "+No.r),mt("/U <"+No.toHexString(No.U)+">"),mt("/O <"+No.toHexString(No.O)+">"),mt("/P "+No.P),mt(">>"),mt("endobj")),so(),Ss();var ze=pt;return Hu(),Co(),mt("startxref"),mt(""+ze),mt("%%EOF"),er(mr[Le]),Dt.join(`
`)},wc=L.__private__.getBlob=function(ne){return new Blob([$r(ne)],{type:"application/pdf"})},Cl=L.output=L.__private__.output=(Ve=function(ne,ze){switch(typeof(ze=ze||{})=="string"?ze={filename:ze}:ze.filename=ze.filename||"generated.pdf",ne){case void 0:return Ul();case"save":L.save(ze.filename);break;case"arraybuffer":return $r(Ul());case"blob":return wc(Ul());case"bloburi":case"bloburl":if(pa.URL!==void 0&&typeof pa.URL.createObjectURL=="function")return pa.URL&&pa.URL.createObjectURL(wc(Ul()))||void 0;Us.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ft="",Qt=Ul();try{ft=eN(Qt)}catch{ft=eN(unescape(encodeURIComponent(Qt)))}return"data:application/pdf;filename="+ze.filename+";base64,"+ft;case"pdfobjectnewwindow":if(Object.prototype.toString.call(pa)==="[object Window]"){var sr="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Xr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ze.pdfObjectUrl&&(sr=ze.pdfObjectUrl,Xr="");var tr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+sr+'"'+Xr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ze)+");<\/script></body></html>",ri=pa.open();return ri!==null&&ri.document.write(tr),ri}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(pa)==="[object Window]"){var Yn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ze.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ze.filename+'" width="500px" height="400px" /></body></html>',Bi=pa.open();if(Bi!==null){Bi.document.write(Yn);var Si=this;Bi.document.documentElement.querySelector("#pdfViewer").onload=function(){Bi.document.title=ze.filename,Bi.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Si.output("bloburl"))}}return Bi}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(pa)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ga='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ze)+'"></iframe></body></html>',xo=pa.open();if(xo!==null&&(xo.document.write(Ga),xo.document.title=ze.filename),xo||typeof safari>"u")return xo;break;case"datauri":case"dataurl":return pa.document.location.href=this.output("datauristring",ze);default:return null}},Ve.foo=function(){try{return Ve.apply(this,arguments)}catch(ft){var ne=ft.stack||"";~ne.indexOf(" at ")&&(ne=ne.split(" at ")[1]);var ze="Error in function "+ne.split(`
`)[0].split("<")[0]+": "+ft.message;if(!pa.console)throw new Error(ze);pa.console.error(ze,ft),pa.alert&&alert(ze)}},Ve.foo.bar=Ve,Ve.foo),qc=function(ne){return Array.isArray(hr)===!0&&hr.indexOf(ne)>-1};switch(n){case"pt":vi=1;break;case"mm":vi=72/25.4;break;case"cm":vi=72/2.54;break;case"in":vi=72;break;case"px":vi=qc("px_scaling")==1?.75:96/72;break;case"pc":case"em":vi=12;break;case"ex":vi=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);vi=n}var No=null;lt(),bt();var fh=L.__private__.getPageInfo=L.getPageInfo=function(ne){if(isNaN(ne)||ne%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Mi[ne].objId,pageNumber:ne,pageContext:Mi[ne]}},bc=L.__private__.getPageInfoByObjId=function(ne){if(isNaN(ne)||ne%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ze in Mi)if(Mi[ze].objId===ne)break;return fh(ze)},Sl=L.__private__.getCurrentPageInfo=L.getCurrentPageInfo=function(){return{objId:Mi[Le].objId,pageNumber:Le,pageContext:Mi[Le]}};L.addPage=function(){return ha.apply(this,arguments),this},L.setPage=function(){return Ya.apply(this,arguments),er.call(this,mr[Le]),this},L.insertPage=function(ne){return this.addPage(),this.movePage(Le,ne),this},L.movePage=function(ne,ze){var ft,Qt;if(ne>ze){ft=mr[ne],Qt=Mi[ne];for(var sr=ne;sr>ze;sr--)mr[sr]=mr[sr-1],Mi[sr]=Mi[sr-1];mr[ze]=ft,Mi[ze]=Qt,this.setPage(ze)}else if(ne<ze){ft=mr[ne],Qt=Mi[ne];for(var Xr=ne;Xr<ze;Xr++)mr[Xr]=mr[Xr+1],Mi[Xr]=Mi[Xr+1];mr[ze]=ft,Mi[ze]=Qt,this.setPage(ze)}return this},L.deletePage=function(){return sa.apply(this,arguments),this},L.__private__.text=L.text=function(ne,ze,ft,Qt,sr){var Xr,tr,ri,Yn,Bi,Si,Ga,xo,Yr,Un=(Qt=Qt||{}).scope||this;if(typeof ne=="number"&&typeof ze=="number"&&(typeof ft=="string"||Array.isArray(ft))){var oi=ft;ft=ze,ze=ne,ne=oi}if(arguments[3]instanceof _n==0?(ri=arguments[4],Yn=arguments[5],ps(Ga=arguments[3])==="object"&&Ga!==null||(typeof ri=="string"&&(Yn=ri,ri=null),typeof Ga=="string"&&(Yn=Ga,Ga=null),typeof Ga=="number"&&(ri=Ga,Ga=null),Qt={flags:Ga,angle:ri,align:Yn})):(we("The transform parameter of text() with a Matrix value"),Yr=sr),isNaN(ze)||isNaN(ft)||ne==null)throw new Error("Invalid arguments passed to jsPDF.text");if(ne.length===0)return Un;var Ka,Qo="",Oi=typeof Qt.lineHeightFactor=="number"?Qt.lineHeightFactor:ul,qu=Un.internal.scaleFactor;function Af(Wa){return Wa=Wa.split("	").join(Array(Qt.TabLen||9).join(" ")),Sn(Wa,Ga)}function df(Wa){for(var Mo,vs=Wa.concat(),Ts=[],Vs=vs.length;Vs--;)typeof(Mo=vs.shift())=="string"?Ts.push(Mo):Array.isArray(Wa)&&(Mo.length===1||Mo[1]===void 0&&Mo[2]===void 0)?Ts.push(Mo[0]):Ts.push([Mo[0],Mo[1],Mo[2]]);return Ts}function os(Wa,Mo){var vs;if(typeof Wa=="string")vs=Mo(Wa)[0];else if(Array.isArray(Wa)){for(var Ts,Vs,$u=Wa.concat(),eu=[],tu=$u.length;tu--;)typeof(Ts=$u.shift())=="string"?eu.push(Mo(Ts)[0]):Array.isArray(Ts)&&typeof Ts[0]=="string"&&(Vs=Mo(Ts[0],Ts[1],Ts[2]),eu.push([Vs[0],Vs[1],Vs[2]]));vs=eu}return vs}var Qa=!1,cd=!0;if(typeof ne=="string")Qa=!0;else if(Array.isArray(ne)){var Yc=ne.concat();tr=[];for(var ic,_s=Yc.length;_s--;)(typeof(ic=Yc.shift())!="string"||Array.isArray(ic)&&typeof ic[0]!="string")&&(cd=!1);Qa=cd}if(Qa===!1)throw new Error('Type of text must be string or Array. "'+ne+'" is not recognized.');typeof ne=="string"&&(ne=ne.match(/[\r?\n]/)?ne.split(/\r\n|\r|\n/g):[ne]);var xu=an/Un.internal.scaleFactor,Sc=xu*(Oi-1);switch(Qt.baseline){case"bottom":ft-=Sc;break;case"top":ft+=xu-Sc;break;case"hanging":ft+=xu-2*Sc;break;case"middle":ft+=xu/2-Sc}if((Si=Qt.maxWidth||0)>0&&(typeof ne=="string"?ne=Un.splitTextToSize(ne,Si):Object.prototype.toString.call(ne)==="[object Array]"&&(ne=ne.reduce(function(Wa,Mo){return Wa.concat(Un.splitTextToSize(Mo,Si))},[]))),Xr={text:ne,x:ze,y:ft,options:Qt,mutex:{pdfEscape:Sn,activeFontKey:ti,fonts:Gn,activeFontSize:an}},Ea.publish("preProcessText",Xr),ne=Xr.text,ri=(Qt=Xr.options).angle,Yr instanceof _n==0&&ri&&typeof ri=="number"){ri*=Math.PI/180,Qt.rotationDirection===0&&(ri=-ri),se===J&&(ri=-ri);var Qh=Math.cos(ri),zs=Math.sin(ri);Yr=new _n(Qh,zs,-zs,Qh,0,0)}else ri&&ri instanceof _n&&(Yr=ri);se!==J||Yr||(Yr=pe),(Bi=Qt.charSpace||Bc)!==void 0&&(Qo+=De(Ze(Bi))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(xo=Qt.horizontalScale)!==void 0&&(Qo+=De(100*xo)+` Tz
`),Qt.lang;var ss=-1,fl=Qt.renderingMode!==void 0?Qt.renderingMode:Qt.stroke,wu=Un.internal.getCurrentPageInfo().pageContext;switch(fl){case 0:case!1:case"fill":ss=0;break;case 1:case!0:case"stroke":ss=1;break;case 2:case"fillThenStroke":ss=2;break;case 3:case"invisible":ss=3;break;case 4:case"fillAndAddForClipping":ss=4;break;case 5:case"strokeAndAddPathForClipping":ss=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ss=6;break;case 7:case"addToPathForClipping":ss=7}var Xn=wu.usedRenderingMode!==void 0?wu.usedRenderingMode:-1;ss!==-1?Qo+=ss+` Tr
`:Xn!==-1&&(Qo+=`0 Tr
`),ss!==-1&&(wu.usedRenderingMode=ss),Yn=Qt.align||"left";var Rr,jo=an*Oi,bn=Un.internal.pageSize.getWidth(),Ao=Gn[ti];Bi=Qt.charSpace||Bc,Si=Qt.maxWidth||0,Ga=Object.assign({autoencode:!0,noBOM:!0},Qt.flags);var Jc=[],xn=function(Wa){return Un.getStringUnitWidth(Wa,{font:Ao,charSpace:Bi,fontSize:an,doKerning:!1})*an/qu};if(Object.prototype.toString.call(ne)==="[object Array]"){var Qs;tr=df(ne),Yn!=="left"&&(Rr=tr.map(xn));var js,ac=0;if(Yn==="right"){ze-=Rr[0],ne=[],_s=tr.length;for(var Ql=0;Ql<_s;Ql++)Ql===0?(js=hl(ze),Qs=Xc(ft)):(js=Ze(ac-Rr[Ql]),Qs=-jo),ne.push([tr[Ql],js,Qs]),ac=Rr[Ql]}else if(Yn==="center"){ze-=Rr[0]/2,ne=[],_s=tr.length;for(var Zs=0;Zs<_s;Zs++)Zs===0?(js=hl(ze),Qs=Xc(ft)):(js=Ze((ac-Rr[Zs])/2),Qs=-jo),ne.push([tr[Zs],js,Qs]),ac=Rr[Zs]}else if(Yn==="left"){ne=[],_s=tr.length;for(var Hs=0;Hs<_s;Hs++)ne.push(tr[Hs])}else if(Yn==="justify"&&Ao.encoding==="Identity-H"){ne=[],_s=tr.length,Si=Si!==0?Si:bn;for(var bu=0,fa=0;fa<_s;fa++)if(Qs=fa===0?Xc(ft):-jo,js=fa===0?hl(ze):bu,fa<_s-1){var EA=Ze((Si-Rr[fa])/(tr[fa].split(" ").length-1)),ls=tr[fa].split(" ");ne.push([ls[0]+" ",js,Qs]),bu=0;for(var lo=1;lo<ls.length;lo++){var _h=(xn(ls[lo-1]+" "+ls[lo])-xn(ls[lo]))*qu+EA;lo==ls.length-1?ne.push([ls[lo],_h,0]):ne.push([ls[lo]+" ",_h,0]),bu-=_h}}else ne.push([tr[fa],js,Qs]);ne.push(["",bu,0])}else{if(Yn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(ne=[],_s=tr.length,Si=Si!==0?Si:bn,fa=0;fa<_s;fa++)Qs=fa===0?Xc(ft):-jo,js=fa===0?hl(ze):0,fa<_s-1?Jc.push(De(Ze((Si-Rr[fa])/(tr[fa].split(" ").length-1)))):Jc.push(0),ne.push([tr[fa],js,Qs])}}(typeof Qt.R2L=="boolean"?Qt.R2L:Ci)===!0&&(ne=os(ne,function(Wa,Mo,vs){return[Wa.split("").reverse().join(""),Mo,vs]})),Xr={text:ne,x:ze,y:ft,options:Qt,mutex:{pdfEscape:Sn,activeFontKey:ti,fonts:Gn,activeFontSize:an}},Ea.publish("postProcessText",Xr),ne=Xr.text,Ka=Xr.mutex.isHex||!1;var pf=Gn[ti].encoding;pf!=="WinAnsiEncoding"&&pf!=="StandardEncoding"||(ne=os(ne,function(Wa,Mo,vs){return[Af(Wa),Mo,vs]})),tr=df(ne),ne=[];for(var BA,Tc,Ic,oc=Array.isArray(tr[0])?1:0,sc="",Nf=function(Wa,Mo,vs){var Ts="";return vs instanceof _n?(vs=typeof Qt.angle=="number"?Tt(vs,new _n(1,0,0,1,Wa,Mo)):Tt(new _n(1,0,0,1,Wa,Mo),vs),se===J&&(vs=Tt(new _n(1,0,0,-1,0,0),vs)),Ts=vs.join(" ")+` Tm
`):Ts=De(Wa)+" "+De(Mo)+` Td
`,Ts},Il=0;Il<tr.length;Il++){switch(sc="",oc){case 1:Ic=(Ka?"<":"(")+tr[Il][0]+(Ka?">":")"),BA=parseFloat(tr[Il][1]),Tc=parseFloat(tr[Il][2]);break;case 0:Ic=(Ka?"<":"(")+tr[Il]+(Ka?">":")"),BA=hl(ze),Tc=Xc(ft)}Jc!==void 0&&Jc[Il]!==void 0&&(sc=Jc[Il]+` Tw
`),Il===0?ne.push(sc+Nf(BA,Tc,Yr)+Ic):oc===0?ne.push(sc+Ic):oc===1&&ne.push(sc+Nf(BA,Tc,Yr)+Ic)}ne=oc===0?ne.join(` Tj
T* `):ne.join(` Tj
`),ne+=` Tj
`;var Eu=`BT
/`;return Eu+=ti+" "+an+` Tf
`,Eu+=De(an*Oi)+` TL
`,Eu+=tc+`
`,Eu+=Qo,Eu+=ne,mt(Eu+="ET"),M[ti]=!0,Un};var ll=L.__private__.clip=L.clip=function(ne){return mt(ne==="evenodd"?"W*":"W"),this};L.clipEvenOdd=function(){return ll("evenodd")},L.__private__.discardPath=L.discardPath=function(){return mt("n"),this};var cl=L.__private__.isValidStyle=function(ne){var ze=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(ne)!==-1&&(ze=!0),ze};L.__private__.setDefaultPathOperation=L.setDefaultPathOperation=function(ne){return cl(ne)&&(x=ne),this};var Nl=L.__private__.getStyle=L.getStyle=function(ne){var ze=x;switch(ne){case"D":case"S":ze="S";break;case"F":ze="f";break;case"FD":case"DF":ze="B";break;case"f":case"f*":case"B":case"B*":ze=ne}return ze},ma=L.close=function(){return mt("h"),this};L.stroke=function(){return mt("S"),this},L.fill=function(ne){return $c("f",ne),this},L.fillEvenOdd=function(ne){return $c("f*",ne),this},L.fillStroke=function(ne){return $c("B",ne),this},L.fillStrokeEvenOdd=function(ne){return $c("B*",ne),this};var $c=function(ne,ze){ps(ze)==="object"?Ah(ze,ne):mt(ne)},ec=function(ne){ne===null||se===J&&ne===void 0||(ne=Nl(ne),mt(ne))};function Nh(ne,ze,ft,Qt,sr){var Xr=new N_(ze||this.boundingBox,ft||this.xStep,Qt||this.yStep,this.gState,sr||this.matrix);Xr.stream=this.stream;var tr=ne+"$$"+this.cloneIndex+++"$$";return be(tr,Xr),Xr}var Ah=function(ne,ze){var ft=Nn[ne.key],Qt=yi[ft];if(Qt instanceof l0)mt("q"),mt(zh(ze)),Qt.gState&&L.setGState(Qt.gState),mt(ne.matrix.toString()+" cm"),mt("/"+ft+" sh"),mt("Q");else if(Qt instanceof N_){var sr=new _n(1,0,0,-1,0,fo());ne.matrix&&(sr=sr.multiply(ne.matrix||pe),ft=Nh.call(Qt,ne.key,ne.boundingBox,ne.xStep,ne.yStep,sr).id),mt("q"),mt("/Pattern cs"),mt("/"+ft+" scn"),Qt.gState&&L.setGState(Qt.gState),mt(ze),mt("Q")}},zh=function(ne){switch(ne){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},hf=L.moveTo=function(ne,ze){return mt(De(Ze(ne))+" "+De(st(ze))+" m"),this},Vu=L.lineTo=function(ne,ze){return mt(De(Ze(ne))+" "+De(st(ze))+" l"),this},zo=L.curveTo=function(ne,ze,ft,Qt,sr,Xr){return mt([De(Ze(ne)),De(st(ze)),De(Ze(ft)),De(st(Qt)),De(Ze(sr)),De(st(Xr)),"c"].join(" ")),this};L.__private__.line=L.line=function(ne,ze,ft,Qt,sr){if(isNaN(ne)||isNaN(ze)||isNaN(ft)||isNaN(Qt)||!cl(sr))throw new Error("Invalid arguments passed to jsPDF.line");return se===te?this.lines([[ft-ne,Qt-ze]],ne,ze,[1,1],sr||"S"):this.lines([[ft-ne,Qt-ze]],ne,ze,[1,1]).stroke()},L.__private__.lines=L.lines=function(ne,ze,ft,Qt,sr,Xr){var tr,ri,Yn,Bi,Si,Ga,xo,Yr,Un,oi,Ka,Qo;if(typeof ne=="number"&&(Qo=ft,ft=ze,ze=ne,ne=Qo),Qt=Qt||[1,1],Xr=Xr||!1,isNaN(ze)||isNaN(ft)||!Array.isArray(ne)||!Array.isArray(Qt)||!cl(sr)||typeof Xr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(hf(ze,ft),tr=Qt[0],ri=Qt[1],Bi=ne.length,oi=ze,Ka=ft,Yn=0;Yn<Bi;Yn++)(Si=ne[Yn]).length===2?(oi=Si[0]*tr+oi,Ka=Si[1]*ri+Ka,Vu(oi,Ka)):(Ga=Si[0]*tr+oi,xo=Si[1]*ri+Ka,Yr=Si[2]*tr+oi,Un=Si[3]*ri+Ka,oi=Si[4]*tr+oi,Ka=Si[5]*ri+Ka,zo(Ga,xo,Yr,Un,oi,Ka));return Xr&&ma(),ec(sr),this},L.path=function(ne){for(var ze=0;ze<ne.length;ze++){var ft=ne[ze],Qt=ft.c;switch(ft.op){case"m":hf(Qt[0],Qt[1]);break;case"l":Vu(Qt[0],Qt[1]);break;case"c":zo.apply(this,Qt);break;case"h":ma()}}return this},L.__private__.rect=L.rect=function(ne,ze,ft,Qt,sr){if(isNaN(ne)||isNaN(ze)||isNaN(ft)||isNaN(Qt)||!cl(sr))throw new Error("Invalid arguments passed to jsPDF.rect");return se===te&&(Qt=-Qt),mt([De(Ze(ne)),De(st(ze)),De(Ze(ft)),De(Ze(Qt)),"re"].join(" ")),ec(sr),this},L.__private__.triangle=L.triangle=function(ne,ze,ft,Qt,sr,Xr,tr){if(isNaN(ne)||isNaN(ze)||isNaN(ft)||isNaN(Qt)||isNaN(sr)||isNaN(Xr)||!cl(tr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ft-ne,Qt-ze],[sr-ft,Xr-Qt],[ne-sr,ze-Xr]],ne,ze,[1,1],tr,!0),this},L.__private__.roundedRect=L.roundedRect=function(ne,ze,ft,Qt,sr,Xr,tr){if(isNaN(ne)||isNaN(ze)||isNaN(ft)||isNaN(Qt)||isNaN(sr)||isNaN(Xr)||!cl(tr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ri=4/3*(Math.SQRT2-1);return sr=Math.min(sr,.5*ft),Xr=Math.min(Xr,.5*Qt),this.lines([[ft-2*sr,0],[sr*ri,0,sr,Xr-Xr*ri,sr,Xr],[0,Qt-2*Xr],[0,Xr*ri,-sr*ri,Xr,-sr,Xr],[2*sr-ft,0],[-sr*ri,0,-sr,-Xr*ri,-sr,-Xr],[0,2*Xr-Qt],[0,-Xr*ri,sr*ri,-Xr,sr,-Xr]],ne+sr,ze,[1,1],tr,!0),this},L.__private__.ellipse=L.ellipse=function(ne,ze,ft,Qt,sr){if(isNaN(ne)||isNaN(ze)||isNaN(ft)||isNaN(Qt)||!cl(sr))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Xr=4/3*(Math.SQRT2-1)*ft,tr=4/3*(Math.SQRT2-1)*Qt;return hf(ne+ft,ze),zo(ne+ft,ze-tr,ne+Xr,ze-Qt,ne,ze-Qt),zo(ne-Xr,ze-Qt,ne-ft,ze-tr,ne-ft,ze),zo(ne-ft,ze+tr,ne-Xr,ze+Qt,ne,ze+Qt),zo(ne+Xr,ze+Qt,ne+ft,ze+tr,ne+ft,ze),ec(sr),this},L.__private__.circle=L.circle=function(ne,ze,ft,Qt){if(isNaN(ne)||isNaN(ze)||isNaN(ft)||!cl(Qt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(ne,ze,ft,ft,Qt)},L.setFont=function(ne,ze,ft){return ft&&(ze=Be(ze,ft)),ti=es(ne,ze,{disableWarning:!1}),this};var zl=L.__private__.getFont=L.getFont=function(){return Gn[es.apply(L,arguments)]};L.__private__.getFontList=L.getFontList=function(){var ne,ze,ft={};for(ne in Li)if(Li.hasOwnProperty(ne))for(ze in ft[ne]=[],Li[ne])Li[ne].hasOwnProperty(ze)&&ft[ne].push(ze);return ft},L.addFont=function(ne,ze,ft,Qt,sr){var Xr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Xr.indexOf(arguments[3])!==-1?sr=arguments[3]:arguments[3]&&Xr.indexOf(arguments[3])==-1&&(ft=Be(ft,Qt)),Kn.call(this,ne,ze,ft,sr=sr||"Identity-H")};var ul,Tl=e.lineWidth||.200025,Hi=L.__private__.getLineWidth=L.getLineWidth=function(){return Tl},ff=L.__private__.setLineWidth=L.setLineWidth=function(ne){return Tl=ne,mt(De(Ze(ne))+" w"),this};L.__private__.setLineDash=Qi.API.setLineDash=Qi.API.setLineDashPattern=function(ne,ze){if(ne=ne||[],ze=ze||0,isNaN(ze)||!Array.isArray(ne))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return ne=ne.map(function(ft){return De(Ze(ft))}).join(" "),ze=De(Ze(ze)),mt("["+ne+"] "+ze+" d"),this};var Ec=L.__private__.getLineHeight=L.getLineHeight=function(){return an*ul};L.__private__.getLineHeight=L.getLineHeight=function(){return an*ul};var Ui=L.__private__.setLineHeightFactor=L.setLineHeightFactor=function(ne){return typeof(ne=ne||1.15)=="number"&&(ul=ne),this},kf=L.__private__.getLineHeightFactor=L.getLineHeightFactor=function(){return ul};Ui(e.lineHeight);var hl=L.__private__.getHorizontalCoordinate=function(ne){return Ze(ne)},Xc=L.__private__.getVerticalCoordinate=function(ne){return se===J?ne:Mi[Le].mediaBox.topRightY-Mi[Le].mediaBox.bottomLeftY-Ze(ne)},Kd=L.__private__.getHorizontalCoordinateString=L.getHorizontalCoordinateString=function(ne){return De(hl(ne))},dh=L.__private__.getVerticalCoordinateString=L.getVerticalCoordinateString=function(ne){return De(Xc(ne))},Zc=e.strokeColor||"0 G";L.__private__.getStrokeColor=L.getDrawColor=function(){return Ne(Zc)},L.__private__.setStrokeColor=L.setDrawColor=function(ne,ze,ft,Qt){return Zc=Oe({ch1:ne,ch2:ze,ch3:ft,ch4:Qt,pdfColorType:"draw",precision:2}),mt(Zc),this};var _u=e.fillColor||"0 g";L.__private__.getFillColor=L.getFillColor=function(){return Ne(_u)},L.__private__.setFillColor=L.setFillColor=function(ne,ze,ft,Qt){return _u=Oe({ch1:ne,ch2:ze,ch3:ft,ch4:Qt,pdfColorType:"fill",precision:2}),mt(_u),this};var tc=e.textColor||"0 g",Gu=L.__private__.getTextColor=L.getTextColor=function(){return Ne(tc)};L.__private__.setTextColor=L.setTextColor=function(ne,ze,ft,Qt){return tc=Oe({ch1:ne,ch2:ze,ch3:ft,ch4:Qt,pdfColorType:"text",precision:3}),this};var Bc=e.charSpace,Uf=L.__private__.getCharSpace=L.getCharSpace=function(){return parseFloat(Bc||0)};L.__private__.setCharSpace=L.setCharSpace=function(ne){if(isNaN(ne))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Bc=ne,this};var ph=0;L.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},L.__private__.setLineCap=L.setLineCap=function(ne){var ze=L.CapJoinStyles[ne];if(ze===void 0)throw new Error("Line cap style of '"+ne+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ph=ze,mt(ze+" J"),this};var Ku=0;L.__private__.setLineJoin=L.setLineJoin=function(ne){var ze=L.CapJoinStyles[ne];if(ze===void 0)throw new Error("Line join style of '"+ne+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ku=ze,mt(ze+" j"),this},L.__private__.setLineMiterLimit=L.__private__.setMiterLimit=L.setLineMiterLimit=L.setMiterLimit=function(ne){if(ne=ne||0,isNaN(ne))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return mt(De(Ze(ne))+" M"),this},L.GState=ub,L.setGState=function(ne){(ne=typeof ne=="string"?ki[oo[ne]]:mh(null,ne)).equals(wa)||(mt("/"+ne.id+" gs"),wa=ne)};var mh=function(ne,ze){if(!ne||!oo[ne]){var ft=!1;for(var Qt in ki)if(ki.hasOwnProperty(Qt)&&ki[Qt].equals(ze)){ft=!0;break}if(ft)ze=ki[Qt];else{var sr="GS"+(Object.keys(ki).length+1).toString(10);ki[sr]=ze,ze.id=sr}return ne&&(oo[ne]=ze.id),Ea.publish("addGState",ze),ze}};L.addGState=function(ne,ze){return mh(ne,ze),this},L.saveGraphicsState=function(){return mt("q"),xa.push({key:ti,size:an,color:tc}),this},L.restoreGraphicsState=function(){mt("Q");var ne=xa.pop();return ti=ne.key,an=ne.size,tc=ne.color,wa=null,this},L.setCurrentTransformationMatrix=function(ne){return mt(ne.toString()+" cm"),this},L.comment=function(ne){return mt("#"+ne),this};var Cc=function(ne,ze){var ft=ne||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ft},set:function(Xr){isNaN(Xr)||(ft=parseFloat(Xr))}});var Qt=ze||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Qt},set:function(Xr){isNaN(Xr)||(Qt=parseFloat(Xr))}});var sr="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return sr},set:function(Xr){sr=Xr.toString()}}),this},vu=function(ne,ze,ft,Qt){Cc.call(this,ne,ze),this.type="rect";var sr=ft||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return sr},set:function(tr){isNaN(tr)||(sr=parseFloat(tr))}});var Xr=Qt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Xr},set:function(tr){isNaN(tr)||(Xr=parseFloat(tr))}}),this},rc=function(){this.page=ba,this.currentPage=Le,this.pages=mr.slice(0),this.pagesContext=Mi.slice(0),this.x=Dn,this.y=ua,this.matrix=ca,this.width=gh(Le),this.height=fo(Le),this.outputDestination=sn,this.id="",this.objectNumber=-1};rc.prototype.restore=function(){ba=this.page,Le=this.currentPage,Mi=this.pagesContext,mr=this.pages,Dn=this.x,ua=this.y,ca=this.matrix,yu(Le,this.width),nc(Le,this.height),sn=this.outputDestination};var ts=function(ne,ze,ft,Qt,sr){sl.push(new rc),ba=Le=0,mr=[],Dn=ne,ua=ze,ca=sr,Ii([ft,Qt])};for(var Wu in L.beginFormObject=function(ne,ze,ft,Qt,sr){return ts(ne,ze,ft,Qt,sr),this},L.endFormObject=function(ne){return function(ze){if(xc[ze])sl.pop().restore();else{var ft=new rc,Qt="Xo"+(Object.keys(Bo).length+1).toString(10);ft.id=Qt,xc[ze]=Qt,Bo[Qt]=ft,Ea.publish("addFormObject",ft),sl.pop().restore()}}(ne),this},L.doFormObject=function(ne,ze){var ft=Bo[xc[ne]];return mt("q"),mt(ze.toString()+" cm"),mt("/"+ft.id+" Do"),mt("Q"),this},L.getFormObject=function(ne){var ze=Bo[xc[ne]];return{x:ze.x,y:ze.y,width:ze.width,height:ze.height,matrix:ze.matrix}},L.save=function(ne,ze){return ne=ne||"generated.pdf",(ze=ze||{}).returnPromise=ze.returnPromise||!1,ze.returnPromise===!1?(o0(wc(Ul()),ne),typeof o0.unload=="function"&&pa.setTimeout&&setTimeout(o0.unload,911),this):new Promise(function(ft,Qt){try{var sr=o0(wc(Ul()),ne);typeof o0.unload=="function"&&pa.setTimeout&&setTimeout(o0.unload,911),ft(sr)}catch(Xr){Qt(Xr.message)}})},Qi.API)Qi.API.hasOwnProperty(Wu)&&(Wu==="events"&&Qi.API.events.length?function(ne,ze){var ft,Qt,sr;for(sr=ze.length-1;sr!==-1;sr--)ft=ze[sr][0],Qt=ze[sr][1],ne.subscribe.apply(ne,[ft].concat(typeof Qt=="function"?[Qt]:Qt))}(Ea,Qi.API.events):L[Wu]=Qi.API[Wu]);var gh=L.getPageWidth=function(ne){return(Mi[ne=ne||Le].mediaBox.topRightX-Mi[ne].mediaBox.bottomLeftX)/vi},yu=L.setPageWidth=function(ne,ze){Mi[ne].mediaBox.topRightX=ze*vi+Mi[ne].mediaBox.bottomLeftX},fo=L.getPageHeight=function(ne){return(Mi[ne=ne||Le].mediaBox.topRightY-Mi[ne].mediaBox.bottomLeftY)/vi},nc=L.setPageHeight=function(ne,ze){Mi[ne].mediaBox.topRightY=ze*vi+Mi[ne].mediaBox.bottomLeftY};return L.internal={pdfEscape:Sn,getStyle:Nl,getFont:zl,getFontSize:yn,getCharSpace:Uf,getTextColor:Gu,getLineHeight:Ec,getLineHeightFactor:kf,getLineWidth:Hi,write:En,getHorizontalCoordinate:hl,getVerticalCoordinate:Xc,getCoordinateString:Kd,getVerticalCoordinateString:dh,collections:{},newObject:rt,newAdditionalObject:Ee,newObjectDeferred:je,newObjectDeferredBegin:oe,getFilters:St,putStream:Ht,events:Ea,scaleFactor:vi,pageSize:{getWidth:function(){return gh(Le)},setWidth:function(ne){yu(Le,ne)},getHeight:function(){return fo(Le)},setHeight:function(ne){nc(Le,ne)}},encryptionOptions:b,encryption:No,getEncryptor:function(ne){return b!==null?No.encryptor(ne,0):function(ze){return ze}},output:Cl,getNumberOfPages:Ra,pages:mr,out:mt,f2:_e,f3:Ie,getPageInfo:fh,getPageInfoByObjId:bc,getCurrentPageInfo:Sl,getPDFVersion:R,Point:Cc,Rectangle:vu,Matrix:_n,hasHotfix:qc},Object.defineProperty(L.internal.pageSize,"width",{get:function(){return gh(Le)},set:function(ne){yu(Le,ne)},enumerable:!0,configurable:!0}),Object.defineProperty(L.internal.pageSize,"height",{get:function(){return fo(Le)},set:function(ne){nc(Le,ne)},enumerable:!0,configurable:!0}),(function(ne){for(var ze=0,ft=zn.length;ze<ft;ze++){var Qt=Kn.call(this,ne[ze][0],ne[ze][1],ne[ze][2],zn[ze][3],!0);I===!1&&(M[Qt]=!0);var sr=ne[ze][0].split("-");Vn({id:Qt,fontName:sr[0],fontStyle:sr[1]||""})}Ea.publish("addFonts",{fonts:Gn,dictionary:Li})}).call(L,zn),ti="F1",ha(l,r),Ea.publish("initialized"),L}P_.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},P_.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},P_.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},P_.prototype.processOwnerPassword=function(e,t){return C5(B5(t).substr(0,5),e)},P_.prototype.encryptor=function(e,t){var r=B5(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return C5(r,n)}},ub.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||ps(e)!==ps(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Qi.API={events:[]},Qi.version="3.0.2";var Xl=Qi.API,bF=1,V0=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},w_=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ia=function(e){return e.toFixed(2)},ug=function(e){return e.toFixed(5)};Xl.__acroform__={};var Df=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},iN=function(e){return e*bF},Ep=function(e){var t=new UV,r=wi.internal.getHeight(e)||0,n=wi.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Ia(n)),Number(Ia(r))],t},v1e=Xl.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},y1e=Xl.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},x1e=Xl.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},mc=Xl.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return x1e(e,t-1)},gc=Xl.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return v1e(e,t-1)},_c=Xl.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return y1e(e,t-1)},w1e=Xl.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,l=e[0],u=e[1],d=e[2],a=e[3],v={};return v.lowerLeft_X=r(l)||0,v.lowerLeft_Y=n(u+a)||0,v.upperRight_X=r(l+d)||0,v.upperRight_Y=n(u)||0,[Number(Ia(v.lowerLeft_X)),Number(Ia(v.lowerLeft_Y)),Number(Ia(v.upperRight_X)),Number(Ia(v.upperRight_Y))]},b1e=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=S5(e,r),l=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+l+" "+Ia(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var u=Ep(e);return u.scope=e.scope,u.stream=t.join(`
`),u}},S5=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},l=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");l=e.multiline?l.map(function(_e){return _e.split(`
`)}):l.map(function(_e){return[_e]});var u=r,d=wi.internal.getHeight(e)||0;d=d<0?-d:d;var a=wi.internal.getWidth(e)||0;a=a<0?-a:a;var v=function(_e,Ie,Ze){if(_e+1<l.length){var st=Ie+" "+l[_e+1][0];return ww(st,e,Ze).width<=a-4}return!1};u++;e:for(;u>0;){t="",u--;var x,b,I=ww("3",e,u).height,M=e.multiline?d-u:(d-I)/2,L=M+=2,U=0,R=0,H=0;if(u<=0){t=`(...) Tj
`,t+="% Width of Text: "+ww(t,e,u=12).width+", FieldWidth:"+a+`
`;break}for(var q="",te=0,J=0;J<l.length;J++)if(l.hasOwnProperty(J)){var se=!1;if(l[J].length!==1&&H!==l[J].length-1){if((I+2)*(te+2)+2>d)continue e;q+=l[J][H],se=!0,R=J,J--}else{q=(q+=l[J][H]+" ").substr(q.length-1)==" "?q.substr(0,q.length-1):q;var ye=parseInt(J),Se=v(ye,q,u),Be=J>=l.length-1;if(Se&&!Be){q+=" ",H=0;continue}if(Se||Be){if(Be)R=ye;else if(e.multiline&&(I+2)*(te+2)+2>d)continue e}else{if(!e.multiline||(I+2)*(te+2)+2>d)continue e;R=ye}}for(var De="",we=U;we<=R;we++){var nt=l[we];if(e.multiline){if(we===R){De+=nt[H]+" ",H=(H+1)%nt.length;continue}if(we===U){De+=nt[nt.length-1]+" ";continue}}De+=nt[0]+" "}switch(De=De.substr(De.length-1)==" "?De.substr(0,De.length-1):De,b=ww(De,e,u).width,e.textAlign){case"right":x=a-b-2;break;case"center":x=(a-b)/2;break;default:x=2}t+=Ia(x)+" "+Ia(L)+` Td
`,t+="("+V0(De)+`) Tj
`,t+=-Ia(x)+` 0 Td
`,L=-(u+2),b=0,U=se?R:R+1,te++,q=""}break}return n.text=t,n.fontSize=u,n},ww=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),l=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:l}},E1e={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},B1e=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},C1e=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Hd.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(E1e)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");bF=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new NV,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var l in n)if(n.hasOwnProperty(l)){var u=n[l];u.objId=void 0,u.hasAnnotation&&B1e(u,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,l){var u=!n;for(var d in n||(l.internal.newObjectDeferredBegin(l.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),l.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||l.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(d)){var a=n[d],v=[],x=a.Rect;if(a.Rect&&(a.Rect=w1e(a.Rect,l)),l.internal.newObjectDeferredBegin(a.objId,!0),a.DA=wi.createDefaultAppearanceStream(a),ps(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(v=a.getKeyValueListForStream()),a.Rect=x,a.hasAppearanceStream&&!a.appearanceStreamContent){var b=b1e(a);v.push({key:"AP",value:"<</N "+b+">>"}),l.internal.acroformPlugin.xForms.push(b)}if(a.appearanceStreamContent){var I="";for(var M in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(M)){var L=a.appearanceStreamContent[M];if(I+="/"+M+" ",I+="<<",Object.keys(L).length>=1||Array.isArray(L)){for(var d in L)if(L.hasOwnProperty(d)){var U=L[d];typeof U=="function"&&(U=U.call(l,a)),I+="/"+d+" "+U+" ",l.internal.acroformPlugin.xForms.indexOf(U)>=0||l.internal.acroformPlugin.xForms.push(U)}}else typeof(U=L)=="function"&&(U=U.call(l,a)),I+="/"+d+" "+U,l.internal.acroformPlugin.xForms.indexOf(U)>=0||l.internal.acroformPlugin.xForms.push(U);I+=">>"}v.push({key:"AP",value:`<<
`+I+">>"})}l.internal.putStream({additionalKeyValues:v,objectId:a.objId}),l.internal.out("endobj")}u&&function(R,H){for(var q in R)if(R.hasOwnProperty(q)){var te=q,J=R[q];H.internal.newObjectDeferredBegin(J.objId,!0),ps(J)==="object"&&typeof J.putStream=="function"&&J.putStream(),delete R[te]}}(l.internal.acroformPlugin.xForms,l)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},kV=Xl.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(d){return d};if(Array.isArray(e)){for(var l="[",u=0;u<e.length;u++)switch(u!==0&&(l+=" "),ps(e[u])){case"boolean":case"number":case"object":l+=e[u].toString();break;case"string":e[u].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),l+="("+V0(n(e[u].toString()))+")"):l+=e[u].toString()}return l+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},qS=function(e,t,r){var n=function(l){return l};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+V0(n(e))+")"},Cp=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Cp.prototype.toString=function(){return this.objId+" 0 R"},Cp.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Cp.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(u){return u!="content"&&u!="appearanceStreamContent"&&u!="scope"&&u!="objId"&&u.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],l=this[n];l&&(Array.isArray(l)?e.push({key:n,value:kV(l,this.objId,this.scope)}):l instanceof Cp?(l.scope=this.scope,e.push({key:n,value:l.objId+" 0 R"})):typeof l!="function"&&e.push({key:n,value:l}))}return e};var UV=function(){Cp.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Df(UV,Cp);var NV=function(){Cp.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+V0(r(e))+")"}},set:function(r){e=r}})};Df(NV,Cp);var Hd=function e(){Cp.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(q){if(isNaN(q))throw new Error('Invalid value "'+q+'" for attribute F supplied.');t=q}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!mc(t,3)},set:function(q){q?this.F=gc(t,3):this.F=_c(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(q){if(isNaN(q))throw new Error('Invalid value "'+q+'" for attribute Ff supplied.');r=q}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(q){n=q!==void 0?q:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(q){n[0]=q}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(q){n[1]=q}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(q){n[2]=q}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(q){n[3]=q}});var l="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return l},set:function(q){switch(q){case"/Btn":case"/Tx":case"/Ch":case"/Sig":l=q;break;default:throw new Error('Invalid value "'+q+'" for attribute FT supplied.')}}});var u=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!u||u.length<1){if(this instanceof hb)return;u="FieldObject"+e.FieldNum++}var q=function(te){return te};return this.scope&&(q=this.scope.internal.getEncryptor(this.objId)),"("+V0(q(u))+")"},set:function(q){u=q.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return u},set:function(q){u=q}});var d="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return d},set:function(q){d=q}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(q){a=q}});var v=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return v},set:function(q){v=q}});var x=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return x===void 0?50/bF:x},set:function(q){x=q}});var b="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return b},set:function(q){b=q}});var I="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!I||this instanceof hb||this instanceof x0))return qS(I,this.objId,this.scope)},set:function(q){q=q.toString(),I=q}});var M=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(M)return this instanceof Uu==0?qS(M,this.objId,this.scope):M},set:function(q){q=q.toString(),M=this instanceof Uu==0?q.substr(0,1)==="("?w_(q.substr(1,q.length-2)):w_(q):q}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Uu==1?w_(M.substr(1,M.length-1)):M},set:function(q){q=q.toString(),M=this instanceof Uu==1?"/"+q:q}});var L=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(L)return L},set:function(q){this.V=q}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(L)return this instanceof Uu==0?qS(L,this.objId,this.scope):L},set:function(q){q=q.toString(),L=this instanceof Uu==0?q.substr(0,1)==="("?w_(q.substr(1,q.length-2)):w_(q):q}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Uu==1?w_(L.substr(1,L.length-1)):L},set:function(q){q=q.toString(),L=this instanceof Uu==1?"/"+q:q}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var U,R=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return R},set:function(q){q=!!q,R=q}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(U)return U},set:function(q){U=q}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,1)},set:function(q){q?this.Ff=gc(this.Ff,1):this.Ff=_c(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,2)},set:function(q){q?this.Ff=gc(this.Ff,2):this.Ff=_c(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,3)},set:function(q){q?this.Ff=gc(this.Ff,3):this.Ff=_c(this.Ff,3)}});var H=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(H!==null)return H},set:function(q){if([0,1,2].indexOf(q)===-1)throw new Error('Invalid value "'+q+'" for attribute Q supplied.');H=q}}),Object.defineProperty(this,"textAlign",{get:function(){var q;switch(H){case 0:default:q="left";break;case 1:q="center";break;case 2:q="right"}return q},configurable:!0,enumerable:!0,set:function(q){switch(q){case"right":case 2:H=2;break;case"center":case 1:H=1;break;default:H=0}}})};Df(Hd,Cp);var W_=function(){Hd.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return kV(t,this.objId,this.scope)},set:function(r){var n,l;l=[],typeof(n=r)=="string"&&(l=function(u,d,a){a||(a=1);for(var v,x=[];v=d.exec(u);)x.push(v[a]);return x}(n,/\((.*?)\)/g)),t=l}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,18)},set:function(r){r?this.Ff=gc(this.Ff,18):this.Ff=_c(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=gc(this.Ff,19):this.Ff=_c(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,20)},set:function(r){r?(this.Ff=gc(this.Ff,20),t.sort()):this.Ff=_c(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,22)},set:function(r){r?this.Ff=gc(this.Ff,22):this.Ff=_c(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,23)},set:function(r){r?this.Ff=gc(this.Ff,23):this.Ff=_c(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,27)},set:function(r){r?this.Ff=gc(this.Ff,27):this.Ff=_c(this.Ff,27)}}),this.hasAppearanceStream=!1};Df(W_,Hd);var q_=function(){W_.call(this),this.fontName="helvetica",this.combo=!1};Df(q_,W_);var $_=function(){q_.call(this),this.combo=!0};Df($_,q_);var t2=function(){$_.call(this),this.edit=!0};Df(t2,$_);var Uu=function(){Hd.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,15)},set:function(r){r?this.Ff=gc(this.Ff,15):this.Ff=_c(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,16)},set:function(r){r?this.Ff=gc(this.Ff,16):this.Ff=_c(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,17)},set:function(r){r?this.Ff=gc(this.Ff,17):this.Ff=_c(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,26)},set:function(r){r?this.Ff=gc(this.Ff,26):this.Ff=_c(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(u){return u};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,l=[];for(n in l.push("<<"),t)l.push("/"+n+" ("+V0(r(t[n]))+")");return l.push(">>"),l.join(`
`)}},set:function(r){ps(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Df(Uu,Hd);var r2=function(){Uu.call(this),this.pushButton=!0};Df(r2,Uu);var X_=function(){Uu.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Df(X_,Uu);var hb=function(){var e,t;Hd.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(l){e=l}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(l){t=l}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var l=function(a){return a};this.scope&&(l=this.scope.internal.getEncryptor(this.objId));var u,d=[];for(u in d.push("<<"),n)d.push("/"+u+" ("+V0(l(n[u]))+")");return d.push(">>"),d.join(`
`)},set:function(l){ps(l)==="object"&&(n=l)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(l){typeof l=="string"&&(n.CA=l)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(l){r=l}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(l){r="/"+l}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=wi.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Df(hb,Hd),X_.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},X_.prototype.createOption=function(e){var t=new hb;return t.Parent=this,t.optionName=e,this.Kids.push(t),S1e.call(this.scope,t),t};var n2=function(){Uu.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=wi.CheckBox.createAppearanceStream()};Df(n2,Uu);var x0=function(){Hd.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,13)},set:function(t){t?this.Ff=gc(this.Ff,13):this.Ff=_c(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,21)},set:function(t){t?this.Ff=gc(this.Ff,21):this.Ff=_c(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,23)},set:function(t){t?this.Ff=gc(this.Ff,23):this.Ff=_c(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,24)},set:function(t){t?this.Ff=gc(this.Ff,24):this.Ff=_c(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,25)},set:function(t){t?this.Ff=gc(this.Ff,25):this.Ff=_c(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,26)},set:function(t){t?this.Ff=gc(this.Ff,26):this.Ff=_c(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Df(x0,Hd);var i2=function(){x0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!mc(this.Ff,14)},set:function(e){e?this.Ff=gc(this.Ff,14):this.Ff=_c(this.Ff,14)}}),this.password=!0};Df(i2,x0);var wi={CheckBox:{createAppearanceStream:function(){return{N:{On:wi.CheckBox.YesNormal},D:{On:wi.CheckBox.YesPushDown,Off:wi.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ep(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,l=e.scope.__private__.encodeColorString(e.color),u=S5(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Ia(wi.internal.getWidth(e))+" "+Ia(wi.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Ia(u.fontSize)+" Tf "+l),r.push("BT"),r.push(u.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Ep(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),l=[],u=wi.internal.getHeight(e),d=wi.internal.getWidth(e),a=S5(e,e.caption);return l.push("1 g"),l.push("0 0 "+Ia(d)+" "+Ia(u)+" re"),l.push("f"),l.push("q"),l.push("0 0 1 rg"),l.push("0 0 "+Ia(d-1)+" "+Ia(u-1)+" re"),l.push("W"),l.push("n"),l.push("0 g"),l.push("BT"),l.push("/"+r+" "+Ia(a.fontSize)+" Tf "+n),l.push(a.text),l.push("ET"),l.push("Q"),t.stream=l.join(`
`),t},OffPushDown:function(e){var t=Ep(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ia(wi.internal.getWidth(e))+" "+Ia(wi.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:wi.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=wi.RadioButton.Circle.YesNormal,t.D[e]=wi.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ep(e);t.scope=e.scope;var r=[],n=wi.internal.getWidth(e)<=wi.internal.getHeight(e)?wi.internal.getWidth(e)/4:wi.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var l=wi.internal.Bezier_C,u=Number((n*l).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+ug(wi.internal.getWidth(e)/2)+" "+ug(wi.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+u+" "+u+" "+n+" 0 "+n+" c"),r.push("-"+u+" "+n+" -"+n+" "+u+" -"+n+" 0 c"),r.push("-"+n+" -"+u+" -"+u+" -"+n+" 0 -"+n+" c"),r.push(u+" -"+n+" "+n+" -"+u+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ep(e);t.scope=e.scope;var r=[],n=wi.internal.getWidth(e)<=wi.internal.getHeight(e)?wi.internal.getWidth(e)/4:wi.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var l=Number((2*n).toFixed(5)),u=Number((l*wi.internal.Bezier_C).toFixed(5)),d=Number((n*wi.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ug(wi.internal.getWidth(e)/2)+" "+ug(wi.internal.getHeight(e)/2)+" cm"),r.push(l+" 0 m"),r.push(l+" "+u+" "+u+" "+l+" 0 "+l+" c"),r.push("-"+u+" "+l+" -"+l+" "+u+" -"+l+" 0 c"),r.push("-"+l+" -"+u+" -"+u+" -"+l+" 0 -"+l+" c"),r.push(u+" -"+l+" "+l+" -"+u+" "+l+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+ug(wi.internal.getWidth(e)/2)+" "+ug(wi.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+d+" "+d+" "+n+" 0 "+n+" c"),r.push("-"+d+" "+n+" -"+n+" "+d+" -"+n+" 0 c"),r.push("-"+n+" -"+d+" -"+d+" -"+n+" 0 -"+n+" c"),r.push(d+" -"+n+" "+n+" -"+d+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Ep(e);t.scope=e.scope;var r=[],n=wi.internal.getWidth(e)<=wi.internal.getHeight(e)?wi.internal.getWidth(e)/4:wi.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var l=Number((2*n).toFixed(5)),u=Number((l*wi.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ug(wi.internal.getWidth(e)/2)+" "+ug(wi.internal.getHeight(e)/2)+" cm"),r.push(l+" 0 m"),r.push(l+" "+u+" "+u+" "+l+" 0 "+l+" c"),r.push("-"+u+" "+l+" -"+l+" "+u+" -"+l+" 0 c"),r.push("-"+l+" -"+u+" -"+u+" -"+l+" 0 -"+l+" c"),r.push(u+" -"+l+" "+l+" -"+u+" "+l+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:wi.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=wi.RadioButton.Cross.YesNormal,t.D[e]=wi.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ep(e);t.scope=e.scope;var r=[],n=wi.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Ia(wi.internal.getWidth(e)-2)+" "+Ia(wi.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Ia(n.x1.x)+" "+Ia(n.x1.y)+" m"),r.push(Ia(n.x2.x)+" "+Ia(n.x2.y)+" l"),r.push(Ia(n.x4.x)+" "+Ia(n.x4.y)+" m"),r.push(Ia(n.x3.x)+" "+Ia(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ep(e);t.scope=e.scope;var r=wi.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ia(wi.internal.getWidth(e))+" "+Ia(wi.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ia(wi.internal.getWidth(e)-2)+" "+Ia(wi.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Ia(r.x1.x)+" "+Ia(r.x1.y)+" m"),n.push(Ia(r.x2.x)+" "+Ia(r.x2.y)+" l"),n.push(Ia(r.x4.x)+" "+Ia(r.x4.y)+" m"),n.push(Ia(r.x3.x)+" "+Ia(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Ep(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ia(wi.internal.getWidth(e))+" "+Ia(wi.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};wi.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=wi.internal.getWidth(e),r=wi.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},wi.internal.getWidth=function(e){var t=0;return ps(e)==="object"&&(t=iN(e.Rect[2])),t},wi.internal.getHeight=function(e){var t=0;return ps(e)==="object"&&(t=iN(e.Rect[3])),t};var S1e=Xl.addField=function(e){if(C1e(this,e),!(e instanceof Hd))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Xl.AcroFormChoiceField=W_,Xl.AcroFormListBox=q_,Xl.AcroFormComboBox=$_,Xl.AcroFormEditBox=t2,Xl.AcroFormButton=Uu,Xl.AcroFormPushButton=r2,Xl.AcroFormRadioButton=X_,Xl.AcroFormCheckBox=n2,Xl.AcroFormTextField=x0,Xl.AcroFormPasswordField=i2,Xl.AcroFormAppearance=wi,Xl.AcroForm={ChoiceField:W_,ListBox:q_,ComboBox:$_,EditBox:t2,Button:Uu,PushButton:r2,RadioButton:X_,CheckBox:n2,TextField:x0,PasswordField:i2,Appearance:wi},Qi.AcroForm={ChoiceField:W_,ListBox:q_,ComboBox:$_,EditBox:t2,Button:Uu,PushButton:r2,RadioButton:X_,CheckBox:n2,TextField:x0,PasswordField:i2,Appearance:wi};Qi.AcroForm;function zV(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},l=e.__addimage__.getImageFileTypeByImageData=function(_e,Ie){var Ze,st,Et,Ut,jt,bt=r;if((Ie=Ie||r)==="RGBA"||_e.data!==void 0&&_e.data instanceof Uint8ClampedArray&&"height"in _e&&"width"in _e)return"RGBA";if(Se(_e))for(jt in n)for(Et=n[jt],Ze=0;Ze<Et.length;Ze+=1){for(Ut=!0,st=0;st<Et[Ze].length;st+=1)if(Et[Ze][st]!==void 0&&Et[Ze][st]!==_e[st]){Ut=!1;break}if(Ut===!0){bt=jt;break}}else for(jt in n)for(Et=n[jt],Ze=0;Ze<Et.length;Ze+=1){for(Ut=!0,st=0;st<Et[Ze].length;st+=1)if(Et[Ze][st]!==void 0&&Et[Ze][st]!==_e.charCodeAt(st)){Ut=!1;break}if(Ut===!0){bt=jt;break}}return bt===r&&Ie!==r&&(bt=Ie),bt},u=function _e(Ie){for(var Ze=this.internal.write,st=this.internal.putStream,Et=(0,this.internal.getFilters)();Et.indexOf("FlateEncode")!==-1;)Et.splice(Et.indexOf("FlateEncode"),1);Ie.objectId=this.internal.newObject();var Ut=[];if(Ut.push({key:"Type",value:"/XObject"}),Ut.push({key:"Subtype",value:"/Image"}),Ut.push({key:"Width",value:Ie.width}),Ut.push({key:"Height",value:Ie.height}),Ie.colorSpace===q.INDEXED?Ut.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(Ie.palette.length/3-1)+" "+("sMask"in Ie&&Ie.sMask!==void 0?Ie.objectId+2:Ie.objectId+1)+" 0 R]"}):(Ut.push({key:"ColorSpace",value:"/"+Ie.colorSpace}),Ie.colorSpace===q.DEVICE_CMYK&&Ut.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Ut.push({key:"BitsPerComponent",value:Ie.bitsPerComponent}),"decodeParameters"in Ie&&Ie.decodeParameters!==void 0&&Ut.push({key:"DecodeParms",value:"<<"+Ie.decodeParameters+">>"}),"transparency"in Ie&&Array.isArray(Ie.transparency)){for(var jt="",bt=0,Nt=Ie.transparency.length;bt<Nt;bt++)jt+=Ie.transparency[bt]+" "+Ie.transparency[bt]+" ";Ut.push({key:"Mask",value:"["+jt+"]"})}Ie.sMask!==void 0&&Ut.push({key:"SMask",value:Ie.objectId+1+" 0 R"});var ar=Ie.filter!==void 0?["/"+Ie.filter]:void 0;if(st({data:Ie.data,additionalKeyValues:Ut,alreadyAppliedFilters:ar,objectId:Ie.objectId}),Ze("endobj"),"sMask"in Ie&&Ie.sMask!==void 0){var lt=(Ie.predictor!=null?"/Predictor "+Ie.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+Ie.width,ie={width:Ie.width,height:Ie.height,colorSpace:"DeviceGray",bitsPerComponent:Ie.bitsPerComponent,decodeParameters:lt,data:Ie.sMask};"filter"in Ie&&(ie.filter=Ie.filter),_e.call(this,ie)}if(Ie.colorSpace===q.INDEXED){var Le=this.internal.newObject();st({data:De(new Uint8Array(Ie.palette)),objectId:Le}),Ze("endobj")}},d=function(){var _e=this.internal.collections[t+"images"];for(var Ie in _e)u.call(this,_e[Ie])},a=function(){var _e,Ie=this.internal.collections[t+"images"],Ze=this.internal.write;for(var st in Ie)Ze("/I"+(_e=Ie[st]).index,_e.objectId,"0","R")},v=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",d),this.internal.events.subscribe("putXobjectDict",a))},x=function(){var _e=this.internal.collections[t+"images"];return v.call(this),_e},b=function(){return Object.keys(this.internal.collections[t+"images"]).length},I=function(_e){return typeof e["process"+_e.toUpperCase()]=="function"},M=function(_e){return ps(_e)==="object"&&_e.nodeType===1},L=function(_e,Ie){if(_e.nodeName==="IMG"&&_e.hasAttribute("src")){var Ze=""+_e.getAttribute("src");if(Ze.indexOf("data:image/")===0)return e2(unescape(Ze).split("base64,").pop());var st=e.loadFile(Ze,!0);if(st!==void 0)return st}if(_e.nodeName==="CANVAS"){if(_e.width===0||_e.height===0)throw new Error("Given canvas must have data. Canvas width: "+_e.width+", height: "+_e.height);var Et;switch(Ie){case"PNG":Et="image/png";break;case"WEBP":Et="image/webp";break;default:Et="image/jpeg"}return e2(_e.toDataURL(Et,1).split("base64,").pop())}},U=function(_e){var Ie=this.internal.collections[t+"images"];if(Ie){for(var Ze in Ie)if(_e===Ie[Ze].alias)return Ie[Ze]}},R=function(_e,Ie,Ze){return _e||Ie||(_e=-96,Ie=-96),_e<0&&(_e=-1*Ze.width*72/_e/this.internal.scaleFactor),Ie<0&&(Ie=-1*Ze.height*72/Ie/this.internal.scaleFactor),_e===0&&(_e=Ie*Ze.width/Ze.height),Ie===0&&(Ie=_e*Ze.height/Ze.width),[_e,Ie]},H=function(_e,Ie,Ze,st,Et,Ut){var jt=R.call(this,Ze,st,Et),bt=this.internal.getCoordinateString,Nt=this.internal.getVerticalCoordinateString,ar=x.call(this);if(Ze=jt[0],st=jt[1],ar[Et.index]=Et,Ut){Ut*=Math.PI/180;var lt=Math.cos(Ut),ie=Math.sin(Ut),Le=function(Re){return Re.toFixed(4)},Fe=[Le(lt),Le(ie),Le(-1*ie),Le(lt),0,0,"cm"]}this.internal.write("q"),Ut?(this.internal.write([1,"0","0",1,bt(_e),Nt(Ie+st),"cm"].join(" ")),this.internal.write(Fe.join(" ")),this.internal.write([bt(Ze),"0","0",bt(st),"0","0","cm"].join(" "))):this.internal.write([bt(Ze),"0","0",bt(st),bt(_e),Nt(Ie+st),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Et.index+" Do"),this.internal.write("Q")},q=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var te=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},J=e.__addimage__.sHashCode=function(_e){var Ie,Ze,st=0;if(typeof _e=="string")for(Ze=_e.length,Ie=0;Ie<Ze;Ie++)st=(st<<5)-st+_e.charCodeAt(Ie),st|=0;else if(Se(_e))for(Ze=_e.byteLength/2,Ie=0;Ie<Ze;Ie++)st=(st<<5)-st+_e[Ie],st|=0;return st},se=e.__addimage__.validateStringAsBase64=function(_e){(_e=_e||"").toString().trim();var Ie=!0;return _e.length===0&&(Ie=!1),_e.length%4!=0&&(Ie=!1),/^[A-Za-z0-9+/]+$/.test(_e.substr(0,_e.length-2))===!1&&(Ie=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_e.substr(-2))===!1&&(Ie=!1),Ie},ye=e.__addimage__.extractImageFromDataUrl=function(_e){if(_e==null||!(_e=_e.trim()).startsWith("data:"))return null;var Ie=_e.indexOf(",");return Ie<0?null:_e.substring(0,Ie).trim().endsWith("base64")?_e.substring(Ie+1):null};e.__addimage__.isArrayBuffer=function(_e){return _e instanceof ArrayBuffer};var Se=e.__addimage__.isArrayBufferView=function(_e){return _e instanceof Int8Array||_e instanceof Uint8Array||_e instanceof Uint8ClampedArray||_e instanceof Int16Array||_e instanceof Uint16Array||_e instanceof Int32Array||_e instanceof Uint32Array||_e instanceof Float32Array||_e instanceof Float64Array},Be=e.__addimage__.binaryStringToUint8Array=function(_e){for(var Ie=_e.length,Ze=new Uint8Array(Ie),st=0;st<Ie;st++)Ze[st]=_e.charCodeAt(st);return Ze},De=e.__addimage__.arrayBufferToBinaryString=function(_e){for(var Ie="",Ze=Se(_e)?_e:new Uint8Array(_e),st=0;st<Ze.length;st+=8192)Ie+=String.fromCharCode.apply(null,Ze.subarray(st,st+8192));return Ie};e.addImage=function(){var _e,Ie,Ze,st,Et,Ut,jt,bt,Nt;if(typeof arguments[1]=="number"?(Ie=r,Ze=arguments[1],st=arguments[2],Et=arguments[3],Ut=arguments[4],jt=arguments[5],bt=arguments[6],Nt=arguments[7]):(Ie=arguments[1],Ze=arguments[2],st=arguments[3],Et=arguments[4],Ut=arguments[5],jt=arguments[6],bt=arguments[7],Nt=arguments[8]),ps(_e=arguments[0])==="object"&&!M(_e)&&"imageData"in _e){var ar=_e;_e=ar.imageData,Ie=ar.format||Ie||r,Ze=ar.x||Ze||0,st=ar.y||st||0,Et=ar.w||ar.width||Et,Ut=ar.h||ar.height||Ut,jt=ar.alias||jt,bt=ar.compression||bt,Nt=ar.rotation||ar.angle||Nt}var lt=this.internal.getFilters();if(bt===void 0&&lt.indexOf("FlateEncode")!==-1&&(bt="SLOW"),isNaN(Ze)||isNaN(st))throw new Error("Invalid coordinates passed to jsPDF.addImage");v.call(this);var ie=we.call(this,_e,Ie,jt,bt);return H.call(this,Ze,st,Et,Ut,ie,Nt),this};var we=function(_e,Ie,Ze,st){var Et,Ut,jt;if(typeof _e=="string"&&l(_e)===r){_e=unescape(_e);var bt=nt(_e,!1);(bt!==""||(bt=e.loadFile(_e,!0))!==void 0)&&(_e=bt)}if(M(_e)&&(_e=L(_e,Ie)),Ie=l(_e,Ie),!I(Ie))throw new Error("addImage does not support files of type '"+Ie+"', please ensure that a plugin for '"+Ie+"' support is added.");if(((jt=Ze)==null||jt.length===0)&&(Ze=function(Nt){return typeof Nt=="string"||Se(Nt)?J(Nt):Se(Nt.data)?J(Nt.data):null}(_e)),(Et=U.call(this,Ze))||(_e instanceof Uint8Array||Ie==="RGBA"||(Ut=_e,_e=Be(_e)),Et=this["process"+Ie.toUpperCase()](_e,b.call(this),Ze,function(Nt){return Nt&&typeof Nt=="string"&&(Nt=Nt.toUpperCase()),Nt in e.image_compression?Nt:te.NONE}(st),Ut)),!Et)throw new Error("An unknown error occurred whilst processing the image.");return Et},nt=e.__addimage__.convertBase64ToBinaryString=function(_e,Ie){Ie=typeof Ie!="boolean"||Ie;var Ze,st="";if(typeof _e=="string"){var Et;Ze=(Et=ye(_e))!==null&&Et!==void 0?Et:_e;try{st=e2(Ze)}catch(Ut){if(Ie)throw se(Ze)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Ut.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return st};e.getImageProperties=function(_e){var Ie,Ze,st="";if(M(_e)&&(_e=L(_e)),typeof _e=="string"&&l(_e)===r&&((st=nt(_e,!1))===""&&(st=e.loadFile(_e)||""),_e=st),Ze=l(_e),!I(Ze))throw new Error("addImage does not support files of type '"+Ze+"', please ensure that a plugin for '"+Ze+"' support is added.");if(_e instanceof Uint8Array||(_e=Be(_e)),!(Ie=this["process"+Ze.toUpperCase()](_e)))throw new Error("An unknown error occurred whilst processing the image");return Ie.fileType=Ze,Ie}})(Qi.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Qi.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,l,u,d=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,v=this.internal.getPageInfoByObjId(r.objId),x=r.pageContext.annotations,b=!1,I=0;I<x.length&&!b;I++)switch((n=x[I]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(b=!0);break;case"reference":case"text":case"freetext":b=!0}if(b!=0){this.internal.write("/Annots [");for(var M=0;M<x.length;M++){n=x[M];var L=this.internal.pdfEscape,U=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var R=this.internal.newAdditionalObject(),H=this.internal.newAdditionalObject(),q=this.internal.getEncryptor(R.objId),te=n.title||"Note";u="<</Type /Annot /Subtype /Text "+(l="/Rect ["+d(n.bounds.x)+" "+a(n.bounds.y+n.bounds.h)+" "+d(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y)+"] ")+"/Contents ("+L(q(n.contents))+")",u+=" /Popup "+H.objId+" 0 R",u+=" /P "+v.objId+" 0 R",u+=" /T ("+L(q(te))+") >>",R.content=u;var J=R.objId+" 0 R";u="<</Type /Annot /Subtype /Popup "+(l="/Rect ["+d(n.bounds.x+30)+" "+a(n.bounds.y+n.bounds.h)+" "+d(n.bounds.x+n.bounds.w+30)+" "+a(n.bounds.y)+"] ")+" /Parent "+J,n.open&&(u+=" /Open true"),u+=" >>",H.content=u,this.internal.write(R.objId,"0 R",H.objId,"0 R");break;case"freetext":l="/Rect ["+d(n.bounds.x)+" "+a(n.bounds.y)+" "+d(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y+n.bounds.h)+"] ";var se=n.color||"#000000";u="<</Type /Annot /Subtype /FreeText "+l+"/Contents ("+L(U(n.contents))+")",u+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+se+")",u+=" /Border [0 0 0]",u+=" >>",this.internal.write(u);break;case"link":if(n.options.name){var ye=this.annotations._nameMap[n.options.name];n.options.pageNumber=ye.page,n.options.top=ye.y}else n.options.top||(n.options.top=0);if(l="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",u="",n.options.url)u="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /A <</S /URI /URI ("+L(U(n.options.url))+") >>";else if(n.options.pageNumber)switch(u="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":u+=" /Fit]";break;case"FitH":u+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,u+=" /FitV "+n.options.left+"]";break;default:var Se=a(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),u+=" /XYZ "+n.options.left+" "+Se+" "+n.options.zoom+"]"}u!=""&&(u+=" >>",this.internal.write(u))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,l,u,d){var a=this.internal.getCurrentPageInfo(),v=this.internal.getCoordinateString,x=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:v(r),y:x(n),w:v(r+l),h:x(n+u)},options:d,type:"link"})},e.textWithLink=function(r,n,l,u){var d,a,v=this.getTextWidth(r),x=this.internal.getLineHeight()/this.internal.scaleFactor;if(u.maxWidth!==void 0){a=u.maxWidth;var b=this.splitTextToSize(r,a).length;d=Math.ceil(x*b)}else a=v,d=x;return this.text(r,n,l,u),l+=.2*x,u.align==="center"&&(n-=v/2),u.align==="right"&&(n-=v),this.link(n,l-x,a,d,u),v},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Qi.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},l=[1570,1571,1573,1575];e.__arabicParser__={};var u=e.__arabicParser__.isInArabicSubstitutionA=function(R){return t[R.charCodeAt(0)]!==void 0},d=e.__arabicParser__.isArabicLetter=function(R){return typeof R=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(R)},a=e.__arabicParser__.isArabicEndLetter=function(R){return d(R)&&u(R)&&t[R.charCodeAt(0)].length<=2},v=e.__arabicParser__.isArabicAlfLetter=function(R){return d(R)&&l.indexOf(R.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(R){return d(R)&&u(R)&&t[R.charCodeAt(0)].length>=1};var x=e.__arabicParser__.arabicLetterHasFinalForm=function(R){return d(R)&&u(R)&&t[R.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(R){return d(R)&&u(R)&&t[R.charCodeAt(0)].length>=3};var b=e.__arabicParser__.arabicLetterHasMedialForm=function(R){return d(R)&&u(R)&&t[R.charCodeAt(0)].length==4},I=e.__arabicParser__.resolveLigatures=function(R){var H=0,q=r,te="",J=0;for(H=0;H<R.length;H+=1)q[R.charCodeAt(H)]!==void 0?(J++,typeof(q=q[R.charCodeAt(H)])=="number"&&(te+=String.fromCharCode(q),q=r,J=0),H===R.length-1&&(q=r,te+=R.charAt(H-(J-1)),H-=J-1,J=0)):(q=r,te+=R.charAt(H-J),H-=J,J=0);return te};e.__arabicParser__.isArabicDiacritic=function(R){return R!==void 0&&n[R.charCodeAt(0)]!==void 0};var M=e.__arabicParser__.getCorrectForm=function(R,H,q){return d(R)?u(R)===!1?-1:!x(R)||!d(H)&&!d(q)||!d(q)&&a(H)||a(R)&&!d(H)||a(R)&&v(H)||a(R)&&a(H)?0:b(R)&&d(H)&&!a(H)&&d(q)&&x(q)?3:a(R)||!d(q)?1:2:-1},L=function(R){var H=0,q=0,te=0,J="",se="",ye="",Se=(R=R||"").split("\\s+"),Be=[];for(H=0;H<Se.length;H+=1){for(Be.push(""),q=0;q<Se[H].length;q+=1)J=Se[H][q],se=Se[H][q-1],ye=Se[H][q+1],d(J)?(te=M(J,se,ye),Be[H]+=te!==-1?String.fromCharCode(t[J.charCodeAt(0)][te]):J):Be[H]+=J;Be[H]=I(Be[H])}return Be.join(" ")},U=e.__arabicParser__.processArabic=e.processArabic=function(){var R,H=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,q=[];if(Array.isArray(H)){var te=0;for(q=[],te=0;te<H.length;te+=1)Array.isArray(H[te])?q.push([L(H[te][0]),H[te][1],H[te][2]]):q.push([L(H[te])]);R=q}else R=L(H);return typeof arguments[0]=="string"?R:(arguments[0].text=R,arguments[0])};e.events.push(["preProcessText",U])}(Qi.API),Qi.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(a){r=a}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(a){n=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var l=300;Object.defineProperty(this,"height",{get:function(){return l},set:function(a){l=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=l+1)}});var u=[];Object.defineProperty(this,"childNodes",{get:function(){return u},set:function(a){u=a}});var d={};Object.defineProperty(this,"style",{get:function(){return d},set:function(a){d=a}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var l;if((r=r||"2d")!=="2d")return null;for(l in n)this.pdf.context2d.hasOwnProperty(l)&&(this.pdf.context2d[l]=n[l]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Qi.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),l.call(this))},l=function(){this.internal.__cell__.lastCell=new u,this.internal.__cell__.pages=1},u=function(){var v=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return v},set:function(R){v=R}});var x=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return x},set:function(R){x=R}});var b=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return b},set:function(R){b=R}});var I=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return I},set:function(R){I=R}});var M=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return M},set:function(R){M=R}});var L=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return L},set:function(R){L=R}});var U=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return U},set:function(R){U=R}}),this};u.prototype.clone=function(){return new u(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},u.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(v){return n.call(this),this.internal.__cell__.headerFunction=typeof v=="function"?v:void 0,this},e.getTextDimensions=function(v,x){n.call(this);var b=(x=x||{}).fontSize||this.getFontSize(),I=x.font||this.getFont(),M=x.scaleFactor||this.internal.scaleFactor,L=0,U=0,R=0,H=this;if(!Array.isArray(v)&&typeof v!="string"){if(typeof v!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");v=String(v)}var q=x.maxWidth;q>0?typeof v=="string"?v=this.splitTextToSize(v,q):Object.prototype.toString.call(v)==="[object Array]"&&(v=v.reduce(function(J,se){return J.concat(H.splitTextToSize(se,q))},[])):v=Array.isArray(v)?v:[v];for(var te=0;te<v.length;te++)L<(R=this.getStringUnitWidth(v[te],{font:I})*b)&&(L=R);return L!==0&&(U=v.length),{w:L/=M,h:Math.max((U*b*this.getLineHeightFactor()-b*(this.getLineHeightFactor()-1))/M,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var v=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new u(v.left,v.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var d=e.cell=function(){var v;v=arguments[0]instanceof u?arguments[0]:new u(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var x=this.internal.__cell__.lastCell,b=this.internal.__cell__.padding,I=this.internal.__cell__.margins||t,M=this.internal.__cell__.tableHeaderRow,L=this.internal.__cell__.printHeaders;return x.lineNumber!==void 0&&(x.lineNumber===v.lineNumber?(v.x=(x.x||0)+(x.width||0),v.y=x.y||0):x.y+x.height+v.height+I.bottom>this.getPageHeight()?(this.cellAddPage(),v.y=I.top,L&&M&&(this.printHeaderRow(v.lineNumber,!0),v.y+=M[0].height)):v.y=x.y+x.height||v.y),v.text[0]!==void 0&&(this.rect(v.x,v.y,v.width,v.height,r===!0?"FD":void 0),v.align==="right"?this.text(v.text,v.x+v.width-b,v.y+b,{align:"right",baseline:"top"}):v.align==="center"?this.text(v.text,v.x+v.width/2,v.y+b,{align:"center",baseline:"top",maxWidth:v.width-b-b}):this.text(v.text,v.x+b,v.y+b,{align:"left",baseline:"top",maxWidth:v.width-b-b})),this.internal.__cell__.lastCell=v,this};e.table=function(v,x,b,I,M){if(n.call(this),!b)throw new Error("No data for PDF table.");var L,U,R,H,q=[],te=[],J=[],se={},ye={},Se=[],Be=[],De=(M=M||{}).autoSize||!1,we=M.printHeaders!==!1,nt=M.css&&M.css["font-size"]!==void 0?16*M.css["font-size"]:M.fontSize||12,_e=M.margins||Object.assign({width:this.getPageWidth()},t),Ie=typeof M.padding=="number"?M.padding:3,Ze=M.headerBackgroundColor||"#c8c8c8",st=M.headerTextColor||"#000";if(l.call(this),this.internal.__cell__.printHeaders=we,this.internal.__cell__.margins=_e,this.internal.__cell__.table_font_size=nt,this.internal.__cell__.padding=Ie,this.internal.__cell__.headerBackgroundColor=Ze,this.internal.__cell__.headerTextColor=st,this.setFontSize(nt),I==null)te=q=Object.keys(b[0]),J=q.map(function(){return"left"});else if(Array.isArray(I)&&ps(I[0])==="object")for(q=I.map(function(ar){return ar.name}),te=I.map(function(ar){return ar.prompt||ar.name||""}),J=I.map(function(ar){return ar.align||"left"}),L=0;L<I.length;L+=1)ye[I[L].name]=.7499990551181103*I[L].width;else Array.isArray(I)&&typeof I[0]=="string"&&(te=q=I,J=q.map(function(){return"left"}));if(De||Array.isArray(I)&&typeof I[0]=="string")for(L=0;L<q.length;L+=1){for(se[H=q[L]]=b.map(function(ar){return ar[H]}),this.setFont(void 0,"bold"),Se.push(this.getTextDimensions(te[L],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),U=se[H],this.setFont(void 0,"normal"),R=0;R<U.length;R+=1)Se.push(this.getTextDimensions(U[R],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ye[H]=Math.max.apply(null,Se)+Ie+Ie,Se=[]}if(we){var Et={};for(L=0;L<q.length;L+=1)Et[q[L]]={},Et[q[L]].text=te[L],Et[q[L]].align=J[L];var Ut=a.call(this,Et,ye);Be=q.map(function(ar){return new u(v,x,ye[ar],Ut,Et[ar].text,void 0,Et[ar].align)}),this.setTableHeaderRow(Be),this.printHeaderRow(1,!1)}var jt=I.reduce(function(ar,lt){return ar[lt.name]=lt.align,ar},{});for(L=0;L<b.length;L+=1){"rowStart"in M&&M.rowStart instanceof Function&&M.rowStart({row:L,data:b[L]},this);var bt=a.call(this,b[L],ye);for(R=0;R<q.length;R+=1){var Nt=b[L][q[R]];"cellStart"in M&&M.cellStart instanceof Function&&M.cellStart({row:L,col:R,data:Nt},this),d.call(this,new u(v,x,ye[q[R]],bt,Nt,L+2,jt[q[R]]))}}return this.internal.__cell__.table_x=v,this.internal.__cell__.table_y=x,this};var a=function(v,x){var b=this.internal.__cell__.padding,I=this.internal.__cell__.table_font_size,M=this.internal.scaleFactor;return Object.keys(v).map(function(L){var U=v[L];return this.splitTextToSize(U.hasOwnProperty("text")?U.text:U,x[L]-b-b)},this).map(function(L){return this.getLineHeightFactor()*L.length*I/M+b+b},this).reduce(function(L,U){return Math.max(L,U)},0)};e.setTableHeaderRow=function(v){n.call(this),this.internal.__cell__.tableHeaderRow=v},e.printHeaderRow=function(v,x){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var b;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var I=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new u(I[0],I[1],I[2],I[3],void 0,-1)}this.setFont(void 0,"bold");for(var M=[],L=0;L<this.internal.__cell__.tableHeaderRow.length;L+=1){b=this.internal.__cell__.tableHeaderRow[L].clone(),x&&(b.y=this.internal.__cell__.margins.top||0,M.push(b)),b.lineNumber=v;var U=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),d.call(this,b),this.setTextColor(U)}M.length>0&&this.setTableHeaderRow(M),this.setFont(void 0,"normal"),r=!1}}(Qi.API);var QV={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},jV=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],T5=zV(jV),HV=[100,200,300,400,500,600,700,800,900],T1e=zV(HV);function $S(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(u){return QV[u=u||"normal"]?u:"normal"}(e.style),n=function(u){return u?typeof u=="number"?u>=100&&u<=900&&u%100==0?u:400:/^\d00$/.test(u)?parseInt(u):u==="bold"?700:400:400}(e.weight),l=function(u){return typeof T5[u=u||"normal"]=="number"?u:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:l,src:e.src||[],ref:e.ref||{name:t,style:[l,r,n].join(" ")}}}function aN(e,t,r,n){var l;for(l=r;l>=0&&l<t.length;l+=n)if(e[t[l]])return e[t[l]];for(l=r;l>=0&&l<t.length;l-=n)if(e[t[l]])return e[t[l]]}var I1e={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},oN={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function sN(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function lN(e){return e.trimLeft()}function F1e(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function P1e(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var bw,cN,uN,b_,Ew,hN,fN,AN,XS=["times"];function dN(e,t,r,n){var l=4,u=mN;switch(n){case Qi.API.image_compression.FAST:l=1,u=pN;break;case Qi.API.image_compression.MEDIUM:l=6,u=gN;break;case Qi.API.image_compression.SLOW:l=9,u=_N}e=function(a,v,x,b){for(var I,M=a.length/v,L=new Uint8Array(a.length+M),U=[L1e,pN,mN,gN,_N],R=0;R<M;R+=1){var H=R*v,q=a.subarray(H,H+v);if(b)L.set(b(q,x,I),H+R);else{for(var te=U.length,J=[],se=0;se<te;se+=1)J[se]=U[se](q,x,I);var ye=O1e(J.concat());L.set(J[ye],H+R)}I=q}return L}(e,t,r,u);var d=x5(e,{level:l});return Qi.API.__addimage__.arrayBufferToBinaryString(d)}function L1e(e){var t=Array.apply([],e);return t.unshift(0),t}function pN(e,t){var r=e.length,n=[];n[0]=1;for(var l=0;l<r;l+=1){var u=e[l-t]||0;n[l+1]=e[l]-u+256&255}return n}function mN(e,t,r){var n=e.length,l=[];l[0]=2;for(var u=0;u<n;u+=1){var d=r&&r[u]||0;l[u+1]=e[u]-d+256&255}return l}function gN(e,t,r){var n=e.length,l=[];l[0]=3;for(var u=0;u<n;u+=1){var d=e[u-t]||0,a=r&&r[u]||0;l[u+1]=e[u]+256-(d+a>>>1)&255}return l}function _N(e,t,r){var n=e.length,l=[];l[0]=4;for(var u=0;u<n;u+=1){var d=M1e(e[u-t]||0,r&&r[u]||0,r&&r[u-t]||0);l[u+1]=e[u]-d+256&255}return l}function M1e(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),l=Math.abs(e-r),u=Math.abs(e+t-r-r);return n<=l&&n<=u?e:l<=u?t:r}function O1e(e){var t=e.map(function(r){return r.reduce(function(n,l){return n+Math.abs(l)},0)});return t.indexOf(Math.min.apply(null,t))}function ZS(e,t,r){var n=t*r,l=Math.floor(n/8),u=16-(n-8*l+r),d=(1<<r)-1;return VV(e,l)>>u&d}function vN(e,t,r,n){var l=r*n,u=Math.floor(l/8),d=16-(l-8*u+n),a=(1<<n)-1,v=(t&a)<<d;(function(x,b,I){if(b+1<x.byteLength)x.setUint16(b,I,!1);else{var M=I>>8&255;x.setUint8(b,M)}})(e,u,VV(e,u)&~(a<<d)&65535|v)}function VV(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function D1e(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,l=e[t++],u=l>>7,d=1<<1+(7&l);e[t++],e[t++];var a=null,v=null;u&&(a=t,v=d,t+=3*d);var x=!0,b=[],I=0,M=null,L=0,U=null;for(this.width=r,this.height=n;x&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,U=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((_e=e[t++])>=0))throw Error("Invalid block size");if(_e===0)break;t+=_e}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var R=e[t++];I=e[t++]|e[t++]<<8,M=e[t++],1&R||(M=null),L=R>>2&7,t++;break;case 254:for(;;){if(!((_e=e[t++])>=0))throw Error("Invalid block size");if(_e===0)break;t+=_e}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var H=e[t++]|e[t++]<<8,q=e[t++]|e[t++]<<8,te=e[t++]|e[t++]<<8,J=e[t++]|e[t++]<<8,se=e[t++],ye=se>>6&1,Se=1<<1+(7&se),Be=a,De=v,we=!1;se>>7&&(we=!0,Be=t,De=Se,t+=3*Se);var nt=t;for(t++;;){var _e;if(!((_e=e[t++])>=0))throw Error("Invalid block size");if(_e===0)break;t+=_e}b.push({x:H,y:q,width:te,height:J,has_local_palette:we,palette_offset:Be,palette_size:De,data_offset:nt,data_length:t-nt,transparent_index:M,interlaced:!!ye,delay:I,disposal:L});break;case 59:x=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return b.length},this.loopCount=function(){return U},this.frameInfo=function(Ie){if(Ie<0||Ie>=b.length)throw new Error("Frame index out of range.");return b[Ie]},this.decodeAndBlitFrameBGRA=function(Ie,Ze){var st=this.frameInfo(Ie),Et=st.width*st.height,Ut=new Uint8Array(Et);yN(e,st.data_offset,Ut,Et);var jt=st.palette_offset,bt=st.transparent_index;bt===null&&(bt=256);var Nt=st.width,ar=r-Nt,lt=Nt,ie=4*(st.y*r+st.x),Le=4*((st.y+st.height)*r+st.x),Fe=ie,Re=4*ar;st.interlaced===!0&&(Re+=4*r*7);for(var et=8,xt=0,Dt=Ut.length;xt<Dt;++xt){var pt=Ut[xt];if(lt===0&&(lt=Nt,(Fe+=Re)>=Le&&(Re=4*ar+4*r*(et-1),Fe=ie+(Nt+ar)*(et<<1),et>>=1)),pt===bt)Fe+=4;else{var Ct=e[jt+3*pt],mr=e[jt+3*pt+1],Zt=e[jt+3*pt+2];Ze[Fe++]=Zt,Ze[Fe++]=mr,Ze[Fe++]=Ct,Ze[Fe++]=255}--lt}},this.decodeAndBlitFrameRGBA=function(Ie,Ze){var st=this.frameInfo(Ie),Et=st.width*st.height,Ut=new Uint8Array(Et);yN(e,st.data_offset,Ut,Et);var jt=st.palette_offset,bt=st.transparent_index;bt===null&&(bt=256);var Nt=st.width,ar=r-Nt,lt=Nt,ie=4*(st.y*r+st.x),Le=4*((st.y+st.height)*r+st.x),Fe=ie,Re=4*ar;st.interlaced===!0&&(Re+=4*r*7);for(var et=8,xt=0,Dt=Ut.length;xt<Dt;++xt){var pt=Ut[xt];if(lt===0&&(lt=Nt,(Fe+=Re)>=Le&&(Re=4*ar+4*r*(et-1),Fe=ie+(Nt+ar)*(et<<1),et>>=1)),pt===bt)Fe+=4;else{var Ct=e[jt+3*pt],mr=e[jt+3*pt+1],Zt=e[jt+3*pt+2];Ze[Fe++]=Ct,Ze[Fe++]=mr,Ze[Fe++]=Zt,Ze[Fe++]=255}--lt}}}function yN(e,t,r,n){for(var l=e[t++],u=1<<l,d=u+1,a=d+1,v=l+1,x=(1<<v)-1,b=0,I=0,M=0,L=e[t++],U=new Int32Array(4096),R=null;;){for(;b<16&&L!==0;)I|=e[t++]<<b,b+=8,L===1?L=e[t++]:--L;if(b<v)break;var H=I&x;if(I>>=v,b-=v,H!==u){if(H===d)break;for(var q=H<a?H:R,te=0,J=q;J>u;)J=U[J]>>8,++te;var se=J;if(M+te+(q!==H?1:0)>n)return void Us.log("Warning, gif stream longer than expected.");r[M++]=se;var ye=M+=te;for(q!==H&&(r[M++]=se),J=q;te--;)J=U[J],r[--ye]=255&J,J>>=8;R!==null&&a<4096&&(U[a++]=R<<8|se,a>=x+1&&v<12&&(++v,x=x<<1|1)),R=H}else a=d+1,x=(1<<(v=l+1))-1,R=null}return M!==n&&Us.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function YS(e){var t,r,n,l,u,d=Math.floor,a=new Array(64),v=new Array(64),x=new Array(64),b=new Array(64),I=new Array(65535),M=new Array(65535),L=new Array(64),U=new Array(64),R=[],H=0,q=7,te=new Array(64),J=new Array(64),se=new Array(64),ye=new Array(256),Se=new Array(2048),Be=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],De=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],we=[0,1,2,3,4,5,6,7,8,9,10,11],nt=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_e=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Ie=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Ze=[0,1,2,3,4,5,6,7,8,9,10,11],st=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Et=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Ut(ie,Le){for(var Fe=0,Re=0,et=new Array,xt=1;xt<=16;xt++){for(var Dt=1;Dt<=ie[xt];Dt++)et[Le[Re]]=[],et[Le[Re]][0]=Fe,et[Le[Re]][1]=xt,Re++,Fe++;Fe*=2}return et}function jt(ie){for(var Le=ie[0],Fe=ie[1]-1;Fe>=0;)Le&1<<Fe&&(H|=1<<q),Fe--,--q<0&&(H==255?(bt(255),bt(0)):bt(H),q=7,H=0)}function bt(ie){R.push(ie)}function Nt(ie){bt(ie>>8&255),bt(255&ie)}function ar(ie,Le,Fe,Re,et){for(var xt,Dt=et[0],pt=et[240],Ct=function(an,Pn){var yn,Ci,Zn,Vi,Ti,ui,ta,bi,ti,vi,Dn=0;for(ti=0;ti<8;++ti){yn=an[Dn],Ci=an[Dn+1],Zn=an[Dn+2],Vi=an[Dn+3],Ti=an[Dn+4],ui=an[Dn+5],ta=an[Dn+6];var ua=yn+(bi=an[Dn+7]),ca=yn-bi,Gn=Ci+ta,Li=Ci-ta,xa=Zn+ui,yi=Zn-ui,Nn=Vi+Ti,ki=Vi-Ti,oo=ua+Nn,wa=ua-Nn,ba=Gn+xa,Mi=Gn-xa;an[Dn]=oo+ba,an[Dn+4]=oo-ba;var Ea=.707106781*(Mi+wa);an[Dn+2]=wa+Ea,an[Dn+6]=wa-Ea;var hr=.382683433*((oo=ki+yi)-(Mi=Li+ca)),Bo=.5411961*oo+hr,xc=1.306562965*Mi+hr,sl=.707106781*(ba=yi+Li),_n=ca+sl,Tt=ca-sl;an[Dn+5]=Tt+Bo,an[Dn+3]=Tt-Bo,an[Dn+1]=_n+xc,an[Dn+7]=_n-xc,Dn+=8}for(Dn=0,ti=0;ti<8;++ti){yn=an[Dn],Ci=an[Dn+8],Zn=an[Dn+16],Vi=an[Dn+24],Ti=an[Dn+32],ui=an[Dn+40],ta=an[Dn+48];var pe=yn+(bi=an[Dn+56]),be=yn-bi,Ve=Ci+ta,rt=Ci-ta,je=Zn+ui,oe=Zn-ui,Ee=Vi+Ti,me=Vi-Ti,xe=pe+Ee,Ne=pe-Ee,Oe=Ve+je,St=Ve-je;an[Dn]=xe+Oe,an[Dn+32]=xe-Oe;var Ht=.707106781*(St+Ne);an[Dn+16]=Ne+Ht,an[Dn+48]=Ne-Ht;var Rt=.382683433*((xe=me+oe)-(St=rt+be)),Vt=.5411961*xe+Rt,Gt=1.306562965*St+Rt,br=.707106781*(Oe=oe+rt),qr=be+br,Hr=be-br;an[Dn+40]=Hr+Vt,an[Dn+24]=Hr-Vt,an[Dn+8]=qr+Gt,an[Dn+56]=qr-Gt,Dn++}for(ti=0;ti<64;++ti)vi=an[ti]*Pn[ti],L[ti]=vi>0?vi+.5|0:vi-.5|0;return L}(ie,Le),mr=0;mr<64;++mr)U[Be[mr]]=Ct[mr];var Zt=U[0]-Fe;Fe=U[0],Zt==0?jt(Re[0]):(jt(Re[M[xt=32767+Zt]]),jt(I[xt]));for(var sn=63;sn>0&&U[sn]==0;)sn--;if(sn==0)return jt(Dt),Fe;for(var er,mt=1;mt<=sn;){for(var En=mt;U[mt]==0&&mt<=sn;)++mt;var $r=mt-En;if($r>=16){er=$r>>4;for(var zn=1;zn<=er;++zn)jt(pt);$r&=15}xt=32767+U[mt],jt(et[($r<<4)+M[xt]]),jt(I[xt]),mt++}return sn!=63&&jt(Dt),Fe}function lt(ie){ie=Math.min(Math.max(ie,1),100),u!=ie&&(function(Le){for(var Fe=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Re=0;Re<64;Re++){var et=d((Fe[Re]*Le+50)/100);et=Math.min(Math.max(et,1),255),a[Be[Re]]=et}for(var xt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Dt=0;Dt<64;Dt++){var pt=d((xt[Dt]*Le+50)/100);pt=Math.min(Math.max(pt,1),255),v[Be[Dt]]=pt}for(var Ct=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],mr=0,Zt=0;Zt<8;Zt++)for(var sn=0;sn<8;sn++)x[mr]=1/(a[Be[mr]]*Ct[Zt]*Ct[sn]*8),b[mr]=1/(v[Be[mr]]*Ct[Zt]*Ct[sn]*8),mr++}(ie<50?Math.floor(5e3/ie):Math.floor(200-2*ie)),u=ie)}this.encode=function(ie,Le){Le&&lt(Le),R=new Array,H=0,q=7,Nt(65496),Nt(65504),Nt(16),bt(74),bt(70),bt(73),bt(70),bt(0),bt(1),bt(1),bt(0),Nt(1),Nt(1),bt(0),bt(0),function(){Nt(65499),Nt(132),bt(0);for(var Ci=0;Ci<64;Ci++)bt(a[Ci]);bt(1);for(var Zn=0;Zn<64;Zn++)bt(v[Zn])}(),function(Ci,Zn){Nt(65472),Nt(17),bt(8),Nt(Zn),Nt(Ci),bt(3),bt(1),bt(17),bt(0),bt(2),bt(17),bt(1),bt(3),bt(17),bt(1)}(ie.width,ie.height),function(){Nt(65476),Nt(418),bt(0);for(var Ci=0;Ci<16;Ci++)bt(De[Ci+1]);for(var Zn=0;Zn<=11;Zn++)bt(we[Zn]);bt(16);for(var Vi=0;Vi<16;Vi++)bt(nt[Vi+1]);for(var Ti=0;Ti<=161;Ti++)bt(_e[Ti]);bt(1);for(var ui=0;ui<16;ui++)bt(Ie[ui+1]);for(var ta=0;ta<=11;ta++)bt(Ze[ta]);bt(17);for(var bi=0;bi<16;bi++)bt(st[bi+1]);for(var ti=0;ti<=161;ti++)bt(Et[ti])}(),Nt(65498),Nt(12),bt(3),bt(1),bt(0),bt(2),bt(17),bt(3),bt(17),bt(0),bt(63),bt(0);var Fe=0,Re=0,et=0;H=0,q=7,this.encode.displayName="_encode_";for(var xt,Dt,pt,Ct,mr,Zt,sn,er,mt,En=ie.data,$r=ie.width,zn=ie.height,an=4*$r,Pn=0;Pn<zn;){for(xt=0;xt<an;){for(mr=an*Pn+xt,sn=-1,er=0,mt=0;mt<64;mt++)Zt=mr+(er=mt>>3)*an+(sn=4*(7&mt)),Pn+er>=zn&&(Zt-=an*(Pn+1+er-zn)),xt+sn>=an&&(Zt-=xt+sn-an+4),Dt=En[Zt++],pt=En[Zt++],Ct=En[Zt++],te[mt]=(Se[Dt]+Se[pt+256|0]+Se[Ct+512|0]>>16)-128,J[mt]=(Se[Dt+768|0]+Se[pt+1024|0]+Se[Ct+1280|0]>>16)-128,se[mt]=(Se[Dt+1280|0]+Se[pt+1536|0]+Se[Ct+1792|0]>>16)-128;Fe=ar(te,x,Fe,t,n),Re=ar(J,b,Re,r,l),et=ar(se,b,et,r,l),xt+=32}Pn+=8}if(q>=0){var yn=[];yn[1]=q+1,yn[0]=(1<<q+1)-1,jt(yn)}return Nt(65497),new Uint8Array(R)},e=e||50,function(){for(var ie=String.fromCharCode,Le=0;Le<256;Le++)ye[Le]=ie(Le)}(),t=Ut(De,we),r=Ut(Ie,Ze),n=Ut(nt,_e),l=Ut(st,Et),function(){for(var ie=1,Le=2,Fe=1;Fe<=15;Fe++){for(var Re=ie;Re<Le;Re++)M[32767+Re]=Fe,I[32767+Re]=[],I[32767+Re][1]=Fe,I[32767+Re][0]=Re;for(var et=-(Le-1);et<=-ie;et++)M[32767+et]=Fe,I[32767+et]=[],I[32767+et][1]=Fe,I[32767+et][0]=Le-1+et;ie<<=1,Le<<=1}}(),function(){for(var ie=0;ie<256;ie++)Se[ie]=19595*ie,Se[ie+256|0]=38470*ie,Se[ie+512|0]=7471*ie+32768,Se[ie+768|0]=-11059*ie,Se[ie+1024|0]=-21709*ie,Se[ie+1280|0]=32768*ie+8421375,Se[ie+1536|0]=-27439*ie,Se[ie+1792|0]=-5329*ie}(),lt(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Pd(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function xN(e){function t(we){if(!we)throw Error("assert :P")}function r(we,nt,_e){for(var Ie=0;4>Ie;Ie++)if(we[nt+Ie]!=_e.charCodeAt(Ie))return!0;return!1}function n(we,nt,_e,Ie,Ze){for(var st=0;st<Ze;st++)we[nt+st]=_e[Ie+st]}function l(we,nt,_e,Ie){for(var Ze=0;Ze<Ie;Ze++)we[nt+Ze]=_e}function u(we){return new Int32Array(we)}function d(we,nt){for(var _e=[],Ie=0;Ie<we;Ie++)_e.push(new nt);return _e}function a(we,nt){var _e=[];return function Ie(Ze,st,Et){for(var Ut=Et[st],jt=0;jt<Ut&&(Ze.push(Et.length>st+1?[]:new nt),!(Et.length<st+1));jt++)Ie(Ze[jt],st+1,Et)}(_e,0,we),_e}var v=function(){var we=this;function nt(z,W){for(var ce=1<<W-1>>>0;z&ce;)ce>>>=1;return ce?(z&ce-1)+ce:z}function _e(z,W,ce,ve,Qe){t(!(ve%ce));do z[W+(ve-=ce)]=Qe;while(0<ve)}function Ie(z,W,ce,ve,Qe){if(t(2328>=Qe),512>=Qe)var qe=u(512);else if((qe=u(Qe))==null)return 0;return function(Je,ut,dt,vt,Wt,dr){var yt,rr,lr=ut,Qr=1<<dt,gr=u(16),Ur=u(16);for(t(Wt!=0),t(vt!=null),t(Je!=null),t(0<dt),rr=0;rr<Wt;++rr){if(15<vt[rr])return 0;++gr[vt[rr]]}if(gr[0]==Wt)return 0;for(Ur[1]=0,yt=1;15>yt;++yt){if(gr[yt]>1<<yt)return 0;Ur[yt+1]=Ur[yt]+gr[yt]}for(rr=0;rr<Wt;++rr)yt=vt[rr],0<vt[rr]&&(dr[Ur[yt]++]=rr);if(Ur[15]==1)return(vt=new Ze).g=0,vt.value=dr[0],_e(Je,lr,1,Qr,vt),Qr;var zr,Gr=-1,rn=Qr-1,ni=0,Qn=1,ra=1,si=1<<dt;for(rr=0,yt=1,Wt=2;yt<=dt;++yt,Wt<<=1){if(Qn+=ra<<=1,0>(ra-=gr[yt]))return 0;for(;0<gr[yt];--gr[yt])(vt=new Ze).g=yt,vt.value=dr[rr++],_e(Je,lr+ni,Wt,si,vt),ni=nt(ni,yt)}for(yt=dt+1,Wt=2;15>=yt;++yt,Wt<<=1){if(Qn+=ra<<=1,0>(ra-=gr[yt]))return 0;for(;0<gr[yt];--gr[yt]){if(vt=new Ze,(ni&rn)!=Gr){for(lr+=si,zr=1<<(Gr=yt)-dt;15>Gr&&!(0>=(zr-=gr[Gr]));)++Gr,zr<<=1;Qr+=si=1<<(zr=Gr-dt),Je[ut+(Gr=ni&rn)].g=zr+dt,Je[ut+Gr].value=lr-ut-Gr}vt.g=yt-dt,vt.value=dr[rr++],_e(Je,lr+(ni>>dt),Wt,si,vt),ni=nt(ni,yt)}}return Qn!=2*Ur[15]-1?0:Qr}(z,W,ce,ve,Qe,qe)}function Ze(){this.value=this.g=0}function st(){this.value=this.g=0}function Et(){this.G=d(5,Ze),this.H=u(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=d(Ql,st)}function Ut(z,W,ce,ve){t(z!=null),t(W!=null),t(2147483648>ve),z.Ca=254,z.I=0,z.b=-8,z.Ka=0,z.oa=W,z.pa=ce,z.Jd=W,z.Yc=ce+ve,z.Zc=4<=ve?ce+ve-4+1:ce,Dt(z)}function jt(z,W){for(var ce=0;0<W--;)ce|=Ct(z,128)<<W;return ce}function bt(z,W){var ce=jt(z,W);return pt(z)?-ce:ce}function Nt(z,W,ce,ve){var Qe,qe=0;for(t(z!=null),t(W!=null),t(4294967288>ve),z.Sb=ve,z.Ra=0,z.u=0,z.h=0,4<ve&&(ve=4),Qe=0;Qe<ve;++Qe)qe+=W[ce+Qe]<<8*Qe;z.Ra=qe,z.bb=ve,z.oa=W,z.pa=ce}function ar(z){for(;8<=z.u&&z.bb<z.Sb;)z.Ra>>>=8,z.Ra+=z.oa[z.pa+z.bb]<<bu-8>>>0,++z.bb,z.u-=8;Re(z)&&(z.h=1,z.u=0)}function lt(z,W){if(t(0<=W),!z.h&&W<=Hs){var ce=Fe(z)&Zs[W];return z.u+=W,ar(z),ce}return z.h=1,z.u=0}function ie(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Le(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Fe(z){return z.Ra>>>(z.u&bu-1)>>>0}function Re(z){return t(z.bb<=z.Sb),z.h||z.bb==z.Sb&&z.u>bu}function et(z,W){z.u=W,z.h=Re(z)}function xt(z){z.u>=fa&&(t(z.u>=fa),ar(z))}function Dt(z){t(z!=null&&z.oa!=null),z.pa<z.Zc?(z.I=(z.oa[z.pa++]|z.I<<8)>>>0,z.b+=8):(t(z!=null&&z.oa!=null),z.pa<z.Yc?(z.b+=8,z.I=z.oa[z.pa++]|z.I<<8):z.Ka?z.b=0:(z.I<<=8,z.b+=8,z.Ka=1))}function pt(z){return jt(z,1)}function Ct(z,W){var ce=z.Ca;0>z.b&&Dt(z);var ve=z.b,Qe=ce*W>>>8,qe=(z.I>>>ve>Qe)+0;for(qe?(ce-=Qe,z.I-=Qe+1<<ve>>>0):ce=Qe+1,ve=ce,Qe=0;256<=ve;)Qe+=8,ve>>=8;return ve=7^Qe+EA[ve],z.b-=ve,z.Ca=(ce<<ve)-1,qe}function mr(z,W,ce){z[W+0]=ce>>24&255,z[W+1]=ce>>16&255,z[W+2]=ce>>8&255,z[W+3]=255&ce}function Zt(z,W){return z[W+0]|z[W+1]<<8}function sn(z,W){return Zt(z,W)|z[W+2]<<16}function er(z,W){return Zt(z,W)|Zt(z,W+2)<<16}function mt(z,W){var ce=1<<W;return t(z!=null),t(0<W),z.X=u(ce),z.X==null?0:(z.Mb=32-W,z.Xa=W,1)}function En(z,W){t(z!=null),t(W!=null),t(z.Xa==W.Xa),n(W.X,0,z.X,0,1<<W.Xa)}function $r(){this.X=[],this.Xa=this.Mb=0}function zn(z,W,ce,ve){t(ce!=null),t(ve!=null);var Qe=ce[0],qe=ve[0];return Qe==0&&(Qe=(z*qe+W/2)/W),qe==0&&(qe=(W*Qe+z/2)/z),0>=Qe||0>=qe?0:(ce[0]=Qe,ve[0]=qe,1)}function an(z,W){return z+(1<<W)-1>>>W}function Pn(z,W){return((4278255360&z)+(4278255360&W)>>>0&4278255360)+((16711935&z)+(16711935&W)>>>0&16711935)>>>0}function yn(z,W){we[W]=function(ce,ve,Qe,qe,Je,ut,dt){var vt;for(vt=0;vt<Je;++vt){var Wt=we[z](ut[dt+vt-1],Qe,qe+vt);ut[dt+vt]=Pn(ce[ve+vt],Wt)}}}function Ci(){this.ud=this.hd=this.jd=0}function Zn(z,W){return((4278124286&(z^W))>>>1)+(z&W)>>>0}function Vi(z){return 0<=z&&256>z?z:0>z?0:255<z?255:void 0}function Ti(z,W){return Vi(z+(z-W+.5>>1))}function ui(z,W,ce){return Math.abs(W-ce)-Math.abs(z-ce)}function ta(z,W,ce,ve,Qe,qe,Je){for(ve=qe[Je-1],ce=0;ce<Qe;++ce)qe[Je+ce]=ve=Pn(z[W+ce],ve)}function bi(z,W,ce,ve,Qe){var qe;for(qe=0;qe<ce;++qe){var Je=z[W+qe],ut=Je>>8&255,dt=16711935&(dt=(dt=16711935&Je)+((ut<<16)+ut));ve[Qe+qe]=(4278255360&Je)+dt>>>0}}function ti(z,W){W.jd=255&z,W.hd=z>>8&255,W.ud=z>>16&255}function vi(z,W,ce,ve,Qe,qe){var Je;for(Je=0;Je<ve;++Je){var ut=W[ce+Je],dt=ut>>>8,vt=ut,Wt=255&(Wt=(Wt=ut>>>16)+((z.jd<<24>>24)*(dt<<24>>24)>>>5));vt=255&(vt=(vt+=(z.hd<<24>>24)*(dt<<24>>24)>>>5)+((z.ud<<24>>24)*(Wt<<24>>24)>>>5)),Qe[qe+Je]=(4278255360&ut)+(Wt<<16)+vt}}function Dn(z,W,ce,ve,Qe){we[W]=function(qe,Je,ut,dt,vt,Wt,dr,yt,rr){for(dt=dr;dt<yt;++dt)for(dr=0;dr<rr;++dr)vt[Wt++]=Qe(ut[ve(qe[Je++])])},we[z]=function(qe,Je,ut,dt,vt,Wt,dr){var yt=8>>qe.b,rr=qe.Ea,lr=qe.K[0],Qr=qe.w;if(8>yt)for(qe=(1<<qe.b)-1,Qr=(1<<yt)-1;Je<ut;++Je){var gr,Ur=0;for(gr=0;gr<rr;++gr)gr&qe||(Ur=ve(dt[vt++])),Wt[dr++]=Qe(lr[Ur&Qr]),Ur>>=yt}else we["VP8LMapColor"+ce](dt,vt,lr,Qr,Wt,dr,Je,ut,rr)}}function ua(z,W,ce,ve,Qe){for(ce=W+ce;W<ce;){var qe=z[W++];ve[Qe++]=qe>>16&255,ve[Qe++]=qe>>8&255,ve[Qe++]=255&qe}}function ca(z,W,ce,ve,Qe){for(ce=W+ce;W<ce;){var qe=z[W++];ve[Qe++]=qe>>16&255,ve[Qe++]=qe>>8&255,ve[Qe++]=255&qe,ve[Qe++]=qe>>24&255}}function Gn(z,W,ce,ve,Qe){for(ce=W+ce;W<ce;){var qe=(Je=z[W++])>>16&240|Je>>12&15,Je=240&Je|Je>>28&15;ve[Qe++]=qe,ve[Qe++]=Je}}function Li(z,W,ce,ve,Qe){for(ce=W+ce;W<ce;){var qe=(Je=z[W++])>>16&248|Je>>13&7,Je=Je>>5&224|Je>>3&31;ve[Qe++]=qe,ve[Qe++]=Je}}function xa(z,W,ce,ve,Qe){for(ce=W+ce;W<ce;){var qe=z[W++];ve[Qe++]=255&qe,ve[Qe++]=qe>>8&255,ve[Qe++]=qe>>16&255}}function yi(z,W,ce,ve,Qe,qe){if(qe==0)for(ce=W+ce;W<ce;)mr(ve,((qe=z[W++])[0]>>24|qe[1]>>8&65280|qe[2]<<8&16711680|qe[3]<<24)>>>0),Qe+=32;else n(ve,Qe,z,W,ce)}function Nn(z,W){we[W][0]=we[z+"0"],we[W][1]=we[z+"1"],we[W][2]=we[z+"2"],we[W][3]=we[z+"3"],we[W][4]=we[z+"4"],we[W][5]=we[z+"5"],we[W][6]=we[z+"6"],we[W][7]=we[z+"7"],we[W][8]=we[z+"8"],we[W][9]=we[z+"9"],we[W][10]=we[z+"10"],we[W][11]=we[z+"11"],we[W][12]=we[z+"12"],we[W][13]=we[z+"13"],we[W][14]=we[z+"0"],we[W][15]=we[z+"0"]}function ki(z){return z==LA||z==Vf||z==hd||z==MA}function oo(){this.eb=[],this.size=this.A=this.fb=0}function wa(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ba(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new oo,this.f.kb=new wa,this.sd=null}function Mi(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ea(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function hr(z){return alert("todo:WebPSamplerProcessPlane"),z.T}function Bo(z,W){var ce=z.T,ve=W.ba.f.RGBA,Qe=ve.eb,qe=ve.fb+z.ka*ve.A,Je=Js[W.ba.S],ut=z.y,dt=z.O,vt=z.f,Wt=z.N,dr=z.ea,yt=z.W,rr=W.cc,lr=W.dc,Qr=W.Mc,gr=W.Nc,Ur=z.ka,zr=z.ka+z.T,Gr=z.U,rn=Gr+1>>1;for(Ur==0?Je(ut,dt,null,null,vt,Wt,dr,yt,vt,Wt,dr,yt,Qe,qe,null,null,Gr):(Je(W.ec,W.fc,ut,dt,rr,lr,Qr,gr,vt,Wt,dr,yt,Qe,qe-ve.A,Qe,qe,Gr),++ce);Ur+2<zr;Ur+=2)rr=vt,lr=Wt,Qr=dr,gr=yt,Wt+=z.Rc,yt+=z.Rc,qe+=2*ve.A,Je(ut,(dt+=2*z.fa)-z.fa,ut,dt,rr,lr,Qr,gr,vt,Wt,dr,yt,Qe,qe-ve.A,Qe,qe,Gr);return dt+=z.fa,z.j+zr<z.o?(n(W.ec,W.fc,ut,dt,Gr),n(W.cc,W.dc,vt,Wt,rn),n(W.Mc,W.Nc,dr,yt,rn),ce--):1&zr||Je(ut,dt,null,null,vt,Wt,dr,yt,vt,Wt,dr,yt,Qe,qe+ve.A,null,null,Gr),ce}function xc(z,W,ce){var ve=z.F,Qe=[z.J];if(ve!=null){var qe=z.U,Je=W.ba.S,ut=Je==PA||Je==hd;W=W.ba.f.RGBA;var dt=[0],vt=z.ka;dt[0]=z.T,z.Kb&&(vt==0?--dt[0]:(--vt,Qe[0]-=z.width),z.j+z.ka+z.T==z.o&&(dt[0]=z.o-z.j-vt));var Wt=W.eb;vt=W.fb+vt*W.A,z=Qf(ve,Qe[0],z.width,qe,dt,Wt,vt+(ut?0:3),W.A),t(ce==dt),z&&ki(Je)&&vh(Wt,vt,ut,qe,dt,W.A)}return 0}function sl(z){var W=z.ma,ce=W.ba.S,ve=11>ce,Qe=ce==xh||ce==Hf||ce==PA||ce==di||ce==12||ki(ce);if(W.memory=null,W.Ib=null,W.Jb=null,W.Nd=null,!Qs(W.Oa,z,Qe?11:12))return 0;if(Qe&&ki(ce)&&cd(),z.da)alert("todo:use_scaling");else{if(ve){if(W.Ib=hr,z.Kb){if(ce=z.U+1>>1,W.memory=u(z.U+2*ce),W.memory==null)return 0;W.ec=W.memory,W.fc=0,W.cc=W.ec,W.dc=W.fc+z.U,W.Mc=W.cc,W.Nc=W.dc+ce,W.Ib=Bo,cd()}}else alert("todo:EmitYUV");Qe&&(W.Jb=xc,ve&&os())}if(ve&&!Is){for(z=0;256>z;++z)Ml[z]=89858*(z-128)+ru>>Bu,Ol[z]=-22014*(z-128)+ru,yf[z]=-45773*(z-128),Fs[z]=113618*(z-128)+ru>>Bu;for(z=ka;z<po;++z)W=76283*(z-16)+ru>>Bu,xf[z-ka]=Rr(W,255),dd[z-ka]=Rr(W+8>>4,15);Is=1}return 1}function _n(z){var W=z.ma,ce=z.U,ve=z.T;return t(!(1&z.ka)),0>=ce||0>=ve?0:(ce=W.Ib(z,W),W.Jb!=null&&W.Jb(z,W,ce),W.Dc+=ce,1)}function Tt(z){z.ma.memory=null}function pe(z,W,ce,ve){return lt(z,8)!=47?0:(W[0]=lt(z,14)+1,ce[0]=lt(z,14)+1,ve[0]=lt(z,1),lt(z,3)!=0?0:!z.h)}function be(z,W){if(4>z)return z+1;var ce=z-2>>1;return(2+(1&z)<<ce)+lt(W,ce)+1}function Ve(z,W){return 120<W?W-120:1<=(ce=((ce=Zd[W-1])>>4)*z+(8-(15&ce)))?ce:1;var ce}function rt(z,W,ce){var ve=Fe(ce),Qe=z[W+=255&ve].g-8;return 0<Qe&&(et(ce,ce.u+8),ve=Fe(ce),W+=z[W].value,W+=ve&(1<<Qe)-1),et(ce,ce.u+z[W].g),z[W].value}function je(z,W,ce){return ce.g+=z.g,ce.value+=z.value<<W>>>0,t(8>=ce.g),z.g}function oe(z,W,ce){var ve=z.xc;return t((W=ve==0?0:z.vc[z.md*(ce>>ve)+(W>>ve)])<z.Wb),z.Ya[W]}function Ee(z,W,ce,ve){var Qe=z.ab,qe=z.c*W,Je=z.C;W=Je+W;var ut=ce,dt=ve;for(ve=z.Ta,ce=z.Ua;0<Qe--;){var vt=z.gc[Qe],Wt=Je,dr=W,yt=ut,rr=dt,lr=(dt=ve,ut=ce,vt.Ea);switch(t(Wt<dr),t(dr<=vt.nc),vt.hc){case 2:_h(yt,rr,(dr-Wt)*lr,dt,ut);break;case 0:var Qr=Wt,gr=dr,Ur=dt,zr=ut,Gr=(si=vt).Ea;Qr==0&&(ls(yt,rr,null,null,1,Ur,zr),ta(yt,rr+1,0,0,Gr-1,Ur,zr+1),rr+=Gr,zr+=Gr,++Qr);for(var rn=1<<si.b,ni=rn-1,Qn=an(Gr,si.b),ra=si.K,si=si.w+(Qr>>si.b)*Qn;Qr<gr;){var Fa=ra,Vo=si,aa=1;for(lo(yt,rr,Ur,zr-Gr,1,Ur,zr);aa<Gr;){var Jn=(aa&~ni)+rn;Jn>Gr&&(Jn=Gr),(0,oc[Fa[Vo++]>>8&15])(yt,rr+ +aa,Ur,zr+aa-Gr,Jn-aa,Ur,zr+aa),aa=Jn}rr+=Gr,zr+=Gr,++Qr&ni||(si+=Qn)}dr!=vt.nc&&n(dt,ut-lr,dt,ut+(dr-Wt-1)*lr,lr);break;case 1:for(lr=yt,gr=rr,Gr=(yt=vt.Ea)-(zr=yt&~(Ur=(rr=1<<vt.b)-1)),Qr=an(yt,vt.b),rn=vt.K,vt=vt.w+(Wt>>vt.b)*Qr;Wt<dr;){for(ni=rn,Qn=vt,ra=new Ci,si=gr+zr,Fa=gr+yt;gr<si;)ti(ni[Qn++],ra),sc(ra,lr,gr,rr,dt,ut),gr+=rr,ut+=rr;gr<Fa&&(ti(ni[Qn++],ra),sc(ra,lr,gr,Gr,dt,ut),gr+=Gr,ut+=Gr),++Wt&Ur||(vt+=Qr)}break;case 3:if(yt==dt&&rr==ut&&0<vt.b){for(gr=dt,yt=lr=ut+(dr-Wt)*lr-(zr=(dr-Wt)*an(vt.Ea,vt.b)),rr=dt,Ur=ut,Qr=[],zr=(Gr=zr)-1;0<=zr;--zr)Qr[zr]=rr[Ur+zr];for(zr=Gr-1;0<=zr;--zr)gr[yt+zr]=Qr[zr];pf(vt,Wt,dr,dt,lr,dt,ut)}else pf(vt,Wt,dr,yt,rr,dt,ut)}ut=ve,dt=ce}dt!=ce&&n(ve,ce,ut,dt,qe)}function me(z,W){var ce=z.V,ve=z.Ba+z.c*z.C,Qe=W-z.C;if(t(W<=z.l.o),t(16>=Qe),0<Qe){var qe=z.l,Je=z.Ta,ut=z.Ua,dt=qe.width;if(Ee(z,Qe,ce,ve),Qe=ut=[ut],t((ce=z.C)<(ve=W)),t(qe.v<qe.va),ve>qe.o&&(ve=qe.o),ce<qe.j){var vt=qe.j-ce;ce=qe.j,Qe[0]+=vt*dt}if(ce>=ve?ce=0:(Qe[0]+=4*qe.v,qe.ka=ce-qe.j,qe.U=qe.va-qe.v,qe.T=ve-ce,ce=1),ce){if(ut=ut[0],11>(ce=z.ca).S){var Wt=ce.f.RGBA,dr=(ve=ce.S,Qe=qe.U,qe=qe.T,vt=Wt.eb,Wt.A),yt=qe;for(Wt=Wt.fb+z.Ma*Wt.A;0<yt--;){var rr=Je,lr=ut,Qr=Qe,gr=vt,Ur=Wt;switch(ve){case $d:Nf(rr,lr,Qr,gr,Ur);break;case xh:Il(rr,lr,Qr,gr,Ur);break;case LA:Il(rr,lr,Qr,gr,Ur),vh(gr,Ur,0,Qr,1,0);break;case Sm:Mo(rr,lr,Qr,gr,Ur);break;case Hf:yi(rr,lr,Qr,gr,Ur,1);break;case Vf:yi(rr,lr,Qr,gr,Ur,1),vh(gr,Ur,0,Qr,1,0);break;case PA:yi(rr,lr,Qr,gr,Ur,0);break;case hd:yi(rr,lr,Qr,gr,Ur,0),vh(gr,Ur,1,Qr,1,0);break;case di:Eu(rr,lr,Qr,gr,Ur);break;case MA:Eu(rr,lr,Qr,gr,Ur),Lr(gr,Ur,Qr,1,0);break;case Xd:Wa(rr,lr,Qr,gr,Ur);break;default:t(0)}ut+=dt,Wt+=dr}z.Ma+=qe}else alert("todo:EmitRescaledRowsYUVA");t(z.Ma<=ce.height)}}z.C=W,t(z.C<=z.i)}function xe(z){var W;if(0<z.ua)return 0;for(W=0;W<z.Wb;++W){var ce=z.Ya[W].G,ve=z.Ya[W].H;if(0<ce[1][ve[1]+0].g||0<ce[2][ve[2]+0].g||0<ce[3][ve[3]+0].g)return 0}return 1}function Ne(z,W,ce,ve,Qe,qe){if(z.Z!=0){var Je=z.qd,ut=z.rd;for(t(Ll[z.Z]!=null);W<ce;++W)Ll[z.Z](Je,ut,ve,Qe,ve,Qe,qe),Je=ve,ut=Qe,Qe+=qe;z.qd=Je,z.rd=ut}}function Oe(z,W){var ce=z.l.ma,ve=ce.Z==0||ce.Z==1?z.l.j:z.C;if(ve=z.C<ve?ve:z.C,t(W<=z.l.o),W>ve){var Qe=z.l.width,qe=ce.ca,Je=ce.tb+Qe*ve,ut=z.V,dt=z.Ba+z.c*ve,vt=z.gc;t(z.ab==1),t(vt[0].hc==3),Tc(vt[0],ve,W,ut,dt,qe,Je),Ne(ce,ve,W,qe,Je,Qe)}z.C=z.Ma=W}function St(z,W,ce,ve,Qe,qe,Je){var ut=z.$/ve,dt=z.$%ve,vt=z.m,Wt=z.s,dr=ce+z.$,yt=dr;Qe=ce+ve*Qe;var rr=ce+ve*qe,lr=280+Wt.ua,Qr=z.Pb?ut:16777216,gr=0<Wt.ua?Wt.Wa:null,Ur=Wt.wc,zr=dr<rr?oe(Wt,dt,ut):null;t(z.C<qe),t(rr<=Qe);var Gr=!1;e:for(;;){for(;Gr||dr<rr;){var rn=0;if(ut>=Qr){var ni=dr-ce;t((Qr=z).Pb),Qr.wd=Qr.m,Qr.xd=ni,0<Qr.s.ua&&En(Qr.s.Wa,Qr.s.vb),Qr=ut+wh}if(dt&Ur||(zr=oe(Wt,dt,ut)),t(zr!=null),zr.Qb&&(W[dr]=zr.qb,Gr=!0),!Gr)if(xt(vt),zr.jc){rn=vt,ni=W;var Qn=dr,ra=zr.pd[Fe(rn)&Ql-1];t(zr.jc),256>ra.g?(et(rn,rn.u+ra.g),ni[Qn]=ra.value,rn=0):(et(rn,rn.u+ra.g-256),t(256<=ra.value),rn=ra.value),rn==0&&(Gr=!0)}else rn=rt(zr.G[0],zr.H[0],vt);if(vt.h)break;if(Gr||256>rn){if(!Gr)if(zr.nd)W[dr]=(zr.qb|rn<<8)>>>0;else{if(xt(vt),Gr=rt(zr.G[1],zr.H[1],vt),xt(vt),ni=rt(zr.G[2],zr.H[2],vt),Qn=rt(zr.G[3],zr.H[3],vt),vt.h)break;W[dr]=(Qn<<24|Gr<<16|rn<<8|ni)>>>0}if(Gr=!1,++dr,++dt>=ve&&(dt=0,++ut,Je!=null&&ut<=qe&&!(ut%16)&&Je(z,ut),gr!=null))for(;yt<dr;)rn=W[yt++],gr.X[(506832829*rn&4294967295)>>>gr.Mb]=rn}else if(280>rn){if(rn=be(rn-256,vt),ni=rt(zr.G[4],zr.H[4],vt),xt(vt),ni=Ve(ve,ni=be(ni,vt)),vt.h)break;if(dr-ce<ni||Qe-dr<rn)break e;for(Qn=0;Qn<rn;++Qn)W[dr+Qn]=W[dr+Qn-ni];for(dr+=rn,dt+=rn;dt>=ve;)dt-=ve,++ut,Je!=null&&ut<=qe&&!(ut%16)&&Je(z,ut);if(t(dr<=Qe),dt&Ur&&(zr=oe(Wt,dt,ut)),gr!=null)for(;yt<dr;)rn=W[yt++],gr.X[(506832829*rn&4294967295)>>>gr.Mb]=rn}else{if(!(rn<lr))break e;for(Gr=rn-280,t(gr!=null);yt<dr;)rn=W[yt++],gr.X[(506832829*rn&4294967295)>>>gr.Mb]=rn;rn=dr,t(!(Gr>>>(ni=gr).Xa)),W[rn]=ni.X[Gr],Gr=!0}Gr||t(vt.h==Re(vt))}if(z.Pb&&vt.h&&dr<Qe)t(z.m.h),z.a=5,z.m=z.wd,z.$=z.xd,0<z.s.ua&&En(z.s.vb,z.s.Wa);else{if(vt.h)break e;Je?.(z,ut>qe?qe:ut),z.a=0,z.$=dr-ce}return 1}return z.a=3,0}function Ht(z){t(z!=null),z.vc=null,z.yc=null,z.Ya=null;var W=z.Wa;W!=null&&(W.X=null),z.vb=null,t(z!=null)}function Rt(){var z=new xo;return z==null?null:(z.a=0,z.xb=Wf,Nn("Predictor","VP8LPredictors"),Nn("Predictor","VP8LPredictors_C"),Nn("PredictorAdd","VP8LPredictorsAdd"),Nn("PredictorAdd","VP8LPredictorsAdd_C"),_h=bi,sc=vi,Nf=ua,Il=ca,Eu=Gn,Wa=Li,Mo=xa,we.VP8LMapColor32b=BA,we.VP8LMapColor8b=Ic,z)}function Vt(z,W,ce,ve,Qe){var qe=1,Je=[z],ut=[W],dt=ve.m,vt=ve.s,Wt=null,dr=0;e:for(;;){if(ce)for(;qe&&lt(dt,1);){var yt=Je,rr=ut,lr=ve,Qr=1,gr=lr.m,Ur=lr.gc[lr.ab],zr=lt(gr,2);if(lr.Oc&1<<zr)qe=0;else{switch(lr.Oc|=1<<zr,Ur.hc=zr,Ur.Ea=yt[0],Ur.nc=rr[0],Ur.K=[null],++lr.ab,t(4>=lr.ab),zr){case 0:case 1:Ur.b=lt(gr,3)+2,Qr=Vt(an(Ur.Ea,Ur.b),an(Ur.nc,Ur.b),0,lr,Ur.K),Ur.K=Ur.K[0];break;case 3:var Gr,rn=lt(gr,8)+1,ni=16<rn?0:4<rn?1:2<rn?2:3;if(yt[0]=an(Ur.Ea,ni),Ur.b=ni,Gr=Qr=Vt(rn,1,0,lr,Ur.K)){var Qn,ra=rn,si=Ur,Fa=1<<(8>>si.b),Vo=u(Fa);if(Vo==null)Gr=0;else{var aa=si.K[0],Jn=si.w;for(Vo[0]=si.K[0][0],Qn=1;Qn<1*ra;++Qn)Vo[Qn]=Pn(aa[Jn+Qn],Vo[Qn-1]);for(;Qn<4*Fa;++Qn)Vo[Qn]=0;si.K[0]=null,si.K[0]=Vo,Gr=1}}Qr=Gr;break;case 2:break;default:t(0)}qe=Qr}}if(Je=Je[0],ut=ut[0],qe&&lt(dt,1)&&!(qe=1<=(dr=lt(dt,4))&&11>=dr)){ve.a=3;break e}var Tn;if(Tn=qe)t:{var So,Gi,Ba,To=ve,Go=Je,ys=ut,Ko=dr,Wo=ce,Ps=To.m,ro=To.s,Pa=[null],La=1,wo=0,qa=Yd[Ko];r:for(;;){if(Wo&&lt(Ps,1)){var cs=lt(Ps,3)+2,rs=an(Go,cs),ja=an(ys,cs),Gs=rs*ja;if(!Vt(rs,ja,0,To,Pa))break r;for(Pa=Pa[0],ro.xc=cs,So=0;So<Gs;++So){var Mr=Pa[So]>>8&65535;Pa[So]=Mr,Mr>=La&&(La=Mr+1)}}if(Ps.h)break r;for(Gi=0;5>Gi;++Gi){var co=Kf[Gi];!Gi&&0<Ko&&(co+=1<<Ko),wo<co&&(wo=co)}var ns=d(La*qa,Ze),qo=La,bo=d(qo,Et);if(bo==null)var hn=null;else t(65536>=qo),hn=bo;var us=u(wo);if(hn==null||us==null||ns==null){To.a=1;break r}var jl=ns;for(So=Ba=0;So<La;++So){var Io=hn[So],el=Io.G,cc=Io.H,Su=0,Ls=1,Ms=0;for(Gi=0;5>Gi;++Gi){co=Kf[Gi],el[Gi]=jl,cc[Gi]=Ba,!Gi&&0<Ko&&(co+=1<<Ko);i:{var bf,xs=co,Ef=To,$o=us,Wh=jl,rp=Ba,Fo=0,iu=Ef.m,gd=lt(iu,1);if(l($o,0,0,xs),gd){var np=lt(iu,1)+1,au=lt(iu,1),oa=lt(iu,au==0?1:8);$o[oa]=1,np==2&&($o[oa=lt(iu,8)]=1);var Pc=1}else{var Po=u(19),is=lt(iu,4)+4;if(19<is){Ef.a=3;var ws=0;break i}for(bf=0;bf<is;++bf)Po[kp[bf]]=lt(iu,3);var Xf=void 0,Hl=void 0,Tu=Ef,Ju=Po,ur=xs,Kr=$o,Eh=0,_a=Tu.m,Bt=8,Lc=d(128,Ze);n:for(;Ie(Lc,0,7,Ju,19);){if(lt(_a,1)){var qh=2+2*lt(_a,3);if((Xf=2+lt(_a,qh))>ur)break n}else Xf=ur;for(Hl=0;Hl<ur&&Xf--;){xt(_a);var Bf=Lc[0+(127&Fe(_a))];et(_a,_a.u+Bf.g);var ou=Bf.value;if(16>ou)Kr[Hl++]=ou,ou!=0&&(Bt=ou);else{var ip=ou==16,RA=ou-16,Zf=Gf[RA],Iu=lt(_a,fd[RA])+Zf;if(Hl+Iu>ur)break n;for(var Im=ip?Bt:0;0<Iu--;)Kr[Hl++]=Im}}Eh=1;break n}Eh||(Tu.a=3),Pc=Eh}(Pc=Pc&&!iu.h)&&(Fo=Ie(Wh,rp,8,$o,xs)),Pc&&Fo!=0?ws=Fo:(Ef.a=3,ws=0)}if(ws==0)break r;if(Ls&&Rp[Gi]==1&&(Ls=jl[Ba].g==0),Su+=jl[Ba].g,Ba+=ws,3>=Gi){var Cf,Yf=us[0];for(Cf=1;Cf<co;++Cf)us[Cf]>Yf&&(Yf=us[Cf]);Ms+=Yf}}if(Io.nd=Ls,Io.Qb=0,Ls&&(Io.qb=(el[3][cc[3]+0].value<<24|el[1][cc[1]+0].value<<16|el[2][cc[2]+0].value)>>>0,Su==0&&256>el[0][cc[0]+0].value&&(Io.Qb=1,Io.qb+=el[0][cc[0]+0].value<<8)),Io.jc=!Io.Qb&&6>Ms,Io.jc){var Jf,Mc=Io;for(Jf=0;Jf<Ql;++Jf){var Bh=Jf,Oc=Mc.pd[Bh],eh=Mc.G[0][Mc.H[0]+Bh];256<=eh.value?(Oc.g=eh.g+256,Oc.value=eh.value):(Oc.g=0,Oc.value=0,Bh>>=je(eh,8,Oc),Bh>>=je(Mc.G[1][Mc.H[1]+Bh],16,Oc),Bh>>=je(Mc.G[2][Mc.H[2]+Bh],0,Oc),je(Mc.G[3][Mc.H[3]+Bh],24,Oc))}}}ro.vc=Pa,ro.Wb=La,ro.Ya=hn,ro.yc=ns,Tn=1;break t}Tn=0}if(!(qe=Tn)){ve.a=3;break e}if(0<dr){if(vt.ua=1<<dr,!mt(vt.Wa,dr)){ve.a=1,qe=0;break e}}else vt.ua=0;var $h=ve,_d=Je,Fm=ut,Ks=$h.s,ap=Ks.xc;if($h.c=_d,$h.i=Fm,Ks.md=an(_d,ap),Ks.wc=ap==0?-1:(1<<ap)-1,ce){ve.xb=Yu;break e}if((Wt=u(Je*ut))==null){ve.a=1,qe=0;break e}qe=(qe=St(ve,Wt,0,Je,ut,ut,null))&&!dt.h;break e}return qe?(Qe!=null?Qe[0]=Wt:(t(Wt==null),t(ce)),ve.$=0,ce||Ht(vt)):Ht(vt),qe}function Gt(z,W){var ce=z.c*z.i,ve=ce+W+16*W;return t(z.c<=W),z.V=u(ve),z.V==null?(z.Ta=null,z.Ua=0,z.a=1,0):(z.Ta=z.V,z.Ua=z.Ba+ce+W,1)}function br(z,W){var ce=z.C,ve=W-ce,Qe=z.V,qe=z.Ba+z.c*ce;for(t(W<=z.l.o);0<ve;){var Je=16<ve?16:ve,ut=z.l.ma,dt=z.l.width,vt=dt*Je,Wt=ut.ca,dr=ut.tb+dt*ce,yt=z.Ta,rr=z.Ua;Ee(z,Je,Qe,qe),TA(yt,rr,Wt,dr,vt),Ne(ut,ce,ce+Je,Wt,dr,dt),ve-=Je,Qe+=Je*z.c,ce+=Je}t(ce==W),z.C=z.Ma=W}function qr(){this.ub=this.yd=this.td=this.Rb=0}function Hr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Jr(){this.Fb=this.Bb=this.Cb=0,this.Zb=u(4),this.Lb=u(4)}function en(){this.Yb=function(){var z=[];return function W(ce,ve,Qe){for(var qe=Qe[ve],Je=0;Je<qe&&(ce.push(Qe.length>ve+1?[]:0),!(Qe.length<ve+1));Je++)W(ce[Je],ve+1,Qe)}(z,0,[3,11]),z}()}function Vn(){this.jb=u(3),this.Wc=a([4,8],en),this.Xc=a([4,17],en)}function Kn(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new u(4),this.od=new u(4)}function Sn(){this.ld=this.La=this.dd=this.tc=0}function Ii(){this.Na=this.la=0}function ha(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function sa(){this.ad=u(384),this.Za=0,this.Ob=u(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ya(){this.uc=this.M=this.Nb=0,this.wa=Array(new Sn),this.Y=0,this.ya=Array(new sa),this.aa=0,this.l=new so}function Ra(){this.y=u(16),this.f=u(8),this.ea=u(8)}function es(){this.cb=this.a=0,this.sc="",this.m=new ie,this.Od=new qr,this.Kc=new Hr,this.ed=new Kn,this.Qa=new Jr,this.Ic=this.$c=this.Aa=0,this.D=new Ya,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=d(8,ie),this.ia=0,this.pb=d(4,ha),this.Pa=new Vn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ra),this.Hd=0,this.rb=Array(new Ii),this.sb=0,this.wa=Array(new Sn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new sa),this.L=this.aa=0,this.gd=a([4,2],Sn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function so(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ss(){var z=new es;return z!=null&&(z.a=0,z.sc="OK",z.cb=0,z.Xb=0,bh||(bh=Ul)),z}function Co(z,W,ce){return z.a==0&&(z.a=W,z.sc=ce,z.cb=0),0}function Rf(z,W,ce){return 3<=ce&&z[W+0]==157&&z[W+1]==1&&z[W+2]==42}function Hu(z,W){if(z==null)return 0;if(z.a=0,z.sc="OK",W==null)return Co(z,2,"null VP8Io passed to VP8GetHeaders()");var ce=W.data,ve=W.w,Qe=W.ha;if(4>Qe)return Co(z,7,"Truncated header.");var qe=ce[ve+0]|ce[ve+1]<<8|ce[ve+2]<<16,Je=z.Od;if(Je.Rb=!(1&qe),Je.td=qe>>1&7,Je.yd=qe>>4&1,Je.ub=qe>>5,3<Je.td)return Co(z,3,"Incorrect keyframe parameters.");if(!Je.yd)return Co(z,4,"Frame not displayable.");ve+=3,Qe-=3;var ut=z.Kc;if(Je.Rb){if(7>Qe)return Co(z,7,"cannot parse picture header");if(!Rf(ce,ve,Qe))return Co(z,3,"Bad code word");ut.c=16383&(ce[ve+4]<<8|ce[ve+3]),ut.Td=ce[ve+4]>>6,ut.i=16383&(ce[ve+6]<<8|ce[ve+5]),ut.Ud=ce[ve+6]>>6,ve+=7,Qe-=7,z.za=ut.c+15>>4,z.Ub=ut.i+15>>4,W.width=ut.c,W.height=ut.i,W.Da=0,W.j=0,W.v=0,W.va=W.width,W.o=W.height,W.da=0,W.ib=W.width,W.hb=W.height,W.U=W.width,W.T=W.height,l((qe=z.Pa).jb,0,255,qe.jb.length),t((qe=z.Qa)!=null),qe.Cb=0,qe.Bb=0,qe.Fb=1,l(qe.Zb,0,0,qe.Zb.length),l(qe.Lb,0,0,qe.Lb)}if(Je.ub>Qe)return Co(z,7,"bad partition length");Ut(qe=z.m,ce,ve,Je.ub),ve+=Je.ub,Qe-=Je.ub,Je.Rb&&(ut.Ld=pt(qe),ut.Kd=pt(qe)),ut=z.Qa;var dt,vt=z.Pa;if(t(qe!=null),t(ut!=null),ut.Cb=pt(qe),ut.Cb){if(ut.Bb=pt(qe),pt(qe)){for(ut.Fb=pt(qe),dt=0;4>dt;++dt)ut.Zb[dt]=pt(qe)?bt(qe,7):0;for(dt=0;4>dt;++dt)ut.Lb[dt]=pt(qe)?bt(qe,6):0}if(ut.Bb)for(dt=0;3>dt;++dt)vt.jb[dt]=pt(qe)?jt(qe,8):255}else ut.Bb=0;if(qe.Ka)return Co(z,3,"cannot parse segment header");if((ut=z.ed).zd=pt(qe),ut.Tb=jt(qe,6),ut.wb=jt(qe,3),ut.Pc=pt(qe),ut.Pc&&pt(qe)){for(vt=0;4>vt;++vt)pt(qe)&&(ut.vd[vt]=bt(qe,6));for(vt=0;4>vt;++vt)pt(qe)&&(ut.od[vt]=bt(qe,6))}if(z.L=ut.Tb==0?0:ut.zd?1:2,qe.Ka)return Co(z,3,"cannot parse filter header");var Wt=Qe;if(Qe=dt=ve,ve=dt+Wt,ut=Wt,z.Xb=(1<<jt(z.m,2))-1,Wt<3*(vt=z.Xb))ce=7;else{for(dt+=3*vt,ut-=3*vt,Wt=0;Wt<vt;++Wt){var dr=ce[Qe+0]|ce[Qe+1]<<8|ce[Qe+2]<<16;dr>ut&&(dr=ut),Ut(z.Jc[+Wt],ce,dt,dr),dt+=dr,ut-=dr,Qe+=3}Ut(z.Jc[+vt],ce,dt,ut),ce=dt<ve?0:5}if(ce!=0)return Co(z,ce,"cannot parse partitions");for(ce=jt(dt=z.m,7),Qe=pt(dt)?bt(dt,4):0,ve=pt(dt)?bt(dt,4):0,ut=pt(dt)?bt(dt,4):0,vt=pt(dt)?bt(dt,4):0,dt=pt(dt)?bt(dt,4):0,Wt=z.Qa,dr=0;4>dr;++dr){if(Wt.Cb){var yt=Wt.Zb[dr];Wt.Fb||(yt+=ce)}else{if(0<dr){z.pb[dr]=z.pb[0];continue}yt=ce}var rr=z.pb[dr];rr.Sc[0]=Zu[Rr(yt+Qe,127)],rr.Sc[1]=gf[Rr(yt+0,127)],rr.Eb[0]=2*Zu[Rr(yt+ve,127)],rr.Eb[1]=101581*gf[Rr(yt+ut,127)]>>16,8>rr.Eb[1]&&(rr.Eb[1]=8),rr.Qc[0]=Zu[Rr(yt+vt,117)],rr.Qc[1]=gf[Rr(yt+dt,127)],rr.lc=yt+dt}if(!Je.Rb)return Co(z,4,"Not a key frame.");for(pt(qe),Je=z.Pa,ce=0;4>ce;++ce){for(Qe=0;8>Qe;++Qe)for(ve=0;3>ve;++ve)for(ut=0;11>ut;++ut)vt=Ct(qe,tp[ce][Qe][ve][ut])?jt(qe,8):Up[ce][Qe][ve][ut],Je.Wc[ce][Qe].Yb[ve][ut]=vt;for(Qe=0;17>Qe;++Qe)Je.Xc[ce][Qe]=Je.Wc[ce][DA[Qe]]}return z.kc=pt(qe),z.kc&&(z.Bd=jt(qe,8)),z.cb=1}function Ul(z,W,ce,ve,Qe,qe,Je){var ut=W[Qe].Yb[ce];for(ce=0;16>Qe;++Qe){if(!Ct(z,ut[ce+0]))return Qe;for(;!Ct(z,ut[ce+1]);)if(ut=W[++Qe].Yb[0],ce=0,Qe==16)return 16;var dt=W[Qe+1].Yb;if(Ct(z,ut[ce+2])){var vt=z,Wt=0;if(Ct(vt,(yt=ut)[(dr=ce)+3]))if(Ct(vt,yt[dr+6])){for(ut=0,dr=2*(Wt=Ct(vt,yt[dr+8]))+(yt=Ct(vt,yt[dr+9+Wt])),Wt=0,yt=_f[dr];yt[ut];++ut)Wt+=Wt+Ct(vt,yt[ut]);Wt+=3+(8<<dr)}else Ct(vt,yt[dr+7])?(Wt=7+2*Ct(vt,165),Wt+=Ct(vt,145)):Wt=5+Ct(vt,159);else Wt=Ct(vt,yt[dr+4])?3+Ct(vt,yt[dr+5]):2;ut=dt[2]}else Wt=1,ut=dt[1];dt=Je+Jd[Qe],0>(vt=z).b&&Dt(vt);var dr,yt=vt.b,rr=(dr=vt.Ca>>1)-(vt.I>>yt)>>31;--vt.b,vt.Ca+=rr,vt.Ca|=1,vt.I-=(dr+1&rr)<<yt,qe[dt]=((Wt^rr)-rr)*ve[(0<Qe)+0]}return 16}function wc(z){var W=z.rb[z.sb-1];W.la=0,W.Na=0,l(z.zc,0,0,z.zc.length),z.ja=0}function Cl(z,W,ce,ve,Qe){Qe=z[W+ce+32*ve]+(Qe>>3),z[W+ce+32*ve]=-256&Qe?0>Qe?0:255:Qe}function qc(z,W,ce,ve,Qe,qe){Cl(z,W,0,ce,ve+Qe),Cl(z,W,1,ce,ve+qe),Cl(z,W,2,ce,ve-qe),Cl(z,W,3,ce,ve-Qe)}function No(z){return(20091*z>>16)+z}function fh(z,W,ce,ve){var Qe,qe=0,Je=u(16);for(Qe=0;4>Qe;++Qe){var ut=z[W+0]+z[W+8],dt=z[W+0]-z[W+8],vt=(35468*z[W+4]>>16)-No(z[W+12]),Wt=No(z[W+4])+(35468*z[W+12]>>16);Je[qe+0]=ut+Wt,Je[qe+1]=dt+vt,Je[qe+2]=dt-vt,Je[qe+3]=ut-Wt,qe+=4,W++}for(Qe=qe=0;4>Qe;++Qe)ut=(z=Je[qe+0]+4)+Je[qe+8],dt=z-Je[qe+8],vt=(35468*Je[qe+4]>>16)-No(Je[qe+12]),Cl(ce,ve,0,0,ut+(Wt=No(Je[qe+4])+(35468*Je[qe+12]>>16))),Cl(ce,ve,1,0,dt+vt),Cl(ce,ve,2,0,dt-vt),Cl(ce,ve,3,0,ut-Wt),qe++,ve+=32}function bc(z,W,ce,ve){var Qe=z[W+0]+4,qe=35468*z[W+4]>>16,Je=No(z[W+4]),ut=35468*z[W+1]>>16;qc(ce,ve,0,Qe+Je,z=No(z[W+1]),ut),qc(ce,ve,1,Qe+qe,z,ut),qc(ce,ve,2,Qe-qe,z,ut),qc(ce,ve,3,Qe-Je,z,ut)}function Sl(z,W,ce,ve,Qe){fh(z,W,ce,ve),Qe&&fh(z,W+16,ce,ve+4)}function ll(z,W,ce,ve){Ts(z,W+0,ce,ve,1),Ts(z,W+32,ce,ve+128,1)}function cl(z,W,ce,ve){var Qe;for(z=z[W+0]+4,Qe=0;4>Qe;++Qe)for(W=0;4>W;++W)Cl(ce,ve,W,Qe,z)}function Nl(z,W,ce,ve){z[W+0]&&eu(z,W+0,ce,ve),z[W+16]&&eu(z,W+16,ce,ve+4),z[W+32]&&eu(z,W+32,ce,ve+128),z[W+48]&&eu(z,W+48,ce,ve+128+4)}function ma(z,W,ce,ve){var Qe,qe=u(16);for(Qe=0;4>Qe;++Qe){var Je=z[W+0+Qe]+z[W+12+Qe],ut=z[W+4+Qe]+z[W+8+Qe],dt=z[W+4+Qe]-z[W+8+Qe],vt=z[W+0+Qe]-z[W+12+Qe];qe[0+Qe]=Je+ut,qe[8+Qe]=Je-ut,qe[4+Qe]=vt+dt,qe[12+Qe]=vt-dt}for(Qe=0;4>Qe;++Qe)Je=(z=qe[0+4*Qe]+3)+qe[3+4*Qe],ut=qe[1+4*Qe]+qe[2+4*Qe],dt=qe[1+4*Qe]-qe[2+4*Qe],vt=z-qe[3+4*Qe],ce[ve+0]=Je+ut>>3,ce[ve+16]=vt+dt>>3,ce[ve+32]=Je-ut>>3,ce[ve+48]=vt-dt>>3,ve+=64}function $c(z,W,ce){var ve,Qe=W-32,qe=Ho,Je=255-z[Qe-1];for(ve=0;ve<ce;++ve){var ut,dt=qe,vt=Je+z[W-1];for(ut=0;ut<ce;++ut)z[W+ut]=dt[vt+z[Qe+ut]];W+=32}}function ec(z,W){$c(z,W,4)}function Nh(z,W){$c(z,W,8)}function Ah(z,W){$c(z,W,16)}function zh(z,W){var ce;for(ce=0;16>ce;++ce)n(z,W+32*ce,z,W-32,16)}function hf(z,W){var ce;for(ce=16;0<ce;--ce)l(z,W,z[W-1],16),W+=32}function Vu(z,W,ce){var ve;for(ve=0;16>ve;++ve)l(W,ce+32*ve,z,16)}function zo(z,W){var ce,ve=16;for(ce=0;16>ce;++ce)ve+=z[W-1+32*ce]+z[W+ce-32];Vu(ve>>5,z,W)}function zl(z,W){var ce,ve=8;for(ce=0;16>ce;++ce)ve+=z[W-1+32*ce];Vu(ve>>4,z,W)}function ul(z,W){var ce,ve=8;for(ce=0;16>ce;++ce)ve+=z[W+ce-32];Vu(ve>>4,z,W)}function Tl(z,W){Vu(128,z,W)}function Hi(z,W,ce){return z+2*W+ce+2>>2}function ff(z,W){var ce,ve=W-32;for(ve=new Uint8Array([Hi(z[ve-1],z[ve+0],z[ve+1]),Hi(z[ve+0],z[ve+1],z[ve+2]),Hi(z[ve+1],z[ve+2],z[ve+3]),Hi(z[ve+2],z[ve+3],z[ve+4])]),ce=0;4>ce;++ce)n(z,W+32*ce,ve,0,ve.length)}function Ec(z,W){var ce=z[W-1],ve=z[W-1+32],Qe=z[W-1+64],qe=z[W-1+96];mr(z,W+0,16843009*Hi(z[W-1-32],ce,ve)),mr(z,W+32,16843009*Hi(ce,ve,Qe)),mr(z,W+64,16843009*Hi(ve,Qe,qe)),mr(z,W+96,16843009*Hi(Qe,qe,qe))}function Ui(z,W){var ce,ve=4;for(ce=0;4>ce;++ce)ve+=z[W+ce-32]+z[W-1+32*ce];for(ve>>=3,ce=0;4>ce;++ce)l(z,W+32*ce,ve,4)}function kf(z,W){var ce=z[W-1+0],ve=z[W-1+32],Qe=z[W-1+64],qe=z[W-1-32],Je=z[W+0-32],ut=z[W+1-32],dt=z[W+2-32],vt=z[W+3-32];z[W+0+96]=Hi(ve,Qe,z[W-1+96]),z[W+1+96]=z[W+0+64]=Hi(ce,ve,Qe),z[W+2+96]=z[W+1+64]=z[W+0+32]=Hi(qe,ce,ve),z[W+3+96]=z[W+2+64]=z[W+1+32]=z[W+0+0]=Hi(Je,qe,ce),z[W+3+64]=z[W+2+32]=z[W+1+0]=Hi(ut,Je,qe),z[W+3+32]=z[W+2+0]=Hi(dt,ut,Je),z[W+3+0]=Hi(vt,dt,ut)}function hl(z,W){var ce=z[W+1-32],ve=z[W+2-32],Qe=z[W+3-32],qe=z[W+4-32],Je=z[W+5-32],ut=z[W+6-32],dt=z[W+7-32];z[W+0+0]=Hi(z[W+0-32],ce,ve),z[W+1+0]=z[W+0+32]=Hi(ce,ve,Qe),z[W+2+0]=z[W+1+32]=z[W+0+64]=Hi(ve,Qe,qe),z[W+3+0]=z[W+2+32]=z[W+1+64]=z[W+0+96]=Hi(Qe,qe,Je),z[W+3+32]=z[W+2+64]=z[W+1+96]=Hi(qe,Je,ut),z[W+3+64]=z[W+2+96]=Hi(Je,ut,dt),z[W+3+96]=Hi(ut,dt,dt)}function Xc(z,W){var ce=z[W-1+0],ve=z[W-1+32],Qe=z[W-1+64],qe=z[W-1-32],Je=z[W+0-32],ut=z[W+1-32],dt=z[W+2-32],vt=z[W+3-32];z[W+0+0]=z[W+1+64]=qe+Je+1>>1,z[W+1+0]=z[W+2+64]=Je+ut+1>>1,z[W+2+0]=z[W+3+64]=ut+dt+1>>1,z[W+3+0]=dt+vt+1>>1,z[W+0+96]=Hi(Qe,ve,ce),z[W+0+64]=Hi(ve,ce,qe),z[W+0+32]=z[W+1+96]=Hi(ce,qe,Je),z[W+1+32]=z[W+2+96]=Hi(qe,Je,ut),z[W+2+32]=z[W+3+96]=Hi(Je,ut,dt),z[W+3+32]=Hi(ut,dt,vt)}function Kd(z,W){var ce=z[W+0-32],ve=z[W+1-32],Qe=z[W+2-32],qe=z[W+3-32],Je=z[W+4-32],ut=z[W+5-32],dt=z[W+6-32],vt=z[W+7-32];z[W+0+0]=ce+ve+1>>1,z[W+1+0]=z[W+0+64]=ve+Qe+1>>1,z[W+2+0]=z[W+1+64]=Qe+qe+1>>1,z[W+3+0]=z[W+2+64]=qe+Je+1>>1,z[W+0+32]=Hi(ce,ve,Qe),z[W+1+32]=z[W+0+96]=Hi(ve,Qe,qe),z[W+2+32]=z[W+1+96]=Hi(Qe,qe,Je),z[W+3+32]=z[W+2+96]=Hi(qe,Je,ut),z[W+3+64]=Hi(Je,ut,dt),z[W+3+96]=Hi(ut,dt,vt)}function dh(z,W){var ce=z[W-1+0],ve=z[W-1+32],Qe=z[W-1+64],qe=z[W-1+96];z[W+0+0]=ce+ve+1>>1,z[W+2+0]=z[W+0+32]=ve+Qe+1>>1,z[W+2+32]=z[W+0+64]=Qe+qe+1>>1,z[W+1+0]=Hi(ce,ve,Qe),z[W+3+0]=z[W+1+32]=Hi(ve,Qe,qe),z[W+3+32]=z[W+1+64]=Hi(Qe,qe,qe),z[W+3+64]=z[W+2+64]=z[W+0+96]=z[W+1+96]=z[W+2+96]=z[W+3+96]=qe}function Zc(z,W){var ce=z[W-1+0],ve=z[W-1+32],Qe=z[W-1+64],qe=z[W-1+96],Je=z[W-1-32],ut=z[W+0-32],dt=z[W+1-32],vt=z[W+2-32];z[W+0+0]=z[W+2+32]=ce+Je+1>>1,z[W+0+32]=z[W+2+64]=ve+ce+1>>1,z[W+0+64]=z[W+2+96]=Qe+ve+1>>1,z[W+0+96]=qe+Qe+1>>1,z[W+3+0]=Hi(ut,dt,vt),z[W+2+0]=Hi(Je,ut,dt),z[W+1+0]=z[W+3+32]=Hi(ce,Je,ut),z[W+1+32]=z[W+3+64]=Hi(ve,ce,Je),z[W+1+64]=z[W+3+96]=Hi(Qe,ve,ce),z[W+1+96]=Hi(qe,Qe,ve)}function _u(z,W){var ce;for(ce=0;8>ce;++ce)n(z,W+32*ce,z,W-32,8)}function tc(z,W){var ce;for(ce=0;8>ce;++ce)l(z,W,z[W-1],8),W+=32}function Gu(z,W,ce){var ve;for(ve=0;8>ve;++ve)l(W,ce+32*ve,z,8)}function Bc(z,W){var ce,ve=8;for(ce=0;8>ce;++ce)ve+=z[W+ce-32]+z[W-1+32*ce];Gu(ve>>4,z,W)}function Uf(z,W){var ce,ve=4;for(ce=0;8>ce;++ce)ve+=z[W+ce-32];Gu(ve>>3,z,W)}function ph(z,W){var ce,ve=4;for(ce=0;8>ce;++ce)ve+=z[W-1+32*ce];Gu(ve>>3,z,W)}function Ku(z,W){Gu(128,z,W)}function mh(z,W,ce){var ve=z[W-ce],Qe=z[W+0],qe=3*(Qe-ve)+Fl[1020+z[W-2*ce]-z[W+ce]],Je=yh[112+(qe+4>>3)];z[W-ce]=Ho[255+ve+yh[112+(qe+3>>3)]],z[W+0]=Ho[255+Qe-Je]}function Cc(z,W,ce,ve){var Qe=z[W+0],qe=z[W+ce];return ai[255+z[W-2*ce]-z[W-ce]]>ve||ai[255+qe-Qe]>ve}function vu(z,W,ce,ve){return 4*ai[255+z[W-ce]-z[W+0]]+ai[255+z[W-2*ce]-z[W+ce]]<=ve}function rc(z,W,ce,ve,Qe){var qe=z[W-3*ce],Je=z[W-2*ce],ut=z[W-ce],dt=z[W+0],vt=z[W+ce],Wt=z[W+2*ce],dr=z[W+3*ce];return 4*ai[255+ut-dt]+ai[255+Je-vt]>ve?0:ai[255+z[W-4*ce]-qe]<=Qe&&ai[255+qe-Je]<=Qe&&ai[255+Je-ut]<=Qe&&ai[255+dr-Wt]<=Qe&&ai[255+Wt-vt]<=Qe&&ai[255+vt-dt]<=Qe}function ts(z,W,ce,ve){var Qe=2*ve+1;for(ve=0;16>ve;++ve)vu(z,W+ve,ce,Qe)&&mh(z,W+ve,ce)}function Wu(z,W,ce,ve){var Qe=2*ve+1;for(ve=0;16>ve;++ve)vu(z,W+ve*ce,1,Qe)&&mh(z,W+ve*ce,1)}function gh(z,W,ce,ve){var Qe;for(Qe=3;0<Qe;--Qe)ts(z,W+=4*ce,ce,ve)}function yu(z,W,ce,ve){var Qe;for(Qe=3;0<Qe;--Qe)Wu(z,W+=4,ce,ve)}function fo(z,W,ce,ve,Qe,qe,Je,ut){for(qe=2*qe+1;0<Qe--;){if(rc(z,W,ce,qe,Je))if(Cc(z,W,ce,ut))mh(z,W,ce);else{var dt=z,vt=W,Wt=ce,dr=dt[vt-2*Wt],yt=dt[vt-Wt],rr=dt[vt+0],lr=dt[vt+Wt],Qr=dt[vt+2*Wt],gr=27*(zr=Fl[1020+3*(rr-yt)+Fl[1020+dr-lr]])+63>>7,Ur=18*zr+63>>7,zr=9*zr+63>>7;dt[vt-3*Wt]=Ho[255+dt[vt-3*Wt]+zr],dt[vt-2*Wt]=Ho[255+dr+Ur],dt[vt-Wt]=Ho[255+yt+gr],dt[vt+0]=Ho[255+rr-gr],dt[vt+Wt]=Ho[255+lr-Ur],dt[vt+2*Wt]=Ho[255+Qr-zr]}W+=ve}}function nc(z,W,ce,ve,Qe,qe,Je,ut){for(qe=2*qe+1;0<Qe--;){if(rc(z,W,ce,qe,Je))if(Cc(z,W,ce,ut))mh(z,W,ce);else{var dt=z,vt=W,Wt=ce,dr=dt[vt-Wt],yt=dt[vt+0],rr=dt[vt+Wt],lr=yh[112+(4+(Qr=3*(yt-dr))>>3)],Qr=yh[112+(Qr+3>>3)],gr=lr+1>>1;dt[vt-2*Wt]=Ho[255+dt[vt-2*Wt]+gr],dt[vt-Wt]=Ho[255+dr+Qr],dt[vt+0]=Ho[255+yt-lr],dt[vt+Wt]=Ho[255+rr-gr]}W+=ve}}function ne(z,W,ce,ve,Qe,qe){fo(z,W,ce,1,16,ve,Qe,qe)}function ze(z,W,ce,ve,Qe,qe){fo(z,W,1,ce,16,ve,Qe,qe)}function ft(z,W,ce,ve,Qe,qe){var Je;for(Je=3;0<Je;--Je)nc(z,W+=4*ce,ce,1,16,ve,Qe,qe)}function Qt(z,W,ce,ve,Qe,qe){var Je;for(Je=3;0<Je;--Je)nc(z,W+=4,1,ce,16,ve,Qe,qe)}function sr(z,W,ce,ve,Qe,qe,Je,ut){fo(z,W,Qe,1,8,qe,Je,ut),fo(ce,ve,Qe,1,8,qe,Je,ut)}function Xr(z,W,ce,ve,Qe,qe,Je,ut){fo(z,W,1,Qe,8,qe,Je,ut),fo(ce,ve,1,Qe,8,qe,Je,ut)}function tr(z,W,ce,ve,Qe,qe,Je,ut){nc(z,W+4*Qe,Qe,1,8,qe,Je,ut),nc(ce,ve+4*Qe,Qe,1,8,qe,Je,ut)}function ri(z,W,ce,ve,Qe,qe,Je,ut){nc(z,W+4,1,Qe,8,qe,Je,ut),nc(ce,ve+4,1,Qe,8,qe,Je,ut)}function Yn(){this.ba=new ba,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ea,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Bi(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Si(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ga(){this.ua=0,this.Wa=new $r,this.vb=new $r,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Et,this.yc=new Ze}function xo(){this.xb=this.a=0,this.l=new so,this.ca=new ba,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Le,this.Pb=0,this.wd=new Le,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ga,this.ab=0,this.gc=d(4,Si),this.Oc=0}function Yr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new so,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Un(z,W,ce,ve,Qe,qe,Je){for(z=z==null?0:z[W+0],W=0;W<Je;++W)Qe[qe+W]=z+ce[ve+W]&255,z=Qe[qe+W]}function oi(z,W,ce,ve,Qe,qe,Je){var ut;if(z==null)Un(null,null,ce,ve,Qe,qe,Je);else for(ut=0;ut<Je;++ut)Qe[qe+ut]=z[W+ut]+ce[ve+ut]&255}function Ka(z,W,ce,ve,Qe,qe,Je){if(z==null)Un(null,null,ce,ve,Qe,qe,Je);else{var ut,dt=z[W+0],vt=dt,Wt=dt;for(ut=0;ut<Je;++ut)vt=Wt+(dt=z[W+ut])-vt,Wt=ce[ve+ut]+(-256&vt?0>vt?0:255:vt)&255,vt=dt,Qe[qe+ut]=Wt}}function Qo(z,W,ce,ve){var Qe=W.width,qe=W.o;if(t(z!=null&&W!=null),0>ce||0>=ve||ce+ve>qe)return null;if(!z.Cc){if(z.ga==null){var Je;if(z.ga=new Yr,(Je=z.ga==null)||(Je=W.width*W.o,t(z.Gb.length==0),z.Gb=u(Je),z.Uc=0,z.Gb==null?Je=0:(z.mb=z.Gb,z.nb=z.Uc,z.rc=null,Je=1),Je=!Je),!Je){Je=z.ga;var ut=z.Fa,dt=z.P,vt=z.qc,Wt=z.mb,dr=z.nb,yt=dt+1,rr=vt-1,lr=Je.l;if(t(ut!=null&&Wt!=null&&W!=null),Ll[0]=null,Ll[1]=Un,Ll[2]=oi,Ll[3]=Ka,Je.ca=Wt,Je.tb=dr,Je.c=W.width,Je.i=W.height,t(0<Je.c&&0<Je.i),1>=vt)W=0;else if(Je.$a=3&ut[dt+0],Je.Z=ut[dt+0]>>2&3,Je.Lc=ut[dt+0]>>4&3,dt=ut[dt+0]>>6&3,0>Je.$a||1<Je.$a||4<=Je.Z||1<Je.Lc||dt)W=0;else if(lr.put=_n,lr.ac=sl,lr.bc=Tt,lr.ma=Je,lr.width=W.width,lr.height=W.height,lr.Da=W.Da,lr.v=W.v,lr.va=W.va,lr.j=W.j,lr.o=W.o,Je.$a)e:{t(Je.$a==1),W=Rt();t:for(;;){if(W==null){W=0;break e}if(t(Je!=null),Je.mc=W,W.c=Je.c,W.i=Je.i,W.l=Je.l,W.l.ma=Je,W.l.width=Je.c,W.l.height=Je.i,W.a=0,Nt(W.m,ut,yt,rr),!Vt(Je.c,Je.i,1,W,null)||(W.ab==1&&W.gc[0].hc==3&&xe(W.s)?(Je.ic=1,ut=W.c*W.i,W.Ta=null,W.Ua=0,W.V=u(ut),W.Ba=0,W.V==null?(W.a=1,W=0):W=1):(Je.ic=0,W=Gt(W,Je.c)),!W))break t;W=1;break e}Je.mc=null,W=0}else W=rr>=Je.c*Je.i;Je=!W}if(Je)return null;z.ga.Lc!=1?z.Ga=0:ve=qe-ce}t(z.ga!=null),t(ce+ve<=qe);e:{if(W=(ut=z.ga).c,qe=ut.l.o,ut.$a==0){if(yt=z.rc,rr=z.Vc,lr=z.Fa,dt=z.P+1+ce*W,vt=z.mb,Wt=z.nb+ce*W,t(dt<=z.P+z.qc),ut.Z!=0)for(t(Ll[ut.Z]!=null),Je=0;Je<ve;++Je)Ll[ut.Z](yt,rr,lr,dt,vt,Wt,W),yt=vt,rr=Wt,Wt+=W,dt+=W;else for(Je=0;Je<ve;++Je)n(vt,Wt,lr,dt,W),yt=vt,rr=Wt,Wt+=W,dt+=W;z.rc=yt,z.Vc=rr}else{if(t(ut.mc!=null),W=ce+ve,t((Je=ut.mc)!=null),t(W<=Je.i),Je.C>=W)W=1;else if(ut.ic||os(),ut.ic){ut=Je.V,yt=Je.Ba,rr=Je.c;var Qr=Je.i,gr=(lr=1,dt=Je.$/rr,vt=Je.$%rr,Wt=Je.m,dr=Je.s,Je.$),Ur=rr*Qr,zr=rr*W,Gr=dr.wc,rn=gr<zr?oe(dr,vt,dt):null;t(gr<=Ur),t(W<=Qr),t(xe(dr));t:for(;;){for(;!Wt.h&&gr<zr;){if(vt&Gr||(rn=oe(dr,vt,dt)),t(rn!=null),xt(Wt),256>(Qr=rt(rn.G[0],rn.H[0],Wt)))ut[yt+gr]=Qr,++gr,++vt>=rr&&(vt=0,++dt<=W&&!(dt%16)&&Oe(Je,dt));else{if(!(280>Qr)){lr=0;break t}Qr=be(Qr-256,Wt);var ni,Qn=rt(rn.G[4],rn.H[4],Wt);if(xt(Wt),!(gr>=(Qn=Ve(rr,Qn=be(Qn,Wt)))&&Ur-gr>=Qr)){lr=0;break t}for(ni=0;ni<Qr;++ni)ut[yt+gr+ni]=ut[yt+gr+ni-Qn];for(gr+=Qr,vt+=Qr;vt>=rr;)vt-=rr,++dt<=W&&!(dt%16)&&Oe(Je,dt);gr<zr&&vt&Gr&&(rn=oe(dr,vt,dt))}t(Wt.h==Re(Wt))}Oe(Je,dt>W?W:dt);break t}!lr||Wt.h&&gr<Ur?(lr=0,Je.a=Wt.h?5:3):Je.$=gr,W=lr}else W=St(Je,Je.V,Je.Ba,Je.c,Je.i,W,br);if(!W){ve=0;break e}}ce+ve>=qe&&(z.Cc=1),ve=1}if(!ve)return null;if(z.Cc&&((ve=z.ga)!=null&&(ve.mc=null),z.ga=null,0<z.Ga))return alert("todo:WebPDequantizeLevels"),null}return z.nb+ce*Qe}function Oi(z,W,ce,ve,Qe,qe){for(;0<Qe--;){var Je,ut=z,dt=W+(ce?1:0),vt=z,Wt=W+(ce?0:3);for(Je=0;Je<ve;++Je){var dr=vt[Wt+4*Je];dr!=255&&(dr*=32897,ut[dt+4*Je+0]=ut[dt+4*Je+0]*dr>>23,ut[dt+4*Je+1]=ut[dt+4*Je+1]*dr>>23,ut[dt+4*Je+2]=ut[dt+4*Je+2]*dr>>23)}W+=qe}}function qu(z,W,ce,ve,Qe){for(;0<ve--;){var qe;for(qe=0;qe<ce;++qe){var Je=z[W+2*qe+0],ut=15&(vt=z[W+2*qe+1]),dt=4369*ut,vt=(240&vt|vt>>4)*dt>>16;z[W+2*qe+0]=(240&Je|Je>>4)*dt>>16&240|(15&Je|Je<<4)*dt>>16>>4&15,z[W+2*qe+1]=240&vt|ut}W+=Qe}}function Af(z,W,ce,ve,Qe,qe,Je,ut){var dt,vt,Wt=255;for(vt=0;vt<Qe;++vt){for(dt=0;dt<ve;++dt){var dr=z[W+dt];qe[Je+4*dt]=dr,Wt&=dr}W+=ce,Je+=ut}return Wt!=255}function df(z,W,ce,ve,Qe){var qe;for(qe=0;qe<Qe;++qe)ce[ve+qe]=z[W+qe]>>8}function os(){vh=Oi,Lr=qu,Qf=Af,TA=df}function Qa(z,W,ce){we[z]=function(ve,Qe,qe,Je,ut,dt,vt,Wt,dr,yt,rr,lr,Qr,gr,Ur,zr,Gr){var rn,ni=Gr-1>>1,Qn=ut[dt+0]|vt[Wt+0]<<16,ra=dr[yt+0]|rr[lr+0]<<16;t(ve!=null);var si=3*Qn+ra+131074>>2;for(W(ve[Qe+0],255&si,si>>16,Qr,gr),qe!=null&&(si=3*ra+Qn+131074>>2,W(qe[Je+0],255&si,si>>16,Ur,zr)),rn=1;rn<=ni;++rn){var Fa=ut[dt+rn]|vt[Wt+rn]<<16,Vo=dr[yt+rn]|rr[lr+rn]<<16,aa=Qn+Fa+ra+Vo+524296,Jn=aa+2*(Fa+ra)>>3;si=Jn+Qn>>1,Qn=(aa=aa+2*(Qn+Vo)>>3)+Fa>>1,W(ve[Qe+2*rn-1],255&si,si>>16,Qr,gr+(2*rn-1)*ce),W(ve[Qe+2*rn-0],255&Qn,Qn>>16,Qr,gr+(2*rn-0)*ce),qe!=null&&(si=aa+ra>>1,Qn=Jn+Vo>>1,W(qe[Je+2*rn-1],255&si,si>>16,Ur,zr+(2*rn-1)*ce),W(qe[Je+2*rn+0],255&Qn,Qn>>16,Ur,zr+(2*rn+0)*ce)),Qn=Fa,ra=Vo}1&Gr||(si=3*Qn+ra+131074>>2,W(ve[Qe+Gr-1],255&si,si>>16,Qr,gr+(Gr-1)*ce),qe!=null&&(si=3*ra+Qn+131074>>2,W(qe[Je+Gr-1],255&si,si>>16,Ur,zr+(Gr-1)*ce)))}}function cd(){Js[$d]=Tm,Js[xh]=vf,Js[Sm]=Np,Js[Hf]=qf,Js[PA]=Gh,Js[di]=$f,Js[Xd]=Ad,Js[LA]=vf,Js[Vf]=qf,Js[hd]=Gh,Js[MA]=$f}function Yc(z){return z&-16384?0>z?0:255:z>>nu}function ic(z,W){return Yc((19077*z>>8)+(26149*W>>8)-14234)}function _s(z,W,ce){return Yc((19077*z>>8)-(6419*W>>8)-(13320*ce>>8)+8708)}function xu(z,W){return Yc((19077*z>>8)+(33050*W>>8)-17685)}function Sc(z,W,ce,ve,Qe){ve[Qe+0]=ic(z,ce),ve[Qe+1]=_s(z,W,ce),ve[Qe+2]=xu(z,W)}function Qh(z,W,ce,ve,Qe){ve[Qe+0]=xu(z,W),ve[Qe+1]=_s(z,W,ce),ve[Qe+2]=ic(z,ce)}function zs(z,W,ce,ve,Qe){var qe=_s(z,W,ce);W=qe<<3&224|xu(z,W)>>3,ve[Qe+0]=248&ic(z,ce)|qe>>5,ve[Qe+1]=W}function ss(z,W,ce,ve,Qe){var qe=240&xu(z,W)|15;ve[Qe+0]=240&ic(z,ce)|_s(z,W,ce)>>4,ve[Qe+1]=qe}function fl(z,W,ce,ve,Qe){ve[Qe+0]=255,Sc(z,W,ce,ve,Qe+1)}function wu(z,W,ce,ve,Qe){Qh(z,W,ce,ve,Qe),ve[Qe+3]=255}function Xn(z,W,ce,ve,Qe){Sc(z,W,ce,ve,Qe),ve[Qe+3]=255}function Rr(z,W){return 0>z?0:z>W?W:z}function jo(z,W,ce){we[z]=function(ve,Qe,qe,Je,ut,dt,vt,Wt,dr){for(var yt=Wt+(-2&dr)*ce;Wt!=yt;)W(ve[Qe+0],qe[Je+0],ut[dt+0],vt,Wt),W(ve[Qe+1],qe[Je+0],ut[dt+0],vt,Wt+ce),Qe+=2,++Je,++dt,Wt+=2*ce;1&dr&&W(ve[Qe+0],qe[Je+0],ut[dt+0],vt,Wt)}}function bn(z,W,ce){return ce==0?z==0?W==0?6:5:W==0?4:0:ce}function Ao(z,W,ce,ve,Qe){switch(z>>>30){case 3:Ts(W,ce,ve,Qe,0);break;case 2:Vs(W,ce,ve,Qe);break;case 1:eu(W,ce,ve,Qe)}}function Jc(z,W){var ce,ve,Qe=W.M,qe=W.Nb,Je=z.oc,ut=z.pc+40,dt=z.oc,vt=z.pc+584,Wt=z.oc,dr=z.pc+600;for(ce=0;16>ce;++ce)Je[ut+32*ce-1]=129;for(ce=0;8>ce;++ce)dt[vt+32*ce-1]=129,Wt[dr+32*ce-1]=129;for(0<Qe?Je[ut-1-32]=dt[vt-1-32]=Wt[dr-1-32]=129:(l(Je,ut-32-1,127,21),l(dt,vt-32-1,127,9),l(Wt,dr-32-1,127,9)),ve=0;ve<z.za;++ve){var yt=W.ya[W.aa+ve];if(0<ve){for(ce=-1;16>ce;++ce)n(Je,ut+32*ce-4,Je,ut+32*ce+12,4);for(ce=-1;8>ce;++ce)n(dt,vt+32*ce-4,dt,vt+32*ce+4,4),n(Wt,dr+32*ce-4,Wt,dr+32*ce+4,4)}var rr=z.Gd,lr=z.Hd+ve,Qr=yt.ad,gr=yt.Hc;if(0<Qe&&(n(Je,ut-32,rr[lr].y,0,16),n(dt,vt-32,rr[lr].f,0,8),n(Wt,dr-32,rr[lr].ea,0,8)),yt.Za){var Ur=Je,zr=ut-32+16;for(0<Qe&&(ve>=z.za-1?l(Ur,zr,rr[lr].y[15],4):n(Ur,zr,rr[lr+1].y,0,4)),ce=0;4>ce;ce++)Ur[zr+128+ce]=Ur[zr+256+ce]=Ur[zr+384+ce]=Ur[zr+0+ce];for(ce=0;16>ce;++ce,gr<<=2)Ur=Je,zr=ut+pd[ce],lc[yt.Ob[ce]](Ur,zr),Ao(gr,Qr,16*+ce,Ur,zr)}else if(Ur=bn(ve,Qe,yt.Ob[0]),Pl[Ur](Je,ut),gr!=0)for(ce=0;16>ce;++ce,gr<<=2)Ao(gr,Qr,16*+ce,Je,ut+pd[ce]);for(ce=yt.Gc,Ur=bn(ve,Qe,yt.Dd),dl[Ur](dt,vt),dl[Ur](Wt,dr),gr=Qr,Ur=dt,zr=vt,255&(yt=0|ce)&&(170&yt?$u(gr,256,Ur,zr):tu(gr,256,Ur,zr)),yt=Wt,gr=dr,255&(ce>>=8)&&(170&ce?$u(Qr,320,yt,gr):tu(Qr,320,yt,gr)),Qe<z.Ub-1&&(n(rr[lr].y,0,Je,ut+480,16),n(rr[lr].f,0,dt,vt+224,8),n(rr[lr].ea,0,Wt,dr+224,8)),ce=8*qe*z.B,rr=z.sa,lr=z.ta+16*ve+16*qe*z.R,Qr=z.qa,yt=z.ra+8*ve+ce,gr=z.Ha,Ur=z.Ia+8*ve+ce,ce=0;16>ce;++ce)n(rr,lr+ce*z.R,Je,ut+32*ce,16);for(ce=0;8>ce;++ce)n(Qr,yt+ce*z.B,dt,vt+32*ce,8),n(gr,Ur+ce*z.B,Wt,dr+32*ce,8)}}function xn(z,W,ce,ve,Qe,qe,Je,ut,dt){var vt=[0],Wt=[0],dr=0,yt=dt!=null?dt.kd:0,rr=dt??new Bi;if(z==null||12>ce)return 7;rr.data=z,rr.w=W,rr.ha=ce,W=[W],ce=[ce],rr.gb=[rr.gb];e:{var lr=W,Qr=ce,gr=rr.gb;if(t(z!=null),t(Qr!=null),t(gr!=null),gr[0]=0,12<=Qr[0]&&!r(z,lr[0],"RIFF")){if(r(z,lr[0]+8,"WEBP")){gr=3;break e}var Ur=er(z,lr[0]+4);if(12>Ur||4294967286<Ur){gr=3;break e}if(yt&&Ur>Qr[0]-8){gr=7;break e}gr[0]=Ur,lr[0]+=12,Qr[0]-=12}gr=0}if(gr!=0)return gr;for(Ur=0<rr.gb[0],ce=ce[0];;){e:{var zr=z;Qr=W,gr=ce;var Gr=vt,rn=Wt,ni=lr=[0];if((si=dr=[dr])[0]=0,8>gr[0])gr=7;else{if(!r(zr,Qr[0],"VP8X")){if(er(zr,Qr[0]+4)!=10){gr=3;break e}if(18>gr[0]){gr=7;break e}var Qn=er(zr,Qr[0]+8),ra=1+sn(zr,Qr[0]+12);if(2147483648<=ra*(zr=1+sn(zr,Qr[0]+15))){gr=3;break e}ni!=null&&(ni[0]=Qn),Gr!=null&&(Gr[0]=ra),rn!=null&&(rn[0]=zr),Qr[0]+=18,gr[0]-=18,si[0]=1}gr=0}}if(dr=dr[0],lr=lr[0],gr!=0)return gr;if(Qr=!!(2&lr),!Ur&&dr)return 3;if(qe!=null&&(qe[0]=!!(16&lr)),Je!=null&&(Je[0]=Qr),ut!=null&&(ut[0]=0),Je=vt[0],lr=Wt[0],dr&&Qr&&dt==null){gr=0;break}if(4>ce){gr=7;break}if(Ur&&dr||!Ur&&!dr&&!r(z,W[0],"ALPH")){ce=[ce],rr.na=[rr.na],rr.P=[rr.P],rr.Sa=[rr.Sa];e:{Qn=z,gr=W,Ur=ce;var si=rr.gb;Gr=rr.na,rn=rr.P,ni=rr.Sa,ra=22,t(Qn!=null),t(Ur!=null),zr=gr[0];var Fa=Ur[0];for(t(Gr!=null),t(ni!=null),Gr[0]=null,rn[0]=null,ni[0]=0;;){if(gr[0]=zr,Ur[0]=Fa,8>Fa){gr=7;break e}var Vo=er(Qn,zr+4);if(4294967286<Vo){gr=3;break e}var aa=8+Vo+1&-2;if(ra+=aa,0<si&&ra>si){gr=3;break e}if(!r(Qn,zr,"VP8 ")||!r(Qn,zr,"VP8L")){gr=0;break e}if(Fa[0]<aa){gr=7;break e}r(Qn,zr,"ALPH")||(Gr[0]=Qn,rn[0]=zr+8,ni[0]=Vo),zr+=aa,Fa-=aa}}if(ce=ce[0],rr.na=rr.na[0],rr.P=rr.P[0],rr.Sa=rr.Sa[0],gr!=0)break}ce=[ce],rr.Ja=[rr.Ja],rr.xa=[rr.xa];e:if(si=z,gr=W,Ur=ce,Gr=rr.gb[0],rn=rr.Ja,ni=rr.xa,Qn=gr[0],zr=!r(si,Qn,"VP8 "),ra=!r(si,Qn,"VP8L"),t(si!=null),t(Ur!=null),t(rn!=null),t(ni!=null),8>Ur[0])gr=7;else{if(zr||ra){if(si=er(si,Qn+4),12<=Gr&&si>Gr-12){gr=3;break e}if(yt&&si>Ur[0]-8){gr=7;break e}rn[0]=si,gr[0]+=8,Ur[0]-=8,ni[0]=ra}else ni[0]=5<=Ur[0]&&si[Qn+0]==47&&!(si[Qn+4]>>5),rn[0]=Ur[0];gr=0}if(ce=ce[0],rr.Ja=rr.Ja[0],rr.xa=rr.xa[0],W=W[0],gr!=0)break;if(4294967286<rr.Ja)return 3;if(ut==null||Qr||(ut[0]=rr.xa?2:1),Je=[Je],lr=[lr],rr.xa){if(5>ce){gr=7;break}ut=Je,yt=lr,Qr=qe,z==null||5>ce?z=0:5<=ce&&z[W+0]==47&&!(z[W+4]>>5)?(Ur=[0],si=[0],Gr=[0],Nt(rn=new Le,z,W,ce),pe(rn,Ur,si,Gr)?(ut!=null&&(ut[0]=Ur[0]),yt!=null&&(yt[0]=si[0]),Qr!=null&&(Qr[0]=Gr[0]),z=1):z=0):z=0}else{if(10>ce){gr=7;break}ut=lr,z==null||10>ce||!Rf(z,W+3,ce-3)?z=0:(yt=z[W+0]|z[W+1]<<8|z[W+2]<<16,Qr=16383&(z[W+7]<<8|z[W+6]),z=16383&(z[W+9]<<8|z[W+8]),1&yt||3<(yt>>1&7)||!(yt>>4&1)||yt>>5>=rr.Ja||!Qr||!z?z=0:(Je&&(Je[0]=Qr),ut&&(ut[0]=z),z=1))}if(!z||(Je=Je[0],lr=lr[0],dr&&(vt[0]!=Je||Wt[0]!=lr)))return 3;dt!=null&&(dt[0]=rr,dt.offset=W-dt.w,t(4294967286>W-dt.w),t(dt.offset==dt.ha-ce));break}return gr==0||gr==7&&dr&&dt==null?(qe!=null&&(qe[0]|=rr.na!=null&&0<rr.na.length),ve!=null&&(ve[0]=Je),Qe!=null&&(Qe[0]=lr),0):gr}function Qs(z,W,ce){var ve=W.width,Qe=W.height,qe=0,Je=0,ut=ve,dt=Qe;if(W.Da=z!=null&&0<z.Da,W.Da&&(ut=z.cd,dt=z.bd,qe=z.v,Je=z.j,11>ce||(qe&=-2,Je&=-2),0>qe||0>Je||0>=ut||0>=dt||qe+ut>ve||Je+dt>Qe))return 0;if(W.v=qe,W.j=Je,W.va=qe+ut,W.o=Je+dt,W.U=ut,W.T=dt,W.da=z!=null&&0<z.da,W.da){if(!zn(ut,dt,ce=[z.ib],qe=[z.hb]))return 0;W.ib=ce[0],W.hb=qe[0]}return W.ob=z!=null&&z.ob,W.Kb=z==null||!z.Sd,W.da&&(W.ob=W.ib<3*ve/4&&W.hb<3*Qe/4,W.Kb=0),1}function js(z){if(z==null)return 2;if(11>z.S){var W=z.f.RGBA;W.fb+=(z.height-1)*W.A,W.A=-W.A}else W=z.f.kb,z=z.height,W.O+=(z-1)*W.fa,W.fa=-W.fa,W.N+=(z-1>>1)*W.Ab,W.Ab=-W.Ab,W.W+=(z-1>>1)*W.Db,W.Db=-W.Db,W.F!=null&&(W.J+=(z-1)*W.lb,W.lb=-W.lb);return 0}function ac(z,W,ce,ve){if(ve==null||0>=z||0>=W)return 2;if(ce!=null){if(ce.Da){var Qe=ce.cd,qe=ce.bd,Je=-2&ce.v,ut=-2&ce.j;if(0>Je||0>ut||0>=Qe||0>=qe||Je+Qe>z||ut+qe>W)return 2;z=Qe,W=qe}if(ce.da){if(!zn(z,W,Qe=[ce.ib],qe=[ce.hb]))return 2;z=Qe[0],W=qe[0]}}ve.width=z,ve.height=W;e:{var dt=ve.width,vt=ve.height;if(z=ve.S,0>=dt||0>=vt||!(z>=$d&&13>z))z=2;else{if(0>=ve.Rd&&ve.sd==null){Je=qe=Qe=W=0;var Wt=(ut=dt*wf[z])*vt;if(11>z||(qe=(vt+1)/2*(W=(dt+1)/2),z==12&&(Je=(Qe=dt)*vt)),(vt=u(Wt+2*qe+Je))==null){z=1;break e}ve.sd=vt,11>z?((dt=ve.f.RGBA).eb=vt,dt.fb=0,dt.A=ut,dt.size=Wt):((dt=ve.f.kb).y=vt,dt.O=0,dt.fa=ut,dt.Fd=Wt,dt.f=vt,dt.N=0+Wt,dt.Ab=W,dt.Cd=qe,dt.ea=vt,dt.W=0+Wt+qe,dt.Db=W,dt.Ed=qe,z==12&&(dt.F=vt,dt.J=0+Wt+2*qe),dt.Tc=Je,dt.lb=Qe)}if(W=1,Qe=ve.S,qe=ve.width,Je=ve.height,Qe>=$d&&13>Qe)if(11>Qe)z=ve.f.RGBA,W&=(ut=Math.abs(z.A))*(Je-1)+qe<=z.size,W&=ut>=qe*wf[Qe],W&=z.eb!=null;else{z=ve.f.kb,ut=(qe+1)/2,Wt=(Je+1)/2,dt=Math.abs(z.fa),vt=Math.abs(z.Ab);var dr=Math.abs(z.Db),yt=Math.abs(z.lb),rr=yt*(Je-1)+qe;W&=dt*(Je-1)+qe<=z.Fd,W&=vt*(Wt-1)+ut<=z.Cd,W=(W&=dr*(Wt-1)+ut<=z.Ed)&dt>=qe&vt>=ut&dr>=ut,W&=z.y!=null,W&=z.f!=null,W&=z.ea!=null,Qe==12&&(W&=yt>=qe,W&=rr<=z.Tc,W&=z.F!=null)}else W=0;z=W?0:2}}return z!=0||ce!=null&&ce.fd&&(z=js(ve)),z}var Ql=64,Zs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Hs=24,bu=32,fa=8,EA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];yn("Predictor0","PredictorAdd0"),we.Predictor0=function(){return 4278190080},we.Predictor1=function(z){return z},we.Predictor2=function(z,W,ce){return W[ce+0]},we.Predictor3=function(z,W,ce){return W[ce+1]},we.Predictor4=function(z,W,ce){return W[ce-1]},we.Predictor5=function(z,W,ce){return Zn(Zn(z,W[ce+1]),W[ce+0])},we.Predictor6=function(z,W,ce){return Zn(z,W[ce-1])},we.Predictor7=function(z,W,ce){return Zn(z,W[ce+0])},we.Predictor8=function(z,W,ce){return Zn(W[ce-1],W[ce+0])},we.Predictor9=function(z,W,ce){return Zn(W[ce+0],W[ce+1])},we.Predictor10=function(z,W,ce){return Zn(Zn(z,W[ce-1]),Zn(W[ce+0],W[ce+1]))},we.Predictor11=function(z,W,ce){var ve=W[ce+0];return 0>=ui(ve>>24&255,z>>24&255,(W=W[ce-1])>>24&255)+ui(ve>>16&255,z>>16&255,W>>16&255)+ui(ve>>8&255,z>>8&255,W>>8&255)+ui(255&ve,255&z,255&W)?ve:z},we.Predictor12=function(z,W,ce){var ve=W[ce+0];return(Vi((z>>24&255)+(ve>>24&255)-((W=W[ce-1])>>24&255))<<24|Vi((z>>16&255)+(ve>>16&255)-(W>>16&255))<<16|Vi((z>>8&255)+(ve>>8&255)-(W>>8&255))<<8|Vi((255&z)+(255&ve)-(255&W)))>>>0},we.Predictor13=function(z,W,ce){var ve=W[ce-1];return(Ti((z=Zn(z,W[ce+0]))>>24&255,ve>>24&255)<<24|Ti(z>>16&255,ve>>16&255)<<16|Ti(z>>8&255,ve>>8&255)<<8|Ti(255&z,255&ve))>>>0};var ls=we.PredictorAdd0;we.PredictorAdd1=ta,yn("Predictor2","PredictorAdd2"),yn("Predictor3","PredictorAdd3"),yn("Predictor4","PredictorAdd4"),yn("Predictor5","PredictorAdd5"),yn("Predictor6","PredictorAdd6"),yn("Predictor7","PredictorAdd7"),yn("Predictor8","PredictorAdd8"),yn("Predictor9","PredictorAdd9"),yn("Predictor10","PredictorAdd10"),yn("Predictor11","PredictorAdd11"),yn("Predictor12","PredictorAdd12"),yn("Predictor13","PredictorAdd13");var lo=we.PredictorAdd2;Dn("ColorIndexInverseTransform","MapARGB","32b",function(z){return z>>8&255},function(z){return z}),Dn("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(z){return z},function(z){return z>>8&255});var _h,pf=we.ColorIndexInverseTransform,BA=we.MapARGB,Tc=we.VP8LColorIndexInverseTransformAlpha,Ic=we.MapAlpha,oc=we.VP8LPredictorsAdd=[];oc.length=16,(we.VP8LPredictors=[]).length=16,(we.VP8LPredictorsAdd_C=[]).length=16,(we.VP8LPredictors_C=[]).length=16;var sc,Nf,Il,Eu,Wa,Mo,vs,Ts,Vs,$u,eu,tu,Wd,qd,zf,jh,CA,Al,SA,Xu,Hh,ud,mf,Ys,vh,Lr,Qf,TA,IA=u(511),jf=u(2041),Vh=u(225),Fc=u(767),FA=0,Fl=jf,yh=Vh,Ho=Fc,ai=IA,$d=0,xh=1,Sm=2,Hf=3,PA=4,di=5,Xd=6,LA=7,Vf=8,hd=9,MA=10,fd=[2,3,7],Gf=[3,3,11],Kf=[280,256,256,256,40],Rp=[0,1,1,1,0],kp=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Zd=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Yd=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],wh=8,Zu=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],gf=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],bh=null,_f=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Jd=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ep=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Up=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],OA=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],tp=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],DA=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Pl=[],lc=[],dl=[],Yu=1,Wf=2,Ll=[],Js=[];Qa("UpsampleRgbLinePair",Sc,3),Qa("UpsampleBgrLinePair",Qh,3),Qa("UpsampleRgbaLinePair",Xn,4),Qa("UpsampleBgraLinePair",wu,4),Qa("UpsampleArgbLinePair",fl,4),Qa("UpsampleRgba4444LinePair",ss,2),Qa("UpsampleRgb565LinePair",zs,2);var Tm=we.UpsampleRgbLinePair,Np=we.UpsampleBgrLinePair,vf=we.UpsampleRgbaLinePair,qf=we.UpsampleBgraLinePair,Gh=we.UpsampleArgbLinePair,$f=we.UpsampleRgba4444LinePair,Ad=we.UpsampleRgb565LinePair,Bu=16,ru=1<<Bu-1,ka=-227,po=482,nu=6,Is=0,Ml=u(256),Fs=u(256),yf=u(256),Ol=u(256),xf=u(po-ka),dd=u(po-ka);jo("YuvToRgbRow",Sc,3),jo("YuvToBgrRow",Qh,3),jo("YuvToRgbaRow",Xn,4),jo("YuvToBgraRow",wu,4),jo("YuvToArgbRow",fl,4),jo("YuvToRgba4444Row",ss,2),jo("YuvToRgb565Row",zs,2);var pd=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Kh=[0,2,8],md=[8,7,6,4,4,2,2,2,1,1,1,1],Cu=1;this.WebPDecodeRGBA=function(z,W,ce,ve,Qe){var qe=xh,Je=new Yn,ut=new ba;Je.ba=ut,ut.S=qe,ut.width=[ut.width],ut.height=[ut.height];var dt=ut.width,vt=ut.height,Wt=new Mi;if(Wt==null||z==null)var dr=2;else t(Wt!=null),dr=xn(z,W,ce,Wt.width,Wt.height,Wt.Pd,Wt.Qd,Wt.format,null);if(dr!=0?dt=0:(dt!=null&&(dt[0]=Wt.width[0]),vt!=null&&(vt[0]=Wt.height[0]),dt=1),dt){ut.width=ut.width[0],ut.height=ut.height[0],ve!=null&&(ve[0]=ut.width),Qe!=null&&(Qe[0]=ut.height);e:{if(ve=new so,(Qe=new Bi).data=z,Qe.w=W,Qe.ha=ce,Qe.kd=1,W=[0],t(Qe!=null),((z=xn(Qe.data,Qe.w,Qe.ha,null,null,null,W,null,Qe))==0||z==7)&&W[0]&&(z=4),(W=z)==0){if(t(Je!=null),ve.data=Qe.data,ve.w=Qe.w+Qe.offset,ve.ha=Qe.ha-Qe.offset,ve.put=_n,ve.ac=sl,ve.bc=Tt,ve.ma=Je,Qe.xa){if((z=Rt())==null){Je=1;break e}if(function(yt,rr){var lr=[0],Qr=[0],gr=[0];t:for(;;){if(yt==null)return 0;if(rr==null)return yt.a=2,0;if(yt.l=rr,yt.a=0,Nt(yt.m,rr.data,rr.w,rr.ha),!pe(yt.m,lr,Qr,gr)){yt.a=3;break t}if(yt.xb=Wf,rr.width=lr[0],rr.height=Qr[0],!Vt(lr[0],Qr[0],1,yt,null))break t;return 1}return t(yt.a!=0),0}(z,ve)){if(ve=(W=ac(ve.width,ve.height,Je.Oa,Je.ba))==0){t:{ve=z;r:for(;;){if(ve==null){ve=0;break t}if(t(ve.s.yc!=null),t(ve.s.Ya!=null),t(0<ve.s.Wb),t((ce=ve.l)!=null),t((Qe=ce.ma)!=null),ve.xb!=0){if(ve.ca=Qe.ba,ve.tb=Qe.tb,t(ve.ca!=null),!Qs(Qe.Oa,ce,Hf)){ve.a=2;break r}if(!Gt(ve,ce.width)||ce.da)break r;if((ce.da||ki(ve.ca.S))&&os(),11>ve.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ve.ca.f.kb.F!=null&&os()),ve.Pb&&0<ve.s.ua&&ve.s.vb.X==null&&!mt(ve.s.vb,ve.s.Wa.Xa)){ve.a=1;break r}ve.xb=0}if(!St(ve,ve.V,ve.Ba,ve.c,ve.i,ce.o,me))break r;Qe.Dc=ve.Ma,ve=1;break t}t(ve.a!=0),ve=0}ve=!ve}ve&&(W=z.a)}else W=z.a}else{if((z=new Ss)==null){Je=1;break e}if(z.Fa=Qe.na,z.P=Qe.P,z.qc=Qe.Sa,Hu(z,ve)){if((W=ac(ve.width,ve.height,Je.Oa,Je.ba))==0){if(z.Aa=0,ce=Je.Oa,t((Qe=z)!=null),ce!=null){if(0<(dt=0>(dt=ce.Md)?0:100<dt?255:255*dt/100)){for(vt=Wt=0;4>vt;++vt)12>(dr=Qe.pb[vt]).lc&&(dr.ia=dt*md[0>dr.lc?0:dr.lc]>>3),Wt|=dr.ia;Wt&&(alert("todo:VP8InitRandom"),Qe.ia=1)}Qe.Ga=ce.Id,100<Qe.Ga?Qe.Ga=100:0>Qe.Ga&&(Qe.Ga=0)}(function(yt,rr){if(yt==null)return 0;if(rr==null)return Co(yt,2,"NULL VP8Io parameter in VP8Decode().");if(!yt.cb&&!Hu(yt,rr))return 0;if(t(yt.cb),rr.ac==null||rr.ac(rr)){rr.ob&&(yt.L=0);var lr=Kh[yt.L];if(yt.L==2?(yt.yb=0,yt.zb=0):(yt.yb=rr.v-lr>>4,yt.zb=rr.j-lr>>4,0>yt.yb&&(yt.yb=0),0>yt.zb&&(yt.zb=0)),yt.Va=rr.o+15+lr>>4,yt.Hb=rr.va+15+lr>>4,yt.Hb>yt.za&&(yt.Hb=yt.za),yt.Va>yt.Ub&&(yt.Va=yt.Ub),0<yt.L){var Qr=yt.ed;for(lr=0;4>lr;++lr){var gr;if(yt.Qa.Cb){var Ur=yt.Qa.Lb[lr];yt.Qa.Fb||(Ur+=Qr.Tb)}else Ur=Qr.Tb;for(gr=0;1>=gr;++gr){var zr=yt.gd[lr][gr],Gr=Ur;if(Qr.Pc&&(Gr+=Qr.vd[0],gr&&(Gr+=Qr.od[0])),0<(Gr=0>Gr?0:63<Gr?63:Gr)){var rn=Gr;0<Qr.wb&&(rn=4<Qr.wb?rn>>2:rn>>1)>9-Qr.wb&&(rn=9-Qr.wb),1>rn&&(rn=1),zr.dd=rn,zr.tc=2*Gr+rn,zr.ld=40<=Gr?2:15<=Gr?1:0}else zr.tc=0;zr.La=gr}}}lr=0}else Co(yt,6,"Frame setup failed"),lr=yt.a;if(lr=lr==0){if(lr){yt.$c=0,0<yt.Aa||(yt.Ic=Cu);t:{lr=yt.Ic,Qr=4*(rn=yt.za);var ni=32*rn,Qn=rn+1,ra=0<yt.L?rn*(0<yt.Aa?2:1):0,si=(yt.Aa==2?2:1)*rn;if((zr=Qr+832+(gr=3*(16*lr+Kh[yt.L])/2*ni)+(Ur=yt.Fa!=null&&0<yt.Fa.length?yt.Kc.c*yt.Kc.i:0))!=zr)lr=0;else{if(zr>yt.Vb){if(yt.Vb=0,yt.Ec=u(zr),yt.Fc=0,yt.Ec==null){lr=Co(yt,1,"no memory during frame initialization.");break t}yt.Vb=zr}zr=yt.Ec,Gr=yt.Fc,yt.Ac=zr,yt.Bc=Gr,Gr+=Qr,yt.Gd=d(ni,Ra),yt.Hd=0,yt.rb=d(Qn+1,Ii),yt.sb=1,yt.wa=ra?d(ra,Sn):null,yt.Y=0,yt.D.Nb=0,yt.D.wa=yt.wa,yt.D.Y=yt.Y,0<yt.Aa&&(yt.D.Y+=rn),t(!0),yt.oc=zr,yt.pc=Gr,Gr+=832,yt.ya=d(si,sa),yt.aa=0,yt.D.ya=yt.ya,yt.D.aa=yt.aa,yt.Aa==2&&(yt.D.aa+=rn),yt.R=16*rn,yt.B=8*rn,rn=(ni=Kh[yt.L])*yt.R,ni=ni/2*yt.B,yt.sa=zr,yt.ta=Gr+rn,yt.qa=yt.sa,yt.ra=yt.ta+16*lr*yt.R+ni,yt.Ha=yt.qa,yt.Ia=yt.ra+8*lr*yt.B+ni,yt.$c=0,Gr+=gr,yt.mb=Ur?zr:null,yt.nb=Ur?Gr:null,t(Gr+Ur<=yt.Fc+yt.Vb),wc(yt),l(yt.Ac,yt.Bc,0,Qr),lr=1}}if(lr){if(rr.ka=0,rr.y=yt.sa,rr.O=yt.ta,rr.f=yt.qa,rr.N=yt.ra,rr.ea=yt.Ha,rr.Vd=yt.Ia,rr.fa=yt.R,rr.Rc=yt.B,rr.F=null,rr.J=0,!FA){for(lr=-255;255>=lr;++lr)IA[255+lr]=0>lr?-lr:lr;for(lr=-1020;1020>=lr;++lr)jf[1020+lr]=-128>lr?-128:127<lr?127:lr;for(lr=-112;112>=lr;++lr)Vh[112+lr]=-16>lr?-16:15<lr?15:lr;for(lr=-255;510>=lr;++lr)Fc[255+lr]=0>lr?0:255<lr?255:lr;FA=1}vs=ma,Ts=Sl,$u=ll,eu=cl,tu=Nl,Vs=bc,Wd=ne,qd=ze,zf=sr,jh=Xr,CA=ft,Al=Qt,SA=tr,Xu=ri,Hh=ts,ud=Wu,mf=gh,Ys=yu,lc[0]=Ui,lc[1]=ec,lc[2]=ff,lc[3]=Ec,lc[4]=kf,lc[5]=Xc,lc[6]=hl,lc[7]=Kd,lc[8]=Zc,lc[9]=dh,Pl[0]=zo,Pl[1]=Ah,Pl[2]=zh,Pl[3]=hf,Pl[4]=zl,Pl[5]=ul,Pl[6]=Tl,dl[0]=Bc,dl[1]=Nh,dl[2]=_u,dl[3]=tc,dl[4]=ph,dl[5]=Uf,dl[6]=Ku,lr=1}else lr=0}lr&&(lr=function(Fa,Vo){for(Fa.M=0;Fa.M<Fa.Va;++Fa.M){var aa,Jn=Fa.Jc[Fa.M&Fa.Xb],Tn=Fa.m,So=Fa;for(aa=0;aa<So.za;++aa){var Gi=Tn,Ba=So,To=Ba.Ac,Go=Ba.Bc+4*aa,ys=Ba.zc,Ko=Ba.ya[Ba.aa+aa];if(Ba.Qa.Bb?Ko.$b=Ct(Gi,Ba.Pa.jb[0])?2+Ct(Gi,Ba.Pa.jb[2]):Ct(Gi,Ba.Pa.jb[1]):Ko.$b=0,Ba.kc&&(Ko.Ad=Ct(Gi,Ba.Bd)),Ko.Za=!Ct(Gi,145)+0,Ko.Za){var Wo=Ko.Ob,Ps=0;for(Ba=0;4>Ba;++Ba){var ro,Pa=ys[0+Ba];for(ro=0;4>ro;++ro){Pa=OA[To[Go+ro]][Pa];for(var La=ep[Ct(Gi,Pa[0])];0<La;)La=ep[2*La+Ct(Gi,Pa[La])];Pa=-La,To[Go+ro]=Pa}n(Wo,Ps,To,Go,4),Ps+=4,ys[0+Ba]=Pa}}else Pa=Ct(Gi,156)?Ct(Gi,128)?1:3:Ct(Gi,163)?2:0,Ko.Ob[0]=Pa,l(To,Go,Pa,4),l(ys,0,Pa,4);Ko.Dd=Ct(Gi,142)?Ct(Gi,114)?Ct(Gi,183)?1:3:2:0}if(So.m.Ka)return Co(Fa,7,"Premature end-of-partition0 encountered.");for(;Fa.ja<Fa.za;++Fa.ja){if(So=Jn,Gi=(Tn=Fa).rb[Tn.sb-1],To=Tn.rb[Tn.sb+Tn.ja],aa=Tn.ya[Tn.aa+Tn.ja],Go=Tn.kc?aa.Ad:0)Gi.la=To.la=0,aa.Za||(Gi.Na=To.Na=0),aa.Hc=0,aa.Gc=0,aa.ia=0;else{var wo,qa;if(Gi=To,To=So,Go=Tn.Pa.Xc,ys=Tn.ya[Tn.aa+Tn.ja],Ko=Tn.pb[ys.$b],Ba=ys.ad,Wo=0,Ps=Tn.rb[Tn.sb-1],Pa=ro=0,l(Ba,Wo,0,384),ys.Za)var cs=0,rs=Go[3];else{La=u(16);var ja=Gi.Na+Ps.Na;if(ja=bh(To,Go[1],ja,Ko.Eb,0,La,0),Gi.Na=Ps.Na=(0<ja)+0,1<ja)vs(La,0,Ba,Wo);else{var Gs=La[0]+3>>3;for(La=0;256>La;La+=16)Ba[Wo+La]=Gs}cs=1,rs=Go[0]}var Mr=15&Gi.la,co=15&Ps.la;for(La=0;4>La;++La){var ns=1&co;for(Gs=qa=0;4>Gs;++Gs)Mr=Mr>>1|(ns=(ja=bh(To,rs,ja=ns+(1&Mr),Ko.Sc,cs,Ba,Wo))>cs)<<7,qa=qa<<2|(3<ja?3:1<ja?2:Ba[Wo+0]!=0),Wo+=16;Mr>>=4,co=co>>1|ns<<7,ro=(ro<<8|qa)>>>0}for(rs=Mr,cs=co>>4,wo=0;4>wo;wo+=2){for(qa=0,Mr=Gi.la>>4+wo,co=Ps.la>>4+wo,La=0;2>La;++La){for(ns=1&co,Gs=0;2>Gs;++Gs)ja=ns+(1&Mr),Mr=Mr>>1|(ns=0<(ja=bh(To,Go[2],ja,Ko.Qc,0,Ba,Wo)))<<3,qa=qa<<2|(3<ja?3:1<ja?2:Ba[Wo+0]!=0),Wo+=16;Mr>>=2,co=co>>1|ns<<5}Pa|=qa<<4*wo,rs|=Mr<<4<<wo,cs|=(240&co)<<wo}Gi.la=rs,Ps.la=cs,ys.Hc=ro,ys.Gc=Pa,ys.ia=43690&Pa?0:Ko.ia,Go=!(ro|Pa)}if(0<Tn.L&&(Tn.wa[Tn.Y+Tn.ja]=Tn.gd[aa.$b][aa.Za],Tn.wa[Tn.Y+Tn.ja].La|=!Go),So.Ka)return Co(Fa,7,"Premature end-of-file encountered.")}if(wc(Fa),Tn=Vo,So=1,aa=(Jn=Fa).D,Gi=0<Jn.L&&Jn.M>=Jn.zb&&Jn.M<=Jn.Va,Jn.Aa==0)t:{if(aa.M=Jn.M,aa.uc=Gi,Jc(Jn,aa),So=1,aa=(qa=Jn.D).Nb,Gi=(Pa=Kh[Jn.L])*Jn.R,To=Pa/2*Jn.B,La=16*aa*Jn.R,Gs=8*aa*Jn.B,Go=Jn.sa,ys=Jn.ta-Gi+La,Ko=Jn.qa,Ba=Jn.ra-To+Gs,Wo=Jn.Ha,Ps=Jn.Ia-To+Gs,co=(Mr=qa.M)==0,ro=Mr>=Jn.Va-1,Jn.Aa==2&&Jc(Jn,qa),qa.uc)for(ns=(ja=Jn).D.M,t(ja.D.uc),qa=ja.yb;qa<ja.Hb;++qa){cs=qa,rs=ns;var qo=(bo=(Ms=ja).D).Nb;wo=Ms.R;var bo=bo.wa[bo.Y+cs],hn=Ms.sa,us=Ms.ta+16*qo*wo+16*cs,jl=bo.dd,Io=bo.tc;if(Io!=0)if(t(3<=Io),Ms.L==1)0<cs&&ud(hn,us,wo,Io+4),bo.La&&Ys(hn,us,wo,Io),0<rs&&Hh(hn,us,wo,Io+4),bo.La&&mf(hn,us,wo,Io);else{var el=Ms.B,cc=Ms.qa,Su=Ms.ra+8*qo*el+8*cs,Ls=Ms.Ha,Ms=Ms.Ia+8*qo*el+8*cs;qo=bo.ld,0<cs&&(qd(hn,us,wo,Io+4,jl,qo),jh(cc,Su,Ls,Ms,el,Io+4,jl,qo)),bo.La&&(Al(hn,us,wo,Io,jl,qo),Xu(cc,Su,Ls,Ms,el,Io,jl,qo)),0<rs&&(Wd(hn,us,wo,Io+4,jl,qo),zf(cc,Su,Ls,Ms,el,Io+4,jl,qo)),bo.La&&(CA(hn,us,wo,Io,jl,qo),SA(cc,Su,Ls,Ms,el,Io,jl,qo))}}if(Jn.ia&&alert("todo:DitherRow"),Tn.put!=null){if(qa=16*Mr,Mr=16*(Mr+1),co?(Tn.y=Jn.sa,Tn.O=Jn.ta+La,Tn.f=Jn.qa,Tn.N=Jn.ra+Gs,Tn.ea=Jn.Ha,Tn.W=Jn.Ia+Gs):(qa-=Pa,Tn.y=Go,Tn.O=ys,Tn.f=Ko,Tn.N=Ba,Tn.ea=Wo,Tn.W=Ps),ro||(Mr-=Pa),Mr>Tn.o&&(Mr=Tn.o),Tn.F=null,Tn.J=null,Jn.Fa!=null&&0<Jn.Fa.length&&qa<Mr&&(Tn.J=Qo(Jn,Tn,qa,Mr-qa),Tn.F=Jn.mb,Tn.F==null&&Tn.F.length==0)){So=Co(Jn,3,"Could not decode alpha data.");break t}qa<Tn.j&&(Pa=Tn.j-qa,qa=Tn.j,t(!(1&Pa)),Tn.O+=Jn.R*Pa,Tn.N+=Jn.B*(Pa>>1),Tn.W+=Jn.B*(Pa>>1),Tn.F!=null&&(Tn.J+=Tn.width*Pa)),qa<Mr&&(Tn.O+=Tn.v,Tn.N+=Tn.v>>1,Tn.W+=Tn.v>>1,Tn.F!=null&&(Tn.J+=Tn.v),Tn.ka=qa-Tn.j,Tn.U=Tn.va-Tn.v,Tn.T=Mr-qa,So=Tn.put(Tn))}aa+1!=Jn.Ic||ro||(n(Jn.sa,Jn.ta-Gi,Go,ys+16*Jn.R,Gi),n(Jn.qa,Jn.ra-To,Ko,Ba+8*Jn.B,To),n(Jn.Ha,Jn.Ia-To,Wo,Ps+8*Jn.B,To))}if(!So)return Co(Fa,6,"Output aborted.")}return 1}(yt,rr)),rr.bc!=null&&rr.bc(rr),lr&=1}return lr?(yt.cb=0,lr):0})(z,ve)||(W=z.a)}}else W=z.a}W==0&&Je.Oa!=null&&Je.Oa.fd&&(W=js(Je.ba))}Je=W}qe=Je!=0?null:11>qe?ut.f.RGBA.eb:ut.f.kb.y}else qe=null;return qe};var wf=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function x(we,nt){for(var _e="",Ie=0;Ie<4;Ie++)_e+=String.fromCharCode(we[nt++]);return _e}function b(we,nt){return we[nt+0]|we[nt+1]<<8}function I(we,nt){return(we[nt+0]|we[nt+1]<<8|we[nt+2]<<16)>>>0}function M(we,nt){return(we[nt+0]|we[nt+1]<<8|we[nt+2]<<16|we[nt+3]<<24)>>>0}new v;var L=[0],U=[0],R=[],H=new v,q=e,te=function(we,nt){var _e={},Ie=0,Ze=!1,st=0,Et=0;if(_e.frames=[],!function(ie,Le){for(var Fe=0;Fe<4;Fe++)if(ie[Le+Fe]!="RIFF".charCodeAt(Fe))return!0;return!1}(we,nt)){for(M(we,nt+=4),nt+=8;nt<we.length;){var Ut=x(we,nt),jt=M(we,nt+=4);nt+=4;var bt=jt+(1&jt);switch(Ut){case"VP8 ":case"VP8L":_e.frames[Ie]===void 0&&(_e.frames[Ie]={}),(lt=_e.frames[Ie]).src_off=Ze?Et:nt-8,lt.src_size=st+jt+8,Ie++,Ze&&(Ze=!1,st=0,Et=0);break;case"VP8X":(lt=_e.header={}).feature_flags=we[nt];var Nt=nt+4;lt.canvas_width=1+I(we,Nt),Nt+=3,lt.canvas_height=1+I(we,Nt),Nt+=3;break;case"ALPH":Ze=!0,st=bt+8,Et=nt-8;break;case"ANIM":(lt=_e.header).bgcolor=M(we,nt),Nt=nt+4,lt.loop_count=b(we,Nt),Nt+=2;break;case"ANMF":var ar,lt;(lt=_e.frames[Ie]={}).offset_x=2*I(we,nt),nt+=3,lt.offset_y=2*I(we,nt),nt+=3,lt.width=1+I(we,nt),nt+=3,lt.height=1+I(we,nt),nt+=3,lt.duration=I(we,nt),nt+=3,ar=we[nt++],lt.dispose=1&ar,lt.blend=ar>>1&1}Ut!="ANMF"&&(nt+=bt)}return _e}}(q,0);te.response=q,te.rgbaoutput=!0,te.dataurl=!1;var J=te.header?te.header:null,se=te.frames?te.frames:null;if(J){J.loop_counter=J.loop_count,L=[J.canvas_height],U=[J.canvas_width];for(var ye=0;ye<se.length&&se[ye].blend!=0;ye++);}var Se=se[0],Be=H.WebPDecodeRGBA(q,Se.src_off,Se.src_size,U,L);Se.rgba=Be,Se.imgwidth=U[0],Se.imgheight=L[0];for(var De=0;De<U[0]*L[0]*4;De++)R[De]=Be[De];return this.width=U,this.height=L,this.data=R,this}(function(e){var t,r,n,l,u,d,a,v,x,b=function(ie){return ie=ie||{},this.isStrokeTransparent=ie.isStrokeTransparent||!1,this.strokeOpacity=ie.strokeOpacity||1,this.strokeStyle=ie.strokeStyle||"#000000",this.fillStyle=ie.fillStyle||"#000000",this.isFillTransparent=ie.isFillTransparent||!1,this.fillOpacity=ie.fillOpacity||1,this.font=ie.font||"10px sans-serif",this.textBaseline=ie.textBaseline||"alphabetic",this.textAlign=ie.textAlign||"left",this.lineWidth=ie.lineWidth||1,this.lineJoin=ie.lineJoin||"miter",this.lineCap=ie.lineCap||"butt",this.path=ie.path||[],this.transform=ie.transform!==void 0?ie.transform.clone():new v,this.globalCompositeOperation=ie.globalCompositeOperation||"normal",this.globalAlpha=ie.globalAlpha||1,this.clip_path=ie.clip_path||[],this.currentPoint=ie.currentPoint||new d,this.miterLimit=ie.miterLimit||10,this.lastPoint=ie.lastPoint||new d,this.lineDashOffset=ie.lineDashOffset||0,this.lineDash=ie.lineDash||[],this.margin=ie.margin||[0,0,0,0],this.prevPageLastElemOffset=ie.prevPageLastElemOffset||0,this.ignoreClearRect=typeof ie.ignoreClearRect!="boolean"||ie.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new I(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,l=this.internal.getHorizontalCoordinate,u=this.internal.getVerticalCoordinate,d=this.internal.Point,a=this.internal.Rectangle,v=this.internal.Matrix,x=new b}]);var I=function(ie){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Le=ie;Object.defineProperty(this,"pdf",{get:function(){return Le}});var Fe=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Fe},set:function(er){Fe=!!er}});var Re=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Re},set:function(er){Re=!!er}});var et=0;Object.defineProperty(this,"posX",{get:function(){return et},set:function(er){isNaN(er)||(et=er)}});var xt=0;Object.defineProperty(this,"posY",{get:function(){return xt},set:function(er){isNaN(er)||(xt=er)}}),Object.defineProperty(this,"margin",{get:function(){return x.margin},set:function(er){var mt;typeof er=="number"?mt=[er,er,er,er]:((mt=new Array(4))[0]=er[0],mt[1]=er.length>=2?er[1]:mt[0],mt[2]=er.length>=3?er[2]:mt[0],mt[3]=er.length>=4?er[3]:mt[1]),x.margin=mt}});var Dt=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Dt},set:function(er){Dt=er}});var pt=0;Object.defineProperty(this,"lastBreak",{get:function(){return pt},set:function(er){pt=er}});var Ct=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ct},set:function(er){Ct=er}}),Object.defineProperty(this,"ctx",{get:function(){return x},set:function(er){er instanceof b&&(x=er)}}),Object.defineProperty(this,"path",{get:function(){return x.path},set:function(er){x.path=er}});var mr=[];Object.defineProperty(this,"ctxStack",{get:function(){return mr},set:function(er){mr=er}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(er){var mt;mt=M(er),this.ctx.fillStyle=mt.style,this.ctx.isFillTransparent=mt.a===0,this.ctx.fillOpacity=mt.a,this.pdf.setFillColor(mt.r,mt.g,mt.b,{a:mt.a}),this.pdf.setTextColor(mt.r,mt.g,mt.b,{a:mt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(er){var mt=M(er);this.ctx.strokeStyle=mt.style,this.ctx.isStrokeTransparent=mt.a===0,this.ctx.strokeOpacity=mt.a,mt.a===0?this.pdf.setDrawColor(255,255,255):(mt.a,this.pdf.setDrawColor(mt.r,mt.g,mt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(er){["butt","round","square"].indexOf(er)!==-1&&(this.ctx.lineCap=er,this.pdf.setLineCap(er))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(er){isNaN(er)||(this.ctx.lineWidth=er,this.pdf.setLineWidth(er))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(er){["bevel","round","miter"].indexOf(er)!==-1&&(this.ctx.lineJoin=er,this.pdf.setLineJoin(er))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(er){isNaN(er)||(this.ctx.miterLimit=er,this.pdf.setMiterLimit(er))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(er){this.ctx.textBaseline=er}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(er){["right","end","center","left","start"].indexOf(er)!==-1&&(this.ctx.textAlign=er)}});var Zt=null,sn=null;Object.defineProperty(this,"fontFaces",{get:function(){return sn},set:function(er){Zt=null,sn=er}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(er){var mt;if(this.ctx.font=er,(mt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(er))!==null){var En=mt[1];mt[2];var $r=mt[3],zn=mt[4];mt[5];var an=mt[6],Pn=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(zn)[2];zn=Math.floor(Pn==="px"?parseFloat(zn)*this.pdf.internal.scaleFactor:Pn==="em"?parseFloat(zn)*this.pdf.getFontSize():parseFloat(zn)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(zn);var yn=function(vi){var Dn,ua,ca=[],Gn=vi.trim();if(Gn==="")return XS;if(Gn in oN)return[oN[Gn]];for(;Gn!=="";){switch(ua=null,Dn=(Gn=lN(Gn)).charAt(0)){case'"':case"'":ua=F1e(Gn.substring(1),Dn);break;default:ua=P1e(Gn)}if(ua===null||(ca.push(ua[0]),(Gn=lN(ua[1]))!==""&&Gn.charAt(0)!==","))return XS;Gn=Gn.replace(/^,/,"")}return ca}(an);if(this.fontFaces){var Ci=function(vi,Dn){if(Zt===null){var ua=function(ca){var Gn=[];return Object.keys(ca).forEach(function(Li){ca[Li].forEach(function(xa){var yi=null;switch(xa){case"bold":yi={family:Li,weight:"bold"};break;case"italic":yi={family:Li,style:"italic"};break;case"bolditalic":yi={family:Li,weight:"bold",style:"italic"};break;case"":case"normal":yi={family:Li}}yi!==null&&(yi.ref={name:Li,style:xa},Gn.push(yi))})}),Gn}(vi.getFontList());Zt=function(ca){for(var Gn={},Li=0;Li<ca.length;++Li){var xa=$S(ca[Li]),yi=xa.family,Nn=xa.stretch,ki=xa.style,oo=xa.weight;Gn[yi]=Gn[yi]||{},Gn[yi][Nn]=Gn[yi][Nn]||{},Gn[yi][Nn][ki]=Gn[yi][Nn][ki]||{},Gn[yi][Nn][ki][oo]=xa}return Gn}(ua.concat(Dn))}return Zt}(this.pdf,this.fontFaces),Zn=yn.map(function(vi){return{family:vi,stretch:"normal",weight:$r,style:En}}),Vi=function(vi,Dn,ua){for(var ca=(ua=ua||{}).defaultFontFamily||"times",Gn=Object.assign({},I1e,ua.genericFontFamilies||{}),Li=null,xa=null,yi=0;yi<Dn.length;++yi)if(Gn[(Li=$S(Dn[yi])).family]&&(Li.family=Gn[Li.family]),vi.hasOwnProperty(Li.family)){xa=vi[Li.family];break}if(!(xa=xa||vi[ca]))throw new Error("Could not find a font-family for the rule '"+sN(Li)+"' and default family '"+ca+"'.");if(xa=function(Nn,ki){if(ki[Nn])return ki[Nn];var oo=T5[Nn],wa=oo<=T5.normal?-1:1,ba=aN(ki,jV,oo,wa);if(!ba)throw new Error("Could not find a matching font-stretch value for "+Nn);return ba}(Li.stretch,xa),xa=function(Nn,ki){if(ki[Nn])return ki[Nn];for(var oo=QV[Nn],wa=0;wa<oo.length;++wa)if(ki[oo[wa]])return ki[oo[wa]];throw new Error("Could not find a matching font-style for "+Nn)}(Li.style,xa),!(xa=function(Nn,ki){if(ki[Nn])return ki[Nn];if(Nn===400&&ki[500])return ki[500];if(Nn===500&&ki[400])return ki[400];var oo=T1e[Nn],wa=aN(ki,HV,oo,Nn<400?-1:1);if(!wa)throw new Error("Could not find a matching font-weight for value "+Nn);return wa}(Li.weight,xa)))throw new Error("Failed to resolve a font for the rule '"+sN(Li)+"'.");return xa}(Ci,Zn);this.pdf.setFont(Vi.ref.name,Vi.ref.style)}else{var Ti="";($r==="bold"||parseInt($r,10)>=700||En==="bold")&&(Ti="bold"),En==="italic"&&(Ti+="italic"),Ti.length===0&&(Ti="normal");for(var ui="",ta={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},bi=0;bi<yn.length;bi++){if(this.pdf.internal.getFont(yn[bi],Ti,{noFallback:!0,disableWarning:!0})!==void 0){ui=yn[bi];break}if(Ti==="bolditalic"&&this.pdf.internal.getFont(yn[bi],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ui=yn[bi],Ti="bold";else if(this.pdf.internal.getFont(yn[bi],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ui=yn[bi],Ti="normal";break}}if(ui===""){for(var ti=0;ti<yn.length;ti++)if(ta[yn[ti]]){ui=ta[yn[ti]];break}}ui=ui===""?"Times":ui,this.pdf.setFont(ui,Ti)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(er){this.ctx.globalCompositeOperation=er}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(er){this.ctx.globalAlpha=er}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(er){this.ctx.lineDashOffset=er,lt.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(er){this.ctx.lineDash=er,lt.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(er){this.ctx.ignoreClearRect=!!er}})};I.prototype.setLineDash=function(ie){this.lineDash=ie},I.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},I.prototype.fill=function(){se.call(this,"fill",!1)},I.prototype.stroke=function(){se.call(this,"stroke",!1)},I.prototype.beginPath=function(){this.path=[{type:"begin"}]},I.prototype.moveTo=function(ie,Le){if(isNaN(ie)||isNaN(Le))throw Us.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Fe=this.ctx.transform.applyToPoint(new d(ie,Le));this.path.push({type:"mt",x:Fe.x,y:Fe.y}),this.ctx.lastPoint=new d(ie,Le)},I.prototype.closePath=function(){var ie=new d(0,0),Le=0;for(Le=this.path.length-1;Le!==-1;Le--)if(this.path[Le].type==="begin"&&ps(this.path[Le+1])==="object"&&typeof this.path[Le+1].x=="number"){ie=new d(this.path[Le+1].x,this.path[Le+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new d(ie.x,ie.y)},I.prototype.lineTo=function(ie,Le){if(isNaN(ie)||isNaN(Le))throw Us.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Fe=this.ctx.transform.applyToPoint(new d(ie,Le));this.path.push({type:"lt",x:Fe.x,y:Fe.y}),this.ctx.lastPoint=new d(Fe.x,Fe.y)},I.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),se.call(this,null,!0)},I.prototype.quadraticCurveTo=function(ie,Le,Fe,Re){if(isNaN(Fe)||isNaN(Re)||isNaN(ie)||isNaN(Le))throw Us.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var et=this.ctx.transform.applyToPoint(new d(Fe,Re)),xt=this.ctx.transform.applyToPoint(new d(ie,Le));this.path.push({type:"qct",x1:xt.x,y1:xt.y,x:et.x,y:et.y}),this.ctx.lastPoint=new d(et.x,et.y)},I.prototype.bezierCurveTo=function(ie,Le,Fe,Re,et,xt){if(isNaN(et)||isNaN(xt)||isNaN(ie)||isNaN(Le)||isNaN(Fe)||isNaN(Re))throw Us.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Dt=this.ctx.transform.applyToPoint(new d(et,xt)),pt=this.ctx.transform.applyToPoint(new d(ie,Le)),Ct=this.ctx.transform.applyToPoint(new d(Fe,Re));this.path.push({type:"bct",x1:pt.x,y1:pt.y,x2:Ct.x,y2:Ct.y,x:Dt.x,y:Dt.y}),this.ctx.lastPoint=new d(Dt.x,Dt.y)},I.prototype.arc=function(ie,Le,Fe,Re,et,xt){if(isNaN(ie)||isNaN(Le)||isNaN(Fe)||isNaN(Re)||isNaN(et))throw Us.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(xt=!!xt,!this.ctx.transform.isIdentity){var Dt=this.ctx.transform.applyToPoint(new d(ie,Le));ie=Dt.x,Le=Dt.y;var pt=this.ctx.transform.applyToPoint(new d(0,Fe)),Ct=this.ctx.transform.applyToPoint(new d(0,0));Fe=Math.sqrt(Math.pow(pt.x-Ct.x,2)+Math.pow(pt.y-Ct.y,2))}Math.abs(et-Re)>=2*Math.PI&&(Re=0,et=2*Math.PI),this.path.push({type:"arc",x:ie,y:Le,radius:Fe,startAngle:Re,endAngle:et,counterclockwise:xt})},I.prototype.arcTo=function(ie,Le,Fe,Re,et){throw new Error("arcTo not implemented.")},I.prototype.rect=function(ie,Le,Fe,Re){if(isNaN(ie)||isNaN(Le)||isNaN(Fe)||isNaN(Re))throw Us.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(ie,Le),this.lineTo(ie+Fe,Le),this.lineTo(ie+Fe,Le+Re),this.lineTo(ie,Le+Re),this.lineTo(ie,Le),this.lineTo(ie+Fe,Le),this.lineTo(ie,Le)},I.prototype.fillRect=function(ie,Le,Fe,Re){if(isNaN(ie)||isNaN(Le)||isNaN(Fe)||isNaN(Re))throw Us.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!L.call(this)){var et={};this.lineCap!=="butt"&&(et.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(et.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(ie,Le,Fe,Re),this.fill(),et.hasOwnProperty("lineCap")&&(this.lineCap=et.lineCap),et.hasOwnProperty("lineJoin")&&(this.lineJoin=et.lineJoin)}},I.prototype.strokeRect=function(ie,Le,Fe,Re){if(isNaN(ie)||isNaN(Le)||isNaN(Fe)||isNaN(Re))throw Us.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");U.call(this)||(this.beginPath(),this.rect(ie,Le,Fe,Re),this.stroke())},I.prototype.clearRect=function(ie,Le,Fe,Re){if(isNaN(ie)||isNaN(Le)||isNaN(Fe)||isNaN(Re))throw Us.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(ie,Le,Fe,Re))},I.prototype.save=function(ie){ie=typeof ie!="boolean"||ie;for(var Le=this.pdf.internal.getCurrentPageInfo().pageNumber,Fe=0;Fe<this.pdf.internal.getNumberOfPages();Fe++)this.pdf.setPage(Fe+1),this.pdf.internal.out("q");if(this.pdf.setPage(Le),ie){this.ctx.fontSize=this.pdf.internal.getFontSize();var Re=new b(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Re}},I.prototype.restore=function(ie){ie=typeof ie!="boolean"||ie;for(var Le=this.pdf.internal.getCurrentPageInfo().pageNumber,Fe=0;Fe<this.pdf.internal.getNumberOfPages();Fe++)this.pdf.setPage(Fe+1),this.pdf.internal.out("Q");this.pdf.setPage(Le),ie&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},I.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var M=function(ie){var Le,Fe,Re,et;if(ie.isCanvasGradient===!0&&(ie=ie.getColor()),!ie)return{r:0,g:0,b:0,a:0,style:ie};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(ie))Le=0,Fe=0,Re=0,et=0;else{var xt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(ie);if(xt!==null)Le=parseInt(xt[1]),Fe=parseInt(xt[2]),Re=parseInt(xt[3]),et=1;else if((xt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(ie))!==null)Le=parseInt(xt[1]),Fe=parseInt(xt[2]),Re=parseInt(xt[3]),et=parseFloat(xt[4]);else{if(et=1,typeof ie=="string"&&ie.charAt(0)!=="#"){var Dt=new OV(ie);ie=Dt.ok?Dt.toHex():"#000000"}ie.length===4?(Le=ie.substring(1,2),Le+=Le,Fe=ie.substring(2,3),Fe+=Fe,Re=ie.substring(3,4),Re+=Re):(Le=ie.substring(1,3),Fe=ie.substring(3,5),Re=ie.substring(5,7)),Le=parseInt(Le,16),Fe=parseInt(Fe,16),Re=parseInt(Re,16)}}return{r:Le,g:Fe,b:Re,a:et,style:ie}},L=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},U=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};I.prototype.fillText=function(ie,Le,Fe,Re){if(isNaN(Le)||isNaN(Fe)||typeof ie!="string")throw Us.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Re=isNaN(Re)?void 0:Re,!L.call(this)){var et=bt(this.ctx.transform.rotation),xt=this.ctx.transform.scaleX;Ie.call(this,{text:ie,x:Le,y:Fe,scale:xt,angle:et,align:this.textAlign,maxWidth:Re})}},I.prototype.strokeText=function(ie,Le,Fe,Re){if(isNaN(Le)||isNaN(Fe)||typeof ie!="string")throw Us.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!U.call(this)){Re=isNaN(Re)?void 0:Re;var et=bt(this.ctx.transform.rotation),xt=this.ctx.transform.scaleX;Ie.call(this,{text:ie,x:Le,y:Fe,scale:xt,renderingMode:"stroke",angle:et,align:this.textAlign,maxWidth:Re})}},I.prototype.measureText=function(ie){if(typeof ie!="string")throw Us.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Le=this.pdf,Fe=this.pdf.internal.scaleFactor,Re=Le.internal.getFontSize(),et=Le.getStringUnitWidth(ie)*Re/Le.internal.scaleFactor;return new function(xt){var Dt=(xt=xt||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Dt}}),this}({width:et*=Math.round(96*Fe/72*1e4)/1e4})},I.prototype.scale=function(ie,Le){if(isNaN(ie)||isNaN(Le))throw Us.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Fe=new v(ie,0,0,Le,0,0);this.ctx.transform=this.ctx.transform.multiply(Fe)},I.prototype.rotate=function(ie){if(isNaN(ie))throw Us.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Le=new v(Math.cos(ie),Math.sin(ie),-Math.sin(ie),Math.cos(ie),0,0);this.ctx.transform=this.ctx.transform.multiply(Le)},I.prototype.translate=function(ie,Le){if(isNaN(ie)||isNaN(Le))throw Us.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Fe=new v(1,0,0,1,ie,Le);this.ctx.transform=this.ctx.transform.multiply(Fe)},I.prototype.transform=function(ie,Le,Fe,Re,et,xt){if(isNaN(ie)||isNaN(Le)||isNaN(Fe)||isNaN(Re)||isNaN(et)||isNaN(xt))throw Us.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Dt=new v(ie,Le,Fe,Re,et,xt);this.ctx.transform=this.ctx.transform.multiply(Dt)},I.prototype.setTransform=function(ie,Le,Fe,Re,et,xt){ie=isNaN(ie)?1:ie,Le=isNaN(Le)?0:Le,Fe=isNaN(Fe)?0:Fe,Re=isNaN(Re)?1:Re,et=isNaN(et)?0:et,xt=isNaN(xt)?0:xt,this.ctx.transform=new v(ie,Le,Fe,Re,et,xt)};var R=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};I.prototype.drawImage=function(ie,Le,Fe,Re,et,xt,Dt,pt,Ct){var mr=this.pdf.getImageProperties(ie),Zt=1,sn=1,er=1,mt=1;Re!==void 0&&pt!==void 0&&(er=pt/Re,mt=Ct/et,Zt=mr.width/Re*pt/Re,sn=mr.height/et*Ct/et),xt===void 0&&(xt=Le,Dt=Fe,Le=0,Fe=0),Re!==void 0&&pt===void 0&&(pt=Re,Ct=et),Re===void 0&&pt===void 0&&(pt=mr.width,Ct=mr.height);for(var En,$r=this.ctx.transform.decompose(),zn=bt($r.rotate.shx),an=new v,Pn=(an=(an=(an=an.multiply($r.translate)).multiply($r.skew)).multiply($r.scale)).applyToRectangle(new a(xt-Le*er,Dt-Fe*mt,Re*Zt,et*sn)),yn=H.call(this,Pn),Ci=[],Zn=0;Zn<yn.length;Zn+=1)Ci.indexOf(yn[Zn])===-1&&Ci.push(yn[Zn]);if(J(Ci),this.autoPaging)for(var Vi=Ci[0],Ti=Ci[Ci.length-1],ui=Vi;ui<Ti+1;ui++){this.pdf.setPage(ui);var ta=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],bi=ui===1?this.posY+this.margin[0]:this.margin[0],ti=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],vi=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Dn=ui===1?0:ti+(ui-2)*vi;if(this.ctx.clip_path.length!==0){var ua=this.path;En=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=te(En,this.posX+this.margin[3],-Dn+bi+this.ctx.prevPageLastElemOffset),ye.call(this,"fill",!0),this.path=ua}var ca=JSON.parse(JSON.stringify(Pn));ca=te([ca],this.posX+this.margin[3],-Dn+bi+this.ctx.prevPageLastElemOffset)[0];var Gn=(ui>Vi||ui<Ti)&&R.call(this);Gn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ta,vi,null).clip().discardPath()),this.pdf.addImage(ie,"JPEG",ca.x,ca.y,ca.w,ca.h,null,null,zn),Gn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(ie,"JPEG",Pn.x,Pn.y,Pn.w,Pn.h,null,null,zn)};var H=function(ie,Le,Fe){var Re=[];Le=Le||this.pdf.internal.pageSize.width,Fe=Fe||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var et=this.posY+this.ctx.prevPageLastElemOffset;switch(ie.type){default:case"mt":case"lt":Re.push(Math.floor((ie.y+et)/Fe)+1);break;case"arc":Re.push(Math.floor((ie.y+et-ie.radius)/Fe)+1),Re.push(Math.floor((ie.y+et+ie.radius)/Fe)+1);break;case"qct":var xt=Nt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ie.x1,ie.y1,ie.x,ie.y);Re.push(Math.floor((xt.y+et)/Fe)+1),Re.push(Math.floor((xt.y+xt.h+et)/Fe)+1);break;case"bct":var Dt=ar(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ie.x1,ie.y1,ie.x2,ie.y2,ie.x,ie.y);Re.push(Math.floor((Dt.y+et)/Fe)+1),Re.push(Math.floor((Dt.y+Dt.h+et)/Fe)+1);break;case"rect":Re.push(Math.floor((ie.y+et)/Fe)+1),Re.push(Math.floor((ie.y+ie.h+et)/Fe)+1)}for(var pt=0;pt<Re.length;pt+=1)for(;this.pdf.internal.getNumberOfPages()<Re[pt];)q.call(this);return Re},q=function(){var ie=this.fillStyle,Le=this.strokeStyle,Fe=this.font,Re=this.lineCap,et=this.lineWidth,xt=this.lineJoin;this.pdf.addPage(),this.fillStyle=ie,this.strokeStyle=Le,this.font=Fe,this.lineCap=Re,this.lineWidth=et,this.lineJoin=xt},te=function(ie,Le,Fe){for(var Re=0;Re<ie.length;Re++)switch(ie[Re].type){case"bct":ie[Re].x2+=Le,ie[Re].y2+=Fe;case"qct":ie[Re].x1+=Le,ie[Re].y1+=Fe;default:ie[Re].x+=Le,ie[Re].y+=Fe}return ie},J=function(ie){return ie.sort(function(Le,Fe){return Le-Fe})},se=function(ie,Le){for(var Fe,Re,et=this.fillStyle,xt=this.strokeStyle,Dt=this.lineCap,pt=this.lineWidth,Ct=Math.abs(pt*this.ctx.transform.scaleX),mr=this.lineJoin,Zt=JSON.parse(JSON.stringify(this.path)),sn=JSON.parse(JSON.stringify(this.path)),er=[],mt=0;mt<sn.length;mt++)if(sn[mt].x!==void 0)for(var En=H.call(this,sn[mt]),$r=0;$r<En.length;$r+=1)er.indexOf(En[$r])===-1&&er.push(En[$r]);for(var zn=0;zn<er.length;zn++)for(;this.pdf.internal.getNumberOfPages()<er[zn];)q.call(this);if(J(er),this.autoPaging)for(var an=er[0],Pn=er[er.length-1],yn=an;yn<Pn+1;yn++){this.pdf.setPage(yn),this.fillStyle=et,this.strokeStyle=xt,this.lineCap=Dt,this.lineWidth=Ct,this.lineJoin=mr;var Ci=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Zn=yn===1?this.posY+this.margin[0]:this.margin[0],Vi=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ti=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ui=yn===1?0:Vi+(yn-2)*Ti;if(this.ctx.clip_path.length!==0){var ta=this.path;Fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=te(Fe,this.posX+this.margin[3],-ui+Zn+this.ctx.prevPageLastElemOffset),ye.call(this,ie,!0),this.path=ta}if(Re=JSON.parse(JSON.stringify(Zt)),this.path=te(Re,this.posX+this.margin[3],-ui+Zn+this.ctx.prevPageLastElemOffset),Le===!1||yn===0){var bi=(yn>an||yn<Pn)&&R.call(this);bi&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ci,Ti,null).clip().discardPath()),ye.call(this,ie,Le),bi&&this.pdf.restoreGraphicsState()}this.lineWidth=pt}else this.lineWidth=Ct,ye.call(this,ie,Le),this.lineWidth=pt;this.path=Zt},ye=function(ie,Le){if((ie!=="stroke"||Le||!U.call(this))&&(ie==="stroke"||Le||!L.call(this))){for(var Fe,Re,et=[],xt=this.path,Dt=0;Dt<xt.length;Dt++){var pt=xt[Dt];switch(pt.type){case"begin":et.push({begin:!0});break;case"close":et.push({close:!0});break;case"mt":et.push({start:pt,deltas:[],abs:[]});break;case"lt":var Ct=et.length;if(xt[Dt-1]&&!isNaN(xt[Dt-1].x)&&(Fe=[pt.x-xt[Dt-1].x,pt.y-xt[Dt-1].y],Ct>0)){for(;Ct>=0;Ct--)if(et[Ct-1].close!==!0&&et[Ct-1].begin!==!0){et[Ct-1].deltas.push(Fe),et[Ct-1].abs.push(pt);break}}break;case"bct":Fe=[pt.x1-xt[Dt-1].x,pt.y1-xt[Dt-1].y,pt.x2-xt[Dt-1].x,pt.y2-xt[Dt-1].y,pt.x-xt[Dt-1].x,pt.y-xt[Dt-1].y],et[et.length-1].deltas.push(Fe);break;case"qct":var mr=xt[Dt-1].x+2/3*(pt.x1-xt[Dt-1].x),Zt=xt[Dt-1].y+2/3*(pt.y1-xt[Dt-1].y),sn=pt.x+2/3*(pt.x1-pt.x),er=pt.y+2/3*(pt.y1-pt.y),mt=pt.x,En=pt.y;Fe=[mr-xt[Dt-1].x,Zt-xt[Dt-1].y,sn-xt[Dt-1].x,er-xt[Dt-1].y,mt-xt[Dt-1].x,En-xt[Dt-1].y],et[et.length-1].deltas.push(Fe);break;case"arc":et.push({deltas:[],abs:[],arc:!0}),Array.isArray(et[et.length-1].abs)&&et[et.length-1].abs.push(pt)}}Re=Le?null:ie==="stroke"?"stroke":"fill";for(var $r=!1,zn=0;zn<et.length;zn++)if(et[zn].arc)for(var an=et[zn].abs,Pn=0;Pn<an.length;Pn++){var yn=an[Pn];yn.type==="arc"?De.call(this,yn.x,yn.y,yn.radius,yn.startAngle,yn.endAngle,yn.counterclockwise,void 0,Le,!$r):Ze.call(this,yn.x,yn.y),$r=!0}else if(et[zn].close===!0)this.pdf.internal.out("h"),$r=!1;else if(et[zn].begin!==!0){var Ci=et[zn].start.x,Zn=et[zn].start.y;st.call(this,et[zn].deltas,Ci,Zn),$r=!0}Re&&we.call(this,Re),Le&&nt.call(this)}},Se=function(ie){var Le=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Fe=Le*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return ie-Fe;case"top":return ie+Le-Fe;case"hanging":return ie+Le-2*Fe;case"middle":return ie+Le/2-Fe;default:return ie}},Be=function(ie){return ie+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};I.prototype.createLinearGradient=function(){var ie=function(){};return ie.colorStops=[],ie.addColorStop=function(Le,Fe){this.colorStops.push([Le,Fe])},ie.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},ie.isCanvasGradient=!0,ie},I.prototype.createPattern=function(){return this.createLinearGradient()},I.prototype.createRadialGradient=function(){return this.createLinearGradient()};var De=function(ie,Le,Fe,Re,et,xt,Dt,pt,Ct){for(var mr=Ut.call(this,Fe,Re,et,xt),Zt=0;Zt<mr.length;Zt++){var sn=mr[Zt];Zt===0&&(Ct?_e.call(this,sn.x1+ie,sn.y1+Le):Ze.call(this,sn.x1+ie,sn.y1+Le)),Et.call(this,ie,Le,sn.x2,sn.y2,sn.x3,sn.y3,sn.x4,sn.y4)}pt?nt.call(this):we.call(this,Dt)},we=function(ie){switch(ie){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},nt=function(){this.pdf.clip(),this.pdf.discardPath()},_e=function(ie,Le){this.pdf.internal.out(r(ie)+" "+n(Le)+" m")},Ie=function(ie){var Le;switch(ie.align){case"right":case"end":Le="right";break;case"center":Le="center";break;default:Le="left"}var Fe=this.pdf.getTextDimensions(ie.text),Re=Se.call(this,ie.y),et=Be.call(this,Re)-Fe.h,xt=this.ctx.transform.applyToPoint(new d(ie.x,Re)),Dt=this.ctx.transform.decompose(),pt=new v;pt=(pt=(pt=pt.multiply(Dt.translate)).multiply(Dt.skew)).multiply(Dt.scale);for(var Ct,mr,Zt,sn=this.ctx.transform.applyToRectangle(new a(ie.x,Re,Fe.w,Fe.h)),er=pt.applyToRectangle(new a(ie.x,et,Fe.w,Fe.h)),mt=H.call(this,er),En=[],$r=0;$r<mt.length;$r+=1)En.indexOf(mt[$r])===-1&&En.push(mt[$r]);if(J(En),this.autoPaging)for(var zn=En[0],an=En[En.length-1],Pn=zn;Pn<an+1;Pn++){this.pdf.setPage(Pn);var yn=Pn===1?this.posY+this.margin[0]:this.margin[0],Ci=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Zn=this.pdf.internal.pageSize.height-this.margin[2],Vi=Zn-this.margin[0],Ti=this.pdf.internal.pageSize.width-this.margin[1],ui=Ti-this.margin[3],ta=Pn===1?0:Ci+(Pn-2)*Vi;if(this.ctx.clip_path.length!==0){var bi=this.path;Ct=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=te(Ct,this.posX+this.margin[3],-1*ta+yn),ye.call(this,"fill",!0),this.path=bi}var ti=te([JSON.parse(JSON.stringify(er))],this.posX+this.margin[3],-ta+yn+this.ctx.prevPageLastElemOffset)[0];ie.scale>=.01&&(mr=this.pdf.internal.getFontSize(),this.pdf.setFontSize(mr*ie.scale),Zt=this.lineWidth,this.lineWidth=Zt*ie.scale);var vi=this.autoPaging!=="text";if(vi||ti.y+ti.h<=Zn){if(vi||ti.y>=yn&&ti.x<=Ti){var Dn=vi?ie.text:this.pdf.splitTextToSize(ie.text,ie.maxWidth||Ti-ti.x)[0],ua=te([JSON.parse(JSON.stringify(sn))],this.posX+this.margin[3],-ta+yn+this.ctx.prevPageLastElemOffset)[0],ca=vi&&(Pn>zn||Pn<an)&&R.call(this);ca&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ui,Vi,null).clip().discardPath()),this.pdf.text(Dn,ua.x,ua.y,{angle:ie.angle,align:Le,renderingMode:ie.renderingMode}),ca&&this.pdf.restoreGraphicsState()}}else ti.y<Zn&&(this.ctx.prevPageLastElemOffset+=Zn-ti.y);ie.scale>=.01&&(this.pdf.setFontSize(mr),this.lineWidth=Zt)}else ie.scale>=.01&&(mr=this.pdf.internal.getFontSize(),this.pdf.setFontSize(mr*ie.scale),Zt=this.lineWidth,this.lineWidth=Zt*ie.scale),this.pdf.text(ie.text,xt.x+this.posX,xt.y+this.posY,{angle:ie.angle,align:Le,renderingMode:ie.renderingMode,maxWidth:ie.maxWidth}),ie.scale>=.01&&(this.pdf.setFontSize(mr),this.lineWidth=Zt)},Ze=function(ie,Le,Fe,Re){Fe=Fe||0,Re=Re||0,this.pdf.internal.out(r(ie+Fe)+" "+n(Le+Re)+" l")},st=function(ie,Le,Fe){return this.pdf.lines(ie,Le,Fe,null,null)},Et=function(ie,Le,Fe,Re,et,xt,Dt,pt){this.pdf.internal.out([t(l(Fe+ie)),t(u(Re+Le)),t(l(et+ie)),t(u(xt+Le)),t(l(Dt+ie)),t(u(pt+Le)),"c"].join(" "))},Ut=function(ie,Le,Fe,Re){for(var et=2*Math.PI,xt=Math.PI/2;Le>Fe;)Le-=et;var Dt=Math.abs(Fe-Le);Dt<et&&Re&&(Dt=et-Dt);for(var pt=[],Ct=Re?-1:1,mr=Le;Dt>1e-5;){var Zt=mr+Ct*Math.min(Dt,xt);pt.push(jt.call(this,ie,mr,Zt)),Dt-=Math.abs(Zt-mr),mr=Zt}return pt},jt=function(ie,Le,Fe){var Re=(Fe-Le)/2,et=ie*Math.cos(Re),xt=ie*Math.sin(Re),Dt=et,pt=-xt,Ct=Dt*Dt+pt*pt,mr=Ct+Dt*et+pt*xt,Zt=4/3*(Math.sqrt(2*Ct*mr)-mr)/(Dt*xt-pt*et),sn=Dt-Zt*pt,er=pt+Zt*Dt,mt=sn,En=-er,$r=Re+Le,zn=Math.cos($r),an=Math.sin($r);return{x1:ie*Math.cos(Le),y1:ie*Math.sin(Le),x2:sn*zn-er*an,y2:sn*an+er*zn,x3:mt*zn-En*an,y3:mt*an+En*zn,x4:ie*Math.cos(Fe),y4:ie*Math.sin(Fe)}},bt=function(ie){return 180*ie/Math.PI},Nt=function(ie,Le,Fe,Re,et,xt){var Dt=ie+.5*(Fe-ie),pt=Le+.5*(Re-Le),Ct=et+.5*(Fe-et),mr=xt+.5*(Re-xt),Zt=Math.min(ie,et,Dt,Ct),sn=Math.max(ie,et,Dt,Ct),er=Math.min(Le,xt,pt,mr),mt=Math.max(Le,xt,pt,mr);return new a(Zt,er,sn-Zt,mt-er)},ar=function(ie,Le,Fe,Re,et,xt,Dt,pt){var Ct,mr,Zt,sn,er,mt,En,$r,zn,an,Pn,yn,Ci,Zn,Vi=Fe-ie,Ti=Re-Le,ui=et-Fe,ta=xt-Re,bi=Dt-et,ti=pt-xt;for(mr=0;mr<41;mr++)zn=(En=(Zt=ie+(Ct=mr/40)*Vi)+Ct*((er=Fe+Ct*ui)-Zt))+Ct*(er+Ct*(et+Ct*bi-er)-En),an=($r=(sn=Le+Ct*Ti)+Ct*((mt=Re+Ct*ta)-sn))+Ct*(mt+Ct*(xt+Ct*ti-mt)-$r),mr==0?(Pn=zn,yn=an,Ci=zn,Zn=an):(Pn=Math.min(Pn,zn),yn=Math.min(yn,an),Ci=Math.max(Ci,zn),Zn=Math.max(Zn,an));return new a(Math.round(Pn),Math.round(yn),Math.round(Ci-Pn),Math.round(Zn-yn))},lt=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var ie,Le,Fe=(ie=this.ctx.lineDash,Le=this.ctx.lineDashOffset,JSON.stringify({lineDash:ie,lineDashOffset:Le}));this.prevLineDash!==Fe&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Fe)}}})(Qi.API),function(e){var t=function(d){var a,v,x,b,I,M,L,U,R,H;for(v=[],x=0,b=(d+=a="\0\0\0\0".slice(d.length%4||4)).length;b>x;x+=4)(I=(d.charCodeAt(x)<<24)+(d.charCodeAt(x+1)<<16)+(d.charCodeAt(x+2)<<8)+d.charCodeAt(x+3))!==0?(M=(I=((I=((I=((I=(I-(H=I%85))/85)-(R=I%85))/85)-(U=I%85))/85)-(L=I%85))/85)%85,v.push(M+33,L+33,U+33,R+33,H+33)):v.push(122);return function(q,te){for(var J=te;J>0;J--)q.pop()}(v,a.length),String.fromCharCode.apply(String,v)+"~>"},r=function(d){var a,v,x,b,I,M=String,L="length",U=255,R="charCodeAt",H="slice",q="replace";for(d[H](-2),d=d[H](0,-2)[q](/\s/g,"")[q]("z","!!!!!"),x=[],b=0,I=(d+=a="uuuuu"[H](d[L]%5||5))[L];I>b;b+=5)v=52200625*(d[R](b)-33)+614125*(d[R](b+1)-33)+7225*(d[R](b+2)-33)+85*(d[R](b+3)-33)+(d[R](b+4)-33),x.push(U&v>>24,U&v>>16,U&v>>8,U&v);return function(te,J){for(var se=J;se>0;se--)te.pop()}(x,a[L]),M.fromCharCode.apply(M,x)},n=function(d){return d.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},l=function(d){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((d=d.replace(/\s/g,"")).indexOf(">")!==-1&&(d=d.substr(0,d.indexOf(">"))),d.length%2&&(d+="0"),a.test(d)===!1)return"";for(var v="",x=0;x<d.length;x+=2)v+=String.fromCharCode("0x"+(d[x]+d[x+1]));return v},u=function(d){for(var a=new Uint8Array(d.length),v=d.length;v--;)a[v]=d.charCodeAt(v);return(a=x5(a)).reduce(function(x,b){return x+String.fromCharCode(b)},"")};e.processDataByFilters=function(d,a){var v=0,x=d||"",b=[];for(typeof(a=a||[])=="string"&&(a=[a]),v=0;v<a.length;v+=1)switch(a[v]){case"ASCII85Decode":case"/ASCII85Decode":x=r(x),b.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":x=t(x),b.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":x=l(x),b.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":x=n(x),b.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":x=u(x),b.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[v]+'" is not implemented')}return{data:x,reverseChain:b.reverse().join(" ")}}}(Qi.API),function(e){e.loadFile=function(t,r,n){return function(l,u,d){u=u!==!1,d=typeof d=="function"?d:function(){};var a=void 0;try{a=function(v,x,b){var I=new XMLHttpRequest,M=0,L=function(U){var R=U.length,H=[],q=String.fromCharCode;for(M=0;M<R;M+=1)H.push(q(255&U.charCodeAt(M)));return H.join("")};if(I.open("GET",v,!x),I.overrideMimeType("text/plain; charset=x-user-defined"),x===!1&&(I.onload=function(){I.status===200?b(L(this.responseText)):b(void 0)}),I.send(null),x&&I.status===200)return L(I.responseText)}(l,u,d)}catch{}return a}(t,r,n)},e.loadImageFile=e.loadFile}(Qi.API),function(e){function t(){return(pa.html2canvas?Promise.resolve(pa.html2canvas):PS(()=>Promise.resolve().then(()=>xBe),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function r(){return(pa.DOMPurify?Promise.resolve(pa.DOMPurify):PS(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var v=ps(a);return v==="undefined"?"undefined":v==="string"||a instanceof String?"string":v==="number"||a instanceof Number?"number":v==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":v==="object"?"object":"unknown"},l=function(a,v){var x=document.createElement(a);for(var b in v.className&&(x.className=v.className),v.innerHTML&&v.dompurify&&(x.innerHTML=v.dompurify.sanitize(v.innerHTML)),v.style)x.style[b]=v.style[b];return x},u=function a(v,x){for(var b=v.nodeType===3?document.createTextNode(v.nodeValue):v.cloneNode(!1),I=v.firstChild;I;I=I.nextSibling)x!==!0&&I.nodeType===1&&I.nodeName==="SCRIPT"||b.appendChild(a(I,x));return v.nodeType===1&&(v.nodeName==="CANVAS"?(b.width=v.width,b.height=v.height,b.getContext("2d").drawImage(v,0,0)):v.nodeName!=="TEXTAREA"&&v.nodeName!=="SELECT"||(b.value=v.value),b.addEventListener("load",function(){b.scrollTop=v.scrollTop,b.scrollLeft=v.scrollLeft},!0)),b},d=function a(v){var x=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),b=a.convert(Promise.resolve(),x);return(b=b.setProgress(1,a,1,[a])).set(v)};(d.prototype=Object.create(Promise.prototype)).constructor=d,d.convert=function(a,v){return a.__proto__=v||d.prototype,a},d.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},d.prototype.from=function(a,v){return this.then(function(){switch(v=v||function(x){switch(n(x)){case"string":return"string";case"element":return x.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a),v){case"string":return this.then(r).then(function(x){return this.set({src:l("div",{innerHTML:a,dompurify:x})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},d.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},d.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},v=u(this.prop.src,this.opt.html2canvas.javascriptEnabled);v.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=l("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=l("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(v),this.prop.container.firstChild.appendChild(l("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},d.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(v){var x=Object.assign({},this.opt.html2canvas);return delete x.onrendered,v(this.prop.container,x)}).then(function(v){(this.opt.html2canvas.onrendered||function(){})(v),this.prop.canvas=v,document.body.removeChild(this.prop.overlay)})},d.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(v){var x=this.opt.jsPDF,b=this.opt.fontFaces,I=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,M=Object.assign({async:!0,allowTaint:!0,scale:I,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete M.onrendered,x.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,x.context2d.posX=this.opt.x,x.context2d.posY=this.opt.y,x.context2d.margin=this.opt.margin,x.context2d.fontFaces=b,b)for(var L=0;L<b.length;++L){var U=b[L],R=U.src.find(function(H){return H.format==="truetype"});R&&x.addFont(R.url,U.ref.name,U.ref.style)}return M.windowHeight=M.windowHeight||0,M.windowHeight=M.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):M.windowHeight,x.context2d.save(!0),v(this.prop.container,M)}).then(function(v){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(v),this.prop.canvas=v,document.body.removeChild(this.prop.overlay)})},d.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},d.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},d.prototype.output=function(a,v,x){return(x=x||"pdf").toLowerCase()==="img"||x.toLowerCase()==="image"?this.outputImg(a,v):this.outputPdf(a,v)},d.prototype.outputPdf=function(a,v){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,v)})},d.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},d.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},d.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},d.prototype.set=function(a){if(n(a)!=="object")return this;var v=Object.keys(a||{}).map(function(x){if(x in d.template.prop)return function(){this.prop[x]=a[x]};switch(x){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[x]=a[x]}}},this);return this.then(function(){return this.thenList(v)})},d.prototype.get=function(a,v){return this.then(function(){var x=a in d.template.prop?this.prop[a]:this.opt[a];return v?v(x):x})},d.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},d.prototype.setPageSize=function(a){function v(x,b){return Math.floor(x*b/72*96)}return this.then(function(){(a=a||Qi.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:v(a.inner.width,a.k),height:v(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},d.prototype.setProgress=function(a,v,x,b){return a!=null&&(this.progress.val=a),v!=null&&(this.progress.state=v),x!=null&&(this.progress.n=x),b!=null&&(this.progress.stack=b),this.progress.ratio=this.progress.val/this.progress.state,this},d.prototype.updateProgress=function(a,v,x,b){return this.setProgress(a?this.progress.val+a:null,v||null,x?this.progress.n+x:null,b?this.progress.stack.concat(b):null)},d.prototype.then=function(a,v){var x=this;return this.thenCore(a,v,function(b,I){return x.updateProgress(null,null,1,[b]),Promise.prototype.then.call(this,function(M){return x.updateProgress(null,b),M}).then(b,I).then(function(M){return x.updateProgress(1),M})})},d.prototype.thenCore=function(a,v,x){x=x||Promise.prototype.then;var b=this;a&&(a=a.bind(b)),v&&(v=v.bind(b));var I=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?b:d.convert(Object.assign({},b),Promise.prototype),M=x.call(I,a,v);return d.convert(M,b.__proto__)},d.prototype.thenExternal=function(a,v){return Promise.prototype.then.call(this,a,v)},d.prototype.thenList=function(a){var v=this;return a.forEach(function(x){v=v.thenCore(x)}),v},d.prototype.catch=function(a){a&&(a=a.bind(this));var v=Promise.prototype.catch.call(this,a);return d.convert(v,this)},d.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},d.prototype.error=function(a){return this.then(function(){throw new Error(a)})},d.prototype.using=d.prototype.set,d.prototype.saveAs=d.prototype.save,d.prototype.export=d.prototype.output,d.prototype.run=d.prototype.then,Qi.getPageSize=function(a,v,x){if(ps(a)==="object"){var b=a;a=b.orientation,v=b.unit||v,x=b.format||x}v=v||"mm",x=x||"a4",a=(""+(a||"P")).toLowerCase();var I,M=(""+x).toLowerCase(),L={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(v){case"pt":I=1;break;case"mm":I=72/25.4;break;case"cm":I=72/2.54;break;case"in":I=72;break;case"px":I=.75;break;case"pc":case"em":I=12;break;case"ex":I=6;break;default:throw"Invalid unit: "+v}var U,R=0,H=0;if(L.hasOwnProperty(M))R=L[M][1]/I,H=L[M][0]/I;else try{R=x[1],H=x[0]}catch{throw new Error("Invalid format: "+x)}if(a==="p"||a==="portrait")a="p",H>R&&(U=H,H=R,R=U);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",R>H&&(U=H,H=R,R=U)}return{width:H,height:R,unit:v,k:I,orientation:a}},e.html=function(a,v){(v=v||{}).callback=v.callback||function(){},v.html2canvas=v.html2canvas||{},v.html2canvas.canvas=v.html2canvas.canvas||this.canvas,v.jsPDF=v.jsPDF||this,v.fontFaces=v.fontFaces?v.fontFaces.map($S):null;var x=new d(v);return v.worker?x:x.from(a).doCallback()}}(Qi.API),Qi.API.addJS=function(e){return uN=e,this.internal.events.subscribe("postPutResources",function(){bw=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(bw+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),cN=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+uN+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){bw!==void 0&&cN!==void 0&&this.internal.out("/Names <</JavaScript "+bw+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var l=r.outline.render().split(/\r\n/),u=0;u<l.length;u++){var d=l[u],a=n.exec(d);if(a!=null){var v=a[1];r.internal.newObjectDeferredBegin(v,!1)}r.internal.write(d)}if(this.outline.createNamedDestinations){var x=this.internal.pages.length,b=[];for(u=0;u<x;u++){var I=r.internal.newObject();b.push(I);var M=r.internal.getPageInfo(u+1);r.internal.write("<< /D["+M.objId+" 0 R /XYZ null null null]>> endobj")}var L=r.internal.newObject();for(r.internal.write("<< /Names [ "),u=0;u<b.length;u++)r.internal.write("(page_"+(u+1)+")"+b[u]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+L+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,l,u){var d={title:l,options:u,children:[]};return n==null&&(n=this.root),n.children.push(d),d},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var l=0;l<n.children.length;l++)this.genIds_r(n.children[l])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var l=this.ctx.pdf.internal.getVerticalCoordinateString,u=0;u<n.children.length;u++){var d=n.children[u];this.objStart(d),this.line("/Title "+this.makeString(d.title)),this.line("/Parent "+this.makeRef(n)),u>0&&this.line("/Prev "+this.makeRef(n.children[u-1])),u<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[u+1])),d.children.length>0&&(this.line("/First "+this.makeRef(d.children[0])),this.line("/Last "+this.makeRef(d.children[d.children.length-1])));var a=this.count=this.count_r({count:0},d);if(a>0&&this.line("/Count "+a),d.options&&d.options.pageNumber){var v=r.internal.getPageInfo(d.options.pageNumber);this.line("/Dest ["+v.objId+" 0 R /XYZ 0 "+l(0)+" 0]")}this.objEnd()}for(var x=0;x<n.children.length;x++)this.renderItems(n.children[x])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,l){for(var u=0;u<l.children.length;u++)n.count++,this.count_r(n,l.children[u]);return n.count}}])}(Qi.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,l,u,d,a){var v,x=this.decode.DCT_DECODE,b=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=d||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,v=function(I){for(var M,L=256*I.charCodeAt(4)+I.charCodeAt(5),U=I.length,R={width:0,height:0,numcomponents:1},H=4;H<U;H+=2){if(H+=L,t.indexOf(I.charCodeAt(H+1))!==-1){M=256*I.charCodeAt(H+5)+I.charCodeAt(H+6),R={width:256*I.charCodeAt(H+7)+I.charCodeAt(H+8),height:M,numcomponents:I.charCodeAt(H+9)};break}L=256*I.charCodeAt(H+2)+I.charCodeAt(H+3)}return R}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),v.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}b={data:r,width:v.width,height:v.height,colorSpace:a,bitsPerComponent:8,filter:x,index:n,alias:l}}return b}}(Qi.API),Qi.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var l,u=d1e(e,{checkCrc:!0}),d=u.width,a=u.height,v=u.channels,x=u.palette,b=u.depth;l=x&&v===1?function(Be){for(var De=Be.width,we=Be.height,nt=Be.data,_e=Be.palette,Ie=Be.depth,Ze=!1,st=[],Et=[],Ut=void 0,jt=!1,bt=0,Nt=0;Nt<_e.length;Nt++){var ar=dU(_e[Nt],4),lt=ar[0],ie=ar[1],Le=ar[2],Fe=ar[3];st.push(lt,ie,Le),Fe!=null&&(Fe===0?(bt++,Et.length<1&&Et.push(Nt)):Fe<255&&(jt=!0))}if(jt||bt>1){Ze=!0,Et=void 0;var Re=De*we;Ut=new Uint8Array(Re);for(var et=new DataView(nt.buffer),xt=0;xt<Re;xt++){var Dt=ZS(et,xt,Ie),pt=dU(_e[Dt],4)[3];Ut[xt]=pt}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:nt,alphaBytes:Ut,needSMask:Ze,palette:st,mask:Et}}(u):v===2||v===4?function(Be){for(var De=Be.data,we=Be.width,nt=Be.height,_e=Be.channels,Ie=Be.depth,Ze=_e===2?"DeviceGray":"DeviceRGB",st=_e-1,Et=we*nt,Ut=st,jt=Et*Ut,bt=1*Et,Nt=Math.ceil(jt*Ie/8),ar=Math.ceil(bt*Ie/8),lt=new Uint8Array(Nt),ie=new Uint8Array(ar),Le=new DataView(De.buffer),Fe=new DataView(lt.buffer),Re=new DataView(ie.buffer),et=!1,xt=0;xt<Et;xt++){for(var Dt=xt*_e,pt=0;pt<Ut;pt++)vN(Fe,ZS(Le,Dt+pt,Ie),xt*Ut+pt,Ie);var Ct=ZS(Le,Dt+Ut,Ie);Ct<(1<<Ie)-1&&(et=!0),vN(Re,Ct,1*xt,Ie)}return{colorSpace:Ze,colorsPerPixel:st,colorBytes:lt,alphaBytes:ie,needSMask:et}}(u):function(Be){var De=Be.data,we=Be.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:we,colorsPerPixel:we==="DeviceGray"?1:3,colorBytes:De instanceof Uint8Array?De:new Uint8Array(De.buffer),needSMask:!1}}(u);var I,M,L,U=l,R=U.colorSpace,H=U.colorsPerPixel,q=U.colorBytes,te=U.alphaBytes,J=U.needSMask,se=U.palette,ye=U.mask,Se=null;return n!==Qi.API.image_compression.NONE&&typeof x5=="function"?(Se=function(Be){var De;switch(Be){case Qi.API.image_compression.FAST:De=11;break;case Qi.API.image_compression.MEDIUM:De=13;break;case Qi.API.image_compression.SLOW:De=14;break;default:De=12}return De}(n),I=this.decode.FLATE_DECODE,M="/Predictor ".concat(Se," "),e=dN(q,d*H,H,n),J&&(L=dN(te,d,1,n))):(I=void 0,M="",e=q,J&&(L=te)),M+="/Colors ".concat(H," /BitsPerComponent ").concat(b," /Columns ").concat(d),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(L&&this.__addimage__.isArrayBuffer(L)||this.__addimage__.isArrayBufferView(L))&&(L=this.__addimage__.arrayBufferToBinaryString(L)),{alias:r,data:e,index:t,filter:I,decodeParameters:M,transparency:ye,palette:se,sMask:L,predictor:Se,width:d,height:a,bitsPerComponent:b,colorSpace:R}}},function(e){e.processGIF89A=function(t,r,n,l){var u=new D1e(t),d=u.width,a=u.height,v=[];u.decodeAndBlitFrameRGBA(0,v);var x={data:v,width:d,height:a},b=new YS(100).encode(x,100);return e.processJPEG.call(this,b,r,n,l)},e.processGIF87A=e.processGIF89A}(Qi.API),Pd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),u=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:l,green:n,blue:r,quad:u}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Pd.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Us.log("bit decode error:"+r)}},Pd.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,l=0;l<t;l++)for(var u=this.datav.getUint8(this.pos++,!0),d=n*this.width*4+8*l*4,a=0;a<8&&8*l+a<this.width;a++){var v=this.palette[u>>7-a&1];this.data[d+4*a]=v.blue,this.data[d+4*a+1]=v.green,this.data[d+4*a+2]=v.red,this.data[d+4*a+3]=255}r!==0&&(this.pos+=4-r)}},Pd.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,l=0;l<e;l++){var u=this.datav.getUint8(this.pos++,!0),d=n*this.width*4+2*l*4,a=u>>4,v=15&u,x=this.palette[a];if(this.data[d]=x.blue,this.data[d+1]=x.green,this.data[d+2]=x.red,this.data[d+3]=255,2*l+1>=this.width)break;x=this.palette[v],this.data[d+4]=x.blue,this.data[d+4+1]=x.green,this.data[d+4+2]=x.red,this.data[d+4+3]=255}t!==0&&(this.pos+=4-t)}},Pd.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var l=this.datav.getUint8(this.pos++,!0),u=r*this.width*4+4*n;if(l<this.palette.length){var d=this.palette[l];this.data[u]=d.red,this.data[u+1]=d.green,this.data[u+2]=d.blue,this.data[u+3]=255}else this.data[u]=255,this.data[u+1]=255,this.data[u+2]=255,this.data[u+3]=255}e!==0&&(this.pos+=4-e)}},Pd.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,l=0;l<this.width;l++){var u=this.datav.getUint16(this.pos,!0);this.pos+=2;var d=(u&t)/t*255|0,a=(u>>5&t)/t*255|0,v=(u>>10&t)/t*255|0,x=u>>15?255:0,b=n*this.width*4+4*l;this.data[b]=v,this.data[b+1]=a,this.data[b+2]=d,this.data[b+3]=x}this.pos+=e}},Pd.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var l=this.bottom_up?n:this.height-1-n,u=0;u<this.width;u++){var d=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(d&t)/t*255|0,v=(d>>5&r)/r*255|0,x=(d>>11)/t*255|0,b=l*this.width*4+4*u;this.data[b]=x,this.data[b+1]=v,this.data[b+2]=a,this.data[b+3]=255}this.pos+=e}},Pd.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),u=this.datav.getUint8(this.pos++,!0),d=t*this.width*4+4*r;this.data[d]=u,this.data[d+1]=l,this.data[d+2]=n,this.data[d+3]=255}this.pos+=this.width%4}},Pd.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),u=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*r;this.data[a]=u,this.data[a+1]=l,this.data[a+2]=n,this.data[a+3]=d}},Pd.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,l){var u=new Pd(t,!1),d=u.width,a=u.height,v={data:u.getData(),width:d,height:a},x=new YS(100).encode(v,100);return e.processJPEG.call(this,x,r,n,l)}}(Qi.API),xN.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,l){var u=new xN(t),d=u.width,a=u.height,v={data:u.getData(),width:d,height:a},x=new YS(100).encode(v,100);return e.processJPEG.call(this,x,r,n,l)}}(Qi.API),Qi.API.processRGBA=function(e,t,r){for(var n=e.data,l=n.length,u=new Uint8Array(l/4*3),d=new Uint8Array(l/4),a=0,v=0,x=0;x<l;x+=4){var b=n[x],I=n[x+1],M=n[x+2],L=n[x+3];u[a++]=b,u[a++]=I,u[a++]=M,d[v++]=L}var U=this.__addimage__.arrayBufferToBinaryString(u);return{alpha:this.__addimage__.arrayBufferToBinaryString(d),data:U,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Qi.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},b_=Qi.API,Ew=b_.getCharWidthsArray=function(e,t){var r,n,l=(t=t||{}).font||this.internal.getFont(),u=t.fontSize||this.internal.getFontSize(),d=t.charSpace||this.internal.getCharSpace(),a=t.widths?t.widths:l.metadata.Unicode.widths,v=a.fof?a.fof:1,x=t.kerning?t.kerning:l.metadata.Unicode.kerning,b=x.fof?x.fof:1,I=t.doKerning!==!1,M=0,L=e.length,U=0,R=a[0]||v,H=[];for(r=0;r<L;r++)n=e.charCodeAt(r),typeof l.metadata.widthOfString=="function"?H.push((l.metadata.widthOfGlyph(l.metadata.characterToGlyph(n))+d*(1e3/u)||0)/1e3):(M=I&&ps(x[n])==="object"&&!isNaN(parseInt(x[n][U],10))?x[n][U]/b:0,H.push((a[n]||R)/v+M)),U=n;return H},hN=b_.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),l=t.charSpace||this.internal.getCharSpace();return b_.processArabic&&(e=b_.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,l)/r:Ew.apply(this,arguments).reduce(function(u,d){return u+d},0)},fN=function(e,t,r,n){for(var l=[],u=0,d=e.length,a=0;u!==d&&a+t[u]<r;)a+=t[u],u++;l.push(e.slice(0,u));var v=u;for(a=0;u!==d;)a+t[u]>n&&(l.push(e.slice(v,u)),a=0,v=u),a+=t[u],u++;return v!==u&&l.push(e.slice(v,u)),l},AN=function(e,t,r){r||(r={});var n,l,u,d,a,v,x,b=[],I=[b],M=r.textIndent||0,L=0,U=0,R=e.split(" "),H=Ew.apply(this,[" ",r])[0];if(v=r.lineIndent===-1?R[0].length+2:r.lineIndent||0){var q=Array(v).join(" "),te=[];R.map(function(se){(se=se.split(/\s*\n/)).length>1?te=te.concat(se.map(function(ye,Se){return(Se&&ye.length?`
`:"")+ye})):te.push(se[0])}),R=te,v=hN.apply(this,[q,r])}for(u=0,d=R.length;u<d;u++){var J=0;if(n=R[u],v&&n[0]==`
`&&(n=n.substr(1),J=1),M+L+(U=(l=Ew.apply(this,[n,r])).reduce(function(se,ye){return se+ye},0))>t||J){if(U>t){for(a=fN.apply(this,[n,l,t-(M+L),t]),b.push(a.shift()),b=[a.pop()];a.length;)I.push([a.shift()]);U=l.slice(n.length-(b[0]?b[0].length:0)).reduce(function(se,ye){return se+ye},0)}else b=[n];I.push(b),M=U+v,L=H}else b.push(n),M+=L+U,L=H}return x=v?function(se,ye){return(ye?q:"")+se.join(" ")}:function(se){return se.join(" ")},I.map(x)},b_.splitTextToSize=function(e,t,r){var n,l=(r=r||{}).fontSize||this.internal.getFontSize(),u=(function(b){if(b.widths&&b.kerning)return{widths:b.widths,kerning:b.kerning};var I=this.internal.getFont(b.fontName,b.fontStyle),M="Unicode";return I.metadata[M]?{widths:I.metadata[M].widths||{0:1},kerning:I.metadata[M].kerning||{}}:{font:I.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var d=1*this.internal.scaleFactor*t/l;u.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/l:0,u.lineIndent=r.lineIndent;var a,v,x=[];for(a=0,v=n.length;a<v;a++)x=x.concat(AN.apply(this,[n[a],d,u]));return x},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},l={},u=0;u<16;u++)n[r[u]]=t[u],l[t[u]]=r[u];var d=function(M){return"0x"+parseInt(M,10).toString(16)},a=e.__fontmetrics__.compress=function(M){var L,U,R,H,q=["{"];for(var te in M){if(L=M[te],isNaN(parseInt(te,10))?U="'"+te+"'":(te=parseInt(te,10),U=(U=d(te).slice(2)).slice(0,-1)+l[U.slice(-1)]),typeof L=="number")L<0?(R=d(L).slice(3),H="-"):(R=d(L).slice(2),H=""),R=H+R.slice(0,-1)+l[R.slice(-1)];else{if(ps(L)!=="object")throw new Error("Don't know what to do with value type "+ps(L)+".");R=a(L)}q.push(U+R)}return q.push("}"),q.join("")},v=e.__fontmetrics__.uncompress=function(M){if(typeof M!="string")throw new Error("Invalid argument passed to uncompress.");for(var L,U,R,H,q={},te=1,J=q,se=[],ye="",Se="",Be=M.length-1,De=1;De<Be;De+=1)(H=M[De])=="'"?L?(R=L.join(""),L=void 0):L=[]:L?L.push(H):H=="{"?(se.push([J,R]),J={},R=void 0):H=="}"?((U=se.pop())[0][U[1]]=J,R=void 0,J=U[0]):H=="-"?te=-1:R===void 0?n.hasOwnProperty(H)?(ye+=n[H],R=parseInt(ye,16)*te,te=1,ye=""):ye+=H:n.hasOwnProperty(H)?(Se+=n[H],J[R]=parseInt(Se,16)*te,te=1,R=void 0,Se=""):Se+=H;return q},x={codePages:["WinAnsiEncoding"],WinAnsiEncoding:v("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},b={Unicode:{Courier:x,"Courier-Bold":x,"Courier-BoldOblique":x,"Courier-Oblique":x,Helvetica:x,"Helvetica-Bold":x,"Helvetica-BoldOblique":x,"Helvetica-Oblique":x,"Times-Roman":x,"Times-Bold":x,"Times-BoldItalic":x,"Times-Italic":x}},I={Unicode:{"Courier-Oblique":v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":v("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":v("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":v("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:v("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:v("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":v("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:v("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":v("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":v("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":v("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(M){var L=M.font,U=I.Unicode[L.postScriptName];U&&(L.metadata.Unicode={},L.metadata.Unicode.widths=U.widths,L.metadata.Unicode.kerning=U.kerning);var R=b.Unicode[L.postScriptName];R&&(L.metadata.Unicode.encoding=R,L.encoding=R.codePages[0])}])}(Qi.API),function(e){var t=function(r){for(var n=r.length,l=new Uint8Array(n),u=0;u<n;u++)l[u]=r.charCodeAt(u);return l};e.API.events.push(["addFont",function(r){var n=void 0,l=r.font,u=r.instance;if(!l.isStandardFont){if(u===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");if(typeof(n=u.existsFileInVFS(l.postScriptName)===!1?u.loadFile(l.postScriptName):u.getFileFromVFS(l.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");(function(d,a){a=/^\x00\x01\x00\x00/.test(a)?t(a):t(e2(a)),d.metadata=e.API.TTFFont.open(a),d.metadata.Unicode=d.metadata.Unicode||{encoding:{},kerning:{},widths:[]},d.metadata.glyIdsUsed=[0]})(l,n)}}])}(Qi),Qi.API.addSvgAsImage=function(e,t,r,n,l,u,d,a){if(isNaN(t)||isNaN(r))throw Us.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(l))throw Us.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var v=document.createElement("canvas");v.width=n,v.height=l;var x=v.getContext("2d");x.fillStyle="#fff",x.fillRect(0,0,v.width,v.height);var b={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},I=this;return(pa.canvg?Promise.resolve(pa.canvg):PS(()=>import("./index.es-DB40QiEa.js"),[])).catch(function(M){return Promise.reject(new Error("Could not load canvg: "+M))}).then(function(M){return M.default?M.default:M}).then(function(M){return M.fromString(x,e,b)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(M){return M.render(b)}).then(function(){I.addImage(v.toDataURL("image/jpeg",1),t,r,n,l,d,a)})},Qi.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var l=0;l<this.internal.pages[n].length;l++)this.internal.pages[n][l]=this.internal.pages[n][l].replace(t,r);return this},Qi.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,l,u,d={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(d),v=[],x=0,b=0,I=0;function M(U,R){var H,q=!1;for(H=0;H<U.length;H+=1)U[H]===R&&(q=!0);return q}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(d)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var L=a.length;for(I=0;I<L;I+=1)r[a[I]].value=r[a[I]].defaultValue,r[a[I]].explicitSet=!1}if(ps(e)==="object"){for(l in e)if(u=e[l],M(a,l)&&u!==void 0){if(r[l].type==="boolean"&&typeof u=="boolean")r[l].value=u;else if(r[l].type==="name"&&M(r[l].valueSet,u))r[l].value=u;else if(r[l].type==="integer"&&Number.isInteger(u))r[l].value=u;else if(r[l].type==="array"){for(x=0;x<u.length;x+=1)if(n=!0,u[x].length===1&&typeof u[x][0]=="number")v.push(String(u[x]-1));else if(u[x].length>1){for(b=0;b<u[x].length;b+=1)typeof u[x][b]!="number"&&(n=!1);n===!0&&v.push([u[x][0]-1,u[x][1]-1].join(" "))}r[l].value="["+v.join(" ")+"]"}else r[l].value=r[l].defaultValue;r[l].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var U,R=[];for(U in r)r[U].explicitSet===!0&&(r[U].type==="name"?R.push("/"+U+" /"+r[U].value):R.push("/"+U+" "+r[U].value));R.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+R.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',l=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),u=unescape(encodeURIComponent(n)),d=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),v=unescape(encodeURIComponent("</x:xmpmeta>")),x=u.length+d.length+a.length+l.length+v.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+x+" >>"),this.internal.write("stream"),this.internal.write(l+u+d+a+v),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,l){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:l||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Qi.API),function(e){var t=e.API,r=t.pdfEscape16=function(u,d){for(var a,v=d.metadata.Unicode.widths,x=["","0","00","000","0000"],b=[""],I=0,M=u.length;I<M;++I){if(a=d.metadata.characterToGlyph(u.charCodeAt(I)),d.metadata.glyIdsUsed.push(a),d.metadata.toUnicode[a]=u.charCodeAt(I),v.indexOf(a)==-1&&(v.push(a),v.push([parseInt(d.metadata.widthOfGlyph(a),10)])),a=="0")return b.join("");a=a.toString(16),b.push(x[4-a.length],a)}return b.join("")},n=function(u){var d,a,v,x,b,I,M;for(b=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,v=[],I=0,M=(a=Object.keys(u).sort(function(L,U){return L-U})).length;I<M;I++)d=a[I],v.length>=100&&(b+=`
`+v.length+` beginbfchar
`+v.join(`
`)+`
endbfchar`,v=[]),u[d]!==void 0&&u[d]!==null&&typeof u[d].toString=="function"&&(x=("0000"+u[d].toString(16)).slice(-4),d=("0000"+(+d).toString(16)).slice(-4),v.push("<"+d+"><"+x+">"));return v.length&&(b+=`
`+v.length+` beginbfchar
`+v.join(`
`)+`
endbfchar
`),b+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(u){(function(d){var a=d.font,v=d.out,x=d.newObject,b=d.putStream;if(a.metadata instanceof e.API.TTFFont&&a.encoding==="Identity-H"){for(var I=a.metadata.Unicode.widths,M=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),L="",U=0;U<M.length;U++)L+=String.fromCharCode(M[U]);var R=x();b({data:L,addLength1:!0,objectId:R}),v("endobj");var H=x();b({data:n(a.metadata.toUnicode),addLength1:!0,objectId:H}),v("endobj");var q=x();v("<<"),v("/Type /FontDescriptor"),v("/FontName /"+L_(a.fontName)),v("/FontFile2 "+R+" 0 R"),v("/FontBBox "+e.API.PDFObject.convert(a.metadata.bbox)),v("/Flags "+a.metadata.flags),v("/StemV "+a.metadata.stemV),v("/ItalicAngle "+a.metadata.italicAngle),v("/Ascent "+a.metadata.ascender),v("/Descent "+a.metadata.decender),v("/CapHeight "+a.metadata.capHeight),v(">>"),v("endobj");var te=x();v("<<"),v("/Type /Font"),v("/BaseFont /"+L_(a.fontName)),v("/FontDescriptor "+q+" 0 R"),v("/W "+e.API.PDFObject.convert(I)),v("/CIDToGIDMap /Identity"),v("/DW 1000"),v("/Subtype /CIDFontType2"),v("/CIDSystemInfo"),v("<<"),v("/Supplement 0"),v("/Registry (Adobe)"),v("/Ordering ("+a.encoding+")"),v(">>"),v(">>"),v("endobj"),a.objectNumber=x(),v("<<"),v("/Type /Font"),v("/Subtype /Type0"),v("/ToUnicode "+H+" 0 R"),v("/BaseFont /"+L_(a.fontName)),v("/Encoding /"+a.encoding),v("/DescendantFonts ["+te+" 0 R]"),v(">>"),v("endobj"),a.isAlreadyPutted=!0}})(u)}]),t.events.push(["putFont",function(u){(function(d){var a=d.font,v=d.out,x=d.newObject,b=d.putStream;if(a.metadata instanceof e.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var I=a.metadata.rawData,M="",L=0;L<I.length;L++)M+=String.fromCharCode(I[L]);var U=x();b({data:M,addLength1:!0,objectId:U}),v("endobj");var R=x();b({data:n(a.metadata.toUnicode),addLength1:!0,objectId:R}),v("endobj");var H=x();v("<<"),v("/Descent "+a.metadata.decender),v("/CapHeight "+a.metadata.capHeight),v("/StemV "+a.metadata.stemV),v("/Type /FontDescriptor"),v("/FontFile2 "+U+" 0 R"),v("/Flags 96"),v("/FontBBox "+e.API.PDFObject.convert(a.metadata.bbox)),v("/FontName /"+L_(a.fontName)),v("/ItalicAngle "+a.metadata.italicAngle),v("/Ascent "+a.metadata.ascender),v(">>"),v("endobj"),a.objectNumber=x();for(var q=0;q<a.metadata.hmtx.widths.length;q++)a.metadata.hmtx.widths[q]=parseInt(a.metadata.hmtx.widths[q]*(1e3/a.metadata.head.unitsPerEm));v("<</Subtype/TrueType/Type/Font/ToUnicode "+R+" 0 R/BaseFont/"+L_(a.fontName)+"/FontDescriptor "+H+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),v("endobj"),a.isAlreadyPutted=!0}})(u)}]);var l=function(u){var d,a=u.text||"",v=u.x,x=u.y,b=u.options||{},I=u.mutex||{},M=I.pdfEscape,L=I.activeFontKey,U=I.fonts,R=L,H="",q=0,te="",J=U[R].encoding;if(U[R].encoding!=="Identity-H")return{text:a,x:v,y:x,options:b,mutex:I};for(te=a,R=L,Array.isArray(a)&&(te=a[0]),q=0;q<te.length;q+=1)U[R].metadata.hasOwnProperty("cmap")&&(d=U[R].metadata.cmap.unicode.codeMap[te[q].charCodeAt(0)]),d||te[q].charCodeAt(0)<256&&U[R].metadata.hasOwnProperty("Unicode")?H+=te[q]:H+="";var se="";return parseInt(R.slice(1))<14||J==="WinAnsiEncoding"?se=M(H,R).split("").map(function(ye){return ye.charCodeAt(0).toString(16)}).join(""):J==="Identity-H"&&(se=r(H,U[R])),I.isHex=!0,{text:se,x:v,y:x,options:b,mutex:I}};t.events.push(["postProcessText",function(u){var d=u.text||"",a=[],v={text:d,x:u.x,y:u.y,options:u.options,mutex:u.mutex};if(Array.isArray(d)){var x=0;for(x=0;x<d.length;x+=1)Array.isArray(d[x])&&d[x].length===3?a.push([l(Object.assign({},v,{text:d[x][0]})).text,d[x][1],d[x][2]]):a.push(l(Object.assign({},v,{text:d[x]})).text);u.text=a}else u.text=l(Object.assign({},v,{text:d})).text}])}(Qi),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Qi.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var l,u,d,a,v,x,b,I=t,M=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],L=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],U={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},R={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},H=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],q=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),te=!1,J=0;this.__bidiEngine__={};var se=function(_e){var Ie=_e.charCodeAt(),Ze=Ie>>8,st=R[Ze];return st!==void 0?I[256*st+(255&Ie)]:Ze===252||Ze===253?"AL":q.test(Ze)?"L":Ze===8?"R":"N"},ye=function(_e){for(var Ie,Ze=0;Ze<_e.length;Ze++){if((Ie=se(_e.charAt(Ze)))==="L")return!1;if(Ie==="R")return!0}return!1},Se=function(_e,Ie,Ze,st){var Et,Ut,jt,bt,Nt=Ie[st];switch(Nt){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":te=!1;break;case"N":case"AN":break;case"EN":te&&(Nt="AN");break;case"AL":te=!0,Nt="R";break;case"WS":case"BN":Nt="N";break;case"CS":st<1||st+1>=Ie.length||(Et=Ze[st-1])!=="EN"&&Et!=="AN"||(Ut=Ie[st+1])!=="EN"&&Ut!=="AN"?Nt="N":te&&(Ut="AN"),Nt=Ut===Et?Ut:"N";break;case"ES":Nt=(Et=st>0?Ze[st-1]:"B")==="EN"&&st+1<Ie.length&&Ie[st+1]==="EN"?"EN":"N";break;case"ET":if(st>0&&Ze[st-1]==="EN"){Nt="EN";break}if(te){Nt="N";break}for(jt=st+1,bt=Ie.length;jt<bt&&Ie[jt]==="ET";)jt++;Nt=jt<bt&&Ie[jt]==="EN"?"EN":"N";break;case"NSM":if(d&&!a){for(bt=Ie.length,jt=st+1;jt<bt&&Ie[jt]==="NSM";)jt++;if(jt<bt){var ar=_e[st],lt=ar>=1425&&ar<=2303||ar===64286;if(Et=Ie[jt],lt&&(Et==="R"||Et==="AL")){Nt="R";break}}}Nt=st<1||(Et=Ie[st-1])==="B"?"N":Ze[st-1];break;case"B":te=!1,l=!0,Nt=J;break;case"S":u=!0,Nt="N"}return Nt},Be=function(_e,Ie,Ze){var st=_e.split("");return Ze&&De(st,Ze,{hiLevel:J}),st.reverse(),Ie&&Ie.reverse(),st.join("")},De=function(_e,Ie,Ze){var st,Et,Ut,jt,bt,Nt=-1,ar=_e.length,lt=0,ie=[],Le=J?L:M,Fe=[];for(te=!1,l=!1,u=!1,Et=0;Et<ar;Et++)Fe[Et]=se(_e[Et]);for(Ut=0;Ut<ar;Ut++){if(bt=lt,ie[Ut]=Se(_e,Fe,ie,Ut),st=240&(lt=Le[bt][U[ie[Ut]]]),lt&=15,Ie[Ut]=jt=Le[lt][5],st>0)if(st===16){for(Et=Nt;Et<Ut;Et++)Ie[Et]=1;Nt=-1}else Nt=-1;if(Le[lt][6])Nt===-1&&(Nt=Ut);else if(Nt>-1){for(Et=Nt;Et<Ut;Et++)Ie[Et]=jt;Nt=-1}Fe[Ut]==="B"&&(Ie[Ut]=0),Ze.hiLevel|=jt}u&&function(Re,et,xt){for(var Dt=0;Dt<xt;Dt++)if(Re[Dt]==="S"){et[Dt]=J;for(var pt=Dt-1;pt>=0&&Re[pt]==="WS";pt--)et[pt]=J}}(Fe,Ie,ar)},we=function(_e,Ie,Ze,st,Et){if(!(Et.hiLevel<_e)){if(_e===1&&J===1&&!l)return Ie.reverse(),void(Ze&&Ze.reverse());for(var Ut,jt,bt,Nt,ar=Ie.length,lt=0;lt<ar;){if(st[lt]>=_e){for(bt=lt+1;bt<ar&&st[bt]>=_e;)bt++;for(Nt=lt,jt=bt-1;Nt<jt;Nt++,jt--)Ut=Ie[Nt],Ie[Nt]=Ie[jt],Ie[jt]=Ut,Ze&&(Ut=Ze[Nt],Ze[Nt]=Ze[jt],Ze[jt]=Ut);lt=bt}lt++}}},nt=function(_e,Ie,Ze){var st=_e.split(""),Et={hiLevel:J};return Ze||(Ze=[]),De(st,Ze,Et),function(Ut,jt,bt){if(bt.hiLevel!==0&&b)for(var Nt,ar=0;ar<Ut.length;ar++)jt[ar]===1&&(Nt=H.indexOf(Ut[ar]))>=0&&(Ut[ar]=H[Nt+1])}(st,Ze,Et),we(2,st,Ie,Ze,Et),we(1,st,Ie,Ze,Et),st.join("")};return this.__bidiEngine__.doBidiReorder=function(_e,Ie,Ze){if(function(Et,Ut){if(Ut)for(var jt=0;jt<Et.length;jt++)Ut[jt]=jt;a===void 0&&(a=ye(Et)),x===void 0&&(x=ye(Et))}(_e,Ie),d||!v||x)if(d&&v&&a^x)J=a?1:0,_e=Be(_e,Ie,Ze);else if(!d&&v&&x)J=a?1:0,_e=nt(_e,Ie,Ze),_e=Be(_e,Ie);else if(!d||a||v||x){if(d&&!v&&a^x)_e=Be(_e,Ie),a?(J=0,_e=nt(_e,Ie,Ze)):(J=1,_e=nt(_e,Ie,Ze),_e=Be(_e,Ie));else if(d&&a&&!v&&x)J=1,_e=nt(_e,Ie,Ze),_e=Be(_e,Ie);else if(!d&&!v&&a^x){var st=b;a?(J=1,_e=nt(_e,Ie,Ze),J=0,b=!1,_e=nt(_e,Ie,Ze),b=st):(J=0,_e=nt(_e,Ie,Ze),_e=Be(_e,Ie),J=1,b=!1,_e=nt(_e,Ie,Ze),b=st,_e=Be(_e,Ie))}}else J=0,_e=nt(_e,Ie,Ze);else J=a?1:0,_e=nt(_e,Ie,Ze);return _e},this.__bidiEngine__.setOptions=function(_e){_e&&(d=_e.isInputVisual,v=_e.isOutputVisual,a=_e.isInputRtl,x=_e.isOutputRtl,b=_e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var l=n.text;n.x,n.y;var u=n.options||{};n.mutex,u.lang;var d=[];if(u.isInputVisual=typeof u.isInputVisual!="boolean"||u.isInputVisual,r.setOptions(u),Object.prototype.toString.call(l)==="[object Array]"){var a=0;for(d=[],a=0;a<l.length;a+=1)Object.prototype.toString.call(l[a])==="[object Array]"?d.push([r.doBidiReorder(l[a][0]),l[a][1],l[a][2]]):d.push([r.doBidiReorder(l[a])]);n.text=d}else n.text=r.doBidiReorder(l);r.setOptions({isInputVisual:!0})}])}(Qi),Qi.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Ig(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new X1e(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new R1e(this.contents),this.head=new U1e(this),this.name=new H1e(this),this.cmap=new GV(this),this.toUnicode={},this.hhea=new N1e(this),this.maxp=new V1e(this),this.hmtx=new G1e(this),this.post=new Q1e(this),this.os2=new z1e(this),this.loca=new $1e(this),this.glyf=new K1e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,l,u;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var d,a,v,x;for(x=[],d=0,a=(v=this.bbox).length;d<a;d++)t=v[d],x.push(Math.round(t*this.scaleFactor));return x}).call(this),this.stemV=0,this.post.exists?(n=255&(l=this.post.italic_angle),32768&(r=l>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(u=this.familyClass)===1||u===2||u===3||u===4||u===5||u===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var l,u,d,a;for(d=0,u=0,a=(t=""+t).length;0<=a?u<a:u>a;u=0<=a?++u:--u)l=t.charCodeAt(u),d+=this.widthOfGlyph(this.characterToGlyph(l))+n*(1e3/r)||0;return d*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Vd,Ig=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,l;for(l=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)l.push(this.writeByte(t.charCodeAt(r)));return l},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,l,u,d,a,v;return t=this.readByte(),r=this.readByte(),n=this.readByte(),l=this.readByte(),u=this.readByte(),d=this.readByte(),a=this.readByte(),v=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^l)+16777216*(255^u)+65536*(255^d)+256*(255^a)+(255^v)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*l+16777216*u+65536*d+256*a+v},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,l,u;for(u=[],n=0,l=t.length;n<l;n++)r=t[n],u.push(this.writeByte(r));return u},e}(),R1e=function(){var e;function t(r){var n,l,u;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},l=0,u=this.tableCount;0<=u?l<u:l>u;l=0<=u?++l:--l)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,l,u,d,a,v,x,b,I,M,L,U,R;for(R in L=Object.keys(r).length,v=Math.log(2),I=16*Math.floor(Math.log(L)/v),d=Math.floor(I/v),b=16*L-I,(l=new Ig).writeInt(this.scalarType),l.writeShort(L),l.writeShort(I),l.writeShort(d),l.writeShort(b),u=16*L,x=l.pos+u,a=null,U=[],r)for(M=r[R],l.writeString(R),l.writeInt(e(M)),l.writeInt(x),l.writeInt(M.length),U=U.concat(M),R==="head"&&(a=x),x+=M.length;x%4;)U.push(0),x++;return l.write(U),n=2981146554-e(l.data),l.pos=a+8,l.writeUInt32(n),l.data},e=function(r){var n,l,u,d;for(r=KV.call(r);r.length%4;)r.push(0);for(u=new Ig(r),l=0,n=0,d=r.length;n<d;n=n+=4)l+=u.readUInt32();return 4294967295&l},t}(),k1e={}.hasOwnProperty,Mp=function(e,t){for(var r in t)k1e.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Vd=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var U1e=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Ig).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),wN=function(){function e(t,r){var n,l,u,d,a,v,x,b,I,M,L,U,R,H,q,te,J;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),I=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(v=0;v<256;++v)this.codeMap[v]=t.readByte();break;case 4:for(L=t.readUInt16(),M=L/2,t.pos+=6,u=function(){var se,ye;for(ye=[],v=se=0;0<=M?se<M:se>M;v=0<=M?++se:--se)ye.push(t.readUInt16());return ye}(),t.pos+=2,R=function(){var se,ye;for(ye=[],v=se=0;0<=M?se<M:se>M;v=0<=M?++se:--se)ye.push(t.readUInt16());return ye}(),x=function(){var se,ye;for(ye=[],v=se=0;0<=M?se<M:se>M;v=0<=M?++se:--se)ye.push(t.readUInt16());return ye}(),b=function(){var se,ye;for(ye=[],v=se=0;0<=M?se<M:se>M;v=0<=M?++se:--se)ye.push(t.readUInt16());return ye}(),l=(this.length-t.pos+this.offset)/2,a=function(){var se,ye;for(ye=[],v=se=0;0<=l?se<l:se>l;v=0<=l?++se:--se)ye.push(t.readUInt16());return ye}(),v=q=0,J=u.length;q<J;v=++q)for(H=u[v],n=te=U=R[v];U<=H?te<=H:te>=H;n=U<=H?++te:--te)b[v]===0?d=n+x[v]:(d=a[b[v]/2+(n-U)-(M-v)]||0)!==0&&(d+=x[v]),this.codeMap[n]=65535&d}t.pos=I}return e.encode=function(t,r){var n,l,u,d,a,v,x,b,I,M,L,U,R,H,q,te,J,se,ye,Se,Be,De,we,nt,_e,Ie,Ze,st,Et,Ut,jt,bt,Nt,ar,lt,ie,Le,Fe,Re,et,xt,Dt,pt,Ct,mr,Zt;switch(st=new Ig,d=Object.keys(t).sort(function(sn,er){return sn-er}),r){case"macroman":for(R=0,H=function(){var sn=[];for(U=0;U<256;++U)sn.push(0);return sn}(),te={0:0},u={},Et=0,Nt=d.length;Et<Nt;Et++)te[pt=t[l=d[Et]]]==null&&(te[pt]=++R),u[l]={old:t[l],new:te[t[l]]},H[l]=te[t[l]];return st.writeUInt16(1),st.writeUInt16(0),st.writeUInt32(12),st.writeUInt16(0),st.writeUInt16(262),st.writeUInt16(0),st.write(H),{charMap:u,subtable:st.data,maxGlyphID:R+1};case"unicode":for(Ie=[],I=[],J=0,te={},n={},q=x=null,Ut=0,ar=d.length;Ut<ar;Ut++)te[ye=t[l=d[Ut]]]==null&&(te[ye]=++J),n[l]={old:ye,new:te[ye]},a=te[ye]-l,q!=null&&a===x||(q&&I.push(q),Ie.push(l),x=a),q=l;for(q&&I.push(q),I.push(65535),Ie.push(65535),nt=2*(we=Ie.length),De=2*Math.pow(Math.log(we)/Math.LN2,2),M=Math.log(De/2)/Math.LN2,Be=2*we-De,v=[],Se=[],L=[],U=jt=0,lt=Ie.length;jt<lt;U=++jt){if(_e=Ie[U],b=I[U],_e===65535){v.push(0),Se.push(0);break}if(_e-(Ze=n[_e].new)>=32768)for(v.push(0),Se.push(2*(L.length+we-U)),l=bt=_e;_e<=b?bt<=b:bt>=b;l=_e<=b?++bt:--bt)L.push(n[l].new);else v.push(Ze-_e),Se.push(0)}for(st.writeUInt16(3),st.writeUInt16(1),st.writeUInt32(12),st.writeUInt16(4),st.writeUInt16(16+8*we+2*L.length),st.writeUInt16(0),st.writeUInt16(nt),st.writeUInt16(De),st.writeUInt16(M),st.writeUInt16(Be),xt=0,ie=I.length;xt<ie;xt++)l=I[xt],st.writeUInt16(l);for(st.writeUInt16(0),Dt=0,Le=Ie.length;Dt<Le;Dt++)l=Ie[Dt],st.writeUInt16(l);for(Ct=0,Fe=v.length;Ct<Fe;Ct++)a=v[Ct],st.writeUInt16(a);for(mr=0,Re=Se.length;mr<Re;mr++)se=Se[mr],st.writeUInt16(se);for(Zt=0,et=L.length;Zt<et;Zt++)R=L[Zt],st.writeUInt16(R);return{charMap:n,subtable:st.data,maxGlyphID:J+1}}},e}(),GV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,l;for(t.pos=this.offset,this.version=t.readUInt16(),l=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=l?n<l:n>l;n=0<=l?++n:--n)r=new wN(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,l;return r==null&&(r="macroman"),n=wN.encode(t,r),(l=new Ig).writeUInt16(0),l.writeUInt16(1),n.table=l.data.concat(n.subtable),n},e}(),N1e=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),z1e=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),Q1e=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,l;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var u;for(n=t.readUInt16(),this.glyphNameIndex=[],u=0;0<=n?u<n:u>n;u=0<=n?++u:--u)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],l=[];t.pos<this.offset+this.length;)r=t.readByte(),l.push(this.names.push(t.readString(r)));return l;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var d,a,v;for(v=[],u=d=0,a=this.file.maxp.numGlyphs;0<=a?d<a:d>a;u=0<=a?++d:--d)v.push(t.readUInt32());return v}).call(this)}},e}(),j1e=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},H1e=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,l,u,d,a,v,x,b,I,M;for(t.pos=this.offset,t.readShort(),r=t.readShort(),a=t.readShort(),n=[],u=0;0<=r?u<r:u>r;u=0<=r?++u:--u)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+a+t.readShort()});for(v={},u=b=0,I=n.length;b<I;u=++b)l=n[u],t.pos=l.offset,x=t.readString(l.length),d=new j1e(x,l),v[M=l.nameID]==null&&(v[M]=[]),v[l.nameID].push(d);this.strings=v,this.copyright=v[0],this.fontFamily=v[1],this.fontSubfamily=v[2],this.uniqueSubfamily=v[3],this.fontName=v[4],this.version=v[5];try{this.postscriptName=v[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=v[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=v[7],this.manufacturer=v[8],this.designer=v[9],this.description=v[10],this.vendorUrl=v[11],this.designerUrl=v[12],this.license=v[13],this.licenseUrl=v[14],this.preferredFamily=v[15],this.preferredSubfamily=v[17],this.compatibleFull=v[18],this.sampleText=v[19]},e}(),V1e=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),G1e=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,l,u,d,a,v;for(t.pos=this.offset,this.metrics=[],r=0,a=this.file.hhea.numberOfMetrics;0<=a?r<a:r>a;r=0<=a?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(l=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var x,b;for(b=[],r=x=0;0<=l?x<l:x>l;r=0<=l?++x:--x)b.push(t.readInt16());return b}(),this.widths=(function(){var x,b,I,M;for(M=[],x=0,b=(I=this.metrics).length;x<b;x++)u=I[x],M.push(u.advance);return M}).call(this),n=this.widths[this.widths.length-1],v=[],r=d=0;0<=l?d<l:d>l;r=0<=l?++d:--d)v.push(this.widths.push(n));return v},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),KV=[].slice,K1e=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,l,u,d,a,v,x,b,I;return t in this.cache?this.cache[t]:(u=this.file.loca,r=this.file.contents,n=u.indexOf(t),(l=u.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,d=(a=new Ig(r.read(l))).readShort(),x=a.readShort(),I=a.readShort(),v=a.readShort(),b=a.readShort(),this.cache[t]=d===-1?new q1e(a,x,I,v,b):new W1e(a,d,x,I,v,b),this.cache[t]))},e.prototype.encode=function(t,r,n){var l,u,d,a,v;for(d=[],u=[],a=0,v=r.length;a<v;a++)l=t[r[a]],u.push(d.length),l&&(d=d.concat(l.encode(n)));return u.push(d.length),{table:d,offsets:u}},e}(),W1e=function(){function e(t,r,n,l,u,d){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=l,this.xMax=u,this.yMax=d,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),q1e=function(){function e(t,r,n,l,u){var d,a;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=l,this.yMax=u,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],d=this.raw;a=d.readShort(),this.glyphOffsets.push(d.pos),this.glyphIDs.push(d.readUInt16()),32&a;)d.pos+=1&a?4:2,128&a?d.pos+=8:64&a?d.pos+=4:8&a&&(d.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Ig(KV.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),$1e=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Mp(e,Vd),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var l,u;for(u=[],n=0,l=this.length;n<l;n+=2)u.push(2*t.readUInt16());return u}).call(this):(function(){var l,u;for(u=[],n=0,l=this.length;n<l;n+=4)u.push(t.readUInt32());return u}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),l=0,u=0,d=0;d<n.length;++d)if(n[d]=l,u<r.length&&r[u]==d){++u,n[d]=l;var a=this.offsets[d],v=this.offsets[d+1]-a;v>0&&(l+=v)}for(var x=new Array(4*n.length),b=0;b<n.length;++b)x[4*b+3]=255&n[b],x[4*b+2]=(65280&n[b])>>8,x[4*b+1]=(16711680&n[b])>>16,x[4*b]=(4278190080&n[b])>>24;return x},e}(),X1e=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,l,u;for(r in l=this.font.cmap.tables[0].codeMap,t={},u=this.subset)n=u[r],t[r]=l[n];return t},e.prototype.glyphsFor=function(t){var r,n,l,u,d,a,v;for(l={},d=0,a=t.length;d<a;d++)l[u=t[d]]=this.font.glyf.glyphFor(u);for(u in r=[],l)(n=l[u])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(u in v=this.glyphsFor(r))n=v[u],l[u]=n;return l},e.prototype.encode=function(t,r){var n,l,u,d,a,v,x,b,I,M,L,U,R,H,q;for(l in n=GV.encode(this.generateCmap(),"unicode"),d=this.glyphsFor(t),L={0:0},q=n.charMap)L[(v=q[l]).old]=v.new;for(U in M=n.maxGlyphID,d)U in L||(L[U]=M++);return b=function(te){var J,se;for(J in se={},te)se[te[J]]=J;return se}(L),I=Object.keys(b).sort(function(te,J){return te-J}),R=function(){var te,J,se;for(se=[],te=0,J=I.length;te<J;te++)a=I[te],se.push(b[a]);return se}(),u=this.font.glyf.encode(d,R,L),x=this.font.loca.encode(u.offsets,R),H={cmap:this.font.cmap.raw(),glyf:u.table,loca:x,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(H["OS/2"]=this.font.os2.raw()),this.font.directory.encode(H)},e}();Qi.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,l,u,d;if(Array.isArray(r))return"["+function(){var a,v,x;for(x=[],a=0,v=r.length;a<v;a++)n=r[a],x.push(t.convert(n));return x}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(l in u=["<<"],r)d=r[l],u.push("/"+l+" "+t.convert(d));return u.push(">>"),u.join(`
`)}return""+r},t}();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var I5=function(e,t){return I5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])},I5(e,t)};function Gd(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");I5(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var F5=function(){return F5=Object.assign||function(t){for(var r,n=1,l=arguments.length;n<l;n++){r=arguments[n];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(t[u]=r[u])}return t},F5.apply(this,arguments)};function af(e,t,r,n){function l(u){return u instanceof r?u:new r(function(d){d(u)})}return new(r||(r=Promise))(function(u,d){function a(b){try{x(n.next(b))}catch(I){d(I)}}function v(b){try{x(n.throw(b))}catch(I){d(I)}}function x(b){b.done?u(b.value):l(b.value).then(a,v)}x((n=n.apply(e,[])).next())})}function Mh(e,t){var r={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},n,l,u,d;return d={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function a(x){return function(b){return v([x,b])}}function v(x){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,l&&(u=x[0]&2?l.return:x[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,x[1])).done)return u;switch(l=0,u&&(x=[x[0]&2,u.value]),x[0]){case 0:case 1:u=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,l=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(u=r.trys,!(u=u.length>0&&u[u.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!u||x[1]>u[0]&&x[1]<u[3])){r.label=x[1];break}if(x[0]===6&&r.label<u[1]){r.label=u[1],u=x;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(x);break}u[2]&&r.ops.pop(),r.trys.pop();continue}x=t.call(e,r)}catch(b){x=[6,b],l=0}finally{n=u=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}}function Bw(e,t,r){if(arguments.length===2)for(var n=0,l=t.length,u;n<l;n++)(u||!(n in t))&&(u||(u=Array.prototype.slice.call(t,0,n)),u[n]=t[n]);return e.concat(u||t)}var ym=function(){function e(t,r,n,l){this.left=t,this.top=r,this.width=n,this.height=l}return e.prototype.add=function(t,r,n,l){return new e(this.left+t,this.top+r,this.width+n,this.height+l)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find(function(l){return l.width!==0});return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),fE=function(e,t){return ym.fromClientRect(e,t.getBoundingClientRect())},Z1e=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),l=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new ym(0,0,n,l)},AE=function(e){for(var t=[],r=0,n=e.length;r<n;){var l=e.charCodeAt(r++);if(l>=55296&&l<=56319&&r<n){var u=e.charCodeAt(r++);(u&64512)===56320?t.push(((l&1023)<<10)+(u&1023)+65536):(t.push(l),r--)}else t.push(l)}return t},dc=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],l=-1,u="";++l<r;){var d=e[l];d<=65535?n.push(d):(d-=65536,n.push((d>>10)+55296,d%1024+56320)),(l+1===r||n.length>16384)&&(u+=String.fromCharCode.apply(String,n),n.length=0)}return u},bN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y1e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Cw=0;Cw<bN.length;Cw++)Y1e[bN.charCodeAt(Cw)]=Cw;var EN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ky=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Sw=0;Sw<EN.length;Sw++)ky[EN.charCodeAt(Sw)]=Sw;var J1e=function(e){var t=e.length*.75,r=e.length,n,l=0,u,d,a,v;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var x=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),b=Array.isArray(x)?x:new Uint8Array(x);for(n=0;n<r;n+=4)u=ky[e.charCodeAt(n)],d=ky[e.charCodeAt(n+1)],a=ky[e.charCodeAt(n+2)],v=ky[e.charCodeAt(n+3)],b[l++]=u<<2|d>>4,b[l++]=(d&15)<<4|a>>2,b[l++]=(a&3)<<6|v&63;return x},exe=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},txe=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},w0=5,EF=11,JS=2,rxe=EF-w0,WV=65536>>w0,nxe=1<<w0,eT=nxe-1,ixe=1024>>w0,axe=WV+ixe,oxe=axe,sxe=32,lxe=oxe+sxe,cxe=65536>>EF,uxe=1<<rxe,hxe=uxe-1,BN=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},fxe=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},Axe=function(e,t){var r=J1e(e),n=Array.isArray(r)?txe(r):new Uint32Array(r),l=Array.isArray(r)?exe(r):new Uint16Array(r),u=24,d=BN(l,u/2,n[4]/2),a=n[5]===2?BN(l,(u+n[4])/2):fxe(n,Math.ceil((u+n[4])/4));return new dxe(n[0],n[1],n[2],n[3],d,a)},dxe=function(){function e(t,r,n,l,u,d){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=l,this.index=u,this.data=d}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>w0],r=(r<<JS)+(t&eT),this.data[r];if(t<=65535)return r=this.index[WV+(t-55296>>w0)],r=(r<<JS)+(t&eT),this.data[r];if(t<this.highStart)return r=lxe-cxe+(t>>EF),r=this.index[r],r+=t>>w0&hxe,r=this.index[r],r=(r<<JS)+(t&eT),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),CN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pxe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Tw=0;Tw<CN.length;Tw++)pxe[CN.charCodeAt(Tw)]=Tw;var mxe="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",SN=50,gxe=1,qV=2,$V=3,_xe=4,vxe=5,TN=7,XV=8,IN=9,vg=10,P5=11,FN=12,L5=13,yxe=14,Uy=15,M5=16,Iw=17,Iy=18,xxe=19,PN=20,O5=21,Fy=22,tT=23,E_=24,oA=25,Ny=26,zy=27,B_=28,wxe=29,c0=30,bxe=31,Fw=32,Pw=33,D5=34,R5=35,k5=36,E1=37,U5=38,a2=39,o2=40,rT=41,ZV=42,Exe=43,Bxe=[9001,65288],YV="!",ho="×",Lw="÷",N5=Axe(mxe),Zp=[c0,k5],z5=[gxe,qV,$V,vxe],JV=[vg,XV],LN=[zy,Ny],Cxe=z5.concat(JV),MN=[U5,a2,o2,D5,R5],Sxe=[Uy,L5],Txe=function(e,t){t===void 0&&(t="strict");var r=[],n=[],l=[];return e.forEach(function(u,d){var a=N5.get(u);if(a>SN?(l.push(!0),a-=SN):l.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(u)!==-1)return n.push(d),r.push(M5);if(a===_xe||a===P5){if(d===0)return n.push(d),r.push(c0);var v=r[d-1];return Cxe.indexOf(v)===-1?(n.push(n[d-1]),r.push(v)):(n.push(d),r.push(c0))}if(n.push(d),a===bxe)return r.push(t==="strict"?O5:E1);if(a===ZV||a===wxe)return r.push(c0);if(a===Exe)return u>=131072&&u<=196605||u>=196608&&u<=262141?r.push(E1):r.push(c0);r.push(a)}),[n,r,l]},nT=function(e,t,r,n){var l=n[r];if(Array.isArray(e)?e.indexOf(l)!==-1:e===l)for(var u=r;u<=n.length;){u++;var d=n[u];if(d===t)return!0;if(d!==vg)break}if(l===vg)for(var u=r;u>0;){u--;var a=n[u];if(Array.isArray(e)?e.indexOf(a)!==-1:e===a)for(var v=r;v<=n.length;){v++;var d=n[v];if(d===t)return!0;if(d!==vg)break}if(a!==vg)break}return!1},ON=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n===vg)r--;else return n}return 0},Ixe=function(e,t,r,n,l){if(r[n]===0)return ho;var u=n-1;if(Array.isArray(l)&&l[u]===!0)return ho;var d=u-1,a=u+1,v=t[u],x=d>=0?t[d]:0,b=t[a];if(v===qV&&b===$V)return ho;if(z5.indexOf(v)!==-1)return YV;if(z5.indexOf(b)!==-1||JV.indexOf(b)!==-1)return ho;if(ON(u,t)===XV)return Lw;if(N5.get(e[u])===P5||(v===Fw||v===Pw)&&N5.get(e[a])===P5||v===TN||b===TN||v===IN||[vg,L5,Uy].indexOf(v)===-1&&b===IN||[Iw,Iy,xxe,E_,B_].indexOf(b)!==-1||ON(u,t)===Fy||nT(tT,Fy,u,t)||nT([Iw,Iy],O5,u,t)||nT(FN,FN,u,t))return ho;if(v===vg)return Lw;if(v===tT||b===tT)return ho;if(b===M5||v===M5)return Lw;if([L5,Uy,O5].indexOf(b)!==-1||v===yxe||x===k5&&Sxe.indexOf(v)!==-1||v===B_&&b===k5||b===PN||Zp.indexOf(b)!==-1&&v===oA||Zp.indexOf(v)!==-1&&b===oA||v===zy&&[E1,Fw,Pw].indexOf(b)!==-1||[E1,Fw,Pw].indexOf(v)!==-1&&b===Ny||Zp.indexOf(v)!==-1&&LN.indexOf(b)!==-1||LN.indexOf(v)!==-1&&Zp.indexOf(b)!==-1||[zy,Ny].indexOf(v)!==-1&&(b===oA||[Fy,Uy].indexOf(b)!==-1&&t[a+1]===oA)||[Fy,Uy].indexOf(v)!==-1&&b===oA||v===oA&&[oA,B_,E_].indexOf(b)!==-1)return ho;if([oA,B_,E_,Iw,Iy].indexOf(b)!==-1)for(var I=u;I>=0;){var M=t[I];if(M===oA)return ho;if([B_,E_].indexOf(M)!==-1)I--;else break}if([zy,Ny].indexOf(b)!==-1)for(var I=[Iw,Iy].indexOf(v)!==-1?d:u;I>=0;){var M=t[I];if(M===oA)return ho;if([B_,E_].indexOf(M)!==-1)I--;else break}if(U5===v&&[U5,a2,D5,R5].indexOf(b)!==-1||[a2,D5].indexOf(v)!==-1&&[a2,o2].indexOf(b)!==-1||[o2,R5].indexOf(v)!==-1&&b===o2||MN.indexOf(v)!==-1&&[PN,Ny].indexOf(b)!==-1||MN.indexOf(b)!==-1&&v===zy||Zp.indexOf(v)!==-1&&Zp.indexOf(b)!==-1||v===E_&&Zp.indexOf(b)!==-1||Zp.concat(oA).indexOf(v)!==-1&&b===Fy&&Bxe.indexOf(e[a])===-1||Zp.concat(oA).indexOf(b)!==-1&&v===Iy)return ho;if(v===rT&&b===rT){for(var L=r[u],U=1;L>0&&(L--,t[L]===rT);)U++;if(U%2!==0)return ho}return v===Fw&&b===Pw?ho:Lw},Fxe=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=Txe(e,t.lineBreak),n=r[0],l=r[1],u=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(l=l.map(function(a){return[oA,c0,ZV].indexOf(a)!==-1?E1:a}));var d=t.wordBreak==="keep-all"?u.map(function(a,v){return a&&e[v]>=19968&&e[v]<=40959}):void 0;return[n,l,d]},Pxe=function(){function e(t,r,n,l){this.codePoints=t,this.required=r===YV,this.start=n,this.end=l}return e.prototype.slice=function(){return dc.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),Lxe=function(e,t){var r=AE(e),n=Fxe(r,t),l=n[0],u=n[1],d=n[2],a=r.length,v=0,x=0;return{next:function(){if(x>=a)return{done:!0,value:null};for(var b=ho;x<a&&(b=Ixe(r,u,l,++x,d))===ho;);if(b!==ho||x===a){var I=new Pxe(r,b,v,x);return v=x,{value:I,done:!1}}return{done:!0,value:null}}}},Mxe=1,Oxe=2,Z1=4,DN=8,fb=10,RN=47,Jy=92,Dxe=9,Rxe=32,Mw=34,Py=61,kxe=35,Uxe=36,Nxe=37,Ow=39,Dw=40,Ly=41,zxe=95,Ff=45,Qxe=33,jxe=60,Hxe=62,Vxe=64,Gxe=91,Kxe=93,Wxe=61,qxe=123,Rw=63,$xe=125,kN=124,Xxe=126,Zxe=128,UN=65533,iT=42,d0=43,Yxe=44,Jxe=58,ewe=59,B1=46,twe=0,rwe=8,nwe=11,iwe=14,awe=31,owe=127,xp=-1,e9=48,t9=97,r9=101,swe=102,lwe=117,cwe=122,n9=65,i9=69,a9=70,uwe=85,hwe=90,Dh=function(e){return e>=e9&&e<=57},fwe=function(e){return e>=55296&&e<=57343},C_=function(e){return Dh(e)||e>=n9&&e<=a9||e>=t9&&e<=swe},Awe=function(e){return e>=t9&&e<=cwe},dwe=function(e){return e>=n9&&e<=hwe},pwe=function(e){return Awe(e)||dwe(e)},mwe=function(e){return e>=Zxe},kw=function(e){return e===fb||e===Dxe||e===Rxe},Ab=function(e){return pwe(e)||mwe(e)||e===zxe},NN=function(e){return Ab(e)||Dh(e)||e===Ff},gwe=function(e){return e>=twe&&e<=rwe||e===nwe||e>=iwe&&e<=awe||e===owe},dg=function(e,t){return e!==Jy?!1:t!==fb},Uw=function(e,t,r){return e===Ff?Ab(t)||dg(t,r):Ab(e)?!0:!!(e===Jy&&dg(e,t))},aT=function(e,t,r){return e===d0||e===Ff?Dh(t)?!0:t===B1&&Dh(r):Dh(e===B1?t:e)},_we=function(e){var t=0,r=1;(e[t]===d0||e[t]===Ff)&&(e[t]===Ff&&(r=-1),t++);for(var n=[];Dh(e[t]);)n.push(e[t++]);var l=n.length?parseInt(dc.apply(void 0,n),10):0;e[t]===B1&&t++;for(var u=[];Dh(e[t]);)u.push(e[t++]);var d=u.length,a=d?parseInt(dc.apply(void 0,u),10):0;(e[t]===i9||e[t]===r9)&&t++;var v=1;(e[t]===d0||e[t]===Ff)&&(e[t]===Ff&&(v=-1),t++);for(var x=[];Dh(e[t]);)x.push(e[t++]);var b=x.length?parseInt(dc.apply(void 0,x),10):0;return r*(l+a*Math.pow(10,-d))*Math.pow(10,v*b)},vwe={type:2},ywe={type:3},xwe={type:4},wwe={type:13},bwe={type:8},Ewe={type:21},Bwe={type:9},Cwe={type:10},Swe={type:11},Twe={type:12},Iwe={type:14},Nw={type:23},Fwe={type:1},Pwe={type:25},Lwe={type:24},Mwe={type:26},Owe={type:27},Dwe={type:28},Rwe={type:29},kwe={type:31},Q5={type:32},o9=function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(AE(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==Q5;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case Mw:return this.consumeStringToken(Mw);case kxe:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),l=this.peekCodePoint(2);if(NN(r)||dg(n,l)){var u=Uw(r,n,l)?Oxe:Mxe,d=this.consumeName();return{type:5,value:d,flags:u}}break;case Uxe:if(this.peekCodePoint(0)===Py)return this.consumeCodePoint(),wwe;break;case Ow:return this.consumeStringToken(Ow);case Dw:return vwe;case Ly:return ywe;case iT:if(this.peekCodePoint(0)===Py)return this.consumeCodePoint(),Iwe;break;case d0:if(aT(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case Yxe:return xwe;case Ff:var a=t,v=this.peekCodePoint(0),x=this.peekCodePoint(1);if(aT(a,v,x))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Uw(a,v,x))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(v===Ff&&x===Hxe)return this.consumeCodePoint(),this.consumeCodePoint(),Lwe;break;case B1:if(aT(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case RN:if(this.peekCodePoint(0)===iT)for(this.consumeCodePoint();;){var b=this.consumeCodePoint();if(b===iT&&(b=this.consumeCodePoint(),b===RN))return this.consumeToken();if(b===xp)return this.consumeToken()}break;case Jxe:return Mwe;case ewe:return Owe;case jxe:if(this.peekCodePoint(0)===Qxe&&this.peekCodePoint(1)===Ff&&this.peekCodePoint(2)===Ff)return this.consumeCodePoint(),this.consumeCodePoint(),Pwe;break;case Vxe:var I=this.peekCodePoint(0),M=this.peekCodePoint(1),L=this.peekCodePoint(2);if(Uw(I,M,L)){var d=this.consumeName();return{type:7,value:d}}break;case Gxe:return Dwe;case Jy:if(dg(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case Kxe:return Rwe;case Wxe:if(this.peekCodePoint(0)===Py)return this.consumeCodePoint(),bwe;break;case qxe:return Swe;case $xe:return Twe;case lwe:case uwe:var U=this.peekCodePoint(0),R=this.peekCodePoint(1);return U===d0&&(C_(R)||R===Rw)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case kN:if(this.peekCodePoint(0)===Py)return this.consumeCodePoint(),Bwe;if(this.peekCodePoint(0)===kN)return this.consumeCodePoint(),Ewe;break;case Xxe:if(this.peekCodePoint(0)===Py)return this.consumeCodePoint(),Cwe;break;case xp:return Q5}return kw(t)?(this.consumeWhiteSpace(),kwe):Dh(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Ab(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:dc(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();C_(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var n=!1;r===Rw&&t.length<6;)t.push(r),r=this.consumeCodePoint(),n=!0;if(n){var l=parseInt(dc.apply(void 0,t.map(function(v){return v===Rw?e9:v})),16),u=parseInt(dc.apply(void 0,t.map(function(v){return v===Rw?a9:v})),16);return{type:30,start:l,end:u}}var d=parseInt(dc.apply(void 0,t),16);if(this.peekCodePoint(0)===Ff&&C_(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var a=[];C_(r)&&a.length<6;)a.push(r),r=this.consumeCodePoint();var u=parseInt(dc.apply(void 0,a),16);return{type:30,start:d,end:u}}else return{type:30,start:d,end:d}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===Dw?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Dw?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===xp)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Ow||r===Mw){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===xp||this.peekCodePoint(0)===Ly)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),Nw)}for(;;){var l=this.consumeCodePoint();if(l===xp||l===Ly)return{type:22,value:dc.apply(void 0,t)};if(kw(l))return this.consumeWhiteSpace(),this.peekCodePoint(0)===xp||this.peekCodePoint(0)===Ly?(this.consumeCodePoint(),{type:22,value:dc.apply(void 0,t)}):(this.consumeBadUrlRemnants(),Nw);if(l===Mw||l===Ow||l===Dw||gwe(l))return this.consumeBadUrlRemnants(),Nw;if(l===Jy)if(dg(l,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Nw;else t.push(l)}},e.prototype.consumeWhiteSpace=function(){for(;kw(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Ly||t===xp)return;dg(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,n="";t>0;){var l=Math.min(r,t);n+=dc.apply(void 0,this._value.splice(0,l)),t-=l}return this._value.shift(),n},e.prototype.consumeStringToken=function(t){var r="",n=0;do{var l=this._value[n];if(l===xp||l===void 0||l===t)return r+=this.consumeStringSlice(n),{type:0,value:r};if(l===fb)return this._value.splice(0,n),Fwe;if(l===Jy){var u=this._value[n+1];u!==xp&&u!==void 0&&(u===fb?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):dg(l,u)&&(r+=this.consumeStringSlice(n),r+=dc(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=Z1,n=this.peekCodePoint(0);for((n===d0||n===Ff)&&t.push(this.consumeCodePoint());Dh(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var l=this.peekCodePoint(1);if(n===B1&&Dh(l))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=DN;Dh(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),l=this.peekCodePoint(1);var u=this.peekCodePoint(2);if((n===i9||n===r9)&&((l===d0||l===Ff)&&Dh(u)||Dh(l)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=DN;Dh(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[_we(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],n=t[1],l=this.peekCodePoint(0),u=this.peekCodePoint(1),d=this.peekCodePoint(2);if(Uw(l,u,d)){var a=this.consumeName();return{type:15,number:r,flags:n,unit:a}}return l===Nxe?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(C_(t)){for(var r=dc(t);C_(this.peekCodePoint(0))&&r.length<6;)r+=dc(this.consumeCodePoint());kw(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||fwe(n)||n>1114111?UN:n}return t===xp?UN:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(NN(r))t+=dc(r);else if(dg(r,this.peekCodePoint(0)))t+=dc(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e}(),s9=function(){function e(t){this._tokens=t}return e.create=function(t){var r=new o9;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||Nwe(n,t))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Q5:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e}(),Y1=function(e){return e.type===15},Lv=function(e){return e.type===17},Cs=function(e){return e.type===20},Uwe=function(e){return e.type===0},j5=function(e,t){return Cs(e)&&e.value===t},l9=function(e){return e.type!==31},uv=function(e){return e.type!==31&&e.type!==4},Op=function(e){var t=[],r=[];return e.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&t.push(r),t},Nwe=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},Fg=function(e){return e.type===17||e.type===15},jc=function(e){return e.type===16||Fg(e)},c9=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},ch={type:17,number:0,flags:Z1},BF={type:16,number:50,flags:Z1},yg={type:16,number:100,flags:Z1},Qy=function(e,t,r){var n=e[0],l=e[1];return[Xs(n,t),Xs(typeof l<"u"?l:n,r)]},Xs=function(e,t){if(e.type===16)return e.number/100*t;if(Y1(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},u9="deg",h9="grad",f9="rad",A9="turn",dE={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case u9:return Math.PI*t.number/180;case h9:return Math.PI/200*t.number;case f9:return t.number;case A9:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},d9=function(e){return e.type===15&&(e.unit===u9||e.unit===h9||e.unit===f9||e.unit===A9)},p9=function(e){var t=e.filter(Cs).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[ch,ch];case"to top":case"bottom":return ed(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[ch,yg];case"to right":case"left":return ed(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[yg,yg];case"to bottom":case"top":return ed(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[yg,ch];case"to left":case"right":return ed(270)}return 0},ed=function(e){return Math.PI*e/180},bg={name:"color",parse:function(e,t){if(t.type===18){var r=zwe[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),l=t.value.substring(1,2),u=t.value.substring(2,3);return xg(parseInt(n+n,16),parseInt(l+l,16),parseInt(u+u,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),l=t.value.substring(1,2),u=t.value.substring(2,3),d=t.value.substring(3,4);return xg(parseInt(n+n,16),parseInt(l+l,16),parseInt(u+u,16),parseInt(d+d,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),l=t.value.substring(2,4),u=t.value.substring(4,6);return xg(parseInt(n,16),parseInt(l,16),parseInt(u,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),l=t.value.substring(2,4),u=t.value.substring(4,6),d=t.value.substring(6,8);return xg(parseInt(n,16),parseInt(l,16),parseInt(u,16),parseInt(d,16)/255)}}if(t.type===20){var a=hm[t.value.toUpperCase()];if(typeof a<"u")return a}return hm.TRANSPARENT}},Eg=function(e){return(255&e)===0},Ru=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,l=255&e>>24;return t<255?"rgba("+l+","+n+","+r+","+t/255+")":"rgb("+l+","+n+","+r+")"},xg=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(n*255)<<0)>>>0},zN=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},QN=function(e,t){var r=t.filter(uv);if(r.length===3){var n=r.map(zN),l=n[0],u=n[1],d=n[2];return xg(l,u,d,1)}if(r.length===4){var a=r.map(zN),l=a[0],u=a[1],d=a[2],v=a[3];return xg(l,u,d,v)}return 0};function oT(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var jN=function(e,t){var r=t.filter(uv),n=r[0],l=r[1],u=r[2],d=r[3],a=(n.type===17?ed(n.number):dE.parse(e,n))/(Math.PI*2),v=jc(l)?l.number/100:0,x=jc(u)?u.number/100:0,b=typeof d<"u"&&jc(d)?Xs(d,1):1;if(v===0)return xg(x*255,x*255,x*255,1);var I=x<=.5?x*(v+1):x+v-x*v,M=x*2-I,L=oT(M,I,a+1/3),U=oT(M,I,a),R=oT(M,I,a-1/3);return xg(L*255,U*255,R*255,b)},zwe={hsl:jN,hsla:jN,rgb:QN,rgba:QN},e1=function(e,t){return bg.parse(e,s9.create(t).parseComponentValue())},hm={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Qwe={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Cs(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},jwe={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},pE=function(e,t){var r=bg.parse(e,t[0]),n=t[1];return n&&jc(n)?{color:r,stop:n}:{color:r,stop:null}},HN=function(e,t){var r=e[0],n=e[e.length-1];r.stop===null&&(r.stop=ch),n.stop===null&&(n.stop=yg);for(var l=[],u=0,d=0;d<e.length;d++){var a=e[d].stop;if(a!==null){var v=Xs(a,t);v>u?l.push(v):l.push(u),u=v}else l.push(null)}for(var x=null,d=0;d<l.length;d++){var b=l[d];if(b===null)x===null&&(x=d);else if(x!==null){for(var I=d-x,M=l[x-1],L=(b-M)/(I+1),U=1;U<=I;U++)l[x+U-1]=L*U;x=null}}return e.map(function(R,H){var q=R.color;return{color:q,stop:Math.max(Math.min(1,l[H]/t),0)}})},Hwe=function(e,t,r){var n=t/2,l=r/2,u=Xs(e[0],t)-n,d=l-Xs(e[1],r);return(Math.atan2(d,u)+Math.PI*2)%(Math.PI*2)},Vwe=function(e,t,r){var n=typeof e=="number"?e:Hwe(e,t,r),l=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),u=t/2,d=r/2,a=l/2,v=Math.sin(n-Math.PI/2)*a,x=Math.cos(n-Math.PI/2)*a;return[l,u-x,u+x,d-v,d+v]},Ld=function(e,t){return Math.sqrt(e*e+t*t)},VN=function(e,t,r,n,l){var u=[[0,0],[0,t],[e,0],[e,t]];return u.reduce(function(d,a){var v=a[0],x=a[1],b=Ld(r-v,n-x);return(l?b<d.optimumDistance:b>d.optimumDistance)?{optimumCorner:a,optimumDistance:b}:d},{optimumDistance:l?1/0:-1/0,optimumCorner:null}).optimumCorner},Gwe=function(e,t,r,n,l){var u=0,d=0;switch(e.size){case 0:e.shape===0?u=d=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-l)):e.shape===1&&(u=Math.min(Math.abs(t),Math.abs(t-n)),d=Math.min(Math.abs(r),Math.abs(r-l)));break;case 2:if(e.shape===0)u=d=Math.min(Ld(t,r),Ld(t,r-l),Ld(t-n,r),Ld(t-n,r-l));else if(e.shape===1){var a=Math.min(Math.abs(r),Math.abs(r-l))/Math.min(Math.abs(t),Math.abs(t-n)),v=VN(n,l,t,r,!0),x=v[0],b=v[1];u=Ld(x-t,(b-r)/a),d=a*u}break;case 1:e.shape===0?u=d=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-l)):e.shape===1&&(u=Math.max(Math.abs(t),Math.abs(t-n)),d=Math.max(Math.abs(r),Math.abs(r-l)));break;case 3:if(e.shape===0)u=d=Math.max(Ld(t,r),Ld(t,r-l),Ld(t-n,r),Ld(t-n,r-l));else if(e.shape===1){var a=Math.max(Math.abs(r),Math.abs(r-l))/Math.max(Math.abs(t),Math.abs(t-n)),I=VN(n,l,t,r,!1),x=I[0],b=I[1];u=Ld(x-t,(b-r)/a),d=a*u}break}return Array.isArray(e.size)&&(u=Xs(e.size[0],n),d=e.size.length===2?Xs(e.size[1],l):u),[u,d]},Kwe=function(e,t){var r=ed(180),n=[];return Op(t).forEach(function(l,u){if(u===0){var d=l[0];if(d.type===20&&d.value==="to"){r=p9(l);return}else if(d9(d)){r=dE.parse(e,d);return}}var a=pE(e,l);n.push(a)}),{angle:r,stops:n,type:1}},zw=function(e,t){var r=ed(180),n=[];return Op(t).forEach(function(l,u){if(u===0){var d=l[0];if(d.type===20&&["top","left","right","bottom"].indexOf(d.value)!==-1){r=p9(l);return}else if(d9(d)){r=(dE.parse(e,d)+ed(270))%ed(360);return}}var a=pE(e,l);n.push(a)}),{angle:r,stops:n,type:1}},Wwe=function(e,t){var r=ed(180),n=[],l=1,u=0,d=3,a=[];return Op(t).forEach(function(v,x){var b=v[0];if(x===0){if(Cs(b)&&b.value==="linear"){l=1;return}else if(Cs(b)&&b.value==="radial"){l=2;return}}if(b.type===18){if(b.name==="from"){var I=bg.parse(e,b.values[0]);n.push({stop:ch,color:I})}else if(b.name==="to"){var I=bg.parse(e,b.values[0]);n.push({stop:yg,color:I})}else if(b.name==="color-stop"){var M=b.values.filter(uv);if(M.length===2){var I=bg.parse(e,M[1]),L=M[0];Lv(L)&&n.push({stop:{type:16,number:L.number*100,flags:L.flags},color:I})}}}}),l===1?{angle:(r+ed(180))%ed(360),stops:n,type:l}:{size:d,shape:u,stops:n,position:a,type:l}},m9="closest-side",g9="farthest-side",_9="closest-corner",v9="farthest-corner",y9="circle",x9="ellipse",w9="cover",b9="contain",qwe=function(e,t){var r=0,n=3,l=[],u=[];return Op(t).forEach(function(d,a){var v=!0;if(a===0){var x=!1;v=d.reduce(function(I,M){if(x)if(Cs(M))switch(M.value){case"center":return u.push(BF),I;case"top":case"left":return u.push(ch),I;case"right":case"bottom":return u.push(yg),I}else(jc(M)||Fg(M))&&u.push(M);else if(Cs(M))switch(M.value){case y9:return r=0,!1;case x9:return r=1,!1;case"at":return x=!0,!1;case m9:return n=0,!1;case w9:case g9:return n=1,!1;case b9:case _9:return n=2,!1;case v9:return n=3,!1}else if(Fg(M)||jc(M))return Array.isArray(n)||(n=[]),n.push(M),!1;return I},v)}if(v){var b=pE(e,d);l.push(b)}}),{size:n,shape:r,stops:l,position:u,type:2}},Qw=function(e,t){var r=0,n=3,l=[],u=[];return Op(t).forEach(function(d,a){var v=!0;if(a===0?v=d.reduce(function(b,I){if(Cs(I))switch(I.value){case"center":return u.push(BF),!1;case"top":case"left":return u.push(ch),!1;case"right":case"bottom":return u.push(yg),!1}else if(jc(I)||Fg(I))return u.push(I),!1;return b},v):a===1&&(v=d.reduce(function(b,I){if(Cs(I))switch(I.value){case y9:return r=0,!1;case x9:return r=1,!1;case b9:case m9:return n=0,!1;case g9:return n=1,!1;case _9:return n=2,!1;case w9:case v9:return n=3,!1}else if(Fg(I)||jc(I))return Array.isArray(n)||(n=[]),n.push(I),!1;return b},v)),v){var x=pE(e,d);l.push(x)}}),{size:n,shape:r,stops:l,position:u,type:2}},$we=function(e){return e.type===1},Xwe=function(e){return e.type===2},CF={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var n=E9[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function Zwe(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!E9[e.name])}var E9={"linear-gradient":Kwe,"-moz-linear-gradient":zw,"-ms-linear-gradient":zw,"-o-linear-gradient":zw,"-webkit-linear-gradient":zw,"radial-gradient":qwe,"-moz-radial-gradient":Qw,"-ms-radial-gradient":Qw,"-o-radial-gradient":Qw,"-webkit-radial-gradient":Qw,"-webkit-gradient":Wwe},Ywe={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(n){return uv(n)&&Zwe(n)}).map(function(n){return CF.parse(e,n)})}},Jwe={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Cs(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},e2e={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return Op(t).map(function(r){return r.filter(jc)}).map(c9)}},t2e={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return Op(t).map(function(r){return r.filter(Cs).map(function(n){return n.value}).join(" ")}).map(r2e)}},r2e=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Z_;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(Z_||(Z_={}));var n2e={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return Op(t).map(function(r){return r.filter(i2e)})}},i2e=function(e){return Cs(e)||jc(e)},mE=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},a2e=mE("top"),o2e=mE("right"),s2e=mE("bottom"),l2e=mE("left"),gE=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return c9(r.filter(jc))}}},c2e=gE("top-left"),u2e=gE("top-right"),h2e=gE("bottom-right"),f2e=gE("bottom-left"),_E=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},A2e=_E("top"),d2e=_E("right"),p2e=_E("bottom"),m2e=_E("left"),vE=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return Y1(r)?r.number:0}}},g2e=vE("top"),_2e=vE("right"),v2e=vE("bottom"),y2e=vE("left"),x2e={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},w2e={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},b2e={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Cs).reduce(function(r,n){return r|E2e(n.value)},0)}},E2e=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},B2e={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},C2e={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},db;(function(e){e.NORMAL="normal",e.STRICT="strict"})(db||(db={}));var S2e={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return db.STRICT;case"normal":default:return db.NORMAL}}},T2e={name:"line-height",initialValue:"normal",prefix:!1,type:4},GN=function(e,t){return Cs(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:jc(e)?Xs(e,t):t},I2e={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:CF.parse(e,t)}},F2e={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},H5={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},yE=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},P2e=yE("top"),L2e=yE("right"),M2e=yE("bottom"),O2e=yE("left"),D2e={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Cs).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},R2e={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},xE=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},k2e=xE("top"),U2e=xE("right"),N2e=xE("bottom"),z2e=xE("left"),Q2e={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},j2e={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},H2e={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&j5(t[0],"none")?[]:Op(t).map(function(r){for(var n={color:hm.TRANSPARENT,offsetX:ch,offsetY:ch,blur:ch},l=0,u=0;u<r.length;u++){var d=r[u];Fg(d)?(l===0?n.offsetX=d:l===1?n.offsetY=d:n.blur=d,l++):n.color=bg.parse(e,d)}return n})}},V2e={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},G2e={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=q2e[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},K2e=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},W2e=function(e){var t=e.filter(function(v){return v.type===17}).map(function(v){return v.number}),r=t[0],n=t[1];t[2],t[3];var l=t[4],u=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var d=t[12],a=t[13];return t[14],t[15],t.length===16?[r,n,l,u,d,a]:null},q2e={matrix:K2e,matrix3d:W2e},KN={type:16,number:50,flags:Z1},$2e=[KN,KN],X2e={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(jc);return r.length!==2?$2e:[r[0],r[1]]}},Z2e={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},t1;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(t1||(t1={}));var Y2e={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return t1.BREAK_ALL;case"keep-all":return t1.KEEP_ALL;case"normal":default:return t1.NORMAL}}},J2e={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(Lv(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},B9={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},ebe={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return Lv(t)?t.number:1}},tbe={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},rbe={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Cs).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},nbe={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach(function(l){switch(l.type){case 20:case 0:r.push(l.value);break;case 17:r.push(l.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(l){return l.indexOf(" ")===-1?l:"'"+l+"'"})}},ibe={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},abe={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(Lv(t))return t.number;if(Cs(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},obe={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Cs).map(function(r){return r.value})}},sbe={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},fu=function(e,t){return(e&t)!==0},lbe={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},cbe={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var n=[],l=t.filter(l9),u=0;u<l.length;u++){var d=l[u],a=l[u+1];if(d.type===20){var v=a&&Lv(a)?a.number:1;n.push({counter:d.value,increment:v})}}return n}},ube={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],n=t.filter(l9),l=0;l<n.length;l++){var u=n[l],d=n[l+1];if(Cs(u)&&u.value!=="none"){var a=d&&Lv(d)?d.number:0;r.push({counter:u.value,reset:a})}}return r}},hbe={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(Y1).map(function(r){return B9.parse(e,r)})}},fbe={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var n=[],l=t.filter(Uwe);if(l.length%2!==0)return null;for(var u=0;u<l.length;u+=2){var d=l[u].value,a=l[u+1].value;n.push({open:d,close:a})}return n}},WN=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},Abe={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&j5(t[0],"none")?[]:Op(t).map(function(r){for(var n={color:255,offsetX:ch,offsetY:ch,blur:ch,spread:ch,inset:!1},l=0,u=0;u<r.length;u++){var d=r[u];j5(d,"inset")?n.inset=!0:Fg(d)?(l===0?n.offsetX=d:l===1?n.offsetY=d:l===2?n.blur=d:n.spread=d,l++):n.color=bg.parse(e,d)}return n})}},dbe={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(Cs).forEach(function(l){switch(l.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(l){n.indexOf(l)===-1&&n.push(l)}),n}},pbe={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},mbe={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return Y1(t)?t.number:0}},gbe=function(){function e(t,r){var n,l;this.animationDuration=ci(t,hbe,r.animationDuration),this.backgroundClip=ci(t,Qwe,r.backgroundClip),this.backgroundColor=ci(t,jwe,r.backgroundColor),this.backgroundImage=ci(t,Ywe,r.backgroundImage),this.backgroundOrigin=ci(t,Jwe,r.backgroundOrigin),this.backgroundPosition=ci(t,e2e,r.backgroundPosition),this.backgroundRepeat=ci(t,t2e,r.backgroundRepeat),this.backgroundSize=ci(t,n2e,r.backgroundSize),this.borderTopColor=ci(t,a2e,r.borderTopColor),this.borderRightColor=ci(t,o2e,r.borderRightColor),this.borderBottomColor=ci(t,s2e,r.borderBottomColor),this.borderLeftColor=ci(t,l2e,r.borderLeftColor),this.borderTopLeftRadius=ci(t,c2e,r.borderTopLeftRadius),this.borderTopRightRadius=ci(t,u2e,r.borderTopRightRadius),this.borderBottomRightRadius=ci(t,h2e,r.borderBottomRightRadius),this.borderBottomLeftRadius=ci(t,f2e,r.borderBottomLeftRadius),this.borderTopStyle=ci(t,A2e,r.borderTopStyle),this.borderRightStyle=ci(t,d2e,r.borderRightStyle),this.borderBottomStyle=ci(t,p2e,r.borderBottomStyle),this.borderLeftStyle=ci(t,m2e,r.borderLeftStyle),this.borderTopWidth=ci(t,g2e,r.borderTopWidth),this.borderRightWidth=ci(t,_2e,r.borderRightWidth),this.borderBottomWidth=ci(t,v2e,r.borderBottomWidth),this.borderLeftWidth=ci(t,y2e,r.borderLeftWidth),this.boxShadow=ci(t,Abe,r.boxShadow),this.color=ci(t,x2e,r.color),this.direction=ci(t,w2e,r.direction),this.display=ci(t,b2e,r.display),this.float=ci(t,B2e,r.cssFloat),this.fontFamily=ci(t,nbe,r.fontFamily),this.fontSize=ci(t,ibe,r.fontSize),this.fontStyle=ci(t,sbe,r.fontStyle),this.fontVariant=ci(t,obe,r.fontVariant),this.fontWeight=ci(t,abe,r.fontWeight),this.letterSpacing=ci(t,C2e,r.letterSpacing),this.lineBreak=ci(t,S2e,r.lineBreak),this.lineHeight=ci(t,T2e,r.lineHeight),this.listStyleImage=ci(t,I2e,r.listStyleImage),this.listStylePosition=ci(t,F2e,r.listStylePosition),this.listStyleType=ci(t,H5,r.listStyleType),this.marginTop=ci(t,P2e,r.marginTop),this.marginRight=ci(t,L2e,r.marginRight),this.marginBottom=ci(t,M2e,r.marginBottom),this.marginLeft=ci(t,O2e,r.marginLeft),this.opacity=ci(t,ebe,r.opacity);var u=ci(t,D2e,r.overflow);this.overflowX=u[0],this.overflowY=u[u.length>1?1:0],this.overflowWrap=ci(t,R2e,r.overflowWrap),this.paddingTop=ci(t,k2e,r.paddingTop),this.paddingRight=ci(t,U2e,r.paddingRight),this.paddingBottom=ci(t,N2e,r.paddingBottom),this.paddingLeft=ci(t,z2e,r.paddingLeft),this.paintOrder=ci(t,dbe,r.paintOrder),this.position=ci(t,j2e,r.position),this.textAlign=ci(t,Q2e,r.textAlign),this.textDecorationColor=ci(t,tbe,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=ci(t,rbe,(l=r.textDecorationLine)!==null&&l!==void 0?l:r.textDecoration),this.textShadow=ci(t,H2e,r.textShadow),this.textTransform=ci(t,V2e,r.textTransform),this.transform=ci(t,G2e,r.transform),this.transformOrigin=ci(t,X2e,r.transformOrigin),this.visibility=ci(t,Z2e,r.visibility),this.webkitTextStrokeColor=ci(t,pbe,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=ci(t,mbe,r.webkitTextStrokeWidth),this.wordBreak=ci(t,Y2e,r.wordBreak),this.zIndex=ci(t,J2e,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return Eg(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return fu(this.display,4)||fu(this.display,33554432)||fu(this.display,268435456)||fu(this.display,536870912)||fu(this.display,67108864)||fu(this.display,134217728)},e}(),_be=function(){function e(t,r){this.content=ci(t,lbe,r.content),this.quotes=ci(t,fbe,r.quotes)}return e}(),qN=function(){function e(t,r){this.counterIncrement=ci(t,cbe,r.counterIncrement),this.counterReset=ci(t,ube,r.counterReset)}return e}(),ci=function(e,t,r){var n=new o9,l=r!==null&&typeof r<"u"?r.toString():t.initialValue;n.write(l);var u=new s9(n.read());switch(t.type){case 2:var d=u.parseComponentValue();return t.parse(e,Cs(d)?d.value:t.initialValue);case 0:return t.parse(e,u.parseComponentValue());case 1:return t.parse(e,u.parseComponentValues());case 4:return u.parseComponentValue();case 3:switch(t.format){case"angle":return dE.parse(e,u.parseComponentValue());case"color":return bg.parse(e,u.parseComponentValue());case"image":return CF.parse(e,u.parseComponentValue());case"length":var a=u.parseComponentValue();return Fg(a)?a:ch;case"length-percentage":var v=u.parseComponentValue();return jc(v)?v:ch;case"time":return B9.parse(e,u.parseComponentValue())}break}},vbe="data-html2canvas-debug",ybe=function(e){var t=e.getAttribute(vbe);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},V5=function(e,t){var r=ybe(e);return r===1||t===r},Dp=function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,V5(r,3))debugger;this.styles=new gbe(t,window.getComputedStyle(r,null)),W5(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=fE(this.context,r),V5(r,4)&&(this.flags|=16)}return e}(),xbe="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",$N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var jw=0;jw<$N.length;jw++)jy[$N.charCodeAt(jw)]=jw;var wbe=function(e){var t=e.length*.75,r=e.length,n,l=0,u,d,a,v;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var x=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),b=Array.isArray(x)?x:new Uint8Array(x);for(n=0;n<r;n+=4)u=jy[e.charCodeAt(n)],d=jy[e.charCodeAt(n+1)],a=jy[e.charCodeAt(n+2)],v=jy[e.charCodeAt(n+3)],b[l++]=u<<2|d>>4,b[l++]=(d&15)<<4|a>>2,b[l++]=(a&3)<<6|v&63;return x},bbe=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},Ebe=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},b0=5,SF=11,sT=2,Bbe=SF-b0,C9=65536>>b0,Cbe=1<<b0,lT=Cbe-1,Sbe=1024>>b0,Tbe=C9+Sbe,Ibe=Tbe,Fbe=32,Pbe=Ibe+Fbe,Lbe=65536>>SF,Mbe=1<<Bbe,Obe=Mbe-1,XN=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},Dbe=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},Rbe=function(e,t){var r=wbe(e),n=Array.isArray(r)?Ebe(r):new Uint32Array(r),l=Array.isArray(r)?bbe(r):new Uint16Array(r),u=24,d=XN(l,u/2,n[4]/2),a=n[5]===2?XN(l,(u+n[4])/2):Dbe(n,Math.ceil((u+n[4])/4));return new kbe(n[0],n[1],n[2],n[3],d,a)},kbe=function(){function e(t,r,n,l,u,d){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=l,this.index=u,this.data=d}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>b0],r=(r<<sT)+(t&lT),this.data[r];if(t<=65535)return r=this.index[C9+(t-55296>>b0)],r=(r<<sT)+(t&lT),this.data[r];if(t<this.highStart)return r=Pbe-Lbe+(t>>SF),r=this.index[r],r+=t>>b0&Obe,r=this.index[r],r=(r<<sT)+(t&lT),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),ZN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ube=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Hw=0;Hw<ZN.length;Hw++)Ube[ZN.charCodeAt(Hw)]=Hw;var Nbe=1,cT=2,uT=3,YN=4,JN=5,zbe=7,e6=8,hT=9,fT=10,t6=11,r6=12,n6=13,i6=14,AT=15,Qbe=function(e){for(var t=[],r=0,n=e.length;r<n;){var l=e.charCodeAt(r++);if(l>=55296&&l<=56319&&r<n){var u=e.charCodeAt(r++);(u&64512)===56320?t.push(((l&1023)<<10)+(u&1023)+65536):(t.push(l),r--)}else t.push(l)}return t},jbe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],l=-1,u="";++l<r;){var d=e[l];d<=65535?n.push(d):(d-=65536,n.push((d>>10)+55296,d%1024+56320)),(l+1===r||n.length>16384)&&(u+=String.fromCharCode.apply(String,n),n.length=0)}return u},Hbe=Rbe(xbe),$A="×",dT="÷",Vbe=function(e){return Hbe.get(e)},Gbe=function(e,t,r){var n=r-2,l=t[n],u=t[r-1],d=t[r];if(u===cT&&d===uT)return $A;if(u===cT||u===uT||u===YN||d===cT||d===uT||d===YN)return dT;if(u===e6&&[e6,hT,t6,r6].indexOf(d)!==-1||(u===t6||u===hT)&&(d===hT||d===fT)||(u===r6||u===fT)&&d===fT||d===n6||d===JN||d===zbe||u===Nbe)return $A;if(u===n6&&d===i6){for(;l===JN;)l=t[--n];if(l===i6)return $A}if(u===AT&&d===AT){for(var a=0;l===AT;)a++,l=t[--n];if(a%2===0)return $A}return dT},Kbe=function(e){var t=Qbe(e),r=t.length,n=0,l=0,u=t.map(Vbe);return{next:function(){if(n>=r)return{done:!0,value:null};for(var d=$A;n<r&&(d=Gbe(t,u,++n))===$A;);if(d!==$A||n===r){var a=jbe.apply(null,t.slice(l,n));return l=n,{value:a,done:!1}}return{done:!0,value:null}}}},Wbe=function(e){for(var t=Kbe(e),r=[],n;!(n=t.next()).done;)n.value&&r.push(n.value.slice());return r},qbe=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var l=r.getBoundingClientRect(),u=Math.round(l.height);if(e.body.removeChild(n),u===t)return!0}}return!1},$be=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,l=AE(n.data).map(function(v){return dc(v)}),u=0,d={},a=l.every(function(v,x){r.setStart(n,u),r.setEnd(n,u+v.length);var b=r.getBoundingClientRect();u+=v.length;var I=b.x>d.x||b.y>d.y;return d=b,x===0?!0:I});return e.body.removeChild(t),a},Xbe=function(){return typeof new Image().crossOrigin<"u"},Zbe=function(){return typeof new XMLHttpRequest().responseType=="string"},Ybe=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},a6=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},Jbe=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var l=new Image,u=t.toDataURL();l.src=u;var d=G5(r,r,0,0,l);return n.fillStyle="red",n.fillRect(0,0,r,r),o6(d).then(function(a){n.drawImage(a,0,0);var v=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var x=e.createElement("div");return x.style.backgroundImage="url("+u+")",x.style.height=r+"px",a6(v)?o6(G5(r,r,0,0,x)):Promise.reject(!1)}).then(function(a){return n.drawImage(a,0,0),a6(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},G5=function(e,t,r,n,l){var u="http://www.w3.org/2000/svg",d=document.createElementNS(u,"svg"),a=document.createElementNS(u,"foreignObject");return d.setAttributeNS(null,"width",e.toString()),d.setAttributeNS(null,"height",t.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",r.toString()),a.setAttributeNS(null,"y",n.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),d.appendChild(a),a.appendChild(l),d},o6=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},ih={get SUPPORT_RANGE_BOUNDS(){var e=qbe(document);return Object.defineProperty(ih,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=ih.SUPPORT_RANGE_BOUNDS&&$be(document);return Object.defineProperty(ih,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=Ybe(document);return Object.defineProperty(ih,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?Jbe(document):Promise.resolve(!1);return Object.defineProperty(ih,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=Xbe();return Object.defineProperty(ih,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=Zbe();return Object.defineProperty(ih,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(ih,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(ih,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},r1=function(){function e(t,r){this.text=t,this.bounds=r}return e}(),eEe=function(e,t,r,n){var l=nEe(t,r),u=[],d=0;return l.forEach(function(a){if(r.textDecorationLine.length||a.trim().length>0)if(ih.SUPPORT_RANGE_BOUNDS){var v=s6(n,d,a.length).getClientRects();if(v.length>1){var x=TF(a),b=0;x.forEach(function(M){u.push(new r1(M,ym.fromDOMRectList(e,s6(n,b+d,M.length).getClientRects()))),b+=M.length})}else u.push(new r1(a,ym.fromDOMRectList(e,v)))}else{var I=n.splitText(a.length);u.push(new r1(a,tEe(e,n))),n=I}else ih.SUPPORT_RANGE_BOUNDS||(n=n.splitText(a.length));d+=a.length}),u},tEe=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var l=t.parentNode;if(l){l.replaceChild(n,t);var u=fE(e,n);return n.firstChild&&l.replaceChild(n.firstChild,n),u}}return ym.EMPTY},s6=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var l=n.createRange();return l.setStart(e,t),l.setEnd(e,t+r),l},TF=function(e){if(ih.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return Wbe(e)},rEe=function(e,t){if(ih.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(n){return n.segment})}return aEe(e,t)},nEe=function(e,t){return t.letterSpacing!==0?TF(e):rEe(e,t)},iEe=[32,160,4961,65792,65793,4153,4241],aEe=function(e,t){for(var r=Lxe(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],l,u=function(){if(l.value){var d=l.value.slice(),a=AE(d),v="";a.forEach(function(x){iEe.indexOf(x)===-1?v+=dc(x):(v.length&&n.push(v),n.push(dc(x)),v="")}),v.length&&n.push(v)}};!(l=r.next()).done;)u();return n},oEe=function(){function e(t,r,n){this.text=sEe(r.data,n.textTransform),this.textBounds=eEe(t,this.text,n,r)}return e}(),sEe=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(lEe,cEe);case 2:return e.toUpperCase();default:return e}},lEe=/(^|\s|:|-|\(|\))([a-z])/g,cEe=function(e,t,r){return e.length>0?t+r.toUpperCase():e},S9=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this;return l.src=n.currentSrc||n.src,l.intrinsicWidth=n.naturalWidth,l.intrinsicHeight=n.naturalHeight,l.context.cache.addImage(l.src),l}return t}(Dp),T9=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this;return l.canvas=n,l.intrinsicWidth=n.width,l.intrinsicHeight=n.height,l}return t}(Dp),I9=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this,u=new XMLSerializer,d=fE(r,n);return n.setAttribute("width",d.width+"px"),n.setAttribute("height",d.height+"px"),l.svg="data:image/svg+xml,"+encodeURIComponent(u.serializeToString(n)),l.intrinsicWidth=n.width.baseVal.value,l.intrinsicHeight=n.height.baseVal.value,l.context.cache.addImage(l.svg),l}return t}(Dp),F9=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this;return l.value=n.value,l}return t}(Dp),K5=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this;return l.start=n.start,l.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,l}return t}(Dp),uEe=[{type:15,flags:0,unit:"px",number:3}],hEe=[{type:16,flags:0,number:50}],fEe=function(e){return e.width>e.height?new ym(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new ym(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},AEe=function(e){var t=e.type===dEe?new Array(e.value.length+1).join("•"):e.value;return t.length===0?e.placeholder||"":t},pb="checkbox",mb="radio",dEe="password",l6=707406591,IF=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this;switch(l.type=n.type.toLowerCase(),l.checked=n.checked,l.value=AEe(n),(l.type===pb||l.type===mb)&&(l.styles.backgroundColor=3739148031,l.styles.borderTopColor=l.styles.borderRightColor=l.styles.borderBottomColor=l.styles.borderLeftColor=2779096575,l.styles.borderTopWidth=l.styles.borderRightWidth=l.styles.borderBottomWidth=l.styles.borderLeftWidth=1,l.styles.borderTopStyle=l.styles.borderRightStyle=l.styles.borderBottomStyle=l.styles.borderLeftStyle=1,l.styles.backgroundClip=[0],l.styles.backgroundOrigin=[0],l.bounds=fEe(l.bounds)),l.type){case pb:l.styles.borderTopRightRadius=l.styles.borderTopLeftRadius=l.styles.borderBottomRightRadius=l.styles.borderBottomLeftRadius=uEe;break;case mb:l.styles.borderTopRightRadius=l.styles.borderTopLeftRadius=l.styles.borderBottomRightRadius=l.styles.borderBottomLeftRadius=hEe;break}return l}return t}(Dp),P9=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this,u=n.options[n.selectedIndex||0];return l.value=u&&u.text||"",l}return t}(Dp),L9=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this;return l.value=n.value,l}return t}(Dp),M9=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this;l.src=n.src,l.width=parseInt(n.width,10)||0,l.height=parseInt(n.height,10)||0,l.backgroundColor=l.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){l.tree=D9(r,n.contentWindow.document.documentElement);var u=n.contentWindow.document.documentElement?e1(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):hm.TRANSPARENT,d=n.contentWindow.document.body?e1(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):hm.TRANSPARENT;l.backgroundColor=Eg(u)?Eg(d)?l.styles.backgroundColor:d:u}}catch{}return l}return t}(Dp),pEe=["OL","UL","MENU"],s2=function(e,t,r,n){for(var l=t.firstChild,u=void 0;l;l=u)if(u=l.nextSibling,R9(l)&&l.data.trim().length>0)r.textNodes.push(new oEe(e,l,r.styles));else if(z_(l))if(z9(l)&&l.assignedNodes)l.assignedNodes().forEach(function(a){return s2(e,a,r,n)});else{var d=O9(e,l);d.styles.isVisible()&&(mEe(l,d,n)?d.flags|=4:gEe(d.styles)&&(d.flags|=2),pEe.indexOf(l.tagName)!==-1&&(d.flags|=8),r.elements.push(d),l.slot,l.shadowRoot?s2(e,l.shadowRoot,d,n):!gb(l)&&!k9(l)&&!_b(l)&&s2(e,l,d,n))}},O9=function(e,t){return q5(t)?new S9(e,t):U9(t)?new T9(e,t):k9(t)?new I9(e,t):_Ee(t)?new F9(e,t):vEe(t)?new K5(e,t):yEe(t)?new IF(e,t):_b(t)?new P9(e,t):gb(t)?new L9(e,t):N9(t)?new M9(e,t):new Dp(e,t)},D9=function(e,t){var r=O9(e,t);return r.flags|=4,s2(e,t,r,r),r},mEe=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||FF(e)&&r.styles.isTransparent()},gEe=function(e){return e.isPositioned()||e.isFloating()},R9=function(e){return e.nodeType===Node.TEXT_NODE},z_=function(e){return e.nodeType===Node.ELEMENT_NODE},W5=function(e){return z_(e)&&typeof e.style<"u"&&!l2(e)},l2=function(e){return typeof e.className=="object"},_Ee=function(e){return e.tagName==="LI"},vEe=function(e){return e.tagName==="OL"},yEe=function(e){return e.tagName==="INPUT"},xEe=function(e){return e.tagName==="HTML"},k9=function(e){return e.tagName==="svg"},FF=function(e){return e.tagName==="BODY"},U9=function(e){return e.tagName==="CANVAS"},c6=function(e){return e.tagName==="VIDEO"},q5=function(e){return e.tagName==="IMG"},N9=function(e){return e.tagName==="IFRAME"},u6=function(e){return e.tagName==="STYLE"},wEe=function(e){return e.tagName==="SCRIPT"},gb=function(e){return e.tagName==="TEXTAREA"},_b=function(e){return e.tagName==="SELECT"},z9=function(e){return e.tagName==="SLOT"},h6=function(e){return e.tagName.indexOf("-")>0},bEe=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(n){return r.counters[n].pop()})},e.prototype.parse=function(t){var r=this,n=t.counterIncrement,l=t.counterReset,u=!0;n!==null&&n.forEach(function(a){var v=r.counters[a.counter];v&&a.increment!==0&&(u=!1,v.length||v.push(1),v[Math.max(0,v.length-1)]+=a.increment)});var d=[];return u&&l.forEach(function(a){var v=r.counters[a.counter];d.push(a.counter),v||(v=r.counters[a.counter]=[]),v.push(a.reset)}),d},e}(),f6={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},A6={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},EEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},BEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},S_=function(e,t,r,n,l,u){return e<t||e>r?C1(e,l,u.length>0):n.integers.reduce(function(d,a,v){for(;e>=a;)e-=a,d+=n.values[v];return d},"")+u},Q9=function(e,t,r,n){var l="";do r||e--,l=n(e)+l,e/=t;while(e*t>=t);return l},Ac=function(e,t,r,n,l){var u=r-t+1;return(e<0?"-":"")+(Q9(Math.abs(e),u,n,function(d){return dc(Math.floor(d%u)+t)})+l)},r0=function(e,t,r){r===void 0&&(r=". ");var n=t.length;return Q9(Math.abs(e),n,!1,function(l){return t[Math.floor(l%n)]})+r},M_=1,hg=2,fg=4,Hy=8,Yp=function(e,t,r,n,l,u){if(e<-9999||e>9999)return C1(e,4,l.length>0);var d=Math.abs(e),a=l;if(d===0)return t[0]+a;for(var v=0;d>0&&v<=4;v++){var x=d%10;x===0&&fu(u,M_)&&a!==""?a=t[x]+a:x>1||x===1&&v===0||x===1&&v===1&&fu(u,hg)||x===1&&v===1&&fu(u,fg)&&e>100||x===1&&v>1&&fu(u,Hy)?a=t[x]+(v>0?r[v-1]:"")+a:x===1&&v>0&&(a=r[v-1]+a),d=Math.floor(d/10)}return(e<0?n:"")+a},d6="十百千萬",p6="拾佰仟萬",m6="マイナス",pT="마이너스",C1=function(e,t,r){var n=r?". ":"",l=r?"、":"",u=r?", ":"",d=r?" ":"";switch(t){case 0:return"•"+d;case 1:return"◦"+d;case 2:return"◾"+d;case 5:var a=Ac(e,48,57,!0,n);return a.length<4?"0"+a:a;case 4:return r0(e,"〇一二三四五六七八九",l);case 6:return S_(e,1,3999,f6,3,n).toLowerCase();case 7:return S_(e,1,3999,f6,3,n);case 8:return Ac(e,945,969,!1,n);case 9:return Ac(e,97,122,!1,n);case 10:return Ac(e,65,90,!1,n);case 11:return Ac(e,1632,1641,!0,n);case 12:case 49:return S_(e,1,9999,A6,3,n);case 35:return S_(e,1,9999,A6,3,n).toLowerCase();case 13:return Ac(e,2534,2543,!0,n);case 14:case 30:return Ac(e,6112,6121,!0,n);case 15:return r0(e,"子丑寅卯辰巳午未申酉戌亥",l);case 16:return r0(e,"甲乙丙丁戊己庚辛壬癸",l);case 17:case 48:return Yp(e,"零一二三四五六七八九",d6,"負",l,hg|fg|Hy);case 47:return Yp(e,"零壹貳參肆伍陸柒捌玖",p6,"負",l,M_|hg|fg|Hy);case 42:return Yp(e,"零一二三四五六七八九",d6,"负",l,hg|fg|Hy);case 41:return Yp(e,"零壹贰叁肆伍陆柒捌玖",p6,"负",l,M_|hg|fg|Hy);case 26:return Yp(e,"〇一二三四五六七八九","十百千万",m6,l,0);case 25:return Yp(e,"零壱弐参四伍六七八九","拾百千万",m6,l,M_|hg|fg);case 31:return Yp(e,"영일이삼사오육칠팔구","십백천만",pT,u,M_|hg|fg);case 33:return Yp(e,"零一二三四五六七八九","十百千萬",pT,u,0);case 32:return Yp(e,"零壹貳參四五六七八九","拾百千",pT,u,M_|hg|fg);case 18:return Ac(e,2406,2415,!0,n);case 20:return S_(e,1,19999,BEe,3,n);case 21:return Ac(e,2790,2799,!0,n);case 22:return Ac(e,2662,2671,!0,n);case 22:return S_(e,1,10999,EEe,3,n);case 23:return r0(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return r0(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return Ac(e,3302,3311,!0,n);case 28:return r0(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",l);case 29:return r0(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",l);case 34:return Ac(e,3792,3801,!0,n);case 37:return Ac(e,6160,6169,!0,n);case 38:return Ac(e,4160,4169,!0,n);case 39:return Ac(e,2918,2927,!0,n);case 40:return Ac(e,1776,1785,!0,n);case 43:return Ac(e,3046,3055,!0,n);case 44:return Ac(e,3174,3183,!0,n);case 45:return Ac(e,3664,3673,!0,n);case 46:return Ac(e,3872,3881,!0,n);case 3:default:return Ac(e,48,57,!0,n)}},j9="data-html2canvas-ignore",g6=function(){function e(t,r,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new bEe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var n=this,l=CEe(t,r);if(!l.contentWindow)return Promise.reject("Unable to find iframe window");var u=t.defaultView.pageXOffset,d=t.defaultView.pageYOffset,a=l.contentWindow,v=a.document,x=IEe(l).then(function(){return af(n,void 0,void 0,function(){var b,I;return Mh(this,function(M){switch(M.label){case 0:return this.scrolledElements.forEach(MEe),a&&(a.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(a.scrollY!==r.top||a.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(a.scrollX-r.left,a.scrollY-r.top,0,0))),b=this.options.onclone,I=this.clonedReferenceElement,typeof I>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:v.fonts&&v.fonts.ready?[4,v.fonts.ready]:[3,2];case 1:M.sent(),M.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,TEe(v)]:[3,4];case 3:M.sent(),M.label=4;case 4:return typeof b=="function"?[2,Promise.resolve().then(function(){return b(v,I)}).then(function(){return l})]:[2,l]}})})});return v.open(),v.write(PEe(document.doctype)+"<html></html>"),LEe(this.referenceElement.ownerDocument,u,d),v.replaceChild(v.adoptNode(this.documentElement),v.documentElement),v.close(),x},e.prototype.createElementClone=function(t){if(V5(t,2))debugger;if(U9(t))return this.createCanvasClone(t);if(c6(t))return this.createVideoClone(t);if(u6(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return q5(r)&&(q5(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),h6(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return mT(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(u,d){return d&&typeof d.cssText=="string"?u+d.cssText:u},""),l=t.cloneNode(!1);return l.textContent=n,l}}catch(u){if(this.context.logger.error("Unable to access cssRules property",u),u.name!=="SecurityError")throw u}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var l=t.cloneNode(!1);try{l.width=t.width,l.height=t.height;var u=t.getContext("2d"),d=l.getContext("2d");if(d)if(!this.options.allowTaint&&u)d.putImageData(u.getImageData(0,0,t.width,t.height),0,0);else{var a=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(a){var v=a.getContextAttributes();v?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}d.drawImage(t,0,0)}return l}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return l},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var l=t.ownerDocument.createElement("canvas");return l.width=t.offsetWidth,l.height=t.offsetHeight,l},e.prototype.appendChildNode=function(t,r,n){(!z_(r)||!wEe(r)&&!r.hasAttribute(j9)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!z_(r)||!u6(r))&&t.appendChild(this.cloneNode(r,n))},e.prototype.cloneChildNodes=function(t,r,n){for(var l=this,u=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;u;u=u.nextSibling)if(z_(u)&&z9(u)&&typeof u.assignedNodes=="function"){var d=u.assignedNodes();d.length&&d.forEach(function(a){return l.appendChildNode(r,a,n)})}else this.appendChildNode(r,u,n)},e.prototype.cloneNode=function(t,r){if(R9(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&z_(t)&&(W5(t)||l2(t))){var l=this.createElementClone(t);l.style.transitionProperty="none";var u=n.getComputedStyle(t),d=n.getComputedStyle(t,":before"),a=n.getComputedStyle(t,":after");this.referenceElement===t&&W5(l)&&(this.clonedReferenceElement=l),FF(l)&&REe(l);var v=this.counters.parse(new qN(this.context,u)),x=this.resolvePseudoContent(t,l,d,n1.BEFORE);h6(t)&&(r=!0),c6(t)||this.cloneChildNodes(t,l,r),x&&l.insertBefore(x,l.firstChild);var b=this.resolvePseudoContent(t,l,a,n1.AFTER);return b&&l.appendChild(b),this.counters.pop(v),(u&&(this.options.copyStyles||l2(t))&&!N9(t)||r)&&mT(u,l),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([l,t.scrollLeft,t.scrollTop]),(gb(t)||_b(t))&&(gb(l)||_b(l))&&(l.value=t.value),l}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,n,l){var u=this;if(n){var d=n.content,a=r.ownerDocument;if(!(!a||!d||d==="none"||d==="-moz-alt-content"||n.display==="none")){this.counters.parse(new qN(this.context,n));var v=new _be(this.context,n),x=a.createElement("html2canvaspseudoelement");mT(n,x),v.content.forEach(function(I){if(I.type===0)x.appendChild(a.createTextNode(I.value));else if(I.type===22){var M=a.createElement("img");M.src=I.value,M.style.opacity="1",x.appendChild(M)}else if(I.type===18){if(I.name==="attr"){var L=I.values.filter(Cs);L.length&&x.appendChild(a.createTextNode(t.getAttribute(L[0].value)||""))}else if(I.name==="counter"){var U=I.values.filter(uv),R=U[0],H=U[1];if(R&&Cs(R)){var q=u.counters.getCounterValue(R.value),te=H&&Cs(H)?H5.parse(u.context,H.value):3;x.appendChild(a.createTextNode(C1(q,te,!1)))}}else if(I.name==="counters"){var J=I.values.filter(uv),R=J[0],se=J[1],H=J[2];if(R&&Cs(R)){var ye=u.counters.getCounterValues(R.value),Se=H&&Cs(H)?H5.parse(u.context,H.value):3,Be=se&&se.type===0?se.value:"",De=ye.map(function(_e){return C1(_e,Se,!1)}).join(Be);x.appendChild(a.createTextNode(De))}}}else if(I.type===20)switch(I.value){case"open-quote":x.appendChild(a.createTextNode(WN(v.quotes,u.quoteDepth++,!0)));break;case"close-quote":x.appendChild(a.createTextNode(WN(v.quotes,--u.quoteDepth,!1)));break;default:x.appendChild(a.createTextNode(I.value))}}),x.className=$5+" "+X5;var b=l===n1.BEFORE?" "+$5:" "+X5;return l2(r)?r.className.baseValue+=b:r.className+=b,x}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e}(),n1;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(n1||(n1={}));var CEe=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(j9,"true"),e.body.appendChild(r),r},SEe=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},TEe=function(e){return Promise.all([].slice.call(e.images,0).map(SEe))},IEe=function(e){return new Promise(function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var l=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var u=setInterval(function(){l.body.childNodes.length>0&&l.readyState==="complete"&&(clearInterval(u),t(e))},50)}})},FEe=["all","d","content"],mT=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);FEe.indexOf(n)===-1&&t.style.setProperty(n,e.getPropertyValue(n))}return t},PEe=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},LEe=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},MEe=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},OEe=":before",DEe=":after",$5="___html2canvas___pseudoelement_before",X5="___html2canvas___pseudoelement_after",_6=`{
    content: "" !important;
    display: none !important;
}`,REe=function(e){kEe(e,"."+$5+OEe+_6+`
         .`+X5+DEe+_6)},kEe=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},H9=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),UEe=function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(_T(t)||jEe(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return af(this,void 0,void 0,function(){var r,n,l,u,d=this;return Mh(this,function(a){switch(a.label){case 0:return r=H9.isSameOrigin(t),n=!gT(t)&&this._options.useCORS===!0&&ih.SUPPORT_CORS_IMAGES&&!r,l=!gT(t)&&!r&&!_T(t)&&typeof this._options.proxy=="string"&&ih.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!gT(t)&&!_T(t)&&!l&&!n?[2]:(u=t,l?[4,this.proxy(u)]:[3,2]);case 1:u=a.sent(),a.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(v,x){var b=new Image;b.onload=function(){return v(b)},b.onerror=x,(HEe(u)||n)&&(b.crossOrigin="anonymous"),b.src=u,b.complete===!0&&setTimeout(function(){return v(b)},500),d._options.imageTimeout>0&&setTimeout(function(){return x("Timed out ("+d._options.imageTimeout+"ms) loading image")},d._options.imageTimeout)})];case 3:return[2,a.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var l=t.substring(0,256);return new Promise(function(u,d){var a=ih.SUPPORT_RESPONSE_TYPE?"blob":"text",v=new XMLHttpRequest;v.onload=function(){if(v.status===200)if(a==="text")u(v.response);else{var I=new FileReader;I.addEventListener("load",function(){return u(I.result)},!1),I.addEventListener("error",function(M){return d(M)},!1),I.readAsDataURL(v.response)}else d("Failed to proxy resource "+l+" with status code "+v.status)},v.onerror=d;var x=n.indexOf("?")>-1?"&":"?";if(v.open("GET",""+n+x+"url="+encodeURIComponent(t)+"&responseType="+a),a!=="text"&&v instanceof XMLHttpRequest&&(v.responseType=a),r._options.imageTimeout){var b=r._options.imageTimeout;v.timeout=b,v.ontimeout=function(){return d("Timed out ("+b+"ms) proxying "+l)}}v.send()})},e}(),NEe=/^data:image\/svg\+xml/i,zEe=/^data:image\/.*;base64,/i,QEe=/^data:image\/.*/i,jEe=function(e){return ih.SUPPORT_SVG_DRAWING||!VEe(e)},gT=function(e){return QEe.test(e)},HEe=function(e){return zEe.test(e)},_T=function(e){return e.substr(0,4)==="blob"},VEe=function(e){return e.substr(-3).toLowerCase()==="svg"||NEe.test(e)},ii=function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),T_=function(e,t,r){return new ii(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},Vw=function(){function e(t,r,n,l){this.type=1,this.start=t,this.startControl=r,this.endControl=n,this.end=l}return e.prototype.subdivide=function(t,r){var n=T_(this.start,this.startControl,t),l=T_(this.startControl,this.endControl,t),u=T_(this.endControl,this.end,t),d=T_(n,l,t),a=T_(l,u,t),v=T_(d,a,t);return r?new e(this.start,n,d,v):new e(v,a,u,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),YA=function(e){return e.type===1},GEe=function(){function e(t){var r=t.styles,n=t.bounds,l=Qy(r.borderTopLeftRadius,n.width,n.height),u=l[0],d=l[1],a=Qy(r.borderTopRightRadius,n.width,n.height),v=a[0],x=a[1],b=Qy(r.borderBottomRightRadius,n.width,n.height),I=b[0],M=b[1],L=Qy(r.borderBottomLeftRadius,n.width,n.height),U=L[0],R=L[1],H=[];H.push((u+v)/n.width),H.push((U+I)/n.width),H.push((d+R)/n.height),H.push((x+M)/n.height);var q=Math.max.apply(Math,H);q>1&&(u/=q,d/=q,v/=q,x/=q,I/=q,M/=q,U/=q,R/=q);var te=n.width-v,J=n.height-M,se=n.width-I,ye=n.height-R,Se=r.borderTopWidth,Be=r.borderRightWidth,De=r.borderBottomWidth,we=r.borderLeftWidth,nt=Xs(r.paddingTop,t.bounds.width),_e=Xs(r.paddingRight,t.bounds.width),Ie=Xs(r.paddingBottom,t.bounds.width),Ze=Xs(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=u>0||d>0?xl(n.left+we/3,n.top+Se/3,u-we/3,d-Se/3,as.TOP_LEFT):new ii(n.left+we/3,n.top+Se/3),this.topRightBorderDoubleOuterBox=u>0||d>0?xl(n.left+te,n.top+Se/3,v-Be/3,x-Se/3,as.TOP_RIGHT):new ii(n.left+n.width-Be/3,n.top+Se/3),this.bottomRightBorderDoubleOuterBox=I>0||M>0?xl(n.left+se,n.top+J,I-Be/3,M-De/3,as.BOTTOM_RIGHT):new ii(n.left+n.width-Be/3,n.top+n.height-De/3),this.bottomLeftBorderDoubleOuterBox=U>0||R>0?xl(n.left+we/3,n.top+ye,U-we/3,R-De/3,as.BOTTOM_LEFT):new ii(n.left+we/3,n.top+n.height-De/3),this.topLeftBorderDoubleInnerBox=u>0||d>0?xl(n.left+we*2/3,n.top+Se*2/3,u-we*2/3,d-Se*2/3,as.TOP_LEFT):new ii(n.left+we*2/3,n.top+Se*2/3),this.topRightBorderDoubleInnerBox=u>0||d>0?xl(n.left+te,n.top+Se*2/3,v-Be*2/3,x-Se*2/3,as.TOP_RIGHT):new ii(n.left+n.width-Be*2/3,n.top+Se*2/3),this.bottomRightBorderDoubleInnerBox=I>0||M>0?xl(n.left+se,n.top+J,I-Be*2/3,M-De*2/3,as.BOTTOM_RIGHT):new ii(n.left+n.width-Be*2/3,n.top+n.height-De*2/3),this.bottomLeftBorderDoubleInnerBox=U>0||R>0?xl(n.left+we*2/3,n.top+ye,U-we*2/3,R-De*2/3,as.BOTTOM_LEFT):new ii(n.left+we*2/3,n.top+n.height-De*2/3),this.topLeftBorderStroke=u>0||d>0?xl(n.left+we/2,n.top+Se/2,u-we/2,d-Se/2,as.TOP_LEFT):new ii(n.left+we/2,n.top+Se/2),this.topRightBorderStroke=u>0||d>0?xl(n.left+te,n.top+Se/2,v-Be/2,x-Se/2,as.TOP_RIGHT):new ii(n.left+n.width-Be/2,n.top+Se/2),this.bottomRightBorderStroke=I>0||M>0?xl(n.left+se,n.top+J,I-Be/2,M-De/2,as.BOTTOM_RIGHT):new ii(n.left+n.width-Be/2,n.top+n.height-De/2),this.bottomLeftBorderStroke=U>0||R>0?xl(n.left+we/2,n.top+ye,U-we/2,R-De/2,as.BOTTOM_LEFT):new ii(n.left+we/2,n.top+n.height-De/2),this.topLeftBorderBox=u>0||d>0?xl(n.left,n.top,u,d,as.TOP_LEFT):new ii(n.left,n.top),this.topRightBorderBox=v>0||x>0?xl(n.left+te,n.top,v,x,as.TOP_RIGHT):new ii(n.left+n.width,n.top),this.bottomRightBorderBox=I>0||M>0?xl(n.left+se,n.top+J,I,M,as.BOTTOM_RIGHT):new ii(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=U>0||R>0?xl(n.left,n.top+ye,U,R,as.BOTTOM_LEFT):new ii(n.left,n.top+n.height),this.topLeftPaddingBox=u>0||d>0?xl(n.left+we,n.top+Se,Math.max(0,u-we),Math.max(0,d-Se),as.TOP_LEFT):new ii(n.left+we,n.top+Se),this.topRightPaddingBox=v>0||x>0?xl(n.left+Math.min(te,n.width-Be),n.top+Se,te>n.width+Be?0:Math.max(0,v-Be),Math.max(0,x-Se),as.TOP_RIGHT):new ii(n.left+n.width-Be,n.top+Se),this.bottomRightPaddingBox=I>0||M>0?xl(n.left+Math.min(se,n.width-we),n.top+Math.min(J,n.height-De),Math.max(0,I-Be),Math.max(0,M-De),as.BOTTOM_RIGHT):new ii(n.left+n.width-Be,n.top+n.height-De),this.bottomLeftPaddingBox=U>0||R>0?xl(n.left+we,n.top+Math.min(ye,n.height-De),Math.max(0,U-we),Math.max(0,R-De),as.BOTTOM_LEFT):new ii(n.left+we,n.top+n.height-De),this.topLeftContentBox=u>0||d>0?xl(n.left+we+Ze,n.top+Se+nt,Math.max(0,u-(we+Ze)),Math.max(0,d-(Se+nt)),as.TOP_LEFT):new ii(n.left+we+Ze,n.top+Se+nt),this.topRightContentBox=v>0||x>0?xl(n.left+Math.min(te,n.width+we+Ze),n.top+Se+nt,te>n.width+we+Ze?0:v-we+Ze,x-(Se+nt),as.TOP_RIGHT):new ii(n.left+n.width-(Be+_e),n.top+Se+nt),this.bottomRightContentBox=I>0||M>0?xl(n.left+Math.min(se,n.width-(we+Ze)),n.top+Math.min(J,n.height+Se+nt),Math.max(0,I-(Be+_e)),M-(De+Ie),as.BOTTOM_RIGHT):new ii(n.left+n.width-(Be+_e),n.top+n.height-(De+Ie)),this.bottomLeftContentBox=U>0||R>0?xl(n.left+we+Ze,n.top+ye,Math.max(0,U-(we+Ze)),R-(De+Ie),as.BOTTOM_LEFT):new ii(n.left+we+Ze,n.top+n.height-(De+Ie))}return e}(),as;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(as||(as={}));var xl=function(e,t,r,n,l){var u=4*((Math.sqrt(2)-1)/3),d=r*u,a=n*u,v=e+r,x=t+n;switch(l){case as.TOP_LEFT:return new Vw(new ii(e,x),new ii(e,x-a),new ii(v-d,t),new ii(v,t));case as.TOP_RIGHT:return new Vw(new ii(e,t),new ii(e+d,t),new ii(v,x-a),new ii(v,x));case as.BOTTOM_RIGHT:return new Vw(new ii(v,t),new ii(v,t+a),new ii(e+d,x),new ii(e,x));case as.BOTTOM_LEFT:default:return new Vw(new ii(v,x),new ii(v-d,x),new ii(e,t+a),new ii(e,t))}},vb=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},KEe=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},yb=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},WEe=function(){function e(t,r,n){this.offsetX=t,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return e}(),Gw=function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e}(),qEe=function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e}(),$Ee=function(e){return e.type===0},V9=function(e){return e.type===1},XEe=function(e){return e.type===2},v6=function(e,t){return e.length===t.length?e.some(function(r,n){return r===t[n]}):!1},ZEe=function(e,t,r,n,l){return e.map(function(u,d){switch(d){case 0:return u.add(t,r);case 1:return u.add(t+n,r);case 2:return u.add(t+n,r+l);case 3:return u.add(t,r+l)}return u})},G9=function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),K9=function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new GEe(this.container),this.container.styles.opacity<1&&this.effects.push(new qEe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,l=this.container.bounds.top+this.container.styles.transformOrigin[1].number,u=this.container.styles.transform;this.effects.push(new WEe(n,l,u))}if(this.container.styles.overflowX!==0){var d=vb(this.curves),a=yb(this.curves);v6(d,a)?this.effects.push(new Gw(d,6)):(this.effects.push(new Gw(d,2)),this.effects.push(new Gw(a,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,l=this.effects.slice(0);n;){var u=n.effects.filter(function(v){return!V9(v)});if(r||n.container.styles.position!==0||!n.parent){if(l.unshift.apply(l,u),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var d=vb(n.curves),a=yb(n.curves);v6(d,a)||l.unshift(new Gw(a,6))}}else l.unshift.apply(l,u);n=n.parent}return l.filter(function(v){return fu(v.target,t)})},e}(),Z5=function(e,t,r,n){e.container.elements.forEach(function(l){var u=fu(l.flags,4),d=fu(l.flags,2),a=new K9(l,e);fu(l.styles.display,2048)&&n.push(a);var v=fu(l.flags,8)?[]:n;if(u||d){var x=u||l.styles.isPositioned()?r:t,b=new G9(a);if(l.styles.isPositioned()||l.styles.opacity<1||l.styles.isTransformed()){var I=l.styles.zIndex.order;if(I<0){var M=0;x.negativeZIndex.some(function(U,R){return I>U.element.container.styles.zIndex.order?(M=R,!1):M>0}),x.negativeZIndex.splice(M,0,b)}else if(I>0){var L=0;x.positiveZIndex.some(function(U,R){return I>=U.element.container.styles.zIndex.order?(L=R+1,!1):L>0}),x.positiveZIndex.splice(L,0,b)}else x.zeroOrAutoZIndexOrTransformedOrOpacity.push(b)}else l.styles.isFloating()?x.nonPositionedFloats.push(b):x.nonPositionedInlineLevel.push(b);Z5(a,b,u?b:r,v)}else l.styles.isInlineLevel()?t.inlineLevel.push(a):t.nonInlineLevel.push(a),Z5(a,t,r,v);fu(l.flags,8)&&W9(l,v)})},W9=function(e,t){for(var r=e instanceof K5?e.start:1,n=e instanceof K5?e.reversed:!1,l=0;l<t.length;l++){var u=t[l];u.container instanceof F9&&typeof u.container.value=="number"&&u.container.value!==0&&(r=u.container.value),u.listValue=C1(r,u.container.styles.listStyleType,!0),r+=n?-1:1}},YEe=function(e){var t=new K9(e,null),r=new G9(t),n=[];return Z5(t,r,r,n),W9(t.container,n),r},y6=function(e,t){switch(t){case 0:return td(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return td(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return td(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return td(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},JEe=function(e,t){switch(t){case 0:return td(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return td(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return td(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return td(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},eBe=function(e,t){switch(t){case 0:return td(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return td(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return td(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return td(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},tBe=function(e,t){switch(t){case 0:return Kw(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return Kw(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return Kw(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return Kw(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},Kw=function(e,t){var r=[];return YA(e)?r.push(e.subdivide(.5,!1)):r.push(e),YA(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},td=function(e,t,r,n){var l=[];return YA(e)?l.push(e.subdivide(.5,!1)):l.push(e),YA(r)?l.push(r.subdivide(.5,!0)):l.push(r),YA(n)?l.push(n.subdivide(.5,!0).reverse()):l.push(n),YA(t)?l.push(t.subdivide(.5,!1).reverse()):l.push(t),l},q9=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},xb=function(e){var t=e.styles,r=e.bounds,n=Xs(t.paddingLeft,r.width),l=Xs(t.paddingRight,r.width),u=Xs(t.paddingTop,r.width),d=Xs(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,u+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+l),-(t.borderTopWidth+t.borderBottomWidth+u+d))},rBe=function(e,t){return e===0?t.bounds:e===2?xb(t):q9(t)},nBe=function(e,t){return e===0?t.bounds:e===2?xb(t):q9(t)},vT=function(e,t,r){var n=rBe(O_(e.styles.backgroundOrigin,t),e),l=nBe(O_(e.styles.backgroundClip,t),e),u=iBe(O_(e.styles.backgroundSize,t),r,n),d=u[0],a=u[1],v=Qy(O_(e.styles.backgroundPosition,t),n.width-d,n.height-a),x=aBe(O_(e.styles.backgroundRepeat,t),v,u,n,l),b=Math.round(n.left+v[0]),I=Math.round(n.top+v[1]);return[x,b,I,d,a]},I_=function(e){return Cs(e)&&e.value===Z_.AUTO},Ww=function(e){return typeof e=="number"},iBe=function(e,t,r){var n=t[0],l=t[1],u=t[2],d=e[0],a=e[1];if(!d)return[0,0];if(jc(d)&&a&&jc(a))return[Xs(d,r.width),Xs(a,r.height)];var v=Ww(u);if(Cs(d)&&(d.value===Z_.CONTAIN||d.value===Z_.COVER)){if(Ww(u)){var x=r.width/r.height;return x<u!=(d.value===Z_.COVER)?[r.width,r.width/u]:[r.height*u,r.height]}return[r.width,r.height]}var b=Ww(n),I=Ww(l),M=b||I;if(I_(d)&&(!a||I_(a))){if(b&&I)return[n,l];if(!v&&!M)return[r.width,r.height];if(M&&v){var L=b?n:l*u,U=I?l:n/u;return[L,U]}var R=b?n:r.width,H=I?l:r.height;return[R,H]}if(v){var q=0,te=0;return jc(d)?q=Xs(d,r.width):jc(a)&&(te=Xs(a,r.height)),I_(d)?q=te*u:(!a||I_(a))&&(te=q/u),[q,te]}var J=null,se=null;if(jc(d)?J=Xs(d,r.width):a&&jc(a)&&(se=Xs(a,r.height)),J!==null&&(!a||I_(a))&&(se=b&&I?J/n*l:r.height),se!==null&&I_(d)&&(J=b&&I?se/l*n:r.width),J!==null&&se!==null)return[J,se];throw new Error("Unable to calculate background-size for element")},O_=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},aBe=function(e,t,r,n,l){var u=t[0],d=t[1],a=r[0],v=r[1];switch(e){case 2:return[new ii(Math.round(n.left),Math.round(n.top+d)),new ii(Math.round(n.left+n.width),Math.round(n.top+d)),new ii(Math.round(n.left+n.width),Math.round(v+n.top+d)),new ii(Math.round(n.left),Math.round(v+n.top+d))];case 3:return[new ii(Math.round(n.left+u),Math.round(n.top)),new ii(Math.round(n.left+u+a),Math.round(n.top)),new ii(Math.round(n.left+u+a),Math.round(n.height+n.top)),new ii(Math.round(n.left+u),Math.round(n.height+n.top))];case 1:return[new ii(Math.round(n.left+u),Math.round(n.top+d)),new ii(Math.round(n.left+u+a),Math.round(n.top+d)),new ii(Math.round(n.left+u+a),Math.round(n.top+d+v)),new ii(Math.round(n.left+u),Math.round(n.top+d+v))];default:return[new ii(Math.round(l.left),Math.round(l.top)),new ii(Math.round(l.left+l.width),Math.round(l.top)),new ii(Math.round(l.left+l.width),Math.round(l.height+l.top)),new ii(Math.round(l.left),Math.round(l.height+l.top))]}},oBe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",x6="Hidden Text",sBe=function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var n=this._document.createElement("div"),l=this._document.createElement("img"),u=this._document.createElement("span"),d=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",d.appendChild(n),l.src=oBe,l.width=1,l.height=1,l.style.margin="0",l.style.padding="0",l.style.verticalAlign="baseline",u.style.fontFamily=t,u.style.fontSize=r,u.style.margin="0",u.style.padding="0",u.appendChild(this._document.createTextNode(x6)),n.appendChild(u),n.appendChild(l);var a=l.offsetTop-u.offsetTop+2;n.removeChild(u),n.appendChild(this._document.createTextNode(x6)),n.style.lineHeight="normal",l.style.verticalAlign="super";var v=l.offsetTop-n.offsetTop+2;return d.removeChild(n),{baseline:a,middle:v}},e.prototype.getMetrics=function(t,r){var n=t+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,r)),this._data[n]},e}(),$9=function(){function e(t,r){this.context=t,this.options=r}return e}(),lBe=1e4,cBe=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this;return l._activeEffects=[],l.canvas=n.canvas?n.canvas:document.createElement("canvas"),l.ctx=l.canvas.getContext("2d"),n.canvas||(l.canvas.width=Math.floor(n.width*n.scale),l.canvas.height=Math.floor(n.height*n.scale),l.canvas.style.width=n.width+"px",l.canvas.style.height=n.height+"px"),l.fontMetrics=new sBe(document),l.ctx.scale(l.options.scale,l.options.scale),l.ctx.translate(-n.x,-n.y),l.ctx.textBaseline="bottom",l._activeEffects=[],l.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),l}return t.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(l){return n.applyEffect(l)})},t.prototype.applyEffect=function(r){this.ctx.save(),XEe(r)&&(this.ctx.globalAlpha=r.opacity),$Ee(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),V9(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return af(this,void 0,void 0,function(){var n;return Mh(this,function(l){switch(l.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:l.sent(),l.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return af(this,void 0,void 0,function(){return Mh(this,function(n){switch(n.label){case 0:if(fu(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,n,l){var u=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+l);else{var d=TF(r.text);d.reduce(function(a,v){return u.ctx.fillText(v,a,r.bounds.top+l),a+u.ctx.measureText(v).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(d){return d==="normal"||d==="small-caps"}).join(""),l=dBe(r.fontFamily).join(", "),u=Y1(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,u,l].join(" "),l,u]},t.prototype.renderTextNode=function(r,n){return af(this,void 0,void 0,function(){var l,u,d,a,v,x,b,I,M=this;return Mh(this,function(L){return l=this.createFontStyle(n),u=l[0],d=l[1],a=l[2],this.ctx.font=u,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",v=this.fontMetrics.getMetrics(d,a),x=v.baseline,b=v.middle,I=n.paintOrder,r.textBounds.forEach(function(U){I.forEach(function(R){switch(R){case 0:M.ctx.fillStyle=Ru(n.color),M.renderTextWithLetterSpacing(U,n.letterSpacing,x);var H=n.textShadow;H.length&&U.text.trim().length&&(H.slice(0).reverse().forEach(function(q){M.ctx.shadowColor=Ru(q.color),M.ctx.shadowOffsetX=q.offsetX.number*M.options.scale,M.ctx.shadowOffsetY=q.offsetY.number*M.options.scale,M.ctx.shadowBlur=q.blur.number,M.renderTextWithLetterSpacing(U,n.letterSpacing,x)}),M.ctx.shadowColor="",M.ctx.shadowOffsetX=0,M.ctx.shadowOffsetY=0,M.ctx.shadowBlur=0),n.textDecorationLine.length&&(M.ctx.fillStyle=Ru(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(q){switch(q){case 1:M.ctx.fillRect(U.bounds.left,Math.round(U.bounds.top+x),U.bounds.width,1);break;case 2:M.ctx.fillRect(U.bounds.left,Math.round(U.bounds.top),U.bounds.width,1);break;case 3:M.ctx.fillRect(U.bounds.left,Math.ceil(U.bounds.top+b),U.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&U.text.trim().length&&(M.ctx.strokeStyle=Ru(n.webkitTextStrokeColor),M.ctx.lineWidth=n.webkitTextStrokeWidth,M.ctx.lineJoin=window.chrome?"miter":"round",M.ctx.strokeText(U.text,U.bounds.left,U.bounds.top+x)),M.ctx.strokeStyle="",M.ctx.lineWidth=0,M.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,n,l){if(l&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var u=xb(r),d=yb(n);this.path(d),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(l,0,0,r.intrinsicWidth,r.intrinsicHeight,u.left,u.top,u.width,u.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return af(this,void 0,void 0,function(){var n,l,u,d,a,v,te,te,x,b,I,M,se,L,U,ye,R,H,q,te,J,se,ye;return Mh(this,function(Se){switch(Se.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,l=r.curves,u=n.styles,d=0,a=n.textNodes,Se.label=1;case 1:return d<a.length?(v=a[d],[4,this.renderTextNode(v,u)]):[3,4];case 2:Se.sent(),Se.label=3;case 3:return d++,[3,1];case 4:if(!(n instanceof S9))return[3,8];Se.label=5;case 5:return Se.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return te=Se.sent(),this.renderReplacedElement(n,l,te),[3,8];case 7:return Se.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof T9&&this.renderReplacedElement(n,l,n.canvas),!(n instanceof I9))return[3,12];Se.label=9;case 9:return Se.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return te=Se.sent(),this.renderReplacedElement(n,l,te),[3,12];case 11:return Se.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof M9&&n.tree?(x=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,x.render(n.tree)]):[3,14];case 13:b=Se.sent(),n.width&&n.height&&this.ctx.drawImage(b,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),Se.label=14;case 14:if(n instanceof IF&&(I=Math.min(n.bounds.width,n.bounds.height),n.type===pb?n.checked&&(this.ctx.save(),this.path([new ii(n.bounds.left+I*.39363,n.bounds.top+I*.79),new ii(n.bounds.left+I*.16,n.bounds.top+I*.5549),new ii(n.bounds.left+I*.27347,n.bounds.top+I*.44071),new ii(n.bounds.left+I*.39694,n.bounds.top+I*.5649),new ii(n.bounds.left+I*.72983,n.bounds.top+I*.23),new ii(n.bounds.left+I*.84,n.bounds.top+I*.34085),new ii(n.bounds.left+I*.39363,n.bounds.top+I*.79)]),this.ctx.fillStyle=Ru(l6),this.ctx.fill(),this.ctx.restore()):n.type===mb&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+I/2,n.bounds.top+I/2,I/4,0,Math.PI*2,!0),this.ctx.fillStyle=Ru(l6),this.ctx.fill(),this.ctx.restore())),uBe(n)&&n.value.length){switch(M=this.createFontStyle(u),se=M[0],L=M[1],U=this.fontMetrics.getMetrics(se,L).baseline,this.ctx.font=se,this.ctx.fillStyle=Ru(u.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=fBe(n.styles.textAlign),ye=xb(n),R=0,n.styles.textAlign){case 1:R+=ye.width/2;break;case 2:R+=ye.width;break}H=ye.add(R,0,0,-ye.height/2+1),this.ctx.save(),this.path([new ii(ye.left,ye.top),new ii(ye.left+ye.width,ye.top),new ii(ye.left+ye.width,ye.top+ye.height),new ii(ye.left,ye.top+ye.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new r1(n.value,H),u.letterSpacing,U),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!fu(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(q=n.styles.listStyleImage,q.type!==0)return[3,18];te=void 0,J=q.url,Se.label=15;case 15:return Se.trys.push([15,17,,18]),[4,this.context.cache.match(J)];case 16:return te=Se.sent(),this.ctx.drawImage(te,n.bounds.left-(te.width+10),n.bounds.top),[3,18];case 17:return Se.sent(),this.context.logger.error("Error loading list-style-image "+J),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(se=this.createFontStyle(u)[0],this.ctx.font=se,this.ctx.fillStyle=Ru(u.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",ye=new ym(n.bounds.left,n.bounds.top+Xs(n.styles.paddingTop,n.bounds.width),n.bounds.width,GN(u.lineHeight,u.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new r1(r.listValue,ye),u.letterSpacing,GN(u.lineHeight,u.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Se.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return af(this,void 0,void 0,function(){var n,l,q,u,d,q,a,v,q,x,b,q,I,M,q,L,U,q,R,H,q;return Mh(this,function(te){switch(te.label){case 0:if(fu(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:te.sent(),n=0,l=r.negativeZIndex,te.label=2;case 2:return n<l.length?(q=l[n],[4,this.renderStack(q)]):[3,5];case 3:te.sent(),te.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:te.sent(),u=0,d=r.nonInlineLevel,te.label=7;case 7:return u<d.length?(q=d[u],[4,this.renderNode(q)]):[3,10];case 8:te.sent(),te.label=9;case 9:return u++,[3,7];case 10:a=0,v=r.nonPositionedFloats,te.label=11;case 11:return a<v.length?(q=v[a],[4,this.renderStack(q)]):[3,14];case 12:te.sent(),te.label=13;case 13:return a++,[3,11];case 14:x=0,b=r.nonPositionedInlineLevel,te.label=15;case 15:return x<b.length?(q=b[x],[4,this.renderStack(q)]):[3,18];case 16:te.sent(),te.label=17;case 17:return x++,[3,15];case 18:I=0,M=r.inlineLevel,te.label=19;case 19:return I<M.length?(q=M[I],[4,this.renderNode(q)]):[3,22];case 20:te.sent(),te.label=21;case 21:return I++,[3,19];case 22:L=0,U=r.zeroOrAutoZIndexOrTransformedOrOpacity,te.label=23;case 23:return L<U.length?(q=U[L],[4,this.renderStack(q)]):[3,26];case 24:te.sent(),te.label=25;case 25:return L++,[3,23];case 26:R=0,H=r.positiveZIndex,te.label=27;case 27:return R<H.length?(q=H[R],[4,this.renderStack(q)]):[3,30];case 28:te.sent(),te.label=29;case 29:return R++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var n=this;r.forEach(function(l,u){var d=YA(l)?l.start:l;u===0?n.ctx.moveTo(d.x,d.y):n.ctx.lineTo(d.x,d.y),YA(l)&&n.ctx.bezierCurveTo(l.startControl.x,l.startControl.y,l.endControl.x,l.endControl.y,l.end.x,l.end.y)})},t.prototype.renderRepeat=function(r,n,l,u){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(l,u),this.ctx.fill(),this.ctx.translate(-l,-u)},t.prototype.resizeImage=function(r,n,l){var u;if(r.width===n&&r.height===l)return r;var d=(u=this.canvas.ownerDocument)!==null&&u!==void 0?u:document,a=d.createElement("canvas");a.width=Math.max(1,n),a.height=Math.max(1,l);var v=a.getContext("2d");return v.drawImage(r,0,0,r.width,r.height,0,0,n,l),a},t.prototype.renderBackgroundImage=function(r){return af(this,void 0,void 0,function(){var n,l,u,d,a,v;return Mh(this,function(x){switch(x.label){case 0:n=r.styles.backgroundImage.length-1,l=function(b){var I,M,L,nt,Ut,jt,Ze,st,De,U,nt,Ut,jt,Ze,st,R,H,q,te,J,se,ye,Se,Be,De,we,nt,_e,Ie,Ze,st,Et,Ut,jt,bt,Nt,ar,lt,ie,Le,Fe,Re;return Mh(this,function(et){switch(et.label){case 0:if(b.type!==0)return[3,5];I=void 0,M=b.url,et.label=1;case 1:return et.trys.push([1,3,,4]),[4,u.context.cache.match(M)];case 2:return I=et.sent(),[3,4];case 3:return et.sent(),u.context.logger.error("Error loading background-image "+M),[3,4];case 4:return I&&(L=vT(r,n,[I.width,I.height,I.width/I.height]),nt=L[0],Ut=L[1],jt=L[2],Ze=L[3],st=L[4],De=u.ctx.createPattern(u.resizeImage(I,Ze,st),"repeat"),u.renderRepeat(nt,De,Ut,jt)),[3,6];case 5:$we(b)?(U=vT(r,n,[null,null,null]),nt=U[0],Ut=U[1],jt=U[2],Ze=U[3],st=U[4],R=Vwe(b.angle,Ze,st),H=R[0],q=R[1],te=R[2],J=R[3],se=R[4],ye=document.createElement("canvas"),ye.width=Ze,ye.height=st,Se=ye.getContext("2d"),Be=Se.createLinearGradient(q,J,te,se),HN(b.stops,H).forEach(function(xt){return Be.addColorStop(xt.stop,Ru(xt.color))}),Se.fillStyle=Be,Se.fillRect(0,0,Ze,st),Ze>0&&st>0&&(De=u.ctx.createPattern(ye,"repeat"),u.renderRepeat(nt,De,Ut,jt))):Xwe(b)&&(we=vT(r,n,[null,null,null]),nt=we[0],_e=we[1],Ie=we[2],Ze=we[3],st=we[4],Et=b.position.length===0?[BF]:b.position,Ut=Xs(Et[0],Ze),jt=Xs(Et[Et.length-1],st),bt=Gwe(b,Ut,jt,Ze,st),Nt=bt[0],ar=bt[1],Nt>0&&ar>0&&(lt=u.ctx.createRadialGradient(_e+Ut,Ie+jt,0,_e+Ut,Ie+jt,Nt),HN(b.stops,Nt*2).forEach(function(xt){return lt.addColorStop(xt.stop,Ru(xt.color))}),u.path(nt),u.ctx.fillStyle=lt,Nt!==ar?(ie=r.bounds.left+.5*r.bounds.width,Le=r.bounds.top+.5*r.bounds.height,Fe=ar/Nt,Re=1/Fe,u.ctx.save(),u.ctx.translate(ie,Le),u.ctx.transform(1,0,0,Fe,0,0),u.ctx.translate(-ie,-Le),u.ctx.fillRect(_e,Re*(Ie-Le)+Le,Ze,st*Re),u.ctx.restore()):u.ctx.fill())),et.label=6;case 6:return n--,[2]}})},u=this,d=0,a=r.styles.backgroundImage.slice(0).reverse(),x.label=1;case 1:return d<a.length?(v=a[d],[5,l(v)]):[3,4];case 2:x.sent(),x.label=3;case 3:return d++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,n,l){return af(this,void 0,void 0,function(){return Mh(this,function(u){return this.path(y6(l,n)),this.ctx.fillStyle=Ru(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,n,l,u){return af(this,void 0,void 0,function(){var d,a;return Mh(this,function(v){switch(v.label){case 0:return n<3?[4,this.renderSolidBorder(r,l,u)]:[3,2];case 1:return v.sent(),[2];case 2:return d=JEe(u,l),this.path(d),this.ctx.fillStyle=Ru(r),this.ctx.fill(),a=eBe(u,l),this.path(a),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return af(this,void 0,void 0,function(){var n,l,u,d,a,v,x,b,I=this;return Mh(this,function(M){switch(M.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,l=!Eg(n.backgroundColor)||n.backgroundImage.length,u=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],d=hBe(O_(n.backgroundClip,0),r.curves),l||n.boxShadow.length?(this.ctx.save(),this.path(d),this.ctx.clip(),Eg(n.backgroundColor)||(this.ctx.fillStyle=Ru(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:M.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(L){I.ctx.save();var U=vb(r.curves),R=L.inset?0:lBe,H=ZEe(U,-R+(L.inset?1:-1)*L.spread.number,(L.inset?1:-1)*L.spread.number,L.spread.number*(L.inset?-2:2),L.spread.number*(L.inset?-2:2));L.inset?(I.path(U),I.ctx.clip(),I.mask(H)):(I.mask(U),I.ctx.clip(),I.path(H)),I.ctx.shadowOffsetX=L.offsetX.number+R,I.ctx.shadowOffsetY=L.offsetY.number,I.ctx.shadowColor=Ru(L.color),I.ctx.shadowBlur=L.blur.number,I.ctx.fillStyle=L.inset?Ru(L.color):"rgba(0,0,0,1)",I.ctx.fill(),I.ctx.restore()}),M.label=2;case 2:a=0,v=0,x=u,M.label=3;case 3:return v<x.length?(b=x[v],b.style!==0&&!Eg(b.color)&&b.width>0?b.style!==2?[3,5]:[4,this.renderDashedDottedBorder(b.color,b.width,a,r.curves,2)]:[3,11]):[3,13];case 4:return M.sent(),[3,11];case 5:return b.style!==3?[3,7]:[4,this.renderDashedDottedBorder(b.color,b.width,a,r.curves,3)];case 6:return M.sent(),[3,11];case 7:return b.style!==4?[3,9]:[4,this.renderDoubleBorder(b.color,b.width,a,r.curves)];case 8:return M.sent(),[3,11];case 9:return[4,this.renderSolidBorder(b.color,a,r.curves)];case 10:M.sent(),M.label=11;case 11:a++,M.label=12;case 12:return v++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,n,l,u,d){return af(this,void 0,void 0,function(){var a,v,x,b,I,M,L,U,R,H,q,te,J,se,ye,Se,ye,Se;return Mh(this,function(Be){return this.ctx.save(),a=tBe(u,l),v=y6(u,l),d===2&&(this.path(v),this.ctx.clip()),YA(v[0])?(x=v[0].start.x,b=v[0].start.y):(x=v[0].x,b=v[0].y),YA(v[1])?(I=v[1].end.x,M=v[1].end.y):(I=v[1].x,M=v[1].y),l===0||l===2?L=Math.abs(x-I):L=Math.abs(b-M),this.ctx.beginPath(),d===3?this.formatPath(a):this.formatPath(v.slice(0,2)),U=n<3?n*3:n*2,R=n<3?n*2:n,d===3&&(U=n,R=n),H=!0,L<=U*2?H=!1:L<=U*2+R?(q=L/(2*U+R),U*=q,R*=q):(te=Math.floor((L+R)/(U+R)),J=(L-te*U)/(te-1),se=(L-(te+1)*U)/te,R=se<=0||Math.abs(R-J)<Math.abs(R-se)?J:se),H&&(d===3?this.ctx.setLineDash([0,U+R]):this.ctx.setLineDash([U,R])),d===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Ru(r),this.ctx.stroke(),this.ctx.setLineDash([]),d===2&&(YA(v[0])&&(ye=v[3],Se=v[0],this.ctx.beginPath(),this.formatPath([new ii(ye.end.x,ye.end.y),new ii(Se.start.x,Se.start.y)]),this.ctx.stroke()),YA(v[1])&&(ye=v[1],Se=v[2],this.ctx.beginPath(),this.formatPath([new ii(ye.end.x,ye.end.y),new ii(Se.start.x,Se.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return af(this,void 0,void 0,function(){var n;return Mh(this,function(l){switch(l.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Ru(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=YEe(r),[4,this.renderStack(n)];case 1:return l.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}($9),uBe=function(e){return e instanceof L9||e instanceof P9?!0:e instanceof IF&&e.type!==mb&&e.type!==pb},hBe=function(e,t){switch(e){case 0:return vb(t);case 2:return KEe(t);case 1:default:return yb(t)}},fBe=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},ABe=["-apple-system","system-ui"],dBe=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return ABe.indexOf(t)===-1}):e},pBe=function(e){Gd(t,e);function t(r,n){var l=e.call(this,r,n)||this;return l.canvas=n.canvas?n.canvas:document.createElement("canvas"),l.ctx=l.canvas.getContext("2d"),l.options=n,l.canvas.width=Math.floor(n.width*n.scale),l.canvas.height=Math.floor(n.height*n.scale),l.canvas.style.width=n.width+"px",l.canvas.style.height=n.height+"px",l.ctx.scale(l.options.scale,l.options.scale),l.ctx.translate(-n.x,-n.y),l.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),l}return t.prototype.render=function(r){return af(this,void 0,void 0,function(){var n,l;return Mh(this,function(u){switch(u.label){case 0:return n=G5(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,mBe(n)];case 1:return l=u.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Ru(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(l,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}($9),mBe=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},gBe=function(){function e(t){var r=t.id,n=t.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Bw([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Bw([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Bw([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Bw([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e}(),_Be=function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new gBe({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new UEe(this,t)}return e.instanceCount=1,e}(),X9=function(e,t){return t===void 0&&(t={}),vBe(e,t)};typeof window<"u"&&H9.setContext(window);var vBe=function(e,t){return af(void 0,void 0,void 0,function(){var r,n,l,u,d,a,v,x,b,I,M,L,U,R,H,q,te,J,se,ye,Be,Se,Be,De,we,nt,_e,Ie,Ze,st,Et,Ut,jt,bt,Nt,ar,lt,ie,Le,Fe;return Mh(this,function(Re){switch(Re.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return l={allowTaint:(De=t.allowTaint)!==null&&De!==void 0?De:!1,imageTimeout:(we=t.imageTimeout)!==null&&we!==void 0?we:15e3,proxy:t.proxy,useCORS:(nt=t.useCORS)!==null&&nt!==void 0?nt:!1},u=F5({logging:(_e=t.logging)!==null&&_e!==void 0?_e:!0,cache:t.cache},l),d={windowWidth:(Ie=t.windowWidth)!==null&&Ie!==void 0?Ie:n.innerWidth,windowHeight:(Ze=t.windowHeight)!==null&&Ze!==void 0?Ze:n.innerHeight,scrollX:(st=t.scrollX)!==null&&st!==void 0?st:n.pageXOffset,scrollY:(Et=t.scrollY)!==null&&Et!==void 0?Et:n.pageYOffset},a=new ym(d.scrollX,d.scrollY,d.windowWidth,d.windowHeight),v=new _Be(u,a),x=(Ut=t.foreignObjectRendering)!==null&&Ut!==void 0?Ut:!1,b={allowTaint:(jt=t.allowTaint)!==null&&jt!==void 0?jt:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:x,copyStyles:x},v.logger.debug("Starting document clone with size "+a.width+"x"+a.height+" scrolled to "+-a.left+","+-a.top),I=new g6(v,e,b),M=I.clonedReferenceElement,M?[4,I.toIFrame(r,a)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return L=Re.sent(),U=FF(M)||xEe(M)?Z1e(M.ownerDocument):fE(v,M),R=U.width,H=U.height,q=U.left,te=U.top,J=yBe(v,M,t.backgroundColor),se={canvas:t.canvas,backgroundColor:J,scale:(Nt=(bt=t.scale)!==null&&bt!==void 0?bt:n.devicePixelRatio)!==null&&Nt!==void 0?Nt:1,x:((ar=t.x)!==null&&ar!==void 0?ar:0)+q,y:((lt=t.y)!==null&&lt!==void 0?lt:0)+te,width:(ie=t.width)!==null&&ie!==void 0?ie:Math.ceil(R),height:(Le=t.height)!==null&&Le!==void 0?Le:Math.ceil(H)},x?(v.logger.debug("Document cloned, using foreign object rendering"),Be=new pBe(v,se),[4,Be.render(M)]):[3,3];case 2:return ye=Re.sent(),[3,5];case 3:return v.logger.debug("Document cloned, element located at "+q+","+te+" with size "+R+"x"+H+" using computed rendering"),v.logger.debug("Starting DOM parsing"),Se=D9(v,M),J===Se.styles.backgroundColor&&(Se.styles.backgroundColor=hm.TRANSPARENT),v.logger.debug("Starting renderer for element at "+se.x+","+se.y+" with size "+se.width+"x"+se.height),Be=new cBe(v,se),[4,Be.render(Se)];case 4:ye=Re.sent(),Re.label=5;case 5:return(!((Fe=t.removeContainer)!==null&&Fe!==void 0)||Fe)&&(g6.destroy(L)||v.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),v.logger.debug("Finished rendering"),[2,ye]}})})},yBe=function(e,t,r){var n=t.ownerDocument,l=n.documentElement?e1(e,getComputedStyle(n.documentElement).backgroundColor):hm.TRANSPARENT,u=n.body?e1(e,getComputedStyle(n.body).backgroundColor):hm.TRANSPARENT,d=typeof r=="string"?e1(e,r):r===null?hm.TRANSPARENT:4294967295;return t===n.documentElement?Eg(l)?Eg(u)?d:u:l:d};const xBe=Object.freeze(Object.defineProperty({__proto__:null,default:X9},Symbol.toStringTag,{value:"Module"}));function wBe({plot:e}){const t=bb(),r=Me.useRef(),[n,l]=Me.useState(!1),[u,d]=Me.useState(!1);if(!e)return Nr.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-100",children:[Nr.jsx("h2",{className:"text-2xl font-semibold text-green-900 mb-6",children:"لا توجد بيانات لعرضها"}),Nr.jsx("button",{onClick:()=>t("/"),className:"px-6 py-2 bg-green-900 text-white rounded-lg shadow hover:bg-green-800 transition",children:"العودة للرئيسية"})]});const a=()=>{const U=e.status;return U==="مستثمر"||U===!0?"مستثمرة":U==="قيد الطرح"?"قيد الطرح":U==="تحت الإيجار"?"تحت الإيجار":"غير مستثمرة"},v=()=>{const U=a();return U==="مستثمرة"?"border-red-500":U==="قيد الطرح"?"border-yellow-500":U==="تحت الإيجار"?"border-orange-500":"border-green-500"},x=[{label:"رقم القطعة",value:e.number},{label:"رقم المخطط",value:e.planNumber},{label:"الحي",value:e.neighborhood},{label:"الحالة",value:a(),colored:!0},{label:"المساحة (م²)",value:e.area},{label:"نوع المشروع",value:e.ACTIV||e.projectType},{label:"النشاط الرئيسي",value:e.main_activ||e.facilityType},{label:"الإيجار",value:e.invested?"مؤجر":"غير مؤجر",colored:!0},{label:"الإحداثيات",value:e.coordinates?e.coordinates.map(([U,R])=>`(${U.toFixed(4)}, ${R.toFixed(4)})`).join(", "):"غير متوفرة"}],b=e.number,M=e.coordinates?`https://api.mapbox.com/styles/v1/mapbox/satellite-v9/static/${e.coordinates[0][1]},${e.coordinates[0][0]},17,0/600x400?access_token=pk.eyJ1Ijoib21hci1oZWdhenkxMjMiLCJhIjoiY21mMHV1OTIyMGtxNjJrc2Jrc3ptd3hyeSJ9.0DL-T3mWdUhrcfOaRKenNA`:"/default-plot-image.jpg",L=async()=>{if(!n)return alert("الرجاء الانتظار حتى تحميل الصورة");const U=r.current,H=(await X9(U,{scale:2,useCORS:!0})).toDataURL("image/png"),q=new Qi("p","mm","a4"),te=q.internal.pageSize.getWidth(),J=q.internal.pageSize.getHeight(),se=q.getImageProperties(H),ye=se.width/se.height;let Se=te,Be=te/ye;Be>J&&(Be=J,Se=J*ye);const De=(te-Se)/2;q.addImage(H,"PNG",De,10,Se,Be),q.save(`land-${e.number}.pdf`)};return Nr.jsxs("div",{className:"h-screen w-screen flex items-center justify-center bg-gray-100 p-4 relative",children:[!n&&Nr.jsx("div",{className:"absolute flex items-center justify-center inset-0 bg-gray-100/80 z-50",children:Nr.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-green-700"})}),u&&Nr.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 cursor-zoom-out transition-opacity duration-300",onClick:()=>d(!1),children:Nr.jsx("img",{src:M,alt:"صورة مكبرة",className:"max-h-[90%] max-w-[90%] object-contain rounded-lg shadow-lg transform scale-100 animate-scaleIn"})}),Nr.jsxs("div",{ref:r,className:`w-full max-w-4xl bg-white rounded-2xl shadow-xl p-6 flex flex-col justify-between h-full transition-all duration-300 ${n?"opacity-100":"opacity-0"}`,children:[Nr.jsx("h2",{className:"text-2xl font-bold text-green-900 border-b pb-3 w-full text-center",children:"بيانات قطعة الأرض"}),Nr.jsxs("div",{className:"flex flex-col md:flex-row gap-6 mt-4 flex-1",children:[Nr.jsx("div",{className:"flex justify-center md:justify-start",children:Nr.jsx(CI,{value:b,size:120,bgColor:"transparent",fgColor:"#14532d",level:"H"})}),Nr.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-4",children:[x.map((U,R)=>Nr.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 flex flex-col shadow-sm",children:[Nr.jsx("span",{className:"text-sm font-semibold text-green-700",children:U.label}),Nr.jsx("span",{className:`${U.colored?v():"text-gray-900"} mt-1 font-medium break-words text-sm`,children:U.value})]},R)),Nr.jsx("div",{className:`col-span-1 row-span-1 border-4 ${v()} rounded-lg shadow-lg overflow-hidden cursor-zoom-in transition-transform duration-300 hover:scale-105`,onClick:()=>d(!0),children:Nr.jsx("img",{src:M,alt:"صورة قطعة الأرض",crossOrigin:"anonymous",onLoad:()=>l(!0),className:"w-full h-full object-cover rounded-lg"})})]})]}),Nr.jsxs("div",{className:"flex mt-4 justify-center gap-4",children:[Nr.jsx("button",{onClick:()=>t("/"),className:"px-5 py-2 bg-green-900 text-white rounded-lg shadow hover:bg-green-800 transition",children:"العودة للرئيسية"}),Nr.jsx("button",{onClick:L,className:"px-5 py-2 bg-red-600 text-white rounded-lg shadow hover:bg-red-700 transition",children:"تصدير PDF"})]})]}),Nr.jsx("style",{children:`
  @keyframes scaleIn {
    0%   { transform: scale(0.5); opacity: 0.8; }
    100%  { transform: scale(1.5); opacity: 1; }
    
  }
  .animate-scaleIn {
    animation: scaleIn 0.6s ease-in  forwards;
  }
`})]})}function bBe(){const[e,t]=Me.useState(!1),[r,n]=Me.useState(null);return Nr.jsx(N$,{children:Nr.jsxs(m$,{children:[Nr.jsx(My,{path:"/login",element:e?Nr.jsx(Kx,{to:"/"}):Nr.jsx(X$,{onEnter:()=>t(!0)})}),Nr.jsx(My,{path:"/",element:e?Nr.jsx(ove,{setScannedPlot:n}):Nr.jsx(Kx,{to:"/login"})}),Nr.jsx(My,{path:"/scanned-plot",element:e?Nr.jsx(wBe,{plot:r}):Nr.jsx(Kx,{to:"/login"})}),Nr.jsx(My,{path:"*",element:Nr.jsx(Kx,{to:"/"})})]})})}Cq.createRoot(document.getElementById("root")).render(Nr.jsx(pc.StrictMode,{children:Nr.jsx(bBe,{})}));export{ps as _,Vx as c,od as g};
